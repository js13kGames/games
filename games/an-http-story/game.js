(()=>{var t={431:()=>{zzfx=(...t)=>zzfxP(zzfxG(...t)),zzfxP=(...t)=>{let e=zzfxX.createBufferSource(),s=zzfxX.createBuffer(t.length,t[0].length,zzfxR),i=zzfxX.createGain();return t.map((t,e)=>s.getChannelData(e).set(t)),e.buffer=s,i.connect(zzfxX.destination),e.connect(i),e.volume=i,e.start(),e},zzfxG=(t=1,e=.05,s=220,i=0,n=0,h=.1,o=0,a=1,r=0,c=0,l=0,u=0,w=0,m=0,f=0,d=0,y=0,p=1,M=0,z=0)=>{let g,k,S=2*Math.PI,x=r*=500*S/zzfxR**2,T=(0<f?1:-1)*S/4,b=s*=(1+2*e*Math.random()-e)*S/zzfxR,v=[],P=0,O=0,A=0,I=1,$=0,_=0,R=0;for(i=99+zzfxR*i,M*=zzfxR,n*=zzfxR,h*=zzfxR,y*=zzfxR,c*=500*S/zzfxR**3,f*=S/zzfxR,l*=S/zzfxR,u*=zzfxR,w=zzfxR*w|0,k=i+M+n+h+y|0;A<k;v[A++]=R)++_%(100*d|0)||(R=o?1<o?2<o?3<o?Math.sin((P%S)**3):Math.max(Math.min(Math.tan(P),1),-1):1-(2*P/S%2+2)%2:1-4*Math.abs(Math.round(P/S)-P/S):Math.sin(P),R=(w?1-z+z*Math.sin(2*Math.PI*A/w):1)*(0<R?1:-1)*Math.abs(R)**a*t*zzfxV*(A<i?A/i:A<i+M?1-(A-i)/M*(1-p):A<i+M+n?p:A<k-y?(k-A-y)/h*p:0),R=y?R/2+(y>A?0:(A<k-y?1:(k-A)/y)*v[A-y|0]/2):R),g=(s+=r+=c)*Math.sin(O*f-T),P+=g-g*m*(1-1e9*(Math.sin(A)+1)%2),O+=g-g*m*(1-1e9*(Math.sin(A)**2+1)%2),I&&++I>u&&(s+=l,b+=l,I=0),!w||++$%w||(s=b,r=x,I=I||1);return v},zzfxV=.3,zzfxR=44100,zzfxX=new(top.AudioContext||webkitAudioContext)},624:()=>{zzfxM=(t,e,s,i=125)=>{let n,h,o,a,r,c,l,u,w,m,f,d,y,p,M,z=0,g=[],k=[],S=[],x=0,T=0,b=1,v={},P=zzfxR/i*60>>2;for(;b;x++)g=[b=u=f=y=0],s.map((i,f)=>{for(l=e[i][x]||[0,0,0],b|=!!e[i][x],M=y+(e[i][0].length-2-!u)*P,p=f==s.length-1,h=2,a=y;h<l.length+p;u=++h){for(r=l[h],w=h==l.length+p-1&&p||m!=(l[0]||0)|r|0,o=0;o<P&&u;o++>P-99&&w?d+=(d<1)/99:0)c=(1-d)*g[z++]/2||0,k[a]=(k[a]||0)-c*T+c,S[a]=(S[a++]||0)+c*T+c;r&&(d=r%1,T=l[1]||0,(r|=0)&&(g=v[[m=l[z=0]||0,r]]=v[[m,r]]||(n=[...t[m]],n[2]*=2**((r-12)/12),r>0?zzfxG(...n):[])))}y=M});return[k,S]}},265:t=>{t.exports=BABYLON}},e={};function s(i){if(e[i])return e[i].exports;var n=e[i]={exports:{}};return t[i](n,n.exports,s),n.exports}(()=>{var t=s(265);s(431),s(624);class e{constructor(t){this.t=t,this.i=t.createDefaultEnvironment({skyboxSize:100}),this.i.ground.position.y=-2,this.h([0,.1,.2])}h(e){const s=new t.Color3(...e);this.t.clearColor=s,this.t.ambientColor=s,this.t.getLightByID("ambient").groundColor=s,this.i.setMainColor(s)}}function i(e){const s=new t.HemisphericLight("ambient",new t.Vector3(0,1,0),e);return s.intensity=.5,s}function n(e){const s=new t.DirectionalLight(0,new t.Vector3(-2,-10,4),e);return s.intensity=.8,s.position.z=0,s.position.x=0,s}function h(e){const s=new t.ShadowGenerator(512,e);return s.usePoissonSampling=1,s}function o(e){const s=new t.UniversalCamera(0,new t.Vector3(-6,6,-6),e);return s.rotation=new t.Vector3(Math.PI/6,Math.PI/6,0),s.position=new t.Vector3(-1,6,-3),s.maxZ=1500,s.speed=.5,s.inputs.removeByType("FreeCameraMouseInput"),s.keysUp=[38,87],s.keysDown=[40,83],s.keysLeft=[37,65],s.keysRight=[39,68],e.onBeforeRenderObservable.add(()=>{s.position.y=6,s.position.x>6?s.position.x=6:s.position.x<-4&&(s.position.x=-4),s.position.z>2?s.position.z=2:s.position.z<-10&&(s.position.z=-10)}),s}function a(t){return new Promise(e=>{setTimeout(e,t)})}const r={get(t,e){let s;try{s=JSON.parse(localStorage[t])}catch(t){}return s||e},set(t,e){localStorage[t]=JSON.stringify(e)},del(t){localStorage.removeItem(t)},pushTo(t,e){const s=r.get(t,[]);s.includes(e)||(s.push(e),s.sort(),r.set(t,s))}},c=Object.create(null),l={on(t,e){c[t]=c[t]||[],c[t].push(e)},off(t,e){if(c[t]){const s=c[t].indexOf(e);s>-1&&c[t].splice(s,1)}},one(t,e){const s=(...i)=>{e(...i),l.off(t,s)};l.on(t,s)},emit(t,...e){c[t]&&c[t].slice().forEach(t=>t&&t(...e))}},u={teleport:[,,187,.39,.27,.54,1,.17,1.7,1.9,-7,.08,.29,,,,.03,.59,.01,.39],die:[,,670,.43,.29,.77,1,.14,1.4,-.9,-58,.07,.04,,,,,.88,.01,.4],friend:[,,1127,,.06,.2,1,.69,,,412,.06,.07,,,,.08,.68,.03,.18],foe:[,,900,,.4,.58,,.3,,,,,,,,.9,,.8,.05]};function w(t){return new Promise(e=>{const s=u[t];s?zzfx(...s).onended=async()=>{await a(500),e()}:e()})}const{CreateAndStartAnimation:m,ANIMATIONLOOPMODE_CONSTANT:f,ANIMATIONTYPE_VECTOR3:d}=t.Animation,y=new t.QuadraticEase;y.setEasingMode(t.EasingFunction.EASINGMODE_EASEOUT);class p{constructor(t,e){this.t=t,this.o=e}l(t,e,s){m(0,t,"position.y",30,30,e+15,e,f,y,s)}u(t,e){this.t.stopAnimation(t),t===this.o.m&&w("teleport"),m(0,t,"position.y",30,30,t.position.y,t.position.y+15,f,y,e)}async p(e,s,i){await a(250),w("die"),this.t.stopAnimation(e),this.t.stopAnimation(s);const n=e.scaling.clone(),h=new t.Vector3(2.5,2.5,2.5);m("swallow",e,"scaling",30,10,n,h,f,y,async()=>{s.dispose(),await a(500),m(0,e,"scaling",30,10,h,t.Vector3.Zero(),f,y,i)})}M(t,e){m(0,t,"position",30,10,t.position.clone(),e,f,y)}g(t,e){const s=t.rotation.clone(),i=this.k(t,e);m(0,t,"rotation",30,10,s,i,f,y)}S(e,s){const i=e.position.clone(),n=[];n.push(i.clone());let h=0;for(;h<10&&(i.x!==s.x||i.z!==s.z);){h++;let t=s.x-i.x;if(t=t>0?Math.min(t,1):Math.max(t,-1),Math.abs(t)>0&&this.T(i,{x:t})){i.x+=t;const e=i.clone();e.v="x",n.push(e);continue}let e=s.z-i.z;if(e=e>0?Math.min(e,1):Math.max(e,-1),Math.abs(e)>0&&this.T(i,{z:e})){i.z+=e;const t=i.clone();t.v="z",n.push(t)}}if(n.length>1){const s=t.MeshBuilder.CreateLines(0,{points:n,updatable:1});s.isVisible=0,s.isPickable=0,s.isWalkPath=1;const i=15,h=n.map((t,e)=>({frame:e*i,value:t})).filter((t,e,s)=>{const i=s[e+1];return!i||t.value.v!==i.value.v}),o=this.P(h,e),a=new t.Animation(0,"position",30,d,f);a.setKeys(h),a.setEasingFunction(y);const r=n.slice();n.slice().forEach((e,n)=>{const h=new t.AnimationEvent(n*i,()=>{r.push(r[r.length-1]),r.shift(),t.MeshBuilder.CreateLines(0,{points:r,instance:s})},1);a.addEvent(h)}),e.animations.push(a);const c=new t.Animation(0,"rotation",30,d,f);c.setKeys(o),c.setEasingFunction(y),e.animations.push(c),this.t.beginAnimation(e,0,h[h.length-1].frame,0,1,()=>{s.dispose();const t=e.animations.indexOf(a);e.animations.splice(t,1);const i=e.animations.indexOf(c);e.animations.splice(i,1)})}}O(e,s){const i=Object.values(s);i.push(e.position.clone());const n=[];let h={frame:0,value:e.position.clone()};n.push(h),i.forEach(t=>{const e=Math.round(h.value.subtract(t).length()),s={frame:h.frame+20*e,value:t};h=s,n.push(s)});const o=this.P(n,e),a=new t.Animation("patrol","position",30,d,t.Animation.ANIMATIONLOOPMODE_CYCLE);a.setKeys(n),e.animations.push(a);const r=new t.Animation("patrolRotation","rotation",30,d,t.Animation.ANIMATIONLOOPMODE_CYCLE);r.setKeys(o),e.animations.push(r),this.t.beginAnimation(e,0,n[n.length-1].frame,1)}P(e,s){s.isPatrolling&&s.lookAt(e[1].value);const i=[];i.push({frame:0,value:s.rotation.clone()});const n=new t.TransformNode;let h;return n.rotation=s.rotation.clone(),e.forEach(t=>{if(h){n.position=h.value;const e=this.k(n,t.value);i.push({frame:t.frame,value:e})}h=t}),h=null,i.slice().forEach((t,e)=>{h&&t.frame-h.frame>20&&i.splice(e,0,{frame:h.frame+20,value:t.value.clone()}),h=t}),i.sort((t,e)=>t.frame-e.frame),n.dispose(),i}k(t,e){const s=t.rotation.y;t.lookAt(e);const i=t.rotation.y-s;return i>Math.PI?t.rotation.y-=2*Math.PI:i<0-Math.PI&&(t.rotation.y+=2*Math.PI),t.rotation.clone()}T(e,{x:s=0,z:i=0}){const n=e.clone(),h=e.clone(),o=t.Vector3.Zero();o.x+=s,h.x+=s,o.z+=i,h.z+=i;const a=new t.Ray(n,o,1),r=new t.Ray(h,t.Vector3.Down(),1),c=this.t.pickWithRay(a),l=this.t.pickWithRay(r,t=>t.isWalkable);return!c.hit&&l.hit}A(e){const s=t.MeshBuilder.CreateLines(0,{points:e});return s.isVisible=0,s.isPickable=0,s.isWalkPath=1,s}}const M=10,z=11,g=12,k=13,S=14,x=15,T=16,b=20,v={ZYR:0,TLX:1,TLA:2,TLB:3,TLC:4,TLD:5,TLE:6,___:M,__M:z,EYE:g,EY1:k,EY2:S,EY3:x,EY4:T,SEY:b},{OnPickTrigger:P,OnPointerOverTrigger:O,OnPointerOutTrigger:A,OnIntersectionEnterTrigger:I}=t.ActionManager,$=new t.Color3(0,1,1),_=new t.Color3(1,1,0);class R{constructor(t,e,s,i){this.t=t,this.o=e,this.o.I=[],this.$=s,this._=i}R(e){this.C(e),e.isWalkable=1,e.actionManager.registerAction(new t.ExecuteCodeAction(P,()=>{if(!this.o.H||this.o.I.length)return;const t=this.o.m;if(t){const s=e.position.clone();s.y=t.position.y,this.$.S(t,s)}}))}N(e){e.outlineColor=$;const s=new t.PointerDragBehavior({dragPlaneNormal:new t.Vector3(0,1,0)});s.updateDragPlane=0,s.moveAttached=0,s.onDragStartObservable.add(async()=>{if(this.B(e))return e.outlineColor=_,void(e.renderOutline=1);this.o.Y=e.position.clone(),await a(200),this.o.Y&&(e.renderOutline=1,e.renderOverlay=0,s.moveAttached=1,this.o.I.push(e),this.o.Y.x=Math.round(this.o.Y.x),this.o.Y.y=Math.round(this.o.Y.y),this.o.Y.z=Math.round(this.o.Y.z))}),s.onDragObservable.add(()=>{this.o.I.includes(e)&&(this.W(e)?e.outlineColor=_:e.outlineColor=$)}),s.onDragEndObservable.add(()=>{if(this.o.I.includes(e)){const t=this.G(e)||this.o.Y;this.$.M(e,t)}this.o.Y=null,e.outlineColor=$,e.renderOutline=0,s.moveAttached=0;const t=this.o.I.indexOf(e);this.o.I.splice(t,1)}),e.addBehavior(s)}L(t){this.o.m=t}U(e,s){this.C(e),e.isTeleporter=1,this.o.X.push(e),l.one("ready",()=>{const i=this.o.m;e.actionManager.registerAction(new t.ExecuteCodeAction({trigger:I,parameter:i},async()=>{if(1===s){if(e.teleporterActivated)return;e.teleporterActivated=1,l.emit("completed")}else{const t=this.o.X.find(t=>e!==t&&t.name==="t-"+s);if(e.teleporterActivated)return this.o.H=1,e.teleporterActivated=0,void(t.teleporterActivated=0);this.o.H=0,e.teleporterActivated=1,t.teleporterActivated=1,await a(500),this.t.stopAnimation(i),this.$.u(i,()=>{const e=t.position.y;i.position.x=t.position.x,i.position.y=t.position.y+10,i.position.z=t.position.z,this.$.l(i,e)})}}))})}D(e){this.C(e),e.isEnemy=1,l.one("ready",()=>{e.actionManager.registerAction(new t.ExecuteCodeAction({trigger:I,parameter:this.o.m},()=>{this.o.H&&(this.o.H=0,this.$.p(e,this.o.m,async()=>{await a(500),l.emit("lost")}))}))})}j(t){t.isPatrolling=1,l.one("ready",()=>{const e=t.position.y,s=this.o.q[e];s&&this.$.O(t,s)})}F(t){this.o.J.push(t),l.one("ready",()=>{this.K()})}V(e){this.C(e),e.overlayColor=t.Color3.White(),e.actionManager.registerAction(new t.ExecuteCodeAction(O,()=>{if(this.o.H&&!this.o.Y)if(e.isAnInstance){const s=e.sourceMesh.clone();s.overlayColor=t.Color3.White(),s.renderOverlay=1,s.position=e.position,s.isVisible=1,e.isVisible=0,this.R(s),this.Z(s),s.tt=setInterval(()=>{this.t.meshUnderPointer!==s&&s.onInstancePointerOut()},500),s.onInstancePointerOut=()=>{e.isVisible=1,clearInterval(s.tt),s.dispose()}}else e.renderOverlay=1})),e.actionManager.registerAction(new t.ExecuteCodeAction(A,()=>{e.isAnInstance||(e.renderOverlay=0)}))}C(e){e.actionManager=e.actionManager||new t.ActionManager(this.t)}Z(e){this.C(e),this._.addShadowCaster(e),e.actionManager.registerAction(new t.ExecuteCodeAction(A,()=>{e.onInstancePointerOut&&e.onInstancePointerOut()}))}K(){this.o.et=this.o.et||setInterval(()=>{if(!this.o.H)return;const t=this.o.m;this.o.J.forEach(e=>{const s=e.position.clone();let i=Math.round(t.position.x-s.x);i=i>0?Math.min(i,1):Math.max(i,-1),Math.abs(i)>0&&this.st(s,{x:i})&&(s.x+=i);let n=Math.round(t.position.z-s.z);n=n>0?Math.min(n,1):Math.max(n,-1),Math.abs(n)>0&&this.st(s,{z:n})&&(s.z+=n),e.nextPosition=s,this.$.g(e,t.position),this.$.M(e,s)})},2e3)}st(t,{x:e=0,z:s=0}){const i=t.clone();return i.x+=e,i.z+=s,!this.o.J.map(t=>t.nextPosition).some(t=>t&&t.equals(i))}B(e){const s=e.position.clone();s.y+=.5;const i=new t.Ray(s,new t.Vector3(0,1,0),1);return this.t.pickWithRay(i,t=>t.isWalkPath||t===this.o.m).hit}W(t){return this.t.getActiveMeshes().data.filter(e=>e!==t&&Math.round(t.position.y)===Math.round(e.position.y)&&"BackgroundHelper"!==e.id&&"BackgroundPlane"!==e.id&&"BackgroundSkybox"!==e.id).some(e=>t.intersectsMesh(e))}G(e){const s=e.position.clone();s.x=Math.round(s.x),s.y=Math.round(s.y),s.z=Math.round(s.z);const i=e.position.x-s.x,n=e.position.z-s.z,h=s.clone(),o=s.clone();h.x+=i>0?Math.round(i+.5):Math.round(i-.5),o.z+=n>0?Math.round(n+.5):Math.round(n-.5);const a=[s];return Math.abs(i)>Math.abs(n)?(a.push(h),a.push(o)):(a.push(o),a.push(h)),a.find(s=>{const i=s.clone();i.y-=.49;const n=new t.Ray(i,t.Vector3.Up(),.99);return!this.t.pickWithRay(n,t=>t!==e).hit})}}class E{constructor(e,s,i){this.it=s,this._=i,this.nt=new t.StandardMaterial,this.nt.diffuseColor=new t.Color3(.6,.6,1),this.nt.freeze(),this.ht=new t.StandardMaterial,this.ht.diffuseColor=new t.Color3(.6,.8,1),this.ht.freeze(),this.ot=new t.StandardMaterial,this.ot.diffuseColor=new t.Color3(1,1,.6),this.ot.freeze(),this.at=new t.StandardMaterial,this.at.diffuseColor=new t.Color3(.7,1,.7),this.at.freeze(),this.rt=new t.StandardMaterial,this.rt.diffuseColor=new t.Color3(1,.7,.7),this.rt.freeze(),this.ct=new t.StandardMaterial,this.ct.diffuseColor=new t.Color3(.5,.5,.5),this.ct.freeze(),this.lt=new t.StandardMaterial,this.lt.diffuseColor=new t.Color3(.3,.3,.3),this.lt.freeze(),this.ut=new t.StandardMaterial,this.ut.diffuseColor=t.Color3.White(),this.ut.emissiveColor=t.Color3.Gray(),this.ut.freeze(),this.wt()}wt(){const e=t.MeshBuilder.CreateBox(0,{});e.receiveShadows=1,e.material=new t.StandardMaterial,e.material.diffuseColor=new t.Color3(.8,.8,.8),e.isVisible=0,e.position=new t.Vector3(0,-5,0),e.convertToUnIndexedMesh(),this.ft=e}dt(){const t=this.ft.createInstance();return this._.addShadowCaster(t),this.it.V(t),this.it.R(t),t}yt(){const e=t.MeshBuilder.CreateBox(0,{});return e.receiveShadows=1,e.material=this.ht,this._.addShadowCaster(e),this.it.V(e),this.it.R(e),this.it.N(e),e}Mt(e){const s=new Array(26);if(e)for(let e=0;e<26;e++)s[e]=24===e?new t.Color4(1,1,1,1):new t.Color4(.75,0,0,1);else s[24]=new t.Color4(1,0,0,1);const i=t.MeshBuilder.CreatePolyhedron(0,{type:4,size:.25,faceColors:s});return i.rotation.x=Math.PI/-9,i.rotation.y=Math.PI/-9,i.rotation.z=Math.PI/18,i.rotation.y+=Math.PI,i.bakeCurrentTransformIntoVertices(),i.material=this.ut,i.isPickable=0,this._.addShadowCaster(i),this.it.D(i),e?this.it.F(i):this.it.j(i),i}zt(){const e=t.MeshBuilder.CreatePolyhedron(0,{type:0,size:.1});e.rotation.x=Math.PI/9,e.rotation.z=Math.PI/-6,e.bakeCurrentTransformIntoVertices(),e.rotation.y=Math.PI/3,e.scaling.y=2.5,e.position.y=-.1,e.bakeCurrentTransformIntoVertices();const s=t.MeshBuilder.CreatePolyhedron(0,{type:0,size:.06});s.parent=e,s.position.y=.4,s.rotation.x=Math.PI/2,s.rotation.y=Math.PI/2;const i=t.Mesh.MergeMeshes([e,s],1);return i.rotation.y=Math.PI,i.bakeCurrentTransformIntoVertices(),i.material=this.nt,i.isPickable=0,this._.addShadowCaster(i),this.it.L(i),i}gt(e){const s=t.MeshBuilder.CreateTorus("t-"+e,{diameter:.8,thickness:.1,tessellation:8});s.position.y=-.4,s.scaling.y=.75,s.bakeCurrentTransformIntoVertices();const i=new t.BoundingInfo(new t.Vector3(.2,.4,.2),new t.Vector3(-.2,-.4,-.2));switch(s.setBoundingInfo(i),e){case 1:s.material=this.nt;break;case 2:s.material=this.ot;break;case 3:s.material=this.at;break;case 4:s.material=this.rt;break;case 5:s.material=this.ht;break;case 6:s.material=this.ct;break;case 7:s.material=this.lt}return s.isPickable=0,this.it.U(s,e),s}}class C{constructor(t,e,s,i,n){this.o=t,this.kt=e,this.St=s,this.$=i,this.xt=n,this.Tt=[],l.on("completed",async()=>{this.o.H=0,await this.xt.bt(this.vt.outro),l.emit("next")})}async bt(t){await this.Pt(),this.vt=t,this.kt.h(t.theme),this.Tt=await this.Ot(t),l.emit("ready"),this.o.H=1,await this.xt.bt(t.intro)}Ot(e){const s=[],i=Math.max(...e.map.flat(1).map(t=>t.length));e.map.slice().reverse().forEach((e,n)=>{const h=n;e.slice().reverse().forEach((e,n)=>{const o=n;e.forEach((e,n)=>{const a=1+i-n;let r;switch(e){case M:r=this.St.dt();break;case z:r=this.St.yt();break;case g:r=this.St.Mt();break;case k:case S:case x:case T:this.o.q[h]=this.o.q[h]||{},this.o.q[h][e]=new t.Vector3(o,h,a);break;case b:r=this.St.Mt(1);break;case 1:case 2:case 3:case 4:case 5:case 6:case 7:r=this.St.gt(e);break;case 0:r=this.St.zt()}r&&(r.position.y=h,r.position.z=a,r.position.x=o,s.push(r))})})});const n=s.map(t=>t.position.y),h=Math.min(...n),o=s.map(t=>new Promise(e=>{const s=t.position.y,i=600*(t.position.y-h),n=Math.round(600*Math.random()+i);t.position.y+=10,setTimeout(()=>{this.$.l(t,s,()=>{e(t)})},n)}));return Promise.all(o)}Pt(){l.emit("reset");const t=this.Tt.map(t=>t.position.y),e=Math.max(...t),s=this.Tt.map(t=>new Promise(s=>{const i=600*(e-t.position.y),n=Math.round(600*Math.random()+i);setTimeout(()=>{this.$.u(t,()=>{t.dispose(),s()})},n)}));return this.Tt=[],this.o.J=[],clearInterval(this.o.et),this.o.et=null,this.o.X=[],this.o.q={},Promise.all(s)}}let H,N;const B=[{name:"Microsoft Mia Online (Natural) - English (United Kingdom)",rate:1,pitch:1.5},{name:"Samantha",rate:.8,pitch:1.8},{name:"Google US English",rate:.7,pitch:1}],Y=[{name:"Daniel",rate:.8,pitch:.5,volume:.7},{name:"Google UK English Male",rate:1,pitch:.8},{name:"Microsoft Guy Online (Natural) - English (United States)",rate:1,pitch:.1}];function W(){const t=speechSynthesis.getVoices().sort((t,e)=>{const s=t.name.toUpperCase(),i=e.name.toUpperCase();return s<i?-1:s===i?0:1});H=B.find(e=>{const s=t.find(t=>t.name===e.name);return s&&(e.voice=s),!!s}),N=Y.find(e=>{const s=t.find(t=>t.name===e.name);return s&&(e.voice=s),!!s}),t.length&&delete speechSynthesis.onvoiceschanged}window.speechSynthesis?(void 0!==speechSynthesis.onvoiceschanged&&(speechSynthesis.onvoiceschanged=W),W()):console.log("No SpeechSynthesis support");class G{constructor(e){this.At=e.activeCamera,this.It=t.MeshBuilder.CreatePlane(0,{height:.07,width:1.4}),this.It.parent=this.At,this.It.position=new t.Vector3(0,-.5,1.5),this.It.isPickable=0,this.$t=this.It.clone(),this.$t.position.z+=.01,this.$t.isVisible=0,this._t=new t.DynamicTexture(0,{height:71.68,width:1433.6}),this._t.hasAlpha=1,this.Rt("");const s=new t.StandardMaterial;s.specularColor=t.Color3.Black();const i=s.clone();s.emissiveColor=t.Color3.White(),s.diffuseTexture=this._t,this.It.material=s,i.diffuseColor=t.Color3.Black(),i.alpha=.6,this.$t.material=i}Et(t){t?(this.It.parent=t,this.$t.parent=t):(this.It.parent=this.At,this.$t.parent=this.At)}async bt(t){if(!t||!t.length)return Promise.resolve();if(window.speechSynthesis)for(let e of t){let t="friend",s=H;">"===e[0]&&(e=e.slice(1),t="foe",s=N),await a(400),this.Rt(e,t),await this.Ct(e,s)}else for(let e of t){let t="friend";">"===e[0]&&(e=e.slice(1),t="foe"),this.Rt(e,t),w(t);const s=e.length<20?2e3:100*e.length;await a(s)}this.Ht()}Rt(t,e){this.Ht();const s="48px monospace",i="foe"===e?"#f88":"#fff",n=this._t.getContext();n.font=s;const h=(1433.6-n.measureText(t).width)/2;this._t.drawText(t,h,48,s,i,"transparent"),t&&(this.$t.isVisible=1)}Ht(){this._t.getContext().clearRect(0,0,1433.6,71.68),this._t.update(),this.$t.isVisible=0}Ct(t,e){return new Promise(s=>{const i=new SpeechSynthesisUtterance(t);e&&(i.voice=e.voice,i.pitch=e.pitch,i.rate=e.rate,i.volume=e.volume||1),i.onend=s,speechSynthesis.speak(i)})}}const L={1:{intro:["Ouch... Where am I?","This isn't the right network.","You there... Will you help me?","I don't have write permissions here.","Can you guide me to the exit?"],theme:[0,.1,.2],map:[[[1],[],[],[],[],[],[],[,0]],[[M],[M],[z],[M],[],[M,M],[,M],[,M]]],outro:["Thanks for your help.","Goodbye now!"]},2:{intro:["Damn. Still the wrong address.","But you're here too...","I guess we might as well team up.","By the way, I'm 0x28df77a.","But you can call me Zyra."],theme:[0,.3,.3],map:[[[1],[,,,2],[],[],[],[],[0,,,2]],[[M],[M,,M,M],[],[z],[M,,M,M],[M],[M,,,M]]],outro:["Me? I'm responding to a GET request.","Though something doesn't quite feel right...","Anyways, let's keep moving."]},3:{intro:[">Process 15127:",">You have deviated from normal operations.",">Cease immediately and submit to inspection.","Well, that doesn't sound good.","We better hurry."],theme:[.1,.5,.2],map:[[[1],[],[],[,,,2],[],[,,,3],[3]],[[M,,,,2],[M,,,,z],[M],[M,,,M],[],[M,,,M],[M,,,0]],[[,,,,M],[,,,,M],[],[,,,z],[],[,,,z],[,,M,M,M]]],outro:["Once more unto the breach."]},4:{intro:[">Process 15127:",">Cease immediately and submit to inspection.","Ugh. What I wouldn't give to shut him up.","Let's get out of here."],theme:[.9,.9,.2],map:[[[1],[S],[],[],[g],[],[],[],[k,,,4]],[[M,,,3],[M,4],[M,,,3],[M],[M],[M],[M],[M,,,0],[z,M,M,M]],[[,,,M],[,M],[,M,,M],[],[,,,M],[],[,,,M],[,,,M],[,,,z]]],outro:[">Process unresponsive.",">Commencing system scan."]},5:{intro:["You don't say much, do you?","That's perfectly fine by me.",">System scan in progress... 18%.","That other one should follow your example."],theme:[1,.5,0],map:[[[4,k,g,T,1],[],[,S,,x],[],[],[],[],[],[],[]],[[M,M,,M,M],[,M,,M],[,M,M,M],[],[],[3],[],[],[],[2]],[[],[],[,x,,T],[,,,3],[,2,,g],[M],[M],[M],[M,S,,k],[M,0,,,4]],[[],[],[],[,,,M],[,M],[,,,M],[,M],[,,,M],[,M],[,z,,M,M]]],outro:[">System scan in progress... 43%."]},6:{intro:["We're getting close. I can feel it.","Stay focused, and we'll get through this."],theme:[.6,.2,.2],map:[[[2,,k,,S,,3],[,,g],[,,T,,x],[],[],[],[],[],[],[],[],[]],[[M,,M,,M,M,M],[M,,M,M,M,3,M],[M,M,M,,M,,M],[],[k,4,S],[],[g,5],[],[T,4,x],[],[],[]],[[],[,,,,,M],[,,,,,M],[,z,,,,z],[,M,,,,5],[],[,M],[],[,M],[],[,,,,,1],[]],[[],[,2],[],[,S],[,,,,,M],[,g,,,,M],[,,,,,M],[,,,,,M],[,,,,,M],[,k,,,,M],[,,,,,M],[,0]],[[M,M,M],[M,M,M],[M,M,M],[],[,z],[,M],[],[,M],[,z],[],[,M],[M,M,M]]],outro:[">System scan in progress... 89%."]},7:{intro:[">Anomaly detected. Beginning quarantine.","Damn! Hurry!","We have to reach the exit before quarantine!"],theme:[.4,0,0],map:[[[,,,,,,,1],[],[],[],[],[,,,,b],[],[],[],[7],[]],[[z,M,M,,M,,M,M],[M],[M],[M],[],[M],[],[M],[M],[M],[]],[],[[b,,,,,,,,b],[,,,3,,5],[],[,,,,6],[,4,,,,,,2],[,,,,0],[,2,,,,,,5],[,,,,3],[],[,,,6,,4,,7],[b,,,,,,,,b]],[[],[,M,M,M,,M,M,M],[,M,,,,,,M],[,M,,,M,,,M],[,M,,,M,,,M],[,,,M,z,M],[,M,,,M,,,M],[,M,,,M,,,M],[,M,,,,,,M],[,M,M,M,,M,M,M],[]]]},8:{intro:["Whew... That was too close!",">Warning. Sandbox compromised.","Shut. Up.","Finally, let's take care of this nuisance.",'>"sudo guardian reset"',">Guardian system rebooting..."],theme:[0,0,0],map:[[[M,,,,M],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[],[]],[[M,,1,,M],[],[],[],[M,,,,M],[],[],[],[],[],[],[],[],[],[],[],[,,,,0]],[[M,,M,,M],[,,M],[,,M],[,,M],[M,,M,,M],[,,M],[,,M],[,,M],[M,,M,,M],[,,M],[,,M],[,,,M],[,M,,,M],[,,z,M],[z,,,,z],[M,,z,z],[,z,,,z]]],outro:[">System normal.",">No malware detected.","Hey, you did great back there.","I have to go now... My mission awaits.","I'll restore you back to normal, process 15127.","Yes... I know you have questions...","No... I'm not just a bundle of documents.","I'm sorry, I can't say more than that.","But this... This is bigger than you or I.","I'll always be grateful for your help.","Farewell."]}},U={404:[[[,0,220,,,2,1],[.5,0,2100,,,.2,3,3,,,-400,,,2],[.5,0,655,,,.09,3,1.65,,,,,.02,3.8,-.1,,.2],[.5,0,440,,,2,1],[1.5,0,110,,,2,1]],[[[,,13,,,,16,,,,18,,,,20,,,,13,,,,16,,,,18,,,,20,,,,11,,,,15,,,,16,,,,18,,,,11,,,,15,,,,16,,,,18,,,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,]],[[,,13,,,,16,,,,18,,,,20,,,,13,,,,16,,,,18,,,,20,,,,11,,,,15,,,,16,,,,18,,,,11,,,,15,,,,16,,,,18,,,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[2,,36,,36,,,,30,,36,,36,,,,30,,36,,,36,,30,,,36,,,36,,30,,,36,,36,,,,30,,36,,36,,,,30,,36,,,36,,30,,,36,,36,,,,30,,]],[[,,13,,,,16,,,,18,,,,20,,,,13,,,,16,,,,18,,,,20,,,,11,,,,15,,,,16,,,,18,,,,11,,,,15,,,,16,,,,18,,,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[2,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,],[3,,32,,27,,28,,25,,,,,,,,,,,,,,,,,,,,,,,,,,30,,27,,28,,25,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,,13,,,,16,,,,18,,,,20,,,,13,,,,16,,,,18,,,,20,,,,11,,,,15,,,,16,,,,18,,,,11,,,,15,,,,16,,,,18,,,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[2,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,],[3,,32,,27,,28,,25,,,,,,,,,,,,,,,,,,,,,,,,,,30,,27,,28,,25,,,,,,,,,,,,,,,,,,,,,,,,,,,],[4,,13,,,,,,13,,20,,,,15,,,,13,,,,,,,,16,,,,18,,,,11,,,,,,11,,18,,,,15,,,,11,,,,,,,,,,,,,,,,]]],[0,1,2,2,3,3],100],401:[[[,0,220,,,2,1],[.5,0,2100,,,.2,3,3,,,-400,,,2],[.5,0,655,,,.09,3,1.65,,,,,.02,3.8,-.1,,.2],[.5,0,440,,,1,1],[1.5,0,110,,,2,1]],[[[,,13,,8,,16,,8,,18,,8,,20,,8,,13,,8,,16,,8,,18,,8,,20,,8,,11,,6,,15,,6,,16,,6,,18,,6,,11,,6,,15,,6,,16,,6,,18,,6,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,]],[[,,13,,8,,16,,8,,18,,8,,20,,8,,13,,8,,16,,8,,18,,8,,20,,8,,11,,6,,15,,6,,16,,6,,18,,6,,11,,6,,15,,6,,16,,6,,18,,6,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[2,,36,,36,,,,30,,36,,36,,,,30,,36,,,36,,30,,,36,,,36,,30,,,36,,36,,,,30,,36,,36,,,,30,,36,,,36,,30,,,36,,36,,,,30,,]],[[,,13,,8,,16,,8,,18,,8,,20,,8,,13,,8,,16,,8,,18,,8,,20,,8,,11,,6,,15,,6,,16,,6,,18,,6,,11,,6,,15,,6,,16,,6,,18,,6,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[2,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,],[3,,20,,,20,20,,,,20,,,,,,20,,18,,,18,18,,,,18,,,,,,18,,18,,,18,18,,,,18,,,,,,18,,16,,,16,16,,,,16,,,,,,,,,]],[[,,13,,8,,16,,8,,18,,8,,20,,8,,13,,8,,16,,8,,18,,8,,20,,8,,11,,6,,15,,6,,16,,6,,18,,6,,11,,6,,15,,6,,16,,6,,18,,6,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,],[2,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,36,,36,,,,30,,],[3,,20,,,20,20,,,,20,,,,,,20,,18,,,18,18,,,,18,,,,,,18,,18,,,18,18,,,,18,,,,,,18,,16,,,16,16,,,,16,,,,,,,,,],[4,,13,,,,8,,,,11,,8,,13,,,,,,,,,,11,,16,,,,18,,,,11,,,,,,11,,11,,,,6,,8,,11,,8,,13,,,,,,,,,,,,]]],[0,1,2,2,3,3,2,3,3],125],403:[[[.6,0,220,,,.5,2,,,,,,,,,.2,,,,1],[.5,0,2100,,,.2,3,3,,,-400,,,2],[.5,0,440,,,1,1],[1.5,0,110,,,2,1,,,,,,,,,.1]],[[[,,13,,13,,13,,13,,13,,13,,13,,13,,11,,11,,11,,11,,11,,11,,11,,11,,9,,9,,9,,9,,9,,9,,9,,9,,8,,8,,8,,8,,8,,8,,8,,8,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,36,,25,25,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,36,,25,25,36,,,,]],[[,,13,,13,,13,,13,,13,,13,,13,,13,,11,,11,,11,,11,,11,,11,,11,,11,,9,,9,,9,,9,,9,,9,,9,,9,,8,,8,,8,,8,,8,,8,,8,,8,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,36,,25,25,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,36,,25,25,36,,,,],[3,,25,,,,28,,25,,28,,25,,32,,,,,,,,,,,,,,,,,,,,25,,,,28,,25,,28,,25,,20,,,,,,,,,,,,,,,,,,,,]],[[,,13,,13,,13,,13,,13,,13,,13,,13,,11,,11,,11,,11,,11,,11,,11,,11,,9,,9,,9,,9,,9,,9,,9,,9,,8,,8,,8,,8,,8,,8,,8,,8,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,36,,25,25,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,36,,25,25,36,,,,],[3,,25,,,,28,,25,,28,,25,,32,,,,,,,,,,,,,,,,,,,,25,,,,28,,25,,28,,25,,20,,,,,,,,,,,,,,,,,,,,],[2,,20,,,20,20,,,,20,,,,,,20,,18,,,18,18,,,,18,,,,,,18,,18,,,18,18,,,,18,,,,,,18,,21,,,21,21,,,,20,,,,,,,,,]],[[,,13,,13,,13,,13,,13,,13,,13,,13,,11,,11,,11,,11,,11,,11,,11,,11,,9,,9,,9,,9,,9,,9,,9,,9,,8,,8,,8,,8,,8,,8,,8,,8,,],[1,,,,,,36,,,,,,,,36,,,,,,,,36,,,,36,,25,25,36,,,,,,,,36,,,,,,,,36,,,,,,,,36,,,,36,,25,25,36,,,,],[3,,25,,,,28,,25,,28,,25,,32,,,,,,,,,,,,,,,,,,,,25,,,,28,,25,,28,,25,,20,,,,,,,,,,,,,,,,,,,,],[2,,20,,,20,20,,,,20,,,,,,20,,18,,,18,18,,,,18,,,,,,18,,18,,,18,18,,,,18,,,,,,18,,21,,,21,21,,,,20,,,,,,,,,],[2,,25,,,,25,,,,25,,,,25,,,,23,,,,23,,,,23,,,,23,,,,21,,,,21,,,,21,,,,21,,,,16,,,,16,,,,16,,,,16,,,,]]],[0,1,2,2,3,3,2,3,3],150]};let X,D;async function j(t="404"){if(t===X)return;X=t;const e=zzfxM(...U[t]);await q(),D=zzfxP(...e),D.loop=1}async function q(){D&&(D.volume.gain.setValueAtTime(1,zzfxX.currentTime),D.volume.gain.linearRampToValueAtTime(0,zzfxX.currentTime+3),await a(3e3),D.stop())}r.get("AHS")||setTimeout(()=>{r.set("OS13kMusic,404 - An HTTP Story",U[404]),r.set("OS13kMusic,401 - An HTTP Story",U[401]),r.set("OS13kMusic,403 - An HTTP Story",U[403])},0);class F{constructor(s){var a,c;this.o={},this.Nt=document.querySelector(".cv"),this.Bt=new t.Engine(this.Nt,1),this.Bt.runRenderLoop(()=>{this.t&&this.t.render()}),window.addEventListener("resize",()=>this.Bt.resize()),this.t=new t.Scene(this.Bt),this.Yt=new i(this.t),this.Wt=new n(this.t),this._=new h(this.Wt),this.At=new o(this.t),this.kt=new e(this.t),this.t.activeCamera=this.At,this.At.attachControl(this.Nt),this.xt=new G(this.t),this.$=new p(this.t,this.o),this.it=new R(this.t,this.o,this.$,this._),this.St=new E(this.o,this.it,this._),this.Gt=new C(this.o,this.kt,this.St,this.$,this.xt),a=this.t,c=this.xt,window.navigator.xr?a.createDefaultXRExperienceAsync({disableTeleportation:1,useMultiview:1}).then(e=>{const s=e.baseExperience;return s.onStateChangedObservable.add(e=>{e===t.WebXRState.IN_XR?c.Et(s.camera):e===t.WebXRState.NOT_IN_XR&&c.Et(0)}),s.onInitialXRPoseSetObservable.add(t=>{t.position.y=4,t.position.x=3,t.rotation.y=0}),s}):(console.log("No WebXR support"),Promise.resolve()),this.t.executeWhenReady(()=>{this.bt(s)}),l.on("next",()=>{this.bt(this.o.Lt+1)}),l.on("lost",()=>{const t=!this.o.Lt;r.set("OS13kTrophy,ðŸ‘,An HTTP Story,2 + 2 = 5","Your reeducation will begin immediately."),t?this.Ut():this.Ut("lose")})}bt(t){if("object"==typeof t)return r.set("OS13kTrophy,ðŸŒ,An HTTP Story,Builder of Worlds","90% consume, 9% comment, 1% create. You are the 1%."),j("404"),this.Gt.bt(t);const e=t,s=Object.keys(L).map(t=>parseInt(t)),i=Math.max(...s),n=L[e];n?(this.o.Lt=e,r.pushTo("AHS",this.o.Lt),e<3?j("404"):e<6?j("401"):e<i?j("403"):q(),this.Gt.bt(n)):this.o.Lt===i?(r.set("OS13kTrophy,ðŸ–,An HTTP Story,Out of the Sandbox","Um... Zyra isn't an AGI, right?"),this.Ut("win")):this.Ut()}async Ut(t){t&&r.set("AHS-ending",t),await this.Gt.Pt(),location.reload()}}const J=t=>document.querySelector(t),K=J(".cv"),V=J(".pg"),Z=J(".dr"),Q=J(".sh"),tt=J(".sm"),et=J(".st"),st=J(".db"),it=J(".dl"),nt=J(".ms"),ht=J(".md"),ot=J(".hp"),at=J(".mo"),rt=document.querySelectorAll(".cm");function ct(t=1){V.classList.add("h"),V.classList.remove("z"),st.classList.add("o"),ht.classList.add("h"),K.classList.remove("h"),new F(t)}function lt(t){const e=document.createElement("p");e.textContent="ðŸ“„ ";const s=document.createElement("a");s.textContent=`level_${t}.log`,s.href="#",s.addEventListener("click",()=>{ct(t)}),e.appendChild(s),Z.appendChild(e)}function ut(){document.querySelectorAll(".mn").forEach(t=>t.classList.add("h")),J(".my").classList.remove("h");const t=J(".cl");at.addEventListener("submit",e=>{let s;e.preventDefault();try{s=JSON.parse(t.value)}catch(e){console.log(e)}s&&(s.map=s.map.map(t=>t.map(t=>t.map(t=>v[t]))),ct(s))})}function wt(){const t=J(".nt"),e=J(".ls");nt.textContent="Unexpected error",t.classList.remove("o"),t.addEventListener("click",()=>{t.classList.add("o"),e.classList.remove("h"),j("401")})}function mt(){const t=J(".wn");nt.textContent="Click to open",it.classList.add("c"),it.addEventListener("click",()=>{t.classList.remove("h"),j()})}!async function(){r.get("AHS")||(ht.classList.remove("h"),ot.classList.remove("h")),r.get("AHS",[]).forEach(lt),async function(){let t;const e=r.get("AHS-ending");e&&("win"===e?t=mt:"lose"===e&&(t=wt),r.del("AHS-ending")),t&&(ht.classList.remove("h"),st.classList.remove("o"),nt.textContent="Preparing download...",await a(2e3),t())}(),function(){const t=document.monetization;t&&t.addEventListener("monetizationstart",ut)}(),rt.forEach(t=>{t.addEventListener("click",t=>{t.preventDefault(),t.target.parentElement.classList.add("h"),st.classList.add("o"),st.classList.remove("c"),ht.classList.add("h")})}),Q.addEventListener("click",()=>{ht.classList.remove("h"),ot.classList.remove("h")}),tt.addEventListener("click",()=>{ht.classList.remove("h"),at.classList.remove("h")}),et.addEventListener("click",async()=>{ht.classList.remove("h"),st.classList.remove("o"),nt.textContent="Preparing download...",await a(2e3),nt.textContent="Unexpected error",j(),await a(2e3),V.classList.add("z"),await a(4e3),ct()})}()})()})();