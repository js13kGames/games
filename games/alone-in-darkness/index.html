<!doctype html><style>*{margin:0;padding:0}*,::after,::before{box-sizing:border-box}body,html{height:100%}body{font-family:sans-serif;color:#fff;background:#000}body.phase-text #ikw{transform:translateY(0)}body.phase-text #to{display:block}body.pause #to{display:block}body.pause #to:after{display:block}body.pause #text{font-size:26px;line-height:1.3}body.phase-compass #compass{display:block}body.phase-compass #sb{display:none}b{color:#ff0}#wrapper{position:absolute;top:calc(50% - 500px);left:calc(50% - 700px);width:1400px;height:1000px}#game{width:1000px;height:1000px;background:#000;animation:shake 20s;animation-iteration-count:infinite;transition:transform .2s ease}#game.moving{animation-duration:8s}#game.sprinting{animation-duration:3s}@keyframes shake{0%{transform:translate(2px,2px) rotate(0)}10%{transform:translate(-2px,0) rotate(-.1deg)}20%{transform:translate(0,0) rotate(.1deg)}30%{transform:translate(0,2px) rotate(0)}40%{transform:translate(2px,-2px) rotate(.1deg)}50%{transform:translate(-2px,2px) rotate(-.1deg)}60%{transform:translate(0,2px) rotate(0)}70%{transform:translate(0,2px) rotate(-.1deg)}80%{transform:translate(-2px,-2px) rotate(.1deg)}90%{transform:translate(2px,-2px) rotate(0)}100%{transform:translate(2px,2px) rotate(-.1deg)}}#phone{display:inline-block;position:absolute;top:150px;right:20px;width:296px;height:614px;padding:73px 17px;border-radius:39px;background:#464646;box-shadow:inset 0 0 3px 0 rgba(0,0,0,.7)}#phone:before{width:calc(100% - 8px);height:calc(100% - 8px);position:absolute;top:4px;content:'';left:4px;border-radius:35px;background:#080808;z-index:1}#phone:after{width:calc(100% - 12px);height:calc(100% - 12px);position:absolute;top:6px;content:'';left:6px;border-radius:34px;box-shadow:inset 0 0 3px 0 rgba(0,0,0,.1),inset 0 0 6px 3px #212121;z-index:2}#sc{width:100%;position:relative;height:100%;z-index:3;background:#fff;overflow:hidden;display:block;border-radius:1px;background:#222}#pbb,#ptb{height:2px;background:#000;width:100%;display:block}#ph{border-radius:100%;width:47px;height:47px;position:absolute;left:50%;margin-left:-24px;bottom:15px;z-index:3;background:#080808;background:linear-gradient(135deg,#080808 0,#464646 50%,#080808 100%)}#ph:before{background:#080808;position:absolute;content:'';border-radius:100%;width:calc(100% - 6px);height:calc(100% - 6px);top:3px;left:3px}#ptb{height:10px;background:#212121;position:absolute;top:47px;left:0}#pbb{height:10px;background:#212121;position:absolute;bottom:47px;left:0}#sl{position:absolute;top:133px;right:-3px;width:3px;height:46px;border-radius:0 2px 2px 0;background:#464646}#pv{position:absolute;left:-3px;top:131px;z-index:0;height:46px;width:3px;border-radius:2px 0 0 2px;background:#464646}#pv:before{position:absolute;left:2px;top:-55px;height:28px;width:2px;border-radius:2px 0 0 2px;background:inherit;content:'';display:block}#pv:after{position:absolute;left:0;top:57px;height:46px;width:3px;border-radius:2px 0 0 2px;background:inherit;content:'';display:block}#pf{background:#080808;width:8px;height:8px;position:absolute;top:17px;left:50%;margin-left:-4px;border-radius:100%;z-index:3}#ps{background:#3c3d3d;width:11px;height:11px;position:absolute;top:34px;left:94px;z-index:3;border-radius:100%}#pk{background:#292728;width:49px;height:4px;position:absolute;top:38px;left:calc(50% - 25px);border-radius:4px;z-index:3}.pa{position:relative;display:inline-block;vertical-align:top;width:27.3333%;margin:5% 3%;padding-top:27.3333%;background:#ccc;border-radius:15%}.pa b{position:absolute;bottom:-15px;left:0;right:0;font-size:11px;color:#fff;text-align:center;font-weight:400}.pa:not(#pe){cursor:pointer}.pa:not(#pe):hover{opacity:.8}.phi{position:absolute;top:20px;left:30px;background-color:#c44;display:inline-block;height:20px;transform:rotate(-45deg);width:20px}.phi::after,.phi::before{content:"";background-color:#c44;border-radius:50%;height:20px;position:absolute;width:20px}.phi::before{top:-10px;left:0}.phi::after{left:10px;top:0}#pc{background:#a93}#pci{position:absolute;display:block;top:20px;left:20%;width:60%;height:40%;background-color:#000;border-radius:5px}#pci::after{content:"";display:block;width:22px;height:22px;border:4px solid #a93;position:absolute;top:10%;left:calc(50% - 11px);background-color:#000;border-radius:50%}#pci::before{content:"";display:block;width:50%;height:7px;position:absolute;top:-16%;left:25%;background-color:#000;border-radius:10px}#pl{background:#19c}#pli{position:absolute;display:block;top:15px;left:33px;width:10px;height:42px;background-image:linear-gradient(to bottom,#000 38px,rgba(0,0,0,0) 38px,rgba(0,0,0,0) 40px,#000 40px,#000 42px)}#pli::before{content:'';height:7px;display:block;position:relative;left:-8px;top:-8px;border-top:28px solid #000;border-right:13px solid transparent;border-left:13px solid transparent}#pli::after{content:'';display:block}#so{background:#e86;color:#000}.psi{position:absolute;top:0;left:0;right:0;text-align:center;font-size:50px;line-height:66px}.ge{display:inline-block;position:absolute;top:9px;right:12px;margin:3.6px;width:18px;height:18px;background:#fff;border-radius:50%;border:5.14286px solid gray;box-sizing:border-box;font-size:18px;z-index:2}.ge:after,.ge:before{content:'×';position:absolute;z-index:-1;top:50%;left:50%;transform:translate(-50%,-50%);font-family:"times new roman";font-weight:700;font-size:250%;color:gray}.ge:after{transform:translate(-50%,-50%) rotate(45deg)}.ge+.ge{position:absolute;top:30px;right:30px;transform:scale(1.5) rotate(13deg)}#no{background-image:linear-gradient(to bottom,#fd2 0,#ec3 20px,#aaa 21px,#fff 21px,#fff 32px,#aaa 33px,#fff 34px,#fff 46px,#aaa 47px,#fff 48px,#fff 60px,#aaa 61px,#fff 62px)}#notes{position:absolute;bottom:0;left:0;right:0;color:#000;padding:20px;font-size:20px;line-height:1.5;font-style:italic;background:#fd2;z-index:2;transition:all .3s}#notes:not(.visible){transform:translateY(100%)}#notes::before{content:'';position:absolute;display:block;top:45px;left:0;right:0;height:1px;background:#999;box-shadow:0 60px 0 0 #999,0 90px 0 0 #999,0 120px 0 0 #999}#music,#settings{position:absolute;bottom:0;left:0;right:0;color:#000;padding:80px 20px;font-size:20px;line-height:1.5;font-style:italic;transition:all .3s;background:#e86;z-index:3}#music:not(.visible),#settings:not(.visible){transform:translateY(100%)}#settings{background:#ccc;padding:50px 20px;font-size:18px}#settings b{color:#000}#compass{display:none;position:absolute;bottom:61px;left:61px;width:140px;height:140px;border-radius:50%;margin:0 auto;border:10px solid #333;background:#000;box-shadow:0 0 3px #000,0 0 1px 7px #222}#compass::after,#compass::before{content:'';position:absolute;border-radius:50%}#compass::before{border:2px dashed #444;left:7px;right:7px;bottom:7px;top:7px}#compass::after{left:-7px;right:-7px;bottom:-7px;top:-7px;background:linear-gradient(-45deg,rgba(255,255,255,.2) 0,rgba(255,255,255,.05) 47%,rgba(255,255,255,0) 48%,rgba(255,255,255,0) 100%)}#compass span{position:absolute;font-size:10px;font-weight:700;color:#666}#compass span:first-child{top:14px;left:57px}#compass span:nth-child(3){bottom:14px;left:57px}#compass span:nth-child(2){top:57px;right:20px}#compass span:nth-child(4){top:57px;left:20px}@keyframes compass-rotate{from{transform:rotate(-15deg)}to{transform:rotate(15deg)}}#cpw{position:relative;width:42px;height:21px;left:calc(50% - 21px);top:calc(50% - 12px);transform:rotate(-104deg)}#cp{position:relative;width:42px;height:21px;left:calc(50% - 21px);top:calc(50% - 12px);animation:compass-rotate 4s cubic-bezier(.7,0,.3,1) infinite alternate}#cp::before{content:'';position:absolute;left:0;right:0;top:0;bottom:0;background:linear-gradient(-63deg,#4fbcf2 1%,#1a6ece 50%,#d8d8d8 51%,#f45e50 53%,#ff2d2d 100%);transform:skewX(60deg)}#cp::after{content:'';width:7px;height:7px;background:#4781c0;border-radius:50%;box-shadow:inset 0 0 4px 2px #4d4d4d,0 0 5px 1px #fff;position:absolute;left:calc(50% - 3.5px);top:calc(50% - 3.5px)}#sb{position:absolute;bottom:99px;left:calc(50% - 60px);height:85px;width:120px}#sb p{width:16%;margin:0 2%;display:inline-block;background-color:#fff;border:1px solid #eee}#sb-1{height:20%}#sb-2{height:40%}#sb-3{height:60%}#sb-4{height:80%}#sb-5{height:99%}#sb[data-level="1"]{animation:blink 2s infinite}#sb[data-level="1"] p:first-child{background-color:#e44;border:thin solid #b11}#sb[data-level="2"]{animation:blink 2s infinite}#sb[data-level="2"] p:nth-child(-n+2){background-color:#e44;border:thin solid #b11}#sb[data-level="3"] p:nth-child(-n+3){background-color:#fc1;border:thin solid #ecba00}#sb[data-level="4"] p:nth-child(-n+4){background-color:#fc1;border:thin solid #ecba00}#sb[data-level="5"] p{background-color:#2a8;border:thin solid #1c8c70}.ok .bar{background-color:#fc1;border:thin solid #ecba00}@keyframes blink{0%{opacity:1}49%{opacity:1}50%{opacity:0}100%{opacity:0}}#ikw{position:absolute;bottom:0;left:0;right:0;transform:translateY(100%);transition:transform .3s ease}#ik{border-top:1px solid #3a3d42;background-image:linear-gradient(to bottom,#9098a3,#454f5d);padding:2% 0 1%}#ik li{text-align:center;list-style:none;padding:1% 2%}#ik button{display:inline-block;width:8.5%;margin:0 .25%;padding:3% 0;color:#000;font-weight:700;font-size:16px;color:#3a3d42;text-decoration:none;text-align:center;text-shadow:0 1px 1px #fff;border:0;border-top:1px solid rgba(255,255,255,.45);background:#ecedef;background-image:linear-gradient(to bottom,#f8f8f9,#dddfe1);border-radius:3px;box-shadow:0 1px 3px rgba(0,0,0,.7),0 1px 0 rgba(0,0,0,.3)}#ik button.active,#ik button:active{background-image:linear-gradient(to bottom,#e2e3e4,#aaadb4)}#ik .space{margin-top:2%;width:65%;padding:2% 0}#to{position:absolute;top:0;left:0;width:1000px;height:1000px;background:rgba(0,0,0,.8);display:none}#to::after{display:none;content:'Press Enter to continue';position:absolute;bottom:200px;right:0;font-size:20px}.text{padding-top:300px;font-size:40px;text-align:center;letter-spacing:3px}.text span{display:inline-block;vertical-align:baseline;transition:all .4s ease}.text span.current{border-bottom:2px solid #ff0}.text span.checked{opacity:0;transform:translateY(-100px)}.text em{font-size:70%}#cd{background:#000;font-size:27px;padding:7px 0;margin-bottom:-1px;text-align:center}#cd span{display:inline-block;vertical-align:middle;margin:0 7px;width:43px;text-align:right;font-size:42px}progress{position:absolute;bottom:4px;left:calc(50% - 25px);height:6px;background:#444;border-radius:3px;width:50px}progress::-webkit-progress-bar{border-radius:3px;background:#777}progress::-webkit-progress-value{border-radius:3px;background:#161}progress.off::-webkit-progress-value{background:#611}</style><div id=wrapper><canvas id=game width=1000 height=1000></canvas><div id=phone><div id=ptb></div><div id=sl></div><div id=pv></div><div id=pf></div><div id=ps></div><div id=pk></div><div id=sc><div class=pa id=pe><p class=phi></p><progress min=0 max=100 value=100></progress><b>Sprint</b></div><div id=pl class=pa><p id=pli></p><progress min=0 max=100 value=100></progress><b>Flashlight</b></div><div class=pa id=pc><p id=pci></p><progress min=0 max=100 value=100></progress><b>Camera</b></div><div class=pa id=no><b>Notes</b></div><div class=pa id=se><p class=ge><p class=ge></p><b>Settings</b></div><div id=so class=pa><p class=psi>♫</p><b>Music</b></div><div id=compass><span>N</span> <span>E</span> <span>S</span> <span>W</span><div id=cpw><p id=cp></div></div><div id=notes>TODO LIST:<br><br>1/ Find 5 bar signal<br>2/ Type message<br>3/ Find Exit</div><div id=settings><b>Move</b>:<br>arrows, ZQSD, WASD<br><b>Sprint</b>: shift<br><b>Flashlight</b>: F<br><b>Camera flash</b>: spacebar<br></div><div id=music>You are offline, you can't access your music</div><div id=sb data-level=1><p id=sb-1><p id=sb-2><p id=sb-3><p id=sb-4><p id=sb-5></div><div id=ikw><p id=cd><ul id=ik></ul></div></div><div id=ph></div><div id=pbb></div></div><div id=to><p id=text class=text></div></div><script>!function(){"use strict";var e,t,a,o,n,i,r,s,l,y=function(e){return document.getElementById(e)},h=y("wrapper"),c=y("game"),x=y("sb"),m=y("cpw"),f=y("pl").querySelector("progress"),u=y("pe").querySelector("progress"),d=y("pc").querySelector("progress"),v=c.getContext("2d"),b=0;new Date;const g="#eee",p=250;var w=c.width/2,M=c.height/2;const I=0;var L,k,P,S,C,T,q,A=0,E=1,D=1,R={x:500,y:250},F=!1,H=!1,O=!1,z=!1,W=!1,$=!1,K=0,G=0,N=+new Date,U=0,B=0,Q=0,Y=1,Z=!1;const J=1.5,V=3.5,X=2,j=100,_=180,ee=60,te=40,ae=60,oe=90,ne=45,ie=150,re=600,se=400;var le,ye=["Hello from the other side","I must have called a thousand times","I'll send an SOS to the world","Lorem ipsum dolor sit amet","Hello darkness, my old friend","I'm still standing yeah yeah yeah","Freedom!"],he=[[{x:0,y:0},{x:1e3,y:0},{x:1e3,y:1e3},{x:0,y:1e3},{x:0,y:0}],[{x:0,y:100},{x:75,y:100}],[{x:125,y:100},{x:225,y:100}],[{x:200,y:0},{x:200,y:100}],[{x:275,y:100},{x:350,y:100}],[{x:350,y:0},{x:350,y:450},{x:600,y:450},{x:600,y:500},{x:800,y:500},{x:800,y:525}],[{x:350,y:350},{x:100,y:350},{x:100,y:600},{x:225,y:600}],[{x:225,y:700},{x:100,y:700},{x:100,y:900},{x:525,y:900}],[{x:575,y:900},{x:650,y:900}],[{x:650,y:1e3},{x:650,y:775}],[{x:650,y:725},{x:650,y:700}],[{x:275,y:700},{x:775,y:700}],[{x:825,y:700},{x:900,y:700}],[{x:0,y:400},{x:25,y:400}],[{x:75,y:400},{x:100,y:400}],[{x:0,y:800},{x:25,y:800}],[{x:75,y:800},{x:100,y:800}],[{x:275,y:600},{x:525,y:600}],[{x:575,y:600},{x:800,y:600},{x:800,y:575}],[{x:350,y:600},{x:350,y:550}],[{x:350,y:500},{x:350,y:450}],[{x:500,y:450},{x:500,y:600}],[{x:450,y:325},{x:450,y:100},{x:800,y:100},{x:800,y:175}],[{x:450,y:375},{x:450,y:400},{x:625,y:400}],[{x:675,y:400},{x:700,y:400},{x:700,y:300},{x:800,y:300}],[{x:800,y:225},{x:800,y:500}],[{x:900,y:0},{x:900,y:50}],[{x:600,y:100},{x:600,y:225}],[{x:600,y:275},{x:600,y:400}],[{x:900,y:100},{x:900,y:225}],[{x:900,y:175},{x:1e3,y:175}],[{x:900,y:500},{x:1e3,y:500}],[{x:900,y:275},{x:900,y:575}],[{x:900,y:625},{x:900,y:900},{x:700,y:900}],[{x:200,y:400},{x:250,y:400},{x:250,y:500},{x:200,y:500},{x:200,y:400}],[{x:100,y:200},{x:250,y:200},{x:250,y:225},{x:100,y:225},{x:100,y:200}],[{x:400,y:900},{x:400,y:775},{x:450,y:775},{x:450,y:900}]],ce={x:970,y:920,w:50,h:75};function xe(){var e=1400/window.innerWidth,t=1020/window.innerHeight,a=Math.min(1.2,1/Math.max(e,t));h.style.webkitTransform=h.style.transform="scale("+a+")"}function me(){v.drawImage(le,w+a,M+o)}function fe(){return i>=a+ce.x-ce.w/2&&i<=a+ce.x+ce.w/2&&r>=o+ce.y+25}function ue(e){for(var t=0;t<e.length;t+=4)if(102===e[t]&&102===e[t+1]&&102===e[t+2])return!0;return!1}function de(e,t){var a=e[0].x,o=e[0].y,n=e[1].x-e[0].x,i=e[1].y-e[0].y,r=t[0].x,s=t[0].y,l=t[1].x-t[0].x,y=t[1].y-t[0].y,h=Math.sqrt(n*n+i*i),c=Math.sqrt(l*l+y*y);if(n/h==l/c&&i/h==y/c)return null;var x=(n*(s-o)+i*(a-r))/(l*i-y*n),m=(r+l*x-a)/n;return m<0||x<0||x>1?null:{x:a+n*m,y:o+i*m,param:m}}CanvasRenderingContext2D.prototype.roundRect=function(e,t,a,o,n){return a<2*n&&(n=a/2),o<2*n&&(n=o/2),this.beginPath(),this.moveTo(e+n,t),this.arcTo(e+a,t,e+a,t+o,n),this.arcTo(e+a,t+o,e,t+o,n),this.arcTo(e,t+o,e,t,n),this.arcTo(e,t,e+a,t,n),this.closePath(),this};const ve=700;function be(e,t){var n=[],s=[];he.forEach((e=>{e.forEach((e=>{s.indexOf(e.x+"-"+e.y)<0&&e.x+ve>i-a&&e.x-ve<i-a&&e.y+ve>r-o&&e.y-ve<r-o&&(s.push(e.x+"-"+e.y),n.push(e))}))}));for(var l=[],y=0;y<n.length;++y){var h=n[y],c=Math.atan2(h.y-t,h.x-e);h.angle=c,l.push(c-1e-5,c,c+1e-5)}var x=[];for(y=0;y<l.length;++y){c=l[y];var m,f=[{x:e,y:t},{x:e+Math.cos(c),y:t+Math.sin(c)}],u=null;Math.max(0,i-a-ve),Math.min(1e3,i-a+ve),Math.max(0,r-o-ve),Math.min(1e3,r-o+ve),he.forEach((e=>{for(var t=0;t<e.length-1;++t)if((m=[e[t],e[t+1]])[0].x+ve>i-a&&m[0].x-ve<i-a&&m[0].y+ve>r-o&&m[0].y-ve<r-o||m[1].x+ve>i-a&&m[1].x-ve<i-a&&m[1].y+ve>r-o&&m[1].y-ve<r-o){var n=de(f,m);if(!n)continue;(!u||n.param<u.param)&&(u=n)}})),u&&(u.angle=c,x.push(u))}return x.sort((function(e,t){return e.angle-t.angle}))}var ge,pe,we,Me,Ie;function Le(e,t,n){t.fillStyle=n,t.beginPath(),t.moveTo(w+a+e[0].x,M+o+e[0].y);for(var i=1;i<e.length;++i){var r=e[i];t.lineTo(w+a+r.x,M+o+r.y)}t.fill()}function ke(){for(var e=ye[A],t="",a=0;a<e.length;++a){var o=" "===e.charAt(a)?"&nbsp;":e.charAt(a);t+=`<span${0===a?' class="current"':""} data-val="${e.charAt(a)}">${o}</span>`}y("text").innerHTML=t}function Pe(){++E,Ae()}function Se(){v.save(),e.forEach(((e,t)=>{var n=Math.sqrt(Math.pow(o+e.y-r-G,2)+Math.pow(a+e.x-i-K,2)),s=Math.sqrt(Math.pow(o+e.y-r,2)+Math.pow(a+e.x-i,2)),l=C?se:F?_:j;if(s<20)qe(!0);else{if(n<l+20){if(n<l-5&&2!==E){if(!C&&(e.v||(e.v=+new Date+1e3),N>=e.v)){var y=Math.atan2(o+e.y-r,a+e.x-i);e.x-=X*Math.cos(y),e.y-=X*Math.sin(y)}e.s||(e.s=!0)}v.beginPath(),v.fillStyle="#000";var h=w+a+e.x,c=M+o+e.y,x=15,m=Math.abs(Math.floor(N/200+2*t)%16-8)-4;v.moveTo(h-x,c),v.bezierCurveTo(h-x,c-x+m,h+x+m,c-x-m,h+x,c),v.bezierCurveTo(h+x,c+x-m,h-x,c+x,h-x,c),v.fill()}e.s&&(v.beginPath(),v.fillStyle="#fff",v.arc(w+a+e.x+2,M+o+e.y,1,0,2*Math.PI,!1),v.arc(w+a+e.x-2,M+o+e.y,1,0,2*Math.PI,!1),v.fill())}})),v.restore()}function Ce(){100===q&&(C=!0,T=0,d.classList.add("off"),d.value=0,q=0)}function Te(){var e=N;N=new Date,U=N-e,requestAnimationFrame(Te),function(){B=O?-1:z?1:0,Q=W?-1:$?1:0,v.clearRect(0,0,c.width,c.height),v.fillStyle="#000",v.fillRect(0,0,c.width,c.height);var e,t,y,[h,L]=function(){var e=B*(n?V:J),t=Q*(n?V:J);me();var a=w+i-11,o=M+r-11,s=v.getImageData(a+e,o+t,22,22).data;if(ue(s)){if(0!==B)do{e-=B,s=v.getImageData(a+e,o,22,22).data}while(ue(s)&&e*B>0);if(0!==Q)do{t-=Q,s=v.getImageData(a,o+t,22,22).data}while(ue(s)&&t*Q>0)}return[e,t]}(),A=U/30;0!==B?(B>0&&i<p||B<0&&i>-p?i+=h:a-=h,K=Math.min(20,Math.max(K+A*B,-20))):K=K>0?Math.max(0,K-A):Math.min(0,K+A),0!==Q?(Q>0&&r<p||Q<0&&r>-p?r+=L:o-=L,G=Math.min(20,Math.max(G+A*Q,-20))):G=G>0?Math.max(0,G-A):Math.min(0,G+A),q<100&&(q=Math.min(100,q+U/ie),d.value=q,100===q&&d.classList.remove("off")),function(){var e=[be(i-a+K/8,r-o+G/8)];if(F)var t=10;else t=7;for(var n=0;n<2*Math.PI;n+=2*Math.PI/10){var s=Math.cos(n)*t,l=Math.sin(n)*t;e.push(be(i-a+K/8+s,r-o+G/8+l))}for(var y=1;y<e.length;++y)Le(e[y],v,"rgba(255,255,255,0.08)");Le(e[0],v,g)}(),me(),v.globalCompositeOperation="source-over",function(){var e=w+i,t=M+r;0!==B||0!==Q?(b+=U,s=-90*B,0!==Q&&(0===s?s=-90*Q+90:s+=45*Q*B)):b=0;var a=5*Math.sin(Math.floor(b/(n?50:150)));n?(P=Math.max(0,P-U/ae))<=0&&(u.classList.add("off"),n=!1,S=!1):(P=Math.min(100,P+U/oe),!S&&P>ne&&(u.classList.remove("off"),S=!0)),u.value=P,v.save(),v.translate(e,t),v.rotate(s*Math.PI/180),v.rotate(a*Math.PI/180),v.fillStyle="#444",v.roundRect(-15,-6,30,12,20).fill(),v.rotate(-a*Math.PI/180),v.drawImage(l,-25,-25),v.restore()}(),C?(T+=U)>re&&(C=!1):function(){var e=document.createElement("canvas");e.width=c.width,e.height=c.height;var t=e.getContext("2d");if(F){var a=_,o=.8;(k=Math.max(0,k-U/ee))<=0&&(F=!1)}else a=j,o=.6,k=Math.min(100,k+U/te);f.value=k;var n=I;t.fillStyle="rgba(0, 0, 0, "+(1-n/100)+")",t.fillRect(0,0,c.width,c.height);var s=w+i,l=M+r,y=t.createRadialGradient(s+K,l+G,0,s+K,l+G,Math.floor(1e3*a)/1e3);y.addColorStop(0,"rgba(0,0,0,1)"),y.addColorStop(o,"rgba(0,0,0,.95)"),y.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=y,t.globalCompositeOperation="destination-out",t.fillRect(s-a+K,l-a+G,2*a,2*a),v.drawImage(e,0,0)}(),Se(),1===E?((y=Math.sqrt(Math.pow(i-(a+R.x),2)+Math.pow(r-(o+R.y),2)))<50?(t=5,Pe()):t=y<250?4:y<400?3:y<700?2:1,D!==t&&(x.setAttribute("data-level",t),D=t),!Z&&fe()&&(Z=!0,Ae(2))):3===E&&(e=180*Math.atan2(o+ce.y-r,a+ce.x-i)/Math.PI-14,m.style.transform="rotate("+e+"deg)",fe()&&function(){if(H)return E=4,void Ae();++Y,qe()}())}()}function qe(t){F=!1,Y%2==1?(a=-50,o=-50):(a=-50,o=-950),n=!1,i=0,r=0,s=0,k=100,P=100,S=!0,C=!1,T=0,q=100,Z=!1,d.value=q,d.classList.remove("off"),e=[{x:80,y:280},{x:50,y:700},{x:640,y:690},{x:450,y:30},{x:980,y:520},{x:700,y:850},{x:480,y:980},{x:720,y:450},{x:620,y:140}],t?Ae(1):(E=1,document.body.classList.remove("phase-compass"),Ae())}function Ae(e){document.body.classList.add("pause"),t=!0;var a="Ok...<br>\nI'm here, alone, with my phone, offline.<br>\n<br>\nNothing broken, I can <b>move</b> <em>(arrows, ZQSD, WASD)</em>,<br>\nor <b>sprint</b> <em>(shift, controlled by my health app)</em><br>\nI can use  my <b>Flashlight</b> <em>(F, or click on the app)</em><br><br>\nI have to find network with 5 bars using my <b>phone signal</b><br><br>\nI've seen some shadows moving, they seem to be attracted by light.<br>\nI should avoid them, or detect them with my <b>camera flash</b> <em>(spacebar, or click on the app)</em>";Y>1&&(a="I'm on another stage, I have to find the <b>signal</b> on this one before leaving."),e?(1===e&&(a="That shadow put me back to my initial point.<br>I have to find my way back!"),2===e&&(a="I have to find a place where signal has 5 bars before leaving this stage"),3===e&&(a="I have to find a place where signal has 5 bars before leaving this stage")):(2===E&&(a="I've found network!<br>I have to <b>type</b> my message quickly before signal disappear!<br><em>(use keyboard to rewrite text)</em>"),3===E&&(a=H?"I've send my message! When I'll have left that floor I'll be free!":"Damn! Not enough signal to send my message.",a+="<br>I have to use my <b>compass</b> to find the exit, pointing in blue direction"),4===E&&(a="Congratulations!<br> You are now free, and can go back online!<br><br>Thank you for playing!")),y("text").innerHTML=a}y("pl").onclick=()=>{t||(F=!F)},y("pc").onclick=()=>{t||Ce()},y("no").onclick=()=>{y("music").classList.remove("visible"),y("settings").classList.remove("visible"),y("notes").classList.toggle("visible"),clearTimeout(ge),ge=setTimeout((()=>{y("notes").classList.remove("visible")}),5e3)},y("se").onclick=()=>{y("music").classList.remove("visible"),y("notes").classList.remove("visible"),y("settings").classList.toggle("visible"),clearTimeout(pe),pe=setTimeout((()=>{y("settings").classList.remove("visible")}),5e3)},y("so").onclick=()=>{y("music").classList.toggle("visible"),y("settings").classList.remove("visible"),y("notes").classList.remove("visible"),clearTimeout(we),we=setTimeout((()=>{y("music").classList.remove("visible")}),5e3)},document.onkeydown=function(e){var a=e.keyCode,o=e.key.toLowerCase();if(t)13===a&&(document.body.classList.remove("pause"),t=!1,2===E&&function(){var e;document.body.classList.add("phase-text"),ke(),e=+new Date,L=setInterval((function(){var t=Math.max(0,3e4-N+e),a=Math.floor(t/1e3%100),o=Math.floor(t/10%100);y("cd").innerHTML="<span>00</span>:<span>"+("0"+a).substr(-2)+"</span>:<span>"+("0"+o).substr(-2)+"</span>",t<=0&&(clearInterval(L),Pe())}),10)}(),3===E&&(document.body.classList.remove("phase-text"),document.body.classList.add("phase-compass")),4==E&&(Y=1,A=0,E=1,qe()));else if(2===E){!function(e){var t=y("text").querySelector(".current");e.toLowerCase()===t.getAttribute("data-val").toLowerCase()&&(t.classList.remove("current"),t.classList.add("checked"),t.nextElementSibling?t.nextElementSibling.classList.add("current"):++A<ye.length?ke():(H=!0,clearInterval(L),Pe()))}(e.key);var i=y("ik").querySelector('button[data-char="'+e.key.toUpperCase()+'"');i&&i.classList.add("active")}else 39===a||"d"===o?z=1:37!==a&&"q"!==o&&"a"!==o||(B=-1,O=1),38===a||"z"===o||"w"===o?W=1:40!==a&&"s"!==o||($=1),0===B&&0===Q||(c.classList.add(e.shiftKey?"sprinting":"moving"),e.shiftKey&&(S||P>ne)&&(n=!0))},document.onkeypress=function(e){2===E||t||("f"===e.key.toLowerCase()&&(F=!F),32===e.keyCode&&Ce())},document.onkeyup=function(e){var t=e.keyCode,a=e.key.toLowerCase();if(39===t||"d"===a?z=0:37!==t&&"q"!==a&&"a"!==a||(O=0),38===t||"z"===a||"w"===a?W=0:40!==t&&"s"!==a||($=0),e.shiftKey||(n=!1),c.classList.remove("moving","sprinting"),2===E){var o=y("ik").querySelector('button[data-char="'+e.key.toUpperCase()+'"');o&&o.classList.remove("active")}},window.addEventListener("resize",(function(e){xe()})),window.requestAnimationFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.msRequestAnimationFrame,window.onload=function(){Te()},qe(),xe(),function(){he.push([{x:ce.x-ce.w/2,y:ce.y},{x:ce.x-ce.w/2,y:ce.y+ce.h},{x:ce.x+ce.w/2,y:ce.y+ce.h},{x:ce.x+ce.w/2,y:ce.y}]),(le=document.createElement("canvas")).width=1e3,le.height=1e3;var e,t=le.getContext("2d");e=t,he.forEach((t=>{e.strokeStyle="#666",e.lineWidth=6,t.forEach(((a,o)=>{0===o?(e.beginPath(),e.moveTo(a.x,+a.y)):e.lineTo(a.x,+a.y),o===t.length-1&&e.stroke()}))})),function(e){for(var t=ce.x-ce.w/2,a=ce.y,o=0;o<=4;++o){var n=e.createLinearGradient(t,a+15*o,t,a+15*(o+1));n.addColorStop(0,"black"),n.addColorStop(1,"white"),e.fillStyle=n,e.fillRect(t,a+15*o,50,15)}}(t)}(),Me=y("ik"),Ie="",["QWERTYUIOP","ASDFGHJKL","ZXCVBNM,.'"].forEach((e=>{Ie+="<li>";for(var t=0;t<e.length;++t)Ie+=`<button type="button" data-char="${e.charAt(t)}">${e.charAt(t)}</button>`;Ie+="</li>"})),Ie+='<li>\n        <button type="button" class="space" data-char=" ">space</button>\n    </li>',Me.innerHTML=Ie,function(){(l=document.createElement("canvas")).width=50,l.height=50;var e=l.getContext("2d");e.fillStyle="#A42",e.beginPath(),e.arc(25,25,10,.75*Math.PI,2.25*Math.PI,!1),e.fill(),e.fillStyle="#feab75",e.globalCompositeOperation="source-atop",e.beginPath(),e.arc(18.5,31,7,0,2*Math.PI,!1),e.arc(31.5,31,7,0,2*Math.PI,!1),e.fill(),e.globalCompositeOperation="source-over",e.beginPath(),e.arc(25,33,3,0,2*Math.PI,!1),e.fill(),e.fillStyle="#fff",e.beginPath(),e.arc(20,30,2,0,2*Math.PI,!1),e.arc(30,30,2,0,2*Math.PI,!1),e.fill(),e.fillStyle="#77F",e.beginPath(),e.arc(20,32,1,0,2*Math.PI,!1),e.arc(30,32,1,0,2*Math.PI,!1),e.fill(),e.strokeStyle="#A42",e.lineWidth=1,e.beginPath(),e.arc(20,30,2,1.2*Math.PI,1.8*Math.PI,!1),e.stroke(),e.beginPath(),e.arc(30,30,2,1.2*Math.PI,1.8*Math.PI,!1),e.stroke()}(),Ae()}()</script>