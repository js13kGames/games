<!doctype html><style>body,html{height:100vh;margin:0;padding:0}*{font:normal 24px sans-serif;text-align:center;color:#fff}#c{display:block;margin:0 auto;position:absolute;top:0;left:0;touch-action:none}body{background:#3230b3;min-height:100vh}#VRButton,button{padding:12px 24px;border:2px solid rgb(255 255 255 / .8);border-radius:2px;background:#ef3eda;outline:0;box-shadow:0 4px 12px rgb(0 0 0 / .3);transition:all .2s ease;font-weight:700;text-transform:uppercase;letter-spacing:1px}#VRButton:hover,button:hover{transform:translateY(-2px);box-shadow:0 6px 16px rgb(0 0 0 / .4);border-color:#fff}#VRButton:active,button:active{transform:translateY(0);box-shadow:0 2px 8px rgb(0 0 0 / .3);border-color:rgb(255 255 255 / .9)}#VRButton{position:absolute;bottom:20px;left:0;right:0;margin:0 auto;width:fit-content;z-index:999;cursor:pointer;display:none}#VRButton[data-disabled=true]{cursor:auto}.webxr-message{position:absolute;bottom:20px;left:0;right:0;margin:0 auto;width:fit-content;z-index:999;text-decoration:none}</style><canvas id=c style=display:none></canvas><div id=i><h1>AL13YCAT</h1><button id=p style=display:none>JOIN</button></div><script type=module>import*as t from"/2025/webxr/three.module.js";class e{static t;o;constructor(){this.o={}}static get Instance(){return e.t||(e.t=new e),e.t}on(t,e){this.o[t]=this.o[t]||[],this.o[t].push(e)}off(t,e){this.o[t]=(this.o[t]||[]).filter(t=>t!==e)}emit(t,...e){(this.o[t]||[]).forEach(t=>t(...e))}h(){Object.keys(this.o).forEach(t=>{delete this.o[t]})}getCallbacks(){return this.o}}const n="#e81416",o="#ffa500",s="#faeb36",i="#79c314",r="#487de7",c="#70369d",a="#ffffff",h="#000000",l="#ff00ff",w="#abb7d0",u="#42485d",d="#ff3b94",f="#ffcc00",p="#f6ff00",v="#a6fd29",M="#8ea5ff",m="#200589",y="#39013a",g="#333333",b="#888888",S={"Light Blue":"#9999ff",Yellow:"#fffb00",Orange:"#ff7300",Red:"#ff0000",Purple:"#c300ff",Blue:"#0000ff",Green:"#00ff00",Lime:"#b0ffb0",Pink:"#ff00ff",Silver:"#d3d3d3"},A={color:d,artist:v,title:M},O=[n,o,s,i,r,c],R=["Red","Orange","Yellow","Green","Blue","Violet"],C=["Shiny Toy Guns","B.B. King","Jack White","Black Sabbath","Faith Hill","Cliff Sheen"],B=["OFFSIDE","SHOWCASE","LOADOUT","BACKHAND","BOOKMARKS","MANPOWER"],T={color:R,artist:C,title:B},_={color:42,artist:24,title:34},x=[[0,1,2,3,4,5],[0,2,4,1,5,3],[0,3,5,1,4,2]],P=["color","artist","title"];class k{l;selected;vinyls;progress;constructor(){this.l=[],this.selected={},this.vinyls=[],this.reset()}addVinylByIndex(t){if(this.l[0]===t)return;this.l.unshift(t);const{color:n,artist:o,title:s}=this.vinyls[t],i=R.indexOf(n),r=C.indexOf(o),c=B.indexOf(s);this.progress.color.solved||i!==this.progress.color.currentIndex+1?(this.progress.color.correctCount=0,this.progress.color.currentIndex=-1):(this.progress.color.correctCount++,this.progress.color.correctCount===R.length&&(this.progress.color.solved=!0),e.Instance.emit(9),this.progress.color.currentIndex=i),this.progress.artist.solved||r!==(this.progress.artist.currentIndex+1)%C.length?this.progress.artist.correctCount=1:(this.progress.artist.correctCount++,this.progress.artist.correctCount===C.length&&(this.progress.artist.solved=!0),e.Instance.emit(9)),this.progress.artist.currentIndex=r,this.progress.title.solved||c!==(this.progress.title.currentIndex+1)%B.length?this.progress.title.correctCount=1:(this.progress.title.correctCount++,this.progress.title.correctCount===B.length&&(this.progress.title.solved=!0),e.Instance.emit(9)),this.progress.title.currentIndex=c;const a=Math.max(this.progress.color.correctCount,this.progress.artist.correctCount,this.progress.title.correctCount);e.Instance.emit(1,6>this.progress.bestComboCount&&this.progress.bestComboCount>a),this.progress.bestComboCount=a,this.progress.bestComboType=this.progress.color.correctCount!==this.progress.bestComboCount||this.progress.color.solved?this.progress.artist.correctCount!==this.progress.bestComboCount||this.progress.artist.solved?"title":"artist":"color",this.progress.bestComboUsedVinyls=this.l.slice(0,this.progress.bestComboCount),this.progress.displayText=this.getDisplayText(),e.Instance.emit(5,this.progress)}isSolved(t){return t?this.progress[t].solved:this.progress.color.solved&&this.progress.artist.solved&&this.progress.title.solved}getDisplayText(){const{currentIndex:t,correctCount:e}=this.progress[this.progress.bestComboType],n=T[this.progress.bestComboType];let o=this.l.slice(0,e).reverse().map(t=>this.vinyls[t][this.progress.bestComboType]);if(0===e)return"Select a record to play → → → → →";for(let o=0;e>o;o++){let e=t-o;0>e&&(e+=n.length)}return this.progress.color.solved&&this.progress.artist.solved&&this.progress.title.solved?"🎉 Game Over 🎉":6===this.progress.color.correctCount||6===this.progress.artist.correctCount||6===this.progress.title.correctCount?"🎉 Sequence Complete 🎉":1===o.length?`What follows ${this.vinyls[this.l[0]][this.progress.bestComboType]} best? → → → → →`:o.join("→")}reset(){this.l=[],this.selected={};const[t,n,o]=x;this.progress={color:{currentIndex:-1,correctCount:0,solved:!1},artist:{currentIndex:-2,correctCount:0,solved:!1},title:{currentIndex:-2,correctCount:0,solved:!1},bestComboType:"color",bestComboCount:0,bestComboUsedVinyls:[],displayText:"Select a record to play → → → → →"},this.vinyls=R.map((t,e)=>({index:e,color:t,artist:"",title:""})),t.forEach((t,e)=>{this.vinyls[t].color=R[e]}),n.forEach((t,e)=>{this.vinyls[t].artist=C[e]}),o.forEach((t,e)=>{this.vinyls[t].title=B[e]}),e.Instance.emit(5,this.progress)}}class I{static createButton(t){const e=document.createElement("button");let n=null;async function o(o){o.addEventListener("end",s),await t.xr.setSession(o),e.textContent="EXIT VR",n=o}function s(){n.removeEventListener("end",s),e.textContent="ENTER VR",n=null}if(e.style.display="block",e.textContent="ENTER VR",e.id="VRButton",e.onclick=()=>{null===n?navigator.xr.requestSession("immersive-vr",{optionalFeatures:["local-floor","bounded-floor","layers"]}).then(o):n.end()},"xr"in navigator)return e.style.display="none",navigator.xr.isSessionSupported("immersive-vr").then(t=>{t?e.style.display="block":(e.textContent="VR NOT SUPPORTED",e.setAttribute("data-disabled","true"))}).catch(()=>{e.textContent="VR NOT ALLOWED",e.setAttribute("data-disabled","true")}),e;{const t=document.createElement("a");return t.innerHTML="WEBXR NOT AVAILABLE",t.className="m",t}}}const L=new t.Clock,E=new t.Vector3(0,0,0).clone(),z="AL13YCAT",D=t.MathUtils.degToRad,N=t.MathUtils.randFloatSpread,G=["You are a cat DJ creating purrfect setlists.","The vinyl you choose to play after the previous one","will either build up your combo or break all progress.","Fill the meter to lock in a sequence.","Finish all three sequences to win!"],q=.0254,F=(t=1024,e=1024)=>{const n=document.createElement("canvas");n.width=t,n.height=e;const o=n.getContext("2d");return[n,o]},V=(e,n,o)=>{const s=new t.Vector3(1,0,0),i=new t.Euler(0,e,-Math.PI/2+n);return s.applyEuler(i).normalize().multiplyScalar(o)},Y=t=>parseFloat(""+(t||0)),W=t=>t[Math.floor(Math.random()*t.length)],U=(t,e)=>{const n=L.getElapsedTime();return.5*Math.sin(Math.sqrt(t*t+e*e)-2*n)},$=(e=1)=>{const n=2*Math.PI*Math.random(),o=e*Math.sqrt(Math.random());return new t.Vector3(o*Math.cos(n),0,o*Math.sin(n))},J={},j=new t.Color,K=(e,n)=>{const o=1==n?.glow,s=`color-${e}-${o}`;if(J[s])return J[s];const i=new(o?t.MeshBasicMaterial:t.MeshStandardMaterial)({color:e,side:t.FrontSide});return J[s]=i,i},H=(e,n)=>{const{color:o,bgColor:s,textAlign:i,ratio:r,fontSize:c}=n;j.setStyle(o||h);const a="string"==typeof o?o:"#"+j.getHexString(),l=`text-${a}-${e.join("")}`;if(J[l])return J[l];const w=1024,u=r?w/r:w,[d,f]=F(w,u);s&&(f.fillStyle=s,f.fillRect(0,0,w,u)),f.textAlign=i||"center";let p=16;"center"===f.textAlign&&(p=512),e.forEach((t,e)=>{const n=void 0!==c?c:64;f.strokeStyle=h,f.font=n+"px monospace",f.textBaseline="top",f.lineWidth=8,f.strokeText(t,p,16+n*e),f.fillStyle=a,f.fillText(t,p,16+n*e)});const v=new t.CanvasTexture(d),M=new t.MeshBasicMaterial({map:v,transparent:!0,side:t.DoubleSide});return J[l]=M,M},X=t=>t*t,Q=t=>.5>t?4*t*t*t:1-Math.pow(-2*t+2,3)/2,Z=t=>.5*Math.cos(2*t*Math.PI+Math.PI)+.5;class tt{static t;u;v;M;constructor(){this.u=[],this.v=null,this.M=new t.Clock}static get Instance(){return tt.t||(tt.t=new tt),tt.t}initScene(t){this.v||(this.v=t,this.M.start())}update(){const e=1e3*this.M.getElapsedTime();this.u=this.u.filter(n=>{const{mesh:o,start:s,end:i,easeFunc:r,loop:c}=n,a=n.endTime-n.startTime,h=t.MathUtils.clamp((e-n.startTime)/a,0,1);if(i.position&&o.position.lerpVectors(s.position,i.position,r(h)),i.rotation){const e=s.rotation,n=i.rotation,c=new t.Euler;c.order=e.order||t.Euler.DefaultOrder,c.x=e.x+(n.x-e.x)*r(h),c.y=e.y+(n.y-e.y)*r(h),c.z=e.z+(n.z-e.z)*r(h),o.rotation.copy(c)}return i.scaling&&o.scale.lerpVectors(s.scaling,i.scaling,r(h)),n.endTime>e||(c?(n.startTime=e,n.endTime=e+a,i.position&&o.position.copy(s.position),i.rotation&&o.rotation.copy(s.rotation),i.scaling&&o.scale.copy(s.scaling),!0):(n.resolve&&(n.resolve(),n.resolve=void 0,n.reject=void 0),!1))})}animateTransform(t){const{mesh:e,end:n}=t,o=t.duration||1e3,s=t.delay||0,i=t.ease||X,r=1e3*this.M.getElapsedTime();let c,a;const h=new Promise((t,e)=>{c=t,a=e});return this.u.push({mesh:e,start:{position:e.position.clone(),rotation:e.rotation.clone(),scaling:e.scale.clone()},end:n,easeFunc:i,startTime:r+s,endTime:r+s+o,loop:t.loop||!1,resolve:c,reject:a}),h}cancelAnimation(t,e=!1){const n=this.u.filter(e=>e.mesh===t);n.length&&(n.forEach(n=>{const{end:o}=n;e&&(o.position&&t.position.copy(o.position),o.rotation&&t.rotation.copy(o.rotation),o.scaling&&t.scale.copy(o.scaling)),n.reject&&(n.reject(),n.resolve=void 0,n.reject=void 0)}),this.u=this.u.filter(e=>e.mesh!==t))}}class et{constructor(){this.m=[this.S.bind(this),this.A.bind(this),this.O.bind(this),this.R.bind(this)],this.C=null,this.B=0,this.T=0,this._=0,this.P=null}S(t){return Math.sin(6.283184*t)}O(t){return t%1*2-1}A(t){return.5>t%1?1:-1}R(t){var e=t%1*4;return 2>e?e-1:3-e}k(t){return.003959503758*2**((t-128)/12)}I(t,e,n){var o,s,i,r,c,a,h=this.m[t.i[0]],l=t.i[1],w=t.i[3]/32,u=this.m[t.i[4]],d=t.i[5],f=t.i[8]/32,p=t.i[9],v=t.i[10]*t.i[10]*4,M=t.i[11]*t.i[11]*4,m=t.i[12]*t.i[12]*4,y=1/m,g=-t.i[13]/16,b=t.i[14],S=n*2**(2-t.i[15]),A=new Int32Array(v+M+m),O=0,R=0;for(o=0,s=0;v+M+m>o;o++,s++)s>=0&&(s-=S,c=this.k(e+(15&(b=b>>8|(255&b)<<4))+t.i[2]-128),a=this.k(e+(15&b)+t.i[6]-128)*(1+8e-4*t.i[7])),i=1,v>o?i=o/v:o>=v+M&&(i=(1-(i=(o-v-M)*y))*3**(g*i)),r=h(O+=c*i**w)*l,r+=u(R+=a*i**f)*d,p&&(r+=(2*Math.random()-1)*p),A[o]=80*r*i|0;return A}async init(t){return new Promise(e=>{this.C=t,this.B=t.endPattern,this.T=0,this._=t.rowLen*t.patternLen*(this.B+1)*2,this.P=new Int32Array(this._),e()})}generateChannel(t){return new Promise(e=>{var n,o,s,i,r,c,a,h,l,w,u,d,f,p,v=new Int32Array(this._),M=this.C.songData[t],m=this.C.rowLen,y=this.C.patternLen,g=0,b=0,S=!1,A=[];for(s=0;this.B>=s;++s)for(a=M.p[s],i=0;y>i;++i){var O=a?M.c[a-1].f[i]:0;O&&(M.i[O-1]=M.c[a-1].f[i+y]||0,17>O&&(A=[]));var R=this.m[M.i[16]],C=M.i[17]/512,B=2**(M.i[18]-9)/m,T=M.i[19],_=M.i[20],x=135.82764118168*M.i[21]/44100,P=1-M.i[22]/255,k=1e-5*M.i[23],I=M.i[24]/32,L=M.i[25]/512,E=6.283184*2**(M.i[26]-9)/m,z=M.i[27]/255,D=M.i[28]*m&-2;for(u=(s*y+i)*m,r=0;4>r;++r)if(c=a?M.c[a-1].n[i+r*y]:0){A[c]||(A[c]=this.I(M,c,m));var N=A[c];for(o=0,n=2*u;N.length>o;o++,n+=2)v[n]+=N[o]}for(o=0;m>o;o++)(w=v[h=2*(u+o)])||S?(d=x,T&&(d*=R(B*h)*C+.5),b+=(d=1.5*Math.sin(d))*(f=P*(w-b)-(g+=d*b)),w=3==_?b:1==_?f:g,k&&(w=1>(w*=k)?w>-1?this.S(.25*w):-1:1,w/=k),S=(w*=I)*w>1e-5,p=w*(1-(l=Math.sin(E*h)*L+.5)),w*=l):p=0,h>=D&&(p+=v[h-D+1]*z,w+=v[h-D]*z),v[h]=0|p,v[h+1]=0|w,this.P[h]+=0|p,this.P[h+1]+=0|w}e()})}async generate(){this.P.fill(0),this.T=0;const t=[];for(let e=0;this.C.numChannels>e;e++)t.push(this.generateChannel(e));return await Promise.all(t),this.T=this.C.numChannels,1}createAudioBuffer(t){for(var e=t.createBuffer(2,this._/2,44100),n=0;2>n;n++)for(var o=e.getChannelData(n),s=n;this._>s;s+=2)o[s>>1]=this.P[s]/65536;return e}createAudioBufferRange(t,e=0,n=null){(null===n||n>this._/2)&&(n=this._/2),0>e&&(e=0),e>=n&&(e=n-1);const o=n-e;for(var s=t.createBuffer(2,o,44100),i=0;2>i;i++)for(var r=s.getChannelData(i),c=0;o>c;c++)r[c]=this.P[2*(e+c)+i]/65536;return s}createWave(){var t=44+2*this._-8,e=t-36,n=new Uint8Array(44+2*this._);n.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var o=0,s=44;this._>o;++o){var i=this.P[o];n[s++]=255&(i=-32767>i?-32767:i>32767?32767:i),n[s++]=i>>8&255}return n}createWaveRange(t=0,e=null){(null===e||e>this._/2)&&(e=this._/2),0>t&&(t=0),t>=e&&(t=e-1);const n=e-t;var o=44+2*n-8,s=o-36,i=new Uint8Array(44+2*n);i.set([82,73,70,70,255&o,o>>8&255,o>>16&255,o>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&s,s>>8&255,s>>16&255,s>>24&255]);for(var r=0,c=44;n>r;++r){var a=this.P[2*(t+r)];i[c++]=255&(a=-32767>a?-32767:a>32767?32767:a),i[c++]=a>>8&255}return i}getData(t,e){for(var n=2*Math.floor(44100*t),o=Array(e),s=0;2*e>s;s+=1){var i=n+s;o[s]=t>0&&this.P.length>i?this.P[i]/32768:0}return o}}const nt=44100,ot=new(window.AudioContext||window.webkitAudioContext),st=(...t)=>((...t)=>{let e=ot.createBufferSource(),n=ot.createBuffer(t.length,t[0].length,nt);return t.map((t,e)=>n.getChannelData(e).set(t)),e.buffer=n,e.connect(ot.destination),e.start(),e})(((t=1,e=.05,n=220,o=0,s=0,i=.1,r=0,c=1,a=0,h=0,l=0,w=0,u=0,d=0,f=0,p=0,v=0,M=1,m=0,y=0)=>{let g,b,S=2*Math.PI,A=a*=500*S/nt**2,O=(f>0?1:-1)*S/4,R=n*=(1+2*e*Math.random()-e)*S/nt,C=[],B=0,T=0,_=0,x=1,P=0,k=0,I=0;for(h*=500*S/nt**3,f*=S/nt,l*=S/nt,w*=nt,u=nt*u|0,b=(o=99+nt*o)+(m*=nt)+(s*=nt)+(i*=nt)+(v*=nt)|0;b>_;C[_++]=I)++k%(100*p|0)||(I=r?r>1?r>2?r>3?Math.sin((B%S)**3):Math.max(Math.min(Math.tan(B),1),-1):1-(2*B/S%2+2)%2:1-4*Math.abs(Math.round(B/S)-B/S):Math.sin(B),I=(u?1-y+y*Math.sin(2*Math.PI*_/u):1)*(I>0?1:-1)*Math.abs(I)**c*t*.3*(o>_?_/o:o+m>_?1-(_-o)/m*(1-M):o+m+s>_?M:b-v>_?(b-_-v)/i*M:0),I=v?I/2+(v>_?0:(b-v>_?1:(b-_)/v)*C[_-v|0]/2):I),g=(n+=a+=h)*Math.sin(T*f-O),B+=g-g*d*(1-1e9*(Math.sin(_)+1)%2),T+=g-g*d*(1-1e9*(Math.sin(_)**2+1)%2),x&&++x>w&&(n+=l,R+=l,x=0),!u||++P%u||(n=R,a=A,x=x||1);return C})(...t));var it={songData:[{i:[0,255,116,85,0,255,116,0,37,14,4,6,73,99,0,0,0,0,0,0,2,136,15,0,32,0,0,0,6],p:[1,1,1,2,,,1,1,2,2],c:[{n:[139,,,,139,,,,139,,,,139,,,,139,,,,139,,,,139,,139,,139,,139],f:[]},{n:[140,,140,,,,140,,,,140,,140,,140,,,,140,,140,,,,140,,140,,,,140],f:[]}]},{i:[0,160,128,64,0,160,128,0,64,210,4,7,52,85,0,0,0,60,4,1,2,255,0,0,32,61,5,0,6],p:[,1,2,1,2,1,2,1,1,1],c:[{n:[,,,,139,,,,,,,,139,,,,,,,,139,,,,,,,,139,,139],f:[]},{n:[,,,,,,,,,,,,139,,139,,,,,,,,,,,,,,139,,139],f:[]}]},{i:[0,255,106,64,0,255,106,0,64,0,5,7,164,0,0,0,0,0,0,0,2,255,0,2,32,83,5,25,1],p:[,,,,1,,2,1,1,2],c:[{n:[144,,,,,,,,,,,,,,,,144],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,156,,,,,,,,,,,,,,,,156],f:[]}]},{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[,,,,1,1,1,1,2,2],c:[{n:[132,,,,,,,,132,,,,,,,,144,,,,,,,,144],f:[]},{n:[],f:[]}]},{i:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,0,0,0,69,3,1,1,23,167,0,32,77,6,25,6],p:[,,2,1,,2,1,2,2,1],c:[{n:[144,,,,144,,,,144,,,,142,,142,,144,,144,,144,,,,144,,,,144,,,,147,,,,151,,,,147,,,,149,,149,,147,,147,,151,,,,147,,,,147,,,,151,,,,154,,,,151,,,,151,,151,,151,,151,,154,,,,151,,,,151],f:[]},{n:[144,144,144,,144,,,,,,,,,,,,,,,,,,,,,,,,,,,,147,147,147,,147,,,,,,,,,,,,,,,,,,,,,,,,,,,,151,151,151,,151],f:[]}]}],rowLen:5513,patternLen:32,endPattern:9,numChannels:5};const rt=new AudioContext;let ct=0;e.Instance.on(5,t=>{ct=Math.min(t.bestComboCount||0,6)});const at=["Light Blue","Yellow","Orange","Red","Purple","Blue","Green","Lime","Pink","Silver"],ht=t=>{const[e,n,o,s,i,r,c,a,h,l,w,u,d,f,p]=t;return[e,n,Y(o),Y(s),Y(i),Y(r),Y(c),Y(a),Y(h),Y(l),Y(w),Y(u),Y(d),Y(f),Y(p)]},lt={c(e){const[n,o,s,i,r,c,a,h,l,w,u,d,f,p,v]=ht(e),M=new t.BoxGeometry(s,i,r);return M.translate(c-d,a-f,h-p),M.rotateX(D(l)),M.rotateY(D(w)),M.rotateZ(D(u)),M.computeBoundingBox(),M},s(e){const[n,o,s,i,r,c,a,h,l,w,u,d,f,p,v]=ht(e),M=new t.SphereGeometry(s/2,32,16);return M.scale(s/s,i/s,r/s),M.translate(c-d,a-f,h-p),M.rotateX(D(l)),M.rotateY(D(w)),M.rotateZ(D(u)),M},p(e){const[n,o,s,i,r,c,a,h,l,w,u,d,f,p,v]=ht(e),M=new t.PlaneGeometry(s,i);return M.rotateX(D(-90)),M.translate(c-d,a-f,h-p),M.rotateX(D(l)),M.rotateY(D(w)),M.rotateZ(D(u)),M.computeBoundingBox(),M},cy(e){const[n,o,s,i,r,c,a,h,l,w,u,d,f,p,v]=ht(e),M=s/2,m=new t.CylinderGeometry(M,M,i,32);m.translate(c-d,a-f,h-p),m.scale(1,1,r/s);const y=D(l),g=D(w),b=D(u),S=new t.Euler(y,g,b);return m.applyQuaternion((new t.Quaternion).setFromEuler(S)),m.computeBoundingBox(),m},py(e){const[n,o,s,i,r,c,a,h,l,w,u,d,f,p,v]=ht(e),M=new t.CylinderGeometry(0,Math.sqrt(s*s+s*s)/2,i,4,1,!1,Math.PI/4);return M.scale(1,1,r/s),M.translate(c-d,a-f+.3*i,h-p),M.rotateX(D(l)),M.rotateY(D(w)),M.rotateZ(D(u)),M}},wt=(e,n)=>{const{palette:o={},glow:s=!1}=n,i=new t.Group;i.position.set(0,0,0),i.rotation.set(0,0,0),i.scale.set(1,1,1);const r={...S,...o};return e.forEach(e=>{if(null!==e)if(Array.isArray(e[0]))i.add(wt(e,{palette:r,glow:s}));else{const[n,o,c,a,h,l,w,u,d,f,p,v,M,m,y]=ht(e),g=(t=>{const[e]=t,n=lt[e];if(!n)throw Error("Unknown shape: "+e);return n(t)})(e);let b=new t.MeshStandardMaterial({color:r[at[y]],side:t.DoubleSide});(!0===s||Array.isArray(s)&&s.includes(y))&&(b.emissive=new t.Color(r[at[y]]),b.emissiveIntensity=1);const S=new t.Mesh(g,b);S.name=o,S.position.set(Y(v),Y(M),Y(m)),i.add(S)}}),i},ut=[[0,8],[2,7],[8,11],[9,4],[10,0],[9,-4],[5,-6],[0,-7]],dt=[[0,6],[1,7],[2,7],[2,5],[3,6],[4,5],[3,2],[3,-5]],ft={depth:1.6,bevelSize:.2,bevelOffset:-.2},pt=e=>{const n=new t.Shape;return[...e,...e.reverse().map(([t,e])=>[-t,e])].forEach(([t,e],o)=>{0===o&&n.moveTo(t,e),n.lineTo(t,e)}),n},vt=[g,o,"#666666",y,m,u,M,b,"#994f00",f],Mt=new t.Vector3(-1,1,-1),mt=new t.Vector3(1,2,1);class yt{parent;L;D;N;G;constructor(){this.G=!1,this.parent=new t.Group,this.D=new t.PlaneGeometry(20,29,20,29),this.D.rotateX(Math.PI/2),this.N=new t.MeshStandardMaterial({wireframe:!0}),this.N.emissiveIntensity=1,this.L=new t.Mesh(this.D,this.N),this.parent.add(this.L),e.Instance.on(8,()=>{const t=this.D.getAttribute("position");for(let e=0;t.array.length>e;e+=3)t.array[e+1]=U(t.array[e],t.array[e+2]);t.needsUpdate=!0}),e.Instance.on(5,t=>{this.G=t.bestComboCount>=3,!this.L.material.visible&&this.G&&(this.L.position.set(0,-5,0),this.N.emissive.set(A[t.bestComboType]),tt.Instance.animateTransform({mesh:this.L,end:{position:E},ease:Q,duration:2e3})),this.L.material.visible=this.G})}get mesh(){return this.parent}}const gt=()=>{const o=new t.Group,s=(new t.BufferGeometry).setFromPoints([E,new t.Vector3(0,0,-25)]);for(let e=0;6>e;e++){const i=new t.Line(s);i.material.color.set(n),i.lookAt(new t.Vector3(3*e-9,0,25)),o.add(i)}return o.visible=!1,e.Instance.on(9,()=>{st(.6,0,110,.2,.6,.36,1,1.8,void 0,void 0,void 0,void 0,void 0,.3,void 0,void 0,void 0,.33,.4,void 0,-1500),o.rotation.set(Math.PI/4,0,0),o.visible=!0,tt.Instance.cancelAnimation(o),tt.Instance.animateTransform({mesh:o,end:{rotation:new t.Euler(-Math.PI/4,0,0)},duration:1999}).then(()=>o.visible=!1)}),o},bt={Purple:g,Red:d,Silver:a},St=()=>[["c",,6,6,8,,,,,,,,-3,,2],["c",,4,4,11.1,,,-.55,,,,,-3,,2],["c",,2,2,2,-2,,-5,,,,-2,-1,-5,4],["c",,2,2,2,2,,-5,,,,2,-1,-5,4],["c",,2,6,2,,,6,,,,,-3,7,2],["c",,1,4,6,,-3,9.5,15,,,,-3,8.5,9],["c",,1,5,7,,2.5,9.9,-15,,,,2,8.4,2],["c",,2,5,6,,2.2,,-30,,,,2.7,,2],["c",,1,2,2,-2.5,-4,-2,,,-40,-3,-3,-2,9],["c",,3,1,4,-4.5,-3.5,4,,,20,-3,-3,3,9],["c",,1,2,2,2.5,-4,-2,,,40,3,-3,-2,9],["c",,3,1,4,4.5,-3.5,4,,,-25,3,-3,3,9]],At=[{Orange:f,Purple:h,Silver:p},{Orange:m,Purple:h,Silver:M},{Orange:v,Purple:y,Silver:b}],Ot=new t.Vector3(.05,.05,.05),Rt=new t.Clock;let Ct,Bt,Tt,_t,xt,Pt,kt,It=0,Lt=0,Et=0;const zt=[];let Dt;const Nt=new t.Vector3(0,0,.3),Gt=new t.Vector3(0,5,0),qt=new t.Color;function Ft(){Vt(Nt)}function Vt(e){Dt=_t.xr.getReferenceSpace();const n={x:-1*e.x,y:-1*e.y,z:-1*e.z,w:1},o=new t.Quaternion,s=new XRRigidTransform(n,o);Dt=Dt.getOffsetReferenceSpace(s),_t.xr.setReferenceSpace(Dt)}function Yt(e){const o=e.target,s="left"===e.data.handedness?-1:1;if(!o.getObjectByName("t")){const e=new t.Group;e.name="t",e.rotation.set(0,0,0),e.position.set(-1*s*.035,.05,-.12),o.add(e)}let i=o.getObjectByName("p");i||(i=((e={})=>{const n=new t.Group;n.name="p";const o=wt([["cy",,4,6,2,,-1,,,,,,-1,,4],["s",,4,4,2,,2,,,,,,2,,4],["c",,.3,1,.3,-1.15,3.5,-.55,-77,,,-1.15,3.5,-.55,9],["c",,.3,1,.3,-.45,3.9,-.55,-77,,,-.45,3.9,-.55,9],["c",,.3,1,.3,.45,3.9,-.55,-77,,,.45,3.9,-.55,9],["c",,.3,1,.3,1.05,3.6,-.55,-77,,,1.05,3.6,-.55,9],["c",,2,.7,.4,,1.85,-.9,,,,,1.5,-.1,3],["c",,.8,.5,1.1,,2.45,-.55,,,,,2.2,-.1,3],["c",,.3,.6,.6,-1.15,2.7,-.8,,,,-1.15,2.7,-.1,3],["c",,.3,.6,.6,-.45,3.1,-.8,,,,-.45,3.1,-.1,3],["c",,.3,.6,.6,.45,3.1,-.8,,,,.45,3.1,-.1,3],["c",,.3,.6,.6,1.05,2.7,-.8,,,,1.05,2.7,-.1,3]],{palette:{...bt,...e}});o.scale.set(.03125,.03125,.03125),o.rotation.set(3*Math.PI/2,0,0),n.attach(o);const s=new t.PointLight(d,.5,4);return n.attach(s),n})(),i.position.set(0,0,.15),o.add(i));let r=o.getObjectByName("l");if(!r){const e=(new t.BufferGeometry).setFromPoints([E,new t.Vector3(0,0,-1)]);r=new t.Line(e),r.material.color.set(n),r.name="l",r.scale.z=5,o.add(r)}}function Wt(t){if(xt=t.target,!xt)return;const e=$t(xt);if(e.length>0){let t=!1;e.forEach(({object:e})=>{if(t)return;let n=e;for(;n;){if(n.onPointerPick){n.onPointerPick(xt),t=!0;const e=xt.getObjectByName("l");e&&(e.visible=!1);break}n=n.parent}})}xt.userData.targetRayMode=t.data.targetRayMode}function Ut(t){xt=t.target;const e=xt.userData.selected;e?.onPointerDrop&&e.onPointerDrop(xt),xt.getObjectByName("l").visible=!0}function $t(t){return t.updateMatrixWorld(),Tt.setFromXRController(t),Tt.intersectObjects(Bt.children,!0)}function Jt(t){if("screen"===t.userData.targetRayMode||void 0!==t.userData.selected)return;const e=t.getObjectByName("l"),n=$t(t);if(e&&(e.scale.z=5),n.length>0){let t=!1;n.forEach(({object:n,distance:o})=>{if(t)return;let s=n;for(;s;){if(s.userData.isPickable){const n=s.getObjectByName("h");n&&(n.visible=!0),e&&(e.scale.z=o),zt.push(s),t=!0;break}s=s.parent}})}}function jt(){const t=Rt.getDelta();It+=t,It>=.5&&(e.Instance.emit(0),It-=.5),tt.Instance.update(),e.Instance.emit(8,t),(()=>{for(;zt.length;){const t=zt.pop().getObjectByName("h");t&&(t.visible=!1)}})(),Jt(Pt),Jt(kt),_t.render(Bt,Ct)}const Kt=()=>{Ct.aspect=window.innerWidth/window.innerHeight,Ct.updateProjectionMatrix(),_t.setSize(window.innerWidth,window.innerHeight)},Ht=async t=>{const e=document.getElementById("p");t?(e.setAttribute("disabled","true"),e.innerHTML="LOADING..."):(e.removeAttribute("disabled"),e.innerHTML="JOIN")};function Xt(){const v=document.getElementById("p");v.style.display="inline-block",v&&(v.onclick=async()=>{await Ht(!0),await new Promise(t=>setTimeout(t,1)),await(async()=>{Et=JSON.parse(localStorage.getItem(z)||"{}").maxFishCount||0,_t=new t.WebGLRenderer({antialias:!0}),_t.setPixelRatio(window.devicePixelRatio),_t.setSize(window.innerWidth,window.innerHeight),_t.setClearColor(m,1),_t.xr.addEventListener("sessionstart",Ft),_t.xr.enabled=!0,_t.setAnimationLoop(jt),document.body.appendChild(I.createButton(_t)),document.body.appendChild(_t.domElement);const v=new k;Bt=new t.Scene,Ct=new t.PerspectiveCamera(75,window.innerWidth/window.innerHeight,.1,1e3),Ct.position.set(0,2,1),Ct.rotation.set(-1*Math.PI/12,0,0),Bt.add(Ct),tt.Instance.initScene(Bt);const S=(new t.Color).setStyle(b),R=new t.AmbientLight(S,.2);Bt.add(R);const C=(new t.Color).setStyle(a),B=new t.DirectionalLight(C,.3);B.position.set(6,10,8),B.castShadow=!0,B.target.position.set(0,0,0),Bt.add(B),Bt.add(B.target);const T=(()=>{const n=new t.Group;let o=0;const s=new t.RingGeometry(.5,1,32),i=H(["🎉"],{textAlign:"center",fontSize:1024,ratio:1}),r=new t.InstancedMesh(s,i,24);r.instanceMatrix.setUsage(t.DynamicDrawUsage);const c=new t.Object3D;n.add(r);const a=[];for(let t=0;24>t;t++)a.push(1-.5*Math.random());return e.Instance.on(7,t=>{n.position.copy(t);for(let t=0;24>t;t++){c.position.copy($(.17)),c.position.y=.05,c.rotation.set(Math.random()*Math.PI,Math.random()*Math.PI,Math.random()*Math.PI);const e=.04;c.scale.set(e,e,e),c.updateMatrix(),r.setMatrixAt(t,c.matrix)}r.instanceMatrix.needsUpdate=!0,r.visible=!0,o=1}),e.Instance.on(8,t=>{if(o-=t,0>o)r.visible=!1;else{for(let e=0;24>e;e++){r.getMatrixAt(e,c.matrix),c.matrix.decompose(c.position,c.quaternion,c.scale),c.position.y+=.2*t;const n=o>a[e]?.04:0;c.scale.set(n,n,n),c.updateMatrix(),r.setMatrixAt(e,c.matrix)}r.instanceMatrix.needsUpdate=!0}}),n})();Bt.add(T);const x=(()=>{const n=new t.Group,o=new t.Object3D,s=30,i=new t.BoxGeometry,c=new t.MeshStandardMaterial;c.emissive=new t.Color(r),c.emissiveIntensity=.2;const h=[];let l=[0],w=0,u=0;const d=new t.InstancedMesh(i,c,900);d.instanceMatrix.setUsage(t.DynamicDrawUsage);const f=new t.Color;let p=0;for(let t=0;s>t;t++)for(let e=0;s>e;e++){const n=V(0,2*e*Math.PI/s,15);n.z=4*-t,o.position.copy(n),o.scale.set(1,1,2),o.updateMatrix(),f.setHSL(.6,.5+.5*Math.random(),.25+.5*Math.random()),h.push(f.getHex()),d.setMatrixAt(p,o.matrix),d.setColorAt(p,f),p++}return n.add(d),e.Instance.on(8,t=>{w+=t;for(let e=0;l.length>e;e++)l[e]+=4*t;l=l.filter(t=>10>t);for(let t=0;d.count>t;t++){d.getMatrixAt(t,o.matrix),o.matrix.decompose(o.position,o.quaternion,o.scale);const e=Math.floor(t/s),n=e%2?1:-1,i=4*-e,r=t%s*2*Math.PI/s,c=.05*n*w,p=l.some(t=>e===Math.floor(4*t));o.position.copy(V(0,r+c,15)),o.position.z=i+u*n*Math.sin(w),o.updateMatrix(),d.setMatrixAt(t,o.matrix),d.setColorAt(t,p?f.setStyle(a):f.setHex(h[t]))}d.instanceMatrix.needsUpdate=!0,d.instanceColor.needsUpdate=!0}),e.Instance.on(5,t=>{u=6>t.bestComboCount?0:1,l.push(0)}),n})();x.position.set(0,0,5),Bt.add(x);const L=(v=>{const S=wt([[["c",,2,.1,1,,.85,-.5,,,,,-.1,,6],["c",,2.02,.03,1.01,,.85,-.49,,,,,-.1,,9],["c",,.1,.8,.1,-.85,.4,-.85,,,,.1,,-.9,6],["c",,.1,.8,.1,-.85,.4,-.15,,,,.1,,-.2,6],["c",,.1,.8,.1,.85,.4,-.15,,,,1.8,,-.2,6],["c",,.1,.8,.1,.85,.4,-.85,,,,1.8,,-.9,6],["c",,.4,.1,.8,.7,.95,-.5,,,,.7,.95,-.5,0],["c",,.6,.1,.4,-.6,.95,-.3,,,,-.4,.95,-.3,0],["c",,.4,.1,.4,.1,.95,-.3,,,,.1,1.01,-.3,0],["cy","pad",.4,.02,.4,.1,1,-.3,,,,.1,1,-.3,3],["p","fish",.6,.4,,-.6,1.01,-.3,,,,-.6,1.01,-.3,7]],["c",,22,1,4,,-1.5,-23,,,,,-2,-15,2],["c",,20,1,20,,-2.5,-11,,,,,-3,-4,3],["c",,20,1,6,,-2.5,2,,,,,-3,5,3],["c",,8,2,3,,-1,.5,,,,,-1,-4,2],["c",,1,4,1,6.5,,-6.5,,,,7,,-7,6],["c",,1,4,1,6.5,,-10.5,,,,7,,-11,6],["c",,1,3,1,6.5,.5,-14.5,,,,7,,-15,6],["c",,1,4,1,6.5,,-18.5,,,,7,,-19,6],["c",,1,4,1,6.5,,-14.5,,,,7,,-15,6],["c",,1,4,1,-6.5,,-6.5,,,,-6,,-7,6],["c",,1,4,1,-6.5,,-2.5,,,,-6,,-3,6],["c",,1,4,1,6.5,,-2.5,,,,7,,-3,6],["c",,1,4,1,-6.5,,-10.5,,,,-6,,-11,6],["c",,1,4,1,-6.5,,-14.5,,,,-6,,-15,6],["c",,1,4,1,-6.5,,-18.5,,,,-6,,-19,6],["c",,4,1,20,8,2.5,-11,,,,7,2,-3,1],["c",,4,1,20,-8,2.5,-11,,,,-9,2,-3,1],["c",,4.2,.4,20.2,-8,2.5,-11,,,,-9,2,-3,9],["c",,4.2,.4,20.2,8,2.5,-11,,,,7,2,-3,9]],{palette:{Green:"#93e0a8",Yellow:w,Orange:"#687793",Red:u,"Light Blue":r,Silver:l},glow:[9]}),R=(()=>{const t=wt([["c",,13,1,3,-1.5,.5,-.5,,,,,,,5],["c",,13.2,.4,3.2,-1.5,.5,-.5,,,,,,,1],[["c",,12.4,2.7,1,-1.5,2.45,.3,-60,,,-1.5,1.1,.88,6],["c",,11.8,.8,.1,-1.5,3.2,.85,-60,,,-1.5,1.1,.88,3],["c","p-color-0",1.8,.3,.1,-6.5,2.45,.85,-60,,,-11.5,1.1,.88,9],["c","p-color-1",1.8,.3,.1,-4.5,2.45,.85,-60,,,.5,1.1,.88,9],["c","p-color-2",1.8,.3,.1,-2.5,2.45,.85,-60,,,.5,1.1,.88,9],["c","p-color-3",1.8,.3,.1,-.5,2.45,.85,-60,,,.5,1.1,.88,9],["c","p-color-4",1.8,.3,.1,1.5,2.45,.85,-60,,,.5,1.1,.88,9],["c","p-color-5",1.8,.3,.1,3.5,2.45,.85,-60,,,.5,1.1,.88,9],["c","p-artist-1",1.8,.3,.1,-4.5,1.95,.85,-60,,,.5,1.1,.88,9],["c","p-artist-2",1.8,.3,.1,-2.5,1.95,.85,-60,,,.5,1.1,.88,9],["c","p-artist-3",1.8,.3,.1,-.5,1.95,.85,-60,,,.5,1.1,.88,9],["c","p-artist-4",1.8,.3,.1,1.5,1.95,.85,-60,,,.5,1.1,.88,9],["c","p-artist-5",1.8,.3,.1,3.5,1.95,.85,-60,,,.5,1.1,.88,9],["c","p-artist-0",1.8,.3,.1,-6.5,1.95,.85,-60,,,-11.5,1.1,.88,9],["c","p-title-1",1.8,.3,.1,-4.5,1.45,.85,-60,,,.5,1.1,.88,9],["c","p-title-2",1.8,.3,.1,-2.5,1.45,.85,-60,,,.5,1.1,.88,9],["c","p-title-3",1.8,.3,.1,-.5,1.45,.85,-60,,,.5,1.1,.88,9],["c","p-title-4",1.8,.3,.1,1.5,1.45,.85,-60,,,.5,1.1,.88,9],["c","p-title-5",1.8,.3,.1,3.5,1.45,.85,-60,,,.5,1.1,.88,9],["c","p-title-0",1.8,.3,.1,-6.5,1.45,.85,-60,,,-11.5,1.1,.88,9],["p","display",11.8,.8,,-1.5,2.23,-.88,30,,,-1.5,2.23,-.88,8]]],{palette:{Red:h,Green:w,Blue:r,Silver:h,Yellow:l},glow:[1]});return t.scale.set(.1,.1,.1),e.Instance.on(5,e=>{t.getObjectByName("display").material=H([e.displayText],{color:A[e.bestComboType],textAlign:"left",ratio:14.75,fontSize:_[e.bestComboType]}),P.forEach(n=>{for(let o=0;6>o;o++){const s=t.getObjectByName(`p-${n}-${o}`);if(!s)continue;let i=g;(e[n].solved||e[n].correctCount>o)&&(i=A[n]),(e[n].solved||e[n].correctCount>o)&&"color"===n&&(i=O[o]);const r=i!==g;s.material.color.set(i),s.material.emissive.set(r?i:h),s.material.emissiveIntensity=r?1:0,s.material.needsUpdate=!0}})}),t})();S.add(R),R.position.set(-.1,.9,-.7);const C=(()=>{const t=wt([["cy",,3.9,.1,3.9,-.27,2.1,,,,30,-.27,2.1,,9],["cy",,4,.8,4,,.5,,,,,,.5,,5],["cy",,3.9,1,3.9,,.5,,,,,,.5,,9],["cy",,3.8,.6,3.8,,.8,,,,,,.8,,8]],{palette:{Blue:M,Red:d,Silver:a}});return t.scale.set(.03125,.03125,.03125),t.userData.isPickable=!0,t.onPointerPick=()=>{e.Instance.emit(9)},t})();S.add(C),C.position.set(-.8,1,-.2);const B=(n=>{const o=new t.Group,s=new t.Object3D;let i=!1;const r=(()=>{const e=pt(ut),n=new t.ExtrudeGeometry(e,ft);return n.scale(.05,.05,.05),n})(),c=new t.MeshStandardMaterial,a=new t.InstancedMesh(r,c,80);a.instanceMatrix.setUsage(t.DynamicDrawUsage);const l=(()=>{const e=pt(dt),n=new t.ExtrudeGeometry(e,ft);return n.scale(.05,.05,.05),n.rotateX(-1*Math.PI/2),n})(),w=new t.MeshStandardMaterial,u=new t.InstancedMesh(l,w,160);u.instanceMatrix.setUsage(t.DynamicDrawUsage);const d=new t.Color,f=new t.Color;o.add(a),o.add(u);const p=new t.Vector3(0,-1,0),v=[],M=[];for(let e=0;8>e;e++)for(let n=0;10>n;n++){const o=n+8*e,i=W(vt),r=new t.Vector3(2*n-10+.5+e%2*1,0,2*e-8+.5);Math.abs(r.x)>=5&&(r.y+=5);const c=new t.Vector3(N(.3),N(.1),N(.3));r.add(c),s.position.copy(r).add(p),s.lookAt(0,6,0),s.updateMatrix(),a.setMatrixAt(o,s.matrix),d.setStyle(i),a.setColorAt(o,d);for(let t=0;2>t;t++){const e=2*o+t;s.position.copy(r),s.updateMatrix(),u.setMatrixAt(e,s.matrix),f.setStyle(i),u.setColorAt(e,f)}v.push({positionOffset:r,poseDelay:t.MathUtils.randInt(0,15),color:i})}return e.Instance.on(5,t=>{i=t.bestComboCount>=3,w.emissive.set(4>t.bestComboCount?h:A[t.bestComboType]),w.emissiveIntensity=4>t.bestComboCount?0:.8}),e.Instance.on(8,()=>{const e=n.xr?.getCamera();if(!e)return;const o={controllers:[]};if([0,1].forEach(t=>{const e=n.xr?.getController(t);if(e){const t=e.getObjectByName("p");t&&o.controllers.push(t.matrixWorld.clone())}}),e&&(o.camera=e.matrix.clone(),M.push(o),M.length>60&&M.shift()),0==M.length)return a.visible=!1,void(u.visible=!1);v.forEach((e,n)=>{const o=M[Math.max(0,M.length-1-e.poseDelay)];o?.camera&&(s.matrix.copy(o.camera),s.matrix.decompose(s.position,s.quaternion,s.scale),s.position.clamp(Mt,mt).add(e.positionOffset).add(p),i&&4>s.position.y&&(s.position.y+=U(s.position.x,s.position.z)),s.updateMatrix(),a.setMatrixAt(n,s.matrix),o.controllers.forEach((o,r)=>{const c=2*n+r;s.matrix.copy(o),s.matrix.decompose(s.position,s.quaternion,s.scale),s.position.clamp(Mt,mt).add(e.positionOffset).add(p),s.position.add(new t.Vector3(0===r?-.1:.1,.2,-.3)),i&&4>s.position.y&&(s.position.y+=U(s.position.x,s.position.z)),s.updateMatrix(),u.setMatrixAt(c,s.matrix)}))}),a.instanceMatrix.needsUpdate=!0,u.instanceMatrix.needsUpdate=!0}),o})(v);S.add(B),B.position.set(0,-1,-10),B.rotation.set(0,Math.PI,0);const T=wt([["s",,20,16,16,,8,,,,,,8,,4],["s",,16,16,16,,-5,,,,,,-5,,4],[["cy",,4,1,4,-3,10,-7.1,-71,-5,16,-3,10,-7.1,1],["s",,2,2,4,-2.8,10.1,-7,-75,7,10,-2.8,10.1,-7,4],["cy",,4,1,4,3,10,-7.2,-71,5,-17,3,10,-7.2,1],["s",,2,2,4,2.9,10,-7.1,-74,-4,-12,2.9,10,-7.1,4]],[["c",,4,4,2,1.84,6.03,-7.5,-25,,80,2.34,6.53,-7.5,9],["c",,4,4,2,-2.91,5.98,-7.5,,23,10,-2.41,6.48,-7.5,9],["c",,2,2,2,,5,-7,,,,,4,-7,3],["py",,3,1.6,1,,8.2,-8,-180,,,,8.2,-8,8]],[["py",,6,7,4,-4.86,13.55,-1.28,-14,20,31,-4.86,13.55,-1.28,4],["py",,6,7,4,5.14,13.55,-1.28,-11,-15,-33,5.14,13.55,-1.28,4],["py",,5.2,6.2,3.4,5.14,13.15,-1.78,-9,-16,-33,5.14,13.15,-1.78,1],["py",,5,5.5,3.8,-5.04,13.54,-1.59,-17,19,32,-5.04,13.54,-1.59,1]],[["cy",,.2,11,.2,-7.93,6,-10.12,,-15,90,-7.93,6,-10.12,9],["cy",,.2,9.2,.2,-6.87,7.72,-9,,-15,75,-6.87,7.72,-9,9],["cy",,.2,9,.2,-7.07,3.78,-9.3,,-15,105,-7.07,3.78,-9.3,9],["cy",,.2,7.8,.2,6.87,7.62,-8.9,180,-15,-105,6.87,7.62,-8.9,9],["cy",,.2,9.4,.2,6.93,6,-9.52,,-165,90,6.93,6,-9.52,9],["cy",,.2,8.8,.2,6.87,3.88,-9.1,180,-15,-75,6.87,3.88,-9.1,9]]],{palette:{Purple:g,Silver:b},glow:[1]});T.position.set(-3,1,0),T.scale.set(.1,.1,.1),T.rotation.set(0,-Math.PI/4,0),S.attach(T);const x=T.clone(!0);x.position.set(3,1,0),x.rotation.set(0,Math.PI/4,0),S.attach(x);const k=gt();S.add(k),k.position.set(-2.35,1.9,-.55);const I=gt();I.position.set(2.5,1.6,-.5),S.add(I);const L=(()=>{const e=wt([[["c",,1,8,2,7.5,7,,,,,7.5,7,,5],["c",,3,9,2,5.5,7.5,,,,,5.5,7.5,,5],["c",,8,4,2,,10,,,,,,11.5,,5],["c",,8,1,2,,5.5,,,,,,5.5,,5],["c",,3,9,2,-5.5,7.5,,,,,-5.5,7.5,,5],["c",,1,8,2,-7.5,7,,,,,-7.5,7,,5]],["c",,12,2.1,2.8,,4.04,,,,,,3,,3],["c",,2,2,1,2.72,6.89,,,,-45,2.72,6.89,,2],["c",,4,4,.2,2.81,6.91,-.1,,,-45,2.81,6.91,-.1,4],["c",,2,2,1,-2.69,6.91,,,,-45,-2.75,7,,2],["cy",,16,8,16,,-4,,,,,,-4,,6],["c","label",12,2,2.02,,10,,,,,,9,1,9]],{palette:{Blue:f,Silver:p,Red:d,Orange:w,Purple:y,Green:r},glow:[0,1,2,3,4,5,7,8,9]});return e.getObjectByName("label").material=H(["AL13YCAT"],{color:h,fontSize:224,ratio:4,bgColor:m}),tt.Instance.animateTransform({mesh:e,end:{rotation:new t.Euler(0,2*Math.PI-.01,0)},duration:16e3,ease:t=>t,loop:!0}),e})();S.add(L),L.position.set(0,0,-30);const z=new yt;S.add(z.mesh),z.mesh.position.set(0,-1,-10);const D=(()=>{const n=new t.Group;n.renderOrder=1;const o=new t.PlaneGeometry(5,5);o.translate(0,-2,0);const s=H(["You win!","Thanks for playing","Created by Alex Swan"],{color:"white"}),i=H(G,{color:"white",fontSize:24}),r=new t.Mesh(o,i);return n.add(r),r.position.set(0,-5,0),e.Instance.on(5,e=>{e.color.solved&&e.artist.solved&&e.title.solved?(r.userData.solved=!0,r.visible=!0,r.material=s,r.material.needsUpdate=!0,r.scale.set(.1,.1,.1),r.rotation.set(-Math.PI/2,0,0),r.position.set(0,0,-20),tt.Instance.animateTransform({mesh:r,end:{position:E,scaling:new t.Vector3(1,1,1),rotation:new t.Euler(0,0,0)},duration:1e3})):e.bestComboCount>1&&(r.visible=!1)}),n})();S.add(D),D.position.set(0,6,-5);const q=(()=>{const a=new t.Group;let l=[n,o,s,i,r,c],w=[(t,e)=>0===t||0===e,(t,e)=>1===t||1===e,(t,e)=>2===t||2===e,(t,e)=>3===t||3===e,(t,e)=>4===t||4===e,(t,e)=>5===t||5===e,(t,e)=>e+t===0||12-t-e-2==0,(t,e)=>e+t===1||12-t-e-2==1,(t,e)=>e+t===2||12-t-e-2==2,(t,e)=>e+t===3||12-t-e-2==3,(t,e)=>e+t===4||12-t-e-2==4,(t,e)=>e+t===5||12-t-e-2==5,(t,e)=>(t+e)%2==0,(t,e)=>(t+e)%2==1,(t,e)=>(t+e)%2==0,(t,e)=>(t+e)%2==1,(t,e)=>(t+e)%2==0,(t,e)=>(t+e)%2==1];for(;6>l.length;)l.push(...l);l=l.slice(0,6);let u=-2;const d=new t.BoxGeometry;d.translate(.5,.5,.5),d.scale(.9,1.1,.9);for(let e=0;6>e;e++)for(let n=0;6>n;n++){const o=new t.MeshStandardMaterial({color:h}),s=new t.Mesh(d,o);s.userData.x=n,s.userData.y=e,s.position.set(-3+n,0,-3+e),a.attach(s)}return e.Instance.on(0,()=>{if(u+=1,0>u)return;const n=l[u%l.length];a.children.forEach(e=>{const{x:o,y:s}=e.userData,i=w[u%w.length](o,s),r=i?n:h;e.material.needsUpdate=!0,e.material.color.set(r),e.material.emissive.set(i?r:h),e.material.needsUpdate=!0,e.material.emissiveIntensity=i?1:0,i&&tt.Instance.animateTransform({mesh:e,end:{scaling:new t.Vector3(1,i?1.1:1,1)},duration:500,ease:Z})}),e.Instance.emit(6,n)}),a})();return S.add(q),q.position.set(0,-3,-10),q.scale.set(2,1,2),S})(_t);Bt.add(L);const D=L.getObjectByName("pad"),Y=L.getObjectByName("fish");Y.material=H(["","💥🐟"],{ratio:1.5});const J=(()=>{const n=new t.Group,o=[];let s=!0;for(let s=0;10>s;s++){const s=At[t.MathUtils.randInt(0,At.length-1)],i=wt(St(),{palette:s,glow:!0}).clone(!0);i.userData.velocity=new t.Vector3(0,5+3*Math.random(),-5),i.userData.isPickable=!0,i.userData.shot=0,i.onPointerPick=()=>{st(1.01,void 0,275,.01,.01,.15,1,1.03,-3.7,void 0,-93,.07,void 0,void 0,void 0,-.1,void 0,.5,.04,.09),i.userData.shot+=1,i.userData.velocity.set(0,10,0),e.Instance.emit(7,i.getWorldPosition(new t.Vector3)),e.Instance.emit(4,i.userData.shot)},i.position.set(10*Math.random()-5,0,0),o.push(i),n.attach(i),i.scale.set(0,0,0)}return e.Instance.on(8,n=>{o.forEach(o=>{if(o.userData.velocity.y-=10*n,o.position.addScaledVector(o.userData.velocity,n),-2>o.position.y){o.userData.shot>0&&(st(2.07,0,130.81,.01,.26,.47,3,1.15,void 0,.1,void 0,void 0,.05,void 0,void 0,void 0,.14,.26,.15,.02),e.Instance.emit(4,0)),o.userData.shot=0;const n=new t.Vector3(4*Math.random()-2,0,4*Math.random()-2).sub(o.position).normalize(),s=new t.Quaternion;s.setFromUnitVectors(new t.Vector3(0,0,-1),n),o.quaternion.copy(s),o.position.y=-2;const i=new t.Vector3(0,0,-1);i.applyQuaternion(o.quaternion),i.multiplyScalar(5),o.userData.velocity.x=i.x,o.userData.velocity.z=i.z,o.userData.velocity.y=7+6*Math.random()}const s=new t.Quaternion;s.setFromUnitVectors(new t.Vector3(0,0,-1),o.userData.velocity),o.quaternion.copy(s)})}),e.Instance.on(5,t=>{const e=t.bestComboCount>=5,n=e!==s;o.forEach(t=>{n&&(tt.Instance.cancelAnimation(t),tt.Instance.animateTransform({mesh:t,end:{scaling:e?Ot:E},duration:e?2e3:1e3}))}),s=e}),n})();J.position.set(0,0,-10),Bt.attach(J),v.vinyls.forEach((n,o)=>{const s=(({color:n,artist:o,title:s})=>{const c=new t.Group,l=new t.RingGeometry(4,7,32);l.translate(0,0,-.001),l.scale(q,q,q);const w=K(n,{glow:!0});c.add(new t.Mesh(l,w));const u=new t.RingGeometry(.25,4,32);u.scale(q,q,q),u.translate(0,0,-.001);const d=K(new t.Color(a),{});c.add(new t.Mesh(u,d));const f=new t.PlaneGeometry(14.2,14.2);f.translate(0,0,.102),f.scale(q,q,q);const p=((e,n)=>{const[o,s]=F();s.fillStyle=h,s.strokeStyle=h,s.lineWidth=8,s.beginPath(),s.arc(512,512,20,0,2*Math.PI),s.stroke(),s.save(),s.translate(512,512),s.beginPath();for(var c=2*Math.PI/60,a=1.5*Math.PI+c;20*Math.PI>a;)s.lineTo(a*Math.cos(a)*4.5,a*Math.sin(a)*4.5),a+=c;s.stroke(),s.restore(),s.beginPath(),s.arc(512,512,288,0,2*Math.PI),s.stroke(),s.lineWidth=32,s.beginPath(),s.arc(512,512,496,0,2*Math.PI),s.stroke(),s.textAlign="center",e&&(s.font="64px monospace",s.textBaseline="middle",s.strokeStyle=h,s.lineWidth=8,s.strokeText(e,512,430.08),s.fillStyle=i,s.fillText(e,512,430.08)),n&&(s.font="96px monospace",s.textBaseline="bottom",s.fillStyle=r,s.strokeText(n,512,696.32),s.fillText(n,512,696.32));const l=new t.CanvasTexture(o);return l.encoding=t.LinearSRGBColorSpace,new t.MeshBasicMaterial({map:l,transparent:!0})})(o,s);c.add(new t.Mesh(f,p));const v=c.clone();v.rotation.set(0,Math.PI,0),c.add(v);const M=new t.RingGeometry(7,7.5,32);M.scale(q,q,q);const m=K(a,{glow:!0});m.emissiveIntensity=1;const y=new t.Mesh(M,m);y.visible=!1,y.name="h",c.add(y);const g=y.clone();return g.material=g.material.clone(),c.add(g),e.Instance.on(5,t=>{g.visible=t.bestComboUsedVinyls.includes(c.userData.recordIndex),g.material.color.set(A[t.bestComboType]),g.material.needsUpdate=!0}),c})(n),c=new t.Vector3(.7,1.15,-.2-.125*o);s.position.copy(c),s.userData.originalPosition=c,s.userData.isPickable=!0,s.userData.recordIndex=o,s.userData.endMove=()=>{Bt.attach(s),tt.Instance.cancelAnimation(s),tt.Instance.animateTransform({mesh:s,end:{position:s.userData.originalPosition,rotation:new t.Euler(0,0,0)},duration:100})},s.onPointerPick=e=>{if(e.userData.selected||v.isSolved())return;v.selected[e.id]=o;const n=e.getObjectByName("t");n&&(tt.Instance.cancelAnimation(s),n.attach(s),tt.Instance.animateTransform({mesh:s,end:{position:E,rotation:new t.Euler(0,Math.PI/2,0)},duration:60}),e.userData.selected=s,D.material.emissive.setStyle(M))},s.onPointerDrop=e=>{if(tt.Instance.cancelAnimation(s,!0),D.material.emissive.setStyle(h),.3>s.getWorldPosition(new t.Vector3).distanceTo(D.getWorldPosition(new t.Vector3)))return v.addVinylByIndex(s.userData.recordIndex),delete v.selected[e.id],e.userData.selected=void 0,D.children.forEach(t=>{t.userData.endMove&&t.userData.endMove()}),D.attach(s),void tt.Instance.animateTransform({mesh:s,end:{position:new t.Vector3(0,.02,0),rotation:new t.Euler(-1*Math.PI/2,0,0)},duration:60}).then(()=>{tt.Instance.animateTransform({mesh:s,end:{rotation:new t.Euler(-1*Math.PI/2,0,-2*Math.PI)},ease:t=>t,duration:1800,loop:!0})});s.userData.endMove(),e.userData.selected=void 0},Bt.add(s)}),Pt=_t.xr.getController(0),Pt.addEventListener("connected",Yt),Pt.addEventListener("selectstart",Wt),Pt.addEventListener("selectend",Ut),Pt.addEventListener("squeezestart",Wt),Pt.addEventListener("squeezeend",Ut),Bt.add(Pt),kt=_t.xr.getController(1),kt.addEventListener("connected",Yt),kt.addEventListener("selectstart",Wt),kt.addEventListener("selectend",Ut),kt.addEventListener("squeezestart",Wt),kt.addEventListener("squeezeend",Ut),Bt.add(kt),Tt=new t.Raycaster,window.addEventListener("resize",Kt,!1),e.Instance.on(1,n=>{n?st(void 0,void 0,143,.03,.17,.09,2,1.5,10,-17,void 0,void 0,void 0,void 0,4,void 0,void 0,.73,.09):st(void 0,0,void 0,void 0,.07,.12,void 0,3.4,void 0,void 0,109,.07,void 0,void 0,void 0,void 0,void 0,.6,.05,void 0,-1428),n||e.Instance.emit(7,D?.getWorldPosition(new t.Vector3))}),e.Instance.on(6,t=>{qt.setStyle(t),R.color.set(qt.add(S).multiplyScalar(.5))}),e.Instance.on(3,()=>{It>100&&(e.Instance.emit(0),It=0)}),e.Instance.on(5,()=>{v.isSolved()&&(Vt(Gt),Gt.set(0,0,0))}),e.Instance.on(4,t=>{Lt=t>0?Lt+1:0,Et=Math.max(Et,Lt),localStorage.setItem(z,JSON.stringify({maxFishCount:Et})),Y.material=H(["","💥🐟","","JUGGLES: "+Lt,"","BEST: "+Et],{ratio:1.5,color:a})}),(async()=>{const t=new et;await t.init(it),await t.generate();const n=[];for(let e=0;6>e;e++){const o=176400*e,s=t.createAudioBufferRange(rt,o,o+176400);n.push(s)}const o=t.createAudioBufferRange(rt,1058400,1764e3),s=[...n,o];let i=null,r=!1;const c=t=>{let n;i&&(i.stop(),i.disconnect()),n=6>t?t:6;const o=s[n];i=rt.createBufferSource(),i.buffer=o,i.connect(rt.destination),i.loop=!0,i.start();const a=setInterval(()=>{e.Instance.emit(3),ct!==t&&(clearInterval(a),c(ct))},2e3);r=!0};c(ct)})(),v.reset()})(),Ht(!1),document.getElementById("i").style.display="none",document.getElementById("c").style.display="block"});const S=document.createElement("p");S.innerHTML=G.join("<br>"),document.getElementById("i")?.insertBefore(S,v)}"loading"===document.readyState?window.addEventListener("DOMContentLoaded",Xt):Xt()</script>