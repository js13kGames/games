<html><title>Runekeeper - js13kGames 2023</title><link rel="shortcut icon"/><style>body{overflow:hidden;background:#000;margin:0px;font-family:sans-serif;}h1{color:#fff;text-align:center;margin-top:30px;}img{position:fixed;top:280px;width:600px;left:50%;margin-left:-300px;}h2{color:#666;font-style:italic;text-align:center;}</style><canvas></canvas><script>(()=>{var I={};function G(i,e){(I[i]||(I[i]=[])).push(e)}function y(i,e){I[i]=(I[i]||[]).filter(i=>i!=e)}function S(i,e){(I[i]||[]).map(i=>i(e))}var m=document.getElementsByTagName("canvas")[0];function x(i){var e=a.getTransform();i(),a.setTransform(e)}function Y(I,i,e=!1){I.beginPath(),i.map((i,e)=>{0==e?I.moveTo(i[0],i[1]):I.lineTo(i[0],i[1])}),e&&I.closePath(),I.stroke()}function p(i,e){Y(i,e,!0),i.fill()}m.width=innerWidth,m.height=innerHeight,window.onresize=()=>{m.width=innerWidth,m.height=innerHeight,a.imageSmoothingEnabled=!1};var i=document.createElement("canvas"),a=(i.width=i.height=64,a=i.getContext("2d"),m.getContext("2d")),n=(document.querySelector("link").href=i.toDataURL(),a.imageSmoothingEnabled=!1,a.lineJoin="round",a.lineCap="round","#683492"),d="#000",k="#474747",w="#777",b="#cbcbcb",M="#fff";var X=function(I,t,a,n){let l=0;return{update:function(i){if(2<(l+=i))return!0},render:function(e){x(()=>{e.translate(80*(I+.5),80*(t+.3)-70*(1-Math.exp(5*-l)));var i=1-l/2;e.fillStyle=`rgba(${n[0]},${n[1]},${n[2]},${i})`,e.textAlign="center",e.font="bold 40px arial",e.fillText("-"+a,0,0)})},order:100}},l=[],h={},o=[],r=0;function Z(e){e.inView||(e.inView=()=>1),l.push(e),P(),e.tags?.map(i=>{h[i]=h[i]??[],h[i].push(e)})}function P(){l.sort((i,e)=>(i.order||0)-(e.order||0))}function s(i,e){return i.filter(i=>!e.includes(i))}function v(i){return h[i]||[]}requestAnimationFrame(function i(I){let t=Math.min(.001*(I-r),.018);a.clearRect(0,0,m.width,m.height),a.textBaseline="middle",a.lineJoin="round",a.lineCap="round";var e=Math.min(m.width/800,m.height/1100);a.setTransform(e,0,0,e,m.width/2-190*e,.3*m.height-240*e),x(()=>{let e=v(0)[0];var i;e&&e.set(a),o.length=0,l.map(i=>{i.update?.(t)&&o.push(i)}),o.length&&(l=s(l,i=o),i.map(e=>{e.tags?.map(i=>{h[i]=s(h[i],[e])})})),e?l.map(i=>{i.inView(e.x,e.y)&&i.render?.(a)}):l.map(i=>{i.render?.(a)}),r=I}),requestAnimationFrame(i)});var W=function(t,a,n,l){let h=0;return{render:function(I){x(()=>{I.translate(80*(t+.5),80*(a+.5));var i=h/.5,e=n*(1-Math.exp(4*-i));I.strokeStyle=`rgba(${l[0]}, ${l[1]}, ${l[2]}, ${1-i})`,I.lineWidth=12*(1-i),I.beginPath(),I.ellipse(0,0,e,.8*e,0,0,2*Math.PI),I.stroke()})},update:function(i){return.5<(h+=i)},order:15}};function $(e,I){var t=v("obstacle");for(let i=0;i<t.length;i++){var a=t[i];if(a.getX()==e&&a.getY()==I)return 1}}function T(e,I){var t=v("enemy");for(let i=0;i<t.length;i++){var a=t[i];if(a.getX()==e&&a.getY()==I)return 1}}var c=function(h,o,r){let m=7*Math.random(),I=h,t=o,a=h,n=o,e={},d=1,s=0,f=0,l=!1,u=[1,2,3][r],c=u,H=0,g=[2,2,2][r],J=0;function Y(i,e){a=h,n=o,I=i,t=e,s=d,f=0,S(10)}function p(){H+=1}function M(){if(0<h){if(H>=g){let I=[[h-1,o]];.5<Math.random()?(I.push([h-1,o-1]),I.push([h-1,o+1])):(I.push([h-1,o+1]),I.push([h-1,o-1])),.5<Math.random()?(I.push([h,o-1]),I.push([h,o+1])):(I.push([h,o+1]),I.push([h,o-1])),.5<Math.random()?(I.push([h+1,o-1]),I.push([h+1,o+1])):(I.push([h+1,o+1]),I.push([h+1,o-1])),setTimeout(()=>{for(let i=0;i<I.length;i++){var e=I[i];if(0<=e[1]&&e[1]<=5&&e[0]<=5&&!$(e[0],e[1])){Y(e[H=0],e[1]);break}}},30*o+25*h)}}else s=2,f=0,S(6,1),Z(X(-1.1,o+.5,1,[255,0,0]));0<J&&(--J,v(1))}function v(i){u-=i,Z(W(h,o,95,[0,0,0])),Z(X(h,o,i,[255,0,0])),S(9),u<=0&&(l=!0)}function T([i,e,I]){i==h&&e==o&&(0==I&&(J=3),1==I&&(H=-1,v(1)),2==I)&&v(2)}return Z(W(h,o,55,[0,0,0])),G(1,p),G(4,M),G(5,T),(e={update:function(i){if(-1==H?m+=.4*i:m+=1.52*i,f+=i,s==d&&(i=f/.35,h=a*(1-i)+I*i,o=n*(1-i)+t*i,.35<f)&&(h=I,o=t,f=0,s=0,e.order=30+.02*o,P()),2==s&&.5<f&&(s=0,f=0),l)return y(1,p),y(4,M),y(5,T),S(11),!0},render:function(l){x(()=>{var i;l.translate(80*(h+.5),80*(o+.5)),l.fillStyle="rgba(0,0,0,0.1)",l.beginPath(),l.ellipse(0,0,26,19,0,0,2*Math.PI),l.fill(),s==d&&(i=f/.35,l.translate(0,-120*i*(1-i))),l.lineWidth=10,0==r?(l.fillStyle="#973",l.strokeStyle="#973"):1==r?(l.fillStyle=w,l.strokeStyle=w):2==r&&(l.fillStyle="#383",l.strokeStyle="#383");let e=Math.cos(10*m),I=Math.cos(10*m+1);if(l.fillRect(-10+e,0,20-2*e,-34-2*e),l.strokeRect(-10+e,0,20-2*e,-34-2*e),x(()=>{l.translate(0,-39-3*e),0==r?(l.fillStyle="#763",l.strokeStyle="#763",l.fillRect(-6,0,12,-16),l.strokeRect(-6,0,12,-16),l.strokeStyle=b,l.beginPath(),l.moveTo(-3,-8),l.lineTo(-3.01,-8),l.stroke()):1==r?(l.fillStyle=k,l.strokeStyle=k,l.fillRect(-6,0,12,-16),l.strokeRect(-6,0,12,-16),l.strokeStyle="#c11",l.beginPath(),l.moveTo(0,-21),l.lineTo(1,-29),l.lineTo(6,-33),l.lineTo(10,-29),l.stroke(),l.strokeStyle=b,l.beginPath(),l.moveTo(-3,-8),l.lineTo(-3.01,-8),l.stroke()):2==r&&(l.strokeStyle="#eee",l.beginPath(),l.moveTo(-8,-20),l.lineTo(-12,-24),l.stroke(),l.fillStyle="#263",l.strokeStyle="#263",l.fillRect(-6,0,12,-16),l.strokeRect(-6,0,12,-16),l.strokeStyle="#fa0",l.beginPath(),l.moveTo(-3,-8),l.lineTo(-3.01,-8),l.stroke(),l.strokeStyle="#eee",l.beginPath(),l.moveTo(8,-20),l.lineTo(12,-24),l.stroke())}),x(()=>{l.translate(-20,+I-18),l.rotate(.04*Math.cos(10*m-.2)),2==s&&(l.translate(20*-Math.exp(25*-Math.pow(1.5*(f-.25),2)),0),l.rotate(1.2*-Math.exp(30*-Math.pow(1.5*(f-.3),2)))),0==r?(l.rotate(-.2),l.strokeStyle="#841",l.beginPath(),l.moveTo(0,-30),l.lineTo(0,16),l.stroke(),l.strokeStyle="#eee",l.beginPath(),l.moveTo(-2,-26),l.lineTo(0,-30),l.lineTo(2,-26),l.stroke()):1==r?(l.strokeStyle="#eee",l.beginPath(),l.moveTo(0,0),l.lineTo(-6,-32),l.stroke(),l.strokeStyle="#841",l.beginPath(),l.moveTo(-5,0),l.lineTo(5,-3),l.moveTo(0,0),l.lineTo(2,4),l.stroke()):2==r&&(l.translate(-4,0),l.rotate(-.2),l.strokeStyle="#841",l.beginPath(),l.moveTo(0,-20),l.lineTo(0,8),l.stroke(),l.fillStyle="#99b",l.beginPath(),l.ellipse(0,-20,14,14,0,0,2*Math.PI),l.fill(),l.lineWidth=5,l.strokeStyle="#77a",l.beginPath(),l.moveTo(11,-20),l.lineTo(16,-20),l.moveTo(-11,-20),l.lineTo(-16,-20),l.moveTo(0,-31),l.lineTo(0,-36),l.stroke())}),-1==H)for(let e=0;e<8;e++){let i=(30*e+40*m)%50/50;i,i,i,i,i;l.fillStyle=`rgba(${250-150*i}, ${250-150*i}, 255, ${(1-i*i)*i*4})`,x(()=>{l.beginPath(),l.translate(.34*(83*e%130-65),30*i+2.6*(17*e%23-25)),l.rotate(e+3.5*i),l.fillRect(-6,-6,12,12),l.fill()})}if(0<J)for(let i=0;i<9;i++){var t=(30*i+100*m)%50/50,a=.15+.85*t,n=1-t*t*t*t*t;l.fillStyle=`rgba(${255*n}, ${(50+200*t)*n}, ${30*n}, ${1-t})`,l.beginPath(),l.ellipse(.34*(83*i%130-65),56*-t+1.3*(11*i%23-5),26*(1-t)*a,26*(1-t)/a*t,0,0,2*Math.PI),l.fill()}for(let i=0;i<c;i++)x(()=>{l.translate(-22*(c-1)/2+22*i,0),l.beginPath(),l.strokeStyle="#222",l.lineWidth=10,l.moveTo(-5,10),l.lineTo(0,15),l.lineTo(5,10),l.stroke(),i<u&&(l.strokeStyle="#f22",l.lineWidth=6,l.stroke())});for(let i=0;i<g;i++)x(()=>{l.translate(-22*(g-1)/2+22*i,0),l.beginPath(),l.strokeStyle="#222",l.lineWidth=10,l.moveTo(-4,27),l.lineTo(4,27),l.stroke(),(i<H||i<=H&&0<Math.cos(15*m))&&(l.strokeStyle="#3af",l.lineWidth=6,l.stroke())})})},tags:["enemy","obstacle"],order:30,getX:()=>I,getY:()=>t}).order=30+.02*o,P(),Y(h-1,o),e};i=function(){function i(){if(v("enemy").length<3){var i=parseInt(Math.min(v("game")[0].getScore()/4,2)),e=parseInt(Math.min(Math.floor(Math.random()*(i+1)),i));for(let i=0;i<30;i++){var I=Math.floor(6*Math.random());if(!$(5,I)){Z(c(6,I,e));break}}}}return G(4,function(){i()}),i(),{update:function(i){},render:function(i){}}};var R=function(){let i=0,I=!1,t=!0;return G(11,function(){i+=1}),G(1,function(){t=!1}),G(12,function(){I=!0}),{update:function(i){},render:function(e){x(()=>{e.setTransform(1,0,0,1,0,0),e.fillStyle="#dbad81",e.fillRect(0,0,m.width,m.height)}),e.strokeStyle="#fbcda1",e.lineWidth=4,e.beginPath();for(let i=0;i<=6;i++)e.moveTo(80*i,0),e.lineTo(80*i,480),e.moveTo(0,80*i),e.lineTo(480,80*i);e.stroke(),t?(e.fillStyle="#222",e.textAlign="center",e.font="bold 30px arial",e.fillText("DRAW SYMBOLS TO MOVE THE RUNESTONE",200,-40)):I?(e.fillStyle="#f00",e.textAlign="center",e.font="bold 30px arial",e.fillText(`GAME OVER! (score = ${i})`,240,-40)):(e.fillStyle="#222",e.textAlign="center",e.font="bold 30px arial",e.fillText(`${i} ${1==i?"ENEMY":"ENEMIES"} SLAIN`,240,-40))},order:-20,tags:["game"],getScore:()=>i}},E=[[230,30,30],[48,128,230],[106,250,106]];var q=function(n,l,i){let h=5*Math.random(),o=0,e=1==i?10:50;return Z(W(n,l,55,E[i])),S(5,[n,l,i]),{update:function(i){if(h+=i,1<(o+=+i))return!0},render:function(a){0==i?x(()=>{a.translate(80*(n+.5),80*(l+.5));for(let i=0;i<12;i++){var e=(30*i+100*h)%50/50,I=.15+.85*e,t=1-e*e*e*e*e;a.fillStyle=`rgba(${255*t}, ${(50+200*e)*t}, ${30*t}, ${(1-e)*(1-o*o*o)})`,a.beginPath(),a.ellipse(.5*(83*i%130-65),56*-e+2*(11*i%23-5),26*(1-e)*I,26*(1-e)/I*e,0,0,2*Math.PI),a.fill()}}):1==i?x(()=>{var i=1-o*o*o;a.translate(80*(n+.5),80*(l+.5)),a.fillStyle="#29e",a.fillRect(-38*i,-38*i,76*i,76*i),a.strokeStyle="#eef",a.lineWidth=5*i,a.beginPath(),a.moveTo(-25,5),a.lineTo(-20,-5),a.lineTo(-15,5),a.moveTo(-5,25),a.lineTo(0,15),a.lineTo(5,25),a.moveTo(-5,-15),a.lineTo(0,-25),a.lineTo(5,-15),a.moveTo(25,5),a.lineTo(20,-5),a.lineTo(15,5),a.stroke()}):2==i&&x(()=>{a.translate(80*(n+.5),80*(l+.5)),a.strokeStyle="#131",a.lineWidth=11*(1-o),a.beginPath(),a.moveTo(-18*Math.cos(123*Math.round(13*h)),-55),a.lineTo(18*Math.cos(103*Math.round(15*h)),-40),a.lineTo(-11*Math.cos(93*Math.round(17*h)),-20),a.lineTo(11*Math.cos(133*Math.round(13*h)),-15),a.lineTo(6*Math.cos(97*Math.round(11*h)),10),a.stroke(),a.strokeStyle="#1f1",a.lineWidth=10*(1-o),a.stroke()})},order:e}},A={0:[.4,.4,.4],1:[1,.3,.3],2:[.3,.65,1],3:[.4,1,.4],4:[1,1,.3],5:[1,.65,.3],6:[1,.4,1]},D=[[[-7,-7],[7,-7],[7,-7],[7,7],[7,7],[-7,7],[-7,7],[-7,-7]],[[-7,0],[7,0],[0,-7],[0,7]],[[-7,-7],[7,7],[-7,7],[7,-7]],[[-7,0],[7,0]],[[0,-7],[0,7]]],f=[[230,30,30],[48,128,230],[16,240,16]];var L=function(h,o,r,m){let l=0,d=!1;function s(t){var a={};for(let I=0;I<t.length;I++){let i=t[I][0],e=t[I][1];i<0||6<=i||e<0||6<=e||(setTimeout(()=>{Z(q(i,e,r))},t[I][2]),a[t[I][2]]=!0)}Object.keys(a).map(i=>{setTimeout(()=>S(8,r),i)})}return G(1,function i([e,I,t,a,n]){null!=n&&(t=n[0],a=n[1]);let l=-1;n=Math.abs(a-I)+Math.abs(t-e);e==h&&t==h&&(I<=o&&o<=a||a<=o&&o<=I)&&(l=Math.abs(o-I)),0<=(l=I==o&&a==o&&(e<=h&&h<=t||t<=h&&h<=e)?Math.abs(h-e):l)&&(setTimeout(()=>{Z(W(h,o,60,f[r])),d=!0,S(2),y(1,i)},l/(n+.01)*600),setTimeout(()=>{var i,e;i=t,e=a,0==m?s([[i-1,e,0],[i-1,e-1,150],[i,e-1,0],[i+1,e-1,150],[i+1,e,0],[i+1,e+1,150],[i,e+1,0],[i-1,e+1,150]]):1==m?s([[i-1,e,0],[i,e-1,0],[i+1,e,0],[i,e+1,0],[i-2,e,300],[i,e-2,300],[i+2,e,300],[i,e+2,300]]):2==m?s([[i-1,e-1,0],[i+1,e-1,0],[i-1,e+1,0],[i+1,e+1,0],[i-2,e-2,300],[i+2,e-2,300],[i-2,e+2,300],[i+2,e+2,300]]):3==m?s([[i-1,e,0],[i-2,e,100],[i-3,e,200],[i-4,e,300],[i-5,e,400],[i+1,e,0],[i+2,e,100],[i+3,e,200],[i+4,e,300],[i+5,e,400]]):4==m&&s([[i,e-1,0],[i,e-2,100],[i,e-3,200],[i,e-4,300],[i,e-5,400],[i,e+1,0],[i,e+2,100],[i,e+3,200],[i,e+4,300],[i,e+5,400]])},660))}),{render:function(n){x(()=>{n.translate(80*(h+.5),80*(o+.5));var i=f[r];n.fillStyle=`rgb(${i[0]}, ${i[1]}, ${i[2]})`,n.beginPath(),n.ellipse(0,0,+Math.cos(12*l)+18,18-+Math.cos(12*l),0,0,2*Math.PI),n.fill();for(let i=0;i<3;i++){var e=(30*i+50*l)%50/50,I=.15+.85*e;n.beginPath(),n.ellipse((30*i+20)%24-12,36*-e,12*(1-e)*I,16*(1-e)/I*e,0,0,2*Math.PI),n.fill()}n.strokeStyle=M,n.lineWidth=5,n.beginPath();var t=D[m];for(let i=0;i<t.length;i++){var a=t[i];i%2==0?n.moveTo(a[0],a[1]):n.lineTo(a[0],a[1])}n.stroke()})},update:function(i){return l+=i,d},tags:["obstacle"],order:15,getX:()=>h,getY:()=>o}},B={5:0,1:1,3:2,2:3,4:4,6:5},C=[[[-7,10],[0,-10],[7,10]],[[10,0],[9,4],[7,7],[4,9],[0,10],[-4,9],[-7,7],[-9,4],[-10,0],[-9,-4],[-7,-7],[-4,-9],[0,-10],[4,-9],[7,-7],[9,-4],[10,0]],[[-5,-10],[5,-10],[-3,0],[3,0],[0,10]],[[-9,-10],[9,-10],[0,10],[-9,-10]],[[-10,-4],[-5,4],[0,-4],[5,4],[10,-4]],[[-9,-8],[9,8],[9,-8],[-9,8],[-9,-8]]];var O=function(){let d=0,I=!1,s=0,f=2,u=[[-35,0],[-15,30],[15,30],[35,0],[15,-30],[-15,-30]],c=.66,H=1,g=0,J=0,t=0,a=0,n=-1,l=-1,h=0,o=0,r={};function m(i,e,I){h=s,o=f,t=i,a=e,g=H,J=0,null!=I?(t=I[0],a=I[1],n=i,l=e,e=(i=Math.abs(h-t)+Math.abs(o-a))/(i+.5),setTimeout(()=>{S(7),Z(W(t,a,50,[255,0,255]))},1e3*c*e)):(n=-1,l=-1),S(1,[h,o,t,a,null!=I?[n,l]:null])}return G(0,function([i,e]){if(!I&&0!=i){var t=B[i];if(1==e){var a=Math.sign(t-s);let e=s,I=-1;for(let i=s+a;0<a&&i<=t||a<0&&i>=t;i+=a){if(T(i,f)){I=i;break}e=i}0<=I?m(e,f,[I,f]):m(e,f,null)}else{var n=Math.sign(t-f);let e=f,I=-1;for(let i=f+n;0<n&&i<=t||n<0&&i>=t;i+=n){if(T(s,i)){I=i;break}e=i}0<=I?m(s,e,[s,I]):m(s,e,null)}}}),G(12,function(){I=!0}),r={update:function(i){var e;J+=i,g==H&&(i=J/c,d=i*Math.PI*2,s=h*(1-i)+t*i,f=o*(1-i)+a*i,(0<n||0<l)&&(e=(e=Math.abs(h-t)+Math.abs(o-a))/(e+.5))<i&&(e=(i-e)/(1-e),s=s*(1-e)+n*e,f=f*(1-e)+l*e),1<=i&&(f=0<n||0<l?(s=n,l):(s=t,a),J=0,g=0,d=0,t=s,a=f,S(3),Z(W(s,f,50,[255,255,255])),setTimeout(()=>{S(4)},550)),r.order=30+.02*f,P())},render:function(r){let m=v("caster")[0];x(()=>{for(let i=0;i<6;i++){r.lineWidth=4;var e=m.getIsDrawing()||m.getInDrawArea();e&&m.getDrawingOnLeft()?r.strokeStyle=M:r.strokeStyle="#fbcda1",x(()=>{r.translate(-40,40+80*i),r.scale(1.5,1.5),Y(r,C[i])}),e&&!m.getDrawingOnLeft()?r.strokeStyle=M:r.strokeStyle="#fbcda1",x(()=>{r.translate(40+80*i,520),r.scale(1.5,1.5),Y(r,C[i])})}r.translate(80*(s+.5),80*(f+.5)+4),r.fillStyle="rgba(0,0,0,0.13)",r.beginPath(),r.ellipse(0,0,32,22,0,0,2*Math.PI),r.fill(),g==H&&(i=J/c,r.translate(0,-90*i*(1-i)));var i=d;let I=Math.cos(i),t=Math.sin(i);i=u.map(i=>[.8*(i[0]*I+i[1]*t),.8*(-i[0]*t*.6+i[1]*I*.6)]);r.lineWidth=10,r.strokeStyle="#828",r.fillStyle="#f7f",p(r,i),r.translate(0,-11),r.lineWidth=6,r.beginPath();for(let i=0;i<6;i++){var a=u[i],n=.83*(a[0]*I+a[1]*t),a=.83*(-a[0]*t*.6+a[1]*I*.6);r.moveTo(n,a),r.lineTo(n,10+a)}r.stroke(),r.lineWidth=10,r.fillStyle="#f7f",p(r,i),r.strokeStyle="#fff",r.beginPath();var l=[[0,-7],[7,r.lineWidth=6],[-7,6]];for(let i=0;i<3;i++){var h=l[i],o=h[0]*I+h[1]*t,h=-h[0]*t*.6+h[1]*I*.6;r.moveTo(o,h),r.lineTo(.01+o,h)}r.stroke()})},order:30+.02*f,tags:["obstacle"],getX:()=>t,getY:()=>a}},e=atob("eJiYiIiJeIiIiXeIiIiXmXl3iXh5iIiHh3eJmXiIl5l3iHd4iIiIh3d4eZeIiIiHiIeJiXeJiIh4mJl3iHl5h5iHiYiIeIeYiIiYmIh3d4iHmIeIh5iJmYmXiIeXh3l4h3mYeXh5iXiIiJeIeJiXd3iYmXeJmId5h4mXd5eJiHiIiJmXeHl5iJiIh4eIiXiXiHiIiId3iIiIl5iIh3mYiYiIiIeHiHmId4h4l3d3d4iIiImJeIiIh4iHiIiYiXiJl5mIiIiJiYiYeHiIiZh4iZd3l5iYd4iIiHiJmZeXmJh4iImZiHh4iZiHiIiZmYd4eIiJh4h4eJh4h3d3eHiJh5d5d4d3iXeIeIiIeImIiYiHl5iIeYh5d4d4iHeIiXeIiHiIh3iHmJiIiIiIiJl4iIeIiIiIiYiImJiYiHh3h3eImZmXh5iIh6iYl3iJiXeIl5h3eZmIeIh4eId3iJl4h4iZeYiJh4iImXiYeHiZeIiJeXeIl5l4mYmYiIiIeIeIiIeHiXh3d4eId4mHmYl4iJiYh5iHeIiYmYiZiHiIiIiIiXmIiYd4h5iHh4h3d4iHiHiIh4h4h3d4iHmIiIiIiJiIh4h5iIeYmZiJiIiXiJmYeJiYiIiHiImHiImYiIl4eHeZiImJeHiImJiYh5h3mHmXeIh4d5h4eJmJiHh4h3iIeId3iYiHh5eXmYmIeImIeJeIh4d4h5mHd5iIiYiJd5eId3iHiIiHl4mIh4eYeIiZmYiHh5mHiJmIl4mId3iHd4iJh4d5l4d3eIh4iIiXiIiIiImIiHmImIh4iHeJiJmJiHiHeId4mHmJiHh4eIiId4l5mIiJiHiJiYiImXd3eIiIiYmIiYmYh4mImImIh3iId4d4d5eYd4iIl5iJh5eHd4eIeYeJl4iYmImJiXeHmYmIiIh4l4l4mJeHiIiId4mXmXeHmHmIiJmYmIiJiYl5iXiHh3eYiId4eIiIh4h4h3h4eIeHeId3h4iHiHh3iHiImImImImZiYiHmJiJiHiIiImId5d3mZeIh5h5h4iHiIiHeJiIiYl4mHiZiZiIiXmIl4mZh4mJiYh4iJiHiYh4iIeYl5eJiIiImImIiYeYiYiIiIeHeIl4h5iFeIiHeId4h4eIiIiIiIiIiImIeIiIeIiIiIiIiJiIiIiIiYiIiIiYeIiIiIiIiImIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiHeIiIeIiHiYeIiIiIiIiIh4h4iJiIiIiIeHiIiIiJiIiIiHiJiIh3iIh3iHiHiIiIeIiIeIiIiIh4iHiJiHeIiIh3eIh4iIh4h3iYiIiIiHiIiIiIiIeIiIeIiIiIiIiIiIiIiIeId4d4eYh3mHh4iHiIh4iIeYiJiIiIeIiYeHiIiHiIiIiIiIeHiJiIeIiIh4eIiHiHiHiIiZiImHmJiIh4iIiIiIh4iIiIiIiIiIeIiIiIiIiHh4mIiJiIiIiIiIiIiJmIiIiIiId4iHiIiIiIiIiJiIiHiIiIh4h4iIiImIiIiIiIh4iImIiIeIiIiIiIiIiIiIiHiIiIh4mIiIiImIiIiIeIh4h4iIh3iIiHmJiHiIiIiHiIh4h4iIiImIiImIiIiIiImIh4iYiJh4iIiImIh4iIiIeIh3iIiIiIiIh4iImIiIiYeIiIeHiIiYeIiIiIiId4iIiIiIiJiIeIiIiYiIiIiIeHiIiJiIeIeHiIh4iIiHiIiIiIiIiIh4iIiHiIiIeIiIiIiIh4eIiHh4iIeHh4h3iJiIiIiIiXd4iIiIeImIiIiIiJiIiIiIiImIiIiIiIiHh4iIiIh4iIiIiYeImImIiIh4eIiJiIiIiJeIiIiIiIiIiIiHiHeIiIiIiIiIiIiIh4iIiYh4h4h4iIiHiIeHeHiIiJiIh3iHmJiIh4iIiIeIh4iHmZmIiYiYh4iIiIiIeImHiIiIiHiImYeIiImIeIh3iHd3mIiIiHiHiImIiIiIiIeIeHeYiIl4iIiHh4iHh4h4iIiIiIiHiHiIeHeYh4iIeIiIiImImIiIiIh4eIiIiYiIiIiIiIiIiIeIiIiIiIiIiIiIiId4iIiJiIiIiIiIiIh4iYiIiIiIiIiIh4iIiJeIiIiIiIiIiIiYiYiJiJiXiIiIiIiIh4iHd5iIiZh5iJiYiIiIiIiIiIiIiHd4iHiIiIiIeJiIiIiIh3iImIiIiIiIiIiIiIiIiIiIh4l4iIiIiIiIiIeJiIiIiJeIiIiIiIiHiIl4eImIiIiIiIiYh3iIiIiIiIiImYeIiIiJiIiIiIiIiIiIiIiIiIeIiId4iYiIiIiIh4iHiIiIiIiImIiIiHiJiImIeIiIiIeImHiIiHiIiIiIiJd5iIiIiIiHiIiIiIiIiIiIiIiIiYiIiIiIiIiIiJiIiYeIiIiIiIiIeImIiIiIiHiIh4iIiIiJmIiIh3iIiIh4iIeIh4iIiIiIeIiIiIiIiIiIiIiIeIh4mIiHeIiYiJh4iIiHiIiIiIiIiHiIiYiIiIiIeIeZh4eHeIiIeIiJh4iIiHiIiIiIiIiIiHiIh3mIiHh4iIh4iJd4iHmIeIiHeIh4iYiIiIiIiImIh4iYiImIiIiJh4h4h4mIeIiHiIh4iIiHiIiIiJh4iIiIiIiYiYd5iIiHiHh4iHiIiIiHiIh4h3h4iIeYh4iIh4iIiHeIiIiIiIiIeIiJh4iIiHiJiIiIiIiIiIiImIeIiIiIiIiIiJiIiIiImIiIiIiIiImIiIiIiIh4iIiIeIiIiIiIh4iIiIh4iIiIiIiIiIiHh4h4iIiIiIiIiIiIeIiIiIiIiIh4iIiIiIiIiIiIiYiIh4eYiHiIiIiIiHiImIiJh4iIiIeJiHiHiIeHiIiIiHiIh4eIh4iHiId3iImHiIiId4iIiJiIeIeIeIiIiIiIiIiIiIiIiIiHiHh4eIiIh4mIiYiIiIiIiImHiIeIiIiHiIiIiJiIeIiIh4eIeIiIeIiHiIiHiIh4iIh4iIiIiXiJiIiImIiHiHiIiIiIh4iJiIiIiHiYiYmIiIiIh4iIiIeIiJiJiIiIiXiIh4h4iHiIh4mXh5iIeIiIiIiHiIiIiIiIeIiIiImIiIiIiIiIiIh4h3iHiHd4iYd4iJiImIiImIiJiIiIiIiIiIiIeJiImHiIiIeHh5iIiIiIiIiIiJiImYmImIl4iImIiJiJiIiIiIiHiJh4iIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIh4iIiIh4h4iHiIiGiIiIiIiIiIiIiIiJiIh4iIiIiIiIh4eIiHeIeIh4h4iJh3h3h4eJiIiIiIh4iIeIiIiIiHiIeImIiIiIiIiIiImYiIeIiIh4iYiIiIiIiHiIeIiIiIiIiIiIiIiXiIiIiIiIeIiIiIh4h3iIiHiYmJiIeIeIiHh2qXmYd4mJmImKd4l4mYmHiWmIl4iHiIe5mIhpmJl4eaiaqZd6aJeZqXh3iYiXaYiHqIqJiZVnenmHaJd3qXd2eZh5mJeYmHZWmXeHiGiZlpmZhomYmml2eJiHtnZ5l4mZiZiIdolpmphnmWd4mKmIhXd5aIh5h5Z6aIiZZqmYh5h3ipandpqXeGqHiZaXdnmYh5l5l4d4qZiXmpipiGeIaIlaeIiZqHmXl5imeYaHiZmHl3eIh3iVipl5aWephnh2eYh4iWiWiHiJeJeHiHh7pZiXiHZ4qWl5aZqZmIhnhoeXmIiWd4eaibaJl3l3Zpl3alh5maiIZ5aGeZh4l4iZiXl3l2eJeYh5h5iJmYmZhmeHhpiKeZlneWead6iXt6eKmXd5mniWeGlnmYiWipeYeFmYZ4eHmXmlaqh2iIiJlplpiJiIl4qYmIdoepiIl4mYp4iYeImIqZaaaIiZh5d3Z4"),H=[];for(let i=0;i<+e.length+0;i++){var t=e.charCodeAt(i);H.push(2.2*((15&t)-8)/16,2.2*((t>>4&15)-8)/16)}function g(t,a,i,n,l,h,o,r,m,d){var s=new Array(i);for(let I=0;I<i;I++){let e=0;for(let i=0;i<n;i++){var f=h+i%o+r*(l+Math.floor(i/o)),u=m+I*n+i;e+=a[u]*t[f]}var c=I+d+m;s[I]=Math.max(0,a[c]+e)}return s}function J(i){let I=i.reduce((i,e)=>i+e,0)/i.length,e=i.reduce((i,e)=>i+Math.pow(e-I,2),0)/i.length;return i.map(i=>(i-I)/Math.sqrt(.001+e))}var N=function(){let f=document.createElement("canvas").getContext("2d"),u=new Array(784),c=[],t=!1,a=[],n=-1,l=0,h=!1,o=!1;function r(i){var e=i.changedTouches;e&&(i.clientX=e[0].clientX,i.clientY=e[0].clientY)}function i(i){r(i),n=-1,i.clientY<.65*m.height-5||(h=i.clientX<m.width/2,c.length=0,c.push([i.clientX,i.clientY]),t=!0)}function e(i){var e,I;r(i),t||(h=i.clientX<m.width/2),o=i.clientY>.65*m.height-5,t&&0<c.length&&(I=c[c.length-1],e=i.clientX-I[0],I=i.clientY-I[1],!o||h&&i.clientX>m.width/2||!h&&i.clientX<m.width/2||20<e*e+I*I&&c.push([i.clientX,i.clientY]))}function I(i){r(i),0!=c.length&&(n=function(){let t=[1/0,1/0],a=[-1/0,-1/0],n=(c.map(i=>{t[0]=Math.min(i[0],t[0]),t[1]=Math.min(i[1],t[1]),a[0]=Math.max(i[0],a[0]),a[1]=Math.max(i[1],a[1])}),[]),l=Math.max(a[0]-t[0],a[1]-t[1]);if(l<70)return 0;l=Math.max(l,100);let h={},o=0,r=0;for(let i=0;i<20;i++){n=[];let e=3*Math.random()+16,I=3*Math.random()+16;c.map(i=>{n.push([(i[0]-(a[0]+t[0])/2)/l*e,(i[1]-(a[1]+t[1])/2)/l*I])}),f.setTransform(1,0,0,1,0,0),f.clearRect(0,0,28,28),f.strokeStyle="white",f.lineWidth=.5*Math.random()+1.3,f.lineJoin="round",f.lineCap="round",f.setTransform(1+.1*(Math.random()-.5),.1*(Math.random()-.5),.1*(Math.random()-.5),1+.1*(Math.random()-.5),2*(Math.random()-.5)+14,2*(Math.random()-.5)+14),Y(f,n);var m=f.getImageData(0,0,28,28).data;for(let i=0;i<m.length;i+=4)u[i>>2]=m[i]/255;var d=function(i){return x11=J(g(i,H,34,49,0,0,7,28,0,1666)),x12=J(g(i,H,34,49,0,7,7,28,0,1666)),x13=J(g(i,H,34,49,0,14,7,28,0,1666)),x14=J(g(i,H,34,49,0,21,7,28,0,1666)),x21=J(g(i,H,34,49,7,0,7,28,0,1666)),x22=J(g(i,H,34,49,7,7,7,28,0,1666)),x23=J(g(i,H,34,49,7,14,7,28,0,1666)),x24=J(g(i,H,34,49,7,21,7,28,0,1666)),x31=J(g(i,H,34,49,14,0,7,28,0,1666)),x32=J(g(i,H,34,49,14,7,7,28,0,1666)),x33=J(g(i,H,34,49,14,14,7,28,0,1666)),x34=J(g(i,H,34,49,14,21,7,28,0,1666)),x41=J(g(i,H,34,49,21,0,7,28,0,1666)),x42=J(g(i,H,34,49,21,7,7,28,0,1666)),x43=J(g(i,H,34,49,21,14,7,28,0,1666)),x44=J(g(i,H,34,49,21,21,7,28,0,1666)),y11=J(g(x11.concat(x12,x21,x22),H,25,136,0,0,1e3,0,1700,3400)),y12=J(g(x13.concat(x14,x23,x24),H,25,136,0,0,1e3,0,1700,3400)),y21=J(g(x31.concat(x32,x41,x42),H,25,136,0,0,1e3,0,1700,3400)),y22=J(g(x33.concat(x34,x43,x44),H,25,136,0,0,1e3,0,1700,3400)),z=g(y11.concat(y12,y21,y22),H,7,100,0,0,1e3,0,5125,700)}(u),d=(i=>i.reduce((i,e,I,t)=>e>t[i]?I:i,0))(d),s=(void 0===h[d]&&(h[d]=0),h[d]+=1,h[d]);s>r&&(r=s,o=d)}return o}(),a=JSON.parse(JSON.stringify(c)),l=0,c.length=0,t=!1,S(0,[n,h?0:1]))}return window.addEventListener("mousedown",i),window.addEventListener("mousemove",e),window.addEventListener("mouseup",I),window.addEventListener("touchstart",i),window.addEventListener("touchmove",e),window.addEventListener("touchend",I),{update:function(I){l+=I,-1!=n&&l<5&&a.map((i,e)=>{i[0]+=24*Math.cos(3*l+.2*e)*I,i[1]+=24*Math.sin(3*l+.2*e)*I})},render:function(I){x(()=>{I.setTransform(1,0,0,1,0,0),I.fillStyle=k,I.fillRect(0,.65*m.height,m.width,.36*m.height),I.lineWidth=10,I.strokeStyle="#3d3d3d",Y(I,[[m.width/2,.65*m.height],[m.width/2,m.height]]),I.strokeStyle=d,Y(I,[[0,.65*m.height],[m.width,.65*m.height]]),I.lineWidth=6;var i=.65*m.height+30,e=m.width/2-10;I.strokeStyle="#664",Y(I,[[e-30,i],[e-30,40+i]]),Y(I,[[e-40,10+i],[e-30,i],[e-20,10+i]]),Y(I,[[e-40,30+i],[e-30,40+i],[e-20,30+i]]),I.strokeStyle="#466",e=m.width/2,Y(I,[[30+e,i+=20],[70+e,i]]),Y(I,[[40+e,i-10],[30+e,i],[40+e,10+i]]),Y(I,[[60+e,i-10],[70+e,i],[60+e,10+i]]),t&&(I.strokeStyle="white",I.lineWidth=20,Y(I,c)),-1!=n&&(e=2*Math.exp(3*-l),i=A[n],I.strokeStyle=`rgba(${255*i[0]}, ${255*i[1]}, ${255*i[2]}, ${.6*e})`,I.lineWidth=20+80*(1-Math.exp(5*-l)),Y(I,a),I.strokeStyle=`rgba(${300*i[0]}, ${300*i[1]}, ${300*i[2]}, ${e})`,I.lineWidth=20,Y(I,a))})},tags:["caster"],getIsDrawing:()=>t,getDrawingOnLeft:()=>h,getInDrawArea:()=>o}};var V=function(){let I=0,t=10,e=!1;return G(6,function(i){if((t-=i)<=0&&(t=0,!e)){e=!0;for(let i=0;i<3;i++)setTimeout(()=>{Z(W(-2,1.5,70,[255,255,255]))},400*i);S(12)}}),{update:function(i){I+=1.52*i},render:function(e){x(()=>{e.translate(-120,160),0<t&&(e.fillStyle="#f11",e.textAlign="center",e.font="bold 30px arial",e.fillText(t+" HP",0,230)),e.fillStyle=w,e.strokeStyle=k,e.lineWidth=10;for(let i=0;i<4;i++)e.translate(0,20),p(e,[[-30,0],[-15,10],[-15,30],[-30,20]]),p(e,[[-15,10],[15,10],[30,0],[30,20],[15,30],[-15,30]]),e.translate(0,20),p(e,[[-30,0],[-15,10],[15,10],[15,30],[-15,30],[-30,20]]),p(e,[[15,10],[30,0],[30,20],[15,30]]);var i;e.translate(0,-143),e.fillStyle="#a4a4a4",p(e,[[-30,0],[-15,10],[15,10],[30,0],[15,-10],[-15,-10]]),0<t&&(e.translate(3,-2),e.fillStyle=d,e.strokeStyle=d,e.lineWidth=4,i=.05*-Math.cos(10*I)+.95,p(e,[[-20*i,0],[12*i,0],[i,-30],[-10*i,-10]]),e.fillStyle=n,e.strokeStyle=n,e.translate(0,-23+Math.abs(2.5*Math.sin(5*I))),e.rotate(.08*Math.sin(10*I+3)),p(e,[[-20,2],[-10,-1],[13,0],[20,4],[17,0],[12,-5],[7,-13],[0,-23],[-10,-29],[-21,-20],[-12,-22],[-6,-10]]),e.lineWidth=7,e.strokeStyle=M,Y(e,[[8,-4],[8.01,-4]]),Y(e,[[-1,-4],[-1.01,-4]]),Y(e,[[2,-11],[2.01,-11]]))})}}};function F(i,e,I){return Math.min(Math.max(i,e),I)}var K=function(){audioCtx=new AudioContext,sampleRate=audioCtx.sampleRate;let i,Y,p,M,v,T,y,S,x,k,w,b,X,Z,P,W,$,C,R,E,q=!0,A=i=>Math.sin(i),D=i=>(i%6.28-3.14)/6.28,L=i=>F(1e3*Math.sin(i),-1,1);async function B(){return new Promise(i=>setTimeout(i,0))}async function O(i,e){var i=audioCtx.createBuffer(1,sampleRate*i,sampleRate),I=i.getChannelData(0),t=i.length;for(let i=0;i<t;i++)I[i]=e(44100*i/sampleRate)*(1-i/t);return await B(),i}function N(e){return()=>{var i=audioCtx.createBufferSource();i.buffer=e,i.connect(audioCtx.destination),i.start()}}return{init:async function(){function e(i,e,I){e=18*Math.pow(2,-e/12);return D(i/e)*A(i/(2*e+3*A(i/2e5)))*.1*(0<i/44100-I?1:0)*Math.exp(7*-(i/44100-I))}attackSound=await O(.2,i=>.05*D(i/(.3-220*Math.exp(-i/500)))),i=await O(.2,i=>.15*(.3*A(i/(20+i/150))+Math.random())),T=await O(.2,i=>.07*D(i/(.3-220*Math.exp(-i/500)))),Y=await O(.25,i=>.1*(.3*L(i/(120+i/250))+Math.random())*(.5*L(i/600)+.5)),p=await O(.1,i=>.1*L(i/(20+150*Math.exp(-i/1600)))),v=await O(.3,i=>.06*(A(i/(14+i*i/1e6))+Math.random()/2)),M=await O(.3,i=>.08*A(i/(100-i/20))),y=await O(.4,i=>.16*Math.random()),S=await O(.4,i=>L(i/(30+i/500))*(.5*L(i/(1500+i/60))+.5)*(.5*L(i/(600+i/40))+.5)*.11),x=await O(.5,i=>.15*(D(i/(3+i/250))+.1*Math.random())),k=await O(2,i=>e(i,0,0)+e(i,7,.15)+e(i,0,.3)),w=await O(2,i=>e(i,2,0)+e(i,3,.15)+e(i,5,.3)),b=await O(2,i=>e(i,12,0)+e(i,6,.15)+e(i,0,.3)),X=await O(2,i=>e(i,10,0)+e(i,10,.15)+e(i,3,.3)),Z=await O(2,i=>e(i,5,0)+e(i,4,.15)+e(i,5,.3)),P=await O(2,i=>e(i,8,0)+e(i,1,.15)+e(i,4,.3)),W=await O(2,i=>e(i,-4,0)+e(i,-10,.15)+e(i,-4,.3));var I=.82*sampleRate,t=audioCtx.createBuffer(1,I,sampleRate).getChannelData(0),a=.1*sampleRate;for(let i=0;i<a;i++)t[i]+=.06*(A(i/(70+i/300))+Math.random()/3)*(1-i/a),t[parseInt(.25*I)+i]+=.02*(D(i/(80-i/2e3))+Math.random()/3)*(1-i/a),t[parseInt(.5*I)+i]+=.06*Math.random()*(1-i/a)+.06*(A(i/(70+i/300))+Math.random()/3)*(1-i/a),t[parseInt(.75*I)+i]+=.02*(D(i/(80-i/2e3))+Math.random()/3)*(1-i/a);function n(i,e){e=80*Math.pow(2,-e/12);return.25*A(i/(e+i/9e3))*(1-i/h)}await B();var l=audioCtx.createBuffer(1,16*I,sampleRate).getChannelData(0);let h=.25*sampleRate;var o=.25*I;for(let i=0;i<4;i++){var r=i*o*16,m=[0,-5,-2,-7][i];for(let i=0;i<h;i++)l[i+r]+=n(i,0+m),l[i+3*o+r]+=n(i,5+m),l[i+4*o+r]+=n(i,7+m),l[i+5*o+r]+=n(i,10+m),l[i+7*o+r]+=n(i,12+m),l[i+9*o+r]+=n(i,12+m),l[i+10*o+r]+=n(i,10+m),l[i+11*o+r]+=n(i,7+m),l[i+12*o+r]+=n(i,12+m),l[i+14*o+r]+=n(i,10+m)}function d(i,e){e=20*Math.pow(2,-e/12);return.04*A(i/(e+5*Math.exp(-i/h*4)))*F(1-i/(12*h),0,1)*Math.pow(.5*A(i/1550)+.5,3)}await B();var s=audioCtx.createBuffer(1,16*I,sampleRate).getChannelData(0);for(let i=0;i<4;i++){var f=i*o*16,u=[[-2,3,7],[-2,2,7],[-2,2,5],[-4,0,3]][i];for(let i=0;i<12*h;i++)s[i+f]+=d(i,u[0]),s[i+f]+=d(i,u[1]),s[i+f]+=d(i,u[2])}function c(i,e){e=20*Math.pow(2,-e/12);return.034*D(i/(e+.01*A(i/1e3)))*(1-i/(2*h))}await B();var H=audioCtx.createBuffer(1,16*I,sampleRate).getChannelData(0);for(let i=0;i<2*h;i++)H[i]+=c(i,7),H[i+3*o]+=c(i,0),H[i+6*o]+=c(i,3),H[i+7*o]+=c(i,5),H[i+8*o]+=c(i,7),H[i+11*o]+=c(i,0),H[i+14*o]+=c(i,3),H[i+15*o]+=c(i,5),H[i+16*o]+=c(i,2),H[i+32*o]+=c(i,5),H[i+35*o]+=c(i,-2),H[i+38*o]+=c(i,2),H[i+39*o]+=c(i,3),H[i+40*o]+=c(i,5),H[i+43*o]+=c(i,-2),H[i+46*o]+=c(i,3),H[i+47*o]+=c(i,2),H[i+48*o]+=c(i,0);await B();var g=($=audioCtx.createBuffer(1,32*I,sampleRate)).getChannelData(0);for(let i=0;i<g.length;i++)g[i]+=t[i%t.length],g[i]+=l[i%l.length],g[i]+=s[i%s.length],g[i]+=H[i%H.length];G(7,N(i)),G(9,N(i)),G(1,N(p)),G(3,N(Y)),G(2,N(M)),G(10,N(v)),G(6,N(T)),G(8,i=>{N({0:y,1:S,2:x}[i])()}),G(0,([i])=>{N({0:W,5:k,1:w,3:b,2:X,4:Z,6:P}[i])()}),(R=new GainNode(audioCtx)).connect(audioCtx.destination),(E=new GainNode(audioCtx)).connect(audioCtx.destination);{var J=$;let i=C;(C=audioCtx.createBufferSource()).buffer=J,C.loop=!0,C.connect(q?R:E),C.start(),setTimeout(()=>{i?.stop()},700),R.gain.setTargetAtTime(q?1:0,audioCtx.currentTime,.5),E.gain.setTargetAtTime(q?0:1,audioCtx.currentTime,.5),q=!q}}}};function u(){var e=Math.floor(3*Math.random()),I=Math.floor(5*Math.random());for(let i=0;i<300;i++){var t=Math.floor(4*Math.random()+1),a=Math.floor(4*Math.random()+1);if(!$(t,a))return void Z(L(t,a,e,I))}console.log("Failed to place!")}Z(R()),Z(V()),Z(O()),Z(N()),Z(i()),u(),u(),u(),G(2,u),K().init()})();</script>