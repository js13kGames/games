<!doctype html><title>Ballarena Revival</title><style>body,html{height:100%}div{float:left;width:100%;min-height:100%;height:100%;margin:0;background-color:#000}table{width:100%;height:100%}canvas{position:absolute}</style><div id=d><canvas id=c></canvas><table><tr><td id=e><td id=f><td id=g></table></div><script>function AdvancedRenderer(t,i,e){for(this.context=t.getContext("2d"),this.canvas=t,this.container=i,this.game=e,this.itemTime=this.itemDisplayed=this.time=0,this.menuText=["PLAY ! ","CONTROLS : ","MUSIC : ","SOUND FX : ","HALL OF FAME"],this.starfield=[],t=0;500>t;++t)this.starfield[t]=[Math.random(),Math.random(),Math.random()];this.starfieldPhi=this.starfieldZ=this.starfieldY=this.starfieldX=0,this.starfieldSpeed=[0,0,-.005,.01],this.starfieldTargetSpeed=[0,0,-.005,.01],this.starfieldTargetCount=this.starfieldCount=100,this.twirlingStars=[],this.floaterSymbol=" ⇔ >< ✚ ♥ ✿ ☕ ☠ ✋ ☸ ✪ ⚡ ⚛ ♨".split(" "),this.floaterColor=" #CFC #FE8 #CFC #FCC #CCC #CCF #FFF #FFC #FEC #DEE #8FF #8F8 #FFC".split(" "),this.meteors=[]}function Ball(t){this.posY=this.posX=0,this.speed=.02,this.heading=0,this.radius=.04,this.stuckOnPad=t,this.offsetOnPad=0}function Brick(t,i,e){this.hitPoints=1,this.relativeTime=0,this.posX=t,this.posY=i,this.radius=.08,this.alive=!0,this.timeBlown=0,this.path=null,this.color=e,this.value=this.hitPoints}function CircularPath(t,i){this.radius=t,this.speed=i}function DoubleCircularPath(t,i,e,s){this.radius=t,this.speed=i,this.radius2=e,this.speed2=s}function HarmonicPath(t,i,e,s){this.radius=t,this.speed=i,this.radius2=e,this.speed2=s}function OscillatingPath(t,i,e,s,a,h){this.deltaX=t,this.radiusX=i,this.offsetY=e,this.speed1=s,this.speed2=a,this.shift2=h}function FlowerPath(t,i,e,s){this.coefA=t,this.coefB=i,this.coefC=e,this.speed=s}function LissajousPath(t,i,e){this.radius=t,this.sx=i,this.sy=e}function PulsatingPath(t,i,e,s,a,h,o,n){this.speed=s,this.speed2=o,this.angleShift=e,this.x=t,this.y=i,this.zoom=a/2,this.period=h,this.offset=n}function CollisionHandler(t){this.level=t}function Controls(){this.stance=1,this.totalClear()}function Floater(t,i,e,s){this.posX=t,this.posY=i,this.speedR=.01,this.phiAmplitude=this.constantPhi=0,this.phiFrequency=.2,this.radius=.08,this.t0=e,this.item=s,this.hit=!1}function Game(t,i){this.transitionToHof=this.transitionTimer=0,this.menuOffset=10,this.controls=t,this.level=new Level(this.controls,i),this.hof=[];for(var e=0;16>e;++e)this.hof.push(["...",1e3*(16-e)]);this.menu=new MenuDriver(t,i),this.signingToHof=-1}function Level(t,i){this.bricks=[],this.bricksLeft=0,this.balls=[],this.ballsInPlay=0,this.floaters=[],this.padRadius=.8,this.padThickness=.08,this.lossDistanceSq=1,this.controls=t,this.soundManager=i,this.collisionHandler=new CollisionHandler(this),this.canCheat=!1,this.initialize()}function MenuDriver(t,i){this.controls=t,this.soundManager=i,this.optionCount=5,this.active=!1}AdvancedRenderer.prototype={initialize:function(){this.renderBuffer=document.createElement("canvas"),this.renderBuffer.width=1060,this.renderBuffer.height=580;var t=this.renderBuffer.getContext("2d"),i="#FFFFC0 #FFFFC0 #FFFFC0 #C0FFC0 #C0FFFF #FFC0FF #FFC0FF #FFC0FF #FFFFFF #AAA".split(" "),e="#FF2000 #E08000 #C0C000 #00A000 #0080C0 #0020FF #7000C0 #FF00A0 #404040 #000".split(" ");t.save();for(var s=0;10>s;++s){var a=t.createRadialGradient(15,45,2,30,30,30);a.addColorStop(0,i[s]),a.addColorStop(1,e[s]),t.fillStyle=a,t.beginPath(),t.arc(30,30,30,0,7,0),t.fill(),t.translate(0,60);for(var h=1;8>h;++h){t.strokeStyle=a,t.lineWidth=26-3*h;for(var o=(8.5-h)/8,n=0;8>n;++n)t.beginPath(),t.arc(30,30,17,(n-o)*Math.PI/4,(n+o)*Math.PI/4,0),t.stroke();t.translate(0,60)}t.translate(60,-480)}for(t.restore(),t.save(),t.translate(600,0),(a=t.createRadialGradient(30,30,2,30,30,30)).addColorStop(0,"rgba(0,0,0,0)"),a.addColorStop(.7,"rgba(0,0,0,0)"),a.addColorStop(.8,"#0000FF"),a.addColorStop(.85,"#00FFFF"),a.addColorStop(1,"rgba(0,0,255,0)"),t.fillStyle=a,t.beginPath(),t.arc(30,30,30,0,7,0),t.fill(),t.translate(0,60),(a=t.createRadialGradient(8,23,2,15,15,15)).addColorStop(0,"white"),a.addColorStop(1,"#202030"),t.fillStyle=a,t.beginPath(),t.arc(15,15,15,0,7,0),t.fill(),t.translate(0,60),(a=t.createRadialGradient(8,23,2,15,15,15)).addColorStop(0,"white"),a.addColorStop(1,"red"),t.fillStyle=a,t.beginPath(),t.arc(15,15,15,0,7,0),t.fill(),t.translate(0,60),t.beginPath(),t.arc(15,15,15,0,7,0),t.fill(),t.translate(0,-60),(a=t.createLinearGradient(0,0,30,0)).addColorStop(0,"#FF0000"),a.addColorStop(.1,"#00A000"),a.addColorStop(.3,"#A0FFA0"),a.addColorStop(.9,"#00A000"),a.addColorStop(1,"#FF0000"),t.fillStyle=a,t.fillRect(0,15,30,60),t.restore(),t.textAlign="center",t.textBaseline="middle",t.fillStyle="yellow",t.font="20px Verdana",i="1990 ProTracker module.;for the original;Horace Wimp of Aurora;;and music.;used for both sfx;the amazing SoundBox Lite;Marcus Geelnard for;;version go as follow :;Credits for this;;Acorn Archimedes.;by Eterna on;released in 1990;original Ballarena;tribute to the;This game is a;;;again for next compo.;and meet you;enjoyed the game,;Hope you;;Ballarena 2013k;You just completed;Congratulations !".split(";"),e=0;e<i.length;++e)t.fillText(i[e],860,20+20*e)},resize:function(){var t=Math.min(window.innerWidth,window.innerHeight);this.canvas.height=this.canvas.width=t,this.context.height=this.context.width=t,this.context.translate(t/2,t/2),this.context.scale(.4*t,-.4*t),this.canvas.style.left=Math.floor((window.innerWidth-t)/2)+"px",this.canvas.style.top=Math.floor((window.innerHeight-t)/2)+"px"},drawMain:function(){if(this.context.save(),this.context.clearRect(0,0,this.context.width,this.context.height),this.resize(),this.drawStarfield(),2==this.game.eventType){if(0==this.twirlingStars.length){for(var t=0;t<this.starfieldCount;++t){var i=this.starfield[t][0]+this.starfieldX,e=this.starfield[t][1]+this.starfieldY,s=this.starfield[t][2]+this.starfieldZ;if((i=i-Math.floor(i)-.5)*i+(e=e-Math.floor(e)-.5)*e<(s=s-Math.floor(s)+.5)*s){var a=i*Math.cos(this.starfieldPhi)-e*Math.sin(this.starfieldPhi);i=e*Math.cos(this.starfieldPhi)+i*Math.sin(this.starfieldPhi);this.twirlingStars.push([2*a/s,2*i/s,.005/s])}}this.starfieldCount=0}for(this.context.save(),t=Math.cos(this.game.level.padAngle[0])*(this.game.level.padRadius-.04),s=Math.sin(this.game.level.padAngle[0])*(this.game.level.padRadius-.04),this.context.translate(t*(50-this.game.transitionTimer)/50,s*(50-this.game.transitionTimer)/50),s=(1+this.game.transitionTimer)/51,this.context.scale(s,s),t=0;t<this.twirlingStars.length;++t)this.context.fillRect(this.twirlingStars[t][0],this.twirlingStars[t][1],this.twirlingStars[t][2]/s,this.twirlingStars[t][2]/s);this.context.restore()}else this.twirlingStars.length=0;if(this.game.transitionToHof?(this.context.save(),this.context.translate(2-this.game.transitionToHof/5,0),this.drawHallOfFame(),this.context.restore()):this.time=0,10>this.game.transitionToHof&&14>this.game.level.level&&(this.context.save(),this.context.translate(-this.game.transitionToHof/5,0),this.drawGame(),this.context.restore()),3==this.game.eventType&&this.game.transitionTimer&&(this.context.save(),this.context.scale(.01,-.01),this.context.fillStyle="black",this.context.strokeStyle="white",this.context.font="64px Verdana",this.context.textAlign="center",this.context.textBaseline="middle",i=.09*(this.game.transitionTimer-50)*(this.game.transitionTimer-50)-20,this.context.fillText("GAME",-i,-30),this.context.strokeText("GAME",-i,-30),this.context.fillText("OVER",i,30),this.context.strokeText("OVER",i,30),this.context.restore()),10>this.game.menuOffset)for(t=this.game.level.time,s="rgb("+(s=Math.round(215-Math.cos(t/20)))+",255,"+(430-s)+")",0==t%3&&0==(1&Math.floor(t/50))&&(s="#FF8080"),this.context.translate(this.game.menuOffset/5,0),this.context.scale(.012,-.012),this.context.textAlign="center",this.context.fillStyle="black",this.context.lineWidth=1.5,this.context.lineJoin="bevel",t=0;5>t;++t)this.context.strokeStyle=this.game.menu.selectedOption==t?s:"#A0A0A0",a=this.menuText[t],this.game.level.level&&(a=4==t?"QUIT":t?a:"RESUME"),a+=1==t?1==this.game.controls.stance?"REGULAR":"GOOFY":"",a+=2==t?this.game.level.soundManager.soundSupport?this.game.level.soundManager.musicOn?"ON":"OFF":"not supported":"",a+=3==t?this.game.level.soundManager.soundSupport?this.game.level.soundManager.soundOn?"ON":"OFF":"not supported":"",this.context.strokeText(a,0,25*t-50),this.context.fillText(a,0,25*t-50);this.context.restore()},drawEndGame:function(){this.context.save(),this.context.clearRect(0,0,this.context.width,this.context.height),this.resize(),this.drawStarfield();for(var t=580,i=-1.25;.5>i;i+=.01){var e=Math.min(580,Math.max(0,930- -1/(i-1)*200-this.time%850)),s=t-Math.floor(e);0==this.time%850?t=580:0<s&&(this.context.globalAlpha=.5-i/2,this.context.drawImage(this.renderBuffer,660,e,400,1,-1+i,i,2-2*i,.01),t=Math.min(t,Math.ceil(e)))}this.context.restore(),++this.time},drawGame:function(){var t=this.game.level;this.context.rotate(-t.cameraRoll),this.context.textAlign="center",this.context.textBaseline="middle";for(var i=0;i<t.floaters.length;++i){this.context.save(),this.context.translate(t.floaters[i].posX,t.floaters[i].posY),this.context.drawImage(this.renderBuffer,600,0,60,60,-t.floaters[i].radius,-t.floaters[i].radius,2*t.floaters[i].radius,2*t.floaters[i].radius);var e=.01+.002*Math.sin(t.time/5);this.context.scale(e,-e),this.context.fillStyle=this.floaterColor[t.floaters[i].item],this.context.fillText(this.floaterSymbol[t.floaters[i].item],0,.5),this.context.restore(),t.floaters[i].hit&&this.meteors.push({x:t.floaters[i].posX,y:t.floaters[i].posY,i:t.floaters[i].item,t:0,r:t.floaters[i].radius})}for(i=0;i<t.bricks.length;++i)8>(e=t.bricks[i].alive?0:t.time-t.bricks[i].timeBlown)&&this.context.drawImage(this.renderBuffer,60*t.bricks[i].color,60*e,60,60,t.bricks[i].posX-t.bricks[i].radius,t.bricks[i].posY-t.bricks[i].radius,2*t.bricks[i].radius,2*t.bricks[i].radius),t.bricks[i].hitEcho&&(this.context.beginPath(),this.context.arc(t.bricks[i].posX,t.bricks[i].posY,t.bricks[i].radius,0,7,0),this.context.fill());for(i=0;i<this.meteors.length;++i)if(50<this.meteors[i].t)this.meteors[i]=this.meteors[this.meteors.length-1],--this.meteors.length,--i;else{e=this.meteors[i].r*(50-this.meteors[i].t)/50,this.context.save(),this.context.lineWidth=.01,this.context.translate(this.meteors[i].x,this.meteors[i].y),this.context.rotate(++this.meteors[i].t/10),this.context.strokeStyle="blue",this.context.beginPath(),this.context.arc(0,0,.95*e,0,7,0),this.context.stroke(),this.context.fillStyle=7==this.meteors[i].i?"red":"white",this.context.beginPath(),this.context.moveTo(e,0);for(var s=0;9>s;++s)this.context.lineTo((1&s?e/4:e)*Math.cos(s*Math.PI/4),(1&s?e/4:e)*Math.sin(s*Math.PI/4));this.context.fill(),this.context.restore()}if(1!=this.game.eventType)for(i=0;i<t.ballsInPlay;++i)this.context.drawImage(this.renderBuffer,600,60,30,30,t.balls[i].posX-t.balls[i].radius,t.balls[i].posY-t.balls[i].radius,2*t.balls[i].radius,2*t.balls[i].radius);if(t.level){for(this.context.rotate(t.cameraRoll),this.context.save(),this.context.scale(.01,-.01),t.newItem&&(t.lastItem!=this.itemDisplayed||115<=this.itemTime)&&(this.itemDisplayed=t.lastItem,this.itemTime=0,this.predrawItemName(0)),this.itemDisplayed&&60>this.itemTime&&(i=(15<this.itemTime?0:.3*(this.itemTime-15)*(this.itemTime-15))-120,e=Math.min(240,120-i),15<this.itemTime&&30>this.itemTime?this.predrawItemName(this.itemTime-15):50<=this.itemTime&&this.predrawItemNameHide(this.itemTime-50),this.context.drawImage(this.renderBuffer,0,480,2.5*e,100,i,-130,e,40),++this.itemTime),this.context.rotate(Math.PI/2),i=0;i<t.lives;++i)this.context.drawImage(this.renderBuffer,600,120,30,30,10*i-85,90,5,5),this.context.drawImage(this.renderBuffer,600,150,30,30,10*i-85,95,5,10),this.context.drawImage(this.renderBuffer,600,180,30,30,10*i-85,105,5,5);if(this.context.rotate(-Math.PI/2),this.context.fillStyle="white",this.context.fillText(t.score,-100,80),this.context.fillStyle="blue",i=13==t.level?"ⅩⅢ":String.fromCharCode(8543+t.level),1==this.game.eventType&&this.game.transitionTimer?(this.context.translate(80-3*this.game.transitionTimer,5*this.game.transitionTimer-80),e=1+this.game.transitionTimer/10,this.context.scale(e,e),this.context.fillText("level",0,-this.game.transitionTimer/e-300/(3+this.game.transitionTimer)),this.context.fillText(i,0,0),this.context.lineWidth=.3,this.context.strokeStyle="rgb(0,"+Math.min(255,4*this.game.transitionTimer)+",255)",this.context.strokeText("level",0,-this.game.transitionTimer/e-300/(3+this.game.transitionTimer)),this.context.strokeText(i,0,0)):this.context.fillText(i,80,-80),this.context.restore(),t.environmentItem)for(this.context.strokeStyle="red",this.context.lineWidth=.02,i=0;12.5*i<t.environmentItemEnd-t.time;++i)this.context.beginPath(),this.context.arc(0,0,1,Math.PI/2-Math.PI*i/12,Math.PI/2-Math.PI*(i/12+1/13),!0),this.context.stroke();if(1!=this.game.eventType)for(this.context.rotate(-t.cameraRoll),i=0;i<t.padCount;++i)this.context.rotate(t.padAngle[i]),this.context.drawImage(this.renderBuffer,600,120,30,30,t.padRadius,-t.padWidth,t.padThickness,t.padThickness),this.context.drawImage(this.renderBuffer,600,150,30,30,t.padRadius,-t.padWidth+t.padThickness,t.padThickness,2*(t.padWidth-t.padThickness)),this.context.drawImage(this.renderBuffer,600,180,30,30,t.padRadius,t.padWidth-t.padThickness,t.padThickness,t.padThickness)}},predrawItemName:function(t){var i=this.renderBuffer.getContext("2d");t||i.clearRect(0,480,600,100),i.globalCompositeOperation="lighter",i.font="64px Verdana",i.strokeStyle="rgba(16, 64, 16, 64)",i.strokeText(";LARGER PAD;SMALLER PAD;EXTRA PAD;LIFE;MULTI BALL;SLOW DOWN BALLS;POISON;SLOW DOWN PADS;;;;;;;;CAMERA ROLL;STEEL BRICKS;MAGNETIC;GRAVITY;STICKY PADS".split(";")[this.itemDisplayed],300-t,530)},predrawItemNameHide:function(t){for(var i=this.renderBuffer.getContext("2d"),e=0;10>e;++e)i.clearRect(0,480+10*e+t,600,1)},drawStarfield:function(){var t=this.game.level.level;this.context.fillStyle="white",this.context.rotate(this.starfieldPhi);for(var i=0;i<this.starfieldCount;++i){var e=this.starfield[i][0]+this.starfieldX,s=this.starfield[i][1]+this.starfieldY,a=this.starfield[i][2]+this.starfieldZ;e=e-Math.floor(e)-.5,s=s-Math.floor(s)-.5,a=a-Math.floor(a)+.5;this.context.fillRect(2*e/a,2*s/a,.005/a,.005/a)}for(this.context.rotate(-this.starfieldPhi),this.starfieldTargetSpeed[0]=[0,.01,0,-.01][3&t],this.starfieldTargetSpeed[1]=[0,0,-.01,.01,0,0][t%6],this.starfieldTargetSpeed[2]=[-.005,0,-.005,0,0,-.01,-.02,0][7&t],this.starfieldTargetSpeed[3]=[.01,0,0,0,-.008][t%4],this.starfieldTargetCount=t||500==this.starfieldTargetCount?100:100==this.starfieldTargetCount?500:this.starfieldTargetCount,this.starfieldX+=this.starfieldSpeed[0],this.starfieldY+=this.starfieldSpeed[1],this.starfieldZ+=this.starfieldSpeed[2],this.starfieldPhi+=this.starfieldSpeed[3],i=0;4>i;++i)t=this.starfieldTargetSpeed[i]-this.starfieldSpeed[i],this.starfieldSpeed[i]+=1e-4>Math.abs(t)?0:0<t?1e-4:-1e-4;this.starfieldCount+=this.starfieldTargetCount==this.starfieldCount?0:this.starfieldTargetCount>this.starfieldCount?1:-1},drawHallOfFame:function(){this.context.scale(.025,-.025),this.context.textAlign="center",this.context.lineWidth=.3;for(var t=15;0<t;--t)this.context.strokeStyle="rgb("+(255-17*t)+","+(255-17*t)+","+(255-17*t)+")",this.context.strokeText("Hall of Fame",.2*t*Math.cos(-t+this.time),-t/3-35);for(this.context.fillStyle="black",this.context.fillText("Hall of Fame",0,-35),-1<this.game.signingToHof?this.time=(8*this.time+30*this.game.signingToHof)/9:++this.time,this.context.scale(.4,.4),this.context.rotate(-.01*this.time),this.context.textBaseline="middle",t=0;16>t;++t)this.context.fillStyle="rgb("+(255-17*t)+","+17*t+","+(t==this.game.signingToHof?255:0)+")",this.context.textAlign="left",this.context.font="6px Verdana",this.context.fillText(1+t+".",18,0),this.context.font="7px Verdana",this.context.scale(1,1.5),this.context.fillText(this.game.hof[t][0],30,0),this.context.textAlign="right",this.context.scale(1,1.7),this.context.fillText(this.game.hof[t][1],86,0),this.context.scale(1,1/2.55),this.context.rotate(.3)}},Ball.prototype={},Brick.prototype={moveTo:function(t,i){this.posX=t,this.posY=i},receiveHit:function(t){return--this.hitPoints?++this.color:this.explode(t),!this.hitPoints},explode:function(t){this.alive=!1,this.timeBlown=t}},CircularPath.prototype={positionAt:function(t){return{x:this.radius*Math.cos(this.speed*t),y:this.radius*Math.sin(this.speed*t)}}},DoubleCircularPath.prototype={positionAt:function(t){return{x:this.radius*Math.cos(this.speed*t)+this.radius2*Math.cos(this.speed2*t),y:this.radius*Math.sin(this.speed*t)+this.radius2*Math.sin(this.speed2*t)}}},HarmonicPath.prototype={positionAt:function(t){return{x:(this.radius+this.radius2*Math.cos(this.speed2*t))*Math.cos(this.speed*t),y:(this.radius+this.radius2*Math.cos(this.speed2*t))*Math.sin(this.speed*t)}}},OscillatingPath.prototype={positionAt:function(t){var i=this.speed1*t;return{x:(t=this.deltaX+this.radiusX*Math.cos(this.speed2*t+this.shift2))*Math.cos(i)-this.offsetY*Math.sin(i),y:t*Math.sin(i)+this.offsetY*Math.cos(i)}}},FlowerPath.prototype={positionAt:function(t){return{x:Math.cos(this.speed*t)/(this.coefA+this.coefB*Math.sin(this.speed*this.coefC*t)),y:Math.sin(this.speed*t)/(this.coefA+this.coefB*Math.sin(this.speed*this.coefC*t))}}},LissajousPath.prototype={positionAt:function(t){return{x:this.radius*Math.cos(this.sx*t),y:this.radius*Math.sin(this.sy*t)}}},PulsatingPath.prototype={positionAt:function(t){var i=this.speed*t+this.offset;t=this.speed2*t+this.angleShift*(Math.floor(i/(this.period+1))+((Math.floor(i)&this.period)==this.period?.5*(1+Math.cos(i*Math.PI)):0));return{x:(i=(Math.floor(i)&this.period)==this.period?1+this.zoom*(1-Math.cos(2*i*Math.PI)):1)*(this.x*Math.cos(t)+this.y*Math.sin(t)),y:i*(-this.x*Math.sin(t)+this.y*Math.cos(t))}}},CollisionHandler.prototype={testBrickHits:function(){for(var t=!1,i=0;i<this.level.ballsInPlay;++i)for(var e=0;e<this.level.bricks.length;++e)if(this.level.bricks[e].alive){var s=this.level.bricks[e].posX-this.level.balls[i].posX,a=this.level.bricks[e].posY-this.level.balls[i].posY,h=this.level.balls[i].radius+this.level.bricks[e].radius;Math.sqrt(s*s+a*a)<h&&(t=!0,this.level.hitBrick(e),s=Math.atan2(a,s),this.level.balls[i].heading=2*s-Math.PI-this.level.balls[i].heading)}return t},testPadHits:function(){for(var t=!1,i=0;i<this.level.ballsInPlay;++i)if(0>this.level.balls[i].stuckOnPad)for(var e=0,s=0;s<this.level.padCount;++s)if(e+=this.level.padAngle[s],0<=Math.cos(e-this.level.balls[i].heading)){var a=Math.cos(e),h=Math.sin(e);Math.abs(a*this.level.balls[i].posX+h*this.level.balls[i].posY-this.level.padRadius)<this.level.balls[i].radius&&(a=-h*this.level.balls[i].posX+a*this.level.balls[i].posY,Math.abs(a)<this.level.padWidth&&(t=!0,20==this.level.environmentItem?(this.level.balls[i].stuckOnPad=s,this.level.balls[i].offsetOnPad=a):this.level.balls[i].heading=2*(e+Math.PI)-Math.PI-this.level.balls[i].heading))}return t},testFloaterHits:function(){for(var t=0,i=[],e=0;e<this.level.padCount;++e){t=t+this.level.padAngle[e];for(var s=Math.cos(t),a=Math.sin(t),h=0;h<this.level.floaters.length;++h)Math.abs(s*this.level.floaters[h].posX+a*this.level.floaters[h].posY-this.level.padRadius-.5*this.level.padThickness)<this.level.floaters[h].radius+.5*this.level.padThickness&&Math.abs(-a*this.level.floaters[h].posX+s*this.level.floaters[h].posY)<this.level.padWidth&&(i.push([this.level.floaters[h].item,e]),this.level.floaters[h].hit=!0)}for(t=0;t<i.length;++t)this.level.itemActivated(i[t][0],i[t][1]);return 0<i.length}},Controls.prototype={partialClear:function(){this.controlEscape=this.controlFire=this.controlDown=this.controlUp=!1,this.areaClicked=this.lastKeyDown=0},totalClear:function(){this.partialClear(),this.mouseControlRight=this.mouseControlLeft=this.controlRight=this.controlLeft=!1},toggleStance:function(){this.stance*=-1},getAngularDirection:function(){return this.stance*((this.controlLeft||this.mouseControlLeft?-1:0)+(this.controlRight||this.mouseControlRight?1:0))},onKeyUp:function(t){return!this.keyControl(t,!1)},onKeyDown:function(t){return!this.keyControl(t,!0)},mouseControl:function(t,i,e){switch(i){case 8:this.mouseControlLeft=e;break;case 9:this.mouseControlRight=e;break;default:i=document.getElementById("c").style.top;var s=Math.min(window.innerWidth,window.innerHeight);0<s&&(.2<(t=(t.clientY-parseInt(i))/s)&&.8>t&&e&&(this.areaClicked=Math.floor((t-.08)/.12)),this.controlEscape|=.2>t),this.controlFire=this.controlFire||e}return!0},keyControl:function(t,i){var e=!0,s=window.event?window.event.keyCode:t.which;switch(i&&(this.lastKeyDown=s),s){case 37:case 74:this.controlLeft=i;break;case 38:case 65:this.controlUp=i;break;case 39:case 75:this.controlRight=i;break;case 40:case 81:this.controlDown=i;break;case 32:case 13:this.controlFire=i;break;case 80:case 27:this.controlEscape=i;break;default:e=!1}return e}},Floater.prototype={move:function(t){var i=Math.sqrt(this.posX*this.posX+this.posY*this.posY),e=Math.atan2(this.posY,this.posX);i+=this.speedR,e+=this.constantPhi+this.phiAmplitude*Math.cos(this.phiFrequency*(t-this.t0));return this.posX=i*Math.cos(e),this.posY=i*Math.sin(e),i}},Game.prototype={launchMenu:function(){this.menu.initialize(),this.startLevel(0),this.menu.active=!0,this.eventType=0;var t=this;this.intervalId=setInterval((function(){t.mainLoop()}),40)},startGame:function(){this.level.initialize(),this.score=0,this.startLevel(1)},startLevel:function(t){this.level.createContents(t),t&&this.level.giveInitialBall(!0)},mainLoop:function(){if(this.level.level&&this.controls.controlEscape&&3!=this.eventType&&(this.menu.active=!0,this.menu.done=!1,this.controls.partialClear()),this.menuOffset=this.menu.active?Math.max(this.menuOffset-1,0):Math.min(this.menuOffset+1,10),this.level.animateItems(!this.menu.active),this.renderer.drawMain(),this.menu.active&&(this.menu.processEvents(),this.menu.done&&(this.menu.selectedOption?(this.eventType=3,this.transitionTimer=1):this.level.level||this.startGame())),this.controls.partialClear(),this.transitionTimer)if(--this.transitionTimer)3==this.eventType&&10>this.transitionTimer&&(this.transitionToHof=Math.min(this.transitionToHof+1,10));else switch(this.eventType){case 1:this.startLevel(this.level.level);break;case 2:this.level.giveInitialBall(!1);break;case 3:this.level.ballsInPlay=0,clearInterval(this.intervalId),this.recordScore(this.level.score),this.level.score=0,this.hofLoop();break;case 4:this.level.ballsInPlay=0,clearInterval(this.intervalId),this.endGameLoop()}else this.eventType=0,this.transitionToHof=Math.max(this.transitionToHof-1,0),this.level.level&&(this.level.lost()&&(this.level.soundManager.playBallLoss(),this.transitionTimer=this.level.lives?50:100,this.eventType=this.level.lives?2:3,--this.level.lives),this.level.won())&&(++this.level.level,this.transitionTimer=14==this.level.level?1:70,this.eventType=14==this.level.level?4:1)},endGameLoop:function(){if(this.renderer.drawEndGame(),this.controls.controlFire)this.controls.totalClear(),this.recordScore(this.level.score),this.hofLoop();else{var t=this;setTimeout((function(){t.endGameLoop()}),40)}},hofLoop:function(){if(this.transitionToHof=Math.min(this.transitionToHof+1,10),this.menuOffset=Math.min(this.menuOffset+1,10),-1<this.signingToHof&&(8==this.controls.lastKeyDown||46==this.controls.lastKeyDown?this.hof[this.signingToHof][0]=this.hof[this.signingToHof][0].substr(0,Math.max(0,this.hof[this.signingToHof][0].length-1)):31<this.controls.lastKeyDown&&8>this.hof[this.signingToHof][0].length&&(this.hof[this.signingToHof][0]+=String.fromCharCode(this.controls.lastKeyDown)),13==this.controls.lastKeyDown&&("CHEATER"==this.hof[this.signingToHof][0]&&(this.level.canCheat=!0),this.signingToHof=-1),this.controls.totalClear()),this.renderer.drawMain(),this.controls.controlFire)this.launchMenu();else{var t=this;setTimeout((function(){t.hofLoop()}),40)}},setRenderer:function(t){this.renderer=t},recordScore:function(t){this.signingToHof=-1;for(var i=0;i<this.hof.length&&-1==this.signingToHof;++i)t>this.hof[i][1]&&(this.signingToHof=i);if(-1<this.signingToHof){for(i=this.hof.length-1;i>this.signingToHof;--i)this.hof[i]=this.hof[i-1];this.hof[this.signingToHof]=["",t]}}},Level.prototype={initialize:function(){this.padCount=2,this.padAngle=[0,3.1416],this.padSpeed=.05,this.padWidth=.16,this.score=this.environmentItemEnd=this.environmentItem=this.time=this.floaters.length=0,this.lives=3,this.cameraRoll=0,this.ballMinSpeed=.02,this.lastItem=0},createContents:function(t){switch(this.floaters.length=0,this.bricks.length=0,t){case 1:this.createLevel1();break;case 2:this.createLevel2();break;case 3:this.createLevel3();break;case 4:this.createLevel4();break;case 5:this.createLevel5();break;case 6:this.createLevel6();break;case 7:this.createLevel7();break;case 8:this.createLevel8();break;case 9:this.createLevel9();break;case 10:this.createLevel10();break;case 11:this.createLevel11();break;case 12:this.createLevel12();break;case 13:this.createLevel13();break;default:this.createLevel0()}this.bricksLeft=this.bricks.length,this.level=t},giveInitialBall:function(t){this.padCount=2,1==this.padAngle.length&&this.padAngle.push(Math.PI),!t&&this.padAngle.length||(this.padAngle=[0,3.1416]),this.padAngle.length=2,this.padSpeed=.05,this.padWidth=.16,this.ballsInPlay=1,this.balls[0]=new Ball(0),this.balls.length=1,this.environmentItemEnd=this.environmentItem=this.cameraRoll=0},won:function(){return!this.bricksLeft},lost:function(){return!this.ballsInPlay},animateItems:function(t){if(t&&this.padCount){this.padAngle[0]+=this.controls.getAngularDirection()*this.padSpeed,16==this.environmentItem&&(this.cameraRoll+=this.controls.getAngularDirection()*this.padSpeed,this.cameraRoll+=this.cameraRoll>Math.PI?-2*Math.PI:this.cameraRoll<-Math.PI?2*Math.PI:0);for(var i=2*Math.PI/this.padCount,e=1;e<this.padCount;++e)this.padAngle[e]=.01>Math.abs(this.padAngle[e]-i)?i:this.padAngle[e]+(this.padAngle[e]>i?-.01:.01)}for(this.ballsInPlay||(e=0<this.cameraRoll?-.05:.05,Math.abs(e)>Math.abs(this.cameraRoll)&&(e=-this.cameraRoll),this.cameraRoll+=e),120==this.controls.lastKeyDown&&this.canCheat&&(this.bricksLeft=0),e=0;e<this.ballsInPlay&&t;++e){if(-1<this.balls[e].stuckOnPad&&this.controls.controlFire&&(this.balls[e].heading=this.padAngle[this.balls[e].stuckOnPad]+Math.PI+this.balls[e].offsetOnPad/200,this.balls[e].stuckOnPad=-1),-1<this.balls[e].stuckOnPad&&!this.controls.controlFire)i=this.padAngle[this.balls[e].stuckOnPad],this.balls[e].posX=Math.cos(i)*(this.padRadius-this.balls[e].radius)-Math.sin(i)*this.balls[e].offsetOnPad,this.balls[e].posY=Math.sin(i)*(this.padRadius-this.balls[e].radius)+Math.cos(i)*this.balls[e].offsetOnPad;else{i=this.balls[e].speed*Math.cos(this.balls[e].heading);var s=this.balls[e].speed*Math.sin(this.balls[e].heading);if(18==this.environmentItem||19==this.environmentItem){var a=this.balls[e].posX*this.balls[e].posX+this.balls[e].posY*this.balls[e].posY;i=i+this.balls[e].posX*(18==this.environmentItem?-.001/(a+.01):2e-4/(a+.01)),s=s+this.balls[e].posY*(18==this.environmentItem?-.001/(a+.01):2e-4/(a+.01));this.balls[e].heading=Math.atan2(s,i),this.balls[e].speed=Math.sqrt(i*i+s*s)}else this.balls[e].speed+=this.balls[e].speed<this.ballMinSpeed?2e-4:0;this.balls[e].posX+=i,this.balls[e].posY+=s}this.balls[e].posX*this.balls[e].posX+this.balls[e].posY*this.balls[e].posY>this.lossDistanceSq&&(--this.ballsInPlay,this.balls[e]=this.balls[this.ballsInPlay],--this.balls.length,--e)}for(e=0;e<this.bricks.length;++e)this.bricks[e].hitEcho=!1,this.bricks[e].path&&(t=this.bricks[e].path.positionAt(this.time+this.bricks[e].relativeTime),this.bricks[e].posX=t.x,this.bricks[e].posY=t.y),7==this.level&&(this.bricks[e].radius=.08+.02*Math.cos(.1*this.time+this.bricks[e].relativeTime)),12==this.level&&this.ballsInPlay&&(t=this.bricks[e].posX-this.balls[0].posX,i=this.bricks[e].posY-this.balls[0].posY,this.bricks[e].radius=Math.min(.03+.1*(t*t+i*i),.1));for(e=0;e<this.floaters.length;++e)(this.floaters[e].move(this.time)>this.lossDistanceSq||this.floaters[e].hit)&&(this.deleteFloater(e),--e);this.newItem=!1,this.collisionHandler.testBrickHits()&&this.soundManager.playBrickHit(),this.collisionHandler.testPadHits()&&this.soundManager.playPadHit(),this.collisionHandler.testFloaterHits()&&this.soundManager.playFloaterCaught(),++this.time,this.time>=this.environmentItemEnd&&(this.environmentItem=0)},hitBrick:function(t){17==this.environmentItem?this.bricks[t].hitEcho=!0:this.bricks[t].receiveHit(this.time)&&(.8<Math.random()&&this.createFloater(t),--this.bricksLeft,this.score+=10*this.bricks[t].value*(9+this.ballsInPlay)*(12-this.padCount))},itemActivated:function(t,i){switch(this.lastItem=t,this.newItem=!0,t){case 1:this.padWidth=Math.min(this.padWidth+.04,.32);break;case 2:this.padWidth=Math.max(this.padWidth-.04,.08);break;case 3:this.padAngle.push(Math.PI/this.padCount),++this.padCount;break;case 4:++this.lives;break;case 5:for(var e=0,s=0;s<this.ballsInPlay;++s)if(-1==this.balls[s].stuckOnPad){var a=Object.create(this.balls[s]);a.heading+=Math.PI,this.balls.push(a),++e}this.ballsInPlay+=e;break;case 6:for(s=0;s<this.ballsInPlay;++s)this.balls[s].speed-=.005;break;case 7:for(e=i+1;e<this.padCount;++e)this.padAngle[e-1]=this.padAngle[e]+(e==i+1?this.padAngle[e-1]:0);--this.padAngle.length,--this.padCount;break;case 8:this.padSpeed=Math.max(this.padSpeed-.01,.03)}15<t&&(this.environmentItem=t,this.environmentItemEnd=this.time+300)},createFloater:function(t){t=this.bricks[t];var i=1+Math.floor(13*Math.random());this.floaters.push(new Floater(t.posX,t.posY,this.time,i+(8<i?7:0)))},deleteFloater:function(t){this.floaters[t]=this.floaters[this.floaters.length-1],--this.floaters.length},createLevel0:function(){for(var t=[[3,2,1,1,2,3,7,3,2,0,3,2,2,3,1],[5,5,1,1,5,5,1,5,5,0,4,5,3,4,1],[3,7,1,1,7,3,7,5,7,0,2,5,2,2,5],[5,5,1,1,5,5,1,5,5,0,1,5,2,4,3],[7,5,7,7,5,5,7,5,5,0,7,2,2,3,5]],i=0;i<t.length;++i)for(var e=new CircularPath(.95-.09*i,.03),s=0;s<t[i].length;++s)for(var a=0;3>a;++a)if(t[i][s]&1<<a){var h=new Brick(0,0,7&s);h.path=e,h.relativeTime=-3.2*(a+4*s),h.radius=.04,this.bricks.push(h)}},createLevel1:function(){this.bricks.push(new Brick(0,0,2));for(var t=1;3>t;++t)for(var i=0;i<6*t;++i)this.bricks.push(new Brick(.24*t*Math.cos(6.28*i/(6*t)),.24*t*Math.sin(6.28*i/(6*t)),2-t))},createLevel2:function(){for(var t=1;4>t;++t)for(var i=new CircularPath(.24*t-.12,.03),e=[0,3,6,6][t],s=0;s<e;++s){var a=new Brick(0,0,4+(6==e&&1&s?1:0)+(3==t?1:0));a.path=i,a.relativeTime=210*s/e+5*t,this.bricks.push(a)}},createLevel3:function(){this.bricks.push(new Brick(0,0,0));for(var t=1;4>t;++t)for(var i=new CircularPath(.18*t,1&t?.03:-.03),e=0;e<6*t;++e){var s=new Brick(0,0,[0,1,4,3][t]);s.path=i,s.relativeTime=35*e/t,this.bricks.push(s)}},createLevel4:function(){for(var t=0;3>t;++t)for(var i=new DoubleCircularPath(.38,2e-4,.2,.03),e=0;6>e;++e){var s=new Brick(0,0,[1,4,6][t]);s.path=i,s.relativeTime=35*e+10500*t,this.bricks.push(s)}},createLevel5:function(){for(var t=new HarmonicPath(.2,.015,.05,.045),i=0;6>i;++i){var e=new Brick(0,0,3);e.radius=.06,e.path=t,e.relativeTime=280*i/4,this.bricks.push(e)}for(t=new HarmonicPath(.55,.015,.08,.09),i=0;24>i;++i)(e=new Brick(0,0,6)).radius=.06,e.path=t,e.relativeTime=70*i/4,this.bricks.push(e)},createLevel6:function(){for(var t=0;24>t;++t){var i=new OscillatingPath(.18*Math.floor(t/6)-.27,.3,t%6*.18-.5,.015,.045,3.1416*t),e=new Brick(0,0,[5,8][1&t]);e.path=i,e.relativeTime=0,this.bricks.push(e)}},createLevel7:function(){this.bricks.push(new Brick(0,0,8));for(var t=1;3>t;++t)for(var i=0;i<6*t;++i){var e=new Brick(.24*t*Math.cos(6.28*i/(6*t)),.24*t*Math.sin(6.28*i/(6*t)),[8,6,8][t]);e.relativeTime=i+2*t,e.hitPoints=2,this.bricks.push(e)}},createLevel8:function(){for(var t=0;6>t;++t){var i=new Brick(0,0,1),e=.6*Math.cos(Math.PI*t/3),s=.6*Math.sin(Math.PI*t/3);e=new PulsatingPath(e,s,Math.PI/6,.03,-.33,1,.01,0);i.path=e,this.bricks.push(i)}for(t=0;6>t;++t)i=new Brick(0,0,4),e=new PulsatingPath(e=.4*Math.cos(Math.PI*(t+.25)/3),s=.4*Math.sin(Math.PI*(t+.25)/3),Math.PI/6,.03,-.33,1,.01,Math.PI),i.path=e,this.bricks.push(i)},createLevel9:function(){for(var t=new LissajousPath(.4,.03,.02),i=0;20>i;++i){var e=new Brick(0,0,7);e.path=t,e.relativeTime=6.28*i/.2,this.bricks.push(e)}},createLevel10:function(){for(var t=0;16>t;++t){var i=new Brick(0,0,[0,2,3,4][t>>2]),e=new PulsatingPath([0,1,0,-1,-1,-2,-3,-2,0,-1,0,1,1,2,3,2][t]/8,[1,2,3,2,0,1,0,-1,-1,-2,-3,-2,0,-1,0,1][t]/8,Math.PI/2,.03,1,7,0,0);i.path=e,this.bricks.push(i)}},createLevel11:function(){for(var t=0;6>t;++t)for(var i=0;3>i;++i){var e=new Brick(0,0,[2,8,4,8,7,8][t]),s=new PulsatingPath(s=[.6,.3,.6][i]*Math.cos(2*Math.PI*(t/6+(i-1)/28)),[.6,.3,.6][i]*Math.sin(2*Math.PI*(t/6+(i-1)/28)),-Math.PI/6,.03,-.4,3,0,0);e.path=s,this.bricks.push(e)}},createLevel12:function(){this.bricks.push(new Brick(0,0,8));for(var t=1;3>t;++t)for(var i=0;i<6*t;++i)this.bricks.push(new Brick(.24*t*Math.cos(6.28*i/(6*t)),.24*t*Math.sin(6.28*i/(6*t)),[8,1,8][t]))},createLevel13:function(){for(var t=[[5,2,9,0],[2,2,9,0],[5,2,9,0]],i=0;3>i;++i){for(var e=new CircularPath(.6-.09*i,.03),s=0;16>s;++s)for(var a=0;4>a;++a)if(t[i][3&s]&1<<a){var h=new Brick(0,0,[1,6,2,7][s>>2]);h.path=e,h.relativeTime=-3.2*(a+4*s),h.radius=.04,this.bricks.push(h)}for(s=0;3>s;++s)for(a=0;4>a;++a)t[i][3&s]&1<<a&&((h=new Brick(.05*(a+4*s-5.6),.1*(i-1),0)).radius=.04,h.hitPoints=7,this.bricks.push(h))}}},MenuDriver.prototype={initialize:function(){this.done=!1,this.selectedOption=0,this.controls.totalClear()},getSelectedOption:function(){return this.selectedOption},processEvents:function(){if(this.selectedOption+=(this.controls.controlUp&&0<this.selectedOption?-1:0)+(this.controls.controlDown&&this.selectedOption<this.optionCount-1?1:0),this.controls.areaClicked&&(this.selectedOption=this.controls.areaClicked-1),this.controls.controlFire)switch(this.selectedOption){case 1:this.controls.toggleStance();break;case 2:this.soundManager.toggleMusic();break;case 3:this.soundManager.toggleSound();break;default:this.done=!0,this.active=!1}this.controls.totalClear()}};var CPlayer=function(){var t=function(t){return Math.sin(6.283184*t)},i=[t,function(t){return.5>t%1?1:-1},function(t){return t%1*2-1},function(t){return 2>(t=t%1*4)?t-1:3-t}];this.init=function(t,i,e){this.firstRow=0,this.lastRow=t.endPattern-2,this.firstCol=0,this.lastCol=t.songData.length-1,this.globalVolume=i||1,e&&(this.firstRow=e.firstRow,this.lastRow=e.lastRow,this.firstCol=e.firstCol,this.lastCol=e.lastCol),this.song=t,this.numSamples=32*t.rowLen*(this.lastRow-this.firstRow+1),this.numWords=2*this.numSamples,this.chnBufWork=new Int32Array(this.numWords),this.mixBufWork=new Int32Array(this.numWords),this.currentCol=this.firstCol,this.currentRow=this.firstRow},this.generate=function(){var e,s,a,h,o,n,r,l,c,d,f=this.chnBufWork,u=this.mixBufWork;a=this.numWords;var p=this.song.songData[this.currentCol],m=this.song.rowLen;if(this.currentRow==this.firstRow)for(s=0;s<a;s++)f[s]=0;var v,g=0,x=0;d=!1;var b=(b=this.currentRow+8)>this.lastRow?this.lastRow:b;for(s=this.currentRow;s<=b;++s){for(o=p.p[s],a=0;32>a;++a){(c=o?p.c[o-1].fx[a]:0)&&(p.i[c-1]=p.c[o-1].fx[a+32]||0),v=i[p.i[0]];var M=p.i[1],w=p.i[3],k=i[p.i[4]],C=p.i[5],T=p.i[8],y=p.i[9],P=4*p.i[10]*p.i[10],I=4*p.i[11]*p.i[11],S=4*p.i[12]*p.i[12],F=i[p.i[13]],A=p.i[14]/512,B=Math.pow(2,p.i[15]-9)/m,L=p.i[16],R=p.i[17],H=135.82764118168*p.i[18]/44100,O=1-p.i[19]/255,E=1e-5*p.i[20],D=p.i[21]/32,W=p.i[22]/512,Y=6.283184*Math.pow(2,p.i[23]-9)/m,X=p.i[24]/255,G=p.i[25]*m;for(c=(32*(s-this.firstRow)+a)*m,h=0;4>h;++h)if(e=o?p.c[o-1].n[a+32*h]:0){var z=.003959503758*Math.pow(2,(e+p.i[2]-128-128)/12),K=.003959503758*Math.pow(2,(e+p.i[6]-128-128)/12)*(1+8e-4*p.i[7]),N=0,U=0;for(e=0;e<P+I+S;e++)r=1,e<P?r=e/P:e>=P+I&&(r-=(e-P-I)/S),n=z,w&&(n*=r*r),l=v(N+=n)*M,n=K,T&&(n*=r*r),l+=k(U+=n)*C,y&&(l+=(2*Math.random()-1)*y),f[2*(c+e)]+=80*l*r|0}for(e=0;e<m;e++)(l=f[h=2*(c+e)])||d?(d=H,L&&(d*=F(B*h)*A+.5),x+=(d=1.5*Math.sin(d))*(l=O*(l-x)-(g+=d*x)),l=3==R?x:1==R?l:g,E&&(l=1>(l*=E)?-1<l?t(.25*l):-1:1,l/=E),d=1e-5<(l*=D)*l,v=l*(1-(n=Math.sin(Y*h)*W+.5)),l*=n):v=0,h>=G&&(v+=f[h-G+1]*X,l+=f[h-G]*X),f[h]=0|v,f[h+1]=0|l,u[h]+=v*this.globalVolume|0,u[h+1]+=l*this.globalVolume|0}this.currentRow++}return this.currentRow>this.lastRow&&(this.currentRow=this.firstRow,this.currentCol++),{done:this.currentCol>this.lastCol,progress:(this.currentCol-this.firstCol+(this.currentRow-this.firstRow)/(this.lastRow-this.firstRow+1))/(this.lastCol-this.firstCol+1)}},this.createWave=function(){var t,i,e,s,a,h=this.mixBufWork,o=this.numWords;for(this.chnBufWork=null,i=(t=2*o-8)-36,s=String.fromCharCode(82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&i,i>>8&255,i>>16&255,i>>24&255),t=0;t<o;){for(e="",i=0;256>i&&t<o;++i,t++)a=-32767>(a=h[t])?-32767:32767<a?32767:a,e+=String.fromCharCode(255&a,a>>8&255);s+=e}return s},this.getData=function(t,i){for(var e=2*Math.floor(44100*t),s=Array(i),a=this.mixBufWork,h=0;h<2*i;h+=1){var o=e+h;s[h]=0<t&&o<a.length?a[o]/32768:0}return s}};function SoundManager(){this.musicOn=this.soundOn=!0}SoundManager.prototype={initialize:function(t,i){try{this.audioFloater=new Audio;var e=this.audioFloater.canPlayType("audio/wav");this.soundSupport="probably"==e||"maybe"==e}catch(t){this.soundSupport=!1}if(this.soundSupport){this.context=t,this.game=i,t.fillStyle="white",t.fillText("decrunching",120,10);var s=this;setTimeout((function(){s.init2()}),1)}else this.musicOn=this.soundOn=!1,i.launchMenu()},init2:function(){var t=new CPlayer;t.init({songData:[{i:[0,255,152,0,0,255,152,12,0,0,2,0,60,0,0,0,0,2,255,0,0,32,47,3,157,2],p:[1],c:[{n:[123],fx:[]}]}],rowLen:5513,endPattern:2}),t.generate(),this.audioFloater=new Audio("data:audio/wav;base64,"+btoa(t.createWave())),(t=new CPlayer).init({songData:[{i:[2,100,135,0,3,201,128,0,0,0,0,0,40,0,195,4,1,3,50,184,119,160,147,6,84,6],p:[1],c:[{n:[123,,134,,132,,130,,128,,127,,,,,,,,,,,,,,,,,,,,,,123,,122,,120,,118,,116,,115],fx:[]}]}],rowLen:5513,endPattern:2}),t.generate(),this.audioBallLoss=new Audio("data:audio/wav;base64,"+btoa(t.createWave())),(t=new CPlayer).init({songData:[{i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,2,14,0,14,39,76,5,0,0],p:[1],c:[{n:[147],fx:[]}]}],rowLen:5513,endPattern:2}),t.generate(),this.audioPadHit=new Audio("data:audio/wav;base64,"+btoa(t.createWave())),(t=new CPlayer).init({songData:[{i:[3,255,128,0,0,255,140,0,0,127,2,2,23,0,96,3,1,3,137,79,0,32,84,2,12,4],p:[1],c:[{n:[135],fx:[]}]}],rowLen:5513,endPattern:2}),t.generate(),this.audioBrickHit=new Audio("data:audio/wav;base64,"+btoa(t.createWave())),this.songGen5=new CPlayer,this.songGen5.init({songData:[{i:[1,255,128,0,1,154,128,9,0,0,7,5,52,0,0,0,0,2,255,0,0,33,47,3,146,2],p:[5,1,2,3,4,,,,,6,7,6,7,8,9,10,,1,2,3,4],c:[{n:[161,,,,,,163,,164,,163,,161,,,,159,,,,156,,,,154,,,,159],fx:[]},{n:[161,,163,,161,,159,,161,,,,159,,,,161,,,,,,,,,,,,161,,163],fx:[]},{n:[164,,,,168,,,,166,,164,,163,,,,164,,163,,161,,,,163,,161,,159],fx:[]},{n:[161,,,,166,,,,163,,,,159,,,,161],fx:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,156],fx:[,,,,,22,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,33]},{n:[161,,156,,156,,163,,156,,156,,161,,163,,164,,156,,156,,168,,156,,156,,164,,163],fx:[]},{n:[164,,159,,159,,168,,159,,159,,169,,166,,168,,159,,159,,164,,159,,159,,164,,163],fx:[]},{n:[169,,161,,161,,166,,161,,161,,168,,169,,166,,157,,157,,166,,157,,161,,166,,169],fx:[]},{n:[168,,159,,159,,164,,159,,159,,168,,166,,164,,156,,156,,159,,156,,159,,164,,168],fx:[]},{n:[166,,154,,154,,159,,154,,154,,163,,164,,163,,151,,151,,159,,151,,151,,161,,163],fx:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[,1,2,3,4,1,2,3,4,5,6,5,6,7,8,9,10],c:[{n:[149,,,,,,149,,147,,,,147,,,,152,,,,,,,,147],fx:[]},{n:[145,,,,140,,145,,147,,,,142,,147,,149,,,,,,144,,137,,,,149,,147],fx:[]},{n:[152,,,,,,152,,147,,,,,,147,,149,,,,149,,149,,144,,,,156,,145],fx:[]},{n:[145,,,,140,,145,,147,,,,,,159,,149,,,,144,,149],fx:[]},{n:[149,,,,161,,149,,,,156,,152,,151,,149,,,,161,,149,,,,147,,149,,151],fx:[]},{n:[152,,,,168,,152,,,,147,,152,,151,,152,,,,164,,152,,,,147,,156,,152],fx:[]},{n:[154,,,,169,,154,,,,166,,161,,157,,154,,,,166,,154,,,,149,,154,,149],fx:[]},{n:[152,,,,168,,152,,,,147,,149,,147,,152,,,,164,,152,,,,164,,168,,164],fx:[]},{n:[147,,,,159,,147,,,,147,,154,,151,,147,,,,159,,147,,,,159,,157,,159],fx:[]},{n:[144,,,,156,,151,,,,151,,154,,156,,144,,,,156,,160,,,,156,,158,,160],fx:[]}]},{i:[1,255,128,0,1,154,128,9,0,0,7,5,52,0,0,0,0,2,255,0,0,32,47,3,146,2],p:[,,,,,,,,,,,,,,,,1],c:[{n:[160,,156,,156,,161,,156,,156,,160,,161,,163,,156,,156,,168,,156,,166,,164,,163],fx:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[,,,,,,,,,,,,,,,,,2,1,3,4],c:[{n:[169,,,,,,,,166,,,,169,,,,168,,,,,,164,,161,,,,159],fx:[]},{n:[164,,,,166,,168,,166,,,,164,,,,164,,,,159,,,,163,,,,166],fx:[]},{n:[168,,,,159,,,,163,,,,,,166,,168,,,,164,,,,156,,,,163,,159],fx:[]},{n:[157,,,,,,,,159,,,,,,,,164,,,,163,,,,161,,,,156],fx:[]}]},{i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,2,14,0,1,39,76,5,0,0],p:[,1,2,1,2,1,2,1,2,3,4,3,4,3,4,3,4,1,2,1,2],c:[{n:[148,,,,,,,,,,,,,,,,148,,,,,,,,,,,,148],fx:[]},{n:[148,,,,,,,,,,,,,,148,,148,,,,,,,,,,,,148],fx:[]},{n:[149,,,,,,149,,,,149,,,,149,,149,,,,,,149,,,149,149,,,,149],fx:[]},{n:[149,,,,,,149,,,,149,,,,149,,149,,,,,,149,,,149,,149,,,149],fx:[]}]},{i:[3,0,128,0,3,68,128,0,1,218,4,4,40,1,55,4,1,2,67,115,124,190,67,6,39,1],p:[,1,1,1,1,1,1,1,1,,,,,,,,,1,1,1,1],c:[{n:[,,161,,153,,161,,,,,,,,,,,,161,,153,,161],fx:[]}]},{i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,2,14,0,1,39,76,5,0,0],p:[,1,2,1,3,1,2,1,4,5,6,5,6,5,6,5,6,1,2,1,3],c:[{n:[,,,,,,,,160,,,,,,,,,,,,,,,,160],fx:[]},{n:[,,,,,,,,160,,,,,,,,,,,,,,,,160,,160,,,,160],fx:[]},{n:[,,,,,,,,160,,,,,,,,,,,,,,,,160,,160,,160,,160],fx:[]},{n:[,,,,,,,,160,,,,,,,,,,,,,,,,160,157,157,157,157,157,157,157],fx:[]},{n:[,,,,157,,,,,,,,157,,,,,,,,157,,,,,,,,157,,,157],fx:[]},{n:[,,,,157,,,,,,,,157,,,,,,,,157,,,,,,157,,157,157,,157],fx:[]}]},{i:[1,192,128,0,1,192,116,9,0,0,6,22,34,0,69,3,1,1,23,167,0,0,77,6,25,6],p:[,,,,,1,2,3,4],c:[{n:[161,,156,161,,156,163,,164,163,163,164,161,163,164,161,159,164,161,159,156,161,159,156,154,159,156,154,159,156,154,159],fx:[,,22,22,,22,22,,,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,,,8,16,,,35,,,16,35,16,35,16,8,16,35,,8,16,35,,8,16,35,,8,16,35,,8,16]},{n:[161,154,163,161,161,163,159,161,161,159,161,161,159,161,161,159,161,161,159,161,161,159,161,161,159,161,,159,161,,163,161],fx:[22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,,22,22,,,,,22,,,22,35,,35,16,35,16,35,16,35,16,8,16,35,,8,16,35,,8,16,,,8,,,,,,35,,,16]},{n:[164,,,164,168,,164,168,166,164,164,166,163,164,166,163,164,166,163,164,161,163,164,161,163,164,161,163,159,161,163,159],fx:[22,,,22,22,,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,35,,,16,36,,8,16,35,,35,16,35,16,8,16,35,,35,16,35,16,8,16,35,,35,16,35,16,8,16]},{n:[161,163,159,161,166,161,159,166,163,149,166,163,159,166,163,159,161,163,159,161,163,159,161,163,159,161,163,159,161,,,161],fx:[22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,,22,22,,,,,,,,,36,,8,16,35,,8,16,35,,8,16,35,,8,17,35,,8,15,,,8]}]}],rowLen:4134,endPattern:22},.2),this.init3()},init3:function(){var t=this.songGen5.generate();if(this.context.strokeStyle="#05A",this.context.strokeRect(0,20,300,10),this.context.fillStyle="#05A",this.context.fillRect(0,20,300*t.progress,10),t.done)this.audioMusic=new Audio("data:audio/wav;base64,"+btoa(this.songGen5.createWave())),this.audioMusic.loop=!0,this.audioMusic.play(),this.game.launchMenu();else{var i=this;setTimeout((function(){i.init3()}),1)}},toggleSound:function(){this.soundSupport&&(this.soundOn=!this.soundOn,this.soundOn||(this.audioFloater.pause(),this.audioBallLoss.pause(),this.audioPadHit.pause(),this.audioBrickHit.pause(),this.audioMusic.pause()))},toggleMusic:function(){this.soundSupport&&((this.musicOn=!this.musicOn)?this.audioMusic.play():this.audioMusic.pause())},playBrickHit:function(){this.soundOn&&(this.audioBrickHit.currentTime=0,this.audioBrickHit.play())},playPadHit:function(){this.soundOn&&(this.audioPadHit.currentTime=0,this.audioPadHit.play())},playBallLoss:function(){this.soundOn&&(this.audioBallLoss.currentTime=0,this.audioBallLoss.play())},playFloaterCaught:function(){this.soundOn&&(this.audioFloater.currentTime=0,this.audioFloater.play())}};var b=document.body,c=document.getElementsByTagName("canvas")[0];document.body.clientWidth,window.onload=function(){var t=new Controls;document.onkeydown=function(i){return t.onKeyDown(i)},document.onkeyup=function(i){return t.onKeyUp(i)},document.getElementById("e").onmousedown=function(i){return t.mouseControl(i,8,!0)},document.getElementById("e").onmouseup=function(i){return t.mouseControl(i,8,!1)},document.getElementById("g").onmousedown=function(i){return t.mouseControl(i,9,!0)},document.getElementById("g").onmouseup=function(i){return t.mouseControl(i,9,!1)},document.getElementById("c").onmousedown=function(i){return t.mouseControl(i,0,!0)};var i=new SoundManager,e=new Game(t,i),s=new AdvancedRenderer(c,b,e);s.initialize(),e.setRenderer(s),i.initialize(c.getContext("2d"),e)}</script>