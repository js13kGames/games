<title>Kuro Neko Market - js13kGames 2025</title><style>*{box-sizing:inherit}html{box-sizing:border-box}body,html{height:100%}body{margin:0;background:#000;overflow:hidden}canvas{display:block;width:100%;height:100%;cursor:none}</style><canvas id=g></canvas><script>const t=()=>Symbol();class s{t;constructor(){this.t={}}on(t,s){return this.t[t]||(this.t[t]=[]),this.t[t].push(s),()=>{const i=this.t[t].findIndex(t=>t===s);0>i||(this.t[t][i]=null)}}i(t,s){this.t[t]&&(this.t[t].map(t=>t&&t(s)),this.t[t]=this.t[t].filter(Boolean))}h(){this.t={}}}const i=(t,s,i)=>{const e=t.o(i),h=e.mul(s);return t.add(h.o(e))},e=(t,s,i)=>{const e=t.o(i).rotate(s);return i.add(e)},h=(t=0,s=0)=>({x:t,y:s,l(t){return this.x>t.x&&this.y>t.y},p(t){return t.x>this.x&&t.y>this.y},add(t){return h(this.x+t.x,this.y+t.y)},o(t){return h(this.x-t.x,this.y-t.y)},u(t){return h(this.x*t.x,this.y*t.y)},v(){return h(1/this.x,1/this.y)},mul(t){return h(this.x*t,this.y*t)},rotate(t){return h(this.x*Math.cos(t)-this.y*Math.sin(t),this.x*Math.sin(t)+this.y*Math.cos(t))},length(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},equals(t){return this.x==t.x&&this.y==t.y},ceil(){return h(Math.ceil(this.x),Math.ceil(this.y))},round(){return h(Math.round(this.x),Math.round(this.y))},floor(){return h(Math.floor(this.x),Math.floor(this.y))},clone(){return h(this.x,this.y)}}),n=h(),o=h(1,1),a=h(),r=h(1,0),c=h(0,1),l=h(0,.5),u=h(.5,0),d=h(.5,1),m=h(.5,.5),p=t(),x=t();class z extends s{M;id;m;opacity;scale;rotation;origin;size;F;A;C;constructor({m:t=h(),opacity:s=1,scale:i=1,size:e=h(),origin:o=a,rotation:r=0,F:c=!1,A:l=[],C:u=n,...d}={}){super(),this.m=t,this.opacity=s,this.scale=i,this.rotation=r,this.origin=o,this.size=e,this.F=c,this.C=u,this.A=[];for(let t in d)this[t]=d[t];this.S(l||[])}h(){super.h(),this.M&&this.M.removeChild(this),this.A.map(t=>t.h()),this.A=[]}S(t){t.map(t=>this.B(t))}B(t,s=this.A.length){t.M&&t.M.removeChild(t),t.M=this,this.A.splice(s,0,t),t.i(p),this.i(x)}k(t){for(const s of this.A){if(s.id===t)return s;const i=s.k(t);if(i)return i}}removeChild(t){this.A=this.A.filter(s=>s!==t),this.i(x)}update(t){}L(t){}D(){return this.M?this.rotation+this.M.D():this.rotation}H(){return this.M?this.scale*this.M.H():this.scale}Z(){const t=this.m;if(!this.M)return t;const s=this.M.size.u(this.M.origin);return e(i(t,this.M.H(),s),this.M.D(),s).add(this.M.Z())}P(t){const s=t.H()/this.H(),i=t.size.u(t.origin);return{scale:s,m:this.T(t.Z().add(i.mul(s))).o(i.mul(s)),rotation:t.rotation-this.D()}}V(t){const s=this.Z(),h=this.D(),n=this.H(),o=this.size.u(this.origin);return s.add(e(i(t,n,o),h,o))}T(t){const s=this.Z(),h=t.o(s),n=this.size.u(this.origin);return e(i(h,1/this.H(),n),-this.D(),n)}j(t){const s=this.T(t);return s.l(n.o(this.C))&&s.p(this.size.add(this.C))}}class y extends z{canvas;I;constructor(t){super(t),this.canvas=new OffscreenCanvas(this.size.x,this.size.y),this.I=this.canvas.getContext("2d")}Z(){return this.m}}const w=t();class M extends s{root;R;constructor({$:t}){super(),this.R=0,this.root=new y({size:t})}_=t=>{requestAnimationFrame(this._),this.root&&(this.R&&this.i(w,t-this.R),t&&(this.R=t))};W(){this._(0)}}const g=new class{G=new Map;set(t,s){return this.G.set(t,s),s}get(t){return this.G.get(t)}};class A extends z{direction;mode;O;align;U;constructor({direction:t="row",mode:s="fixed",O:i=0,align:e="center",U:h="center",...n}={}){super(n),this.direction=t,this.O=i,this.align=e,this.U=h,this.mode=s,this.on(x,()=>this.X()),this.X()}X(){const t="row"==this.direction?"x":"y",s="row"==this.direction?"y":"x",i=h("x"==t?1:0,"y"==t?1:0);let e=0;const n=this.A.reduce((t,i)=>{const h=i.size.mul(i.scale);return e=Math.max(e,h[s]),t.add(h)},h()),o=i.mul(this.O),a=n.add(o.mul(this.A.length-1));if("hug"==this.mode){const s=h("x"==t?a.x:e,"y"==t?a.y:e);this.m=this.m.add(this.size.u(this.origin)).o(s.u(this.origin)),this.size=s,this.M?.i(x)}let r=0,c=0;"center"==this.U?r=this.size.mul(.5).o(a.mul(.5))[t]:"end"==this.U&&(r=this.size.o(a)[t]),this.A.map(i=>{"center"==this.align?c=this.size.mul(.5).o(i.size.mul(i.scale).mul(.5))[s]:"end"==this.align&&(c=this.size.o(i.size.mul(i.scale))[s]),i.m=h("x"==t?r:c,"y"==t?r:c),r+=i.size[t]*i.scale+o[t]})}}const v=t(),f=t(),E=t(),B=[.2,,1500,,,,1,4,1.2,,-100,.06,,,1,,.19,,.02,,1e3],L=[,,212,.01,.01,.08,,3.9,,169,,,,,,,,.55,.04],D=[,,76,.1,.02,.15,2,.6,-.4,,,,,,,,,.6,.01,,100,1],C=[.3,,,.06,,,4,,1,,220,.03,,100,,,,,,,200,1],P=[.1,,,.06,,.12,4,,,,-50,.02,,,,,,,,,,],F=[1.2,,,.06,,.03,1,,1,,220,.03,,,5,,,,,,200,1],b=[2,,,.06,,.06,1,,-7,,,,,2,6.8,,,,,,50,1],Z=[,.2,400,,,.02,,3,-50,,,,,,16,,,,,,500,1],H=[.2,,,,.4,,3,,,,,,,-1,8,,,,,,200,2],O=[,,310,.2,.1,.3,,4,,4.3,,,.76,,9,,,.4,.13,1,50,1],U=[{id:"mackerel",q:[[{N:"#C7B3CA"}],[{J:"#A45EB1"},{J:"#323033"}],[{K:"#A45EB1",Y:"#A45EB1"},{K:"#323033",Y:"#323033"}],[{pattern:"m0 4 12 12 4-4M0 12 12 0l4 4"}]],tt:5,size:h(40,70),pattern:"M16 12c-3 0-4-4-4-4s-1 4-4 4-4-4-4-4-1 4-4 4M0 0s1 4 4 4 4-4 4-4 1 4 4 4 4-4 4-4",st:"M23 65 20 0C4-1-2 32 18 62l-4 16 2 1 4-5 9 3-6-12Z",K:"#429247",Y:"#429247",J:"#A3D9A7",it:"#429247",et:"m16 79 5-15 3 1 5 12-6-5-7 7Z",ht:"m3 9 15 6-7-7 5-7L4 6M3 9l-2 1m2-1 1-1m0-2L1 5m3 1v1m0 1 7 2M4 8V7m0 0 6-1",body:"M21 64C12 43 10 6 20 0c15 14 15 48 4 65l-3-1Z",details:"m21 64 1 1m2 0h-1m-1 0-1 7m1-7h1m0 0 2 6",nt:[[8,h(19,7)]],N:"#3A1141"},{id:"sole",q:[[{N:"#C7B3CA"}],[{J:"#F399EA"},{J:"#968F9D"}],[{Y:"#F399EA"},{Y:"#5B5661"}],[{pattern:"M0 5c3 0 5-4 8-4s5 4 8 4M0 13c3 0 5-4 8-4s5 4 8 4"},{pattern:"m0 8 6 6m10-6-6 6M5 8l3 3 3-3M2 6l6-6 6 6M3 0 0 3m13-3 3 3"}]],tt:6,size:h(50,70),pattern:"M0 5c3 0 5-4 8-4s5 4 8 4M0 13c2 0 2 3 0 3m0-7c3 0 5 4 8 4s5-4 8-4m0 4c-2 0-2 3 0 3M8 8C6 8 6 5 8 5s2 3 0 3Z",st:"M28 79 25 0c-26 6-36 45-4 64 0 4-11 13 7 15Z",K:"#D7A374",Y:"#D7A374",J:"#D7A374",it:"#B27242",et:"M21 76c-3-1 6-14 6-14C3 47-6 32 25 1c35 16 21 41 4 61 0 0 8 14 6 15-4 2-9 2-14-1Z",ht:"M1 11h3m0 0c3 2 9 5 11 4s4-12 1-14C14 0 6 5 4 5m0 6V9m0-4H1m3 0v2m0 2 8 1M4 9V7m0 0 10-2",body:"M24 57C7 40 4 16 25 0c21 15 21 37 6 58v7h-6s1-6-1-8Z",details:"M39 43h3m-1-8h3m-2-8h3m-5-7h4m-34 7H8m3 7H7m6 7H9m7 7h-3m13 17h4m-3 0-1 8m3-8 2 10",nt:[[6,h(24,6)],[4,h(27,2)]],N:"#3A1141"},{id:"tile",q:[[{N:"#C7B3CA"}],[{J:"#F399EA"},{J:"#5B5661"}],[{K:"#A45EB1",Y:"#A45EB1"},{K:"#968F9D",Y:"#968F9D"}],[{pattern:"m0 1 4 4 4-4 4 4 4-4M0 9l4 4 4-4 4 4 4-4"},{pattern:"m0 8 6 6m10-6-6 6M5 8l3 3 3-3M2 6l6-6 6 6M3 0 0 3m13-3 3 3"}]],tt:7,size:h(40,70),pattern:"M0 5c3 0 5-4 8-4s5 4 8 4M0 13c3 0 5-4 8-4s5 4 8 4",st:"M21 79 17 1C3-1-10 25 15 65l-3 13 3 1h6Z",K:"#B44141",Y:"#B44141",J:"#EEAA67",it:"#B44141",et:"m15 79 2-10 4 3 3-2 5 9H15Z",ht:"m5 7 10-5v14L5 14m0-7L1 8m4-1 1 1m1 2-1 2m1-2h6m-6 0L6 8m-1 6-4-1m4 1 1-2m0 0 5 1M6 8l6-2",body:"M28 12c5 10 1 34-5 52l1 6-3 2-4-3 1-7c-4-6-8-27-8-29 0-11 0-29 7-32 6 2 9 6 11 11Z",details:"m17 69 2 1m5 0-2 1m-1 1-2-2m2 2v5m0-5 1-1m-3-1-1 5m4-4 3 6",nt:[[4,h(22,7)]],N:"#3A1141"}],S=t=>Math.random()<t,Y=(t,s)=>Math.random()*(s-t)+t,k=(t,s)=>Math.floor(Y(t,s)),I=t=>t[k(0,t.length)],V=t=>{const s=[...t];for(let t=s.length-1;t>0;t--){const i=k(0,t+1),e=s[t];s[t]=s[i],s[i]=e}return s},$=(t,s)=>{if(S(1/4))return t;const i=V(s),e=i[0];let h={...t,...e};const n=i[1];return S(1/3)?{...h,...n}:h},J=(t,s)=>{if(S(.2))return t;const i=V(s),e=i[0];let h={...t,...e};const n=i[1];return S(1/3)?h:{...h,...n}},T=(t,s)=>V(s).reduce((t,s)=>S(1/3)?t:[...t,s],[]).reduce((t,s)=>({...t,...s}),t),_=(t,s)=>{const i=V(t.q),e=S(.5)?I(s):null,h=i.reduce((t,s)=>{const i=I(s);return S(1/3)?t:[...t,i]},e?[e]:[]);return e&&h.push(e),h.reduce((t,s)=>({...t,...s}),t)},q=(t,s,i)=>localStorage[t+"etItem"]("knm:"+s,i),R=t=>JSON.parse(q("g",t)),W=(t,s)=>q("s",t,JSON.stringify(s)),K=(...t)=>N([G(...t)]),X={volume:.5,sampleRate:44100,rt:new AudioContext},N=(t,s=1,i=1,e=0,h=!1)=>{const n=X.rt.createBuffer(t.length,t[0].length,X.sampleRate),o=X.rt.createBufferSource();t.map((t,s)=>n.getChannelData(s).set(t)),o.buffer=n,o.playbackRate.value=i,o.loop=h;const a=X.rt.createGain();a.gain.value=X.volume*s,a.connect(X.rt.destination);const r=new StereoPannerNode(X.rt,{pan:e});return o.connect(r).connect(a),o.start(),o},G=(t=1,s=.05,i=220,e=0,h=0,n=.1,o=0,a=1,r=0,c=0,l=0,u=0,d=0,m=0,p=0,x=0,z=0,y=1,w=0,M=0,g=0,A=0)=>{let v,f,E=2*Math.PI,B=t=>0>t?-1:1,L=X.sampleRate,D=r*=500*E/L/L,C=i*=(1+2*s*Math.random()-s)*E/L,P=[],F=0,b=0,Z=0,H=1,O=0,U=0,S=0,Y=E*Math.abs(g)*2/L,k=Math.sin(Y),I=Math.cos(Y),V=Math.sin(Y)/2/2,$=1+V,J=-2*I/$,T=(1-V)/$,_=0,q=0,R=0,W=0,[K,N,G]=(A?A>1?()=>[.5*k/$,0,.5*-k/$]:()=>[.5*(1+I)/$,-(1+I)/$,.5*(1+I)/$]:()=>[.5*(1-I)/$,(1-I)/$,.5*(1-I)/$])();for(c*=500*E/L**3,p*=E/L,l*=E/L,u*=L,d=d*L|0,t*=X.volume,f=(e=e*L+9)+(w*=L)+(h*=L)+(n*=L)+(z*=L)|0;f>Z;P[Z++]=S*t)++U%(100*x|0)||(S=o?o>1?o>2?o>3?Math.sin(F**3):Math.max(Math.min(Math.tan(F),1),-1):1-(2*F/E%2+2)%2:1-4*Math.abs(Math.round(F/E)-F/E):Math.sin(F),S=(d?1-M+M*Math.sin(E*Z/d):1)*B(S)*Math.abs(S)**a*(e>Z?Z/e:e+w>Z?1-(Z-e)/w*(1-y):e+w+h>Z?y:f-z>Z?(f-Z-z)/n*y:0),S=z?S/2+(z>Z?0:(f-z>Z?1:(f-Z)/z)*P[Z-z|0]/2/t):S,g&&(S=W=G*_+N*(_=q)+K*(q=S)-T*R-J*(R=W))),v=(i+=r+=c)*Math.cos(p*b++),F+=v+v*m*Math.sin(Z**5),H&&++H>u&&(i+=l,C+=l,H=0),!d||++O%d||(i=C,r=D,H=H||1);return P},j=t(),Q=t(),tt=t(),st=t();class it extends s{ot;lt;ct;ut;dt;wt;gt;vt;Mt=[];yt=!1;xt=!1;zt=0;ft=0;constructor(){super(),this.ot=g.get(M),this.ot.on(w,t=>this.Ft(t))}init(t,s,i,e){this.lt=t.map(t=>U[t]),this.ct=s,this.ut=i,this.dt=e,this.wt=(t=>{const s=[];for(const i of t){const t=V(i.q).slice(0,3);let e=[];do{e=t.reduce((t,s)=>{const i=I(s);return[...t,[i,i.N?k(-3,0):k(0,3)||k(-2,0)]]},[])}while(1>e.reduce((t,[,s])=>t+s,i.tt));s.push(e)}return s})(this.lt),this.gt=[$,J,T,_][i],this.vt=115/(10+3*this.ct),this.yt=!1,this.xt=!1,this.ft=0,this.zt=0,this.Mt=[]}At(t){const s=this.lt.findIndex(({id:s})=>s==t.id),i=((t,s)=>s.reduce((s,[i,e])=>{for(const e in i)if(i[e]!=t[e])return s;return s+e},t.tt))(t,this.wt[s]),e=this.Mt.push([t,i,!1]);this.i(j,e-1)}start(){this.yt=!0}Ft(t){if(!this.xt)if(this.zt>120){if(this.xt=!0,null!=this.dt){const t=R("s")??[];t[this.dt]=Math.max(this.Ct()/this.Et(),t[this.dt]??0),W("s",t)}this.i(tt)}else if(this.i(Q,120-this.zt),this.yt){if(this.zt+=t/1e3,0>=this.ft){const t=((t,s,i)=>{const e=k(0,t.length);return i(t[e],s[e].map(([t])=>t))})(this.lt,this.wt,this.gt);this.At(t),this.ft=this.vt}this.zt>115||(this.ft-=t/1e3)}}St(t){return this.Mt[t][0]}Et(){return this.Mt.reduce((t,[,s])=>t+s,0)}Ct(){return this.Mt.reduce((t,[,s,i])=>i?t+s:t,0)}Bt(t,s){const i=this.Mt[t];return i[1]==s?(i[2]=!0,K(...L),this.i(st,this.Ct()),!0):(K(...D),!1)}}const et=(t,s,i)=>Math.min(i,Math.max(s,t)),ht=t=>t,nt=t=>t*t,ot=t=>1-(1-t)*(1-t),at=t=>ct(nt(t),ot(t),t),rt=[{is:t=>"number"==typeof t,kt:(t,s,i)=>t+(s-t)*i},{is:t=>"x"in t&&"y"in t,kt:(t,s,i)=>h(t.x+(s.x-t.x)*i,t.y+(s.y-t.y)*i)}],ct=(t,s,i)=>{for(const e of rt)if(e.is(t)&&e.is(s))return e.kt(t,s,i)},lt=(t,s,i,e=ht)=>{let h=0;return(n=0)=>(h=et(h+n/i,0,1),ct(t,s,e(h)))};class ut{bt;Lt;Dt;constructor(t,s){this.bt=t,this.to(s)}is(t){return this.Lt==t}Ht(t){return!!this.Dt[0]&&t in this.Dt[0]}Zt(t){return!!this.Dt[1]&&this.Dt[1].includes(t)}to(t){const s=this.bt[t];s&&(this.Lt=t,this.Dt=s)}Pt(t){const s=this.Dt[0][t];s&&this.to(s)}}const dt=t(),mt=t(),pt=t(),xt=t(),zt=t(),yt=t(),wt=t(),Mt=t(),gt=t(),At=t(),vt=t(),ft=t(),Et={[pt]:[{[gt]:xt}],[xt]:[{[At]:zt},[dt]],[zt]:[{[vt]:yt},[dt]],[yt]:[{[ft]:wt},[mt]],[wt]:[{[Mt]:pt},[dt]]},Bt=t(),Lt=t();class Dt extends s{mapping;Tt=0;Vt=0;jt;It=null;Dt=new ut(Et,pt);constructor(t){super(),this.mapping=t,g.get(M).on(w,this.Rt)}Rt=t=>{this.Dt.Zt(dt)?(this.Tt=this.jt(t),this.Tt>.55&&this.Dt.Ht(At)&&(K(...O),this.Dt.Pt(At)),1==this.Tt&&this.Dt.Pt(vt),2==this.Tt&&this.Dt.Pt(Mt)):this.Dt.Zt(mt)&&(this.Vt+=t,200>this.Vt||(this.Vt=0,this.$t()))};$t(){this.Dt.Ht(ft)&&(this.Dt.Pt(ft),this.It&&this.i(Lt,new this.It),this.It=null,this.jt=lt(1,2,1e3,ot))}to(t){this.Dt.Ht(gt)&&(this.Dt.Pt(gt),this.i(Bt),this.It=this.mapping[t],this.jt=lt(0,1,1e3,nt))}}const Ct=(t,s,i,e,h)=>{t.beginPath(),t.roundRect(s.x,s.y,i.x,i.y,e),Zt(t,h)},Pt=(t,s,i,e)=>{t.beginPath(),t.rect(s.x,s.y,i.x,i.y),Zt(t,e)},Ft=(t,s,i)=>{t.beginPath();const{x:e,y:h}=s.add(o.mul(i));t.arc(e,h,i,0,2*Math.PI,!0)},bt=(t,s,i)=>{t.lineCap="round",t.lineJoin="round",i&&(t.lineWidth=i),s&&(t.strokeStyle=s),t.stroke()},Zt=(t,s)=>{s&&(t.fillStyle=s),t.fill()},Ht=(t,s,i,e)=>{Ft(t,s,i),Zt(t,e)},Ot=(t,s)=>{t.moveTo(...s)},Ut=(t,s)=>{t.lineTo(...s)},St=(t,s)=>{t.bezierCurveTo(...s)},Yt={_t:["x","y"],Wt:Ot},kt={Gt:!0,_t:["x","y"],Ot:(t,s)=>[(s.at(-2)||0)+t[0],(s.at(-1)||0)+t[1]],Wt:Ot},It={...Yt},Vt={_t:["x","y"],Wt:Ut},$t={Gt:!0,_t:["x","y"],Ot:(t,s)=>[(s.at(-2)||0)+t[0],(s.at(-1)||0)+t[1]],Wt:Ut},Jt={_t:["x"],Ot:(t,s)=>[t[0],s.at(-1)],Wt:Ut},Tt={Gt:!0,_t:["x"],Ot:(t,s)=>[s.at(-2)+t[0],s.at(-1)],Wt:Ut},_t={_t:["y"],Ot:(t,s)=>[s.at(-2),t[0]],Wt:Ut},qt={Gt:!0,_t:["y"],Ot:(t,s)=>[s.at(-2),s.at(-1)+t[0]],Wt:Ut},Rt={_t:["x","y","x","y","x","y"],Wt:St},Wt={Gt:!0,_t:["x","y","x","y","x","y"],Ot:(t,s)=>[s.at(-2)+t[0],s.at(-1)+t[1],s.at(-2)+t[2],s.at(-1)+t[3],s.at(-2)+t[4],s.at(-1)+t[5]],Wt:St},Kt=t=>4>t.length?[t.at(-2),t.at(-1)]:[t.at(-2)+t.at(-2)-t.at(-4),t.at(-1)+t.at(-1)-t.at(-3)],Xt={_t:["x","y","x","y"],Ot:(t,s)=>[...Kt(s),...t],Wt:St},Nt={Gt:!0,_t:["x","y","x","y"],Ot:(t,s)=>[...Kt(s),s.at(-2)+t[0],s.at(-1)+t[1],s.at(-2)+t[2],s.at(-1)+t[3]],Wt:St},Gt={_t:[],Wt(t){t.closePath()}},jt={M:Yt,m:kt,L:Vt,l:$t,H:Jt,h:Tt,V:_t,v:qt,C:Rt,c:Wt,S:Xt,s:Nt,Z:Gt,z:Gt},Qt=(t,{path:s,viewBox:i,Ut:e=!1})=>{const h=()=>{let t=s.search(/[A-Za-z]/);if(0>t)return;const i=s.at(t);return s=s.slice(t+1).trim(),jt[i]};let n=h(),o=[];for(n&&t.beginPath(),n===kt&&(n=It);n;){const{Gt:a,_t:r,Ot:c,Wt:l}=n,u=t=>{let s="";const i=t=>0==s.length&&"-"==t||"."==t&&!s.includes(".")||/\d/.test(t);for(;void 0!==t[0]&&i(t[0]);)s+=t[0],t=t.slice(1);return[s,t]};let d=r.map(t=>{const[h,n]=u(s);s=n.trim();let o=parseFloat(h);return i&&e&&"x"==t&&(o=a?-o:i.x/2+(i.x/2-o)),o}),m=c?c(d,o):d;m.length&&(o=m),l(t,m),0!=s.search(/[-\.\d]/)?n=h():(n!==kt&&n!==It||(n=$t),n===Yt&&(n=Vt))}},ts=(t,s,i,e,h)=>{const n=t.createLinearGradient(s.x,s.y,i.x,i.y);return e.map(([t,s])=>n.addColorStop(h?.Ut?1-t:t,s)),n},ss=t=>Array(t).fill(null).map((t,s)=>s);class is extends z{L(t){Pt(t,n,this.size,ts(t,h(0,0),h(0,this.size.y/2),[[0,"#282828"],[1,"#5B5B5B"]]));const s=this.size.y/2;ss(5).map(i=>{t.beginPath(),t.arc(this.size.x/4*i,this.size.y/2,s,0,2*Math.PI,!0),Zt(t,"#807D7D")})}}class es extends z{offsetX=0;Xt=30;update(t){this.offsetX+=this.Xt*t/1e3}L(t){Pt(t,n,h(this.size.x,this.size.y+5),"#B44141");for(const s of ss(14)){const i=45,e=14*i;Qt(t,{path:`M${((this.offsetX+i*s)%e-(e-this.size.x)/2).toFixed(2)} ${this.size.y+5}v-5L${this.size.x/2} -70`}),bt(t,"#3A1141")}Qt(t,{path:`M0 ${this.size.y}h${this.size.x}`}),bt(t),Qt(t,{path:"M0 0h"+this.size.x}),bt(t,"#E4B4B4")}}class hs extends z{constructor(t){super(t),this.S([new is({size:h(this.size.x,25),m:h(0,this.size.y-10)}),new es({size:h(this.size.x,this.size.y-10)})])}}class ns extends z{L(t){t.fillStyle="#00000088",t.fillRect(0,this.size.y-10,this.size.x,20)}}const os=t();class as extends z{id=os;qt=25;Nt=!0;Jt=.4;Kt=!0;origin=m;B(t,s){super.B(t,s),t.C=o.mul(25)}removeChild(t){super.removeChild(t),t.C=n}Qt(t){return this.V(h(t.x,(this.size.y-10)/2))}}class rs extends z{Yt;ts;path;ss;constructor({Yt:t="#3A1141",ts:s,ss:i=1,path:e,...h}){super(h),this.path=e,this.Yt=t,this.ts=s,this.ss=i}L(t){Qt(t,{path:this.path}),bt(t,this.Yt,this.ss),this.ts&&Zt(t,this.ts)}}class cs extends rs{constructor({es:t=12,...s}){super({...s,ss:2}),this.scale=t/12}}const ls={0:"M4 8C1.1 8 .8 1 4 1 7.2 1 6.9 8 4 8Z",1:"M2.5 2.7C3.4 2 3.8 1.5 4.4 1c.3-.3.3.3.3.6 0 .5 0 4.7 0 6.3",2:"M1.4 3.4c0-1 .4-2 2-2.4 1.5-.2 2.6.9 2.6 2 0 1.8-2.2 2.7-2.9 3.1-.4.2-1.3.8-1.5 1-.3.3-.3.6-.3.6.1 0 1 0 1.5 .1 1.7 0 3.7 0 3.7 0",3:"M1.8 6.4c.5 1.6 3 2.2 4 .6.3-.5.5-1.2 0-1.9-.4-.6-1.1-.8-1.8-.8-.1 0-.1 0 0 0 .7 0 1.4-.3 1.8-.9.3-.6.2-1.3-.3-1.8-.6-.6-2.5-.9-3.3.5",4:"M3 1S2.1 4.8 2 5.2c0 .1-.2.2.5.2l3.6 0m0 0V1m0 4.4v2.6",5:"M5.6 1c-1.2 0-1.4 0-2.6 0-.1 0-.3 0-.3.2-.2 1-.2 2-.5 3.3 0 .1 0 .2.1.2.1.1.3 0 .4-.1 1.2-1.1 3.1-.2 3.1 1.4 0 2.6-2.7 2.2-3.6 1.4",6:"M5.7 1c-1.1-.1-3 .6-3.6 3.3-.1.6-.1 1.2-.1 1.7m0 0c0 2.7 4 2.6 3.9 0 0-2.4-3.8-2.1-3.9 0Z",7:"M2 1.1c1.5 0 2.3 0 3.9 0 .3 0 .2.1.2.2 0 1.6-2.9 4.3-2.9 6.5v.3",8:"M4 4.3c-2.8 0-2.7 3.7 0 3.7S6.8 4.3 4 4.3Zm0 0c-2.3 0-2.4-3.3 0-3.3s2.3 3.3 0 3.3Z",9:"M2.4 7.9c2.5.1 4.2-2.5 3.3-5.6m-1.8-1.3c-2.4 0-2.5 3.4 0 3.4 2.5 0 2.4-3.4 0-3.4Z"};class us extends cs{size=h(8,9);value;constructor({value:t,...s}){super({path:ls[t],...s}),this.value=t}hs(t){this.path=ls[t],this.value=t}}class ds extends A{ns=1;rs;constructor({es:t,Yt:s,value:i=0,...e}){super({...e,mode:"hug",align:"end",U:"start",O:-2}),this.rs={es:t,Yt:s},this.hs(i)}hs(t){const s=""+t;this.ns=Math.max(s.length,this.ns);let i=0;for(const[t,e]of s.padStart(this.ns,"0").split("").entries()){const h=+e;0==h&&t!=s.length-1||(i=1);const n=""+t;let o=this.k(n);o||(o=new us({...this.rs,id:n,value:h,opacity:0}),this.B(o)),o.hs(h),o.opacity=i}}}class ms extends cs{size=h(8,9);constructor({...t}){super({path:"M6.5 3c-2.5-2.5-5 0-5 2s2 3.5 5 2m-2-6v7.6",...t})}}class ps extends z{L(t){Ht(t,n,this.size.x/2,this.color),bt(t,"#FEE2E2",2)}}class xs extends z{level;Ut;type;ls;texture;nt;cs;ps;constructor({Ut:t=!1,type:s,ps:i,size:e,origin:n,cs:o=!1,...a}){super(a),this.Ut=t,this.type=s,this.size=e??this.type.size,this.origin=n??m,this.ps=i??null,this.cs=o;const r=(t,i,e)=>{const n=t.x-e.x/2;return new ps({size:h(i,i),color:s.N,m:h(e.x/2+n*(this.Ut?-1:1)-(this.Ut?i:0),t.y)})};this.texture=new y({size:h(16,16),A:[new rs({path:s.pattern,size:h(16,16)})]}),this.nt=s.nt.map(([t,i])=>r(i,t,s.size)),this.S([...this.nt,this.texture])}h(){super.h(),this.nt=[],this.texture=null}update(){this.nt.map(t=>t.opacity=this.ps?0:1)}L(t){this.cs||(Qt(t,{path:this.type.st,viewBox:this.size,Ut:this.Ut}),Zt(t,"#00000044")),Qt(t,{path:this.type.et,viewBox:this.size,Ut:this.Ut}),Zt(t,this.ps??ts(t,h(0,0),h(0,this.size.y+10),[[.85,this.type.K],[.95,this.type.Y]])),Qt(t,{path:this.type.body,viewBox:this.size,Ut:this.Ut}),Zt(t,this.ps??ts(t,n,h(this.size.x,0),[[.2,this.type.it],[.8,this.type.J]],{Ut:this.Ut})),Zt(t,t.createPattern(this.texture.canvas,"repeat")),Qt(t,{path:this.type.details,viewBox:this.size,Ut:this.Ut}),bt(t,this.ps??"#3A1141")}}const zs=t=>new Promise(s=>setTimeout(s,t));class ys extends A{us=!1;baseLayer=.75;size=h(24,24);ls=this.size.mul(.5);origin=m;direction="row";align="center";U="center";O=0;value=0;ds=!1;ws(){K(...C),this.ds=!0}drop(){K(...P),this.ds=!1}L(t){this.ds||(Qt(t,{path:"M2 6 0 2V0h22l2 4v2l-2 4 2 2v2l-2 4 2 2v2l-2 4H0v-2l2-2-2-4v-2l2-2-2-4V8l2-2Z"}),Zt(t,"#00000088")),Qt(t,{path:"M22 0H0l2 4-2 4 2 4-2 4 2 4-2 4h22l2-4-2-4 2-4-2-4 2-4-2-4Z"}),Zt(t,ts(t,n,h(0,this.size.y),[[0,"#F9F4F0"],[1,"#F3EAE2"]]))}}const ws="m1 4.7 2 3.1c.1.2.4.2.5 0L6.9 1",Ms="m2 9 5-9M2 4C0 4 0 1 2 1s2 3 0 3Zm5 4C5 8 5 5 7 5s2 3 0 3Z",gs="M1 10V1l4.5 4.5L1 10Z",As="#3A1141",vs="#B674C2",fs=h(14,14),Es=h(14,32),Bs=t(),Ls=t();class Ds extends z{baseLayer=.8;gs=!0;vs(){return this.V(fs.mul(.5))}Ms(){const[t]=this.A;t instanceof us&&this.i(Bs,t.value),K(...Z),this.i(Ls)}}const Cs=t(),Ps=t(),Fs=t();class bs extends z{constructor(t){super(t);const s=ss(10).map(t=>{const s=new Ds({size:fs,A:[new us({color:As,es:10,value:t,m:h(3,2.5),origin:m})]});return s.on(Bs,t=>this.i(Cs,t)),s}),i=new Ds({size:Es,A:[new cs({Yt:"#8B2325",path:"m1.5 8 5-7m-5 0 5 7",es:10,m:h(3,2.5),origin:m})]});i.on(Ls,()=>this.i(Ps));const e=new Ds({size:Es.add(h(10,0)),A:[new cs({Yt:"#10A11A",path:ws,es:10,m:h(3,2.5),origin:m})]});e.on(Ls,()=>this.i(Fs)),this.S([new A({m:h(4,4),align:"start",direction:"col",U:"start",O:0,A:[...ss(3).map(t=>new A({size:fs,align:"start",direction:"row",U:"start",O:0,A:s.slice(1+3*t,4+3*t)})),new A({size:Es,align:"start",direction:"row",U:"start",O:0,A:[i,s[0],e]})]})])}}const Zs=t();class Hs extends z{L(t){Ct(t,n,this.size.add(h(0,7)),12,"#00000066"),Ct(t,n,this.size,12,ts(t,n,h(0,2),[[0,"#FEE2E2"],[1,"#F3DEF7"]]));const s=()=>Qt(t,{path:"M8 23.5h16c.8 0 1.5.7 1.5 1.5v34c0 .8-.7 1.5-1.5 1.5H12c-3 0-5.5-2.5-5.5-5.5V25c0-.8.7-1.5 1.5-1.5Z"});s(),bt(t,"#FEE2E2"),t.translate(0,-1),s(),bt(t,"#C7B3CA"),t.translate(0,1),t.beginPath(),t.arc(11,54,2,0,2*Math.PI,!0),Zt(t,"#C7B3CA"),Ct(t,o.mul(6),h(20,12),6,ts(t,h(6,6),h(6,7),[[0,"#732182"],[1,"#D58DE2"]]))}}class Os extends z{size=h(74,66);ls=this.size.mul(.5);origin=m;value=[0,0];ys;xs;zs;fs;constructor(t){super(t);const s=new bs({m:h(25,0)});this.fs=new ys({id:Zs,m:h(-2,29)}),this.zs=new z({A:[this.fs]}),this.ys=new us({Yt:vs,es:10,value:0,origin:m}),this.xs=new us({Yt:vs,es:10,value:0,origin:m}),this.S([this.zs,new Hs({size:h(77,66)}),new A({m:h(15.5,11.5),mode:"hug",origin:m,direction:"row",align:"start",U:"center",A:[this.ys,this.xs]}),s]),s.on(Cs,t=>this.Fs(t)),s.on(Ps,()=>this.reset()),s.on(Fs,()=>this.As())}h(){super.h(),this.ys=null,this.xs=null,this.zs=null,this.fs=null}reset(){this.Fs(0),this.Fs(0)}async As(){if(this.Cs)return;const[t,s]=this.value;if(!t&&!s)return;t&&this.fs.B(new us({value:t})),this.fs.B(new us({value:s})),this.fs.value=10*t+s,this.fs.qt=-42,this.fs.us=!0,K(...H),await zs(500),this.k(Zs)&&(this.fs.qt=0);const i=new ys({id:Zs,m:h(-2,29)});this.zs.B(i),this.fs=i,this.reset()}Fs(t){this.value=[this.value[1],t];const[s,i]=this.value,e=s?As:vs,h=s||i?As:vs;this.ys.hs(s),this.ys.Yt=e,this.xs.hs(i),this.xs.Yt=h}}class Us{ot=g.get(M);Es(t,s){s.m=t.o(s.size.u(s.origin).mul(.5)),this.ot.root.B(s)}Ss(t,s){this.Es(t,new s)}Bs(t,s,i=8){ss(i).map(e=>{const h=new s;h.rotation=2*Math.PI/i*e,this.Es(t,h)})}}class Ss extends z{ks=0;origin=m;bs=lt(0,1,600,ot);update(t){this.ks=this.bs(t),this.opacity=et(8*-this.ks+8,0,1),1==this.ks&&this.h()}}class Ys extends Ss{origin=l;Ls="#EEAA67";size=h(16,3);L(t){const s=this.ks*this.size.x/2,i=et(2*this.ks-1,0,1)*this.size.x,e=et(2*this.ks,0,1)*this.size.x;Qt(t,{path:`M${s+e} ${this.size.y/2}L${s+i} ${this.size.y/2}`}),bt(t,this.Ls,this.size.y)}}class ks extends Ss{origin=l;size=h(9,9);L(t){t.translate(16*this.ks,0),Qt(t,{path:"M0 0L9 9M0 9L9 0"}),bt(t,"#581D41",4)}}class Is extends z{level;Ds;value=0;Hs;Jt=.75;baseLayer=.75;us=!0;origin=m;ls;h(){super.h(),this.Hs=null}constructor({Ut:t=!1,Ds:s,...i}){super(i),this.level=g.get(it),this.Ds=s;const e=this.level.St(s);this.size=e.size,this.ls=this.size.mul(.5),this.Hs=new xs({Ut:t,type:e}),this.B(this.Hs),this.on(p,()=>this.Zs()),this.on(x,()=>this.Zs())}Zs(){if(this.M?.id!=os)return;const t=this.k(Zs);if(!t)return;const s=this.level.Bt(this.Ds,t.value),i=g.get(Us);i.Bs(this.V(this.ls),s?Ys:ks,s?8:4),s&&(i.Ss(this.V(this.ls),Vs),this.Kt=!1,this.opacity=.5,this.us=!1)}Kt=t=>t.id==Zs;host(t){this.k(Zs)?.h(),t.us=!1}Qt(t){return this.V(this.size.mul(.5))}ws(){K(...F),this.Hs.cs=!0}drop(t){K(...b),this.Hs.cs=!1,this.Jt=t.Jt}}class Vs extends Ss{origin=m;size=h(9,9);update(t){super.update(t),this.scale=4*this.ks}L(t){Qt(t,{path:ws}),bt(t,"#FEE2E2",2)}}class $s extends cs{constructor({value:t,...s}){const i=Math.sign(t)>=0;super({path:i?"M3.5 4v4m-2-2h4":"M1.5 6h3",size:h(i?7:6,9),...s})}}const Js=t(),Ts=h(80,63);class _s extends z{level=g.get(it);page;size=Ts;origin=m;baseLayer=.8;gs=!0;Ps;vs(t){return this.V(this.size.mul(.5))}async Ms(){const t=lt(1,.75,100,nt);this.Ps=t,await zs(100),K(...P),this.Ts((this.page+1)%this.level.lt.length),this.Ps===t&&(this.Ps=lt(.75,1,100,ot))}update(t){this.Ps&&(this.scale=this.Ps(t))}constructor(t){super(t),this.Ts(0)}Ts(t){this.page=t;const s=this.k(Js);s&&s.h();const i=this.level.lt[this.page],e=this.level.wt[this.page];this.B(new z({id:Js,rotation:-Math.PI/32,A:[new qs({size:Ts}),new Ks({size:h(24,24),m:h(4,7),color:"#F3DEF7",A:[new A({size:h(24,24),A:[new ms({Yt:"#9C5FA7"}),new us({value:i.tt})]})]}),new A({O:13,m:h(0,-3),size:h(80,6),A:ss(5).map(()=>new Ws({size:h(2,6)}))}),new rs({m:h(33,7),ss:8,Yt:i.it,path:"M5 20 6 4l11 16 3-16 11 14",opacity:.3}),new rs({m:h(33,7),ss:8,Yt:i.K,path:"M40 17 35 6",opacity:.3}),new A({m:h(33,29),align:"start",rotation:-Math.PI/2,scale:.5,size:h(40,20),A:[new Rs({body:i.body,et:i.et,nt:i.nt,size:i.size})]}),new A({m:h(0,33),size:h(80,24),O:5,A:e.map(([t,s])=>{const e=t=>new z({A:[new Ks({m:h(10,0),opacity:.5,size:h(4,4),color:t}),new Ks({m:h(1,1),opacity:.4,size:h(6,6),color:t}),new Ks({m:h(4,4),opacity:.4,size:h(10,10),color:t})]}),n=t?t.N?new z({size:h(18,16),A:[new Ks({m:h(9.5,4.5),size:h(6,6),color:"#C7B3CA"}),new rs({path:"M18 1c-6 0-13.5 4.2-17 11.6L6 15M12.5 3c-6 0-6 9 0 9s6-9 0-9Z"})]}):t.K||t.Y?new z({size:h(18,16),A:[new rs({path:i.ht}),e(t.K||t.Y)]}):t.pattern?new rs({size:h(16,16),origin:m,rotation:Math.PI,path:t.pattern}):t.J||t.it?new z({size:h(18,16),A:[e(t.J||t.it)]}):null:null;return new A({size:h(18,24),O:0,direction:"col",U:"start",A:[...n?[n]:[],new A({size:h(24,0),align:"start",A:[new $s({origin:d,es:10,value:s}),new us({origin:d,es:10,value:Math.abs(s)})]})]})})})]}))}}class qs extends z{L(t){Ct(t,n,this.size.add(h(0,3)),1,"#00000088"),Ct(t,n,this.size,1,ts(t,n,this.size.u(c),[[0,"#FEE2E2"],[1,"#F3EAE2"]]))}}class Rs extends z{body;et;nt;constructor({body:t,et:s,nt:i,...e}){super(e),this.body=t,this.et=s,this.nt=i}L(t){Qt(t,{path:this.body}),bt(t,"#3A1141",2),Qt(t,{path:this.et}),bt(t),this.nt.map(([s,i])=>{Ft(t,i,(s+2)/2),bt(t)})}}class Ws extends z{L(t){Ct(t,h(0,2),this.size,1,"#00000088"),Ct(t,n,this.size,1,ts(t,n,this.size.u(c),[[0,"#FEE2E2"],[.4,"#BEADB8"]]))}}class Ks extends z{L(t){Ht(t,n,this.size.x/2,this.color)}}const Xs=t();class Ns extends s{ot;constructor(){super(),this.ot=g.get(M),this.ot.on(w,()=>this.L())}L(){this.Vs(this.ot.root),this.i(Xs)}Vs(t){t.A.map(s=>{this.js(t.I,s)})}js(t,s){if(s.I)return void this.Vs(s);const{m:h,scale:o,rotation:a,opacity:r}=s;t.save();const c=s.size.u(s.origin),l=h.add(i(n,o,c));if(t.translate(l.x,l.y),1!=o&&t.scale(o,o),0!=a){const s=e(n,a,c);t.translate(s.x,s.y),t.rotate(a)}t.globalAlpha=t.globalAlpha*r,!!s.L&&s.L(t),s.A.map(s=>{this.js(t,s)}),t.restore()}}class Gs{canvas;I;ot;Is;Rs;$;$s;_s;constructor({canvas:t}){this.canvas=t,this.I=this.canvas.getContext("2d"),this.ot=g.get(M),this.Is=g.get(Ns),this.Ws(),window.onresize=this.Ws,this.Is.on(Xs,this.draw)}Ws=()=>{const t=getComputedStyle(this.canvas);this.Rs=h(parseInt(t.width),parseInt(t.height)),this.canvas.width=this.Rs.x,this.canvas.height=this.Rs.y,this.I.imageSmoothingEnabled=!1,this.$=this.ot.root.size;const s=Math.min(this.Rs.x/this.$.x,this.Rs.y/this.$.y);this._s=h(this.$.x*s,this.$.y*s),this.$s=this.Rs.o(this._s).mul(.5)};draw=()=>{this.I.drawImage(this.ot.root.canvas,0,0,this.$.x,this.$.y,this.$s.x,this.$s.y,this._s.x,this._s.y)}}const js=t(),Qs=t(),ti=t();class si extends s{Gs;ot;Os=n;Us=!1;Xs=!1;qs=!1;Ns;Js;Ks=.2;Qs=2;constructor(){super(),this.ot=g.get(M),this.Gs=g.get(Gs);const t=this.Gs.canvas;t.onmousedown=t=>this.Ys(t),t.onmouseup=t=>this.ti(t),t.onmousemove=t=>this.si(t)}Ys(t){this.Xs=!0,this.ii(js,t)}ti(t){this.Xs=!1,this.ii(Qs,t)}si(t){this.ii(ti,t)}ii(t,s){const i=this.ei(this.hi(s));this.Os=i,this.i(t,{m:i})}hi(t){return h(t.clientX,t.clientY)}ei(t){const{$s:s,$:i,_s:e}=this.Gs;let h=t.o(s);return h=h.u(i).u(e.v()),h}}const ii=(t,s)=>{s(t).map(t=>ii(t,s))},ei=t=>!!t.qt;class hi extends s{ot;constructor(){super(),this.ot=g.get(M),this.ot.on(w,t=>this.ni(t))}ni(t){ii(this.ot.root,s=>s.F?[]:(ei(s)&&(s.Nt||(s.m=s.m.add(h(1,0).mul(s.qt*t/1e3)),s.m.x>this.ot.root.size.x&&s.h())),s.A))}}const ni=t=>[...t].reverse(),oi=t=>void 0!==t.gs,ai=t=>void 0!==t.us,ri=t(),ci=t();class li extends s{ot;input;ri=null;oi=[];constructor(){super(),this.ot=g.get(M),this.input=g.get(si),this.ot.on(w,()=>this.move()),this.input.on(js,()=>this.click())}click(){this.i(ri,{item:this.ri,ai:this.oi,li:this.input.Os})}move(){if(this.input.Os.l(n)&&this.input.Os.p(this.ot.root.size)){const t=[],s=[];ii(this.ot.root,i=>((oi(i)||ai(i)&&i.us)&&t.push(i),(t=>void 0!==t.Kt)(i)&&i.Kt&&s.push(i),i.A)),this.ri=ni(t).find(t=>t.j(this.input.Os))??null,this.oi=ni(s).filter(t=>t.j(this.input.Os))}else this.ri=null,this.oi=[];this.i(ci,{ri:this.ri,li:this.input.Os})}}const ui=t(),di=t(),mi=t(),pi=t(),xi=t(),zi=t(),yi=t(),wi=t(),Mi=t(),gi=t(),Ai=t(),vi=t(),fi=t(),Ei=t(),Bi=t(),Li={[ui]:[{[wi]:di,[Mi]:pi},[Ei]],[di]:[{[gi]:mi,[fi]:ui},[Ei,Bi]],[mi]:[{[Ai]:ui},[Bi]],[pi]:[{[vi]:xi}],[xi]:[{[yi]:zi},[Ei]],[zi]:[{[Ai]:ui}]};class Di extends z{L(t){Qt(t,{path:"m11 15 5-14 5 13-10 1Z"}),Zt(t,"#D58DE2")}}class Ci extends z{ot=g.get(M);viewBox=h(22,71);ls=h(22,22);origin=this.ls.u(this.viewBox.v());ci=!1;size=this.viewBox;L(t){const s=h(22,71),i=[{},{offsetX:s.x-1,Ut:!0}];for(const{offsetX:e,Ut:h}of i)t.save(),e&&t.translate(e,0),Qt(t,{path:"M22 1C12-2 10 5 8 11c-11.5 3-7 11.5-6.5 16 0 2 0 4 .5 6 3 12.1 2 28.6 2 38h18V1Z",viewBox:s,Ut:h}),Zt(t,"#19191A"),t.restore();if(this.ci)for(const{offsetX:e,Ut:h}of i)t.save(),e&&t.translate(e,0),Qt(t,{path:"M20 13c0 4.1-1.5 6.5-3.5 6.5-1.9 0-3.5-2.4-3.5-6.5s2.1-8 4-8c2 0 3 3.9 3 8Z",viewBox:s,Ut:h}),Zt(t,"#E6B9B9"),Qt(t,{path:"M11.7 22c.9 2.9-.2 4.4-2 5-1.9.6-3.8-.1-4.7-3-.9-2.9-.5-6.9 1.4-7.5 1.8-.5 4.4 2.6 5.3 5.5Z",viewBox:s,Ut:h}),Zt(t),Qt(t,{path:"M16 28c2.5-2 3-6 6-6v15c-1.7 0-5.3 2-8 1.5-3.5-.6-5.4-3-4.5-5.5 1.1-3.4 4.2-3.1 6.5-5Z",viewBox:s,Ut:h}),Zt(t),t.restore();Pt(t,h(4,s.y-1),h(2*s.x-9,1e3),"#19191A")}}class Pi extends z{ot=g.get(M);input=g.get(si);pi=g.get(li);Dt=new ut(Li,ui);ui=null;di=this.m;wi;gi;Mi;yi;Ps;Hs=new Ci;mi=new Di;xi=new z({A:[this.mi,this.Hs]});zi=new z;constructor(t){super(t),this.Hs.m=this.Hs.ls.mul(-1),this.mi.m=this.Hs.m,this.S([this.xi,this.zi])}baseLayer=1;fi=[this.pi.on(ci,t=>this.move(t)),this.pi.on(ri,t=>this.click(t))];h(){super.h(),this.fi.map(t=>t()),this.ui=null,this.Hs=null,this.mi=null,this.xi=null,this.zi=null}move({ri:t,li:s}){this.wi={ri:t,li:s},t&&!t.us||this.idle(),t?.gs&&this.li(),this.seek(s)}Fi(){this.wi&&this.move(this.wi)}click({item:t,li:s,ai:i}){if(t&&ai(t)&&this.ws(t),t&&oi(t)&&this.Ms(t,s),i&&this.ui){const t=i.find(t=>!0===t.Kt||t.Kt(this.ui));t&&this.drop(t,s)}}seek(t){this.Dt.Zt(Ei)&&(this.gi=lt(this.gi?this.gi():n,t,100,ot))}async Ms(t,s){if(!this.Dt.Ht(gi))return;this.Dt.Pt(gi);const i=t.vs(s),e=100;this.Ps=lt(1,t.baseLayer/this.baseLayer,e,nt),this.yi=lt(this.yi?this.yi():h(6,30),h(4,22),e,nt),this.gi=lt(this.di,i,e,nt),await zs(e),t.Ms(),this.Ps=lt(t.baseLayer/this.baseLayer,1,e,ot),this.yi=lt(h(4,22),h(6,30),e,ot),this.Dt.Pt(Ai),this.Fi()}idle(){this.Dt.Ht(fi)&&(this.Dt.Pt(fi),this.yi&&(this.yi=lt(this.yi(),n,200,at)),this.Mi=lt(this.Mi?this.Mi():h(0,-7.5),n,200,nt),this.Ps=lt(this.xi.scale,1,200,at))}async li(){this.Dt.Ht(wi)&&(this.Dt.Pt(wi),this.yi=lt(this.yi?this.yi():n,h(6,30),125,at),await zs(75),this.Dt.Zt(Bi)&&(this.Mi=lt(this.Mi?this.Mi():n,h(0,-7.5),75,ot)))}async drop(t,s){const i=this.ui;if(!this.Dt.Ht(yi)||!i)return;this.Dt.Pt(yi),this.ui=null;let e=t.Qt(s);ei(t)&&(e=e.add(h(1,0).mul(75*t.qt/1e3)));const o=h(0,40);this.gi=lt(this.xi.m,e,75,at),this.Ps=lt(this.xi.scale,t.Jt/this.baseLayer,75,at),await zs(75),i.m=e.o(i.ls),i.scale=t.Jt/i.baseLayer,i.drop?.(t),this.zi.B(i),ei(t)&&(i.qt=t.qt),this.yi=lt(n,o,75,at),await zs(75),ei(t)&&!t.Nt&&(i.qt=0),Object.assign(i,t.P(i)),t.host?.(i),t.B(i),this.Hs.ci=!1,this.Dt.Pt(Ai),this.yi=lt(o,n,150,at),this.Ps=lt(this.xi.scale,1,150,at)}async ws(t){if(!this.Dt.Ht(Mi))return;this.Dt.Pt(Mi),this.ui=t;let s=t.V(t.ls);ei(t)&&(s=s.add(h(1,0).mul(150*t.qt/1e3)));const i=h(0,40);this.gi=lt(this.xi.m,s,150,at),this.yi=lt(n,i,75,at),this.Ps=lt(this.xi.scale,t.scale*t.baseLayer/this.baseLayer,75,at),await zs(75),Object.assign(t,this.ot.root.P(t)),this.zi.B(t),this.Hs.ci=!0,this.yi=lt(i,n,75,at),await zs(75),ei(t)&&(t.qt=0),t.scale=this.baseLayer/t.baseLayer,t.m=t.ls.mul(-1),t.ws?.(),this.xi.B(t),this.Dt.Pt(vi),this.Ps=lt(this.xi.scale,1,150,at),this.Fi()}update(t){this.gi&&(this.xi.m=this.di=this.gi(t)),this.Mi&&(this.mi.m=this.Hs.m.add(this.Mi(t))),this.yi&&(this.xi.m=this.xi.m.add(this.yi(t))),this.Ps&&(this.xi.scale=this.Ps(t))}}class Fi extends z{L(t){Pt(t,n,this.size,"#9C5FA7")}}class bi extends z{Ai=Math.PI;Ci=t=>{this.Ai=Math.PI-.02617993877991494*t};Ei=g.get(it).on(Q,this.Ci);h(){super.h(),this.Ei()}L(t){Pt(t,n,this.size,ts(t,n,h(0,this.size.y),[[0,"#EA9D50"],[1,"#E5B993"]]));const s=this.size.u(d),i=h(this.size.x/2/4,this.size.y),{x:o,y:a}=e(i,this.Ai,s);t.beginPath(),t.arc(o,a+2*(this.size.y-a)*(this.size.y/this.size.x),20,0,2*Math.PI,!0),Zt(t,"#F9F3EF")}}const Zi=t(),Hi=h(9,13),Oi=h(14,11),Ui=(t,s=!1)=>ts(t,n,Hi.u(a),[[0,s?"#956037":"#A3683C"],[1,s?"#A3683C":"#956037"]]),Si=(t,s=!1)=>ts(t,n,Oi.u(a),[[0,s?"#B37342":"#A3683C"],[1,s?"#A3683C":"#B37342"]]),Yi=[[h(21,-5),!0],[h(34,10),!0],[h(10,20)],[h(23,36)],[h(7,43),!0],[h(21,55),!0]],ki=[[h(1,0)],[h(17,10)],[h(45,22)],[h(-10,38)],[h(50,38)],[h(35,32)]],Ii=new y({id:Zi,size:h(60,60),A:[new class extends z{constructor(t={}){super(t),this.size=h(60,60)}L(t){Pt(t,n,this.size,"#A3683C"),[{Si:Ui,Bi:Yi,viewBox:Hi,path:"M0 13c3.9 0 9-3 9-6.5C9 2.9 3.9 0 0 0v13Z"},{Si:Si,Bi:ki,viewBox:Oi,path:"M0 11c7.7 0 14-2.5 14-5.5S7.7 0 0 0v11Z"}].map(({Si:s,Bi:i,viewBox:e,path:h})=>i.map(([i,n])=>{t.save(),t.translate(i.x,i.y),Qt(t,{path:h,viewBox:e,Ut:n}),Zt(t,s(t,n)),t.restore()})),[10.5,32.5,54.5].map(s=>{Qt(t,{path:`M0 ${s}L${this.size.x} ${s}`}),bt(t,"#3B2616",2)}),[{Si:ts(t,h(0,0),h(14,0),[[0,"#956037"],[1,"#A3683C"]]),path:"M0 17c3 0 5 .5 7.5 0 2.6-.5 4-1.5 6.5-1.5"},{Si:ts(t,h(0,0),h(60,0),[[0,"#684327"],[1,"#956037"]]),path:"M0 21c4.5 0 7.3-1.6 12-1.5 3.1 0 4.9 1 8 1 3.5 0 5.5-.9 9-1 4.7-.1 7.3.9 12 1 7.4.2 11.5-3.5 19-3.5"},{Si:ts(t,h(19,0),h(60,0),[[0,"#956037"],[.5,"#5B3727"],[1,"#684327"]]),path:"M60 21c-2 0-7 .6-8.5 1-4 1-15.5 1.7-19 2-6 .5-11 3-15 3"},{Si:ts(t,h(13,0),h(48,0),[[0,"#956037"],[.5,"#764D2D"],[1,"#A3683C"]]),path:"M13 47.5c4.5-.5 7-2 11.5-3 5.2-1 8.3-1 13.5-2 4-.8 6-2 10-2.5"},{Si:ts(t,h(0,0),h(16,0),[[0,"#684327"],[1,"#956037"]]),path:"M0 47c6.5 0 10.5-3 16.5-4"},{Si:ts(t,h(36,0),h(60,0),[[0,"#956037"],[1,"#684327"]]),path:"M37.5 48c9-1 19-1 22.5-1"}].map(({Si:s,path:i})=>{Qt(t,{path:i}),bt(t,s,2)})}}]}),Vi=(t,s)=>t.createPattern(g.get(M).root.k(s).canvas,"repeat");class $i extends z{L(t){Pt(t,n,this.size,Vi(t,Zi))}}const Ji=t(),Ti=t(),_i=G(...[.1,,,2,,3,4,,,,,,,20,,,,.8,.2,,1e3]);class qi extends A{constructor(t={}){super({...t,mode:"hug",align:"end",U:"start"})}L(t){Ct(t,h(-4,-4),this.size.add(h(8,8)),8,"#E4B4B4")}}class Ri{ot;constructor(){this.ot=g.get(M),this.ot.on(w,t=>this.update(t))}update(t){this.ot.root&&ii(this.ot.root,s=>{if((t=>!!t.update)(s)){if(s.F)return[];s.update(t)}return s.A})}}const Wi=t(),Ki=new y({id:Wi,size:h(16,16),A:[new class extends z{L(t){Pt(t,n,o.mul(16),"#E5A366"),Qt(t,{path:"M8 0 0 8l8 8 8-8-8-8Z"}),Zt(t,"#DB9657")}}]}),Xi=t();class Ni extends z{radius;constructor({radius:t,...s}){super(s),this.radius=t}L(t){Ct(t,n,this.size,this.radius,"#560A0A55")}}class Gi extends Ni{ki=g.get(si).on(js,({m:t})=>{this.j(t)&&(K(...Z),this.i(Xi))});h(){super.h(),this.ki()}L(t){Ct(t,h(0,2),this.size,this.radius,"#000000dd"),Ct(t,n,this.size,this.radius,"#FF9838dd"),bt(t,"#FEE2E2")}}class ji extends Ys{Ls="#FEE2E2"}class Qi extends z{screen;delay;color;origin=m;constructor({color:t,delay:s,...i}){super(i),this.screen=g.get(Dt),this.color=t,this.delay=s}update(){const t=Math.min(Math.max(Math.abs(this.screen.Tt-1+.25-this.delay)-.25,0)/.5,1);this.rotation=t*Math.sign(this.screen.Tt-1)*Math.PI,this.scale=-1*t+1}L(t){t.fillStyle=this.color,t.fillRect(0,0,this.size.x,this.size.y)}}class te extends z{constructor(){super();const t=g.get(M).root.size.mul(.05).ceil();ss(t.y).map(s=>ss(t.x).map(i=>{this.B(new Qi({color:"#B27242",delay:(i+s)*(.5/(t.y+t.x)),size:o.mul(20),m:h(i,s).mul(20)}))}))}}const se=t(),ie=new y({id:se,size:h(16,16),A:[new class extends z{L(t){Pt(t,n,o.mul(16),"#9C5FA7"),Qt(t,{path:"M0 16s0-4 2-6 6-2 6-2 4 0 6-2 2-6 2-6m0 16s0-4 2-6M-2 6c2-2 2-6 2-6"}),bt(t,"#AD64BA",3)}}]}),ee=h(36,24),he=[[[0],0,0,0],[[0,1],1,1,0],[[0,1,2],2,2,0]];class ne extends z{ot=g.get(M);constructor(){super(),(R("s")??[]).map((t,s)=>{he[s][3]=t}),this.B(new A({size:this.ot.root.size,direction:"col",O:16,A:[...he.map((t,s)=>new ae({dt:s,level:t})),new ae({level:R("c")??[[],0,0,0],bi:!0})]}))}L(t){Pt(t,n,this.ot.root.size,Vi(t,se))}}class oe extends z{L(t){Ct(t,n,this.size,16,Vi(t,Wi))}}class ae extends z{size=h(296,32);Li;Di;Hi;Zi;Pi=[];ki;h(){super.h(),this.ki(),this.Li=[],this.Di=null,this.Hi=null,this.Zi=null}Ti(){return[this.Pi.sort(),this.Hi.value,this.Di.value]}Vi(t){const s=!this.Pi.includes(t);s?this.Pi.push(t):this.Pi=this.Pi.filter(s=>s!=t);const i=this.Li[t];i.ps=s?null:"#3A1141",i.cs=!s,this.Zi.opacity=0!=this.Pi.length?1:.5}ji=()=>{this.Hi.hs((this.Hi.value+1)%3)};Ii=()=>{this.Di.hs((this.Di.value+1)%4)};constructor({bi:t=!1,dt:s,level:i,...e}){super(e);const n=t?Gi:Ni;this.Li=U.map(t=>new xs({size:h(t.size.x,80),ps:"#3A1141",cs:!0,origin:a,type:t})),this.Di=new le,this.Di.hs(i[2]);const o=new n({radius:4,size:ee,A:[new A({size:ee,A:[this.Di]})]});o.on(Xi,this.Ii),this.Hi=new ce({size:ee}),this.Hi.hs(i[1]);const r=new n({radius:4,size:ee,A:[this.Hi]});r.on(Xi,this.ji),this.Zi=new Gi({radius:12,size:ee,A:[new A({size:ee,A:[new cs({path:gs,Yt:"#FEE2E2",ts:"#FEE2E2",size:h(5,9)})]})],opacity:.5}),this.Zi.on(Xi,()=>{1==this.Zi.opacity&&(g.get(it).init(...this.Ti(),s),g.get(Dt).to(f))});for(const t of i[0])this.Vi(t);this.ki=g.get(si).on(js,({m:s})=>{t&&(this.Li.map((t,i)=>{t.j(s)&&this.Vi(i)}),W("c",[...this.Ti(),0]))});const c=new oe({size:this.size,A:[new A({size:this.size.o(h(12,8)),m:h(6,4),O:8,A:[new Ni({m:h(6,4),radius:12,size:h(40,24),A:[new A({size:h(40,24),A:null!=s?[new us({value:s+1,Yt:"#FEE2E2"})]:[new ue]})]}),new n({radius:4,size:h(106,24),A:[new A({m:h(4,12),direction:"col",align:"center",U:"start",rotation:-Math.PI/2,O:4/.375,scale:.375,A:this.Li})]}),r,o,this.Zi]})]});this.S([c]),null!=s&&this.B(new de({size:h(40,13),m:h(6,26),A:[new ds({value:Math.floor(100*((R("s")??[])[s]??0))}),new cs({path:Ms,size:h(10,9)})]}))}}const re=h(5,9);class ce extends A{value;constructor(t){super(t),this.S(ss(3).map(()=>new cs({size:re,path:gs,Yt:"#FEE2E2"})))}hs(t){this.value=t,this.A.map((t,s)=>t.ts=s>this.value?"#3A1141":"#10A11A")}}class le extends z{value;color;size=h(18,8);hs(t){this.value=t,this.color=["#10A11A","#B27242","#B44141","#AD64BA"][t]}L(t){const s=3==this.value?h(Y(-.5,.5),Y(-.5,.5)):n;Ct(t,h(0,8).add(s),h(5,-4).add(s),1,this.color),bt(t,"#FEE2E2"),Ct(t,h(6.5,8).add(s),h(5,-6).add(s),1,this.value>0?this.color:"#3A1141"),bt(t,"#FEE2E2"),Ct(t,h(13,8).add(s),h(5,-8).add(s),1,this.value>1?this.color:"#3A1141"),bt(t,"#FEE2E2")}}class ue extends z{size=h(16,4);L(t){Ht(t,n,2,"#FEE2E2"),Ht(t,h(6,0),2),Ht(t,h(12,0),2)}}class de extends A{L(t){Ct(t,n,this.size,2,"#FEE2E2")}}const me=document.getElementById("g"),pe=h(360,240),xe=g.set(M,new M({$:pe}));g.set(Ri,new Ri),g.set(Ns,new Ns),g.set(Gs,new Gs({canvas:me})),g.set(si,new si),g.set(li,new li),g.set(hi,new hi),g.set(it,new it),g.set(Dt,new Dt({[v]:ne,[f]:class extends z{level;Ri(t){const s=S(.5),i=this.k(os),e=new Is({Ut:s,rotation:-Math.PI/4*3*(s?-1:1),Ds:t});e.m=i.T(i.Qt(h(-30,0))).o(e.size.u(e.origin)),e.scale=i.Jt/e.baseLayer,e.qt=i.qt,e.Jt=i.Jt,i.B(e)}fi;$i;_i;h(){super.h(),this.fi.map(t=>t()),clearTimeout(this.$i),clearTimeout(this._i)}Wi=()=>{this.$i=setTimeout(this.Wi,k(500,3e3)*(S(.2)?10:1)),K(...B)};Gi=()=>{this._i=setTimeout(this.Gi,k(4e3,5e3)),N([_i])};constructor(){super();const t=g.get(M);this.level=g.get(it),this.level.start(),this.Gi(),this.Wi(),this.fi=[this.level.on(tt,()=>g.get(Dt).to(E)),this.level.on(j,t=>this.Ri(t)),this.level.on(Q,t=>this.k(Ti).hs(Math.floor(t))),this.level.on(st,t=>this.k(Ji).hs(t))];const s=h(t.root.size.x,40),i=h(0,110),e=h(t.root.size.x,90),n=h(t.root.size.x,30),o=h(0,i.y-n.y);this.S([new hs({m:h(0,110),size:s}),new bi({size:h(t.root.size.x,o.y)}),new Fi({m:o,size:n}),new $i({m:h(0,t.root.size.y-90),size:e,A:[new _s({m:h(5,23)}),new Os({m:h(t.root.size.x-90,15)}),new z({Jt:.75,Kt:!0,size:e,Qt(t){const s=this.T(t),i=h(et(s.x,30,this.size.x-30),et(s.y,30,this.size.y-30));return this.V(i)}})]}),new as({m:i,size:s}),new ns({m:i,size:s}),new qi({m:h(8,9),A:[new ds({id:Ti,es:28}),new cs({size:h(8,8),Yt:"#9C5FA7",es:14,path:"M5 1.8c-1.4-1-3.1-.6-3.4.5-.2.6-.2 1.9 2.1 2.3 2.8.5 2 3.4-.4 3.4-.4 0-1.2-.2-2-1"})]}),new qi({m:t.root.size.u(r).o(h(8,-8)),origin:r,A:[new ms({es:28,Yt:"#9C5FA7"}),new ds({id:Ji,es:28})]}),new Pi])}},[E]:class extends z{ot;level;Oi;Ui;Li;Xi;qi;Ni;h(){super.h(),this.Oi=null,this.Ui=null,this.Li=[],this.Xi=null}constructor(){super(),this.level=g.get(it),this.ot=g.get(M);const t=this.level.Mt,s=Math.ceil(t.length/8),i=h(50,80),e=i.y;this.Xi=new ds({es:32,Yt:"#301802"}),this.Oi=new A({size:h(this.ot.root.size.x,32),origin:u,A:[new ms({es:32,Yt:"#AA590F"}),this.Xi,new cs({es:32,path:"m2 9 5-9",size:h(9,9),Yt:"#AA590F"}),new ds({es:32,value:this.level.Et(),Yt:"#301802"}),new ms({es:32,Yt:"#AA590F"})]}),this.Ui=new A({size:h(this.ot.root.size.x,32),origin:d,O:4,scale:0,A:[new ds({es:32,value:Math.floor(this.level.Ct()/this.level.Et()*100),Yt:"#301802"}),new cs({es:32,path:Ms,size:h(9,9),Yt:"#AA590F"})]}),this.Li=t.map(([t,,s])=>new z({size:i,origin:m,A:[new xs({type:t,size:i,rotation:-Math.PI/4*3}),...s?[new A({size:i,A:[new cs({Yt:"#FEE2E2",size:h(8,9),path:ws,es:64})]})]:[]]})),this.qi=lt(0,1,300*this.Li.length,at),this.S([new A({size:this.ot.root.size,direction:"col",A:[new z({size:h(this.ot.root.size.x,32),A:[this.Oi,this.Ui]}),new A({size:h(this.ot.root.size.x,e*s),direction:"col",scale:.5,A:[...ss(s).map(t=>new A({size:h(this.ot.root.size.x,e),O:5,A:this.Li.slice(8*t,8*(t+1))}))]})]})]);const n=h(40,40),o=new Gi({m:h(160,188),radius:20,size:n,A:[new A({size:n,A:[new rs({size:h(20,16),path:"M7 2h11M7 8h11M7 14h11M3 8H1.5M3 14H1.5M3 2H1.5",ss:3})]})]});o.on(Xi,()=>g.get(Dt).to(v)),this.B(o)}Vt=0;Ji=[];update(t){const s=this.qi(t);let i=0;this.Li.map((t,e,o)=>{t.scale=et(s*o.length-e,0,1);const[,a,r]=this.level.Mt[e];if(r&&s*o.length-e>0&&(i+=1,i>this.Ji.length)){const s=g.get(Us);s.Bs(t.V(n).o(h(12,16)),ji),s.Bs(this.Xi.V(this.Xi.size.mul(.5)).add(h(Y(-12,12),Y(-12,12))),ji),K(...L.slice(0,2),L[2]+25*i,...L.slice(3)),this.Ji.push(lt(0,a,300,at))}});const e=this.Ji.reduce((s,i)=>s+Math.floor(i(t)),0);if(this.Xi.hs(e),this.Ni){const s=this.Ni(t);this.Oi.opacity=1-.5*s,this.Oi.scale=.6875*(1-s)+.3125,this.Oi.m=h(this.Oi.m.x,10*(1-s)-10),this.Ui.scale=s}1!=s||this.Ni||(this.Vt+=t/1e3,this.Vt>.2&&(K(...L.slice(0,2),L[2]+25*(i+2),...L.slice(3)),this.Ni=lt(0,1,500,at)))}L(t){Pt(t,n,this.ot.root.size,Vi(t,Wi))}}})),g.set(Us,new Us),xe.root.S([Ii,Ki,ie,new class extends z{screen;constructor(t){super(t),this.screen=g.get(Dt),this.screen.on(Bt,this.Ki),this.screen.on(Lt,this.Qi),this.B(new te)}Qi=async t=>{const[s]=this.A;s&&s.h(),this.B(t,0)};Ki=async()=>{const[t]=this.A;t&&(t.F=!0)}}({A:[new ne]}),new class extends z{update(t){this.m=g.get(si).Os}L(t){Ft(t,o.mul(-2),2),bt(t,"#FEE2E2")}}]),xe.W()</script>