function SfxrParams(){this.setSettings=function(t){for(var e=0;24>e;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(.18>i){var s=.18/i;this.b*=s,this.c*=s,this.e*=s}}}function SfxrSynth(){this._params=new SfxrParams;var t,e,i,s,a,h,r,n,o,c,l,d;this.reset=function(){var t=this._params;s=100/(t.f*t.f+.001),a=100/(t.g*t.g+.001),h=1-t.h*t.h*t.h*.01,r=-t.i*t.i*t.i*1e-6,t.a||(l=.5-t.n/2,d=5e-5*-t.o),n=1+t.l*t.l*(t.l>0?-.9:10),o=0,c=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var s=this._params;return t=s.b*s.b*1e5,e=s.c*s.c*1e5,i=s.e*s.e*1e5+12,3*((t+e+i)/3|0)},this.synthWave=function(u,p){var g=this._params,f=1!=g.s||g.v,m=g.v*g.v*.1,y=1+3e-4*g.w,v=g.s*g.s*g.s*.1,x=1+1e-4*g.t,S=1!=g.s,w=g.x*g.x,b=g.g,T=g.q||g.r,M=g.r*g.r*g.r*.2,H=g.q*g.q*(g.q<0?-1020:1020),R=g.p?((1-g.p)*(1-g.p)*2e4|0)+32:0,I=g.d,D=g.j/2,C=g.k*g.k*.01,k=g.a,A=t,F=1/t,q=1/e,G=1/i,E=5/(1+g.u*g.u*20)*(.01+v);E>.8&&(E=.8),E=1-E;for(var K,W,L,P,B,U,z=!1,j=0,N=0,O=0,Y=0,_=0,V=0,X=0,J=0,Q=0,Z=0,$=new Array(1024),tt=new Array(32),et=$.length;et--;)$[et]=0;for(var et=tt.length;et--;)tt[et]=2*Math.random()-1;for(var et=0;p>et;et++){if(z)return et;if(R&&++Q>=R&&(Q=0,this.reset()),c&&++o>=c&&(c=0,s*=n),h+=r,s*=h,s>a&&(s=a,b>0&&(z=!0)),W=s,D>0&&(Z+=C,W*=1+Math.sin(Z)*D),W|=0,8>W&&(W=8),k||(l+=d,0>l?l=0:l>.5&&(l=.5)),++N>A)switch(N=0,++j){case 1:A=e;break;case 2:A=i}switch(j){case 0:O=N*F;break;case 1:O=1+2*(1-N*q)*I;break;case 2:O=1-N*G;break;case 3:O=0,z=!0}T&&(H+=M,L=0|H,0>L?L=-L:L>1023&&(L=1023)),f&&y&&(m*=y,1e-5>m?m=1e-5:m>.1&&(m=.1)),U=0;for(var it=8;it--;){if(X++,X>=W&&(X%=W,3==k))for(var st=tt.length;st--;)tt[st]=2*Math.random()-1;switch(k){case 0:B=l>X/W?.5:-.5;break;case 1:B=1-X/W*2;break;case 2:P=X/W,P=6.28318531*(P>.5?P-1:P),B=1.27323954*P+.405284735*P*P*(0>P?1:-1),B=.225*((0>B?-1:1)*B*B-B)+B;break;case 3:B=tt[Math.abs(32*X/W|0)]}f&&(K=V,v*=x,0>v?v=0:v>.1&&(v=.1),S?(_+=(B-V)*v,_*=E):(V=B,_=0),V+=_,Y+=V-K,Y*=1-m,B=Y),T&&($[J%1024]=B,B+=$[(J-L+1024)%1024],J++),U+=B}U*=.125*O*w,u[et]=U>=1?32767:-1>=U?-32768:32767*U|0}return p}}function ArcadeAudio(){this.sounds={}}function drawText(t,e,i,s,a){var h=[];t=t.toUpperCase();for(var r=0;r<t.length;r++){var n=letters[t.charAt(r)];n&&h.push(n)}ctx.fillStyle=a;var o=0;for(r=0;r<h.length;r++){n=h[r];for(var c=0,l=0,d=0;d<n.length;d++){for(var u=n[d],p=0;p<u.length;p++)u[p]&&ctx.fillRect(i+(o+p*e),s+c,e,e);l=Math.max(l,u.length*e),c+=e}o+=e+l}}function randomRange(t,e){return Math.floor(Math.random()*(e-t+1))+t}function createTempCanvas(t,e){var i=document.createElement("canvas"),s=i.getContext("2d");return i.width=t,i.height=e,{canvas:i,ctx:s}}function getDistance(t,e){var i=t.x+t.width/2,s=t.y+t.height/2,a=e.x+e.width/2,h=e.y+e.height/2;return Math.sqrt((a-i)*(a-i)+(h-s)*(h-s))}function Map(t){Sprite.call(this,t),this.bg=!0,this.bgIndex=1,this.x=0,this.y=0,this.width=WIDTH,this.height=HEIGHT;var e=createTempCanvas(this.width,this.height);this.canvas=e.canvas,this.ctx=e.ctx,this.ctx.fillStyle="rgb(100,100,100)",this.ctx.fillRect(this.x,this.y,this.width,this.height),this.ctx.fillStyle="#009dd1",this.ctx.fillRect(this.width-20,0,20,this.height),this.ctx.fillStyle="#00d12c",this.ctx.fillRect(this.width-70,0,50,this.height),this.ctx.fillStyle="#d4d4d4";for(var i=0;5>i;i++)for(var s=1;5>s;s++)this.ctx.fillRect(150*s,30+120*i,3,60)}function FrogSpawner(){this.updateOnly=!0,this.live=!0,this.lastUpdate=Date.now(),this.spawnFreq=1400,this.spawnCount=0,1===gameMode?(this.spawnFreq=1e3,this.spawnCount=0):this.spawnFreq=30}function Frog(t){Sprite.call(this,t),this.x=t.x||0,this.y=t.y||10,this.z=1,this.width=20,this.height=16,this.radius=14,this.color={r:0,g:255,b:0,a:1},this.shape=!0,this.colId=0,this.speed=1.5*Math.random()+1.5,this.jump=0,this.jumpSpeed=.24*Math.random()+.12}function Car(t){t=t||{},Sprite.call(this,t),this.skidCanvas=createTempCanvas(WIDTH,HEIGHT),this.width=60,this.height=40,this.radius=30,this.y=t.y||HEIGHT/2,this.x=t.x||WIDTH-120,this.z=2,this.vel={x:0,y:0},this.acc={x:0,y:0},this.angle=0,this.turnSpeed=3,this.thrust=.32,this.isThrusting=!1,this.maxAcc=4.5,this.colId=1,this.color={r:255,g:255,b:255,a:1},this.shape=!0}function Game(){this.states={},this.curState={},this.shakeCount=0,this.shake=0,this.shakeDec=1,this.keys=[],document.addEventListener("keydown",function(t){this.keyDown(t)}.bind(this),!1),document.addEventListener("keyup",function(t){this.keyUp(t)}.bind(this),!1),this.renderCanvas=createTempCanvas(WIDTH,HEIGHT),document.body.appendChild(this.renderCanvas.canvas),this.addState("init"),this.update()}function menuState(){RibbitSmash.addState("Menu"),RibbitSmash.add(new Menu)}function lostState(){RibbitSmash.addState("Lost"),RibbitSmash.add(new Lose)}function gameState(){RibbitSmash.addState("Game"),frogsKilled=0,frogsSaved=0,maxSaved=20,gameStartTime=Date.now(),gameMap=new Map,RibbitSmash.add(gameMap),RibbitSmash.add(new GameUI),RibbitSmash.add(new FrogSpawner),RibbitSmash.add(new Car)}!function(t,e){"function"==typeof define&&define.amd?define(["exports"],e):e("object"==typeof exports&&"string"!=typeof exports.nodeName?exports:t.TinyMusic={})}(this,function(t){function e(t){var i=t.split(n);this.frequency=e.getFrequency(i[0])||0,this.duration=e.getDuration(i[1])||0}function i(t,e,i){this.ac=t||new AudioContext,this.createFxNodes(),this.tempo=e||120,this.loop=!0,this.smoothing=0,this.staccato=0,this.notes=[],this.push.apply(this,i||[])}var s="B#-C|C#-Db|D|D#-Eb|E-Fb|E#-F|F#-Gb|G|G#-Ab|A|A#-Bb|B-Cb",a=440*Math.pow(Math.pow(2,1/12),-9),h=/^[0-9.]+$/,r=4,n=/\s+/,o=/(\d+)/,c={};s.split("|").forEach(function(t,e){t.split("-").forEach(function(t){c[t]=e})}),e.getFrequency=function(t){var e=t.split(o),i=c[e[0]],s=(e[1]||r)-r,h=a*Math.pow(Math.pow(2,1/12),i);return h*Math.pow(2,s)},e.getDuration=function(t){return h.test(t)?parseFloat(t):t.toLowerCase().split("").reduce(function(t,e){return t+("w"===e?4:"h"===e?2:"q"===e?1:"e"===e?.5:"s"===e?.25:0)},0)},i.prototype.createFxNodes=function(){var t=[["bass",100],["mid",1e3],["treble",2500]],e=this.gain=this.ac.createGain();return t.forEach(function(t,i){i=this[t[0]]=this.ac.createBiquadFilter(),i.type="peaking",i.frequency.value=t[1],e.connect(e=i)}.bind(this)),e.connect(this.ac.destination),this},i.prototype.push=function(){return Array.prototype.forEach.call(arguments,function(t){this.notes.push(t instanceof e?t:new e(t))}.bind(this)),this},i.prototype.createCustomWave=function(t,e){e||(e=t),this.waveType="custom",this.customWave=[new Float32Array(t),new Float32Array(e)]},i.prototype.createOscillator=function(){return this.stop(),this.osc=this.ac.createOscillator(),this.customWave?this.osc.setPeriodicWave(this.ac.createPeriodicWave.apply(this.ac,this.customWave)):this.osc.type=this.waveType||"square",this.osc.connect(this.gain),this},i.prototype.scheduleNote=function(t,e){var i=60/this.tempo*this.notes[t].duration,s=i*(1-(this.staccato||0));return this.setFrequency(this.notes[t].frequency,e),this.smoothing&&this.notes[t].frequency&&this.slide(t,e,s),this.setFrequency(0,e+s),e+i},i.prototype.getNextNote=function(t){return this.notes[t<this.notes.length-1?t+1:0]},i.prototype.getSlideStartDelay=function(t){return t-Math.min(t,60/this.tempo*this.smoothing)},i.prototype.slide=function(t,e,i){var s=this.getNextNote(t),a=this.getSlideStartDelay(i);return this.setFrequency(this.notes[t].frequency,e+a),this.rampFrequency(s.frequency,e+i),this},i.prototype.setFrequency=function(t,e){return this.osc.frequency.setValueAtTime(t,e),this},i.prototype.rampFrequency=function(t,e){return this.osc.frequency.linearRampToValueAtTime(t,e),this},i.prototype.play=function(t){return t="number"==typeof t?t:this.ac.currentTime,this.createOscillator(),this.osc.start(t),this.notes.forEach(function(e,i){t=this.scheduleNote(i,t)}.bind(this)),this.osc.stop(t),this.osc.onended=this.loop?this.play.bind(this,t):null,this},i.prototype.stop=function(){return this.osc&&(this.osc.onended=null,this.osc.disconnect(),this.osc=null),this},t.Note=e,t.Sequence=i});var synth=new SfxrSynth;window.jsfxr=function(t){synth._params.setSettings(t);var e=synth.totalReset(),i=new Uint8Array(4*((e+1)/2|0)+44),s=2*synth.synthWave(new Uint16Array(i.buffer,44),e),a=new Uint32Array(i.buffer,0,44);a[0]=1179011410,a[1]=s+36,a[2]=1163280727,a[3]=544501094,a[4]=16,a[5]=65537,a[6]=44100,a[7]=88200,a[8]=1048578,a[9]=1635017060,a[10]=s,s+=44;for(var h=0,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n="data:audio/wav;base64,";s>h;h+=3){var o=i[h]<<16|i[h+1]<<8|i[h+2];n+=r[o>>18]+r[o>>12&63]+r[o>>6&63]+r[63&o]}return n},ArcadeAudio.prototype.add=function(t,e,i){this.sounds[t]=[],i.forEach(function(i,s){this.sounds[t].push({tick:0,count:e,pool:[]});for(var a=0;e>a;a++){var h=new Audio;h.src=jsfxr(i),this.sounds[t][s].pool.push(h)}},this)},ArcadeAudio.prototype.play=function(t){var e=this.sounds[t],i=e.length>1?e[Math.floor(Math.random()*e.length)]:e[0];i.pool[i.tick].play(),i.tick<i.count-1?i.tick++:i.tick=0};var arcadeAudio=new ArcadeAudio;arcadeAudio.add("damage",3,[[1,,.0124,,.182,.296,,-.4884,,,,,,,,,,,1,,,,,1],[3,,.0986,,.1805,.3087,,-.6811,,,,,,,,,,,1,,,,,1],[0,,.0361,,.1438,.2402,,-.4679,,,,,,.5132,,,,,1,,,,,1]]),arcadeAudio.add("screech",50,[[0,,.0639,,.2425,.7582,,-.6217,,,,,,.4039,,,,,1,,,,,.3]]),arcadeAudio.add("lose",1,[[0,.0282,.0784,.0494,.768,.2227,,-.0012,-.0667,.8439,.9265,.0235,.0979,-.4275,.1131,,.0044,.5687,.156,.1265,,.0017,-.0252,1]]),arcadeAudio.add("escaped",1,[[0,,.199,,.3584,.3159,,.3393,,,,,,.0626,,.7404,,,1,,,,,1]]);var letters=letters={A:[[,1],[1,,1],[1,,1],[1,1,1],[1,,1]],B:[[1,1],[1,,1],[1,1,1],[1,,1],[1,1]],C:[[1,1,1],[1],[1],[1],[1,1,1]],D:[[1,1],[1,,1],[1,,1],[1,,1],[1,1]],E:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],F:[[1,1,1],[1],[1,1],[1],[1]],G:[[,1,1],[1],[1,,1,1],[1,,,1],[,1,1]],H:[[1,,1],[1,,1],[1,1,1],[1,,1],[1,,1]],I:[[1,1,1],[,1],[,1],[,1],[1,1,1]],J:[[1,1,1],[,,1],[,,1],[1,,1],[1,1,1]],K:[[1,,,1],[1,,1],[1,1],[1,,1],[1,,,1]],L:[[1],[1],[1],[1],[1,1,1]],M:[[1,1,1,1,1],[1,,1,,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,1],[1,1,,1],[1,,1,1],[1,,,1],[1,,,1]],O:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],P:[[1,1,1],[1,,1],[1,1,1],[1],[1]],Q:[[0,1,1],[1,,,1],[1,,,1],[1,,1,1],[1,1,1,1]],R:[[1,1],[1,,1],[1,,1],[1,1],[1,,1]],S:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],T:[[1,1,1],[,1],[,1],[,1],[,1]],U:[[1,,1],[1,,1],[1,,1],[1,,1],[1,1,1]],V:[[1,,,,1],[1,,,,1],[,1,,1],[,1,,1],[,,1]],W:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,1,1,1]],X:[[1,,,,1],[,1,,1],[,,1],[,1,,1],[1,,,,1]],Y:[[1,,1],[1,,1],[,1],[,1],[,1]],Z:[[1,1,1,1,1],[,,,1],[,,1],[,1],[1,1,1,1,1]],0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[1],[1],[1],[1],[1]],2:[[1,1,1],[,,1],[1,1,1],[1,,],[1,1,1]],3:[[1,1,1],[,,1],[,1,1],[,,1],[1,1,1]],4:[[1,,1],[1,,1],[1,1,1,1],[,,1],[,,1]],5:[[1,1,1],[1,,,],[1,1,1],[,,1],[1,1,1]],6:[[1,1,1],[1,,,],[1,1,1],[1,,1],[1,1,1]],7:[[1,1,1],[,,1],[,,1],[,,1],[,,1]],8:[[1,1,1],[1,,1],[1,1,1],[1,,1],[1,1,1]],9:[[1,1,1],[1,,1],[1,1,1],[,,1],[1,1,1]]," ":[[,,],[,,],[,,],[,,],[,,]],".":[[,,],[,,],[,,],[,,],[,1]],":":[[,,],[,1],[,,],[,,],[,1]],"/":[[,,1],[,1],[,1],[,1],[1,,]]},canvas=document.querySelector("canvas"),ctx=canvas.getContext("2d"),WIDTH=800,HEIGHT=600;canvas.width=WIDTH,canvas.height=HEIGHT;var Sprite=function(t){t=t||{},this.width=t.width||0,this.height=t.height||0,this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.color=t.color||{r:0,g:0,b:0,a:1},this.shape=t.shape||!1,this.img=t.img,this.live=!0};Sprite.prototype={update:function(){},render:function(){var t=this.color;ctx.save(),ctx.fillStyle="rgba("+t.r+","+t.g+","+t.b+","+t.a+")",ctx.fillRect(this.x,this.y,this.width,this.height),ctx.restore()}};var Emitter=function(t){this.live=!0,this.lastUpdate=Date.now(),this.startTime=Date.now(),t=t||{},this.color=t.color||{r:0,g:0,b:0,a:0},this.width=t.width||WIDTH,this.height=t.height||WIDTH,this.x=t.x||0,this.y=t.y||0,this.z=t.z||0,this.rate=t.rate||1,this.duration=t.duration||70,this.thrustRange=t.thrustRange||{min:0,max:2},this.angleRange=t.angleRange||{max:360},this.particles=[],this.updateOnly=!0};Emitter.prototype={kill:function(){this.particles.length;this.particles=[]},update:function(){if(this.lastUpdate=Date.now(),this.lastUpdate>=1e3/this.rate)if(this.lastUpdate-this.startTime<this.duration)for(rate=this.rate;rate--;){var t=randomRange(this.thrustRange.min,this.thrustRange.max),e=randomRange(0,this.angleRange.max),i=new Particle({x:this.x,y:this.y,z:1,thrust:t,angle:e,color:this.color,size:randomRange(2,6)});this.particles.push(i),RibbitSmash.add(i)}else this.kill()}};var Particle=function(t){Sprite.call(this,t),this.startLife=Date.now(),this.curStep=0,this.vel={x:0,y:0},t=t||{},this.lifeTime=void 0!==t.lifeTime?t.lifeTime:100,this.size=t.size||6,this.width=this.height=this.size,this.thrust=t.thrust||0,this.gravity=t.gravity||0,this.angle=t.angle||0,this.endLife=this.startLife+this.lifeTime};Particle.prototype=new Sprite,Particle.prototype.update=function(){this.curStep=this.endLife-Date.now(),this.vel.x=Math.cos(this.angle*Math.PI/180)*this.thrust,this.vel.y=Math.sin(this.angle*Math.PI/180)*this.thrust+this.gravity*(this.lifeTime-this.curStep),this.x+=this.vel.x,this.y+=this.vel.y,(this.y<0||this.y>HEIGHT||this.x<0||this.x>WIDTH||Date.now()>this.endLife)&&(this.live=!1,this.render(!0))},Particle.prototype.render=function(t){var e,i=ctx,s=this.x,a=this.y;t&&(e=createTempCanvas(this.width,this.height),i=e.ctx,s=0,a=0);var h=this.scale||{x:0,y:0};i.fillStyle="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")",i.fillRect(s,a,this.width-h.x,this.height-h.y),t&&gameMap.battleDamage(e.canvas,this.x,this.y)},Map.prototype=new Sprite,Map.prototype.battleDamage=function(t,e,i){this.ctx.drawImage(t,e,i)},Map.prototype.render=function(){ctx.drawImage(this.canvas,0,0,this.width,this.height)};var GameUI=function(t){t=t||{},Sprite.call(this,t),this.x=0,this.y=0,this.z=100,this.width=WIDTH,this.height=30,gameStartTime=Date.now(),timeLimit=6e4+Date.now()};GameUI.prototype=new Sprite,GameUI.prototype.render=function(){ctx.textAlign="start",ctx.fillStyle="#000042",ctx.fillRect(this.x,this.y,this.width,this.height),1===gameMode?(drawText("Time : "+((Date.now()-gameStartTime)/1e3).toFixed(2),3,40,8,"#fff"),drawText("Escaped : "+frogsSaved+"/"+maxSaved,3,600,8,"#fff"),frogsSaved>=maxSaved&&1===gameMode&&(endTime=((Date.now()-gameStartTime)/1e3).toFixed(2),arcadeAudio.play("lose"),RibbitSmash.switchState("Lost"))):2===gameMode&&(drawText("Time Left : "+Math.abs((Date.now()-timeLimit)/1e3).toFixed(2),3,40,8,"#fff"),((Date.now()-timeLimit)/1e3).toFixed(2)>=0&&(RibbitSmash.switchState("Lost"),endTime=(Date.now()-gameStartTime)/1e3)),drawText("Frogs Killed : "+frogsKilled,3,300,8,"#fff")},FrogSpawner.prototype.update=function(){Date.now()>this.lastUpdate+this.spawnFreq&&(this.lastUpdate=Date.now(),this.spawnCount++,RibbitSmash.add(new Frog({x:Math.random()*-WIDTH,y:randomRange(45,HEIGHT-30)})),(1===gameMode||3===gameMode)&&this.spawnCount>12&&(this.spawnCount=0,this.spawnFreq-=100,this.spawnFreq<200&&(this.spawnFreq=200)))},Frog.prototype=new Sprite,Frog.prototype.hit=function(){this.live=!1;var t=createTempCanvas(this.width,this.height);t.ctx.fillStyle="rgb(10,120,0)",t.ctx.fillRect(0,0,this.width,this.height),gameMap.battleDamage(t.canvas,this.x,this.y),RibbitSmash.shake=randomRange(4,6),RibbitSmash.add(new Emitter({color:{r:250,g:0,b:0,a:1},x:this.x,y:this.y}),!0)},Frog.prototype.update=function(t){this.jump+=this.jumpSpeed,Math.abs(Math.sin(this.jump))===Math.sin(this.jump)&&(this.x+=this.speed+Math.sin(this.jump)),this.x>WIDTH&&(this.live=!1,frogsSaved++,1===gameMode&&arcadeAudio.play("escaped"))},Frog.prototype.render=function(){var t=this.y,e=this.x;Math.abs(Math.sin(this.jump))===Math.sin(this.jump)&&(t=this.y+5*Math.sin(this.jump),e=this.x-5*Math.sin(this.jump)),ctx.save(),ctx.fillStyle="rgba(50,50,50,0.3)",ctx.fillRect(e,t,this.width,this.height),ctx.restore(),Sprite.prototype.render.call(this)},Car.prototype=new Sprite,Car.prototype.hit=function(){frogsKilled++,arcadeAudio.play("damage")},Car.prototype.turn=function(t){this.angle+=this.turnSpeed*t},Car.prototype.drawSkids=function(){arcadeAudio.play("screech"),this.skidCanvas.ctx.clearRect(0,0,WIDTH,HEIGHT),this.skidCanvas.ctx.save(),this.skidCanvas.ctx.translate(this.x+this.width/2,this.y+this.height/2),this.skidCanvas.ctx.rotate(this.angle*Math.PI/180),this.skidCanvas.ctx.fillStyle="rgba(10,10,10, 0.2)",this.skidCanvas.ctx.fillRect(this.height-30,-28,10,8),this.skidCanvas.ctx.fillRect(this.height-30,20,10,8),this.skidCanvas.ctx.restore(),gameMap.battleDamage(this.skidCanvas.canvas,0,0)},Car.prototype.update=function(){var t=this.angle*Math.PI/180;this.y<40&&(this.y=40,this.vel.y=.25*-this.vel.y),this.y+this.height>HEIGHT&&(this.y=HEIGHT-this.height,this.vel.y=.25*-this.vel.y),this.x<0&&(this.x=0,this.vel.x=.25*-this.vel.x),this.x+this.width>WIDTH-20&&(this.x=WIDTH-this.width-20,this.vel.x=.25*-this.vel.x),this.isThrusting=!1,(RibbitSmash.getKey(87)||RibbitSmash.getKey(38)||RibbitSmash.getKey(83)||RibbitSmash.getKey(40))&&(this.isThrusting=!0,(RibbitSmash.getKey(83)||RibbitSmash.getKey(40))&&(this.acc.x=Math.cos(t)*(.4*this.thrust),this.acc.y=Math.sin(t)*(.4*this.thrust)),(RibbitSmash.getKey(87)||RibbitSmash.getKey(38))&&(this.acc.x=Math.cos(t)*-this.thrust,this.acc.y=Math.sin(t)*-this.thrust)),(RibbitSmash.getKey(65)||RibbitSmash.getKey(37))&&(this.turn(-1),this.vel.x*=.98,this.vel.y*=.98,this.isThrusting&&this.drawSkids()),(RibbitSmash.getKey(68)||RibbitSmash.getKey(39))&&(this.turn(1),this.vel.x*=.98,this.vel.y*=.98,this.isThrusting&&this.drawSkids()),this.isThrusting||(this.acc.x=0,this.acc.y=0,this.vel.x*=.96,this.vel.y*=.96),this.vel.x+=this.acc.x,this.vel.y+=this.acc.y,this.x+=this.vel.x,this.y+=this.vel.y},Car.prototype.render=function(){this.color;ctx.save(),ctx.translate(this.x+this.width/2,this.y+this.height/2),ctx.rotate(this.angle*Math.PI/180),ctx.fillStyle="#fff",ctx.fillRect(-this.width/2,-this.height/2,this.width,this.height),ctx.fillStyle="#9400f7",ctx.fillRect(-this.height+20,-10,15,20),ctx.fillStyle="#000",ctx.fillRect(this.height-30,-28,20,8),ctx.fillRect(this.height-30,20,20,8),ctx.fillRect(-this.height+10,-28,20,8),ctx.fillRect(-this.height+10,20,20,8),ctx.restore()};var Menu=function(t){t=t||{},Sprite.call(this,t),this.x=0,this.y=0,this.bg=1,this.width=WIDTH,this.height=HEIGHT;var e=AudioContext?new AudioContext:new webkitAudioContext,i=e.currentTime,s=132,a=["F#4 e","G#4 e","A#4 e","B4  e","C#5 e","D#5 e","D#5 e","G#4 e","G#4 e","A#4 e","A#4 e","B4  e","B4  q","-   q","G#4 e","A#4 e","A#4 e","B4  e","B4  e","F#4 e","F#4 e","F#4 e","A#4 e","F#4 e","F#4 e","F#4 e","A#4 q","-   q"],h=["A#3 e","B3  e","C#2 e","B#3 e","G#3 e","B3  e","C#2 e","B3  e","G#3 e","B3  e","C#2 e","B3  e","G#3 e","B3  e","C#2 e","B3  e","G#3 e","B3  e","C#2 e","B3  e","G#3 e","A#3 e","C#2 e","A#3  e","F#3 e","A#3 e","C#2 e","A#3 e","F#3 q","-   q"];this.lead=new TinyMusic.Sequence(e,s,a),this.bass=new TinyMusic.Sequence(e,s,h),this.lead.staccato=.1,this.bass.staccato=.1,this.lead.gain.gain.value=.3,this.bass.gain.gain.value=.3,i=e.currentTime,this.lead.play(i),this.bass.play(i),gameMode=3,RibbitSmash.add(new FrogSpawner)};Menu.prototype=new Sprite,Menu.prototype.update=function(){(RibbitSmash.getKey(32)||RibbitSmash.getKey(13))&&(this.lead.stop(),this.bass.stop(),gameMode=1,RibbitSmash.getKey(13)&&(gameMode=2),gameStartTime=Date.now(),timeLimit=6e4+Date.now(),gameState(),RibbitSmash.switchState("Game"))},Menu.prototype.render=function(){ctx.fillStyle="rgb(100,100,100)",ctx.fillRect(0,0,this.width,this.height),drawText("Ribbet Smash",10,152,72,"#000"),drawText("Ribbet Smash",10,150,70,"#21de00"),drawText("Survival HighScore "+survivalHighScore+" Seconds",3,224,253,"#000"),drawText("Survival HighScore "+survivalHighScore+" Seconds",3,222,250,"#ffff00"),drawText("Rampage HighScore "+rampageHighScore+" Kills in one Minute",3,154,302,"#000"),drawText("Rampage HighScore "+rampageHighScore+" Kills in one Minute",3,152,300,"#ff42f7"),ctx.font="30px monospace",drawText("Press Space to Play Survival",5,122,482,"#000"),drawText("Press Space to Play Survival",5,120,480,"#ffff00"),drawText("Press Enter to Play Rampage",5,132,532,"#000"),drawText("Press Enter to Play Rampage",5,130,530,"#ff42f7")};var Lose=function(t){t=t||{},Sprite.call(this,t),this.x=0,this.y=0,this.width=WIDTH,this.height=HEIGHT};Lose.prototype=new Sprite,Lose.prototype.update=function(){RibbitSmash.getKey(32)&&(RibbitSmash.keys[32]=!1,menuState())},Lose.prototype.render=function(){ctx.fillStyle="rgb(100,100,100)",ctx.fillRect(0,0,this.width,this.height);ctx.textAlign="center",ctx.fillStyle="#fff",ctx.font="70px monospace",1===gameMode?(endTime>survivalHighScore&&(survivalHighScore=endTime,localStorage.setItem("survivalHighScore",survivalHighScore)),drawText("Too Many Got Away",8,115,72,"#000"),drawText("Too Many Got Away",8,113,70,"#21de00"),drawText("You stopped "+frogsKilled+" in "+endTime,4,227,222,"#000"),drawText("You stopped "+frogsKilled+" in "+endTime,4,225,220,"#ff42f7"),drawText("Longest Survival Time "+survivalHighScore,4,202,322,"#000"),drawText("Longest Survival Time "+survivalHighScore,4,200,320,"#ff42f7")):(frogsKilled>rampageHighScore&&(rampageHighScore=frogsKilled,localStorage.setItem("rampageHighScore",rampageHighScore)),drawText("Frog Killing Machine",8,55,72,"#000"),drawText("Frog Killing Machine",8,53,70,"#21de00"),drawText("You killed "+frogsKilled+" in one minute!",4,187,222,"#000"),drawText("You killed "+frogsKilled+" in one minute!",4,185,220,"#ff42f7"),drawText("Most Killed in a minute "+rampageHighScore,4,172,322,"#000"),drawText("Most Killed in a minute "+rampageHighScore,4,170,320,"#ff42f7")),drawText("Press Space to Return to Menu",5,122,492,"#000"),drawText("Press Space to Return to Menu",5,120,490,"#ffff00")},Game.prototype={add:function(t,e){this.curState.entities.push(t)},remove:function(t){var e=this.curState.entities,i=(e.length,e.indexOf(t));void 0!==i.kill&&i.kill(),e.splice(i,1)},switchState:function(t){this.curState=this.states[t]},addState:function(t,e){this.states[t]={entities:[],init:e},this.switchState(t)},getKey:function(t){return this.keys[t]},keyDown:function(t){this.keys[t.keyCode]=!0},keyUp:function(t){this.keys[t.keyCode]=!1},render:function(){var t=this.curState.entities,e=t.length;for(ctx.clearRect(0,0,WIDTH,HEIGHT),t.sort(function(t,e){return t.bg&&e.bg?e.bgIndex-t.bgIndex:t.bg?1:e.bg?-1:t.z&&e.z?e.z-t.z:0});e--;)t[e].updateOnly||t[e].render();var i=0,s=0;this.shake>0&&(i=(Math.random()-.5)*this.shake,s=(Math.random()-.5)*this.shake,this.shake-=.1*this.shakeDec),cX=i+.5<<0,cY=s+.5<<0,this.renderCanvas.ctx.clearRect(0,0,WIDTH,HEIGHT),this.renderCanvas.ctx.drawImage(canvas,0,0,WIDTH,HEIGHT,cX,cY,WIDTH,HEIGHT)},update:function(){for(var t=this.curState.entities,e=t.length,i=0;e>i;i++)if(void 0!==t[i].colId)for(var s=t[i],a=i+1;e>a;a++)if(void 0!==t[a].colId){var h=t[a];if(s.colId!==h.colId){var r=s.radius+h.radius;getDistance(s,h)<r&&(s.hit(),h.hit())}}for(;e--;){var n=t[e];n&&(n.live?n.update():this.remove(n))}this.render(),requestAnimationFrame(function(){this.update()}.bind(this))}};var RibbitSmash=new Game,gameMap,gameMode=1,frogsKilled=0,frogsSaved=0,maxSaved=20,gameStartTime=Date.now(),endTime=(Date.now()-gameStartTime)/1e3,timeLimit=0,survivalHighScore=localStorage.getItem("survivalHighScore"),rampageHighScore=localStorage.getItem("rampageHighScore");survivalHighScore=survivalHighScore||0,rampageHighScore=rampageHighScore||0,gameState(),lostState(),menuState(),RibbitSmash.switchState("Menu");
//# sourceMappingURL=maps/ribbitsmash.js.map