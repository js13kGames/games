<!doctype html><html><head><meta name=viewport content="width=990"><title>Dwarfs: There and Back Again - js13kGames 2019</title><style>*{touch-action:manipulation}body{background:#fff;font-family:-apple-system,'Segoe UI',system-ui,sans-serif;line-height:1.58;margin:0;-moz-user-select:none;-webkit-user-select:none;user-select:none}b{font-weight:inherit}canvas{display:block;image-rendering:optimizespeed;image-rendering:pixelated}h1{color:#7b9278;font-size:32px;letter-spacing:-.5px;line-height:40px;margin:0 0 0 -2px;text-shadow:0 1px 0 #4c625a;white-space:nowrap}h1 b{color:#eb6b6f}.obj{left:-2000px;margin:40px;opacity:0;position:absolute;top:-1000px;transform:translateY(40px);transition:margin-bottom .5s,opacity .5s,transform .5s}.obj.spawn{opacity:1;position:static;transform:translateY(0)}.obj.despawn{position:static;transform:translateY(-40px)}.controls .obj{transform:translateY(40px) scale3d(1.2,1.2,1)}.controls .obj.spawn{transform:translateY(0) scale3d(1,1,1)}.controls .obj.despawn{margin-bottom:-100px;pointer-events:none;transform:translateY(-40px) scale3d(.8,.8,1)}.controls{left:544px;position:absolute;top:80px;width:440px}.controls a,.textbox a{background:#f84284;border-radius:2px;box-shadow:0 8px 20px rgba(248,66,132,.4);color:#fff;display:block;font-size:13px;font-weight:600;letter-spacing:2px;line-height:20px;padding:10px;text-align:center;text-decoration:none;text-transform:uppercase;touch-action:manipulation;-webkit-tap-highlight-color:transparent;-webkit-user-drag:none}.controls a:focus{outline:1px solid rgba(248,66,132,.9);outline-offset:2px}.controls a:active{box-shadow:0 6px 20px rgba(248,66,132,.4);transform:translateY(2px)}.controls a[disabled]{filter:grayscale(1);pointer-events:none}.textbox{background:#fff;font-size:18px;margin:100px 60px 0;outline:2px solid #fff;outline-offset:1px;padding:20px;width:525px}.textbox a{margin:0 20px 10px}.textbox p{margin:0 0 21px}#dwarf-plural,#fullscreen,#gold-title{display:none}#dwarf-plural{color:#7b9278}#fullscreen{background:rgba(0,0,0,.6);bottom:0;height:100%;left:0;position:fixed;right:0;top:0;width:100%}</style></head><body><div class=obj id=title><h1>We have <b id=dwarf-count>1</b> dwarf<b id=dwarf-plural>s</b><span id=gold-title> and <b id=gold-count>0</b> gold</span>.</h1></div><div class=obj id=fortress><canvas id=can-fortress></canvas></div><div class=obj id=forest><canvas id=can-forest></canvas></div><div class=obj id=treasure><canvas id=can-treasure></canvas></div><div class=controls><div class=obj id=adventure><a id=btn-adventure href=#>send on adventure</a></div><div class=obj id=draft><a id=btn-draft href=# disabled=disabled>draft another dwarf<br>(<b id=dwarf-cost>1</b> gold)</a></div><div class=obj id=covfefe><a id=btn-covfefe href=# disabled=disabled>hot coffee<br>(+20% dwarf speed, 10 gold)</a></div><div class=obj id=autorun><a id=btn-autorun href=# disabled=disabled>automated adventuring<br>(20 gold)</a></div><div class=obj id=fasta><a id=btn-fasta href=# disabled=disabled>red goes fasta!<br>(+10% dwarf speed, 25 gold)</a></div><div class=obj id=illuminate><a id=btn-illuminate href=# disabled=disabled>illuminate the forest<br>(+30% forest speed, 25 gold)</a></div><div class=obj id=turborun><a id=btn-turborun href=# disabled=disabled>turbo button<br>(2x automation speed, 30 gold)</a></div><div class=obj id=speedrun><a id=btn-speedrun href=# disabled=disabled>intel core i9<br>(2x automation speed, 40 gold)</a></div><div class=obj id=orbital><a id=btn-orbital href=#>make dwarfs<br>work again</a></div><div class=obj id=develop><a id=btn-develop href=# disabled=disabled>develop the wasteland<br>(+30% wasteland speed, 20 gold)</a></div><div class=obj id=develop2><a id=btn-develop2 href=# disabled=disabled>industrial revolution<br>(2x carry weight, 25 gold)</a></div><div class=obj id=genetic><a id=btn-genetic href=# disabled=disabled>genetic modification<br>(+50% carry weight, 30 gold)</a></div><div class=obj id=portal><a id=btn-portal href=# disabled=disabled>thinking with portals<br>(science, 60 gold)</a></div><div class=obj id=delorean><a id=btn-delorean href=# disabled=disabled>build a time machine<br>(science, 90 gold)</a></div><div class=obj id=back><a id=btn-back href=#>go back in time<br>(and fix history)</a></div></div><div id=fullscreen><div class=obj id=kegs><div class=textbox><p>Dwarfs have found an unimaginable amount of ale in the forest!</p><p>One hundred kegs of ale opened and one thousand toasts lifted to the great deeds of heroic warriors!</p><p>All work has ceased.</p><a id=btn-continue href=#>continue</a></div></div><div class=obj id=nuke><div class=textbox><p>It is with a heavy heart that you call in an orbital strike on the dwarfs' position.</p><p>An unmanned weapons platform in the low orbit comes to life, its servos whirring softly as the cannons lock on.</p><p>Burning spears of light fall towards the forest below. High-explosive shells find their targets in a deadly gale of blazing destruction.</p><a id=btn-continue2 href=#>continue</a></div></div></div><script>"undefined"==typeof AudioContext&&(window.AudioContext=window.webkitAudioContext,window.OfflineAudioContext=window.webkitOfflineAudioContext);const e=120/118;let t,n,a;function s(s,r,o){const l=function(e){return 440*Math.pow(2,(e-69)/12)}(s);r*=e,o*=e;const i=t.createOscillator();i.type="square",i.frequency.value=l,function(n,s){const r=t.createGain();return r.gain.setValueAtTime(.5,a+s),r.gain.exponentialRampToValueAtTime(1e-5,a+s+1.5*e),n.connect(r),r}(i,r).connect(n),i.start(a+r),i.stop(a+o)}function r(e){switch(e>51?(e-8)%44+8:e){case 0:s(57,e+0,e+.25),s(45,e+0,e+2),s(60,e+.25,e+.5),s(57,e+.5,e+.75),s(64,e+.75,e+1.25);break;case 1:s(60,e+.25,e+.75),s(60,e+.75,e+1);break;case 2:s(52,e+0,e+1),s(60,e+.25,e+.5),s(57,e+.5,e+.75),s(64,e+.75,e+1.25);break;case 3:s(52,e+0,e+.75),s(60,e+.25,e+.75),s(60,e+.75,e+1),s(52,e+.75,e+1);break;case 4:s(45,e+0,e+1.75),s(57,e+.25,e+.5),s(60,e+.5,e+.75),s(64,e+.75,e+1.25),s(57,e+.75,e+1.25);break;case 5:s(57,e+.25,e+.5),s(60,e+.5,e+1),s(52,e+.75,e+1);break;case 6:s(60,e+0,e+1),s(52,e+0,e+.5),s(52,e+.5,e+1.5);break;case 7:s(64,e+0,e+1),s(52,e+.5,e+.75),s(52,e+.75,e+1);break;case 8:s(57,e+0,e+.25),s(45,e+0,e+.75),s(57,e+.25,e+.5),s(57,e+.5,e+.75),s(60,e+.75,e+1.25),s(52,e+.75,e+1.75);break;case 9:s(69,e+.25,e+.5),s(67,e+.5,e+.75),s(69,e+.75,e+1),s(52,e+.75,e+1);break;case 10:s(69,e+0,e+.75),s(41,e+0,e+.25),s(48,e+.25,e+.5),s(55,e+.5,e+1.5),s(57,e+.75,e+1.75);break;case 11:s(55,e+.5,e+.75),s(67,e+.75,e+1),s(50,e+.75,e+1);break;case 12:s(67,e+0,e+.25),s(55,e+0,e+.75),s(67,e+.25,e+.5),s(67,e+.5,e+.75),s(66,e+.75,e+1.25),s(57,e+.75,e+1.75),s(54,e+.75,e+1.75);break;case 13:case 21:s(67,e+.25,e+.5),s(66,e+.5,e+.75),s(64,e+.75,e+1),s(47,e+.75,e+1);break;case 14:case 22:s(52,e+0,e+.25),s(47,e+0,e+2),s(54,e+.25,e+.5),s(56,e+.5,e+.75),s(59,e+.75,e+1.75);break;case 15:s(57,e+.75,e+1);break;case 16:s(57,e+0,e+.25),s(45,e+0,e+.75),s(57,e+.25,e+.5),s(57,e+.5,e+.75),s(60,e+.75,e+1.25),s(52,e+.75,e+1.25);break;case 17:s(69,e+.25,e+.5),s(57,e+.25,e+1),s(67,e+.5,e+.75),s(69,e+.75,e+1);break;case 18:s(69,e+0,e+.75),s(57,e+0,e+.25),s(53,e+0,e+.25),s(48,e+0,e+.25),s(48,e+.25,e+.5),s(55,e+.5,e+.75),s(65,e+.75,e+1.75),s(57,e+.75,e+1.25);break;case 19:s(57,e+.25,e+.5),s(60,e+.5,e+1),s(67,e+.75,e+1);break;case 20:s(67,e+0,e+.25),s(43,e+0,e+.5),s(59,e+.25,e+.5),s(67,e+.5,e+.75),s(50,e+.5,e+.75),s(66,e+.75,e+1.25),s(47,e+.75,e+1.75);break;case 23:s(67,e+.75,e+1);break;case 24:s(67,e+0,e+.25),s(59,e+0,e+.5),s(55,e+0,e+.5),s(62,e+.25,e+.5),s(67,e+.5,e+.75),s(59,e+.5,e+.75),s(67,e+.75,e+1.25),s(57,e+.75,e+1.25);break;case 25:s(67,e+.25,e+.5),s(50,e+.25,e+.5),s(67,e+.5,e+.75),s(43,e+.5,e+1),s(68,e+.75,e+1),s(64,e+.75,e+1);break;case 26:s(68,e+0,e+.25),s(64,e+0,e+.25),s(40,e+0,e+.5),s(64,e+.25,e+.5),s(62,e+.5,e+.75),s(47,e+.5,e+.75),s(62,e+.75,e+1.25),s(52,e+.75,e+1.5);break;case 27:s(60,e+.25,e+.75),s(52,e+.5,e+.75),s(57,e+.75,e+1),s(47,e+.75,e+1);break;case 28:s(60,e+0,e+.5),s(45,e+0,e+.5),s(72,e+.5,e+1),s(64,e+.5,e+1),s(57,e+.5,e+.75),s(48,e+.75,e+1);break;case 29:s(60,e+0,e+.25),s(57,e+0,e+.75),s(53,e+0,e+.75),s(65,e+.25,e+.5),s(67,e+.5,e+.75),s(72,e+.75,e+1),s(43,e+.75,e+1);break;case 30:s(72,e+0,e+.25),s(64,e+0,e+.25),s(60,e+0,e+.25),s(48,e+0,e+.5),s(36,e+0,e+.5),s(72,e+.25,e+.5),s(64,e+.25,e+.5),s(60,e+.25,e+.5),s(72,e+.5,e+.75),s(64,e+.5,e+.75),s(60,e+.5,e+.75),s(55,e+.5,e+.75),s(72,e+.75,e+1.25),s(64,e+.75,e+1.25),s(60,e+.75,e+1.25),s(50,e+.75,e+1.5);break;case 31:s(71,e+.25,e+1),s(62,e+.25,e+1),s(59,e+.25,e+1),s(57,e+.5,e+.75),s(50,e+.75,e+1);break;case 32:s(72,e+0,e+.25),s(64,e+0,e+.25),s(60,e+0,e+.25),s(57,e+0,e+.5),s(52,e+0,e+.5),s(45,e+0,e+.5),s(72,e+.25,e+.5),s(72,e+.5,e+.75),s(59,e+.5,e+1),s(72,e+.75,e+1.25);break;case 33:s(57,e+0,e+.5),s(53,e+0,e+.5),s(48,e+0,e+.5),s(71,e+.25,e+.5),s(69,e+.5,e+.75),s(48,e+.5,e+1),s(67,e+.75,e+1),s(64,e+.75,e+1),s(60,e+.75,e+1);break;case 34:s(67,e+0,e+.25),s(64,e+0,e+.25),s(60,e+0,e+.25),s(36,e+0,e+.5),s(69,e+.25,e+.5),s(71,e+.5,e+.75),s(43,e+.5,e+.75),s(72,e+.75,e+1.25),s(68,e+.75,e+1.25),s(64,e+.75,e+1.25),s(48,e+.75,e+1);break;case 35:s(40,e+0,e+.5),s(71,e+.25,e+1),s(56,e+.5,e+.75),s(52,e+.75,e+1);break;case 36:s(60,e+0,e+.5),s(45,e+0,e+.25),s(52,e+.25,e+.5),s(72,e+.5,e+1),s(64,e+.5,e+1),s(60,e+.5,e+1),s(57,e+.5,e+1);break;case 37:s(60,e+0,e+.25),s(57,e+0,e+.5),s(53,e+0,e+.5),s(65,e+.25,e+.5),s(67,e+.5,e+.75),s(48,e+.5,e+.75),s(72,e+.75,e+1),s(60,e+.75,e+1),s(43,e+.75,e+1);break;case 38:s(72,e+0,e+.25),s(67,e+0,e+.25),s(60,e+0,e+.25),s(48,e+0,e+.5),s(72,e+.25,e+.5),s(60,e+.25,e+.5),s(72,e+.5,e+.75),s(60,e+.5,e+.75),s(55,e+.5,e+.75),s(72,e+.75,e+1.25),s(67,e+.75,e+1.25),s(62,e+.75,e+1.25),s(50,e+.75,e+1);break;case 39:s(43,e+0,e+.25),s(71,e+.25,e+.75),s(67,e+.25,e+.75),s(62,e+.25,e+.75),s(50,e+.25,e+.5),s(57,e+.5,e+1),s(59,e+.75,e+1);break;case 40:s(72,e+0,e+.5),s(64,e+0,e+.5),s(60,e+0,e+.5),s(52,e+0,e+.5),s(45,e+0,e+.5),s(72,e+.5,e+.75),s(64,e+.5,e+.75),s(60,e+.5,e+.75),s(57,e+.5,e+.75),s(72,e+.75,e+1.25),s(67,e+.75,e+1.25),s(60,e+.75,e+1.25),s(48,e+.75,e+1);break;case 41:s(57,e+0,e+.5),s(53,e+0,e+.5),s(48,e+0,e+.5),s(71,e+.25,e+.5),s(69,e+.5,e+.75),s(60,e+.5,e+.75),s(57,e+.5,e+.75),s(67,e+.75,e+1),s(53,e+.75,e+1);break;case 42:s(67,e+0,e+.25),s(48,e+0,e+.25),s(36,e+0,e+.25),s(69,e+.25,e+.5),s(43,e+.25,e+.5),s(71,e+.5,e+.75),s(48,e+.5,e+.75),s(72,e+.75,e+1.25),s(68,e+.75,e+1.25),s(64,e+.75,e+1.25),s(60,e+.75,e+1.25),s(44,e+.75,e+1);break;case 43:s(52,e+0,e+.25),s(71,e+.25,e+1),s(68,e+.25,e+1),s(64,e+.25,e+1),s(47,e+.25,e+.5),s(56,e+.5,e+.75),s(52,e+.75,e+1);break;case 44:s(72,e+0,e+.5),s(64,e+0,e+.5),s(60,e+0,e+.5),s(57,e+0,e+.25),s(45,e+0,e+.25),s(52,e+.25,e+.5),s(72,e+.5,e+.75),s(60,e+.5,e+.75),s(57,e+.5,e+.75),s(72,e+.75,e+1.25),s(67,e+.75,e+1.25),s(60,e+.75,e+1.25),s(48,e+.75,e+1);break;case 45:s(57,e+0,e+.25),s(53,e+0,e+.25),s(71,e+.25,e+.5),s(55,e+.25,e+.5),s(69,e+.5,e+.75),s(48,e+.5,e+1),s(67,e+.75,e+1),s(64,e+.75,e+1),s(60,e+.75,e+1);break;case 46:s(67,e+0,e+.25),s(64,e+0,e+.25),s(60,e+0,e+.25),s(48,e+0,e+.25),s(36,e+0,e+.25),s(69,e+.25,e+.5),s(43,e+.25,e+.5),s(71,e+.5,e+.75),s(48,e+.5,e+1),s(72,e+.75,e+1.25),s(68,e+.75,e+1.25),s(60,e+.75,e+1.25);break;case 47:s(52,e+0,e+.5),s(40,e+0,e+.5),s(71,e+.25,e+1),s(68,e+.25,e+1),s(62,e+.25,e+1),s(47,e+.5,e+.75),s(52,e+.75,e+1);break;case 48:s(71,e+0,e+2),s(68,e+0,e+2),s(62,e+0,e+2),s(52,e+0,e+.25),s(54,e+.25,e+.75),s(56,e+.75,e+1.25);break;case 49:s(54,e+.25,e+.5),s(56,e+.5,e+1);break;case 50:s(64,e+0,e+1.75);break;case 51:s(52,e+.75,e+1)}}let o=-1;function l(){let n=t.currentTime-a+4,s=(o+1)*e;if(!(s>n))for(n+=4;s<n;)r(++o),s+=e}function i(){a=t.currentTime+.05,l(),setInterval(l,999)}let c=!1;const f=464,u=125,d=["7c3f58","eb6b6f","f9a875","fff6d3"],h=["8b956d","c4cfa1","4d533c","1f1f1f"],b=["4c625a","7b9278","abc396","dbf4b4"],p=["2b2b26","706b66","a89f94","e0dbcd"],m=["203c56","544e68","8d697a","ffd4a3"],k=["","ffae00","ffd800","fff000"],g=["ffdc26","fdec4a","fff699","fffee6"],v=["8d684a","d1a575","ffec94","e0dbcd"],w=["","2ea2eb","2a81cb","e0dbcd"],y=["","fa6a39","e94525","fff6d3"],R=[38230,32765,32765,30685,16380,0,3440,0,32770,43018,43530],S=[4080,15016,59754,42682,42682,42682,44009,10916,1360],I=[16733695,16105055,14663415,14663415,12959315,7361805,8257725,1833956,4586321,7361805,8061165,14416871,12974931,15750415,16711935],C=[224,748,1902,1964,11,3847],x=[80,500,500,1785,2045,2045,2045,2045,1785,500,500,80],A=[66934271,66934271,67108863,66060351,63954895,63954895,63954895,63954895,63954895,63954895,63954895,63954895,0],M=[1,[0,18,8,27],[5,7,3,11],[14,7,3,11],2,[8,18,24,27],[8,7,2,11],[17,7,2,11],[6,2,1,1],[7,3,1,1],[15,1,1,1],[17,2,1,1],[16,3,1,1],0,[10,22,3,5],[16,22,2,3],[20,22,2,3],[5,5,5,2],[14,5,5,2],2],T=[1,[0,0,20,11],0,[9,0,2,4],[0,6,20,1],[0,11,20,2],2,[2,5,2,2],[16,5,2,2],[9,4,2,4],[8,5,4,2],3,[0,0,1,1],[19,0,1,1]];function B(e,t,n){return e*(1-n)+t*n}function F(e){return document.getElementById(e)}function q(e,t){t?function(e){F(e).removeAttribute("disabled")}(e):function(e){F(e).setAttribute("disabled","disabled")}(e)}function D(e,t){F(e).textContent=""+t}function P(e,t){F(e).addEventListener("click",e=>{e.preventDefault(),t()})}function E(e){F(e).className="obj spawn"}function O(e,t){F(e).className="obj despawn",setTimeout(()=>{F(e).style.display="none",t&&t()},500)}function W(e){F("fullscreen").style.display="block",E(e)}function G(e,t){O(e,()=>{F("fullscreen").style.display="none",t&&t()})}const L=[[0,0,0,0,0,0,0,0],[14,17,27,17,21,17,14,0],[14,31,21,31,17,31,14,0],[0,10,31,31,31,14,4,0],[0,0,10,14,14,4,0,0],[4,14,14,4,31,31,4,0],[0,4,14,31,31,4,14,0],[0,0,0,12,12,0,0,0],[63,63,63,51,51,63,63,63],[0,0,30,18,18,30,0,0],[63,63,33,45,45,33,63,63],[0,7,3,13,18,18,12,0],[14,17,17,14,4,14,4,0],[4,6,5,4,12,28,24,0],[3,13,11,13,11,27,24,0],[0,21,14,27,14,21,0,0],[8,12,14,15,14,12,8,0],[2,6,14,30,14,6,2,0],[4,14,31,4,31,14,4,0],[10,10,10,10,10,0,10,0],[15,21,21,13,5,5,5,0],[14,17,12,10,6,17,14,0],[0,0,0,0,0,30,30,0],[4,14,31,4,31,14,4,14],[4,14,31,4,4,4,4,0],[4,4,4,4,31,14,4,0],[0,4,6,31,6,4,0,0],[0,4,12,31,12,4,0,0],[0,0,0,16,16,16,31,0],[0,10,10,31,10,10,0,0],[4,4,14,14,31,31,0,0],[31,31,14,14,4,4,0,0],[0,0,0,0,0,0,0,0],[4,14,14,4,4,0,4,0],[27,27,18,0,0,0,0,0],[0,10,31,10,10,31,10,0],[8,14,16,12,2,28,4,0],[25,25,2,4,8,19,19,0],[2,36,20,21,4,0,0,0],[12,12,8,0,0,0,0,0],[4,8,8,8,8,8,4,0],[8,4,4,4,4,4,8,0],[0,10,14,31,14,10,0,0],[0,4,4,31,4,4,0,0],[0,0,0,0,0,12,12,8],[0,0,0,31,0,0,0,0],[0,0,0,0,0,12,12,0],[0,1,2,4,8,16,0,0],[14,17,19,21,25,17,14,0],[4,12,4,4,4,4,14,0],[14,17,1,6,8,16,31,0],[14,17,1,14,1,17,14,0],[2,6,10,18,31,2,2,0],[31,16,16,30,1,17,14,0],[6,8,16,30,17,17,14,0],[31,1,2,4,8,8,8,0],[14,17,17,14,17,17,14,0],[14,17,17,15,1,2,12,0],[0,0,12,12,0,12,12,0],[0,0,12,12,0,12,12,8],[2,4,8,16,8,4,2,0],[0,0,31,0,0,31,0,0],[8,4,2,1,2,4,8,0],[14,17,1,6,4,0,4,0],[14,17,23,21,23,16,14,0],[14,17,17,17,31,17,17,0],[30,17,17,30,17,17,30,0],[14,17,16,16,16,17,14,0],[30,17,17,17,17,17,30,0],[31,16,16,30,16,16,31,0],[31,16,16,30,16,16,16,0],[14,17,16,23,17,17,15,0],[17,17,17,31,17,17,17,0],[14,4,4,4,4,4,14,0],[1,1,1,1,17,17,14,0],[17,18,20,24,20,18,17,0],[16,16,16,16,16,16,31,0],[17,27,21,17,17,17,17,0],[17,25,21,19,17,17,17,0],[14,17,17,17,17,17,14,0],[30,17,17,30,16,16,16,0],[14,17,17,17,21,18,13,0],[30,17,17,30,18,17,17,0],[14,17,16,14,1,17,14,0],[31,4,4,4,4,4,4,0],[17,17,17,17,17,17,14,0],[17,17,17,17,17,10,4,0],[17,17,21,21,21,21,10,0],[17,17,10,4,10,17,17,0],[17,17,17,10,4,4,4,0],[30,2,4,8,16,16,30,0],[14,8,8,8,8,8,14,0],[0,16,8,4,2,1,0,0],[14,2,2,2,2,2,14,0],[4,10,17,0,0,0,0,0],[0,0,0,0,0,0,0,63],[12,12,4,0,0,0,0,0],[0,0,14,1,15,17,15,0],[16,16,30,17,17,17,30,0],[0,0,14,17,16,17,14,0],[1,1,15,17,17,17,15,0],[0,0,14,17,30,16,14,0],[6,8,8,30,8,8,8,0],[0,0,15,17,17,15,1,14],[16,16,28,18,18,18,18,0],[4,0,4,4,4,4,6,0],[2,0,6,2,2,2,18,12],[16,16,18,20,24,20,18,0],[4,4,4,4,4,4,6,0],[0,0,26,21,21,17,17,0],[0,0,28,18,18,18,18,0],[0,0,14,17,17,17,14,0],[0,0,30,17,17,17,30,16],[0,0,15,17,17,17,15,1],[0,0,22,9,8,8,28,0],[0,0,14,16,14,1,14,0],[0,8,30,8,8,10,4,0],[0,0,18,18,18,22,10,0],[0,0,17,17,17,10,4,0],[0,0,17,17,21,31,10,0],[0,0,18,18,12,18,18,0],[0,0,18,18,18,14,4,24],[0,0,30,2,12,16,30,0],[6,8,8,24,8,8,6,0],[4,4,4,4,4,4,4,4],[12,2,2,3,2,2,12,0],[10,20,0,0,0,0,0,0],[4,14,27,17,17,31,0,0],[14,17,16,16,17,14,4,12],[18,0,18,18,18,22,10,0],[3,0,14,17,30,16,14,0],[14,0,14,1,15,17,15,0],[10,0,14,1,15,17,15,0],[12,0,14,1,15,17,15,0],[14,10,14,1,15,17,15,0],[0,14,17,16,17,14,4,12],[14,0,14,17,30,16,14,0],[10,0,14,17,30,16,14,0],[12,0,14,17,30,16,14,0],[10,0,4,4,4,4,6,0],[4,10,0,4,4,4,6,0],[8,0,4,4,4,4,6,0],[10,0,4,10,17,31,17,0],[14,10,14,27,17,31,17,0],[3,0,31,16,30,16,31,0],[0,0,30,5,31,20,15,0],[15,20,20,31,20,20,23,0],[14,0,12,18,18,18,12,0],[10,0,12,18,18,18,12,0],[24,0,12,18,18,18,12,0],[14,0,18,18,18,22,10,0],[24,0,18,18,18,22,10,0],[10,0,18,18,18,14,4,24],[18,12,18,18,18,18,12,0],[10,0,18,18,18,18,12,0],[0,4,14,16,16,14,4,0],[6,9,8,30,8,9,23,0],[17,10,4,31,4,31,4,0],[24,20,20,26,23,18,18,0],[2,5,4,14,4,4,20,8],[6,0,14,1,15,17,15,0],[6,0,4,4,4,4,6,0],[6,0,12,18,18,18,12,0],[6,0,18,18,18,22,10,0],[10,20,0,28,18,18,18,0],[10,20,0,18,26,22,18,0],[14,1,15,17,15,0,15,0],[12,18,18,18,12,0,30,0],[4,0,4,12,16,17,14,0],[0,0,31,16,16,16,0,0],[0,0,63,1,1,0,0,0],[16,18,20,14,17,2,7,0],[16,18,20,11,21,7,1,0],[4,0,4,4,14,14,4,0],[0,0,9,18,9,0,0,0],[0,0,18,9,18,0,0,0],[21,0,42,0,21,0,42,0],[21,42,21,42,21,42,21,42],[42,63,21,63,42,63,21,63],[4,4,4,4,4,4,4,4],[4,4,4,60,4,4,4,4],[0,0,18,18,18,28,16,16],[20,20,20,52,20,20,20,20],[0,0,0,60,20,20,20,20],[0,60,4,60,4,4,4,4],[20,52,4,52,20,20,20,20],[20,20,20,20,20,20,20,20],[0,60,4,52,20,20,20,20],[20,52,4,60,0,0,0,0],[20,20,20,60,0,0,0,0],[4,60,4,60,0,0,0,0],[0,0,0,60,4,4,4,4],[4,4,4,7,0,0,0,0],[4,4,4,63,0,0,0,0],[0,0,0,63,4,4,4,4],[4,4,4,7,4,4,4,4],[0,0,0,63,0,0,0,0],[4,4,4,63,4,4,4,4],[4,7,4,7,4,4,4,4],[20,20,20,23,20,20,20,20],[20,23,16,31,0,0,0,0],[0,31,16,23,20,20,20,20],[20,55,0,63,0,0,0,0],[0,63,0,55,20,20,20,20],[20,23,16,23,20,20,20,20],[0,63,0,63,0,0,0,0],[20,55,0,55,20,20,20,20],[4,63,0,63,0,0,0,0],[20,20,20,63,0,0,0,0],[0,63,0,63,4,4,4,4],[0,0,0,63,20,20,20,20],[20,20,20,31,0,0,0,0],[0,0,0,0,0,0,0,63],[0,0,0,0,0,0,63,63],[0,0,0,0,0,63,63,63],[0,0,0,0,63,63,63,63],[0,0,0,63,63,63,63,63],[0,0,63,63,63,63,63,63],[0,63,63,63,63,63,63,63],[63,63,63,63,63,63,63,63],[32,32,32,32,32,32,32,32],[48,48,48,48,48,48,48,48],[56,56,56,56,56,56,56,56],[60,60,60,60,60,60,60,60],[62,62,62,62,62,62,62,62],[0,28,18,28,18,18,28,16],[30,18,16,16,16,16,16,0],[0,31,10,10,10,10,10,0],[10,0,14,1,15,17,15,0],[0,0,15,18,18,12,0,0],[0,0,18,18,18,28,16,16],[0,0,10,20,4,4,4,0],[14,4,14,17,14,4,14,0],[12,18,18,30,18,18,12,0],[0,14,17,17,10,10,27,0],[12,16,8,4,14,18,12,0],[0,0,10,21,21,10,0,0],[0,4,14,21,21,14,4,0],[0,14,16,30,16,14,0,0],[0,12,18,18,18,18,0,0],[0,30,0,30,0,30,0,0],[0,4,14,4,0,14,0,0],[16,12,2,12,16,0,30,0],[0,0,63,56,38,33,32,63],[0,0,63,7,25,33,1,63],[4,4,4,4,4,20,8,0],[10,0,14,17,17,17,14,0],[62,62,62,62,62,62,62,62],[60,60,60,60,60,60,60,60],[56,56,56,56,56,56,56,56],[48,48,48,48,48,48,48,48],[32,32,32,32,32,32,32,32],[10,0,18,18,18,22,10,0],[24,4,8,28,0,0,0,0],[0,0,0,30,50,51,62,15],[18,63,18,18,63,18,0,0]];function V(e,t,n,a){for(let s=0;s<8;++s){const r=L[e][s];for(let e=0;e<6;++e)r>>5-e&1&&t.fillRect(3*e+n,3*s+a,3,3)}}function j(e,t,n,a){for(let s=0;s<e.length;++s)V(e.charCodeAt(s),t,18*s+n,a)}function N(e){const t=F(e);return t.width=f,t.height=u,t.getContext("2d")}function _(e,t,n){const a=document.createElement("canvas");return a.width=e,a.height=t,n(a.getContext("2d")),a}let Q=1,z=10,H=.59,J=!1,K=!1;const U={};class X{constructor(){this.pos=0,this.prevPos=0,this.gold=0,this.purpose=0,this.turnBack=!1,this.height=70,this.drunkSpeed=.1-.05*Math.random()}_render(e,t){for(let n=0;n<R.length;++n)for(let a=0;a<8;++a){const s=R[n]>>2*(7-a)&3;2!=s&&(t.fillStyle="#"+e[s],t.fillRect(3*a,3*n,3,3))}}buf(e){return U[e[0]]||(U[e[0]]=_(24,33,this._render.bind(this,e)))}advance(){this.prevPos=this.pos;const e=z*(this.pos<230||this.pos>690?.9:H);switch(this.purpose){case 1:this.turnBack=!1,this.pos+=e,this.pos>=928&&(this.pos=928,this.gold=Q,this.purpose=2);break;case 2:this.turnBack=!0,this.pos-=e,this.pos<=0&&(this.pos=0,se(this.gold),this.gold=0,this.purpose=0,this.turnBack=!1);break;case 3:Math.random()<.004&&(this.turnBack=!this.turnBack),this.pos+=this.drunkSpeed*(this.turnBack?-e:e),this.pos<250?(this.pos=250,this.turnBack=!1):this.pos>670&&(this.pos=670,this.turnBack=!0)}}haveFun(e){e&&(this.pos=250+(0|420*Math.random()),this.prevPos=this.pos,this.turnBack=Math.random()<.5),this.gold=0,this.purpose=3,this.height=50+(0|35*Math.random())}}const Y=[];let Z=[];const $=[[10,"autorun"],[20,"illuminate"]];let ee=0,te=1,ne=1;function ae(){q("btn-draft",ee>=te),q("btn-covfefe",ee>=10),q("btn-autorun",ee>=20),q("btn-develop",ee>=20),q("btn-fasta",ee>=25),q("btn-illuminate",ee>=25),q("btn-develop2",ee>=25),q("btn-turborun",ee>=30),q("btn-genetic",ee>=30),q("btn-speedrun",ee>=40),q("btn-portal",ee>=60),q("btn-delorean",ee>=90)}function se(e){for(0==ee&&(F("gold-title").style.display="inline",E("draft"),E("covfefe")),ee+=e;$.length&&ee>=$[0][0];)E($[0][1]),$.shift();D("gold-count",ee),ae()}const re=_(24,27,e=>{for(let t=0;t<S.length;++t)for(let n=0;n<8;++n){const a=S[t]>>2*(7-n)&3;a&&(e.fillStyle="#"+k[a],e.fillRect(3*n,3*t,3,3))}}),oe=_(24,30,e=>{for(let t=0;t<I.length;++t)for(let n=0;n<12;++n){const a=I[t]>>2*(11-n)&3;e.fillStyle="#"+b[a],e.fillRect(2*n,2*t,2,2)}}),le=_(24,24,e=>{for(let t=0;t<C.length;++t)for(let n=0;n<12;++n)C[t]>>11-n&1&&(e.fillStyle="#"+m[0],e.fillRect(2*n,2*t,2,2));for(let t=C.length;t>=0;--t)for(let n=0;n<12;++n)C[t]>>n&1&&(e.fillStyle="#"+m[0],e.fillRect(2*n,2*(5-t)+12,2,2))}),ie=_(72,81,e=>{for(let t of M)"number"==typeof t?e.fillStyle="#"+m[t]:e.fillRect(3*t[0],3*t[1],3*t[2],3*t[3]);for(let t=0;t<6;++t)e.fillRect(21,3*(2*t+7),3,3),e.fillRect(48,3*(2*t+7),3,3)}),ce=_(40,26,e=>{for(let t of T)"number"==typeof t?e.fillStyle="#"+v[t]:e.fillRect(2*t[0],2*t[1],2*t[2],2*t[3])}),fe=_(39,39,e=>{for(let t=0;t<A.length;++t)for(let n=0;n<13;++n){const a=A[t]>>2*n&3;a<2&&(e.fillStyle="#"+d[a],e.fillRect(3*n,3*t,3,3))}});function ue(e,t,n,a){for(let s=0;s<x.length;++s)for(let r=0;r<6;++r){const o=x[s]>>2*r&3;0!=o&&(e.fillStyle="#"+a[o],e.fillRect(3*r+t,3*s+n,3,3))}}function de(e){return t=>{t.fillStyle="#"+d[3],t.fillRect(0,0,f,u),t.fillStyle="#"+d[2];for(let e=0;e<23;++e)e%2==0?(t.fillRect(20*e+5,88,20,4),t.fillRect(20*e+4,92,20,4),t.fillRect(20*e+3,96,20,4),t.fillRect(20*e+1,112,20,4),t.fillRect(20*e,116,20,4),t.fillRect(20*e-1,120,20,4)):(t.fillRect(20*e+3,100,20,4),t.fillRect(20*e+2,104,20,4),t.fillRect(20*e+1,108,20,4));e&&t.drawImage(fe,300,40),t.fillStyle="#"+d[1],j("Dwarf Fortress",t,20,20)}}const he=_(f,u,de(!1)),be=_(f,u,de(!0));function pe(e,t){return n=>{n.fillStyle="#"+e[3],n.fillRect(0,0,f,u),n.fillStyle="#"+e[2];for(let e=0;e<6;++e)j("&",n,70*e+48,50+(0|40*Math.random()));n.fillStyle="#"+e[1],j(t,n,20,20)}}const me=_(f,u,pe(h,"Black Forest")),ke=_(f,u,pe(b,"Reasonably Lit Forest")),ge=_(f,u,e=>{pe(b,"       Ale Forest")(e),e.drawImage(oe,20,18),e.drawImage(oe,47,18),e.drawImage(oe,74,16),e.drawImage(oe,101,16)});function ve(e,t){return n=>{n.fillStyle="#"+m[3],n.fillRect(0,0,f,u),n.fillStyle="#"+m[2];for(let e=0;e<3;++e)j("&",n,120*e+48,50+(0|20*Math.random()));t>0&&(n.fillStyle="#"+m[2],n.fillRect(0,90,f,24),n.fillStyle="#"+m[3],j(" -  -  -  -  -  -  -  - ",n,0,90)),t>1&&(n.drawImage(ie,368,0),n.drawImage(le,310,18)),n.fillStyle="#"+m[1],j(e,n,20,20)}}const we=_(f,u,ve("Wasteland",0)),ye=_(f,u,ve("Country Roads",1)),Re=_(f,u,ve("Industrial Area",2)),Se=_(f,u,e=>{e.fillStyle="#"+p[3],e.fillRect(0,0,f,u);for(let t=0;t<6;++t){const n=35*t+24,a=86+(0|16*Math.random());e.fillStyle="#"+p[2],e.fillRect(n,a,6,2),e.fillRect(n-1,a+2,6,2)}e.drawImage(ce,230,75),e.drawImage(ce,286,73),e.drawImage(ce,342,73),e.drawImage(ce,398,73),e.drawImage(ce,404,45),e.drawImage(ce,400,17),e.fillStyle="#"+p[1],j("Fabled Treasure",e,20,20)});function Ie(e){return e<230?(t=e/230)*t*230:e>690?230*function(e){return e*(2-e)}((e-690)/230)+690:e;var t}function Ce(e,t,n,a,s){let r=!1;J&&Y.sort((e,t)=>e.height-t.height);for(let o of Y){if(0==o.pos&&0==o.prevPos)continue;const l=Ie(B(o.prevPos,o.pos,e))-a;if(!(l<-40||l>500)){switch(r=!0,t.save(),t.translate(l+2,0),o.gold){case 1:t.drawImage(re,-12,30);break;case 3:t.drawImage(re,-8,22,16,18);case 2:t.drawImage(re,-20,40,16,18),t.drawImage(re,4,40,16,18)}o.turnBack&&t.scale(-1,1),t.drawImage(o.buf(n),-12,33*(1-s)+o.height,24,33*s),t.restore()}}return r}class xe{render(e){if(this.canvas.drawImage(this.buf,0,0),Ce(e,this.canvas,this.palette,this.pos,1)&&this.spawn&&(E(this.spawn),this.spawn=void 0),this.renderWaiting&&Z.length){const e=Math.min(Z.length+Oe,24),t=Z[0].buf(this.palette);let n,a;for(let s=e-1;s>=Oe;--s)s>=9?s>=17?(n=14+3*(9*(24-s)-4),a=24):(n=0+3*(9*(17-s)-4),a=47):(n=3*(9*(9-s)-4)-13,a=70),this.canvas.drawImage(t,n+2,a)}this.canvas.lineWidth=2,this.canvas.strokeStyle="#"+this.palette[0],this.canvas.beginPath(),this.canvas.rect(1,1,462,123),this.canvas.stroke()}}let Ae=!1;const Me=function(){const e=.02;let t=-1,n=0;function a(s){if(requestAnimationFrame(a),Ae)t=-1;else{for(-1==t&&(t=s),n+=.001*(s-t),t=s;n>0;)n-=e,We(e);!function(e){Te.render(e),Be.render(e),Fe.render(e)}(n/e+1)}}return function(){requestAnimationFrame(a)}}(),Te=new class extends xe{constructor(){super(),this.canvas=N("can-fortress"),this.palette=d,this.buf=he,this.pos=-230,this.renderWaiting=!0}render(e){super.render(e),qe&&(this.canvas.lineWidth=1,this.canvas.strokeStyle="#"+this.palette[0],this.canvas.beginPath(),this.canvas.rect(426.5,4.5,33,7),this.canvas.stroke(),this.canvas.fillStyle="#"+this.palette[1],this.canvas.fillRect(428,6,30*B(Ee,Pe,e)/De,4))}},Be=new class extends xe{constructor(){super(),this.canvas=N("can-forest"),this.palette=h,this.buf=me,this.pos=230,this.spawn="forest"}},Fe=new class extends xe{constructor(){super(),this.canvas=N("can-treasure"),this.palette=p,this.buf=Se,this.pos=690,this.spawn="treasure"}};let qe=!1,De=2.4,Pe=0,Ee=0,Oe=0;function We(e){Z=[],Oe=0;for(let e of Y)e.advance(),0==e.purpose&&Z.push(e),e.pos>0&&e.pos<160?Oe=1:J&&3!=e.purpose&&e.pos>250&&e.pos<670?e.haveFun():K&&e.pos>200&&e.pos<720&&(1==e.purpose?e.prevPos=e.pos=720:2==e.purpose&&(e.prevPos=e.pos=200));q("btn-adventure",Z.length),qe&&(Pe>=De?(Ee=Pe-=De,Z.length&&(Z[0].purpose=1)):(Ee=Pe,Pe+=e))}Y.push(new X),setTimeout(()=>{E("title"),setTimeout(()=>{E("fortress"),setTimeout(()=>{E("adventure")},300)},300)},10),Me(),P("btn-adventure",()=>{if(Z.length&&(Z[0].purpose=1),!c){try{(t=new AudioContext,(n=t.createGain()).gain.value=.4,function(){const a=t.createConvolver(),s=t.createGain(),r=t.createGain();return s.gain.value=2/3,r.gain.value=1/3,n.connect(a),n.connect(s),a.connect(r),s.connect(t.destination),r.connect(t.destination),new Promise(function(n){!function(e,t){const n=e.audioContext||new AudioContext,a=e.sampleRate||n.sampleRate,s=e.channels||2,r=1.5*e.decay,o=Math.ceil(a*r),l=Math.ceil(a*e.fadeIn),i=Math.ceil(a*e.decay),c=Math.pow(.001,1/i),f=n.createBuffer(s,o,a);for(let e=0;e<s;++e){const t=f.getChannelData(e);for(let e=0;e<o;++e)t[e]=(Math.floor(9007199254740992*Math.random())/9007199254740991*2-1)*Math.pow(c,e);for(let e=0;e<l;++e)t[e]*=e/l}!function(e,t,n,a,s){if(!t)return void s(e);t=Math.min(t,.5*e.sampleRate),n=Math.min(n,.5*e.sampleRate);const r=function(e){const t=[];for(let n=0;n<e.numberOfChannels;++n)t[n]=e.getChannelData(n);return t}(e),o=new OfflineAudioContext(e.numberOfChannels,r[0].length,e.sampleRate),l=o.createBufferSource(),i=o.createBiquadFilter();i.type="lowpass",i.Q.value=1e-4,i.frequency.setValueAtTime(t,0),i.frequency.linearRampToValueAtTime(n,a),i.connect(o.destination),l.buffer=e,l.connect(i),l.start(),o.oncomplete=function(e){s(e.renderedBuffer)},o.startRendering()}(f,e.lpFreqStart,e.lpFreqEnd,e.decay,t)}({audioContext:t,fadeIn:1e-5,decay:1.5*e,lpFreqStart:16e3,lpFreqEnd:1e3},function(e){a.buffer=e,n()})})}()).then(i)}catch(e){}c=!0}}),P("btn-draft",()=>{se(-te),function(){let e=te;te+=ne,ne=e,D("dwarf-cost",te),ae()}(),Y.push(new X),D("dwarf-count",Y.length),F("dwarf-plural").style.display=1==Y.length?"none":"inline"}),P("btn-covfefe",()=>{se(-10),z*=1.2,O("covfefe"),E("fasta")}),P("btn-fasta",()=>{se(-25),z*=1.1,O("fasta")}),P("btn-autorun",()=>{se(-20),qe=!0,O("autorun"),E("turborun")}),P("btn-turborun",()=>{se(-30),De*=.5,O("turborun"),E("speedrun")}),P("btn-speedrun",()=>{se(-40),De*=.5,O("speedrun")}),P("btn-illuminate",()=>{se(-25),Be.palette=b,Be.buf=ke,H*=1.3,O("illuminate"),setTimeout(()=>{Ae=!0,Be.buf=ge,J=!0,Y.forEach(e=>e.haveFun(!0)),W("kegs")},1e4)}),P("btn-continue",()=>{G("kegs",()=>{Ae=!1,E("orbital")})}),P("btn-orbital",()=>{Ae=!0,W("nuke")}),P("btn-continue2",()=>{G("nuke",()=>{O("orbital"),function(){let e=-1,t=Date.now();requestAnimationFrame(function n(){const a=Date.now();a-t>=2e3?(function(){J=!1;const e=Y.filter(e=>e.pos<230||e.pos>690).length;Y.splice(0,Y.length);for(let t=0;t<Math.max(e,3);++t)Y.push(new X);te=3,ne=2,D("dwarf-count",Y.length),D("dwarf-cost",te)}(),Be.palette=m,Be.buf=we,Ae=!1,$.push([10,"develop"]),se(0)):(requestAnimationFrame(n),e=(e+1)%4,Be.canvas.fillStyle="#"+g[e],Be.canvas.fillRect(0,0,f,u),Ce(1,Be.canvas,p,Be.pos,(2e3+t-a)/2e3))})}()})}),P("btn-develop",()=>{se(-20),Be.buf=ye,H*=1.3,O("develop"),E("develop2")}),P("btn-develop2",()=>{se(-25),Be.buf=Re,Q=2,O("develop2"),E("genetic"),$.push([30,"portal"]),$.push([60,"delorean"]),se(0)}),P("btn-genetic",()=>{se(-30),Q=3,O("genetic")}),P("btn-portal",()=>{se(-60),ue(he.getContext("2d"),414,67,w),ue(be.getContext("2d"),414,67,w),ue(Se.getContext("2d"),32,67,y),K=!0,O("portal")}),P("btn-delorean",()=>{se(-90),Te.buf=be,O("delorean"),E("back")}),P("btn-back",()=>{O("back"),setTimeout(()=>{O("treasure"),setTimeout(()=>{O("forest"),setTimeout(()=>{O("fortress"),setTimeout(()=>{O("title"),setTimeout(()=>{location.reload()},300)},300)},300)},300)},10)});for(let e of["btn-adventure","btn-draft","btn-covfefe","btn-fasta","btn-autorun","btn-turborun","btn-speedrun","btn-illuminate","btn-continue","btn-orbital","btn-continue2","btn-develop","btn-develop2","btn-genetic","btn-portal","btn-delorean","btn-back"])F(e).oncontextmenu=function(e){e.preventDefault()};(()=>{let e=0,t=0;document.addEventListener("touchstart",()=>{e=t,t=Date.now()}),document.addEventListener("touchend",t=>{Date.now()-e<400&&t.preventDefault();const n=t.target;n&&n.click&&n.click()})})()</script></body></html>