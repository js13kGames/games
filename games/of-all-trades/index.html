<!doctype html><meta name=viewport content="width=device-width"><title>Of All Trades</title><script type=module crossorigin>!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const Q=["#242424","#005555","#008888","#55bbbb","#cccccc","#cc9999","#bb5555","#aa0000","#770077","#aa00aa","#cc22cc","#cc88aa","#cccc88","#55cc55","#00aa00","#008800"];function Ie(){const e=[];for(let a=0;a<Q.length;a++){const n=t(Q[a]);e.push(n)}return e;function t(e){e=e.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,(function(e,t,a,n){return t+t+a+a+n+n}));var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}}function Ce(e,t){return Math.sqrt(Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)+Math.pow(e[2]-t[2],2))}function Me(e,t){return new Promise((a=>{var n,o=Number.POSITIVE_INFINITY;let i=0;e.forEach(((e,a)=>{(n=Ce(t,e))<o&&(o=n,i=a)})),a(Q[i])}))}async function Te(e,t){const a=Ie(),n=document.querySelector("#start"),o=document.querySelector("#final"),i=n.getContext("2d",{willReadFrequently:!0}),r=o.getContext("2d"),s=[],l=t?100:36,d=t?100:44;if(n.width=l,n.height=d,o.width=l,o.height=d,t)i.font="800px Arial",i.fillText(e[0],-150,20);else{i.fillStyle="#000",i.fillRect(0,0,l,d),i.font="30px Arial";for(let t=0;t<e.length;t++)i.fillText(e[t],2,40)}let u=0,c=0;for(;u<=l&&c<d;){const e=i.getImageData(u,c,1,1).data;s[c]||(s[c]=[]),s[c].push([e[0],e[1],e[2]]),u++,u>l&&(u=0,c++)}for(let e=0;e<s.length;e++)for(let t=0;t<s[e].length;t++){const n=await Me(a,s[e][t]);r.fillStyle="0, 0, 0"===s[e][t].join(", ")?"#00000000":n,r.fillRect(t,e,1,1)}return o.toDataURL("image/png")}const X=["affectionate","afraid","aggressive","altruistic","amiable","angry","animated","annoyed","anxious","appreciative","argumentative","arrogant","attentive","awkward","bashful","bewildered","bold","bored","bossy","brave","brilliant","calm","capable","carefree","careful","caring","cautious","charismatic","charming","cheerful","childish","clever","clumsy","coarse","cold-hearted","compassionate","concerned","confident","confused","conscientious","considerate","cooperative","courageous","cowardly","creative","curious","dainty","daring","decisive","demanding","dependable","determined","devoted","dignified","diligent","discouraged","dishonest","domineering","doubtful","dreamer","eager","easygoing","efficient","encouraging","energetic","enthusiastic","exuberant","fair","fanciful","fearless","finicky","flexible","focused","forgiving","frank","friendly","frugal","frustrated","fun-loving","funny","generous","gentle","giving","gloomy","grateful","greedy","gregarious","gullible","happy","hard-working","hardy","harried","helpful","hesitant","honest","hospitable","humble","impatient","impulsive","independent","industrious","innocent","innovative","inquisitive","insistent","intelligent","intrepid","inventive","jovial","kind","lazy","light-hearted","logical","lonely","lovable","loving","malicious","meek","messy","meticulous","mischievous","moody","mysterious","naive","negligent","nervous","obliging","observant","obstinate","optimistic","organized","patient","pensive","persevering","persuasive","pessimistic","picky","pleasant","pompous","popular","positive","precise","puzzled","quarrelsome","quiet","quixotic","resourceful","sarcastic","scheming","scornful","secretive","self-reliant","sense of humor","sensitive","serious","shrewd","simple","sincere","skillful","slovenly","smart","sneaky","sociable","strange","strict","stubborn","sullen","superstitious","supportive","surly","suspicious","sweet","taciturn","talented","talkative","tenacious","tense","thankful","thorough","thoughtful","thrifty","timid","tireless","tolerant","touchy","trusting","trustworthy","truthful","unscrupulous","unselfish","upset","valiant","versatile","visionary","warm","warm-hearted","whimsical","wise","witty","unkempt","deliberative","reckless","disciplined","inefficient","envisions the unseen","fatigued","unfocused","addled","poor health","imaginative","unimaginative","innovative","knowledgeable","ignorant","observant","erratic","responsible","irresponsible","risk-taker","averse to risk","stressed","disorganized","disorderly","trustworthy","untrustworthy","careless","clumsy","lack of verbal skills","Gruff","Insecure","Conceited","Speaks in rhymes","Competitive"],Se=["Accidents","Wild animals","Bathing","Bats","Bogeyman","Crossing bridges","Bulls","Beggars","Burglars","Being buried alive","Cemeteries","Childbirth","Choking","Clouds","Confined spaces","Corpses","Crowded public places","Mobs","Crystals","death","Decaying matter","Defeat","Demons","Disease","Dogs","Dreams","Dying","Fever","Fire","Flogging","Floods","Forests","Fur (skin of animals)","Ghosts","Heat","Heights","Hell","Heredity","Holy things","Horses","Ice","Insanity","Insects","Injury","Jumping from high places","Knowledge","Lice","Lightening and thunder","Loud noises","Meteors","Mice","Mirrors","Moths","Moon","Myths","Night","Open spaces","Operations","Pain","Parasites","Pointed objects","Poison","Poverty","Priests","Puppets","Rabies","Rats","Religion","Returning home","Responsibility","Ridicule","Riding in a wagon or cart","Rivers","Road travel","Robbers","Shadows","Skin lesions","Sleep","Steep slopes","Smothering","Snakes","Snow","Spiders","Spirits","Stars","Stings","Strangers","Tapeworms","Time","Toads","Tyrants","Virgins","Washing","Wind","Witches and witchcraft","Work","Worms"],ae=["Ursula","Vera","Abigail","Antonia","Amelia","Ada","Adelaide","Adela","Adeline","Adriana","Agatha","Ailith","Alana","Alberta","Albina","Alexandra","Alexis","Allegra","Angelica","Altabella","Ama","Antonia","Annora","Ava","Beatrice","Cecilia","Eira","Ella","Eleanor","Elisaria","Euphemia","Genevieve","Gunnora","Heloise","Honora","Helen","Joan","Matilda","Mirabel","Nezetta","Nadalinde","Olive","Osanna","Petra","Philomena","Phoebe","Portia","Regina","Sabina","Serena","Sibyl","Sophia","Stella","Thora","Ursula","Vera","Winifred","Zelda"],oe=["Abraham","Absalom","Abelard","Acfrid","Achard","Adam","Adelo","Aderich","Ailbern","Adrewic","Adrian","Alaric","Albin","Alexander","Alfwin","Aldebrand","Ambrose","Alamand","Alard","Alaric","Alf","Alwin","Anthony","Archibald","Arthur","Aldo","Alphonse","Abelard","Benedict","Bartholomew","Bertram","Crispin","Daegal","Drustan","Edmund","Elric","Emil","Florian","Gandalf","Godfrey","Gregory","Grimwald","Hamlin","Hawk","Hildebald","Kenric","Leif","Lothar","Morcant","Oliver","Orvyn","Richard","Randolf","Roland","Torsten","Wilkin","Balthasar"],q=["Gervaise","Wainwright","Heathcliff","Albrecht","Hildebrand","Devereaux","Heinrich","Tudor","Templeton","Braxton","Jacobo","Mannix","Benedict","Beckett","Wesley","Maynard","Kimball","Otto","Bassett","Wallace","Oakes","Lister","Tobias","Conrad","Jasper","Bayard","Burne","Hyde","Walden","Gilbert","Fleming","Mann","Rowe","Hammond","Ballard","Kirby","Aiken","Beasley","Frost","Giles","Felix","Harding","Dudley","Barlow","Lange","Pierson","Denton","Courtney","Brandon","Weston","Daley","Elias","Larkin","Godwin","Boswell","Jarrett","Lovell","Roland","Moreland","Lorenzo","Aldrich","Ambrose","Bartley","Thayer","Fenton","Dietrich","Borden","Bartholomew","Garvin","Cecil","Lyman","Brant","Charlton","Seward","Easton","Nilson","Andre","Dayton","Archibald","Ralph","Leo","Aston","Berkeley","Carleton","Kipling","Sherwin","Alton","Bradburn","Osmond","Chilton","Mendel","Birney","Rawlins","Edison","Lyndon","Marden","Atherton","Amaury","Aramis","Brawley","Geoffrey","Haynes","Hill","Hughes","Kimball","Klein","Koch","Kruger","Maddock","Norman","Nuemann","Payne","Schafer","Schneider","Taylor","Turner","Wood","Beckett","Brewer","Browne","Carey","Ead","Aaberg","Adalbert","Albrecht","Alwyn","Annora","Arvel","Ashdown","Audovera","Badden","Bartholomew","Burchard","Cosimo","Enegram","Frithswith","Grimald","Hankin","Hilith","Isolda","Kaiser","Louthy","MacQuoid","Mannering","Merek","Nesta","Olbrecht","Pernelle","Pythias","Rainilda","Rolfe","Sallow","Squire","Terrowin","Theano","Tonis"],$e=["red","white","curly","blonde"],j=[["Peddler","Hunter","Trapper"],["Woodcutter","Shepherd","Farmer"],["Healer","Explorer","Brewer","Ropemaker","Tanner","miner"],["Cartographer","Carpenter","Blacksmith","Sailor","Merchant","Shipwright","Cook","Fisherman"],["Weaver","Banker","Leatherworker","Confectioner","Tailor","Lord"]],re={visualFeature:["Extra finger","Heterochromia","Goiter","Rickets","Missing fingers","Birthmark","Beautiful","Burn mark","Freckles","Short","Tall","Frail","Stout","Dimples","Scars","Unkempt","Callouses"]},Z={traitMain:X,trait:X,traitLesser:X,fear:Se};let M={};async function U(){M={};const e=Math.random(),t=g(1,10)+g(1,10)+g(1,10)+g(1,10),a=await me($e);return M.name=await Be(e),M.age=t,M.hair=a,Le(),Ye(),M.imageId=xe(t,e,a),M}function xe(e,t,a){return e<=5?9:e<=11?10:e>60&&t<.3?16:e>60&&t>.7?21:e>60?11:n(t<.3?17:t>.7?22:12,a);function n(e,t){return"curly"===t?e:"red"===t?e+1:"white"===t?e+2:"blonde"===t?e+3:void 0}}function he(e,t,a){let n="";for(const o in e)n+="name"===o?`<details closed><summary>${e[o]} - ${t}</summary>`:"imageId"===o?`<div><img src="${a[e.imageId]}"></div>`:`<div>${Pe(o)}: <span class="bold">${e[o]}</span></div>`;n+="</details>";const o=document.createElement("span");return o.innerHTML=n,o}function Be(e){return new Promise((t=>{const a=q[Math.floor(Math.random()*q.length)];t(e<=.5?`${ae[Math.floor(Math.random()*ae.length)]} ${a}`:`${oe[Math.floor(Math.random()*oe.length)]} ${a}`)}))}function Ye(){for(const e in Z)M[e]=Z[e][Math.floor(Math.random()*Z[e].length)];return M}async function Le(){for(const e in re)M[e]=await me(re[e]);return M}function me(e){return new Promise((t=>{const a=[...e,...e.reverse()],n=Math.ceil(a.length/2),o=g(0,n)+g(0,n);t(a[o]?a[o]:a[a.length-1])}))}function g(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1)+e)}function Pe(e){const t=e.replace(/([a-z])([A-Z])/g,"$1 $2").split(" ");let a="";return t.forEach((e=>{a=a+e.charAt(0).toUpperCase()+e.slice(1)+" "})),a}const He=e=>{const t={},a=e.getContext("2d"),n=document.querySelector("#perlin-svg");function o(e){return g(1,200)+e}function i(e,t){return new Promise((n=>{n(a.getImageData(e,t,1,1).data)}))}return t.generate=async()=>{let e=0;for(;e<100;){let t=document.createElementNS("http://www.w3.org/2000/svg","path");const a=g(-100,1020),i=g(-100,1020);t.setAttribute("d",`M${o(a)} ${o(i)} L${o(a)} ${o(i)} L${o(a)} ${o(i)} L${o(a)} ${o(i)} L${o(a)} ${o(i)} Z`),t.setAttribute("fill","#000"),t.setAttribute("filter","url(#blur)"),t.setAttribute("class","feature"),t.setAttribute("opacity","0.4"),n.appendChild(t),e++}await new Promise((e=>{var t=(new XMLSerializer).serializeToString(n),o=window.btoa(t),i=new Image;i.onload=function(){a.drawImage(i,0,0),e()},i.src="data:image/svg+xml;base64,"+o}));const t=document.querySelectorAll(".feature");for(let e=0;e<t.length;e++)t[e].remove()},t.getQaud=async(e,t)=>{let a=0,n=0,o=[];for(;a<=200&&n<200;){const r=await i(e+a,t+n);o[n]||(o[n]=[]),o[n].push(r[3]),a++,a>200&&(a=0,n++)}return o},t},Ee=["You approach a circle of standing stones. Remnants of druidic rituals can be seen. You leave immediately.","You come across a pile of chopped wood. The wood has sat out for a season. You wonder why a woodcutter would have left this here to rot.","You find a lone fountain. “Why would someone build this here?” you think to yourself. You take a sip of the clear, inviting water. You feel changed.","You pass an ancient oak. Something strikes you about this tree. You feel like if you close your eyes you can almost hear it singing a song.","You find a dusty scroll hidden under a rock outcropping. The language is foreign to you. You keep the scroll for kindling.","You see an orb of pulsating light floating across the ground.  “A will-o'-the-wisp!” you exclaim. You run terrified.","A key sits half buried in the dirt. Someone somewhere is missing this key. You take it for the iron.","You find a candle stuck to a rock. This looks to have been part of some ritual. The area gives you an unsettled feeling. You leave quietly.","You see a rainbow. So beautiful.","You see a flower. Its beauty captures you and you stop to smell it. Its fragrance is sweet and satisfying.","You come upon a large toadstool. For a brief moment you were sure you saw a small human figure sitting upon it. Whatever was there is gone now.","You come across a sea shell. You lift it to your ear and hear the ocean. What witchcraft is this!!!!","You see a skull peeking out of the earth. The skull is ancient. You say a prayer and continue on your way.","A glint catches your eye. Upon further inspection you find that it is a clear rock. You huck it at a tree and continue your travels.","The sound of a bell starts gently ringing. It grows closer. You hide. The sound passes close and then fades off into the distance. You saw nothing.","You come upon an old woman who offers to tell you your future. She says you will never satisfy your insatiable hunger for knowledge unless you can find the ship made of iron.","A giant stone head sits out in the open. Scratched in the back is a map that seems to show a city out in the ocean and creatures half human and half fish.","You come across a lemon tree. “Not today scurvy!” you exclaim."],Ne=["Chicken says “Cluck","Pig says “Oink","Cow says “Mooo","Sheep says “Baaa","Dog barks","Goat gives a funny look and screams","Horse whinnies"],Re=["Deer says “EEuurrruu”","Owl says “Hooo”","Rat says “Squeak”","Bat says “Chirp”","Rabbit runs off and hides in the underbrush","Wild dog yaps and barks"],pe=["Homestead","Farm","Village","Town","City"],b=(e,t,a)=>e.setAttribute(t,a),T=e=>document.querySelector(e),ge=e=>document.querySelectorAll(e),We=()=>Math.random(),ye=e=>e[Math.floor(Math.random()*e.length)],$=T("#story"),V=T("#game"),De=T("#map"),m=[2,2],p=[100,100];let K;const ie=[],se=["🧕","🌲","🌳","🛖","🏚️","⛪","🏛️","🏯","🏰","👶","🧒","🧓","🧑‍🦱","🧑‍🦰","🧑‍🦳","🧑","👵","👩‍🦱","👩‍🦰","👩‍🦳","👱‍♀️","👴","👨‍🦱","👨‍🦰","👨‍🦳","🧔","🐓","🐖","🐂","🐏","🐕","🐐","🐎","🦌","🦉","🐀","🦇","🐇","🐕","🪨","🪵","⛲","🌳","📜","✨","🗝️","🕯️","🌈","🌺","🍄","🐚","💀","💎","🔔","🔮","🗿","🍋","🧜‍♂️","🛸","🏆"],k=[];let w=0;const L=j.flat();let G,le=0,J=0;for(let e=0;e<L.length;e++){const t=document.createElement("li");t.textContent=L[e]+" - not apprenticed",T("ol").appendChild(t)}const x=Ge(),Fe=T("#perlin"),H=He(Fe);let _,we;const Oe={water:"#00445a",plains:"#359135",forest:"#005a00",mountain:"grey",snow:"#f1f1f1"},ce={n:()=>S(-1,-1),e:()=>S(-1,1),w:()=>S(1,-1),s:()=>S(1,1),nw:()=>S(0,-1),sw:()=>S(1,0),se:()=>S(0,1),ne:()=>S(-1,0)};T("#ui").addEventListener("click",(e=>{ce[e.target.dataset.d]&&ce[e.target.dataset.d]()}),!0);const N=()=>{var e,t;return null==(t=null==(e=x[m[1]])?void 0:e[m[0]])?void 0:t.data};function E(e,t){return e&&t?q[5*t+e]:q[5*m[1]+m[0]]}async function S(e,t){var a,n,o,i;const r=N(),s=["forest","plains"];w>16&&s.push("water"),w>8&&s.push("mountain"),w>24&&s.push("snow");const l=[...p];if(l[1]+=t,l[0]+=e,l[1]>=199||l[1]<=0||l[0]>=199||l[0]<=0)return void await async function(){var a,n;if(null==(a=x[m[1]+t])||!a[m[0]+e])return void($.textContent="You've reached the edge of this land. You can travel no further in this direction.");T(`#m${m[1]}-${m[0]}`).removeAttribute("style"),0!==t&&0!==e?l[1]>=198?(m[1]=m[1]+1,p[1]=2):l[0]>=198?(m[0]=m[0]+1,p[0]=2):l[1]<=2?(m[1]=m[1]-1,p[1]=198):(m[0]=m[0]-1,p[0]=198):0!==t?l[1]>=198?(m[1]=m[1]+1,p[1]=2):(m[1]=m[1]-1,p[1]=198):0!==e&&(l[0]>=198?(m[0]=m[0]+1,p[0]=2):(m[0]=m[0]-1,p[0]=198));const o=T(`#m${m[1]}-${m[0]}`);if(b(o,"style","fill: red"),null!=(n=x[m[1]])&&n[m[0]].name){const e=await te(p[0],p[1],s);p[0]=e[0],p[1]=e[1],ee()}else be()}();const d=ve(null==(n=null==(a=r[l[1]])?void 0:a[l[0]])?void 0:n.elevation);if("mountain"===d&&w<8)return void($.textContent="You need to apprentice with a ropemaker to ascend mountains.");if("water"===d&&w<17)return void($.textContent="You need to apprentice with a shipwright to sail across the ocean.");if("snow"===d&&w<24)return void($.textContent="You need to apprentice with a tailor to ascend snowy peaks.");p[0]=l[0],p[1]=l[1];const u=null==(i=null==(o=r[p[1]])?void 0:o[p[0]])?void 0:i.person;if(L[w]&&(null==u?void 0:u.profession)===L[w]){const e=ge("ol > li"),t=he(u.data,u.profession,k);e[w].textContent="",e[w].appendChild(t),Ue(3+w),w++}ee()}async function be(){var e;_=[...null==(e=x[m[1]])?void 0:e[m[0]]],we=await H.getQaud(200*m[0],200*m[1]);const t=await H.getQaud(200*m[0],200*m[1]);x[m[1]][m[0]]={name:E(),locs:[],locIds:[],data:t},await je();const a=["forest","plains"];w>16&&a.push("water"),w>8&&a.push("mountain"),w>24&&a.push("snow");const n=await te(p[0],p[1],a);p[0]=n[0],p[1]=n[1],await Ke(),ee()}async function te(e,t,a){const n=N();let o,i=1,r=0;const s=[[-1,1],[1,-1],[1,1],[-1,-1],[0,1],[-1,0],[0,-1],[1,0]];for(;!o&&i<200;){if(s[r]||(r=0),o=await qe(s,r,i,e,t,n,a),o)return o;i++,r++}return[100,100]}function qe(e,t,a,n,o,i,r){return new Promise((s=>{const l=o+e[t][0]*a,d=n+e[t][1]*a,u=i[l]?i[l][d]:void 0;void 0!==typeof u&&null!=r&&r.includes(null==u?void 0:u.biome)&&l<195&&l>5&&d<195&&d>5?s([d,l]):s(!1)}))}function Ge(){let e=0,t=0;const a=[];for(let n=0;n<5;n++){a.push([]);for(let o=0;o<5;o++){a[n].push([]);const i=Math.random();e<1&&n>1&&i>.4&&(K=[o,n],ie.push(`They tell you there is a city in the ${E(o,n)} fiefdom. `),a[n][o].push(5),e++),t<11&&i>.7&&(ie.push(`They tell you there is a town in the ${E(o,n)} fiefdom. `),a[n][o].push(4),t++),Math.random()>.6&&a[n][o].push(3);for(let e=0;e<10;e++)Math.random()>.6&&a[n][o].push(2),Math.random()>.5&&a[n][o].push(1)}}return 0===e&&(K=[0,0],a[0][0].push(5),e++),a}function ve(e){return e<20?"water":e>=20&&e<88?"plains":e>=88&&e<170?"forest":e>=170&&e<200?"mountain":e>=200?"snow":void 0}async function je(){const e=N();for(let t=0;t<e.length;t++)for(let a=0;a<e[t].length;a++){const n=await ze(e[t][a],t,a);e[t][a]=n}}async function Ke(){var e,t,a;const n=N();for(let o=0;o<_.length;o++){const i=_[o];let r=g(10,189),s=g(10,189);const l=await Y(i,s,r);for(let o=0;o<i;o++){let r=l[0],s=l[1];r+=o*g(-3,3),s+=o*g(-3,3);const d=await Y(i,s,r),u=x[m[1]][m[0]];u.locs.push([d[0],d[1]]),u.locIds.push(i-1),null!=(e=n[d[1]])&&e[d[0]]&&(n[d[1]][d[0]].structure={type:pe[i-1],imageId:o+3});const c=j[i-1];for(let e=0;e<c.length;e++){let o=d[0]+g(-4,4),r=d[1]+g(-4,4);o===d[0]&&(o+=1),r===d[1]&&(r+=1);const s=await Y(i,r,o),l=await U();let u=c[e];if(l.age,l.age<10&&"Lord"!==u&&(u="Child"),l.age<4&&"Lord"!==u&&(u="Infant"),5===i&&J<2&&"Lord"===u?J++:"Lord"===u&&J>=2&&(u="Jester"),null!=(t=n[s[1]])&&t[s[0]]&&(n[s[1]][s[0]].person={data:l,imageId:l.imageId,profession:u}),1===i||2===i&&Math.random()>.3){const e=g(0,6),t=g(-1,1),o=g(-1,1),i=null==(a=n[s[1]+t])?void 0:a[s[0]+o];i&&(i.animal={id:e,imageId:26+e,story:Ne[e]})}}}}for(let e=0;e<80;e++){let e=g(10,189),t=g(10,189);if(Math.random()>.3){const a=await Y(6,t,e),o=g(0,5);n[a[1]][a[0]].animal={id:o,imageId:33+o,story:Re[o]}}else{const a=await Y(7,t,e),o=await U(),i=ye(L);n[a[1]][a[0]].person={data:o,imageId:o.imageId,profession:"Lord"===i?"Jester":i,isWander:!0}}}for(let e=0;e<8;e++){let e=g(10,189),t=g(10,189);const a=await Y(7,t,e),o=g(0,17);n[a[1]][a[0]].special={id:o,imageId:39+o,story:Ee[o]}}let o=g(101,102),i=g(101,102);const r=await Y(1,i,o),s=await U();n[r[1]][r[0]].person={data:s,imageId:s.imageId,profession:"Peddler",isWander:!0}}async function Y(e,t,a){let n=["forest","plains"];return e>3&&n.push("mountain"),6===e&&n.push("water"),7===e&&n.push("snow"),await te(a,t,n)}function ze(e,t,a){return new Promise((n=>{let o;e>=210&&!G&&a>3&&t>3&&a<198&&t<198&&(G=[m,[a,t]],o={id:58,imageId:58,story:"Hello human. I admire your desire to understand all things. I have an offer for you. Travel with me and I will teach you all you could ever desire to know."}),e<=16&&G&&le<1&&a>3&&t>3&&a<198&&t<198&&(le++,o={id:57,imageId:57,story:`Hello human. The kingdom of the merfolk has watched your journey. We know what you seek lies at ${G[1].join("-")} in the ${E()} fiefdom. Good luck.`});const i=ve(e),r=Xe(i,e,we[t][a]);n({elevation:e,color:Oe[i],biome:i,tree:r,person:void 0,structure:void 0,animal:void 0,special:o})}))}function Xe(e,t,a){let n;if(a>18){let a=!1;return(19===t&&Math.random()>.98||"forest"===e&&Math.random()>.4||"plains"===e&&Math.random()>.85||"mountain"===e&&Math.random()>.85||"snow"===e&&Math.random()>.98)&&(a=!0),a&&(n={imageId:t>100?1:2}),n}}function de(){V.classList.add("stars"),setTimeout((()=>{T("#svg-wrap").innerHTML=`<img style="width:100%" src="${k[59]}">`}),3e3)}setTimeout((async()=>{await H.generate(),await H.generate(),await H.generate(),await H.generate(),await Je(),Ze(),be()}),1e3);let ue=!1;function ee(){var e,t,a,n;const o=ge(".tile"),i=N()[p[1]][p[0]];let r,s="";if($.innerHTML="",ue||(s+="HOW TO PLAY: Start by finding a peddler to apprentice under, then a hunter, and so on. Click on areas of the image to move in different directions. The map in the top left shows the 25 fiefdoms you can explore, and the red square marks your current location. Specific trades people will be around different types of settlements. Homesteads include the first 3 trades, farms the next 3, villages the next 6, towns the next 8, and the city will have the rest.",ue=!0),i.structure&&(s+=`You approach a ${i.structure.type}. `),i.animal&&(s+=`${i.animal.story}. `),i.special&&(s+=`${i.special.story} `,58===i.special.id&&de()),i.person){let n;if(n=i.person.isWander?"Walking out along a small path":"As you approach a settlement",s+=`${n}, you meet a ${i.person.profession} named ${i.person.data.name}. `,L[w-1]&&(null==(e=i.person)?void 0:e.profession)===L[w-1]&&(s+=`You apprentice under ${i.person.data.name}. `),i.person){let e=0;const n=j.map((t=>e+=t.length)),o=null==(t=x[m[1]])?void 0:t[m[0]].locs,r=null==(a=x[m[1]])?void 0:a[m[0]].locIds,l=r.map(((e,t)=>{const a=n[e-1]??0;return w<n[e]&&w>=a?t:-1})),d=ye(l.filter((e=>e>=0))),u=r[d];void 0!==u&&o.length>0?s+=`The ${i.person.profession} shares the location of a *${pe[u]}* in this fiefdom around ${o[d].join("-")}. They say that the trades there are: ${j[u].join(", ")}.`:s+="They tell you to look to another fiefdom for your next apprentiships. "+(4===u?"Check the "+E(K[0],K[1])+"fiefdom. ":"")}r=he(i.person.data,i.person.profession,k)}if(""===s&&(s+=`Location ${E()} fiefdom (${m.join("-")}) ${p.join("-")}. `),$.textContent=s,"Lord"===(null==(n=null==i?void 0:i.person)?void 0:n.profession)&&w>=25&&($.textContent="The lord offers you your final apprenticeship. You have learned all that this great land has to offer. After years in service to the lord as their most trusted advisor, you retire feeling oddly empty inside. Truly, there must be more to know...",de()),r&&$.append(r),o.length>0)for(let e=0;e<o.length;e++)o[e].remove();const l=p[0]-3,d=p[1]-3;for(let e=0;e<14;e++){let t=0;if(e<=6)for(;e-t>-1;){const a=[350-50*e+100*t,25*e-t],n=[e-t+l,t+d];fe([`M ${a[0]} ${a[1]} l 50 25 l -50 25 l -50 -25 Z`,`M ${a[0]-50} ${a[1]+25} l 50 25 l 0 45 l -50 -25 Z`,`M ${a[0]} ${a[1]+50} l 50 -25 l 0 45 l -50 25 Z`],n[0]+"-"+n[1],a,n),t++}else for(;t+(e-6)<7;){const a=[50+50*(t+(e-6))+50*t,25*e-t],n=[6-t+l,t+(e-6)+d];fe([`M ${a[0]} ${a[1]} l 50 25 l -50 25 l -50 -25 Z`,`M ${a[0]-50} ${a[1]+25} l 50 25 l 0 45 l -50 -25 Z`,`M ${a[0]} ${a[1]+50} l 50 -25 l 0 45 l -50 25 Z`],n[0]+"-"+n[1],a,n),t++}}}function fe(e,t,a,n){var o;const i=N();let r=O("g");if(null==(o=i[n[1]])||!o[n[0]])return;const s=i[n[1]][n[0]];for(let t=0;t<e.length;t++){let a=O("path",e[t]);b(a,"fill",s.color),t>0&&b(a,"opacity",.7),r.appendChild(a)}r.classList.add("tile"),r.dataset.xyid=t;let l=i[p[1]][p[0]].elevation-s.elevation;function d(e,t){const n=O("image");b(n,"href",e),b(n,"width",100),b(n,"height",100),n.classList.add("tile"),t&&n.classList.add(t),b(n,"x",a[0]-50),b(n,"y",a[1]-70),b(n,"transform",`translate(0, ${l})`),b(n,"opacity",1-.01*l),V.appendChild(n)}"water"===s.biome&&(l*=.5),"plains"===s.biome&&(l*=2.5),"forest"===s.biome&&(l*=3.5),"mountain"===s.biome&&(l*=6),"snow"===s.biome&&(l*=8),b(r,"transform",`translate(0, ${l})`),b(r,"opacity",1-.015*l),V.appendChild(r),s.tree&&d(k[s.tree.imageId]),s.structure&&d(k[s.structure.imageId]),s.animal&&d(k[s.animal.imageId]),s.person&&d(k[s.person.imageId]),s.special&&d(k[s.special.imageId]),t===p.join("-")&&d(k[0],"player")}function O(e,t){let a=document.createElementNS("http://www.w3.org/2000/svg",e);return t&&"path"===e&&b(a,"d",t),a}function Ze(){for(let e=0;e<5;e++)for(let t=0;t<5;t++){const a=O("rect");b(a,"width",10),b(a,"height",10),b(a,"x",10*t),b(a,"y",10*e),b(a,"id","m"+t+"-"+e),2===t&&2===e&&b(a,"style","fill: red");const n=O("title");n.textContent=q[5*t+e],a.appendChild(n),De.appendChild(a)}}function Ue(e){const t=[];for(let a=0;a<e;a++){const e=document.createElement("img");e.src=k[44],e.style.top=g(10,20)+"%",e.style.left=g(10,90)+"%",e.classList.add("stars"),t.push(e),document.body.appendChild(e)}setTimeout((()=>{for(let e=0;e<t.length;e++)t[e].remove()}),3e3)}async function Je(){for(let e=0;e<se.length;e++){const t=await Te([se[e]]);k.push(t)}}</script><body><style>*{margin:0;padding:0}body{font-family:'Trebuchet MS',Arial,sans-serif;background-color:#000}.image{image-rendering:pixelated;image-rendering:-moz-crisp-edges;image-rendering:crisp-edges}.hidden{display:none}.border{border:2px solid grey;padding:6px 8px;border-radius:8px;margin:2px}li>span{display:inline-block}[data-d]{opacity:0}[data-d]:hover{fill:#f1f1f1;opacity:.2;cursor:pointer}.stars{position:absolute;animation-name:topFadeOut;animation-duration:3s}@keyframes topFadeOut{0%{position:absolute;transform:translateY(0);opacity:1}100%{position:absolute;transform:translateY(-300px);opacity:0}}#wrap{max-width:350px;margin:37px auto;position:relative;color:#fff}#map>rect{fill:#d8b57a}</style><div id=wrap><div id=svg-wrap><svg width=700 height=275 viewBox="0 0 700 350" style="width:100%;max-width:350px;margin:0 auto" xmlns=http://www.w3.org/2000/svg><g id=game></g><g id=ui><rect data-d=nw width=233 height=124 x=0 y=0 /><rect data-d=n width=233 height=124 x=233 y=0 /><rect data-d=ne width=233 height=124 x=466 y=0 /><rect data-d=w width=350 height=124 x=0 y=124 /><rect data-d=e width=350 height=124 x=350 y=124 /><rect data-d=sw width=233 height=124 x=0 y=248 /><rect data-d=s width=233 height=124 x=233 y=248 /><rect data-d=se width=233 height=124 x=466 y=248 /></g></svg><svg id=map width=50 height=50 viewBox="0 0 50 50" transform=rotate(45) style=position:absolute;left:0 xmlns=http://www.w3.org/2000/svg></svg></div><div style=overflow-y:auto;overflow-x:hidden><div id=story class=border>Loading...</div><div class=border><div>Apprenticed List</div><ol style=list-style-position:inside></ol></div></div></div><span>v.0.91</span><div id=character></div><canvas class=hidden id=perlin width=1000 height=1000></canvas><svg class=hidden id=perlin-svg width=1000 height=1000 xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink><filter id=blur filterUnits=objectBoundingBox x=-30% y=-30% width=160% height=160%><feGaussianBlur in=SourceGraphic stdDeviation=10 /></filter></svg><canvas class=hidden id=start></canvas><canvas class=hidden id=final></canvas>