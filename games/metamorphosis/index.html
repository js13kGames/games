<script src=/2017/webxr/aframe.js></script><script>function switchToMainScene(){finite_state="wake",document.getElementById("scene-start").setAttribute("visible","false"),document.getElementById("scene-main").setAttribute("visible","true"),document.querySelector("#light-point").emit("light-on"),first_stage()}function switchToEndScene(){document.querySelector("#light-point").emit("light-off"),document.getElementById("scene-main").setAttribute("visible","false"),document.getElementById("scene-end").setAttribute("visible","true")}function printGameStatus(){console.log("John: "+john_lives+", Jane: "+jane_lives+", Heal times: "+heal_times)}function getJaneAction(){return Math.random()>.5?1:0}function endGame(){var t=document.getElementById("button-defense"),e=document.getElementById("button-talk"),i=document.getElementById("button-end");t.setAttribute("visible","false"),e.setAttribute("visible","false"),i.setAttribute("visible","true")}function black_text_big(t){return{width:4,color:"black",align:"center",value:t}}function white_text_big(t){return{width:4,color:"white",align:"center",value:t}}AFRAME.registerComponent("travel-node",{schema:{axis:{type:"string",default:null},offsetX:{type:"number",default:null},offsetY:{type:"number",default:null},offsetZ:{type:"number",default:null},transition:{type:"string",default:null},animationDur:{type:"number",default:null},animationEasing:{type:"number",default:null},travelTarget:{type:"selector"}},axises:null,clickEventRegistered:!1,travelTarget:null,update:function(){var t=document.querySelector("a-scene");t.hasLoaded?this.setupVariables():t.addEventListener("loaded",function(){this.setupVariables()}.bind(this))},setupVariables:function(){var t=document.querySelector("a-scene"),e=t.components["travel-node-defaults"];if(void 0===e)t.setAttribute("travel-node-defaults",""),setTimeout(this.setupVariables.bind(this),10);else{for(var i in this.data)("number"===this.schema[i].type&&isNaN(this.data[i])||null===this.data[i])&&(this.data[i]=e.data[i]);for(i in this.axises={},t=this.data.axis.toLowerCase().split(","),e=["x","y","z"]){var a=e[i];0<=t.indexOf(a)&&(this.axises[a]=!0)}this.travelTarget=this.data.travelTarget,null===this.travelTarget&&console.warn("Can't determine travel target."),this.clickEventRegistered||(this.el.addEventListener("click",this.onClick.bind(this)),this.clickEventRegistered=!0)}},onClick:function(){var t=new THREE.Vector3,e=new THREE.Vector3;for(var i in t.setFromMatrixPosition(this.el.object3D.matrixWorld),e.setFromMatrixPosition(this.travelTarget.object3D.matrixWorld),this.axises)e[i]=t[i];switch(e.x+=this.data.offsetX,e.y+=this.data.offsetY,e.z+=this.data.offsetZ,this.targetPosition=e,this.data.transition){case"fade":this.fadeToTarget();break;case"move":AFRAME.components.animation?this.moveToTarget():(console.warn("To use the 'move' transition, you will need to add the aframe-animation-component component, available at https://github.com/ngokevin/aframe-animation-component"),this.jumpToTarget());break;default:console.warn("Unknown travel mode: "+this.data.mode);case"jump":this.jumpToTarget()}},fadeToTarget:function(){var t=document.querySelector("a-scene").camera.el,e=document.createElement("a-plane");e.setAttribute("position","0 0 -0.1"),e.setAttribute("material","color: black; transparent: true; opacity: 0");var i=document.createElement("a-animation");i.setAttribute("attribute","material.opacity"),i.setAttribute("from","0"),i.setAttribute("to","1"),i.setAttribute("dur",this.data.animationDur),i.setAttribute("easing",this.data.animationEasing);var a=i.cloneNode(!0);a.setAttribute("from","1"),a.setAttribute("to","0"),a.setAttribute("delay",this.data.animationDur+100),i.addEventListener("animationend",function(){this.jumpToTarget()}.bind(this)),a.addEventListener("animationend",(function(){e.removeChild(a),e.removeChild(i),t.removeChild(e)})),e.appendChild(a),e.appendChild(i),t.appendChild(e)},moveToTarget:function(){this.travelTarget.setAttribute("animation__travel-node_movetotarget","property: position; to: "+this.targetPosition.x+" "+this.targetPosition.y+" "+this.targetPosition.z+"; dur: "+this.data.animationDur+"; easing: "+this.data.animationEasing),this.travelTarget.addEventListener("animation__travel-node_movetotarget-complete",function(){this.travelTarget.removeAttribute("animation__travel-node_movetotarget")}.bind(this))},jumpToTarget:function(){this.travelTarget.setAttribute("position",this.targetPosition)}}),AFRAME.registerComponent("travel-node-defaults",{schema:{axis:{type:"string",default:"x,z"},offsetX:{type:"number",default:0},offsetY:{type:"number",default:0},offsetZ:{type:"number",default:0},transition:{type:"string",default:"fade"},animationDur:{type:"number",default:100},animationEasing:{type:"string",default:"linear"},travelTarget:{type:"selector",default:"[camera]"}},init:function(){var t=document.querySelector("a-scene");t.hasLoaded?this.checkElement():t.addEventListener("loaded",function(){this.checkElement()}.bind(this))},checkElement:function(){"A-SCENE"!==this.el.tagName&&console.warn("travel-node-defaults should be placed on the a-scene element.")}}),function(t){function e(a){if(i[a])return i[a].exports;var n=i[a]={exports:{},id:a,loaded:!1};return t[a].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};e.m=t,e.c=i,e.p="",e(0)}([function(t,e){if("undefined"==typeof AFRAME)throw new Error("Component attempted to register before AFRAME was available.");AFRAME.registerComponent("mirror",{schema:{resolution:{type:"number",default:128},refraction:{type:"number",default:.95},color:{type:"color",default:16777215},distance:{type:"number",default:3e3},interval:{type:"number",default:1e3},repeat:{type:"boolean",default:!1}},multiple:!1,init:function(){this.counter=this.data.interval,this.cam=new THREE.CubeCamera(.5,this.data.distance,this.data.resolution),this.el.object3D.add(this.cam),this.mirrorMaterial=new THREE.MeshBasicMaterial({color:this.data.color,refractionRatio:this.data.refraction,envMap:this.cam.renderTarget.texture}),this.done=!1;var t=this.mirrorMaterial;this.mesh=this.el.getObject3D("mesh"),this.mesh&&this.mesh.traverse((function(e){e instanceof THREE.Mesh&&(e.material=t)}))},tick:function(t,e){if(!this.done)if(this.counter>0)this.counter-=e;else if(this.mesh=this.el.getObject3D("mesh"),this.mesh){this.mesh.visible=!1,AFRAME.scenes[0].renderer.autoClear=!0,this.cam.position.copy(this.el.object3D.worldToLocal(this.el.object3D.getWorldPosition())),this.cam.updateCubeMap(AFRAME.scenes[0].renderer,this.el.sceneEl.object3D);var i=this.mirrorMaterial;this.mesh.traverse((function(t){t instanceof THREE.Mesh&&(t.material=i)})),this.mesh.visible=!0,this.data.repeat||(this.done=!0,this.counter=this.data.interval)}},update:function(t){},remove:function(){},pause:function(){},play:function(){}})}]),AFRAME.registerComponent("hover-effect",{init:function(){var t=this.el,e=t.getAttribute("scale"),i={x:1.2*e.x,y:1.2*e.y,z:1.2*e.z};t.addEventListener("mouseenter",(function(e){t.setAttribute("scale",i)})),t.addEventListener("mouseleave",(function(i){t.setAttribute("scale",e)}))}}),AFRAME.registerComponent("water-cup",{init:function(){var t=this.el;t.addEventListener("mouseenter",(function(e){t.setAttribute("scale","2.5 2.5 2.5")})),t.addEventListener("mouseleave",(function(e){t.setAttribute("scale","2.0 2.0 2.0")})),t.addEventListener("click",(function(e){"wake"===finite_state?(finite_state="water",set_event_plane(finite_state),t.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),action_text_handler=function(){t.setAttribute("visible",!0),reset_event_plane(),second_stage()},action_text.addEventListener("click",action_text_handler)):(set_event_plane(finite_state,"#water-cup-hand"),t.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),event_text.setAttribute("text",white_text("A cup of water. I don't need it right now.")),action_text.setAttribute("text",black_text("PUT BACK")),action_text_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text.addEventListener("click",action_text_handler))}))}}),AFRAME.registerComponent("envelope",{init:function(){var t=this.el;t.addEventListener("click",(function(e){1===third_stage_state?(finite_state="paper",set_event_plane(finite_state),t.setAttribute("visible",!1),action_text_primary_handler=function(){action_text_primary.setAttribute("visible",!1),action_text_secondary.setAttribute("visible",!1),third_stage()},action_text_secondary_handler=function(){t.setAttribute("visible",!0),finite_state="free",reset_event_plane()},action_text_handler=function(){1===third_stage_state?(third_stage_state++,event_text.setAttribute("text",white_text("Oh right, I signed up for the special forces, and my term starts tomorrow."))):2===third_stage_state?(third_stage_state++,event_text.setAttribute("text",white_text("But how come my documents are in this unknown place?"))):3===third_stage_state?(third_stage_state++,event_text.setAttribute("text",white_text("No matter what, I'd better go back to my place and prepare for the enlistment ASAP.")),action_text.setAttribute("text",black_text("PUT BACK"))):4===third_stage_state&&(t.setAttribute("visible",!0),finite_state="free",reset_event_plane(),help_text.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),setTimeout((function(){camera_text.setAttribute("visible",!0),camera_text.setAttribute("text",white_text("The phone on the table is ringing. Maybe I should get it.")),document.querySelector("#phone").emit("phone-ring")}),5e3))},action_text.addEventListener("click",action_text_handler),action_text_primary.addEventListener("click",action_text_primary_handler),action_text_secondary.addEventListener("click",action_text_secondary_handler)):(set_event_plane(finite_state,"#envelope-hand"),t.setAttribute("visible",!1),action_text.setAttribute("visible",!1),action_text_primary.setAttribute("visible",!0),action_text_secondary.setAttribute("visible",!0),event_text.setAttribute("text",white_text("My enlistment documents.")),action_text.setAttribute("text",black_text("PUT BACK")),action_text_primary.setAttribute("text",black_text("READ DOCUMENT")),action_text_secondary.setAttribute("text",black_text("PUT BACK")),action_text_primary_handler=function(){action_text_primary.setAttribute("visible",!1),action_text_secondary.setAttribute("visible",!1),action_text.setAttribute("visible",!0),event_text.setAttribute("text",white_text('"John Doe would be serving the country in the Navy from '+current_date_string+" to "+future_date_string+'..."'))},action_text_secondary_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text.addEventListener("click",action_text_handler),action_text_primary.addEventListener("click",action_text_primary_handler),action_text_secondary.addEventListener("click",action_text_secondary_handler))}))}}),AFRAME.registerComponent("phone",{init:function(){var t=this.el;t.addEventListener("click",(function(e){if(fourth_stage_state>1)set_event_plane(finite_state,"#phone-hand"),t.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),event_text.setAttribute("text",white_text("Someone's phone. There's nothing I can do with it.")),action_text.setAttribute("text",black_text("PUT BACK")),action_text_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text.addEventListener("click",action_text_handler);else if(third_stage_state>1){finite_state="phone",set_event_plane(finite_state),t.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),document.querySelector("#phone").emit("phone-end");var i=document.querySelector("#phone-hand");action_text_handler=function(){1===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text('"Hey, John! Where the hell are you?"')),action_text.setAttribute("text",black_text("NEXT"))):2===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("Who's this?"))):3===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text('"Jane! Your girlfriend! Are you out of your mind?"'))):4===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("Oh…, I’m sorry. I'm somewhere strange."))):5===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text('"What do you mean by strange? I have been waiting for you at the meeting point for hours!"'))):6===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("What meeting point?"))):7===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text('"The place where we should meet on the day you come back from the military?"'))):8===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("What do you mean by that? My term starts from "+current_date_string+", and that's tomorrow."))):9===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("\"John, are you out of your mind? It's "+future_date_string+' today, and today should be the last day of your service."'))):10===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("You're kidding me! I haven't even joined the special forces!"))):11===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text('"Calm down, John. I\'ll go find you and we will figure things out together."'))):12===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("But how are you going to find me if I don't even know where I am?"))):13===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text('"Are you at a place with an abstract painting on the wall?"'))):14===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("How'd you know?"))):15===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text('"Stay there. I\'ll be there right away."')),action_text.setAttribute("text",black_text("END CALL"))):16===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("Everything feels so weird. If that is true, why can't I recall anything from the past three years?")),action_text.setAttribute("text",black_text("NEXT"))):17===fourth_stage_state?(fourth_stage_state++,event_text.setAttribute("text",white_text("I don't feel well. I think I might throw up.")),action_text.setAttribute("text",black_text("NEXT"))):18===fourth_stage_state&&(t.setAttribute("visible",!0),i.setAttribute("visible",!1),finite_state="free",reset_event_plane(),help_text.setAttribute("visible",!0),camera_text.setAttribute("visible",!1),help_text.setAttribute("text",white_text("Find a place to throw up.")),setTimeout((function(){help_text.setAttribute("visible",!1)}),5e3))},action_text.addEventListener("click",action_text_handler)}else set_event_plane(finite_state,"#phone-hand"),t.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),event_text.setAttribute("text",white_text("Someone's phone. There's nothing I can do with it.")),action_text.setAttribute("text",black_text("PUT BACK")),action_text_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text.addEventListener("click",action_text_handler)}))}}),AFRAME.registerComponent("toilet-door",{init:function(){this.el.addEventListener("click",(function(){fourth_stage_state>1?"free"===finite_state?(set_event_plane("toilet_door_enter"),finite_state="toilet",action_text_primary_handler=function(){reset_event_plane();var t=document.querySelector("a-camera");t.setAttribute("position","-4.2 2.5 10.980"),t.setAttribute("rotation","0 270 0")},action_text_secondary_handler=function(){reset_event_plane()},action_text_primary.addEventListener("click",action_text_primary_handler),action_text_secondary.addEventListener("click",action_text_secondary_handler)):"toilet"===finite_state&&(set_event_plane("toilet_door_leave"),action_text_primary_handler=function(){finite_state="free",reset_event_plane();var t=document.querySelector("a-camera");t.setAttribute("position","-5.04 2.5 5.025"),t.setAttribute("rotation","0 0 0"),camera_text.setAttribute("text",white_text("Someone is knocking at the door. Maybe I should answer it.")),camera_text.setAttribute("visible",!0),setTimeout((function(){camera_text.setAttribute("visible",!1)}),5e3)},action_text_secondary_handler=function(){reset_event_plane()},action_text_primary.addEventListener("click",action_text_primary_handler),action_text_secondary.addEventListener("click",action_text_secondary_handler)):(camera_text.setAttribute("text",white_text("There is something else I need to do first.")),camera_text.setAttribute("visible",!0))}))}}),AFRAME.registerComponent("paper",{init:function(){var t=this.el;t.addEventListener("click",(function(){"free"===finite_state&&(set_event_plane(finite_state,"#paper-hand"),t.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),event_text.setAttribute("text",white_text("A stack of paper. There's nothing special with it.")),action_text.setAttribute("text",black_text("PUT BACK")),action_text_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text.addEventListener("click",action_text_handler))}))}}),AFRAME.registerComponent("plant",{init:function(){var t=this.el;t.addEventListener("click",(function(){"free"===finite_state&&(set_event_plane(finite_state,"#plant-hand"),t.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),event_text.setAttribute("text",white_text("A plant. Seems that the owner of this room has a green thumb.")),action_text.setAttribute("text",black_text("PUT BACK")),action_text_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text.addEventListener("click",action_text_handler))}))}}),AFRAME.registerComponent("toilet",{init:function(){this.el.addEventListener("click",(function(){console.log("puke"),event_text.setAttribute("text",white_text("I need to use the toilet, I am going to throw up.")),action_text.setAttribute("text",black_text("USE TOILET")),set_event_plane("free"),action_text_handler=function(){reset_event_plane(),camera_text.setAttribute("text",white_text("Feeling better.")),camera_text.setAttribute("visible",!0),setTimeout((function(){camera_text.setAttribute("visible",!1)}),3e3)},action_text.addEventListener("click",action_text_handler)}))}}),AFRAME.registerComponent("look-at-mirror",{init:function(){this.el.addEventListener("click",(function(){set_event_plane("free"),event_text.setAttribute("text",white_text("Why there is a gigantic insect in the mirror?")),action_text.setAttribute("text",black_text("NEXT")),action_text_handler=function(){console.log("mirror"),1===fifth_stage_state?(fifth_stage_state++,event_text.setAttribute("text",white_text("What! The! Fuck! It's me! I become this gigantic insect!"))):2===fifth_stage_state?(fifth_stage_state++,event_text.setAttribute("text",white_text("No, no, no. This is not possible. This is fucking crazy!"))):3===fifth_stage_state?(fifth_stage_state++,event_text.setAttribute("text",white_text("Oh no..., I am going to puke again..."))):4===fifth_stage_state?(fifth_stage_state++,event_text.setAttribute("text",white_text("Errr..., I don't feel well..."))):5===fifth_stage_state?(fifth_stage_state++,event_text.setAttribute("text",white_text("My throat is burning again. And it's getting worse..."))):6===fifth_stage_state?(fifth_stage_state++,event_text.setAttribute("text",white_text("Ahhhh... I...I..., can't speak!"))):7===fifth_stage_state?(fifth_stage_state++,event_text.setAttribute("text",white_text("This place is fucking weird. What happened to me?"))):8===fifth_stage_state?(fifth_stage_state++,event_text.setAttribute("text",white_text("I need to get out of here.")),action_text.setAttribute("text",black_text("END"))):(event_text.setAttribute("visible",!1),action_text.setAttribute("visible",!1))},action_text.addEventListener("click",action_text_handler)}))}}),AFRAME.registerComponent("front-door",{init:function(){this.el.addEventListener("click",(function(){fifth_stage_state>1?(set_event_plane("front_door_enter"),finite_state="combat",action_text_handler=function(){reset_event_plane();var t=document.querySelector("a-camera");t.setAttribute("position","-4.5 1.8 -10"),t.setAttribute("rotation","0 0 0")},action_text.addEventListener("click",action_text_handler)):(camera_text.setAttribute("text",white_text("There is something else I need to do first.")),camera_text.setAttribute("visible",!0))}))}}),AFRAME.registerComponent("book",{init:function(){var t=this.el;t.addEventListener("click",(function(){"free"===finite_state&&(set_event_plane(finite_state,"#book-hand"),t.setAttribute("visible",!1),camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),event_text.setAttribute("text",white_text("A stack of books. Seems that the owner of this room has a green thumb.")),action_text.setAttribute("text",black_text("PUT BACK")),action_text_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text.addEventListener("click",action_text_handler))}))}}),AFRAME.registerComponent("painting",{init:function(){this.el.addEventListener("click",(function(){!1===mail_show?(mail_show=!0,camera_text.setAttribute("text",white_text("Something fell on the door. Maybe I should take a look at it.")),camera_text.setAttribute("visible",!0),document.querySelector("#mail").setAttribute("visible",!0),setTimeout((function(){camera_text.setAttribute("visible",!1)}),5e3)):(camera_text.setAttribute("text",white_text("A abstract painting. There is nothing special with it.")),camera_text.setAttribute("visible",!0),setTimeout((function(){camera_text.setAttribute("visible",!1)}),3e3))}))}}),AFRAME.registerComponent("mail-floor",{init:function(){var t=this.el;t.addEventListener("click",(function(){set_event_plane("mail"),t.setAttribute("visible",!1),action_text_primary_handler=function(){action_text_primary.setAttribute("visible",!1),action_text_secondary.setAttribute("visible",!1),event_text.setAttribute("text",white_text('"Dear John, you must be wondering why you would receive a letter written by yourself."')),action_text.setAttribute("visible",!0)},action_text_secondary_handler=function(){t.setAttribute("visible",!0),reset_event_plane()},action_text_handler=function(){1===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"And by the time you read this letter, you might figure out that something\'s wrong with your body."'))):2===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"So this letter is meant to tell you what happened."'))):3===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"You\'ve particpated in an elite program while serving the country."'))):4===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"The program acclaimed that its purpose was to improve soldiers\' physical strength through medical injections."'))):5===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"However, what the program didn\'t tell you was that the possible failure rate is way higher than the success rate."'))):6===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"And a variety of side effects may occur, including body tansformation of any kind, which was happening to you right now."'))):7===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"According to your officials, you would soon be injected with a cure."'))):8===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"And you would be sent back to your house for recovering."'))):9===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"However, it\'s very likely that there is no such thing as an cure."'))):10===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"I am not sure what would happen next."'))):11===extra_stage_state?(extra_stage_state++,event_text.setAttribute("text",white_text('"Be aware. Be safe."')),action_text.setAttribute("text",black_text("END READING"))):12===extra_stage_state&&(t.setAttribute("visible",!0),reset_event_plane())},action_text.addEventListener("click",action_text_handler),action_text_primary.addEventListener("click",action_text_primary_handler),action_text_secondary.addEventListener("click",action_text_secondary_handler)}))}}),AFRAME.registerComponent("teleport-listener",{init:function(){this.el.addEventListener("mouseenter",(function(t){"free"===finite_state&&this.setAttribute("material","color","#DDDDDD")})),this.el.addEventListener("mouseleave",(function(t){"free"===finite_state&&this.setAttribute("material","color","#444444")}))}});var john_lives=3,jane_lives=3,heal_times=0,heal_thres=3,game_status_str="Choose an action!",jane_action=0,game_state=1;AFRAME.registerComponent("defense",{init:function(){this.el.addEventListener("click",(function(t){var e=document.getElementById("combat-text");1==game_state&&(0==(jane_action=getJaneAction())?(game_status_str="Jane tries to listen to you but you defense...",0==--jane_lives&&(game_state=0,game_status_str="You killed Jane!",endGame())):game_status_str="Jane attacks you! Thankfully you defense!",e.setAttribute("text",white_text(game_status_str))),printGameStatus()}))}}),AFRAME.registerComponent("talk",{init:function(){this.el.addEventListener("click",(function(t){var e=document.getElementById("combat-text");if(1==game_state){if(0==(jane_action=getJaneAction())){switch(heal_times){case 0:game_status_str='"You monster! Tell me where is John!"';break;case 1:game_status_str='"No way you are John! Tell me who you are!"';break;case 2:game_status_str='"You sounds like John! It can\'t be!"'}3==++heal_times&&(game_state=0,game_status_str="Oh my dear, let't go home and figure all this out!",endGame())}else game_status_str="You try to explain but Jane attacks you!",0==--john_lives&&(game_state=0,game_status_str="You are killed by Jane.",endGame());e.setAttribute("text",white_text(game_status_str))}printGameStatus()}))}})</script><body><a-scene travel-node-default="axis: x,y,z; offsetY: 0.75"><a-entity id=scene-start visible=true><a-entity id=light-ambient light="type: ambient; intensity: 1; color: #BBB"></a-entity><a-entity position="6 3 2" geometry="primitive: plane; height: 1; width: 3.6" material=color:black text="width: 14; color: white; align: center; value: METAMORPHOSIS"></a-entity><a-entity position="6 1 2" geometry="primitive: plane; height: 1; width: 3.6" material=color:white text="width: 14; color: black; align: center; value: WAKE UP" onclick=switchToMainScene() hover-effect></a-entity><a-sky color=#000000></a-sky></a-entity><a-entity id=scene-main visible=false><a-entity light="type: ambient; color: #FFF; intensity: 0.1"></a-entity><a-entity light="type: directional; color: #FFF; intensity: 0.4" position="-0.5 1 1"></a-entity><a-plane class=tile position="-5 0.01 4" rotation="-90 0 0" width=4 height=2 color=#444444 teleport-listener travel-node></a-plane><a-plane class=tile position="-0.4 0.01 4" rotation="-90 0 0" width=4 height=2 color=#444444 teleport-listener travel-node></a-plane><a-plane class=tile position="-3.5 0.01 0" rotation="-90 0 0" width=1 height=4 color=#444444 teleport-listener travel-node></a-plane><a-plane class=tile position="-0.4 0.01 0" rotation="-90 0 0" width=4 height=4 color=#444444 teleport-listener travel-node></a-plane><a-plane class=tile position=" 4.6 0.01 0" rotation="-90 0 0" width=4 height=4 color=#444444 teleport-listener travel-node></a-plane><a-plane class=tile position="-5 0.01 -4" rotation="-90 0 0" width=4 height=2 color=#444444 teleport-listener travel-node></a-plane><a-plane class=tile position="0 0.01 -4" rotation="-90 0 0" width=4 height=2 color=#444444 teleport-listener travel-node></a-plane><a-plane class=tile position=" 4.6 0.01 -4" rotation="-90 0 0" width=4 height=2 color=#444444 teleport-listener travel-node></a-plane><a-plane position="0 0 0" rotation="-90 0 0" width=15 height=15 color=#333333><a-box position="8 0 4" rotation="0 0 0" geometry="width: 1; height: 17; depth: 8" color=#e3e3e3></a-box><a-box position="-8 0 4" rotation="0 0 0" geometry="width: 1; height: 27; depth: 8" color=#e3e3e3></a-box><a-box position="2 8 4" rotation="0 0 90" geometry="width: 1; height: 11; depth: 8" color=#e3e3e3></a-box><a-box position="2 -8 4" rotation="0 0 90" geometry="width: 1; height: 11; depth: 8" color=#e3e3e3></a-box><a-box position="-7 -8 4" rotation="0 0 90" geometry=depth:8 color=#e3e3e3></a-box><a-box position="-7 8 4" rotation="0 0 90" geometry=depth:8 color=#e3e3e3></a-box><a-box position="-5 -8 7" rotation="0 0 90" geometry=height:3;depth:2 color=#e3e3e3></a-box><a-box position="-5 8 7" rotation="0 0 90" geometry=depth:2;height:3 color=#e3e3e3></a-box><a-entity><a-box position="5.77 -5 0.251" geometry=height:4.5;depth:0.5;width:3.5 color=#e3e3e3 material=color:#000000></a-box><a-box position="5.77 -5 0.8" geometry=depth:0.5;height:4.5;width:3.5 color=#e3e3e3 material=color:#ffffff></a-box><a-box position="5.77 -7.32 0.251" geometry=height:0.5;depth:3;width:3.5 color=#e3e3e3 material=color:#000000></a-box></a-entity><a-entity paper hover-effect position="3.482 -1.342 0.01"><a-box position="0 0 0.01" geometry=width:0.7;height:0.5;depth:0.05 color=#e3e3e3 material=color:#FFF></a-box><a-box position="0 0 0" rotation="0 0 -18.850311459804086" geometry=depth:0.05;height:0.5;width:0.7 color=#e3e3e3 material=color:#FFF></a-box></a-entity><a-entity paper="" hover-effect="" position="1.629 2.577 0.01"><a-box position="0 0 0.01" geometry=depth:0.05;height:0.5;width:0.7 color=#e3e3e3 material=color:#FFF></a-box><a-box rotation="0 0 -18.850311459804086" geometry=depth:0.05;height:0.5;width:0.7 color=#e3e3e3 material=color:#FFF></a-box></a-entity><a-entity paper hover-effect="" position="3.01 5.002 0.01"><a-box position="0 0 0.01" geometry=depth:0.05;height:0.5;width:0.7 color=#e3e3e3 material=color:#FFF></a-box><a-box rotation="0 0 -18.850311459804086" geometry=depth:0.05;height:0.5;width:0.7 color=#e3e3e3 material=color:#FFF></a-box></a-entity><a-entity position="3.2 -7 0.5"><a-box material=color:#000000 geometry=width:1.5;depth:1.75></a-box><a-box position="0.053 0.48 0.472" material=color:#fff geometry=width:0.3;height:0.1;depth:0.05></a-box><a-box position="0.053 0.48 0.013" material=color:#fff geometry=depth:0.05;height:0.1;width:0.3></a-box></a-entity><a-entity water-cup hover-effect position="3.2 -7 1.58"><a-cylinder rotation="90.01166961505233 0 0" material="" geometry=height:0.4;radius:0.15></a-cylinder><a-circle position="0.007 -0.003 0.215" material=color:#00ffff geometry=radius:0.13></a-circle></a-entity><a-entity position="-6.5 0 1.7" scale="0.8 0.8 0.8"><a-box position="0.481 0 -0.284" material=color:#996633 geometry=depth:0.3;width:3;height:5></a-box><a-box position="1.818 -2.344 -1.202" material=color:#996633 geometry=depth:2;height:0.3;width:0.3></a-box><a-box position="-0.842 -2.344 -1.202" material=color:#996633 geometry=depth:2;height:0.3;width:0.3></a-box><a-box position="1.844 2.319 -1.202" material=color:#996633 geometry=depth:2;height:0.3;width:0.3></a-box><a-box position="-0.842 2.367 -1.202" material=color:#996633 geometry=depth:2;height:0.3;width:0.3></a-box></a-entity><a-entity plant hover-effect position="-1.75 6.5 0.8"><a-cylinder position="0 0.58 -0.405" rotation="90 0 0" material=color:#3b4752 geometry=radius:0.4;height:0.8></a-cylinder><a-cylinder position="0 0.58 0.042" rotation="90 0 0" material=color:#804000 geometry=radius:0.1;height:0.8></a-cylinder><a-sphere color=yellow radius=5 position="-0.042 0.512 0.619" material=color:#66ff66 geometry=radius:0.5></a-sphere><a-sphere color=yellow radius=5 position="-0.042 0.512 1.039" material=color:#66ff66 geometry=radius:0.3></a-sphere></a-entity><a-entity position="1 6.9 2.3"><a-box position="0 0 -0.27" material=color:#333333 geometry=width:1.2;depth:4></a-box><a-box position="0.012 -0.173 1.18" material=color:#800000 geometry=depth:0.8></a-box><a-box position="0.012 -0.173 0.245" material=color:#400080 geometry=depth:0.8></a-box><a-box position="0.012 -0.173 -0.723" material=color:#008080 geometry=depth:0.8></a-box><a-box position="0.012 -0.173 -1.686" material=color:#000080 geometry=depth:0.8></a-box></a-entity><a-entity phone id=phone position="-5.5 -0.5 1.7"><a-box position="0 0 -0.066" material=color:#333 geometry=height:0.3;width:0.5;depth:0.05></a-box><a-animation begin=phone-ring end=phone-end attribute=scale dur=1000 from="0.5 0.5 0.5" to="0.8 0.8 0.8" repeat=indefinite></a-animation></a-entity><a-entity book hover-effect position="2 0 0.15"><a-box position="0 0 -0.087" material=color:#800080 geometry=width:0.8;height:0.6;depth:0.12></a-box><a-box position="0 0 0.031" material=color:#6d5cae geometry=depth:0.12;height:0.6;width:0.8 rotation="0 0 -14.495832216809827"></a-box></a-entity><a-entity position="-0.5 -6 1.5"><a-box position="0.726 -1.005 -0.252" material=color:#333333 geometry=width:4;depth:2.5></a-box><a-box position="0.726 -0.644 0.655" material=color:#804000 geometry=depth:0.1;height:0.4></a-box><a-box position="0.726 -0.644 0.006" material=color:#804000 geometry=depth:0.1;height:0.4></a-box><a-box position="0.726 -0.644 -0.686" material=color:#804000 geometry=depth:0.1;height:0.4></a-box></a-entity><a-entity envelope hover-effect position="0 -6.5 0.009"><a-box rotation="0 0 -39.5340878640268" material=color:#996633 geometry=width:0.8;depth:0.05></a-box></a-entity><a-entity painting position="-7.4 -5 4.5"><a-box position="-0.114 0 0" material=color:#000000 geometry=height:3;width:0.2;depth:4></a-box><a-box position="-0.048 0.57 0.994" material=color:#ff0000 geometry=depth:2;width:0.2></a-box><a-box position="-0.048 -0.165 -0.633" material=color:#ffffff geometry=depth:2;width:0.2></a-box><a-box position="-0.048 -1.003 0.266" material=color:#ffff00 geometry=depth:2;width:0.2></a-box></a-entity><a-entity id=mail visible=false mail-floor position="-7 -5 0.1"><a-box rotation="0 0 -39.534" material=color:#ff8000 geometry=width:0.5;height:0.8;depth:0.05></a-box></a-entity></a-plane><a-plane position="-4.5 0 10.5" rotation="-90 0 0" width=6 height=6 color=#333333><a-box position="3.5 -1 4" rotation="0 0 90" geometry=width:6;depth:8 color=#e3e3e3></a-box><a-box position="-0.5 -3.5 4" geometry=width:7;depth:8 color=#e3e3e3></a-box><a-box toilet-door position="-0.55 2.8 3" rotation="0 0 0" geometry=depth:6;height:0.2;width:3 material=color:#3a4652 animation=""></a-box><a-entity toilet hover-effect position="1.74 -1.69 1.5" scale="0.4 0.4 0.4"><a-box position="0 -1.13 0.82" scale="1.3 0.6 0.25" material=""></a-box><a-box position="0 -1.13 0" scale="1.3 0.5 1.626" material=""></a-box><a-cylinder position="0 0 0.061" rotation="90 0 0" material="" geometry=radius:1.1;height:0.2></a-cylinder><a-sphere rotation="-90 0 0" material="" geometry=thetaLength:90></a-sphere></a-entity></a-plane><a-plane position="-4.5 0 -10.5" rotation="-90 0 0" width=6 height=6 color=#333333><a-box position="3.5 1 4" rotation="0 0 90" geometry=width:6;depth:8 color=#e3e3e3></a-box><a-box front-door position="-0.55 -2.2 3" rotation="0 0 0" geometry=depth:6;height:0.2;width:3 material=color:#3a4652 animation=""></a-box></a-plane><a-entity look-at-mirror position="-7.4 2.5 11"><a-box position="-0.2 0 0" width=0.5 height=3.5 depth=3.5 material="color: #3a4652;"></a-box><a-box mirror="resolution: 512; repeat: true;" width=0.2 height=3 depth=3></a-box></a-entity><a-entity position="-4.5 1.5 -13.5" rotation="0 180 0"><a-entity position="0 1 0"><a-sphere position="0.164 -0.183 -0.273" scale="0.1 0.1 0.1" material=color:#171412 geometry=""></a-sphere><a-sphere position="-0.01 -0.2 0.04" scale="0.5 0.3 0.3" material=color:#feff62></a-sphere><a-sphere position="-0.09 -0.18 -0.27" scale="0.1 0.1 0.1" material=color:#161311></a-sphere><a-sphere position="0 -0.36 0" scale="0.4 0.4 0.4" material=color:#ffddc5></a-sphere><a-box position="0 -1 0" scale="0.6 1 0.4" material=color:#ff918f geometry=""></a-box></a-entity><a-entity rotation="0 180 0"><a-entity id=button-defense position="-0.5 0.5 1.5" geometry="primitive: plane; height: 0.2; width: 0.5" material="color:white; opacity: 0.8" text="width: 1; color: black; align: center; value: DEFENSE" defense hover-effect></a-entity><a-entity id=button-talk position="0.5 0.5 1.5" geometry="primitive: plane; height: 0.2; width: 0.5" material="color:white; opacity: 0.8" text="width: 1; color: black; align: center; value: TALK" talk hover-effect></a-entity><a-entity id=combat-text position="0 0.2 1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color:black; opacity: 0.8" text="width: 1; color: white; align: center; value: OMG! What a monster!"></a-entity><a-entity id=button-end visible=false position="0 0 1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color:white; opacity: 0.8" text="width: 1; color: black; align: center; value: END GAME" onclick=switchToEndScene() hover-effect></a-entity></a-entity></a-entity><a-sky color=#333></a-sky><a-plane id=event-plane position="0 0 -20" material=opacity:0><a-entity id=water-cup-hand visible=false position="0 0.25 -2.5"><a-cylinder rotation="90.01166961505233 0 0" material="" geometry=height:0.4;radius:0.15></a-cylinder><a-circle position="0.007 -0.003 0.215" material=color:#00ffff geometry=radius:0.13></a-circle></a-entity><a-entity id=envelope-hand visible=false position="0 0.25 -2.5"><a-box rotation="0 0 -39.5340878640268" material=color:#996633 geometry=width:0.8;depth:0.05></a-box></a-entity><a-entity phone id=phone-hand visible=false position="0.03 0.4 -2"><a-box position="0 0 -0.066" rotation="0 0 -90" material=color:#333 geometry=height:0.3;width:0.5;depth:0.05></a-box><a-animation begin=phone-ring end=phone-end attribute=scale dur=1000 from="0.5 0.5 0.5" to="0.8 0.8 0.8" repeat=indefinite></a-animation></a-entity><a-entity id=paper-hand visible=false position="-0.05 0.5 -2"><a-box position="0 0 0.01" geometry=depth:0.05;height:0.5;width:0.7 color=#e3e3e3 material=color:#FFF></a-box><a-box rotation="0 0 -18.850311459804086" geometry=depth:0.05;height:0.5;width:0.7 color=#e3e3e3 material=color:#FFF></a-box></a-entity><a-entity id=plant-hand visible=false position="0.03 0.4 -2" rotation="-90 0 0"><a-cylinder position="0 0.58 -0.405" rotation="90 0 0" material=color:#3b4752 geometry=radius:0.4;height:0.8></a-cylinder><a-cylinder position="0 0.58 0.042" rotation="90 0 0" material=color:#804000 geometry=radius:0.1;height:0.8></a-cylinder><a-sphere color=yellow radius=5 position="-0.042 0.512 0.619" material=color:#66ff66 geometry=radius:0.5></a-sphere><a-sphere color=yellow radius=5 position="-0.042 0.512 1.039" material=color:#66ff66 geometry=radius:0.3></a-sphere></a-entity><a-entity id=book-hand visible=false position="0.05 0.5 -2"><a-box position="0 0 -0.087" material=color:#800080 geometry=width:0.8;height:0.6;depth:0.12></a-box><a-box position="0 0 0.031" material=color:#6d5cae geometry=depth:0.12;height:0.6;width:0.8 rotation="0 0 -14.495832216809827"></a-box></a-entity><a-entity id=mail-hand visible=false position="0.05 0.5 -2"><a-box rotation="0 0 -39.534" material=color:#ff8000 geometry=width:0.5;height:0.8;depth:0.05></a-box></a-entity><a-entity id=event-text visible=false position="0 -0.25 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: #333333" text="width:1; color: white; align: center; value: Okay, this feels better."></a-entity><a-entity id=action-text visible=false position="0 -0.5 -1.5" geometry="primitive: plane; height: 0.1; width: 0.5" material="color: white; opacity: 0.5;" text="width: 1;color: black; align: center; value: PUT BACK"></a-entity><a-entity id=action-text-primary visible=false position="-0.35 -0.5 -1.5" geometry="primitive: plane; height: 0.1; width: 0.5" material="color: white; opacity: 0.5;" text="width: 1;color: black; align: center; value: PUT BACK"></a-entity><a-entity id=action-text-secondary visible=false position="0.35 -0.5 -1.5" geometry="primitive: plane; height: 0.1; width: 0.5" material="color: white; opacity: 0.5;" text="width: 1;color: black; align: center; value: PUT BACK"></a-entity></a-plane></a-entity><a-entity id=scene-end visible=false><a-entity id=light-ambient light="type: ambient; intensity: 1; color: #BBB"></a-entity><a-entity position="-4.5 1.5 -12" geometry="primitive: plane; height: 1; width: 3.6" material=color:black text="width: 14; color: white; align: center; value: THE END"></a-entity><a-sky color=#000000></a-sky></a-entity><a-camera position="6 1 5.4" id=camera><a-entity id=cursor position="0 0 -1" geometry="primitive: ring; radiusOuter: 0.03; radiusInner: 0.02;" material="color: black; shader: flat" cursor="maxDistance: 30; fuse: true"><a-entity geometry="primitive: ring; radiusOuter: 0.035; radiusInner: 0.015;" material="color: white; shader: flat"></a-entity><a-animation begin=click easing=ease-in attribute=scale fill=backwards from="0.2 0.2 0.2" to="1 1 1" dur=150></a-animation><a-animation begin=fusing easing=ease-in attribute=scale fill=forwards from="1 1 1" to="0.2 0.2 0.2" dur=1500></a-animation></a-entity><a-entity id=light-point light="type: point; color: #000; intensity: 0.8" position="0 0 -1"><a-animation begin=light-on attribute=light.color from=#000 to=#FFF dur=1000></a-animation><a-animation begin=light-off attribute=light.color from=#FFF to=#000 dur=1000></a-animation></a-entity><a-entity position="0 -1 2"><a-box position="-1 0.5 0.3" rotation="-2 4 -19" scale="1 0.135 0.468" material=color:#4f4f4f geometry=""></a-box><a-box position="-1 -0.2 0.1" scale="1 0.135 0.4" material=color:#4f4f4f></a-box><a-box position="-1 -1 -0.2" rotation="9 -5 44" scale="1 0.13 0.4" material=color:#4f4f4f></a-box><a-box position="0.8 -0.8 -0.7" rotation="-2 12 -53" scale="1 0.13 0.4" material=color:#4f4f4f></a-box><a-box position="1 0 -0.26" scale="1 0.13 0.4" material=color:#4f4f4f></a-box><a-box position="1 0.5 -0.08" rotation="3 -3 18" scale="1 0.13 0.4" material=color:#4f4f4f></a-box><a-sphere position="0 -0.3 -0.1" scale="1 1.57 1" material=color:#333333;height:100 geometry=""></a-sphere><a-sphere position="-0.05 1.3 0.1" scale="0.5 0.5 0.5" material=color:#333333;height:100></a-sphere><a-sphere position="0.02 1.6 -0.3" scale="0.1 0.1 0.1" material=color:#ffffff;height:100></a-sphere><a-sphere position="-0.3 1.6 -0.2" scale="0.1 0.1 0.1" material=color:#ffffff;height:100></a-sphere><a-box></a-box><a-sphere></a-sphere></a-entity><a-entity id=camera-text visible=false position="0 -0.25 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: #333333" text="width:1; color: white; align: center; value: Oh God, my throat burns like hell. I need some water."></a-entity><a-entity id=help-text visible=false position="0 -0.5 -1.5" geometry="primitive: plane; height: 0.2; width: 1" material="color: white; opacity:0.5;" text="width:1; color: white; align: center; value: Gaze at the water to drink."></a-entity></a-camera></a-scene><script>function black_text(t){return{width:1,color:"black",align:"center",value:t}}function white_text(t){return{width:1,color:"white",align:"center",value:t}}function hide_tile(){for(var t=tile_array.length-1;t>=0;t--)tile_array[t].setAttribute("visible",!1)}function show_tile(){for(var t=tile_array.length-1;t>=0;t--)tile_array[t].setAttribute("visible",!0)}function set_event_plane(t,e){hide_tile(),action_text.removeEventListener("click",action_text_handler),action_text_primary.removeEventListener("click",action_text_primary_handler),action_text_secondary.removeEventListener("click",action_text_secondary_handler);var i=camera_plane.getAttribute("position"),r=camera_plane.getAttribute("rotation");if(event_plane.setAttribute("position",i),event_plane.setAttribute("rotation",r),"water"===t)document.querySelector("#water-cup-hand").setAttribute("visible",!0),event_text.setAttribute("visible",!0),action_text.setAttribute("visible",!0);else if("paper"===t){var n=document.querySelector("#envelope-hand");event_text.setAttribute("text",white_text("Enlistment paper? With my name on it?")),action_text.setAttribute("text",black_text("NEXT")),action_text_primary.setAttribute("text",black_text("READ DOCUMENT")),action_text_secondary.setAttribute("text",black_text("PUT BACK")),event_text.setAttribute("visible",!0),action_text_primary.setAttribute("visible",!0),action_text_secondary.setAttribute("visible",!0),n.setAttribute("visible",!0)}else if("phone"===t){var a=document.querySelector("#phone-hand");event_text.setAttribute("text",white_text("Someone unknown is calling. Maybe I should pick up the phone?")),action_text.setAttribute("text",black_text("PICK UP")),event_text.setAttribute("visible",!0),action_text.setAttribute("visible",!0),a.setAttribute("visible",!0)}else if("toilet_door_enter"===t)event_text.setAttribute("text",white_text("The door that leads to the toilet.")),action_text_primary.setAttribute("text",black_text("USE TOILET")),action_text_secondary.setAttribute("text",black_text("LEAVE")),event_text.setAttribute("visible",!0),action_text_primary.setAttribute("visible",!0),action_text_secondary.setAttribute("visible",!0);else if("toilet_door_leave"===t)event_text.setAttribute("text",white_text("The door that leads to the room.")),action_text_primary.setAttribute("text",black_text("LEAVE TOILET")),action_text_secondary.setAttribute("text",black_text("CANCEL")),action_text.setAttribute("visible",!1),event_text.setAttribute("visible",!0),action_text_primary.setAttribute("visible",!0),action_text_secondary.setAttribute("visible",!0);else if("front_door_enter"===t)event_text.setAttribute("text",white_text("Someone is knocking the door. It must be Jane.")),action_text.setAttribute("text",black_text("OPEN DOOR")),event_text.setAttribute("visible",!0),action_text.setAttribute("visible",!0);else if("mail"===t){document.querySelector("#mail-hand").setAttribute("visible",!0),event_text.setAttribute("text",white_text("There is an mail on the floor. Should I read it?")),action_text_primary.setAttribute("text",black_text("READ MAIL")),action_text_secondary.setAttribute("text",black_text("PUT BACK")),action_text.setAttribute("text",black_text("NEXT")),event_text.setAttribute("visible",!0),action_text_primary.setAttribute("visible",!0),action_text_secondary.setAttribute("visible",!0)}else if("free"===t){if(console.log(t,e),null!=e)document.querySelector(e).setAttribute("visible",!0);event_text.setAttribute("visible",!0),action_text.setAttribute("visible",!0)}}function reset_event_plane(){for(var t=event_plane.children,e=t.length-1;e>=0;e--)t[e].setAttribute("visible",!1);event_plane.setAttribute("position","0 0 -20"),event_plane.setAttribute("rotation","0 0 0"),"free"===finite_state&&show_tile()}function first_stage(){setTimeout((function(){camera_text.setAttribute("visible",!0),help_text.setAttribute("visible",!0)}),3e3)}function second_stage(){camera_text.setAttribute("visible",!0),camera_text.setAttribute("text",white_text("What is this place? Did I get too drunk and sleep over at someone’s place last night?")),show_tile(),help_text.setAttribute("visible",!0),help_text.setAttribute("text",white_text("Gaze at the floor tile to move, and explore the room.")),setTimeout((function(){camera_text.setAttribute("text",white_text("Why? I can't remember anything happened yesterday?"))}),5e3),setTimeout((function(){camera_text.setAttribute("text",white_text("I need to find out what this place is!")),help_text.setAttribute("text",white_text("Gaze at items to pick up, and explore the room."))}),1e4),setTimeout((function(){camera_text.setAttribute("visible",!1),help_text.setAttribute("visible",!1),finite_state="free"}),15e3)}function third_stage(){event_text.setAttribute("text",white_text('"John Doe would be serving the country in the Navy from '+current_date_string+" to "+future_date_string+'..."')),action_text.setAttribute("visible",!0)}var action_text_handler,action_text_primary_handler,action_text_secondary_handler,current_date=new Date,current_date_string=(current_date.getDate()+1).toString()+"/"+(current_date.getMonth()+1).toString()+"/"+current_date.getFullYear().toString(),future_date_string=current_date.getDate().toString()+"/"+(current_date.getMonth()+1).toString()+"/"+(current_date.getFullYear()+3).toString(),finite_state="start",camera_plane=document.querySelector("a-camera"),event_plane=document.querySelector("#event-plane"),event_text=document.querySelector("#event-text"),action_text=document.querySelector("#action-text"),action_text_primary=document.querySelector("#action-text-primary"),action_text_secondary=document.querySelector("#action-text-secondary"),camera_text=document.querySelector("#camera-text"),help_text=document.querySelector("#help-text"),tile_array=document.getElementsByClassName("tile"),third_stage_state=1,fourth_stage_state=1,fifth_stage_state=1,mail_show=!1,extra_stage_state=1;hide_tile()</script>