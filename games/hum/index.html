<!doctype html><title>Hum - js13kGames 2012</title><style>*{font-family:"Arial Rounded MT Bold","Helvetica Rounded",Arial,sans-serif;padding:0;margin:0}body,html{height:100%}.background{position:absolute;left:0;width:100%;height:50%}.background.top{top:0;background:#e99825}.background.bottom{bottom:0;background:#999b0f;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwAgMAAAAqbBEUAAAACVBMVEWeoA+oqhWhoxA1CZwJAAAAR0lEQVR4XqXNoREAMQwDQZOQ708k1YWYbJU/mZRgpFmRK6ey6WAO6NR3PYeOU8AcSPJSc9S68645dOAU5kC2WtGZIxt0MMYP3a8elos0uwIAAAAASUVORK5CYII=)}#outer-wrapper{position:absolute;top:50%;left:0;width:100%;height:480px;margin-top:-240px;background-color:#e99825;background-image:-webkit-gradient(linear,left top,left bottom,from(#e99825),to(#e92553));background-image:-webkit-linear-gradient(top,#e99825,#e92553);background-image:-moz-linear-gradient(top,#e99825,#e92553);background-image:-o-linear-gradient(top,#e99825,#e92553);background-image:linear-gradient(to bottom,#e99825,#e92553)}#inner-wrapper{position:absolute;top:0;left:50%;width:640px;height:100%;margin-left:-320px}#end,#intro{display:none;position:absolute;top:70px;left:50px;width:500px;height:300px;background:#f7eaab;color:#331308;padding:20px 25px}h1{margin-bottom:.5em}dl,p{margin-bottom:1em}p{line-height:1.3em}button{clear:both;display:block;background:#f5e287;border:1px outset #e9b03f;padding:6px 12px;cursor:pointer}button:active{border-style:inset}dl{overflow:hidden}dt{clear:both;float:left;width:220px;margin-bottom:5px}dd{float:left;color:#6b4e16}span.key{display:inline-block;background:#f5e287;padding:0 4px;border:1px outset #fc6}#ui{position:relative;width:640px;margin:0 auto}#energy,#remaining{z-index:5000;display:none;position:absolute;top:6px;right:6px;width:150px;height:28px;background:red}#energy:after{z-index:5005;content:'';display:block;position:absolute;top:0;left:0;width:100%;height:100%;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABEAAAAYAgMAAABhDP6hAAAACVBMVEUAAAD/0wP/3Tr3Rb5mAAAAAXRSTlMAQObYZgAAACtJREFUeF5jYGBg0GJAJZmWOqCSDCsDGFBJrdBQB1SSITQ0FJUkbA6m1QwANGkSdpp2zQAAAAAASUVORK5CYII=);background-repeat:no-repeat;background-position:center center}#remaining{display:block;top:0;left:0;background:#fff}#weight{z-index:5000;display:none;position:absolute;top:45px;right:6px;width:42px;height:18px;font-size:13px;background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADQAAAASBAMAAADmo+DzAAAAElBMVEUAAACJiYl9fX10dHRpaWmSkpKdhCwvAAAAAXRSTlMAQObYZgAAACtJREFUeF5jAAMlMAAzEdxBJWUMBoKCgqGhoYKCghDuoJJyAQMwE8EdJFIAQI8zZ2sUeUsAAAAASUVORK5CYII=);background-repeat:x;background-position:center right}#clouds{overflow:hidden;position:absolute;top:0;left:0;width:100%;height:100%}.cloud{z-index:100;width:200px;height:60px;background:#f7eaab;border-radius:200px;-moz-border-radius:200px;-webkit-border-radius:200px;position:absolute}.cloud:after,.cloud:before{content:'';position:absolute;background:#f7eaab;width:100px;height:80px;position:absolute;top:-15px;left:10px;border-radius:100px;-moz-border-radius:100px;-webkit-border-radius:100px;-webkit-transform:rotate(30deg);transform:rotate(30deg);-moz-transform:rotate(30deg)}.cloud:after{width:120px;height:120px;top:-55px;left:auto;right:15px}.x1{top:12%;left:20%;-webkit-animation:moveclouds 160s linear infinite;-moz-animation:moveclouds 160s linear infinite}.x2{top:15%;left:50%;-webkit-transform:scale(.6);-moz-transform:scale(.6);transform:scale(.6);opacity:.6;-webkit-animation:moveclouds 80s linear infinite;-moz-animation:moveclouds 80s linear infinite}.x3{top:8%;left:80%;-webkit-transform:scale(.8);-moz-transform:scale(.8);transform:scale(.8);opacity:.8;-webkit-animation:moveclouds 120s linear infinite;-moz-animation:moveclouds 120s linear infinite}.x4{top:15%;left:25%;-webkit-transform:scale(.7);-moz-transform:scale(.7);transform:scale(.7);opacity:.8;-webkit-animation:moveclouds 150s linear infinite;-moz-animation:moveclouds 150s linear infinite}.x5{top:2%;left:-3%;-webkit-transform:scale(.7);-moz-transform:scale(.7);transform:scale(.7);opacity:.7;-webkit-animation:moveclouds 110s linear infinite;-moz-animation:moveclouds 110s linear infinite}@-webkit-keyframes moveclouds{0%{margin-left:100%}100%{margin-left:-100%}}@-moz-keyframes moveclouds{0%{margin-left:100%}100%{margin-left:-100%}}</style><div class="background top"></div><div class="background bottom"></div><div id=clouds><div class="cloud x1"></div><div class="cloud x2"></div><div class="cloud x3"></div><div class="cloud x4"></div><div class="cloud x5"></div></div><div id=ui><div id=weight></div><div id=energy><span id=remaining></span></div></div><div id=outer-wrapper><div id=inner-wrapper><canvas height=480 id=stage width=640></canvas><div id=intro><h1>Hum</h1><p>Roger is a very hungry hummingbird. He needs nectar, pronto. He launches into the air on his tiny wings, sipping from flower to flower.<p><small>Roger must flap his wings quickly with the <span class=key>space</span> bar. Use the <span class=key>←</span> & <span class=key>→</span> keys to move Roger. Position his beak right in the middle of a flower, where the nectar is plentiful.</small></p><button id=begin>Begin</button></div><div id=end><h1>Hum</h1><p>Poor Roger. He just couldn't flap any longer.<dl><dt>Time aloft<dd id=end-time><dt>Roger's weight<dd id=end-weight><dt>Roger's favourite flower<dd id=end-color></dl><button id=again>Play Again</button></div></div></div><script>var i,e,h,s,n,r,o,a,l,g,d,c,w,u,y,f,p,m,A,v,t;function R(t){this.id=A.Utils.getGuid(),this.zIndex=this.id+15,this.width=this.height=A.Utils.getRandomInt(8,18),this.hsl={},this.hslStringFlower=null,this.hslStringPetal=null,this.rotate=A.Utils.getRandomInt(1,180),this.originatingX=0,this.stalkRGB={r:79,g:140,b:17},this.stalkCurve={x:A.Utils.getRandomInt(-50,50),y:A.Utils.getRandomInt(50,100)},this.stalkThickness=this.width/6,this.stalkOpacity=1,this.x=0,this.y=0,this.targetY=0,this.targetX=0,this.positionBuffer=70,this.growSpeed=1,this.dieSpeed=3,this.dieXRange=10,this.dieAngle=0,this.finalY=0,this.nectar=100,this.decayRate=.05,this.growing=!1,this.dying=!1,this._init()}function I(){this.id=v.Utils.getGuid(),this.zIndex=9999,this.width=this.originalWidth=80,this.height=this.originalHeight=80,this.sprite=new Image,this.sprite.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAPAAAABQCAMAAAAQlwhOAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2ZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMC1jMDYxIDY0LjE0MDk0OSwgMjAxMC8xMi8wNy0xMDo1NzowMSAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDoyMEQ3NzYyRDk1RkNFMTExOTdCOUNCMjM5MkMwQ0Y3OCIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo1NzdFMDI4OUZDQTcxMUUxQTVEOUNFRkRCQUMwQTdCMCIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo1NzdFMDI4OEZDQTcxMUUxQTVEOUNFRkRCQUMwQTdCMCIgeG1wOkNyZWF0b3JUb29sPSJBZG9iZSBQaG90b3Nob3AgQ1M1LjEgV2luZG93cyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOkJFOUE2RTQzOUJGQ0UxMTE5N0I5Q0IyMzkyQzBDRjc4IiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjIwRDc3NjJEOTVGQ0UxMTE5N0I5Q0IyMzkyQzBDRjc4Ii8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+Kc9JJwAAAB5QTFRFOzs7is0jQkJCALT/Pj4+MzMzc68VfLobgcAfAAAAJ8LRrQAAAAp0Uk5T////////////ALLMLM8AAADOSURBVHja7NbLDsIgFEXR+mrr//+wyWVCQkrBgUG69og08ciaVJf3xVqAgYGBgYGBgYGBgYGBgYGBgScF36I9ys+p/q8ZZw8YGBj4v8Fr9IjSx/PzetDZBVv2esD1PWBgYOAZwUvRK9qi/LW/ZVWmG/bSuY3dsgcMDAw8Lzgvv85e1P9n/1d7wMDAwFcCl539FNUvOMIeMDAw8Azg1DMqn3x7zRH2gIGBgecB36P6k55G2AMGBgaeBzxjwMDAwMDAwMDAwMDAwMDAF+gjwADrSXDr2PaazQAAAABJRU5ErkJggg==",this.frames=3,this.curFrame=0,this.frameLimiter=2,this.weight=2,this.lift=.2,this.speed=1.5,this.hunger=2,this.energy=100,this.x=0,this.y=0,this.xAccel=0,this.yAccel=.02,this.maxYUpAccel=2.5,this.flower=null,this.flowerSippingTimer=null,this.flowerTargetTimer=null,this.drainRate=2,this.lastWeightDisplayed=0}function M(t,i){return Math.floor(Math.random()*(i-t+1))+t}window.requestAnimFrame=requestAnimationFrame,t=0,window.Utils={getGuid:function(){return t+=1},getRandomInt:M,getRandomColor:function(t,i){return{hue:M(1,360),saturation:t,lightness:i}},removeObjFromArray:function(t,i){for(var e=0,s=t.length;e<s;e++)if(t[e].id===i.id)return t.splice(e,1),!0;return!1},sortByZIndex:function(t,i){return t.zIndex-i.zIndex},secondsToTime:function(t){var t=parseInt(t,10),i=Math.floor(t/3600),e=Math.floor((t-3600*i)/60);return{h:i<10?"0"+i:i,m:e<10?"0"+e:e,s:t=(t=t-3600*i-60*e)<10?"0"+t:t}},getHSLString:function(t){return"hsl("+t.hue+", "+t.saturation+"%, "+t.lightness+"%)"}},v=window,I.prototype.setPos=function(t){this.x=t.x,this.y=t.y},I.prototype.getPos=function(){return pos},I.prototype.update=function(){this.yAccel+=this.weight/100;var t=this.x+this.xAccel,i=this.y+this.yAccel;i+this.height<0&&(i=this.y,this.yAccel=0),i-this.height>v.Canvas.height&&v.Game.end(),(t=t<0?0:t)>v.Canvas.width-this.width&&(t=v.Canvas.width-this.width),this.x=t,this.y=i,this._logic()},I.prototype.draw=function(){var t=v.Canvas.context,i=Math.floor(this.curFrame/this.frameLimiter);t.drawImage(this.sprite,this.originalWidth*i,0,this.originalWidth,this.originalHeight,this.x,this.y,this.width,this.height),this.curFrame++,this.curFrame>=this.frames*this.frameLimiter&&(this.curFrame=0),null!==this.flower&&(t.save(),t.fillStyle="#e61752",t.fillRect(this.x+4,this.y+32,6,6),t.restore())},I.prototype._logic=function(){for(var t=v.Flower.flowers,i=null,e=0,s=t.length;e<s;e++){var h={x:this.x+10,y:this.y+32};if(t[e].isNear(h)){i=t[e],this._targetFlower(i);break}}null===i&&null!==this.flower&&(this.flower=null,clearTimeout(this.flowerTargetTimer),clearTimeout(this.flowerSippingTimer)),this.lastWeightDisplayed+.1<this.weight&&(this.lastWeightDisplayed=this.weight,v.UI.displayWeight(this.weight))},I.prototype.flap=function(){var t;this.y<0||(this.energy-=.3,this._capAndDisplayEnergy(),t=this.yAccel-(this.lift-(100-this.energy)/600+.001*this.y),this.y-=5*this.lift,t<-this.maxYUpAccel)||(this.yAccel=t)},I.prototype.left=function(){this.x-=this.speed},I.prototype.right=function(){this.x+=this.speed},I.prototype._targetFlower=function(t){var i=this;this.flower!==t&&(this.flower=t,this.flowerTargetTimer=setTimeout(function(){i._sipFlower()},200))},I.prototype._sipFlower=function(){var t=this;null!==this.flower&&(this.flower.drain(this.drainRate),this.weight+=this.drainRate/800,this.energy+=.6,this._capAndDisplayEnergy(),this.flowerSippingTimer=setTimeout(function(){t._sipFlower()},50))},I.prototype._capAndDisplayEnergy=function(){this.energy<0&&(this.energy=0),100<this.energy&&(this.energy=100),v.UI.displayEnergy(this.energy)},v.Bird=I,A=window,R.prototype.update=function(){var t;this.growing?this.y>this.targetY?(t=this.y-this.targetY,this.y-=this.growSpeed/5+this.growSpeed*(t/50)):(this.finalY=this.targetY,this.growing=!1):this.dying&&(this.y<this.targetY+2*this.height?(this.x=this.targetX+Math.sin(this.dieAngle)*this.dieXRange,this.y+=this.dieSpeed,this.dieAngle+=.1):(this.dying=!1,this._remove())),this.dying&&(this.rotate+=.05),this.drain(this.decayRate)},R.prototype.draw=function(){var t=A.Canvas.context,i=(this.dying||(t.save(),t.beginPath(),t.fillStyle="#999b0f",t.arc(this.originatingX,A.Canvas.height+2,this.width/2,0,2*Math.PI,!0),t.fill(),t.restore()),t.save(),this.x),e=this.y,s=(this.dying&&(0<this.stalkOpacity&&(this.stalkOpacity-=.04,this.stalkOpacity<0)&&(this.stalkOpacity=0),i=this.targetX,e=this.finalY),t.strokeStyle="rgba("+this.stalkRGB.r+", "+this.stalkRGB.g+", "+this.stalkRGB.b+", "+this.stalkOpacity+")",t.lineWidth=this.stalkThickness,t.beginPath(),this.dying?A.Canvas.height:A.Canvas.height-this.height/2+3);t.moveTo(this.originatingX,s),t.quadraticCurveTo(i+this.stalkCurve.x,e+this.stalkCurve.y,i,e),t.stroke(),t.restore(),t.save(),t.translate(this.x+this.width/2,this.y+this.width/2),t.rotate(this.rotate),t.translate(-this.width/2,-this.width/2),t.save(),t.fillStyle=this.hslStringFlower,t.fillRect(0,0,this.width,this.height),t.restore(),t.save(),t.fillStyle=this.hslStringPetal,t.fillRect(0,1-this.height,this.width,this.height),t.fillRect(this.width-1,0,this.width,this.height),t.fillRect(0,this.height-1,this.width,this.height),t.fillRect(1-this.width,0,this.width,this.height),t.restore(),t.restore()},R.prototype._randomPosition=function(){var t=A.Utils.getRandomInt(this.positionBuffer/2,A.Canvas.width-this.positionBuffer),i=A.Utils.getRandomInt(this.positionBuffer,A.Canvas.height-this.positionBuffer);return this.x=this.targetX=t,this.y=A.Canvas.height,this.originatingX=A.Utils.getRandomInt(t-2*this.width,t+2*this.width),{x:t,y:i}},R.prototype._randomFlowerColor=function(){this.hsl=A.Utils.getRandomColor(70,50)},R.prototype._updateColor=function(){this.hslStringFlower=A.Utils.getHSLString(this.hsl),this.hslStringPetal=A.Utils.getHSLString({hue:this.hsl.hue,lightness:this.hsl.lightness-10,saturation:this.hsl.saturation})},R.prototype._remove=function(){if(A.Game.removeFromUpdate(this),A.Game.removeFromDraw(this),!A.Utils.removeObjFromArray(A.Flower.flowers,this))throw new Error("Failed to remove the flower from the root.Flower.flowers array.")},R.prototype._init=function(){this._randomFlowerColor(),this._updateColor(),A.Flower.flowers.push(this),this.grow()},R.prototype.isNear=function(t){return!(t.x<this.x||t.y<this.y||t.x>this.x+this.width||t.y>this.y+this.height)},R.prototype.grow=function(){var t=this._randomPosition();this.targetY=t.y,this.growing=!0},R.prototype.die=function(){this.targetY=A.Canvas.height,this.dying=!0},R.prototype.drain=function(t){this.nectar-=t,this.nectar<=0&&this.die(),t=100-this.nectar+40,this.hsl.lightness=t=90<t?90:t,this._updateColor()},R.flowers=[],A.Flower=R,s=[],r=!(n=[]),g=l=a=o=null,d=function(t){r||(requestAnimFrame(d),!0===t&&(r=!0),c(),w(),u())},c=function(){k.isDown(k.LEFT)&&l.left(),k.isDown(k.RIGHT)&&l.right(),k.isPreserved(k.SPACE)&&l.flap(),null===o&&(o=setTimeout(function(){var t;clearTimeout(o),o=null,1===i.Utils.getRandomInt(1,3)&&i.Flower.flowers.length<15&&(t=new i.Flower,f(t),p(t))},i.Utils.getRandomInt(200,1e3)))},w=function(){for(var t=0,i=s.length;t<i;t++){var e=s[t];null!=e&&e.update()}},u=function(){var t=h.context;t.clearRect(0,0,h.width,h.height),t.save(),t.beginPath(),t.fillStyle="rgba(225,157,12,.5)",t.arc(105,105,100,0,2*Math.PI,!0),t.fill(),t.restore(),t.save(),t.fillStyle=g,t.fillRect(0,0,300,300),t.restore();for(var i=0,e=n.length;i<e;i++){var s=n[i];null!=s&&s.draw()}},y=function(){window.addEventListener("keyup",function(t){k.onKeyup(t)},!1),window.addEventListener("keydown",function(t){k.onKeydown(t)},!1)},f=function(t){s.push(t)},p=function(t){n.push(t),n.sort(i.Utils.sortByZIndex)},m={init:function(t){e=document.getElementById("stage"),h={context:e.getContext("2d"),width:e.width,height:e.height},(g=h.context.createRadialGradient(140,140,20,100,100,100)).addColorStop(0,"rgba(240,217,19,1)"),g.addColorStop(.98,"rgba(240,196,19,.9)"),g.addColorStop(1,"rgba(240,196,19,0)"),i.Canvas=m.getCanvas(),y(),l=new i.Bird,f(l),p(l),l.setPos({x:300,y:h.height}),l.yAccel=-4,i.UI.showIntro()},start:function(t){r=!1,d(t=t||!1),a=(new Date).getTime()},end:function(){var t=i.Utils.secondsToTime(((new Date).getTime()-a)/1e3);r=!0,i.UI.showEnd({time:t,weight:l.weight})},removeFromDraw:function(t){if(!i.Utils.removeObjFromArray(n,t))throw new Error("Failed to remove an object from the _toDraw array.")},removeFromUpdate:function(t){if(!i.Utils.removeObjFromArray(s,t))throw new Error("Failed to remove an object from the _toUpdate array.")},getCanvas:function(){return h}},(i=window).Game=m;var U,F,G,x,b,k={_pressed:{},_preserved:{},SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,isDown:function(t){return this._pressed[t]},isPreserved:function(t){return void 0!==this._preserved[t]&&(delete this._preserved[t],!0)},onKeydown:function(t){this._pressed[t.keyCode]=!0},onKeyup:function(t){t.keyCode===k.SPACE&&(this._preserved[t.keyCode]=!0),delete this._pressed[t.keyCode]}};function C(t){return document.getElementById(t)}function S(t){t.style.display="block"}function D(t){t.style.display="none"}U=window,F=C("intro"),G=C("weight"),x=C("energy"),b=["Blue","Red","Pink","Yellow","Orange","Teal","Magenta","Gold","Cyan"],U.UI={showIntro:function(){S(F),C("begin").addEventListener("click",function(t){setTimeout(function(){D(F),S(G),S(x),U.Game.start(!1)},100)},!1)},showEnd:function(t){D(G),D(x);var i=b[U.Utils.getRandomInt(0,b.length-1)],e=C("end-color"),s=Math.floor(5*t.weight);C("end-time").innerHTML=t.time.m+":"+t.time.s,C("end-weight").innerHTML=s+" grams",e.innerHTML=i,e.style.color=i,S(C("end")),C("again").addEventListener("click",function(t){document.location.reload(!0)},!1)},displayWeight:function(t){t=Math.ceil(25*t),G.style.width=t+"px"},displayEnergy:function(t){C("remaining").style.width=Math.floor(1.5*t)+"px"}},Game.init(),Game.start(!0)</script>