<!doctype html><title>Fly South</title><script src=/2017/webxr/aframe.js></script><body class=a-body><a-scene class=fullscreen canvas vr-mode-ui fog="type: exponential; color: #87CEFA; density: 0.02;"><a-assets><a-plane id=street material=color:#333;></a-plane><a-box id=building material="color:#a1b7dc; metalness:0.3;"></a-box><a-circle id=moon position="3000 700 0" rotation="10 -90 0" geometry="radius: 250" material="shader: flat; color: #ddd; fog: false"></a-circle><a-entity id=level1><a-entity id=streets position="0 0.3 0"></a-entity><a-entity id=buildings></a-entity><a-entity id="park 1" position="325 0.3 325"><a-plane color=#2cb037 position="0 0 0" geometry="primitive: plane; height: 45; width: 45" rotation="270 0 0"></a-plane><a-circle color=#d9c4aa position="0 0.1 0" geometry="primitive: circle; radius: 10" rotation="270 0 0"></a-circle><a-entity position="7 0 9"><a-box position="0 0.5 0" open-ended=true material=color:#6B4226;></a-box><a-cone id=tree position="0 6 0" color=#143306 radius-bottom=2 height=10 segments-height=2 segments-radial=4></a-cone></a-entity><a-entity position="-4 0 -20"><a-box position="0 2 0" open-ended=true height=4 material=color:#6B4226;></a-box><a-box position="0 6 0" open-ended=true width=4 height=4 depth=4 material=color:#143306;></a-box></a-entity></a-entity><a-entity id="park 2" position="325 0.3 275"><a-plane color=#2cb037 position="0 0 0" geometry="primitive: plane; height: 45; width: 45" rotation="270 0 0"></a-plane><a-entity position="-10 0 -18"><a-box position="0 2 0" open-ended=true height=4 material=color:#6B4226;></a-box><a-box position="0 6 0" open-ended=true width=4 height=4 depth=4 material=color:#143306;></a-box></a-entity><a-entity position="5 0 10"><a-box position="0 2 0" open-ended=true height=4 material=color:#6B4226;></a-box><a-box position="0 6 0" open-ended=true width=4 height=4 depth=4 material=color:#143306;></a-box></a-entity></a-entity><a-entity id=intro-room><a-entity id=intro-1><a-text position="0 2 -3" align=center color=black value="You are a goose and it's getting cold."></a-text><a-text position="0 1.7 -3" opacity=0.5 align=center color=black value="Turn right --->"></a-text></a-entity><a-entity id=intro-2><a-text position="3 2 0" rotation="0 -90 0" align=center color=black value="The other geese left for south but you are still hungry."></a-text><a-text position="3 1.7 0" opacity=0.5 rotation="0 -90 0" align=center color=black value="--->"></a-text></a-entity><a-entity id=intro-3><a-text position="0 2 3" rotation="0 180 0" align=center color=black value="Find the central park and land."></a-text><a-text position="0 1.7 3" opacity=0.5 rotation="0 180 0" align=center color=black value="--->"></a-text></a-entity><a-entity id=intro-4><a-text position="-3 2 0" rotation="0 90 0" align=center color=black value="Look up to take off."></a-text><a-text position="-3 1.7 0" opacity=0.5 rotation="0 90 90" align=center color=black value="--->"></a-text></a-entity></a-entity><a-entity id=park-room position="10000 -1000 0"><a-entity id=park-1><a-text position="0 2 -3" align=center color=black value="Yummy! Breadcrumbs!"></a-text><a-text position="0 1.7 -3" align=center color=black value="Now take off to the cloud above you."></a-text><a-text position="0 1.4 -3" opacity=0.5 rotation="0 0 90" align=center color=black value="--->"></a-text></a-entity><a-entity id=park-2><a-text position="0 2 3" rotation="0 180 0" align=center color=black value="Yummy! Breadcrumbs!"></a-text><a-text position="0 1.7 3" rotation="0 180 0" align=center color=black value="Now take off to the cloud above you."></a-text><a-text position="0 1.4 3" opacity=0.5 rotation="0 180 90" align=center color=black value="--->"></a-text></a-entity></a-entity><a-entity id=portal-cloud position="10000 -1000 0"><a-sphere scale="10 4 10" opacity=0.4 material="shader: flat; color: #fff" transparent=true></a-sphere><a-box scale="6 2 6" material="shader: flat; color: #001848"></a-box></a-entity><a-light type=directional color=#fff intensity=0.2 position="-1 2 1" light=""></a-light><a-light type=ambient color=#fff light=""></a-light><a-plane id=ground color=#ccf position="0 -0.1 0" geometry="primitive: plane; height: 5000; width: 5000" rotation="270 0 0"></a-plane><a-sky material="shader: flat; color: #000" geometry="radius: 4000" segments-height=2 segments-width=4></a-sky><a-circle id=sun position="200 1700 -200" rotation="85 -90 0" geometry="radius: 100" material="shader: flat; color: #fff; fog: false"></a-circle></a-entity><a-entity id=level2><a-entity id=clouds rotation="0 45 0"></a-entity><a-sky material="shader: flat; color: #001848; fog: false" geometry="radius: 5000" segments-height=2 segments-width=4></a-sky><a-light position="5 5 0" light="color: #fff; intensity: 1; type: directional"></a-light></a-entity></a-assets><a-entity id=world></a-entity><a-entity id=player><a-camera id=camera far=10000></a-camera></a-entity></a-scene><script>"use strict";function randomInt(t,e){return Math.floor(Math.random()*(e-t+1))+t}function clearChildren(t){for(;t.firstChild;)t.removeChild(myNode.firstChild)}const BLOCKS=10,BLOCKSIZE=50,BLG_MIN_HEIGHT=10,BLG_MAX_HEIGHT=60,GOOSE_HEIGHT=.4;var currentStage,scene=document.querySelector("a-scene"),ground=document.getElementById("ground"),sky=document.querySelector("a-sky"),streets=document.getElementById("streets"),buildings=document.getElementById("buildings"),clouds=document.getElementById("clouds"),cloudPortal=document.getElementById("clouds"),intro=document.getElementById("intro-room"),parkRoom=document.getElementById("park-room"),portalCloud=document.getElementById("cloud-portal"),player=document.getElementById("player"),player_animation=document.getElementById("player_animation"),camera=document.getElementById("camera"),flyingBlocked=!0,portalActive=!1;function startLevel1(){world.appendChild(level1),currentStage=INTRO,flyingBlocked=!0,setTimeout((()=>flyingBlocked=!1),1e3),continueStanding();const t=50*randomInt(1,10),e=50*randomInt(1,10);player.object3D.position.set(t,GOOSE_HEIGHT,e),intro.setAttribute("position",{x:t,y:0,z:e}),clearChildren(streets),clearChildren(buildings);for(let t=0;t<11;t++){const e=500;addStreet(createStreet([50*t,0],[50*t,e],6)),addStreet(createStreet([0,50*t],[e,50*t],6))}for(let t=0;t<10;t++)for(let e=0;e<10;e++){if(6===t&&(5===e||6===e))continue;const n=50*t+25,o=50*e+25,i=40,r=50*Math.random()+10;addBuilding(createBuilding([n,o],i,i,r))}}function startLevel2(){world.removeChild(level1),world.appendChild(level2),player.object3D.position.set(x,0,z),clearChildren(streets),clearChildren(buildings);for(let t=0;t<100;t++){const t=document.getElementById("cloud").cloneNode(!0);t.setAttribute("position",{x:200*Math.random(),y:2*Math.random(),z:80*Math.random()}),t.setAttribute("rotation",{x:20*Math.random(),y:360*Math.random(),z:0}),t.setAttribute("scale",{x:20*Math.random()+2,y:2*Math.random()+1,z:20*Math.random()+2}),clouds.appendChild(t)}}function startLevel3(){player.object3D.position.set(x,GOOSE_HEIGHT,z)}function createStreet([t,e],[n,o],i=5){const r=document.getElementById("street").cloneNode(!0),a=n-t,l=o-e,d=t+a/2,s=e+l/2,c=Math.hypot(a,l);r.setAttribute("height",c),r.setAttribute("width",i),r.setAttribute("position",{x:d,y:0,z:s});const u=180*Math.atan2(l,a)/Math.PI;return r.setAttribute("rotation",{x:270,y:0,z:u+90}),r}function createBuilding([t,e],n,o,i){const r=document.getElementById("building").cloneNode(!0);return r.setAttribute("width",n),r.setAttribute("depth",o),r.setAttribute("height",i),r.setAttribute("position",{x:t,y:i/2,z:e}),r}const addStreet=t=>streets.appendChild(t),addBuilding=t=>buildings.appendChild(t),INTRO=0,FLYING=2;function continueStanding(){if(lastTimestamp){lastTimestamp=null;const t=player.object3D.position;t.x>310&&t.x<390&&t.z>310&&t.z<340&&(parkRoom.setAttribute("position",t),portalActive=!0,portalCloud.setAttribute("position",{x:350,y:60,z:325}))}setTimeout(standingLoop,100)}function continueFlying(){requestAnimationFrame(flyingingLoop)}function standingLoop(){if(!flyingBlocked){if(camera.getAttribute("rotation").x>85)return currentStage=FLYING,continueFlying(),void scene.setAttribute("fog",{density:.01})}continueStanding()}function flyingingLoop(t){lastTimestamp||(lastTimestamp=t);const e=(t-lastTimestamp)/1e3;lastTimestamp=t;let n=player.getAttribute("position");player.object3D.rotation;const o=camera.getAttribute("rotation");if(player.setAttribute("rotation",o),player.object3D.translateZ(-5*e),player.setAttribute("rotation",{x:0,y:0,z:0}),n=player.object3D.position,n.y<GOOSE_HEIGHT)return player.object3D.position.set(n.x,GOOSE_HEIGHT,n.z),continueStanding(),void scene.setAttribute("fog",{density:.02});portalActive&&n.x>347&&n.x<353&&n.y>59&&n.y<61&&n.z>323&&n.z<328&&startLevel2(),continueFlying()}var lastTimestamp=null;setTimeout((()=>startLevel1()))</script>