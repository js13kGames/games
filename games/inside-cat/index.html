<script src=/2025/webxr/aframe.js></script><script>zzfx=(...t)=>zzfxP(zzfxG(...t)),zzfxP=(...t)=>{let e=zzfxX.createBufferSource(),i=zzfxX.createBuffer(t.length,t[0].length,zzfxR);return t.map((t,e)=>i.getChannelData(e).set(t)),e.buffer=i,e.connect(zzfxX.destination),e.start(),e},zzfxG=(t=1,e=.05,i=220,o=0,r=0,n=.1,a=0,s=1,c=0,p=0,l=0,d=0,u=0,h=0,g=0,m=0,A=0,f=1,b=0,y=0)=>{let v,w,E=2*Math.PI,L=c*=500*E/zzfxR**2,q=(0<g?1:-1)*E/4,x=i*=(1+2*e*Math.random()-e)*E/zzfxR,j=[],R=0,_=0,T=0,M=1,z=0,k=0,S=0;for(o=99+zzfxR*o,b*=zzfxR,r*=zzfxR,n*=zzfxR,A*=zzfxR,p*=500*E/zzfxR**3,g*=E/zzfxR,l*=E/zzfxR,d*=zzfxR,u=zzfxR*u|0,w=o+b+r+n+A|0;T<w;j[T++]=S)++k%(100*m|0)||(S=a?1<a?2<a?3<a?Math.sin((R%E)**3):Math.max(Math.min(Math.tan(R),1),-1):1-(2*R/E%2+2)%2:1-4*Math.abs(Math.round(R/E)-R/E):Math.sin(R),S=(u?1-y+y*Math.sin(2*Math.PI*T/u):1)*(0<S?1:-1)*Math.abs(S)**s*t*zzfxV*(T<o?T/o:T<o+b?1-(T-o)/b*(1-f):T<o+b+r?f:T<w-A?(w-T-A)/n*f:0),S=A?S/2+(A>T?0:(T<w-A?1:(w-T)/A)*j[T-A|0]/2):S),v=(i+=c+=p)*Math.sin(_*g-q),R+=v-v*h*(1-1e9*(Math.sin(T)+1)%2),_+=v-v*h*(1-1e9*(Math.sin(T)**2+1)%2),M&&++M>d&&(i+=l,x+=l,M=0),!u||++z%u||(i=x,c=L,M=M||1);return j},zzfxV=.3,zzfxR=44100,zzfxX=new(window.AudioContext||webkitAudioContext);let t,e,o,r=((t,e,i,o=125)=>{let r,n,a,s,c,p,l,d,u,h,g,m,A,f,b,y=0,v=[],w=[],E=[],L=0,q=0,x=1,j={},R=zzfxR/o*60>>2;for(;x;L++)v=[x=d=g=A=0],i.map((o,g)=>{for(l=e[o][L]||[0,0,0],x|=!!e[o][L],b=A+(e[o][0].length-2-!d)*R,f=g==i.length-1,n=2,s=A;n<l.length+f;d=++n){for(c=l[n],u=n==l.length+f-1&&f||h!=(l[0]||0)|c|0,a=0;a<R&&d;a++>R-99&&u?m+=(m<1)/99:0)p=(1-m)*v[y++]/2||0,w[s]=(w[s]||0)-p*q+p,E[s]=(E[s++]||0)+p*q+p;c&&(m=c%1,q=l[1]||0,(c|=0)&&(v=j[[h=l[y=0]||0,c]]=j[[h,c]]||(r=[...t[h]],r[2]*=2**((c-12)/12),c>0?zzfxG(...r):[])))}A=b});return[w,E]})([[,0,23,,.15,.2,3,5],[3,0,43,,,.25,,,,,,,,2],[,0,655,,,.09,3,1.65,,,,,.02,3.8,-.1,,.2],[.4,0,2100,,,.2,3,3,,,-400,,,2],[.5,0,740,,.15,.15,2,.2,,-.15,9,,,.1,.12,,.06]],[[[,,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,12,12,12,12,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,,,,,],[1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],[2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,12,,,,],[3,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,22,20,18]],[[,,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,12,12,12,12,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,,,,,],[1,,12,,,,,,,,12,,12,,,,,,12,,,,,,12,,12,,,,,,,,12,,,,,,,,12,,12,,,,,,12,,,,,,12,,12,,,,,,,,],[2,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,],[,1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,12,12,12,12,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,,,,,],[1,,12,,,,,,,,12,,12,,,,,,12,,,,,,12,,12,,,,,,,,12,,,,,,,,12,,12,,,,,,12,,,,,,12,,12,,,,,,,,],[2,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,],[4,,12,,,,,,,,5,,,,10,,,,,,,,8,,,,7,,,,,,,,5,,,,12,,,,,,,,,,,,3,,,,3,,,,7,,,,7,,,,]],[[,,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,12,12,12,12,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,,,,,],[1,,12,,,,,,,,12,,12,,,,,,12,,,,,,12,,12,,,,,,,,12,,,,,,,,12,,12,,,,,,12,,,,,,12,,12,,,,,,,,],[2,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,],[4,,12,,,,,,,,5,,,,10,,,,,,,,8,,,,7,,,,,,,,5,,,,12,,,,,,,,,,,,3,,,,3,,,,7,,,,7,,,,]],[[,,10,,,,,,,,8,,,,10,,,,,,,,,,,,,,,,10,10,10,10,12,,,,,,,,,,,,10,,,,12,,,,,,,,,,,,,,,,],[4,,3,,,,,,,,3,,,,3,,,,7,,,,5,,,,3,,,,10,8,7,5,3,,,,,,,,,,,,8,,,,10,,,,,,,,,,,,,,,,],[1,,12,,,,,,,,12,,12,,,,,,12,,,,,,12,,12,,,,,,,,12,,,,,,,,12,,12,,,,,,12,,,,,,12,,12,,,,,,,,],[2,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,,,,,12,,,,],[4,,10,,,,,,,,8,,,,10,,,,,,,,8,,,,7,,,,,,,,8,,,,12,,,,,,,,,,,,3,,,,3,,,,7,,,,7,,,,]]],[0,1,2,3,4,2],150),n=new Audio("data:audio/mp3;base64,SUQzBAAAAAAAIlRTU0UAAAAOAAADTGF2ZjU4LjIuMTAzAAAAAAAAAAAAAAD/40DAAAAAAAAAAAAASW5mbwAAAA8AAAAKAAAC2wBbW1tbW1tbW1ttbW1tbW1tbW1tf39/f39/f39/f5KSkpKSkpKSkpKkpKSkpKSkpKSktra2tra2tra2tsnJycnJycnJycnb29vb29vb29vb7e3t7e3t7e3t7f////////////8AAAAATGF2YzU4LjYuAAAAAAAAAAAAAAAAJANgAAAAAAAAAtuRB9lBAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MQxAAIgHnkAUMQAERC3d9z/rnAN9NwMXAMW9bw/4PxANBB36gf2iMP8Mf//BDEswEief/jEsQFCgkmnAGHUAA/se3ug8UXhp5Mx54X/+iiuNzMhHw8/Oa7HiH8h93v/f0/9aooNCU8/+MQxAQJCUagAco4AOZ3P//6oDAFnf///oIgqBJz///8cGg+I6nf+Fw9/5cCVTyDq7///f/jEMQGCboaoABoD6BCZrb///x+HsDUXr///3Jw7xREzNTdXjrE3///6sNgjF5gYHE2+VH/4xDEBgmiFqwqEBQxYZv//+ePwvxNT///mCoNAGha///6yMoTf//6GMQCqPlqIFBmYe9X/+MSxAYJkgqgKmgPov/1jWeSb///aEwN0a///8yEbMnb1cErJ///owwlH+wFqhgM8wBCPMz/4xDEBwnKCqBUOA8E72t//uBp81tOA4WPTb+3/gMf7v/9NlUAxnVP//+Mf8rVIxNrW81P/+MQxAYIMaaUAFAFoP9Th6Pnb///j0JoHR1///+oyIzP1MFZ/6xGRQoxnzasmaXqXYUFNP/jEMQMB9DWbAAQRuj5C5P+I4KCoHz3+oKmTrE/4VMklRX63VMG5AALIfFGvULM1C4rWzr/4xLEEwjoAdW+CEYAxSa+pv/1C3Fhdn62eLam+KpMQU1FMy4xMDCqqqqqqqqqqqqqqqqqqg==");n.playbackRate=.4;let a=new Audio("data:audio/mp3;base64,SUQzBAAAAAAAIlRTU0UAAAAOAAADTGF2ZjU4LjIuMTAzAAAAAAAAAAAAAAD/40DAAAAAAAAAAAAASW5mbwAAAA8AAAASAAAEfQA5OTk5OUVFRUVFRVFRUVFRXFxcXFxcaGhoaGh0dHR0dHR/f39/f4uLi4uLi5eXl5eXoqKioqKirq6urq6uurq6urrFxcXFxcXR0dHR0d3d3d3d3ejo6Ojo9PT09PT0//////8AAAAATGF2YzU4LjYuAAAAAAAAAAAAAAAAJAQkAAAAAAAABH3jDrHbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MQxAADYAXoAAAAAK31n8vq5zDHd9uD//6FIqWpTbcbdAEhsbAxxVZ8pl/WU9QD6WSFS//jEsQZCGgCNl4AhABb/nKP+t//t1oEIMAODmI//PrM713a7bsgfUr4l+i06GYX5gPhTNVH/+MQxB8KcMIpTUYQAPZ8W//mMtvxclQiaP49gcLEbtS5xEoJtkicYA2AsR5+XC5mtBH+hv/jEMQcDwpmjAGTaAEl5HHO/+pFtZwe6Bcb/2+ZkmgaGn//6b////9v+cKCCtU5RN//uM7/4xDEBgjYXtgBwhAAFAAZgQ3s8SHlHPpCS3/0byiQQOB8MfrB9IIeD4PqGABmAlBHKLv//+MSxAkKghrZkBAPgfrqVvWhU//M5v/fwghX//5MmUOMM//8uxF/wWDQF4qMA25QLZRUEoD/4xDEBwnyHxJcEA+CByimNTT/p7/wQX//f//mU7//9jx9S/////FQhBYDggemSWCwzrgB/+MQxAYJshMLGDgFJQJMhxMer+nzWlHIp0lBMDf/yA7////9axziP///+kFIgpaB/7gY5v/jEMQGCeiLGlYwVBqABxuCbz/yE88fuIwNIbP//kSD//7hohET//kxxkkz+UCF3AAA/Az/4xLEBQfBA0peEAo2JpwBKQa/UXR////+iAos//9Z4tb/8UT/9Q9wbYa0ZhCgJIlP2vr/fv/jEMQOCGEDGlwQBSJCMtn//vOc8U//8RmUf/zynf/hxQgxhrhgEJiP8PmZV1fEwXvDv/r/4xDEEwigfuJQCA6ghCO//hUFhca7/zooHv/5FSmJI0BEGqAFyIXgTRSeizGgb/+LlXf//+MQxBcIuAruXDBEAqjwVEj//Jw7//hoOIEEwACUA9nYDN2ddhPUTGJrDLv/WRgr/+o0d//jEsQbCIhqrDRgBED/fMKAv//H1QbwYCjgAQ/u3/KblQUeZ4pS/wpBX/+kr/6mlVhr//JB/+MQxCAIWOqw/hAFBtJqDoQwhiVFTV2+GuBYVWvUVpvla/8rf////oGZ//TkquuHfRDp3v/jEMQlB5FuXABABQSg7yQllvXW7bLd9s7kpY91hrz35Wd5ajrMWkxBTUUzLjEwMKqqqqr/4xDELQcgBfwAAIYAqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq/+MSxDcAoAQAANgAAKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqo=");a.playbackRate=.75;let s={x:0,z:0},c=null,p=!1,l={...s},d=!0;const u={g:"primitive: cylinder; height: 1; radius:.15",m:"color:#000",cl:"button",c:[{g:"primitive:box;width:.5;height:.5;depth:.5",m:"opacity:0",p:"0 .5 0"},{g:"primitive: cylinder; radius:.1",m:"color:#f00",p:"0 .05 0"},{text:"value:DISABLE\nALARMS",sc:"4 4 4",r:"-90 0 0",p:"1.65 .5 -.4"}]},h={c:[{p:"0 .05 .2",r:"-90 0 -45",cl:"spotlight","spotlight-detector":"target:#cat; angle:20; range:18; obstacles:.blocking-obj",animation__move:"property:rotation;to:-155 0 -45;dur:4000;loop:true;dir:alternate;easing:linear",c:[{r:"90 0 0",g:"primitive:cone;radiusBottom:.14;radiusTop:.1;height:.25",m:"color:#000",c:[{p:"0 -.11 0",g:"primitive:sphere;radius:.12",m:"color:#fff;emissive:#fff",sc:"1 .3 1"}]},{l:"type:spot;intensity:10;angle:10;castShadow:true"}]}]},g={id:"cat",cl:"cat",p:"-7.58 .47 -3.75",r:"0 90 0",sh:"cast:true","walk-on-trigger":"speed:2; trigger:startwalk","run-on-trigger":"speed:7; trigger:startrun","jump-on-trigger":"trigger:startjump",status:"standing",blink:"","path-recorder":"","retrace-path":"","cat-seen":"","cat-runner":"","sit-stand":"","turn-trigger":"","pounce-trigger":"trigger:pounce;speed:10","press-button":"",c:[{id:"torso-joint",p:"0 .46 .15",sc:".8 1 1",c:[{id:"torso",g:"primitive:sphere; radius:.23",m:"color:#000; roughness:.9",sh:"cast:true",p:"0 0 0",c:[{id:"head-joint",p:"0 0 0",animation:"property:position; to:0 .27 .22; from:0 .26 .22; loop:true; dur:1000; dir:alternate",animation__standheadbob:"property:position; to:0 .27 .22; from:0 .26 .22; loop:true; dur:1000; dir:alternate; startEvents:catstand; delay:500",c:[{id:"head",p:"0 0 0",g:"primitive:sphere; radius:.22",m:"color:#000; roughness:.9",sc:".6 .8 .8",sh:"cast:true",c:[{g:"primitive:cone; radiusBottom:.14; radiusTop:.04; height:.13",m:"color:#000",p:"0 -.05 .19",r:"0 90 90"},{g:"primitive:sphere; radius:.02",m:"color:#730",sc:"1 1 .5",p:"0 -.03 .26"},{g:"primitive:cone; radiusBottom:.08; radiusTop:0; height:.28",m:"color:#000",p:"-.1 .21 0",r:"0 0 15"},{g:"primitive:cone; radiusBottom:.08; radiusTop:0; height:.28",m:"color:#000",p:".1 .21 0",r:"0 0 -15"},{cl:"eye",g:"primitive:sphere; radius:.03",m:"color:#ff4;emissive:#ff4",sc:"1 1 .3",p:"-.07 .04 .2",blink:"",c:[{g:"primitive:sphere; radius:.03",m:"color:#000",sc:".2 1 1",p:"0 0 .02"}]},{cl:"eye",g:"primitive:sphere; radius:.03",m:"color:#ff4;emissive:#ff4",sc:"1 1 .3",p:".07 .04 .2",blink:"",c:[{g:"primitive:sphere; radius:.03",m:"color:#000",sc:".2 1 1",p:"0 0 .02"}]}]}]},{id:"shoulders",g:"primitive:sphere; radius:.21",m:"color:#000; roughness:.9",p:"0 .13 0",sc:".8 .5 .5"},{id:"frontLegR-joint",g:"primitive:cylinder; radius:.045; height:.2",m:"color:#000",p:"-.12 -.19 .05",c:[{id:"frontLegR",g:"primitive:cylinder; radius:.045; height:.2",m:"color:#000",c:[{id:"frontLowerLegR-joint",g:"primitive:cylinder; radius:.045; height:.2",m:"color:#000",p:"0 -.18 0",c:[{id:"frontLowerLegR",g:"primitive:cylinder; radius:.045; height:.2",m:"color:#000",c:[{id:"frontPawR-joint",g:"primitive:cone; radiusBottom:.06; radiusTop:.03; height:.06",m:"color:#000; roughness:.9",sh:"cast:true",p:"0 -.06 .01",c:[{id:"frontPawR",g:"primitive:cone; radiusBottom:.06; radiusTop:.03; height:.06",m:"color:#000; roughness:.9",sh:"cast:true"}]}]}]}]}]},{id:"frontLegL-joint",g:"primitive:cylinder; radius:.045; height:.2",m:"color:#000",p:".12 -.19 .05",c:[{id:"frontLegL",g:"primitive:cylinder; radius:.045; height:.2",m:"color:#000",c:[{id:"frontLowerLegL-joint",g:"primitive:cylinder; radius:.045; height:.2",m:"color:#000",p:"0 -.18 0",c:[{id:"frontLowerLegL",g:"primitive:cylinder; radius:.045; height:.2",m:"color:#000",c:[{id:"frontPawL-joint",g:"primitive:cone; radiusBottom:.06; radiusTop:.03; height:.06",m:"color:#000; roughness:.9",sh:"cast:true",p:"0 -.06 .01",c:[{id:"frontPawL",g:"primitive:cone; radiusBottom:.06; radiusTop:.03; height:.06",m:"color:#000; roughness:.9",sh:"cast:true"}]}]}]}]}]}]}]},{id:"spine-joint",p:"0 .47 -.06",r:"87 0 0",c:[{id:"spine",g:"primitive:cylinder; radius:.18; height:.35",m:"color:#000; roughness:1; metalness:0",sh:"cast:true",c:[{id:"rear-joint",sc:".8 1 1",p:"0 -.22 .02",cl:"rearR",c:[{g:"primitive:sphere; radius:.22",m:"color:#000; roughness:.9",sh:"cast:true",c:[{id:"tail-joint",p:"0 -.2 -.18",r:"30 0 0",animation__tailwag:"property:rotation; from:30 -15 0; to:30 15 0; dur:500; easing:easeInSine; dur:2000; dir:alternate; loop:true",animation__standtail:"property:rotation; to:30 0 0; dur:250; easing:easeInSine; startEvents:catstand",animation__standtail2:"property:position; to:0 -.2 -.18; dur:250; easing:easeInSine; startEvents:catstand",animation__tailwagstand:"property:rotation; from:30 -15 0; to:30 15 0; dur:500; easing:easeInSine; dur:2000; dir:alternate; loop:true; startEvents:catstand; delay:500",c:[{g:"primitive:cylinder; radius:.035; height:.2",m:"color:#000",sh:"cast:true",animation__tailwag:"property:rotation; from:30 -15 0; to:30 15 0; dur:500; easing:easeInSine; dur:2000; dir:alternate; loop:true",animation__standtail:"property:rotation; to:30 0 0; dur:250; easing:easeInSine; startEvents:catstand",animation__standtail2:"property:position; to:0 -.2 -.18; dur:250; easing:easeInSine; startEvents:catstand",animation__tailwagstand:"property:rotation; from:30 -15 0; to:30 15 0; dur:500; easing:easeInSine; dur:2000; dir:alternate; loop:true; startEvents:catstand; delay:500",c:[{g:"primitive:cylinder; radius:.035; height:.2",m:"color:#000",sh:"cast:true",p:"0 -.18 -.05",r:"30 0 0",animation__tailwag:"property:rotation; from:30 -5 0; to:30 5 0; dur:500; easing:easeInSine; dur:2000; dir:alternate; loop:true",c:[{g:"primitive:sphere; radius:.035",m:"color:#000; roughness:.9",sh:"cast:true",p:"0 -.1 0"}]}]}]},{id:"backUpperLegL-joint",p:".15 -.02 .05",r:"90 0 90",c:[{g:"primitive:cylinder; radius:.15; height:.08",m:"color:#000",sh:"cast:true",c:[{id:"backLegL-joint",r:"90 -90 0",p:".02 0 .1",c:[{g:"primitive:cylinder; radius:.04; height:.3",m:"color:#000",sh:"cast:true",p:"0 -.15 0",c:[{id:"backPawL-joint",p:"0 -.18 0",c:[{g:"primitive:cone; radiusBottom:.06; radiusTop:.03; height:.06",m:"color:#000; roughness:.9",sh:"cast:true"}]}]}]}]}]},{id:"backUpperLegR-joint",p:"-.15 -.02 .05",r:"90 0 90",c:[{g:"primitive:cylinder; radius:.15; height:.08",m:"color:#000",sh:"cast:true",c:[{id:"backLegR-joint",r:"90 -90 0",p:".02 0 .1",c:[{g:"primitive:cylinder; radius:.04; height:.3",m:"color:#000",sh:"cast:true",p:"0 -.15 0",c:[{id:"backPawR-joint",p:"0 -.18 0",c:[{g:"primitive:cone; radiusBottom:.06; radiusTop:.03; height:.06",m:"color:#000; roughness:.9",sh:"cast:true"}]}]}]}]}]}]}]}]}]}]},m={c:[{id:"ground",cl:"clickable",sh:"receive:true","grid-floor":"w:10; h:10; size:1.5",p:"0 .42 0"},{g:"primitive:plane; width:15; height:10.5",m:"color:#540",p:"0 6.42 -2.25",r:"90 0 0"}]},A={c:[{id:"hover",g:"primitive: plane; width: 1.5; height: 1.5",r:"-90 0 0",p:"-100 .45 0",m:"color: #ff0; opacity: .3",cl:"nohit"},{cl:"grass",g:"primitive: plane; width: 15; height: 4.5",p:"0 .44 5.25",r:"-90 0 0",m:"color: #777",sh:"receive:true"},{cl:"grass",g:"primitive: plane; width: 200; height: 200",p:"0 .4 0",r:"-90 0 0",m:"color: #777",sh:"receive:true"}]},f={c:[{cl:"wall clickable",g:"primitive:box; width:2; height:6; depth:.5",p:"0 4 0",m:"color: #fff"},{text:"value: EXIT; color:#f00; align:center",sc:"10 16 16",p:"0 2.25 .25"},{id:"hinge",p:"-.9 -1 -.1","door-trigger":!0,c:[{id:"door",g:"primitive: box; width: 2.5; height: 4; depth: .2",p:"1 0 0",m:"color: #999",c:[{text:"value: EMERGENCY ONLY;align:center",sc:"4 4 4",p:"0 1.25 .21"},{text:"value: ALARM WILL SOUND;align:center",sc:"4 4 4",p:"0 .75 .21"},{id:"secureLight",g:"primitive: sphere; radius: .2",p:"0 .25 0",m:"emissive: #f00"},{cl:"bar clickable",g:"primitive: box; width: 1.75; height: .2; depth: 1.2",p:"-.1 -.2 -.4",m:"color: #fff"}]}]}]},b={p:"0 2.5 .5",c:[{g:"primitive:box; width:2; height:6; depth:.5",p:"0 4.25 0",cl:"wall clickable",m:"color:#fff"},{g:"primitive: box; width: 2; height:4.5; depth:.25",p:"0 -.85 .1",m:"color:#6b5a4a"},{g:"primitive: box; width: 1.6; height:4; depth:.25",p:".025 -1 .15",m:"color:#a67c52",c:[{g:"primitive: sphere; radius:.13",p:"-.5 -.25 .11",m:"color:#fff"}]}]},y={p:"0 2.5 .5",c:[{g:"primitive:box; width:2; height:6; depth:.5",p:"0 -4.2 0",cl:"wall clickable",m:"color:#fff",sh:"receive:true;cast:true",c:[{g:"primitive:box; width:2.05; height:6.05; depth:.5",p:"0 0 -.05",m:"color:#ccc",cl:"outerwall"}]},{g:"primitive:box; width:2; height:6; depth:.5",p:"0 4.25 0",cl:"wall clickable",m:"color:#fff",sh:"receive:true;cast:true",c:[{g:"primitive:box; width:2.05; height:6.05; depth:.5",p:"0 0 -.05",m:"color:#ccc",cl:"outerwall"}]},{g:"primitive: plane; width: 2; height:3.5",p:"0 .5 .1",m:"color:#000;opacity:.7"}]},v={p:"0 2.5 .5",c:[{g:"primitive:box; width:2; height:6; depth:.5",p:"0 -5.25 0",cl:"wall clickable",m:"color:#fff",sh:"receive:true;cast:true",c:[{g:"primitive:box; width:2.05; height:6.05; depth:.5",p:"0 0 -.05",m:"color:#ccc",cl:"outerwall"}]},{g:"primitive:box; width:2; height:6; depth:.5",p:"0 4.25 0",cl:"wall clickable",m:"color:#fff",sh:"receive:true;cast:true",c:[{g:"primitive:box; width:2.05; height:6.05; depth:.5",p:"0 0 -.05",m:"color:#ccc",cl:"outerwall"}]},{g:"primitive: plane; width: 2; height:3.5",p:"0 -.5 0",cl:"mirror",m:"color:#000;opacity:.5;transparent:true"},{g:"primitive:box; width:2; height:.2; depth:.2",p:"0 1.25 -.35",m:"color:#550"},{g:"primitive:box; width:2; height:.2; depth:.2",p:"0 -2.25 -.35",m:"color:#550"},{g:"primitive:box; width:.2; height:3.5; depth:.2",p:"-1 -.5 -.35",m:"color:#550"}]},w={sc:"3 3 3",c:[{g:"primitive:cone; height: .4; radiusBottom:.25; radiusTop:.005; segmentsRadial:6;openEnded:true",m:"color:#99f; metalness:.5; roughness:.1; opacity:.7; transparent:true",r:"180 0 0",a:"property: rotation; to: 180 360 0; loop: true; dur: 12000; easing: linear"},{g:"primitive:cone; height: .15; radiusBottom:.25; radiusTop:.15; segmentsRadial:6",m:"color:#99f; metalness:.5; roughness:.1; opacity:.7; transparent:true",p:"0 .275 0",a:"property: rotation; to: 0 360 0; loop: true; dur: 12000; easing: linear"}]},E={c:[{id:"treasure",g:"primitive:cylinder; radius:.8; height:.2",m:"color:#333",c:[{g:"primitive:cone; radiusBottom:.7; height:1; segmentsRadial:4",m:"color:#333",p:"0 .5 0",r:"0 45 0"},{g:"primitive:cone; radiusBottom:.7; height:1",m:"color:#333",p:"0 1.05 0",r:"180 0 0"},{g:"primitive:cylinder; radius:1.1; height:.2",m:"color:#333",p:"0 1.5 0",s:"receive:false; cast:true",c:[{g:"primitive:cylinder; radius:.3; height:.08",m:"color:#fff",p:"0 .08 0",c:[{id:"treasure",c:[{g:"primitive:cone; height: .4; radiusBottom:.25; radiusTop:.005; segmentsRadial:6;openEnded:true",m:"color:#99f; metalness:.5; roughness:.1; opacity:.7; transparent:true",p:"0 .25 0",r:"180 0 0",a:"property: rotation; to: 180 360 0; loop: true; dur: 12000; easing: linear",sh:"cast:false; receive:false"},{g:"primitive:cone; height: .15; radiusBottom:.25; radiusTop:.15; segmentsRadial:6",m:"color:#99f; metalness:.5; roughness:.1; opacity:.7; transparent:true",p:"0 .525 0",a:"property: rotation; to: 0 360 0; loop: true; dur: 12000; easing: linear",sh:"cast:false; receive:false"}]},{g:"primitive:cylinder; radius:.02; height:3",m:"color:#000",p:"0 4.5 0"},{g:"primitive:cone; radiusBottom:.14; radiusTop:.1; height:.25",m:"color:#000",p:"0 3 0",c:[{g:"primitive:sphere; radius:.12",m:"color:#fff; emissive:#fff",s:"1 .3 1",p:"0 -.05 0"}]},{l:"type: spot; intensity:.6; angle:10; distance:2",p:".1 1.5 .6",r:"-70 10 0"},{l:"type: spot; intensity:.5; angle:12; castShadow:true",p:"0 3 0",r:"-90 0 0"}]}]}]}]},L={id:"ropes",c:[{g:"primitive:cylinder; radius:.05; height:1.6",m:"color:#fff; metalness:.5",p:"-1 -2.5 -1",c:[{g:"primitive:cone; height:.1; radiusTop:.05; radiusBottom:.4",m:"color:#000",p:"0 -.5 0"},{g:"primitive:sphere; radius:.08",m:"color:#fff; metalness:.5",p:"0 .83 0"}]},{g:"primitive:cylinder; radius:.05; height:1.6",m:"color:#fff; metalness:.5",p:"1 -2.5 -1",c:[{g:"primitive:cone; height:.1; radiusTop:.05; radiusBottom:.4",m:"color:#000",p:"0 -.5 0"},{g:"primitive:sphere; radius:.08",m:"color:#fff; metalness:.5",p:"0 .83 0"}]},{g:"primitive:cylinder; radius:.05; height:1.6",m:"color:#fff; metalness:.5",p:"-1 -2.5 1",c:[{g:"primitive:cone; height:.1; radiusTop:.05; radiusBottom:.4",m:"color:#000",p:"0 -.5 0"},{g:"primitive:sphere; radius:.08",m:"color:#fff; metalness:.5",p:"0 .83 0"}]},{g:"primitive:cylinder; radius:.05; height:1.6",m:"color:#fff; metalness:.5",p:"1 -2.5 1",c:[{g:"primitive:cone; height:.1; radiusTop:.05; radiusBottom:.4",m:"color:#000",p:"0 -.5 0"},{g:"primitive:sphere; radius:.08",m:"color:#fff; metalness:.5",p:"0 .83 0"}]},{g:"primitive:torus; arc:60; radius:2; radiusTubular:.02",m:"color:#F55",p:"0 0 1",r:"0 0 -120"},{g:"primitive:torus; arc:60; radius:2; radiusTubular:.02",m:"color:#F55",p:"-1 0 0",r:"0 90 -120"},{g:"primitive:torus; arc:60; radius:2; radiusTubular:.02",m:"color:#F55",p:"0 0 -1",r:"0 0 -120"},{g:"primitive:torus; arc:60; radius:2; radiusTubular:.02",m:"color:#F55",p:"1 0 0",r:"0 90 -120"}]},q={c:[{g:"primitive:plane; width:40; height:40",m:"color:#ddd;emissive:#999",p:"0 -100 -20.5"},{g:"primitive:plane; width:40; height:40",m:"color:#ddd;emissive:#999",p:"0 -200 -20.5"},{g:"primitive:plane; width:40; height:40",m:"color:#ddd;emissive:#999",p:"-15 -200 -1.5",r:"0 90 0"},{g:"primitive:plane; width:40; height:40",m:"color:#ddd;emissive:#999",p:"-15 -100 -1.5",r:"0 90 0"},{id:"piece1",g:"primitive:torusKnot;radiusTubular:.1;radius:3",p:"0 -100 -15",q:"7",m:"color:#B84A39;emissive:#300"},{id:"piece2",g:"primitive:torusKnot;radiusTubular:.1;radius:3",p:"0 -200 -15",q:"7",r:"90 60 0",m:"color:#394AB8;emissive:#003"}]},x={c:[{id:"hiddenCam1",camera:"active:false",p:"0 -101 -12"},{id:"hiddenCam2",camera:"active:false",p:"0 -201 -12"},{id:"hiddenCam3",camera:"active:false",p:"5 -200 -16",r:"0 90 0"},{id:"hiddenCam4",camera:"active:false",p:"5 -101 -14",r:"0 90 0"}]},j={r:"0 90 0",c:[{g:"primitive:box; width:1.7; height:1.2; depth:1",m:"color:#000"},{cl:"vent",g:"primitive:box; width:1.7; height:.05; depth:1.2",m:"color:#999",r:"0 0 0",p:"0 .65 1.2"}]},R={c:[{p:".5 14 -7.5",m:"color:#ccc",cl:"outerwall2",g:"primitive:box; width:18; height: 15; depth:22"},{p:"-22.7 0 -7.5",m:"color:#ccc",cl:"outerwall2",g:"primitive:box; width:30; height: 30; depth:22"}]},_={g:"primitive:box; width:2; height:6; depth:.5",p:"0 0 .5",cl:"wall clickable blocking-obj",m:"color:#fff;side:double",sh:"receive:true;cast:true",c:[{g:"primitive:box; width:2.05; height:6.05; depth:.5",p:"0 0 -.05",m:"color:#ccc",cl:"outerwall"}]},T={g:"primitive:box; width:1.15; height:6; depth:.5",p:"0 0 .5",cl:"wall clickable blocking-obj",m:"color:#fff;side:double",sh:"receive:true;cast:true",c:[{g:"primitive:box; width:1.17; height:6.05; depth:.5",p:"0 0 -.05",m:"color:#ccc",cl:"outerwall"}]},M={id:"id",p:"position",r:"rotation",sc:"scale",g:"geometry",m:"material",sh:"shadow",cl:"class",c:"children",l:"light",li:"line",o:"color",a:"animation"};currlevel=1;let z=[];function k(t,e,i,o){const r=document.createElement("a-entity");for(const e in t){const i=t[e];"c"===e?i.forEach(t=>k(t,r)):"id"===e?r.id=i:r.setAttribute(M[e]||e,i)}return i&&r.setAttribute("position",i),o&&r.setAttribute("rotation",o),e.appendChild(r),r}function S(t){t.flushToDOM(),t.childNodes.forEach(t=>1===t.nodeType&&S(t))}function D(t){for(k(m,o),i=0;i<4;i++)C(z[t][i],o);k(j,o,"-7.99 1.07 -3.75"),k(E,o,".75 .47 -2.5"),k(L,o,".75 3.5 -2.5"),k(u,o,z[t][4].p,z[t][4].r),k(R,e),k(h,o,".76 5.55 -7.47"),k(h,o,"-5 5.55 -7.47"),k(z[t][5],o),document.querySelector("#piece1").setAttribute("rotation","0 "+360*Math.random()+" 0"),document.querySelector("#piece2").setAttribute("rotation","0 "+360*Math.random()+" 0"),document.querySelectorAll(".art").forEach(t=>{t.addEventListener("loaded",()=>{!function(t){const i=e.renderer,o=e.object3D;artId="#art"+t,camId="#hiddenCam"+t;const r=document.querySelector(camId).getObject3D("camera"),n=document.querySelector(artId),a=new THREE.WebGLRenderTarget(512,512),s=i.xr.enabled;i.xr.enabled=!1,i.setRenderTarget(a),i.render(o,r),i.setRenderTarget(null),i.xr.enabled=s;const c=a.texture;c.encoding=THREE.sRGBEncoding,n.getObject3D("mesh").material=new THREE.MeshBasicMaterial({map:c})}(t.getAttribute("artId"))})});let r=document.querySelectorAll(".mirror");if(r.length>0){r.forEach(t=>{t.addEventListener("loaded",()=>{const e=t.getObject3D("mesh");e&&(e.material.depthWrite=!1)})}),document.querySelector("#player").setAttribute("mirror-figure","target:#rig"),S(o),S(c);const t=o.cloneNode(!0);t.setAttribute("id","reflection"),t.setAttribute("scale","1 1 -1"),t.setAttribute("position","0 0 -15.6"),e.appendChild(t),t.querySelectorAll("*").forEach(t=>{for(let{name:e,value:i}of[...t.attributes])"grid-floor"!==e&&"id"!==e&&t.setAttribute(e,i)}),t.object3D.traverse(t=>{t.isMesh&&(t.material=t.material.clone(),t.material.side=THREE.DoubleSide)});let i=document.querySelector("#reflection-cat");(function(t,e){if(t&&e){for(;e.firstChild;)e.removeChild(e.firstChild);for(let o=0;o<t.children.length;o++)i(t.children[o],e)}function i(t,e){const o=document.createElement(t.tagName.toLowerCase());for(let e=0;e<t.attributes.length;e++){const i=t.attributes[e];"id"!==i.name&&"look-at-cursor"!==i.name&&o.setAttribute(i.name,i.value)}for(let e=0;e<t.children.length;e++)i(t.children[e],o);e.appendChild(o)}})(c,i),document.querySelector("#head-joint").setAttribute("look-at-cursor",""),i.setAttribute("mirror-children","target:#cat"),i.removeAttribute("walk-on-trigger"),i.removeAttribute("run-on-trigger"),i.removeAttribute("status"),i.removeAttribute("blink"),i.removeAttribute("cat-seen"),i.removeAttribute("cat-runner"),i.removeAttribute("sit-stand"),i.removeAttribute("retrace-path"),i.removeAttribute("path-recorder"),i.removeAttribute("turn-trigger"),i.removeAttribute("pounce-trigger"),i.removeAttribute("press-button"),i.setAttribute("position","-3 .47 2");let n=document.createElement("a-entity");n.setAttribute("id","mirrorLaser"),n.setAttribute("line","color:#fff"),e.appendChild(n),n.addEventListener("loaded",()=>{document.querySelector("#rightHand").setAttribute("mirror-laser","target: #mirrorLaser;mirrorZ:-8")})}c.addEventListener("loaded",()=>{P(),requestAnimationFrame(()=>{P()}),setTimeout(()=>{P()},0),O()}),document.querySelector("#rightHand").components.raycaster.refreshObjects(),l=c.getAttribute("position"),function(){const t=document.getElementById("brickTexture"),e=t.getContext("2d");e.fillStyle="#221",e.fillRect(0,0,t.width,t.height),e.lineWidth=5;for(let i=0;i<=t.width;i+=64)for(let o=0;o<t.height;o++){const t=o,r=32+20*Math.sin(t/20)-10,n=32+20*Math.cos(t/20+Math.PI/2);e.fillStyle="#311",e.fillRect(r+i,t,15,1),e.fillStyle="#311",e.fillRect(n+i,t,15,1)}let i=document.querySelectorAll(".wall"),o=new THREE.CanvasTexture(t);i.forEach(t=>{t.addEventListener("loaded",()=>{let e=t.getObject3D("mesh");e.material.map=o,e.material.needsUpdate=!0,o.wrapS=o.wrapT=THREE.RepeatWrapping})});const r=document.getElementById("brickTexture2"),n=r.getContext("2d");r.width=256,r.height=128,n.fillStyle="#888",n.fillRect(0,0,r.width,r.height),n.strokeStyle="#666",n.lineWidth=4,n.strokeRect(-r.width/2,0,r.width,r.height/2),n.strokeRect(r.width/2,0,r.width,r.height/2),n.strokeRect(r.width/4,r.height/2,r.width/2,r.height/2);let a=document.querySelectorAll(".outerwall2"),s=document.querySelectorAll(".outerwall"),c=new THREE.CanvasTexture(r),p=new THREE.CanvasTexture(r);s.forEach(t=>{t.addEventListener("loaded",()=>{const e=t.getObject3D("mesh");e.material.map=c,e.material.needsUpdate=!0,c.wrapS=c.wrapT=THREE.RepeatWrapping,c.repeat.set(2,10)})}),a.forEach(t=>{t.addEventListener("loaded",()=>{const e=t.getObject3D("mesh");e.material.map=p,e.material.needsUpdate=!0,p.wrapS=p.wrapT=THREE.RepeatWrapping,p.repeat.set(20,50)})})}(),function(){const t=document.querySelector("#ventTexture"),e=t.getContext("2d");t.width=256,t.height=128,e.fillStyle="#ccc",e.fillRect(0,0,256,128),e.strokeStyle="#555",e.lineWidth=10;for(let t=0;t<=128;t+=15)e.beginPath(),e.moveTo(0,t),e.lineTo(256,t),e.stroke();e.strokeRect(2,2,254,126);const i=new THREE.CanvasTexture(t);i.wrapS=i.wrapT=THREE.RepeatWrapping,i.needsUpdate=!0,document.querySelectorAll(".vent").forEach(t=>{t.addEventListener("loaded",()=>{const e=t.getObject3D("mesh");e.material=e.material.clone(),e.material.map=i,e.material.color.set("#fff"),e.material.needsUpdate=!0})})}(),o.setAttribute("tile-hover","")}function C(t,e){const i=t.r,o=t.p,r=t.w.split(""),n=document.createElement("a-entity");let a=0;r.forEach(t=>{let e;switch(t){case"W":e=k(_,n),n.appendChild(e),e.setAttribute("position",a+" 3.42 .5");break;case"H":e=k(T,n),n.appendChild(e),e.setAttribute("position",a+" 3.42 .5");break;case"D":e=k(b,n),n.appendChild(e),e.setAttribute("position",a+" 3.42 .5");break;case"E":e=k(f,n),n.appendChild(e),e.setAttribute("position",a+" 3.42 .5");break;case"I":e=k(y,n),n.appendChild(e),e.setAttribute("position",a+" 3.42 .5");break;case"M":e=k(v,n),n.appendChild(e),e.setAttribute("position",a+" 3.42 .5");break;case"R":e=k(v,n),n.appendChild(e),e.setAttribute("scale","-1 1 1"),e.setAttribute("position",a+" 3.42 .5")}a+=2}),n.setAttribute("position",o),n.setAttribute("rotation",i),e.appendChild(n)}function B(){p=!1;const e=document.querySelector("#room");Array.from(e.children).forEach(t=>t.remove()),c.setAttribute("position","-7.58 .47 -3.75"),c.setAttribute("rotation","0 90 0"),d=!0,t.stop(),Y(.3),function(e){currlevel=e,D(e);const i=document.getElementById("rig");i.setAttribute("position","-2 1.5 3.4"),i.setAttribute("rotation","0 0 0"),document.querySelectorAll(".fader").forEach(t=>{t.emit("fadeIn")}),function(){if(!p){n.currentTime=0,n.play();const t=document.querySelector("#cat");t.emit("catstand"),t.emit("startwalk");const e={x:-6.7,y:.47,z:-3.75};t.setAttribute("animation__move",{property:"position",to:e.x+" 0.45 "+e.z,dur:1e3,easing:"linear"}),t.addEventListener("animationcomplete__move",()=>{t.emit("stopwalk"),t.removeAttribute("animation__move"),t.emit("catsit")},{once:!0}),p=!0}}(),setTimeout(()=>{t=zzfxP(...r),t.loop=!0},800),document.getElementById("rightHand").addEventListener("thumbstickmoved",t=>{Math.abs(t.detail.x)>.2&&(i.object3D.position.x+=.25*t.detail.x)})}(currlevel)}function I(e){const i=e.detail.intersection;if(!i||!i.object)return;const o=i.object.el;if(o&&o.classList.contains("floor-tile")&&U(o,s)){const t=parseInt(o.dataset.gx),e=parseInt(o.dataset.gz),i=Q(t-s.x,e-s.z);i&&(c.emit("turn",{rotation:{y:i.y}}),X||(X=!0,setTimeout(function(){c.emit("pounce")},500),setTimeout(function(){X=!1},1e3))),G(),document.querySelector("#spine").addEventListener("animationcomplete__stand",()=>{c.emit("startwalk");const i=o.getAttribute("position");c.setAttribute("animation__move",{property:"position",to:i.x+" 0.45 "+i.z,dur:200,easing:"linear"}),c.addEventListener("animationcomplete__move",()=>{c.emit("stopwalk"),s.x=t,s.z=e,c.removeAttribute("animation__move"),O()},{once:!0})},{once:!0})}else if(o&&o.classList.contains("button")&&F(o,s)){let t=o.getAttribute("position"),e=W();const i=H(t.x,t.z,e.w,e.h,e.size),r=parseInt(i.x),n=parseInt(i.z),a=Q(r-s.x,n-s.z);a&&a.y!==Math.abs(c.getAttribute("rotation").y)?(c.emit("turn",{rotation:{y:a.y}}),setTimeout(function(){c.emit("pressbutton")},125)):c.emit("pressbutton"),K||(K=!0,setTimeout(function(){K=!1,d=!1,document.querySelector("#secureLight").setAttribute("material","emissive:#000"),O()},1e3))}else if(o&&o.classList.contains("bar")&&F(o,s,5)){let e=o.getAttribute("position"),i=W();const r=H(e.x,e.z,i.w,i.h,i.size),n=parseInt(r.x),a=parseInt(r.z),l=Q(n-s.x,a-s.z);l&&l.y!==Math.abs(c.getAttribute("rotation").y)?(c.emit("turn",{rotation:{y:l.y}}),setTimeout(function(){c.emit("pressbutton")},250)):c.emit("pressbutton"),K||(K=!0,setTimeout(function(){K=!1,document.querySelector("#hinge").emit("openDoor"),d?(zzfx(...[,0,960,,1,.01,,.8,-.01,,-190,.5,,.05,,,1]),document.querySelectorAll(".fader").forEach(t=>{t.emit("fadeOut")}),setTimeout(B,1e3)):(zzfx(...[,,20,.04,,.6,,1.31,,,-990,.06,.17,,,.04,.07]),function(){p=!1;const e=document.querySelector("#startLevel"+currlevel);e.setAttribute("material","emissive:#00f"),document.querySelector("#treasure"+currlevel)||k(w,e,"-.35 0 -1"),document.querySelector("#startLevel"+currlevel++).setAttribute("material","emissive:#00f");const i=document.getElementById("rig");i.setAttribute("position","200 1.2 3.2"),i.setAttribute("rotation","0 0 0");const o=document.querySelector("#room");Array.from(o.children).forEach(t=>t.remove());const r=document.querySelector("#reflection");r&&Array.from(r.children).forEach(t=>t.remove()),c.setAttribute("position","-7.58 .47 -3.75"),c.setAttribute("rotation","0 90 0"),d=!0,Y(.3),t.stop()}())},120),setTimeout(O,500))}}function W(){const t=document.querySelector("[grid-floor]"),e=t?.components["grid-floor"]?.data;return e?{w:e.w,h:e.h,size:e.size}:{w:10,h:10,size:1.5}}function H(t,e,i,o,r){return{x:Math.round(t/r+i/2-.5),z:Math.round(e/r+o/2-.5)}}function P(){c=document.querySelector("#cat");const{w:t,h:e,size:i}=W(),o=new THREE.Vector3;c.object3D.getWorldPosition(o);const r=H(o.x,o.z,t,e,i);s.x=r.x,s.z=r.z}function U(t,e){const i=parseInt(t.dataset.gx),o=parseInt(t.dataset.gz);return Math.abs(i-e.x)+Math.abs(o-e.z)===1}function F(t,e,i){let o=t.getAttribute("position"),r=W();const n=H(o.x,o.z,r.w,r.h,r.size),a=parseInt(n.x),s=parseInt(n.z);let c=Math.abs(a-e.x);return i>0&&(c=Math.abs(a-(e.x-i))),c+Math.abs(s-e.z)===1}function Q(t,e){return 1===t&&0===e?{y:90}:-1===t&&0===e?{y:-90}:0===t&&-1===e?{y:180}:0===t&&1===e?{y:0}:void 0}function Y(t){document.querySelectorAll(".laser").forEach(e=>{e.setAttribute("material","opacity:"+t)})}function O(){c.emit("catsit")}function V(){let t=W();c.emit("catstand"),setTimeout(function(){c.emit("startwalk",{distance:t.size/2})},100),setTimeout(function(){c.emit("catsit")},1e3)}function G(){c.emit("catstand")}z[1]=[{p:"-7.5 0 -8.25",r:"0 0 0",w:"WWWWDWWW"},{p:"-8.25 0 2",r:"0 90 0",w:"WWWWWW"},{p:"8.2 0 -8",r:"0 -90 0",w:"WWWEWW"},{p:"7.5 0 3.5",r:"0 180 0",w:"WIIIIIWW"},{p:"-2 2 -8",r:"90 0 0"},{c:[{id:"art1",cl:"art",artId:1,g:"primitive:box; width:2.7; height:2.3; depth:.05",p:"-5 3.42 -7.4"},{id:"art2",cl:"art",artId:2,g:"primitive:box; width:2.7; height:2.3; depth:.05",p:"4 3.42 -7.4"},{id:"art3",cl:"art",artId:3,g:"primitive:box; width:2.7; height:2.3; depth:.05",p:"-7.4 3.42 -4.4",r:"0 90 0"},{id:"art4",cl:"art",artId:4,g:"primitive:box; width:2.7; height:2.3; depth:.05",p:"-7.4 3.42 0",r:"0 90 0"}]}],z[2]=[{p:"-7.5 0 -8.25",r:"0 0 0",w:"WWWMRWWW"},{p:"-8.25 0 2",r:"0 90 0",w:"WDWWWH"},{p:"8.2 0 -8",r:"0 -90 0",w:"HWWEWW"},{p:"7.5 0 3.5",r:"0 180 0",w:"WIWIWIWW"},{p:"-7.98 2 -2.2",r:"90 90 0"},{c:[{id:"art1",cl:"art",artId:1,g:"primitive:box; width:2.7; height:2.3; depth:.05",p:"-5 3.42 -7.4"},{id:"art2",cl:"art",artId:2,g:"primitive:box; width:2.7; height:2.3; depth:.05",p:"4 3.42 -7.4"},{id:"art3",cl:"art",artId:3,g:"primitive:box; width:2.7; height:2.3; depth:.05",p:"-7.4 3.42 -4.4",r:"0 90 0"}]}],AFRAME.registerComponent("fade-trigger",{init:function(){this.el.addEventListener("fadeIn",()=>{this.intensity=this.el.getAttribute("light").intensity,this.fadingIn=!0}),this.el.addEventListener("fadeOut",()=>{this.intensity=this.el.getAttribute("light").intensity,this.fadingOut=!0})},tick(t,e){if(this.fadingIn){let t=this.el.getAttribute("light").intensity;const i=e/1e3*.1;this.el.setAttribute("light","intensity",t+i),t+i>=.2&&(this.fadingIn=!1)}else if(this.fadingOut){let t=this.el.getAttribute("light").intensity;const i=this.intensity*(e/1e3);this.el.setAttribute("light","intensity",t-i),t-i<.001&&(this.fadingOut=!1)}}}),AFRAME.registerComponent("door-trigger",{schema:{speed:{type:"number",default:360},trigger:{type:"string",default:"openDoor"}},init:function(){this.el.addEventListener(this.data.trigger,t=>{const e=this.el.getAttribute("rotation");this.startYaw=e.y,this.targetYaw=90;let i=this.targetYaw-this.startYaw;this.targetYaw=this.startYaw+i,this.isTurning=!0})},tick:function(t,e){if(!this.isTurning)return;const i=this.el.getAttribute("rotation");let o=i.y,r=this.targetYaw-o;r=(r+180)%360-180;const n=this.data.speed*(e/1e3);Math.abs(r)<=n?(o=this.targetYaw,this.isTurning=!1):o+=n*Math.sign(r),this.el.setAttribute("rotation",{x:i.x,y:o,z:i.z})}}),AFRAME.registerComponent("turn-trigger",{schema:{speed:{type:"number",default:360},trigger:{type:"string",default:"turn"}},init:function(){this.isTurning=!1,this.startYaw=0,this.targetYaw=0,this.el.addEventListener(this.data.trigger,t=>{const e=this.el.getAttribute("rotation");this.startYaw=e.y;const i=t.detail&&t.detail.rotation?t.detail.rotation:{x:0,y:0,z:0};this.targetYaw=i.y;let o=this.targetYaw-this.startYaw;o=(o+180)%360-180,-270===o&&(o=90),this.targetYaw=this.startYaw+o,this.isTurning=!0})},tick:function(t,e){if(!this.isTurning)return;const i=this.el.getAttribute("rotation");let o=i.y,r=this.targetYaw-o;r=(r+180)%360-180;const n=this.data.speed*(e/1e3);Math.abs(r)<=n?(o=this.targetYaw,this.isTurning=!1):o+=n*Math.sign(r),this.el.setAttribute("rotation",{x:i.x,y:o,z:i.z})}}),AFRAME.registerComponent("pounce-trigger",{schema:{speed:{type:"number",default:.5},trigger:{type:"string",default:"pounce"},height:{type:"number",default:.5},isPouncing:{type:"bool",default:!1}},init:function(){this.data.isPouncing=!1,this.legs=[{id:"#head-joint",rotation:{property:"rotation",to:"30 0 0",dur:250,easing:"linear"},position:{property:"position",to:"0 .06 0.32",dur:250,easing:"linear"}},{id:"#spine-joint",rotation:{property:"rotation",to:"105 0 0",dur:225,easing:"linear"},position:{property:"position",to:"0 0.38 .16",dur:250,easing:"linear"}},{id:"#torso-joint",rotation:{property:"rotation",to:"0 0 0",dur:250,easing:"linear"},position:{property:"position",to:"0 0.34 0.35",dur:250,easing:"linear"}},{id:"#rear-joint",rotation:{property:"rotation",to:"0 0 0",dur:225,easing:"linear"}},{id:"#backUpperLegL-joint",rotation:{property:"rotation",to:"-5 0 90",dur:250,easing:"linear"}},{id:"#backUpperLegR-joint",rotation:{property:"rotation",to:"-5 0 90",dur:250,easing:"linear"}},{id:"#backLegR-joint",rotation:{property:"rotation",to:"90 -190 0",dur:250,easing:"linear"}},{id:"#backLegL-joint",rotation:{property:"rotation",to:"90 -190 0",dur:250,easing:"linear"}},{id:"#frontLegL-joint",rotation:{property:"rotation",to:"-55 0 -10",dur:250,easing:"linear"},position:{property:"position",to:"0.12 -.2 0.2",dur:250,easing:"linear"},scale:{property:"scale",to:"1 1.3 1",dur:250,easing:"linear"}},{id:"#frontLegR-joint",rotation:{property:"rotation",to:"-55 0 10",dur:250,easing:"linear"},position:{property:"position",to:"-.12 -.2 0.2",dur:250,easing:"linear"},scale:{property:"scale",to:"1 1.3 1",dur:250,easing:"linear"}},{id:"#frontLowerLegL-joint",rotation:{property:"rotation",to:"-20 0 -15",dur:250,easing:"linear"},position:{property:"position",to:"-0.02 -.18 .02",dur:250,easing:"linear"}},{id:"#frontLowerLegR-joint",rotation:{property:"rotation",to:"-20 0 15",dur:250,easing:"linear"},position:{property:"position",to:"0.02 -.18 .02",dur:250,easing:"linear"}},{id:"#frontPawL-joint",rotation:{property:"rotation",to:"40 0 0",dur:250,easing:"linear"}},{id:"#frontPawR-joint",rotation:{property:"rotation",to:"40 0 0",dur:250,easing:"linear"}}],this.el.addEventListener(this.data.trigger,()=>{this.data.isPouncing||(this.data.isPouncing=!0,this.startLegAnimations())}),this.el.addEventListener("stoppounce",()=>{this.data.isPouncing=!1,setTimeout(O,1e3)})},startLegAnimations:function(){hover.setAttribute("visible",!1);const t=W().size,e=new THREE.Vector3;this.el.object3D.getWorldDirection(e),e.y=0,e.normalize().multiplyScalar(t-t/2);const i=this.el.object3D.position.clone(),o=i.clone().add(e),r=i.clone().add(e.clone().multiplyScalar(.5));r.y+=this.data.height,this.el.setAttribute("animation__pounceUp",{property:"position",to:r.x+" "+r.y+" "+r.z,dur:125,easing:"easeOutQuad"}),this.el.addEventListener("animationcomplete__pounceUp",()=>{this.el.setAttribute("animation__pounceDown",{property:"position",to:o.x+" "+o.y+" "+o.z,dur:125,easing:"easeInQuad"}),this.el.addEventListener("animationcomplete__pounceDown",()=>{this.data.isPouncing=!1,this.el.removeAttribute("animation__pounceUp"),this.el.removeAttribute("animation__pounceDown"),P(),setTimeout(V,125)},{once:!0})},{once:!0}),this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);i&&(i.removeAttribute("animation__pounce"+e+"_rot"),i.removeAttribute("animation__pounce"+e+"_pos"),i.removeAttribute("animation__pounce"+e+"_scale"),t.rotation&&i.setAttribute("animation__pounce"+e+"_rot",t.rotation),t.position&&i.setAttribute("animation__pounce"+e+"_pos",t.position),t.scale&&i.setAttribute("animation__pounce"+e+"_scale",t.scale))})}}),AFRAME.registerComponent("press-button",{schema:{speed:{type:"number",default:1},trigger:{type:"string",default:"pressbutton"}},init:function(){this.legs=[{id:"#spine-joint",rotation:{property:"rotation",to:"25 0 0",dur:125,easing:"linear"},position:{property:"position",to:"0 1 .41",dur:125,easing:"linear"}},{id:"#torso-joint",rotation:{property:"rotation",to:"10 0 0",dur:125,easing:"linear"},position:{property:"position",to:"0 1.2 0.55",dur:125,easing:"linear"}},{id:"#rear-joint",rotation:{property:"rotation",to:"45 0 0",dur:125,easing:"linear"},position:{property:"position",to:"0 -.32 .02",dur:125,easing:"linear"}},{id:"#backUpperLegL-joint",rotation:{property:"rotation",to:"35 0 90",dur:125,easing:"linear"}},{id:"#backUpperLegR-joint",rotation:{property:"rotation",to:"35 0 90",dur:125,easing:"linear"}},{id:"#backLegR-joint",rotation:{property:"rotation",to:"90 -190 0",dur:125,easing:"linear"}},{id:"#backLegL-joint",rotation:{property:"rotation",to:"90 -190 0",dur:125,easing:"linear"}},{id:"#frontLegL-joint",rotation:{property:"rotation",to:"55 0 -10",dur:125,easing:"linear"},position:{property:"position",to:"0.12 .3 0.4",dur:125,easing:"linear"}},{id:"#frontLegR-joint",rotation:{property:"rotation",to:"55 0 10",dur:125,easing:"linear"},position:{property:"position",to:"-.12 .3 0.4",dur:125,easing:"linear"}},{id:"#frontLowerLegL-joint",rotation:{property:"rotation",to:"-20 0 -15",dur:125,easing:"linear"},position:{property:"position",to:"-0.02 -.18 .02",dur:125,easing:"linear"}},{id:"#frontLowerLegR-joint",rotation:{property:"rotation",to:"-20 0 15",dur:125,easing:"linear"},position:{property:"position",to:"0.02 -.18 .02",dur:125,easing:"linear"}},{id:"#frontPawL-joint",rotation:{property:"rotation",to:"40 0 0",dur:125,easing:"linear"}},{id:"#frontPawR-joint",rotation:{property:"rotation",to:"40 0 0",dur:125,easing:"linear"}}],this.el.addEventListener(this.data.trigger,()=>{G(),this.startLegAnimations()})},startLegAnimations:function(){this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);i&&(i.removeAttribute("animation__press"+e+"_rot"),i.removeAttribute("animation__press"+e+"_pos"),t.rotation&&i.setAttribute("animation__press"+e+"_rot",t.rotation),t.position&&i.setAttribute("animation__press"+e+"_pos",t.position)),i.addEventListener("animationcomplete__press"+e+"_rot",()=>{this.stopLegAnimations(),Y(0)},{once:!0})})},stopLegAnimations:function(){this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);i&&(i.removeAttribute("animation__press"+e+"_rot"),i.removeAttribute("animation__press"+e+"_pos"))})}}),AFRAME.registerComponent("cat-seen",{schema:{speed:{type:"number",default:5},trigger:{type:"string",default:"startjump"},height:{type:"number",default:2}},init:function(){this.isMoving=!1,this.legs=[{id:"#cat",position:{property:"position",dur:250,easing:"easeOutQuad",dir:"alternate",loop:1}},{id:"#backUpperLegL-joint",rotation:{property:"rotation",to:"90 0 90",dur:150,easing:"linear"},position:{property:"position",to:".15 -.02 .1",dur:150,easing:"linear"}},{id:"#backUpperLegR-joint",rotation:{property:"rotation",to:"90 0 90",dur:150,easing:"linear"},position:{property:"position",to:"-.15 0 .02",dur:150,easing:"linear"}},{id:"#backLegR-joint",rotation:{property:"rotation",to:"90 -90 0",dur:150,easing:"linear"},position:{property:"position",to:"0.2 0 .0",dur:150,easing:"linear"}},{id:"#backLegL-joint",rotation:{property:"rotation",to:"90 -90 0",dur:150,easing:"linear"},position:{property:"position",to:".2 0 .05",dur:150,easing:"linear"}},{id:"#frontLegL-joint",rotation:{property:"rotation",to:"-45 0 0",dur:150,easing:"linear"},position:{property:"position",to:"0.12 -.19 0.05",dur:150,easing:"linear"}},{id:"#frontLegR-joint",rotation:{property:"rotation",to:"-45 0 0",dur:150,easing:"linear"},position:{property:"position",to:"-.12 -.19 -.05",dur:150,easing:"linear"}},{id:"#frontLowerLegL-joint",rotation:{property:"rotation",to:"-25 0 0",dur:150,easing:"linear"},position:{property:"position",to:"0 -.21 .03",dur:150,easing:"linear"}},{id:"#frontLowerLegR-joint",rotation:{property:"rotation",to:"-25 0 0",dur:150,easing:"linear"},position:{property:"position",to:"0 -.21 .03",dur:150,easing:"linear"}}],this.el.addEventListener(this.data.trigger,()=>{this.isMoving||(this.isMoving=!0,G(),this.startLegAnimations())}),this.el.addEventListener("stopjump",()=>{this.stopLegAnimations(),this.el.emit("startrun")})},startLegAnimations:function(){this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);if(i&&(t.rotation&&i.setAttribute("animation__jump"+e+"_rot",t.rotation),t.position)){const o=Object.assign({},t.position);if("cat"===i.id){let t=i.getAttribute("position");o.to=t.x+" "+this.data.height+" "+t.z,i.removeAttribute("animation__jump"+e+"_pos"),i.setAttribute("animation__jump"+e+"_pos",o),i.addEventListener("animationcomplete__jump"+e+"_pos",()=>{i.emit("stopjump")},{once:!0})}else i.setAttribute("animation__jump"+e+"_pos",o)}})},stopLegAnimations:function(){this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);i&&(i.removeAttribute("animation__jump"+e+"_rot"),i.removeAttribute("animation__jump"+e+"_pos"),"cat"===i.id&&i.addEventListener("animationcomplete__jump"+e+"_pos",()=>{i.emit("startrun")}))})}}),AFRAME.registerComponent("walk-on-trigger",{schema:{speed:{type:"number",default:2},trigger:{type:"string",default:"startwalk"},distance:{type:"number",default:3}},init:function(){this.isMoving=!1,this.startPos=null,this.travelled=0,this.legs=[{id:"#shoulders",rotation:{property:"rotation",from:"0 0 -15",to:"0 0 15",dur:225,easing:"linear",loop:!0,dir:"alternate"}},{id:"#torso-joint",rotation:{property:"position",from:"0 0.46 0.15",to:"0 0.44 0.15",dur:225,easing:"linear",loop:!0,dir:"alternate",delay:112}},{id:"#rear-joint",rotation:{property:"position",from:"0 -.22 .02",to:"0 -.22 .04",dur:225,easing:"linear",loop:!0,dir:"alternate"}},{id:"#backUpperLegL-joint",rotation:{property:"rotation",from:"75 0 90",to:"125 0 90",dur:450,easing:"linear",loop:!0,dir:"alternate"}},{id:"#backUpperLegR-joint",rotation:{property:"rotation",from:"125 0 90",to:"75 0 90",dur:450,easing:"linear",loop:!0,dir:"alternate"}},{id:"#backLegR-joint",rotation:{property:"rotation",from:"90 -85 0",to:"90 -75 0",dur:450,easing:"linear",loop:!0,dir:"alternate"}},{id:"#backLegL-joint",rotation:{property:"rotation",from:"90 -85 0",to:"90 -75 0",dur:450,easing:"linear",loop:!0,dir:"alternate"}},{id:"#frontLegL-joint",rotation:{property:"rotation",from:"45 0 0",to:"-25 0 0",dur:450,easing:"linear",loop:!0,dir:"alternate"}},{id:"#frontLegR-joint",rotation:{property:"rotation",from:"-25 0 0",to:"45 0 0",dur:450,easing:"linear",loop:!0,dir:"alternate"}},{id:"#frontLowerLegL-joint",rotation:{property:"rotation",from:"0 0 0",to:"-25 0 0",dur:450,easing:"linear",loop:!0,dir:"alternate"}},{id:"#frontLowerLegR-joint",rotation:{property:"rotation",from:"-25 0 0",to:"0 0 0",dur:450,easing:"linear",loop:!0,dir:"alternate"}}],this.el.addEventListener(this.data.trigger,t=>{const e=t.detail&&t.detail.distance?t.detail.distance:0;this.isMoving||(this.remainingDistance=e,this.startLegAnimations(),this.isMoving=!0)}),this.el.addEventListener("stopwalk",()=>{this.isMoving=!1,this.stopLegAnimations()})},startLegAnimations:function(){this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);i&&(t.rotation&&i.setAttribute("animation__walk"+e+"_rot",t.rotation),t.position&&i.setAttribute("animation__walk"+e+"_pos",t.position))})},stopLegAnimations:function(){this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);i&&(i.removeAttribute("animation__walk"+e+"_rot"),i.removeAttribute("animation__walk"+e+"_pos"))})},tick:function(t,e){if(!this.isMoving)return;const i=this.data.speed*(e/1e3);if(void 0!==this.remainingDistance&&this.remainingDistance>0){const t=new THREE.Vector3;this.el.object3D.getWorldDirection(t),t.multiplyScalar(i),this.el.object3D.position.add(t),this.remainingDistance-=i,this.remainingDistance<=0&&(this.isMoving=!1,this.stopLegAnimations(),this.el.emit("stopwalk"))}}}),AFRAME.registerComponent("run-on-trigger",{schema:{speed:{type:"number",default:1},trigger:{type:"string",default:"startrun"}},init:function(){this.isMoving=!1,this.legs=[{id:"#torso-joint",rotation:{property:"position",from:"0 0.46 0.15",to:"0 0.42 0.15",dur:150,easing:"linear",loop:!0,dir:"alternate",delay:112}},{id:"#rear-joint",rotation:{property:"position",from:"0 -.22 .02",to:"0 -.22 .08",dur:150,easing:"linear",loop:!0,dir:"alternate"}},{id:"#backUpperLegL-joint",rotation:{property:"rotation",from:"55 0 90",to:"165 0 90",dur:150,easing:"linear",loop:!0,dir:"alternate"}},{id:"#backUpperLegR-joint",rotation:{property:"rotation",from:"55 0 90",to:"165 0 90",dur:150,easing:"linear",loop:!0,dir:"alternate"}},{id:"#backLegR-joint",rotation:{property:"rotation",from:"90 -85 0",to:"90 -75 0",dur:150,easing:"linear",loop:!0,dir:"alternate"},position:{property:"position",from:"0.2 0 .05",to:"0.2 0 .0",dur:150,easing:"linear",loop:!0,dir:"alternate"}},{id:"#backLegL-joint",rotation:{property:"rotation",from:"90 -85 0",to:"90 -75 0",dur:150,easing:"linear",loop:!0,dir:"alternate"},position:{property:"position",from:"0.2 0 .05",to:"0.2 0 .0",dur:150,easing:"linear",loop:!0,dir:"alternate"}},{id:"#frontLegL-joint",rotation:{property:"rotation",from:"45 0 0",to:"-45 0 0",dur:150,easing:"linear",loop:!0,dir:"alternate"}},{id:"#frontLegR-joint",rotation:{property:"rotation",from:"45 0 0",to:"-45 0 0",dur:150,easing:"linear",loop:!0,dir:"alternate"}},{id:"#frontLowerLegL-joint",rotation:{property:"rotation",from:"0 0 0",to:"-25 0 0",dur:150,easing:"linear",loop:!0,dir:"alternate"},position:{property:"position",from:"0 -.21 0",to:"0 -.21 .03",dur:150,easing:"linear",loop:!0,dir:"alternate"}},{id:"#frontLowerLegR-joint",rotation:{property:"rotation",from:"0 0 0",to:"-25 0 0",dur:150,easing:"linear",loop:!0,dir:"alternate"},position:{property:"position",from:"0 -.21 0",to:"0 -.21 .03",dur:150,easing:"linear",loop:!0,dir:"alternate"}}],this.el.addEventListener(this.data.trigger,()=>{this.isMoving||this.startLegAnimations(),this.isMoving=!0}),this.el.addEventListener("stoprun",()=>{this.isMoving=!1,this.stopLegAnimations()})},startLegAnimations:function(){this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);i&&(t.rotation&&i.setAttribute("animation__run"+e+"_rot",t.rotation),t.position&&i.setAttribute("animation__run"+e+"_pos",t.position))})},stopLegAnimations:function(){this.legs.forEach((t,e)=>{const i=document.querySelector(t.id);i&&(i.removeAttribute("animation__run"+e+"_rot"),i.removeAttribute("animation__run"+e+"_pos"))})},tick:function(t,e){this.isMoving}}),AFRAME.registerComponent("sit-stand",{schema:{dur:{type:"int",default:250},easing:{type:"string",default:"easeInSine"}},init:function(){this.legs=[{id:"#head-joint",sit:{position:"0 0.34 0.10",rotation:"0 0 0"},stand:{position:"0 0.26 0.22",rotation:"0 0 0"}},{id:"#torso-joint",sit:{position:"0 .46 0.15",rotation:"0 0 0"},stand:{position:"0 .46 0.15",rotation:"0 0 0"}},{id:"#spine-joint",sit:{rotation:"45 0 0",position:"0 0.39 0"},stand:{rotation:"87 0 0",position:"0 0.47 -0.06"}},{id:"#rear-joint",sit:{position:"0 -.22 .02",rotation:"0 0 0"},stand:{position:"0 -.22 .02",rotation:"0 0 0"}},{id:"#backUpperLegR-joint",sit:{rotation:"0 0 90"},stand:{rotation:"90 0 90"}},{id:"#backUpperLegL-joint",sit:{rotation:"0 0 90"},stand:{rotation:"90 0 90"}},{id:"#backLegR-joint",sit:{position:"0.2 0 -.05",rotation:"90 -135 90"},stand:{position:"0.02 0 .1",rotation:"90 -90 0"}},{id:"#backLegL-joint",sit:{position:"0.2 0 -.05",rotation:"90 -135 90"},stand:{position:"0.02 0 .1",rotation:"90 -90 0"}},{id:"#frontLegR-joint",sit:{rotation:"0 0 10",position:"-0.09 -0.21 0.1"},stand:{rotation:"0 0 0",position:"-0.12 -0.19 0.05"}},{id:"#frontLegL-joint",sit:{rotation:"0 0 -10",position:"0.09 -0.21 0.1"},stand:{rotation:"0 0 0",position:"0.12 -0.19 0.05"}},{id:"#frontLowerLegR-joint",sit:{position:"0 -0.18 .01",rotation:"0 0 -5"},stand:{position:"0 -0.18 .01",rotation:"0 0 0"}},{id:"#frontLowerLegL-joint",sit:{position:"0 -0.18 .01",rotation:"0 0 5"},stand:{position:"0 -0.18 .01",rotation:"0 0 0"}},{id:"#tail-joint",sit:{rotation:"-20 0 0",position:"0 -0.15 -0.15"},stand:{rotation:"30 0 0",position:"0 -0.20 -0.18"}}],this.el.addEventListener("catsit",()=>this.startLegAnimations("sit")),this.el.addEventListener("catstand",()=>this.startLegAnimations("stand"))},startLegAnimations:function(t){this.legs.forEach((e,i)=>{const o=document.querySelector(e.id);o&&(o.removeAttribute("animation__pounce"+i+"_rot"),o.removeAttribute("animation__pounce"+i+"_pos"),o.removeAttribute("animation__pounce"+i+"_scale"),e[t].rotation&&(o.removeAttribute("animation__sitstand"+i+"_rot"),o.setAttribute("animation__sitstand"+i+"_rot",{property:"rotation",to:e[t].rotation,dur:this.data.dur,easing:this.data.easing})),e[t].position&&(o.removeAttribute("animation__sitstand"+i+"_pos"),o.setAttribute("animation__sitstand"+i+"_pos",{property:"position",to:e[t].position,dur:this.data.dur,easing:this.data.easing})))})}}),AFRAME.registerComponent("grid-floor",{schema:{w:{default:8},h:{default:8},size:{default:1}},init(){const t=this.data.size,e=document.getElementById("gridTexture"),i=new THREE.CanvasTexture(e),o=e.getContext("2d");o.fillStyle="#fff",o.fillRect(0,0,e.width,e.height),o.strokeStyle="#999",o.lineWidth=1;for(let t=0;t<=e.width;t+=64)o.beginPath(),o.moveTo(t,0),o.lineTo(t,e.height),o.stroke(),o.moveTo(0,t),o.lineTo(e.width,t),o.stroke();i.wrapS=i.wrapT=THREE.RepeatWrapping,i.repeat.set(.25,.25);for(let e=0;e<this.data.h;e++)for(let o=0;o<this.data.w;o++){const r=document.createElement("a-plane");r.classList.add("floor-tile"),r.setAttribute("rotation","-90 0 0"),r.setAttribute("width",t),r.setAttribute("height",t),r.setAttribute("position",(o-this.data.w/2+.5)*t+" 0 "+(e-this.data.h/2+.5)*t),r.addEventListener("loaded",()=>{const t=r.getObject3D("mesh");t&&(t.material.map=i,t.material.needsUpdate=!0)}),r.dataset.gx=o,r.dataset.gz=e,this.el.appendChild(r)}}}),AFRAME.registerComponent("blink",{init:function(){const t=this.el.querySelectorAll(".eye"),e=[],i=[];t.forEach((t,o)=>{const r={...t.getAttribute("position")};e[o]=r,i[o]={x:r.x,y:r.y,z:.1}}),setTimeout(function o(){t.forEach((t,o)=>{t.removeAttribute("animation__close"),t.removeAttribute("animation__open"),t.setAttribute("animation__close",{property:"position",to:i[o],dur:100,easing:"easeInSine"}),t.addEventListener("animationcomplete__close",function i(){t.removeEventListener("animationcomplete__close",i),t.setAttribute("animation__open",{property:"position",to:e[o],dur:100,easing:"easeOutSine"})})});const r=2e3+2e3*Math.random();setTimeout(o,r)},2e3)}}),AFRAME.registerComponent("look-at-cursor",{schema:{maxAngle:{type:"number",default:90}},init:function(){this.cursor=document.querySelector("#rightHand"),this.initialRotationY=this.el.object3D.rotation.y},tick:function(){const t=this.cursor.components.raycaster?.intersections;if(!t||0===t.length)return;const e=t[0].point.clone(),i=this.el.object3D,o=new THREE.Vector3;i.getWorldPosition(o);const r=e.clone().sub(o),n=i.parent.worldToLocal(r.clone().add(o)).sub(i.position),a=Math.atan2(n.x,n.z),s=-Math.atan2(n.y,Math.sqrt(n.x*n.x+n.z*n.z)),c=THREE.MathUtils.degToRad(this.data.maxAngle);let p=a;p=THREE.MathUtils.clamp(p,-c,c),i.rotation.order="YXZ",i.rotation.set(s,this.initialRotationY+p,0)}}),AFRAME.registerComponent("spotlight-detector",{schema:{target:{type:"selector"},angle:{type:"number",default:15},range:{type:"number",default:25},obstacles:{type:"string",default:".blocking-obj"}},init(){this.raycaster=new THREE.Raycaster,this.dir=new THREE.Vector3,this.v=new THREE.Vector3},tick(){if(!this.data.target&&(this.data.target=this.el.sceneEl.querySelector("#cat"),!this.data.target))return;const t=this.el.object3D,e=this.data.target.object3D,i=new THREE.Vector3,o=new THREE.Vector3;t.getWorldPosition(i),e.getWorldPosition(o),this.v.subVectors(o,i);const r=this.v.length();if(r>this.data.range)return;if(this.v.normalize(),this.dir.set(0,0,-1).applyQuaternion(t.quaternion).normalize(),THREE.MathUtils.radToDeg(this.dir.angleTo(this.v))>this.data.angle/2)return;const n=[];e.traverse(t=>{t.isMesh&&n.push(t)}),Array.from(document.querySelectorAll(this.data.obstacles)).map(t=>t.object3D).forEach(t=>{t.traverse(t=>{t.isMesh&&n.push(t)})}),this.raycaster.set(i,this.v),this.raycaster.far=r;const s=this.raycaster.intersectObjects(n,!0);if(s.length>0){const t=s[0].object;let e=!1;if(t.traverseAncestors(t=>{t.el&&"cat"===t.el.id&&(e=!0)}),e){setTimeout(()=>{this.data.target.emit("startjump"),a.paused&&(a.currentTime=0,a.play())},0);let t=document.querySelector("#cat");this.data.runningHome=!0;const e=t.components["path-recorder"];t.components["retrace-path"].startRetrace(e.getPath())}}}}),AFRAME.registerComponent("path-recorder",{schema:{interval:{type:"number",default:200}},init:function(){this.points=[],this.time=0},clearPoints:function(){this.points=[],this.time=0},tick:function(t,e){if(this.time+=e,this.time<this.data.interval)return;this.time=0;const i=this.el.object3D.position.clone();(!this.points.length||i.distanceTo(this.points[this.points.length-1])>.2)&&(i.y=.45,this.points.push(i))},getPath:function(){return this.points.slice()}}),AFRAME.registerComponent("retrace-path",{schema:{speed:{type:"number",default:7}},init:function(){this.path=null,this.current=0},startRetrace:function(t){this.path=t.reverse(),this.current=0,this.el.emit("startrun")},tick:function(t,e){if(!this.path||this.current>=this.path.length)return void(this.el.components["run-on-trigger"].isMoving&&(this.el.emit("stoprun"),document.querySelector("#cat").components["path-recorder"].clearPoints()));const i=this.el.object3D.position,o=this.path[this.current],r=o.clone().sub(i);r.length()<.1?this.current++:(r.normalize(),i.addScaledVector(r,.001*e*this.data.speed),this.el.object3D.lookAt(o))}}),AFRAME.registerComponent("mirror-laser",{schema:{target:{type:"selector"},mirrorZ:{type:"number",default:-5}},tick:function(){const t=this.el,e=this.data.target,i=this.data.mirrorZ,o=t.getAttribute("line");if(!o)return;const r=new THREE.Vector3(o.start.x,o.start.y,o.start.z),n=new THREE.Vector3(o.end.x,o.end.y,o.end.z);t.object3D.localToWorld(r),t.object3D.localToWorld(n),r.z=2*i-r.z,n.z=2*i-n.z,e.setAttribute("line",{start:r,end:n,color:"#fff"})}}),AFRAME.registerComponent("mirror-figure",{schema:{target:{type:"selector"}},tick:function(){if(!this.data.target)return;const t=new THREE.Vector3;this.data.target.object3D.getWorldPosition(t),this.el.object3D.position.x=t.x}}),AFRAME.registerComponent("mirror-children",{schema:{target:{type:"selector"},axis:{type:"string",default:"z"},mirrorPos:{type:"number",default:-7.9}},tick:function(){if(!this.data.target)return;srcPosition=this.data.target.getAttribute("position"),this.el.object3D.position.copy(this.data.target.getAttribute("position")),this.el.setAttribute("position",srcPosition.x+" "+srcPosition.y+" "+(this.data.mirrorPos-srcPosition.z+this.data.mirrorPos)),this.el.object3D.quaternion.copy(this.data.target.object3D.quaternion);const t=this.data.target.children,e=this.el.children;srcRotation=this.data.target.getAttribute("rotation"),this.el.setAttribute("rotation",srcRotation.x+" "+(180-srcRotation.y)+" "+srcRotation.z);for(let i=0;i<Math.min(t.length,e.length);i++){const o=t[i].object3D,r=e[i].object3D;r.quaternion.copy(o.quaternion),r.position.copy(o.position)}}}),AFRAME.registerComponent("tile-hover",{init:function(){this.hover=document.querySelector("#hover"),this.rightHand=document.querySelector("#rightHand"),this.currentTile=null,this.rightHand.addEventListener("raycaster-intersection",t=>{const e=t.detail.intersections[0]?.object?.el;e&&e.classList.contains("floor-tile")&&(this.currentTile=e)}),this.rightHand.addEventListener("raycaster-intersection-cleared",()=>{this.currentTile=null,this.hover.setAttribute("visible",!1)})},tick:function(){if(this.currentTile)if(U(this.currentTile,s)){const t=this.currentTile.getAttribute("position");this.hover.setAttribute("position",t.x+" 0.425 "+t.z),this.hover.setAttribute("visible",!0)}else this.hover.setAttribute("visible",!1)}});let X=!1,K=!1;document.addEventListener("DOMContentLoaded",()=>{e=document.querySelector("#scene"),o=document.querySelector("#room"),e.addEventListener("loaded",()=>{c=k(g,e),k(A,e),function(){const t=document.getElementById("scene");for(let e=0;e<47;e++){let i=e*(2*Math.PI/47),o=100*Math.cos(i),r=100*Math.sin(i),n=20+80*Math.random(),a=document.createElement("a-box");a.setAttribute("position",o+" "+(n/2-1)+" "+(r-10)),a.setAttribute("depth",20),a.setAttribute("width",30),a.setAttribute("height",n),a.setAttribute("color","#222"),a.setAttribute("class","building"),t.appendChild(a)}}(),k(q,e),k(x,e);const t=document.querySelector("#rightHand"),i=document.querySelector("#hover");t&&(t.addEventListener("raycaster-intersection",t=>function(t){if(!t.detail.intersections.length)return void hover.setAttribute("visible",!1);const e=t.detail.intersections[0]?.object?.el;if(e&&e.classList.contains("floor-tile")&&U(e,s)){const t=e.getAttribute("position");hover.setAttribute("position",t.x+" 0.425 "+t.z),hover.setAttribute("visible",!0)}else hover.setAttribute("visible",!1)}(t)),t.addEventListener("raycaster-intersection-cleared",()=>{i.setAttribute("visible",!1)}),t.addEventListener("click",t=>I(t)));for(let t=-5.5;t<=7.5;t+=1.5){let i=document.createElement("a-cylinder");i.setAttribute("class","laser"),i.setAttribute("geometry","radius:.01;height:21"),i.setAttribute("rotation","90 0 0"),i.setAttribute("position",t+" 2.2 -7.5"),i.setAttribute("material","color:#f00;opacity:.3;emissive:#f66"),e.appendChild(i)}let o=new THREE.BufferGeometry,r=new Float32Array(6e3);for(let t=0;t<2e3;t++){let e=(new THREE.Vector3).randomDirection().multiplyScalar(150);r.set([e.x,e.y,e.z],3*t)}o.setAttribute("position",new THREE.BufferAttribute(r,3));let n=new THREE.PointsMaterial({color:16777215,size:.2,sizeAttenuation:!1}),a=new THREE.Points(o,n);e.object3D.add(a),document.addEventListener("click",function(){P()})})})</script><canvas id=gridTexture style=display:none height=64 width=64></canvas><canvas id=ventTexture style=display:none></canvas><canvas id=brickTexture style=display:none height=512 width=128></canvas><canvas id=brickTexture2 style=display:none height=128 width=128></canvas><canvas id=cityCanvas style=display:none height=211 width=211></canvas><a-scene background="color: #111" fog="type: exponential; color: #AAA" id=scene shadow="type: pcfsoft"><a-entity id=room></a-entity><a-entity id=reflection-cat></a-entity><a-entity id=menu position="200 3.5 -4" geometry=type:box;width:30;height:30;depth:30 material=color:#222;side:double><a-text position="-2.3 .5 0" value="INSIDE CAT" scale="4 4 4"></a-text><a-plane class=clickable height=.5 id=startLevel1 material=emissive:#00f onclick=startGame(1) position="-2 -.55 0" width=1.5><a-text position="-.35 0 .1" value="LEVEL 1" color=#fff></a-text></a-plane><a-plane class=clickable height=.5 id=startLevel2 material=emissive:#006 onclick=startGame(2) position="0 -.55 0" width=1.5><a-text position="-.35 0 .1" value="LEVEL 2" color=#fff></a-text></a-plane></a-entity><a-entity class=fader fade-trigger light="type: ambient; intensity: 0"></a-entity><a-entity id=rig position="200 1.2 3.2" rotation="0 0 0"><a-camera></a-camera><a-entity id=rightHand laser-controls="hand: right" raycaster="objects: .floor-tile, .button, .clickable; ignore: .nohit; sort: true"></a-entity></a-entity><a-entity id=player position="0 3 -19.4"><a-sphere color=#999 position="0 0 0" radius=.25></a-sphere><a-cone color=#999 height=.2 position="0 -.25 0" radius-bottom=.3 radius-top=.1></a-cone><a-cylinder color=#999 height=1 position="0 -.85 0" radius=.3></a-cylinder></a-entity></a-scene>