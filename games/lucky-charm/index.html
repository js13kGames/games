<!doctype html><meta name=viewport content="width=device-width,viewport-fit=cover"><meta name=theme-color content=#ffea64><title>Lucky Charm - js13kGames 2025</title><style>body,html{background:#ffea64;font-family:Impact;margin:0}body,canvas,html,main{height:100vh;overflow:hidden;width:100vw}canvas,main{position:absolute}[hidden]{display:none}[onclick]{cursor:pointer}h1,h2{background-color:#000;color:#fff;padding:.25em .5em;text-align:center;transform:skewX(-10deg) rotate(-2deg)}h2{font-size:min(15vw,10vh)}h3{color:#fff;font-size:min(10vw,6vh);margin:0;-webkit-text-stroke:1px #000;text-shadow:2px 2px 0 #000}p{margin:.5em 0 0}button{border:4px solid #000;border-radius:0;line-height:1;text-shadow:none}button,div[onclick]{background:#fff;box-shadow:4px 4px 0 #000c;cursor:pointer;padding:1em;text-align:center;transform:skewX(-10deg) rotate(-2deg)}div[onclick]{border:4px solid #000;margin:0 20px;transition:all .2s;width:calc(100% - 80px)}button:hover,div[onclick]:hover{box-shadow:6px 6px 0 #000c;transform:skewX(-10deg) rotate(-2deg) scale(1.05)}@keyframes rotate-background{0%{transform:rotate(0)}to{transform:rotate(1turn)}}@keyframes translate-background{0%{transform:translate(0)}to{transform:translate(20px,20px)}}.translate-background{position:fixed;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;background:#ffea64}.translate-background::before{content:"";position:absolute;top:-100%;left:-100%;right:-100%;bottom:-100%;background-image:radial-gradient(#fddd50 20%,transparent 0),radial-gradient(#fddd50 20%,transparent 0);background-size:20px 20px;background-position:0 0,10px 10px;animation:translate-background 4s linear infinite;z-index:-1}.u{position:relative;padding:15px;border:2px solid #333;border-radius:8px;background:rgba(255,255,255,.9);transition:transform .1s ease}.u:hover{transform:scale(1.05)}.r{position:absolute;top:-1px;left:-1px;background:#000;color:#fff;font-size:2vmin;padding:2px 6px;border-bottom-right-radius:6px;letter-spacing:1px;z-index:-1}@keyframes top-forwards{0%{top:-20%}20%{top:45%}80%{top:47%}100%{top:120%}}.rotate-background{position:fixed;top:0;left:0;right:0;bottom:0;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:20px}.rotate-background::before{content:"";position:absolute;top:-100%;left:-100%;right:-100%;bottom:-100%;background:repeating-conic-gradient(from 0deg at 50% 50%,#f44336cc 0 6deg,#d32f2fcc 0 12deg);animation:rotate-background 20s linear infinite;z-index:-1}</style><img hidden src="data:image/webp;base64,UklGRiwDAABXRUJQVlA4TCADAAAvEcCqEBLJDeDWlbN95JxTuvkXmFJyTRk5bg8BLJJDf9byUfYbEwIEE6Yi2Xgh/MqmiUJaKLYKIVmhnkcAzyCLf5aJhFX/HUiSGjcLyGfOkRBKftA+pr0FJN77ekqCvXeczFYU+w2g6ZOBCxTWdtie+UEPqM87N3Lef+19Q933lx4knifpueXgGZ1iI9J/PxluYM8hfXLdWB17Y17PaAE3mQk3EWFrMqTmkvmKFUQohwDaZmb6JwIKi8JLiupE4OcnnfiqrsRdIJgKnmZHpsHNEGuXh9m2mocNojWayWZMZQ52SEmyeUgtUWlUqfZYqfs3+oriRVQndPR6OuC1rdRUm1rVkGjvui6SYO+0duTeZHKn6Lku2Ux6pJ5pR+49SsXEnqGzuIhT61Q6leTzXeLptPSBFk3pr4ZK4PuTezjR7Ftfxj2Qf/5GFiMI4By5jshMMsUTGnuqESeZzCFF5uDBICXkIEVMikll4v4PUkvHEqtykWZsPSU9IPW+EbF3V0rd3/VJRCyh3gMH8uhYvb9jTG4ronizXQbw3vd40RcxP3oPJzoHqYZJrcVuj7s/ZrkYu8DsME0ByiXkfX/ZvbFYKoUEjEJqif7vYRfdpUX6f63gRWCaHdPE7Pq22FUAp+9nwt6XGRF1ZJeG7aIqZP+i4YgIjzwHh8LCA9PhM0AdgHXgSLUO9DXQ7S+CYwyyWYeZlPekcr18NJfb1OtJ+3JmuacBcVKdeZJD8KTJQMFjgziHtSkxBulgV4NRwky6NI8mcWQKnMeD3SojYiwxIsaANFlo7vffe1bx0w6VfSp5vahfQKn3l7BM5a9H2+SoGeNFfHqdnlvljEEOFURJdzCTVtJFBQFdBQHHkJUGVHVI0SRFBcrIsZlUoOBfB2STMiuvcgyLM/mIozBz0aBJNHHl3BEhccKf3WtBM5lJjzZZU5V70OxfxEqS0gkCoqKtwZRXEGA2uD5ic6hGpFSW9VXgEBUQiY/tFaWZ0iuWMdZYu3u4ZOYSI8LB7nCtMQU7EqcV7k9Bi2MQnv01gSeTcZ4n6qVTwJTBceJpfJCe59q+NQ=="><canvas></canvas><main></main><script>function e(e,t){let n=function(e){if(e.t.length>0){let t=e.t.pop();return e.i[t]=0,t}return e.i.push(0)-1}(e.o);for(let o of t)o&&o(e,n);return n}function t(e){$t=198706*e}function n(){return(($t=16807*$t%2147483647)-1)/2147483646}function o(e=0,t=1){return~~(n()*(t-e+1)+e)}function i(e=0,t=1){return n()*(t-e)+e}function r(e){return e[o(0,e.length-1)]}function a(e,t,n=.5){return(o,i)=>{o.o.i[i]|=8,o.o.l[i]={u:i,m:e,h:t,p:n,k:[0,0],v:[]}}}function l(e,t=0){return(n,o)=>{n.o.i[o]|=128,n.o.M[o]={C:e,R:t,T:0}}}function u(e,t){return(n,o)=>{n.o.i[o]|=2048,n.o.S[o]={I:e,N:0,D:t}}}function c(e,t,n){return e[0]=t,e[1]=n,e}function f(e,t){return e[0]=t[0],e[1]=t[1],e}function s(e,t,n){return e[0]=t[0]+n[0],e[1]=t[1]+n[1],e}function h(e,t,n){return e[0]=t[0]-n[0],e[1]=t[1]-n[1],e}function d(e,t,n){return e[0]=t[0]*n,e[1]=t[1]*n,e}function m(e,t){let n=t[0],o=t[1],i=n*n+o*o;return i>0&&(i=1/Math.sqrt(i)),e[0]=t[0]*i,e[1]=t[1]*i,e}function b(e,t,n){let o=Math.cos(n),i=Math.sin(n);return e[0]=o*t[0]-i*t[1],e[1]=i*t[0]+o*t[1],e}function g(e){return Math.hypot(e[0],e[1])}function p(e,t){return Math.hypot(t[0]-e[0],t[1]-e[1])}function v(e=[0,0],t=0,n=[1,1]){return(o,i)=>{o.o.i[i]|=4352,o.o.A[i]={$:e,L:t,P:n}}}function k(e,t){return(n,o)=>{let i=n.o.A[o];i.$[0]=e,i.$[1]=t}}function w(e){return(t,n)=>{f(t.o.A[n].$,e)}}function M(e,t,n){let o=t[0],i=t[1],r=t[2],a=t[3],l=t[4],u=t[5],c=n[0],f=n[1],s=n[2],h=n[3],d=n[4],m=n[5];return e[0]=o*c+r*f,e[1]=i*c+a*f,e[2]=o*s+r*h,e[3]=i*s+a*h,e[4]=o*d+r*m+l,e[5]=i*d+a*m+u,e}function x(e,t){return e[0]=t[4],e[1]=t[5],e}function A(){return(e,t)=>{e.o.i[t]|=262400,e.o.H[t]={o:e.o.F.subarray(t*Ft,t*Ft+6),B:[1,0,0,1,0,0]}}}function $(e,t,n,o,i,r=0){return(a,l)=>{a.o.O[l]={U:0,G:e,W:r,V:t,j:0,q:n,Y:o,K:i,J:!1},a.o.i[l]|=524288}}function y(e,t,n,o,i,r=0,a=!1){return(l,u)=>{l.o.O[u]={U:1,G:e,X:r,V:t,j:0,q:n,Y:o,K:i,J:a},l.o.i[u]|=524288}}function L(e,t,n){let o=e.createShader(t);return e.shaderSource(o,n),e.compileShader(o),o}function C(e,n){t(n+12345*e);let r=e,a=[],l=function(){let e=[...Qt];for(let t=e.length-1;t>0;t--){let n=o(0,t);[e[t],e[n]]=[e[n],e[t]]}return e}();for(;r>0&&l.length>0;){let e=_(l),t=e._.length,n=Math.min(t,r),o=i()<.7?1:Math.min(n,Math.floor(i()*t)+1);a.push({id:e.Z,tier:o}),r-=o,l=l.filter(t=>t.Z!==e.Z)}return a}function F(e,n,o){t(o+54321*e+98765);let i=new Set(n.map(e=>e.id)),r=[];if(1===e){let e=Qt.filter(e=>0===e.ee);if(e.length>0){let t=_(e);r.push({id:t.Z,tier:1})}}for(;r.length<3;){let e=Qt.filter(e=>{if(r.some(t=>t.id===e.Z))return!1;if(!i.has(e.Z))return!0;let t=n.find(t=>t.id===e.Z);return t&&t.tier<e._.length});if(0===e.length)break;let t=P(e.map(e=>{let t=n.find(t=>t.id===e.Z);return{upgrade:e,tier:t?t.tier+1:1}}));r.push({id:t.upgrade.Z,tier:t.tier})}return r}function Z(e,t){return Math.min(3,e+(t-1))}function P(e){let t=0;for(let n of e)t+=Q(Z(n.upgrade.te,n.tier));let n=i()*t,o=0;for(let t of e)if(o+=Q(Z(t.upgrade.te,t.tier)),n<=o)return t;return e[e.length-1]}function _(e){let t=0;for(let n of e)t+=Q(n.te);let n=i()*t,o=0;for(let t of e)if(o+=Q(t.te),n<=o)return t;return e[e.length-1]}function Q(e){switch(e){case 0:default:return 70;case 1:return 25;case 2:return 4;case 3:return 1}}function H(){let e=[],t=Math.floor(1e6*Math.random());return{currentLevel:1,playerUpgrades:e,opponentUpgrades:C(1,t),availableUpgradeChoices:F(1,e,t),isNewRun:!0,runSeed:t}}function q(...t){return(n,o)=>{64&n.o.i[o]||(n.o.i[o]|=64,n.o.ne[o]={ne:[]});let i=n.o.ne[o].ne;for(let o of t){let t=e(n,o);i.push(t)}}}function*S(e,t,n){if((e.i[t]&n)===n&&(yield t),64&e.i[t])for(let o of e.ne[t].ne)yield*S(e,o,n)}function I(e,t,n){64&e.o.i[n]||(e.o.i[n]|=64,e.o.ne[n]={ne:[]}),e.o.ne[n].ne.push(t)}function U(e,t){if(64&e.i[t])for(let n of e.ne[t].ne)U(e,n);0===e.i[t]||function(e,t){e.i[t]=0,e.t.push(t)}(e,t)}function D(e,t){return-1!==t&&(e.o.i[t]&St)===St}function O(e,t){let n=e.o.A[t],o=e.o.ae[t];if(!n||!o)return-1;let i=-1,r=1/0;for(let a=0;a<e.o.i.length;a++){if(a===t)continue;if(!D(e,a))continue;let l=e.o.re[a];if(l&&l.ie===o.oe)continue;let u=[0,0];h(u,e.o.A[a].$,n.$);let c=g(u);c<r&&(r=c,i=a)}return i}function R(e,t,n){let o=-1;for(let n of S(e.o,t,32768))if(n!==t){o=n;break}if(-1===o)return;let i=e.o.A[o],r=n[0]<0?-1:1;i.P[0]!==r&&(i.P[0]=r,e.o.i[o]|=256)}function N(e,t,n){for(let o of S(e.o,t,2101248))if(o!==t){let t=e.o.A[o],i=n[0]<0?-.5:.5;t.$[0]!==i&&(t.$[0]=i,e.o.i[o]|=256)}}function T(e=.1,t){return(n,o)=>{n.o.i[o]|=1,n.o.ae[o]={le:-1,ce:1/0,ue:[0,0],fe:0,se:e,de:0,oe:t}}}function W(e,t=0){let n={};for(let t in e){let o=0,i={};for(let n in e[t])o+=e[t][n],i[n]=o;n[t]={me:i,X:o}}return(e,o)=>{e.o.i[o]|=2,e.o.he[o]={ge:n,ye:t,pe:0}}}function J(e,t,n){let o=e.o.he[t];o.ge[n]&&(o.ye=n,o.pe=0)}function V(e,t){return(n,o)=>{let r,a,l,u,c;n.o.i[o]|=16,e?(r=1,a=1,l=.5,u=.5,c=1):(r=.5+i(0,1.5),a=.7+i(0,1.3),l=i(0,3),u=i(0,2),c=i(0,1)>.5?1:-1),n.o.re[o]={be:0,ke:n.pe,ve:l,Me:c,we:u,ie:e,Ce:0,xe:t,Re:r,Te:a,Se:0,Ie:0,Ne:1,De:0,Ae:!1,Ee:0,$e:0}}}function B(e=3){return(t,n)=>{t.o.i[n]|=512,t.o.Le[n]={Pe:e,He:e,T:0,Fe:[],Be:[],Oe:0,Ue:0,Ge:0,ze:0}}}function E(e,t){return(n,o)=>{n.o.i[o]|=8192,n.o.We[o]={Ve:e,je:t,qe:[0,0],L:0}}}function G(e,t,n){return Math.max(e,Math.min(t,n))}function j(e,t=[1,1,1,1]){return(n,o)=>{let i=o*Ft;n.o.F[i+6]=0,n.o.F[i+7]=32768,n.o.F[i+8]=t[0],n.o.F[i+9]=t[1],n.o.F[i+10]=t[2],n.o.F[i+11]=t[3],n.o.F[i+12]=1,n.o.F[i+13]=18*e+1,n.o.F[i+14]=16,n.o.F[i+15]=16,n.o.i[o]|=32768,n.o.Ye[o]={Ke:n.o.F.subarray(i+6,i+8),Je:n.o.F.subarray(i+8,i+12),Xe:n.o.F.subarray(i+12,i+16)}}}function X(e){return(t,n)=>{t.o.F[n*Ft+6]=G(-1,1,e)}}function Y(e,t,n){let o=t*Ft;e.o.F[o+12]=1,e.o.F[o+13]=18*n+1,e.o.F[o+14]=16,e.o.F[o+15]=16}function z(e){return(t,n)=>{t.o.i[n]|=1024,t.o._e[n]={Qe:e}}}function K(e,t){if(1048576&e.i[t])return e.et[t].Ze;let n=e.H[t];return n&&void 0!==n.tt?K(e,n.tt):t}function ee(e,t=1/0){return(n,o)=>{n.o.i[o]|=131072,n.o.nt[o]={p:e,X:t,rt:t}}}function te(e=.1){return(t,n)=>{t.o.it[n]={q:e},t.o.i[n]|=16384}}function ne(e,t=1,n=.001,o=[0,-66]){return(i,r)=>{i.o.i[r]|=65536,i.o.ot[r]={lt:e,ct:G(0,1,n),ut:G(0,1,t),ft:[o[0],o[1]],st:[0,0],dt:[0,0],ht:[0,0]}}}function oe(){return[!1,v(),j(27,[.8,0,0,.9]),ne(1,0,.8,[0,-1]),te(.8),u(1)]}function ie(e,t){let n=t?It:Ut;return[A(),v(),j(29,n),W({0:{29:.1,30:.1,31:.1,32:.1,33:.1,34:.1,35:.1,36:.1},1:{23:.1,24:.1,25:.1,26:.1},2:{11:.3,12:.4}},0)]}function re(e,t){let n=2+2*(e.be.currentLevel-1);return[A(),v(),V(t,4),a(2,3,.5),B(n),E(4,0),T(.1,t),q(ie(0,t),[z("b"),A(),v(),ee(.4),$(oe,.05,Math.PI,2,4)]),l(.5,1)]}function ae(e=1){return[!1,v(),j(10),a(1,0),ne(0,0,0,[0,0]),B(2*e)]}function le(e,t,n,o){return(i,r)=>{i.o.i[r]|=16;let a=Math.random()>.5?1:-1;i.o.re[r]={be:0,ke:i.pe,ve:.2,Me:a,we:.3,ie:e,Ce:1,xe:t,Re:n,Te:o,Se:0,Ie:0,Ee:0,Ne:1,De:0,Ae:!1,$e:0}}}function ue(e){let t=e?It:Ut;return[A(),v(),j(6,t),W({0:{6:.1,7:.1,8:.1,9:.1},2:{2:.1,3:.1,4:.1,5:1/0}})]}function ce(e,t,n,o,i){return[A(),v(),le(e,n,o,i),a(2,3,.4),B(t),E(n,0),T(.1,e),q(ue(e)),l(1,1)]}function fe(e,t,n=1){return(o,r)=>{o.o.i[r]|=2097152,o.o.gt[r]={Range:e,R:t,j:i(0,t),yt:n}}}function se(){return[!1,v(),j(13),a(8,3,.1),ne(1,0,.5,[0,-2]),u(2,6)]}function he(){return[!1,A(),v(),fe(8,3,1),$(se,0,.1,4,6,1)]}function de(e){return[...ce(e,2,2.8,2,.1),q(he()),T(.03,e)]}function me(e){return[...ce(e,10,1.5,.1,3),T(.8,e)]}function be(){return[!1,v(),j(29,[1,1,1,.3]),X(1),te(0),a(16,2,1),l(1,.1),u(5)]}function ge(e){return[...ce(e,2,3.2,1.8,.2),y(()=>be(),.2,0,0,0,10)]}function pe(e){return[...ce(e,3,4.2,2.5,.1),T(.02,e)]}function ve(e=0){return[A(),v(),$(()=>{return e=[0,0],[A(),v(e),j(20),X(.1),u(0)];var e},e,0,0,0)]}function ke(e,t){return(n,o)=>{n.o.i[o]|=32,n.o.bt[o]={qe:e,L:t}}}function we(){return[!1,A(),v(),fe(8,3,1),$((e,t)=>{let n=K(e.o,t);return function(e=!0){return[!1,A(),v(),T(.1,e),ke(null,0),E(Dt,0),a(8,3,.15),u(Ot),l(2,0),q([A(),v(),j(0),ke(null,1),E(0,180)])]}(e.o.re[n].ie)},.3,.05,3,4),q(ve(.3))]}function Me(e){return[...ce(e,3,1.8,.8,2),q(we()),T(.3,e)]}function xe(e){return[...ce(e,1,2.5,2,.1),l(5,0),u(10,6)]}function Ae(e){return[!1,A(),v(),j(27,[0,0,0,1]),a(8,3,.05),ne(1,0,0,[0,0]),l(e),u(4),y((e,t)=>[!1,v(),j(27,[1,1,0,.8]),te(0),u(1)],.05,0,0,0,1/0)]}function $e(){return[!1,A(),v(),fe(4,2.5,5),$(()=>Ae(1),0,.5,9,11),q(ve(0))]}function ye(e){return[...ce(e,7,1.3,.5,2.5),q($e()),T(.15,e)]}function Le(){return[!1,v(),j(1),a(8,3,.1),ne(1,0,.5,[0,-2]),u(2,7)]}function Ce(){return[!1,A(),v(),a(8,1,.1),ne(1,0,.8,[0,0]),y(()=>[!1,v(),j(27,[.6,.6,1,1]),ne(1,0,.9,[0,0]),te(.8),a(16,3,.15),l(1),u(6)],1/16,2*Math.PI,2,4,1/0),u(6),q([A(),v(),j(37),ke(null,-1),E(0,3600)])]}function Fe(e,t,n){for(let o of n){let n=_t[o.id];if(n)switch(n.ee){case 0:_e(e,t,n);break;case 1:Qe(e,t,n);break;case 2:Ze(e,t,n,o.tier);break;case 3:Pe(e,t,n)}}}function Ze(e,t,n,o){let i=e.o.re[t],r=e.o.We[t],a=e.o.Le[t];switch(n.Z){case 25:i.Se+=.1+.2*o;break;case 26:i.Ne*=1-.25*o;break;case 27:i.De+=o;break;case 28:i.Ne*=2,i.De+=3;break;case 29:i.kt=.2*o;break;case 30:i.Ie+=.2*o;break;case 31:i.Ae=!0;break;case 32:i.Ee+=.4;break;case 33:i.$e+=.25*o;break;case 34:let e=1+.25*o;r.Ve*=e,i.xe*=e,i.vt=(i.vt||1)*e;break;case 35:i.Mt=(i.Mt||1)*(1+.2*o);break;case 36:i.Re+=.1*o,i.wt=.8*(i.wt||1),i.Ct=(i.Ct||0)+o;break;case 37:let t=1+o;a.Pe+=t,a.He+=t;break;case 38:i.Re*=.7,a.Pe+=o,a.He+=o;break;case 18:a.Ue+=(1-a.Ue)*(.05+.1*o);break;case 19:a.ze+=.1*o;break;case 20:a.Pe+=o,a.He+=o,a.Oe+=o;break;case 21:a.Ge+=(1-a.Ge)*(.05+.1*o);break;case 22:i.xt=!0;break;case 23:i.Rt=!0;break;case 24:i.wt=(i.wt||1)*(1+.5*o)}}function Pe(e,t,n,o){39===n.Z&&y(()=>be(),1/8,0,0,0,1/0)(e,t)}function _e(t,n,o,i){let r;switch(o.Z){case 0:r=e(t,[!1,A(),v(),fe(6,3,1),y((e,t)=>[!1,v(),j(14),W({0:{14:.1,15:.1,16:.1,17:.1,18:.1,19:.1}}),ne(1,0,.8,[0,1]),te(.3),a(16,3,.1),l(1),u(8)],1/12,Math.PI/4,3,5,0,!0)]),I(t,r,n);break;case 1:r=e(t,$e()),I(t,r,n);break;case 2:r=e(t,[!1,A(),v(),fe(6,1.8,10),$(()=>Ae(1.2),.2,.15,7,8),q(ve(.2),[A(),v([0,0],150,[1,1]),$((e,t)=>[!1,v(),j(27,[.9,.8,.6,1]),ne(1,0,.7,[0,-8]),te(.2),u(3)],.2,.3,1,2)])]),I(t,r,n);break;case 3:r=e(t,[!1,A(),v(),fe(15,3.5,1),$(()=>Ae(3.5),0,.01,10,11),q(ve(0))]),I(t,r,n);break;case 4:r=e(t,we()),I(t,r,n);break;case 5:r=e(t,he()),I(t,r,n);break;case 6:r=e(t,[!1,A(),v(),fe(7,2.8,5),$(()=>[!1,v(),j(37),a(8,3,.15),ne(1,.8,.4,[0,0]),l(2,.3),u(8)],.001,.2,3.5,4.5)]),I(t,r,n);break;case 7:r=e(t,[!1,A(),v(),fe(7,2.5,3),$(()=>[!1,A(),v(),j(28),a(8,3,.08),ne(1,0,0,[0,0]),l(2.5),u(5),y(()=>[!1,v(),j(27,[.5,0,1,.7]),ne(1,0,.2,[0,-5]),te(.4),a(16,3,.05),l(.5),u(2.5)],.1,.2,.5,1.5,1/0)],.3,.05,5,6),q(ve(.3))]),I(t,r,n);break;case 8:r=e(t,[!1,A(),v(),fe(5,2.5,1),q([A(),v(),ke([0,0],1),E(0,90),$(Ce,0,Math.PI/6,4,5)])]),I(t,r,n);break;case 9:r=e(t,[!1,A(),v(),fe(8,3.5,1),$(Le,0,.1,4,6)]),I(t,r,n)}}function Qe(t,n,o,i){let a=t.o.re[n],l=t.o.A[n],u=[l.$[0]+2,l.$[1]+2];switch(o.Z){case 10:e(t,[...(c=a.ie,[...ce(c,6,2.8,1.8,1.5),y(()=>function(e){return r([pe,Me,ye,me,de,ge,xe])(e)}(c),3,2*Math.PI,.5,1,1/0)]),w(u)]);break;case 11:e(t,[...pe(a.ie),w(u)]);break;case 12:e(t,[...Me(a.ie),w(u)]);break;case 13:e(t,[...ye(a.ie),w(u)]);break;case 14:e(t,[...me(a.ie),w(u)]);break;case 15:e(t,[...de(a.ie),w(u)]);break;case 16:e(t,[...ge(a.ie),w(u)]);break;case 17:e(t,[...xe(a.ie),w(u)]);break;default:return}var c}function He(e,t){let n=e.o.A[t].$,o=[Wt,Jt];if(p(n,o)>Vt){let i=[n[0]-o[0],n[1]-o[1]];m(i,i),d(i,i,Vt),n[0]=o[0]+i[0],n[1]=o[1]+i[1],e.o.i[t]|=256}}function qe(e,t){let n=e.k[0]-t.k[0],o=e.k[1]-t.k[1],i=e.p+t.p;return n*n+o*o<=i*i}function Se(e,t,n){for(let o=0;o<n;o++){let n=t[o],i=e.h&n.m,r=n.h&e.m;(i||r)&&qe(e,n)&&(i&&e.v.push(n.u),r&&n.v.push(e.u))}}function Ie(e,t,n,o,r){let a=e.o.re[t],l=e.o.ae[t];if(l.ce<o.Tt&&i(0,1)<.3)return void Re(a,3,e.pe);if(l.ce<o.St&&a.we<=0&&a.ve>a.Te*n&&i(0,1)<.2*a.Re)return Re(a,1,e.pe),void(a.we=(1.5+i(0,2))*n*a.Te);a.ve>a.Te*n&&i(0,1)<.4&&(a.Me*=-1,a.ve=0);let u=l.ce;if(u<.1)return;let c=o.It,f=(u-c)/c,h=[0,0];m(h,l.ue);let b=[-h[1]*a.Me,h[0]*a.Me];d(h,h,.6*f),d(b,b,.7),s(r,h,b),m(r,r)}function Ue(e,t,n,o,i){let r=e.o.re[t],a=e.o.ae[t],l=e.o.We[t];if(a.ce<.1||r.ve>(1.5+.5*r.Re)*n)return void Re(r,0,e.pe);m(i,a.ue);let u=Bt*r.Re*(r.vt||1);u=Math.min(u,1.5*Bt/Math.sqrt(l.Ve/Et)),d(i,i,u)}function De(e,t,n){let o=e.o.re[t];if(o.ve>.3*n){Re(o,0,e.pe);for(let n of S(e.o,t,2))J(e,n,0)}}function Oe(e,t,n,o,i){let r=e.o.re[t],a=e.o.ae[t];a.ce>1.5*o.Tt||r.ve>2*n?Re(r,0,e.pe):(m(i,a.ue),d(i,i,-.8))}function Re(e,t,n){e.be!==t&&(e.be=t,e.ke=n,e.ve=0)}function Ne(e,t){let n=e.o.bt[t],o=e.o.We[t];if(1&e.o.i[t]){let n=e.o.ae[t];-1!==n.le&&(o.qe[0]=n.ue[0],o.qe[1]=n.ue[1],e.o.i[t]|=256)}else n.qe&&(o.qe[0]=n.qe[0],o.qe[1]=n.qe[1],e.o.i[t]|=256);n.L&&(o.L=n.L,e.o.i[t]|=256)}function Te(e,t,n){let o=e.o.re[t],i=e.o.ae[t],r=n.R/(1+o.Ce*Gt);o.Mt&&(r/=o.Mt);let a=(0===o.be||1===o.be)&&n.j>=r&&-1!==i.le&&i.ce<=n.Range;return a&&o.ie&&o.Ce.toFixed(2),a}function We(e,t,n){let o=e.o.gt[n];o.j=0;let i=e.o.ae[t];for(let t of S(e.o,n,528384)){let n=e.o.O[t];e.o.A[t].L=i.fe,e.o.i[t]|=256,0===n.U?n.W=o.yt:n.X=o.yt}}function Je(e,t,n,o){let i=!1;for(let r of o.v){let o=K(e.o,t);if(r===o)continue;if(!(512&e.o.i[r]))continue;let a=e.o.Le[r],l=n.C;if(16&e.o.i[o]){let t=e.o.re[o];if(!t)throw Error("missing AI component");t.Ct&&(l+=t.Ct),t.kt&&(l*=1+t.Ce/5*t.kt)}if(a.Fe.push({Nt:l,Dt:o}),16&e.o.i[o]){let t=e.o.re[o];if(!t)throw Error("missing AI component");t.Se>0&&(t.Ce+=l*t.Se)}if(16&e.o.i[o]&&e.o.re[o].xt){let t=e.o.Le[o];if(!t)throw Error("attacker missing health component");t.Be.push({Nt:l/2,Dt:o})}if(16&e.o.i[o]){let t=e.o.re[o];if(t.$e&&16&e.o.i[r]){let n=e.o.re[r],o=l*t.$e;n.Ce=Math.max(0,n.Ce-o),t.Ce+=o}}void 0!==e.At&&ee(Math.min(1,.2*l),Math.min(.5,.1*l))(e,e.At),i=!0}if(i&&(n.T=n.R,0===n.R&&2048&e.o.i[t])){let n=e.o.S[t];n.N=n.I}}function Ve(e=8){return[!1,v([0,0],0,[1,1]),$((e,t)=>function(e=.5){return[!1,v(),j(27,[1,.5,0,.7]),ne(1,0,.2),te(.5),a(16,3,.1),l(e),u(1.5)]}(.5),0,2*Math.PI,8,8,e),u(.2)]}function Be(e){return(t,n)=>{t.o.i[n]|=1048576,t.o.et[n]={Ze:e}}}function Ee(e,t){e.Ce>Yt&&(e.Ce=Math.max(Yt,e.Ce-(e.Ce-Yt)*e.Ne*t)),e.Ce=Math.max(Yt,Math.min(zt,e.Ce))}function Ge(e,t,n,o){let i=0;return t.De>0&&t.Ce>0&&n.He<n.Pe&&(i=t.De*(t.Ce/zt)*o,n.Be.push({Nt:i,Dt:e})),i}function je(e,t){let n=(e.Ce-(o=Yt))/(zt-o)*(1+Kt-1)+1;var o;e.Et||(e.Et=t.P[0]);let i=e.Et*n;t.P[0]=i,t.P[1]=i}function Xe(t,n,o){if(o.Ae&&o.Ce>=zt&&!o.$t){let i=t.o.A[n],r=[i.$[0],i.$[1]];e(t,[...Ve(8),w(r),Be(n)]),o.$t=!0,o.Ce=Yt}else o.Ce<.8*zt&&(o.$t=!1)}function Ye(e,t,n){8192&e.o.i[t]&&(e.o.We[t].Ve=n.xe*Math.sqrt(1+n.Ce/zt))}function ze(e,t,o,i){let r=i.Nt;return o.Ge>0&&n()<o.Ge?0:(o.Ue>0&&(r-=r*o.Ue),o.Oe>0&&(r=Math.max(1,r-o.Oe)),r)}function Ke(e,t,n){for(let o of S(e.o,t,525312)){let t=e.o._e[o];if(t&&"h"===t.Qe){let t=e.o.O[o];0===t.U&&(t.W+=n*n);break}}}function et(e,t,n){for(let o of S(e.o,t,525312)){let t=e.o._e[o];if(t&&"b"===t.Qe){let t=e.o.O[o];0===t.U&&(t.W+=n*n);break}}}function tt(e,t,n){let o=e.o.S[t];o.N>o.I&&(o.D&&kt(e,o.D,t),U(e.o,t)),o.N+=n}function nt(e,t,n){let o=e.o.A[t],i=e.o.We[t];if(i.qe[0]||i.qe[1]){en[0]=i.qe[0],en[1]=i.qe[1];let r=Math.min(1,g(en));if(262144&e.o.i[t]){let n=e.o.H[t];!function(e,t,n){let o=t[0],i=t[1];e[0]=n[0]*o+n[2]*i,e[1]=n[1]*o+n[3]*i}(en,en,void 0!==n.tt?e.o.H[n.tt].B:n.o)}else b(en,en,o.L);m(en,en),d(en,en,r*i.Ve*n),s(o.$,o.$,en),i.qe[0]=0,i.qe[1]=0}i.L&&(o.L+=i.L*i.je*n,i.L=0)}function ot(e,t){if(e.q>0){let n=i(-e.q,e.q),o=i(-e.q,e.q);t.st[0]+=n,t.st[1]+=o}}function it(e,t,n){let o=e.o.Ye[t].Je;!function(e,t,n){let o=t*Ft;e.o.F[o+8]=n[0],e.o.F[o+9]=n[1],e.o.F[o+10]=n[2],e.o.F[o+11]=n[3]}(e,t,[o[0],o[1],o[2],e.o.Ye[t].Je[3]*(1-n)])}function rt(e,t,n){let o=e.o.A[t],i=e.o.ot[t];1===i.lt&&(i.dt[0]+=i.ft[0]*n,i.dt[1]+=i.ft[1]*n,d(i.st,i.st,n),s(i.dt,i.dt,i.st),d(i.dt,i.dt,Math.pow(1-i.ct,n)),d(tn,i.dt,n),s(o.$,o.$,tn),e.o.i[t]|=256,c(i.st,0,0))}function at(e,t){let n=e.o.A[t],o=e.o.ot[t],i=e.o.l[t];if(1===o.lt){c(on,0,0),f(o.ht,o.dt);for(let t=0;t<i.v.length;t++){let n=i.v[t];if(65536&e.o.i[n]&&0===e.o.ot[n].lt){let t=e.o.l[n];h(rn,i.k,t.k);let r=p(i.k,t.k);0===r&&(c(rn,1,0),r=1);let a=i.p+t.p;if(r<a){m(rn,rn);let e=a-r;d(an,rn,e),s(on,on,an),d(o.ht,rn,e)}}}(on[0]||on[1])&&(s(n.$,n.$,on),e.o.i[t]|=256,d(o.ht,o.ht,o.ut))}}function lt(e,t,n){let o=e.o.he[t],i=o.ge[o.ye];if(i){for(let n in i.me)if(o.pe<i.me[n]){Y(e,t,+n);break}o.pe+=n,o.pe>=i.X&&(o.pe-=i.X)}}function ut(e,t){let n=e.Lt/e.Pt/2;var o,i;i=1/n,(o=e.o.Ft[t].Ht)[0]=1/(n*(e.Bt/e.Lt)),o[1]=0,o[2]=0,o[3]=i,o[4]=0,o[5]=0}function ct(e,t,n){let o=e.o.nt[t],i=e.o.A[t];if(o.X-=n,o.X<=0)e.o.i[t]&=-131073,i.$[0]=0,i.$[1]=0;else if(o.rt===1/0)i.$[0]=(Math.random()-.5)*o.p*2,i.$[1]=(Math.random()-.5)*o.p*2;else{let e=o.p*(1-(1-o.X/o.rt)**5);i.$[0]=(Math.random()-.5)*e*2,i.$[1]=(Math.random()-.5)*e*2}e.o.i[t]|=256}function ft(e,t,n){let o=e.o.O[t];switch(o.U){case 0:!function(e,t,n,o){if(!(n.W<=0))for(n.j+=o;n.j>=n.V&&n.W>0;)n.j-=n.V,n.W--,x(ln,e.o.H[t].o),st(e,t,n,ln)}(e,t,o,n);break;case 1:!function(e,t,n,o){if(!(n.X<=0))for(n.j+=o;n.j>=n.V&&n.X>0;)n.j-=n.V,n.X-=o,x(ln,e.o.H[t].o),st(e,t,n,ln)}(e,t,o,n)}}function st(t,n,o,r){let a=t.o.A[n];if(un[0]=Math.cos(a.L*Ht),un[1]=Math.sin(a.L*Ht),o.q>0){let e=i(-o.q/2,o.q/2);b(un,un,e)}m(un,un);let l=i(o.Y,o.K),u=K(t.o,n),c=e(t,[...o.G(t,n),w(r),Be(u)]);o.J||(t.o.A[c].L=a.L);let f=t.o.ot[c];f&&(f.dt[0]=un[0]*l,f.dt[1]=un[1]*l)}function ht(e,t){for(let t=0;t<e.o.i.length;t++)4352&~e.o.i[t]||(262144&e.o.i[t]?mt(e,t):dt(e,t))}function dt(e,t){e.o.i[t]&=-257;let n=e.o.A[t],o=t*Ft;e.o.F[o+0]=n.P[0],e.o.F[o+1]=n.P[1],e.o.F[o+2]=n.L*Ht,e.o.F[o+4]=n.$[0],e.o.F[o+5]=n.$[1]}function mt(e,t,n){e.o.i[t]&=-257;let o=e.o.A[t],i=e.o.H[t];if(function(e,t,n,o){let i=Math.sin(n),r=Math.cos(n);e[0]=r*o[0],e[1]=i*o[0],e[2]=-i*o[1],e[3]=r*o[1],e[4]=t[0],e[5]=t[1]}(i.o,o.$,o.L*Ht,o.P),void 0!==n&&(i.tt=n),void 0!==i.tt&&M(i.o,e.o.H[i.tt].o,i.o),function(e,t){let n=t[0],o=t[1],i=t[2],r=t[3],a=t[4],l=t[5],u=n*r-o*i;u&&(u=1/u,e[0]=r*u,e[1]=-o*u,e[2]=-i*u,e[3]=n*u,e[4]=(i*l-r*a)*u,e[5]=(o*a-n*l)*u)}(i.B,i.o),64&e.o.i[t]){let n=e.o.ne[t];for(let o=0;o<n.ne.length;o++){let i=n.ne[o];(e.o.i[i]&cn)===cn&&mt(e,i,t)}}}function bt(e,...t){return e.reduce((e,n)=>e+function(e){let t=e.shift();return"boolean"==typeof t||null==t?"":Array.isArray(t)?t.join(""):t}(t)+n)}function gt(){return[!1,v(),j(27,[.5,.5,.5,1]),ne(1,0,.3,[0,-9.8]),te(.8),a(16,3,.1),l(.1),u(3)]}function pt(){return[!1,v(),j(0),ne(1,.2,.1,[0,-2]),ke(null,1),E(0,180),a(8,3,.15),l(3),u(2,6)]}function vt(){localStorage.removeItem("com.piesku.blackcat.1")}function kt(t,n,c){switch(n){case 8:t.Ot=2;break;case 0:t.be.currentLevel++,t.be.currentLevel>33?(vt(),t.Ot=3):(t.be.opponentUpgrades=C(t.be.currentLevel,t.be.runSeed),t.be.availableUpgradeChoices=F(t.be.currentLevel,t.be.playerUpgrades,t.be.runSeed),localStorage.setItem("com.piesku.blackcat.1",JSON.stringify(t.be)),t.Ot=3);break;case 1:vt(),t.Ot=4;break;case 2:t.be.playerUpgrades.push(t.be.availableUpgradeChoices[c]),t.Ot=1,function(t){t.Ut=!0,t.o=new Pt(fn),t.o.Gt=Rt,t.o.zt=Nt,e(t,[A(),v(),q([A(),v(),(e,t)=>{e.o.i[t]|=4,e.o.Ft[t]={Ht:[1,0,0,1,0,0],Wt:[1,0,0,1,0,0]}}]),k(Wt,Jt)]);let n=e(t,[z("p"),...re(t,!0),k(Wt-4,Jt),q([z("h"),A(),v([0,0],90,[1,1]),$(()=>[!1,v(),j(21),W({0:{21:.3,22:1}}),ne(1,0,.95,[0,2]),te(.5),u(1)],.1,Math.PI/3,1,2.5,0)])]),a=e(t,[z("o"),...re(t,!1),k(Wt+4,Jt)]);Fe(t,n,t.be.playerUpgrades),Fe(t,a,t.be.opponentUpgrades),function(t){let n=o(3,6);for(let a=0;a<n;a++){let n=i(0,2*Math.PI),a=i(2,Tt-2),l=Wt+Math.cos(n)*a,u=Jt+Math.sin(n)*a,c=o(2,5);for(let n=0;n<c;n++){let n=i(0,2*Math.PI),o=i(0,1.5),a=l+Math.cos(n)*o,c=u+Math.sin(n)*o;g([a-Wt,c-Jt])>Tt-1||e(t,[...ae(r([.8,1,1.2,1.4])),k(a,c)])}}}(t)}(t);break;case 3:t.Ot=0;break;case 4:t.be=H(),vt(),t.Ot=0;break;case 5:vt();break;case 6:{let n=t.o.A[c],[i,r]=n.$;e(t,function(e,t=3,n=1.5,i=.2){return[A(),v(e),a(4,2,n),l(t,.1),u(i),$(gt,.001,2*Math.PI,3,8,o(30,60))]}([i,r],3,1.5,.2));break}case 7:{let n=t.o.A[c],[o,i]=n.$;e(t,(f=[o,i],[!1,A(),v(f,0,[1,1]),$(pt,0,2*Math.PI,5,7,5),u(.1)]));break}}var f}function wt(){let e=new sn,t=null;if(null!==localStorage.getItem("com.piesku.blackcat.1"))try{t=function(){let e=localStorage.getItem("com.piesku.blackcat.1");return e?JSON.parse(e):null}()||null}catch(e){}t?(e.be=t,e.be.isNewRun=!1,e.Ot=0):kt(e,4),e.Vt(),window.$=kt.bind(null,e)}var Mt,xt=class{jt;i=[];t=[];constructor(e=1e4){this.jt=e}},At=class{qt=0;pe=0;Bt=window.innerWidth;Lt=window.innerHeight;Ut=!0;Yt=document.querySelector("main");Kt=document.querySelector("canvas");Jt=this.Kt.getContext("webgl2");Audio=new AudioContext;At;constructor(){document.addEventListener("visibilitychange",()=>document.hidden?this.Xt():this.Vt())}Vt(){let e=performance.now(),t=n=>{let o=(n-e)/1e3;e=n,this.pe+=o,this.qt=requestAnimationFrame(t),this._t(o),this.Ut=!1};requestAnimationFrame(t)}Xt(){cancelAnimationFrame(this.qt),this.qt=0}},$t=1,yt=34962,Lt=3553,Ct=5126,Ft=16,Zt=4*Ft,Pt=class extends xt{F=new Float32Array(this.jt*Ft);Gt=24;zt=16;ae=[];he=[];Ft=[];l=[];re=[];bt=[];ne=[];M=[];Le=[];_e=[];S=[];A=[];We=[];it=[];Ye=[];ot=[];nt=[];H=[];O=[];et=[];gt=[]},_t={0:{Z:0,ee:0,Qe:"Flamethrower",_:["Buuuurn!"],te:1},1:{Z:1,ee:0,Qe:"Shotgun",_:["Hasta la vista, baby!"],te:0},2:{Z:2,ee:0,Qe:"Minigun",_:["Trrrrtrtrtrtrt!"],te:2},3:{Z:3,ee:0,Qe:"Sniper rifle",_:["High-damage, long-range"],te:0},4:{Z:4,ee:0,Qe:"Homing Banana",_:["Peelin' great!"],te:1},5:{Z:5,ee:0,Qe:"Dynamite",_:["Hold that for me?"],te:0},6:{Z:6,ee:0,Qe:"Spikeballs",_:["Hush hush"],te:0},7:{Z:7,ee:0,Qe:"Larpa",_:["Rockets. With particles."],te:2},8:{Z:8,ee:0,Qe:"Hoover crack",_:["Particle vortex"],te:2},9:{Z:9,ee:0,Qe:"Chiquita bomb",_:["Banananana!"],te:2},18:{Z:18,ee:2,Qe:"Damage Reduction",_:["Reduce all damage by 15%","Reduce all damage by 25%","Reduce all damage by 35%"],te:1},19:{Z:19,ee:2,Qe:"Regeneration",_:["Heal +0.2 life per second","Heal +0.3 life per second","Heal +0.5 life per second"],te:1},20:{Z:20,ee:2,Qe:"Thick Hide",_:["+1 max life, reduce damage by 1","+2 max life, reduce damage by 2","+3 max life, reduce damage by 3"],te:1},21:{Z:21,ee:2,Qe:"Evasion",_:["15% chance to dodge attacks","25% chance to dodge attacks","35% chance to dodge attacks"],te:1},22:{Z:22,ee:2,Qe:"Vampiric",_:["25% lifesteal","50% lifesteal","75% lifesteal"],te:1},39:{Z:39,ee:3,Qe:"Shadow Wake",_:["Leave damaging shadow particles behind you"],te:1},23:{Z:23,ee:2,Qe:"Phase Walk",_:["Invulnerable for 50% of dash","Invulnerable for 75% of dash","Invulnerable for 100% of dash"],te:1},24:{Z:24,ee:2,Qe:"Dash Master",_:["+50% dash range","+100% dash range","+150% dash range"],te:0},10:{Z:10,ee:1,Qe:"Spawn Cat",_:["Cat summoner"],te:2},11:{Z:11,ee:1,Qe:"Melee Cat",_:["Whirlwind barbarian"],te:0},12:{Z:12,ee:1,Qe:"Sniper Cat",_:["Boomerang marksman"],te:0},13:{Z:13,ee:1,Qe:"Tank Cat",_:["Defensive support"],te:1},14:{Z:14,ee:1,Qe:"Bodyguard Cat",_:["Loyal bodyguard"],te:1},15:{Z:15,ee:1,Qe:"Berserker Cat",_:["Explosive artillery"],te:0},16:{Z:16,ee:1,Qe:"Stealth Cat",_:["Shadow assassin"],te:2},17:{Z:17,ee:1,Qe:"Suicide Cat",_:["Kaboom!"],te:1},25:{Z:25,ee:2,Qe:"Combat Veteran",_:["Gain +0.3 mana per damage dealt","Gain +0.5 mana per damage dealt","Gain +0.7 mana per damage dealt"],te:0},26:{Z:26,ee:2,Qe:"Slow Metabolism",_:["Mana decays 25% slower","Mana decays 50% slower","Mana decays 75% slower"],te:0},27:{Z:27,ee:2,Qe:"Combat Medic",_:["Heal +1 life/s (scales with mana)","Heal +2 life/s (scales with mana)","Heal +3 life/s (scales with mana)"],te:0},28:{Z:28,ee:2,Qe:"Hypermetabolism",_:["+3 life/s, but 2x mana decay"],te:2},29:{Z:29,ee:2,Qe:"Weapon Mastery",_:["Damage scales with mana (up to +20%)","Damage scales with mana (up to +40%)","Damage scales with mana (up to +60%)"],te:0},30:{Z:30,ee:2,Qe:"Pain Tolerance",_:["Gain +0.2 mana per damage taken","Gain +0.4 mana per damage taken","Gain +0.6 mana per damage taken"],te:1},31:{Z:31,ee:2,Qe:"Shockwave Burst",_:["Damage burst at full mana"],te:2},32:{Z:32,ee:2,Qe:"Kinetic Charger",_:["Gain mana while moving","Gain 2x mana while moving","Gain 3x mana while moving"],te:1},33:{Z:33,ee:2,Qe:"Mana Siphon",_:["Drain 25% of damage dealt as mana","Drain 50% of damage dealt as mana","Drain 75% of damage dealt as mana"],te:1},34:{Z:34,ee:2,Qe:"Lightning Reflexes",_:["+25% movement speed","+50% movement speed","+75% movement speed"],te:1},35:{Z:35,ee:2,Qe:"Quick Draw",_:["+25% attack speed","+40% attack speed","+60% attack speed"],te:0},36:{Z:36,ee:2,Qe:"Brawler",_:["+1 damage, more aggressive","+2 damage, more aggressive","+3 damage, more aggressive"],te:0},37:{Z:37,ee:2,Qe:"Vitality",_:["+2 maximum life","+3 maximum life","+4 maximum life"],te:0},38:{Z:38,ee:2,Qe:"Cautious",_:["+1 max life, defensive","+2 max life, defensive","+3 max life, defensive"],te:0}},Qt=Object.values(_t),Ht=Math.PI/180,qt=180/Math.PI,St=4624,It=[.2,.4,.8,1],Ut=[.8,.2,.2,1],Dt=5,Ot=8,Rt=20,Nt=20,Tt=8,Wt=Rt/2,Jt=Nt/2,Vt=Tt-.5,Bt=4,Et=2,Gt=.5,jt=0,Xt=0,Yt=0,zt=5,Kt=4,en=[0,0],tn=[0,0],nn=69640,on=[0,0],rn=[0,0],an=[0,0],ln=[0,0],un=[0,0],cn=266240,fn=65536,sn=class extends At{o=new Pt(fn);be=H();Ot=2;Qt=function(e){let t=function(e){let t=e.createProgram();return e.attachShader(t,L(e,35633,"#version 300 es\n\nuniform mat3x2 u;uniform vec2 s;layout(location=0) in vec2 p;layout(location=1) in vec2 t;layout(location=2) in vec4 r;layout(location=3) in vec4 n;layout(location=4) in vec4 c;layout(location=5) in vec4 e;out vec2 v;out vec4 w;void main(){int i=int(n.w);if((i&32768)==32768){mat3x2 m;if((i&262144)==262144) {m=mat3x2(r.xy,r.zw,n.xy);}else{vec2 a=r.xy;float b=r.z;m=mat3x2(cos(b)*a.x,sin(b)*a.x,-sin(b)*a.y,cos(b)*a.y,n.xy);}vec3 o=mat3(m)*vec3(p,1);vec3 l=mat3(u)*o;gl_Position=vec4(l.xy,-n.z,1);v=(e.xy+e.zw*t)/s;w=c;}else{gl_Position.z=2.0;}}")),e.attachShader(t,L(e,35632,"#version 300 es\n\nprecision mediump float;uniform sampler2D x;in vec2 v;in vec4 w;out vec4 f;void main(){f=w*texture(x,v);if(f.a==0.0){discard;}}")),e.linkProgram(t),t}(e);return{U:5,Zt:t,en:{Wt:e.getUniformLocation(t,"u"),tn:e.getUniformLocation(t,"x"),nn:e.getUniformLocation(t,"s")}}}(this.Jt);an=function(e,t){let n=e.createTexture();return e.bindTexture(Lt,n),e.texImage2D(Lt,0,6408,6408,5121,t),e.texParameteri(Lt,10241,9728),e.texParameteri(Lt,10240,9728),{rn:n,Gt:t.width,zt:t.height}}(this.Jt,document.querySelector("img"));ln=this.Jt.createBuffer();Pt=48;constructor(){super(),this.Jt.disable(2929),this.Jt.enable(3042),this.Jt.blendFunc(770,771),function(e,t){let n=Float32Array.from([-.51,-.51,0,1,.51,-.51,1,1,-.51,.51,0,0,.51,.51,1,0]);e.bindBuffer(yt,e.createBuffer()),e.bufferData(yt,n,35044),e.enableVertexAttribArray(0),e.vertexAttribPointer(0,2,Ct,!1,16,0),e.enableVertexAttribArray(1),e.vertexAttribPointer(1,2,Ct,!1,16,8),e.bindBuffer(yt,t),e.enableVertexAttribArray(2),e.vertexAttribDivisor(2,1),e.vertexAttribPointer(2,4,Ct,!1,Zt,0),e.enableVertexAttribArray(3),e.vertexAttribDivisor(3,1),e.vertexAttribPointer(3,4,Ct,!1,Zt,16),e.enableVertexAttribArray(4),e.vertexAttribDivisor(4,1),e.vertexAttribPointer(4,4,Ct,!1,Zt,32),e.enableVertexAttribArray(5),e.vertexAttribDivisor(5,1),e.vertexAttribPointer(5,4,Ct,!1,Zt,48)}(this.Jt,this.ln)}_t(e){!function(e,t){for(let n=0;n<e.o.i.length;n++)69632&~e.o.i[n]||rt(e,n,t)}(this,e),ht(this),function(e){let t=[];for(let n=0;n<e.o.i.length;n++)if(!(4104&~e.o.i[n])){let o=e.o.l[n];o.v=[];let i=e.o.A[n];o.k[0]=i.$[0],o.k[1]=i.$[1],t.push(o)}for(let e=0;e<t.length;e++)Se(t[e],t,e)}(this),function(e){for(let t=0;t<e.o.i.length;t++)(e.o.i[t]&nn)===nn&&at(e,t);for(let t=0;t<e.o.i.length;t++)if((e.o.i[t]&nn)===nn){let n=e.o.ot[t];1===n.lt&&f(n.dt,n.ht)}}(this),function(e,t){for(let n=0;n<e.o.i.length;n++)if(!(4097&~e.o.i[n])){let o=e.o.ae[n],i=e.o.A[n];o.de+=t;let r=o.de>=o.se,a=!D(e,o.le);if((r||a)&&(o.de=0,o.le=O(e,n)),-1!==o.le&&D(e,o.le)){let t=e.o.A[o.le];if(t){let r=[0,0];h(r,t.$,i.$),o.ce=g(r),o.ce>.01?(m(o.ue,r),o.fe=Math.atan2(o.ue[1],o.ue[0])*qt,R(e,n,o.ue),N(e,n,o.ue)):(o.ue[0]=0,o.ue[1]=0,o.fe=0)}}else o.le=-1,o.ce=1/0,o.ue[0]=0,o.ue[1]=0,o.fe=0}}(this,e),function(e,t){for(let n=0;n<e.o.i.length;n++)if(!(12817&~e.o.i[n])){let o=e.o.re[n],i=e.o.Le[n],r=e.o.We[n],a=e.o.ae[n];if(!r||!a)continue;if(o.ve+=t,o.we=Math.max(0,o.we-t),-1===a.le){r.qe[0]=0,r.qe[1]=0;continue}let l=r.Ve/Et,u=1/Math.sqrt(l),c=4.5;o.wt&&(c*=o.wt);let f={It:2.5*l,St:c*l*o.Re,Tt:1.2*l};if(e.pe-i.T<.3*u&&2!==o.be){Re(o,2,e.pe);for(let t of S(e.o,n,2))J(e,t,1)}let s=[0,0];switch(o.be){case 0:Ie(e,n,u,f,s);break;case 1:Ue(e,n,u,0,s);break;case 2:De(e,n,u);break;case 3:Oe(e,n,u,f,s)}r.qe[0]=s[0],r.qe[1]=s[1],r.Ve=o.xe*Math.sqrt(o.Ce),(0!==s[0]||0!==s[1])&&(o.Ce+=.1*r.Ve*t+r.Ve*o.Ee*t),e.o.i[n]|=256}}(this,e),function(e){for(let t=0;t<e.o.i.length;t++)8224&~e.o.i[t]||Ne(e,t)}(this),function(e,t){for(let n=0;n<e.o.i.length;n++)if(!(2359296&~e.o.i[n])){let o=e.o.gt[n];o.j+=t;let i=e.o.H[n].tt??-1;Te(e,i,o)&&We(e,i,n)}}(this,e),function(e){for(let t=0;t<e.o.i.length;t++)if(!(55296&~e.o.i[t])){let n=e.o.S[t];65536&e.o.i[t]&&ot(e.o.it[t],e.o.ot[t]),it(e,t,Math.min(n.N/n.I,1))}}(this),function(e,t){for(let n=0;n<e.o.i.length;n++)if(!(4232&~e.o.i[n])){let o=e.o.M[n],i=e.o.l[n];if(!o||!i)continue;if(o.T>0){o.T-=t;continue}Je(e,n,o,i)}}(this,e),function(e,t){for(let n=0;n<e.o.i.length;n++)if(!(512&~e.o.i[n])){let o=e.o.Le[n];if(16&e.o.i[n]){let t=e.o.re[n];t.Rt&&1===t.be&&(o.Fe.length=0)}let i=0;for(let e of o.Fe)i+=ze(0,0,o,e);if(i>0&&(o.He=Math.max(0,o.He-i),o.T=e.pe,et(e,n,i),16&e.o.i[n])){let t=e.o.re[n];t.Ie>0&&(t.Ce+=i*t.Ie)}if(o.He<=0){for(let t of S(e.o,n,2))J(e,t,2);e.o.i[n]&=-513}let r=0;for(let e of o.Be)o.He<o.Pe&&(r+=e.Nt);r>0&&(o.He=Math.min(o.Pe,o.He+r),Ke(e,n,r)),o.ze>0&&o.He<o.Pe&&(o.He=Math.min(o.Pe,o.He+o.ze*t)),o.Fe.length=0,o.Be.length=0}}(this,e),function(e,t){for(let n=0;n<e.o.i.length;n++)if(!(4624&~e.o.i[n])){let o=e.o.re[n],i=e.o.A[n],r=e.o.Le[n];Ee(o,t),Ge(n,o,r,t),je(o,i),Xe(e,n,o),Ye(e,n,o),e.o.i[n]|=256}}(this,e),function(e,t){if(2!==e.Ot)return;let n=[],o=[],i=0,r=0;for(let t=0;t<e.o.i.length;t++)if(!(1552&~e.o.i[t])){let a=e.o._e[t];"p"===a.Qe?(n.push(t),i++):"o"===a.Qe&&(o.push(t),r++)}jt?(Xt-=t)<=0&&(kt(e,1===jt?0:1),jt=0,Xt=0):0===i&&r>0?(jt=2,Xt=3):0===r&&i>0?(jt=1,Xt=3):0===i&&0===r&&(jt=2,Xt=3)}(this,e),function(e,t){for(let n=0;n<e.o.i.length;n++)12544&~e.o.i[n]||nt(e,n,t)}(this,e),function(e){for(let t=0;t<e.o.i.length;t++)12800&~e.o.i[t]||He(e,t)}(this),function(e,t){for(let n=0;n<e.o.i.length;n++)2048&~e.o.i[n]||tt(e,n,t)}(this,e),function(e,t){for(let n=0;n<e.o.i.length;n++)135168&~e.o.i[n]||ct(e,n,t)}(this,e),ht(this),function(e,t){for(let n=0;n<e.o.i.length;n++)786432&~e.o.i[n]||ft(e,n,t)}(this,e),ht(this),function(e,t){if(void 0===e.At)return;let n=[],o=[];for(let t=0;t<e.o.i.length;t++)if(!(4624&~e.o.i[t])&&(n.push(t),1024&e.o.i[t])){let n=e.o._e[t];"p"!==n.Qe&&"o"!==n.Qe||o.push(t)}let i,r=1===o.length?o:n,a=Wt,l=Jt;if(0===r.length)i=1;else if(1===r.length){let t=e.o.A[r[0]];a=t.$[0],l=t.$[1],i=2.5}else{let t=1/0,n=-1/0,o=1/0,u=-1/0;for(let i of r){let r=e.o.A[i],a=r.$[0],l=r.$[1];t=Math.min(t,a),n=Math.max(n,a),o=Math.min(o,l),u=Math.max(u,l)}a=(t+n)/2,l=(o+u)/2,i=Math.max(.5,Math.min(2.5,8/Math.max(.5,Math.max(n-t,u-o)+4)))}let u=e.o.H[e.At].tt;if(void 0===u)return;let c=e.o.A[u],f=c.$[0],s=c.$[1],h=e.Pt/48,d=Math.min(1,3*t),m=h*Math.pow(i/h,d);c.$[0]=f+(a-f)*d,c.$[1]=s+(l-s)*d,e.o.i[u]|=256,e.Pt=48*m,e.Ut=!0}(this,e),function(e){if(e.Bt==window.innerWidth&&e.Lt==window.innerHeight||(e.Ut=!0),e.Ut){e.Bt=e.Kt.width=window.innerWidth,e.Lt=e.Kt.height=window.innerHeight;for(let t=0;t<e.o.i.length;t++)4&~e.o.i[t]||ut(e,t)}}(this),function(e){e.At=void 0;for(let t=0;t<e.o.i.length;t++)if(!(262148&~e.o.i[t])){let n=e.o.Ft[t];return M(n.Wt,n.Ht,e.o.H[t].B),void(e.At=t)}}(this),function(e,t){for(let n=0;n<e.o.i.length;n++)32770&~e.o.i[n]||lt(e,n,t)}(this,e),function(e){for(let t=0;t<e.o.i.length;t++){let n=294912&e.o.i[t],o=t*Ft+7;e.o.F[o]!==n&&(e.o.F[o]=n)}if(e.Jt.bindBuffer(yt,e.ln),e.Jt.bufferData(yt,e.o.F,35040),void 0!==e.At){let t=e.o.Ft[e.At];e.Jt.bindFramebuffer(36160,null),e.Jt.viewport(0,0,e.Bt,e.Lt),e.Jt.clear(16640),function(e,t){let n=e.Qt,o=e.an;e.Jt.useProgram(n.Zt),e.Jt.uniformMatrix3x2fv(n.en.Wt,!1,t.Wt),e.Jt.activeTexture(33984),e.Jt.bindTexture(Lt,o.rn),e.Jt.uniform1i(n.en.tn,0),e.Jt.uniform2f(n.en.nn,o.Gt,o.zt),e.Jt.drawArraysInstanced(n.U,0,4,e.o.i.length)}(e,t)}}(this),function(e){let t=function(e){switch(e.Ot){case 0:return function(e){return bt`<div class="translate-background"><h2>DUEL&nbsp;${e.be.currentLevel}</h2><div style="display:flex;flex-direction:column;gap:15px;align-items:center">${e.be.availableUpgradeChoices.map((e,t)=>{let n=_t[e.id];return n?bt`<div class="u" onclick="window.$(${2}, ${t})"><div class="r">${function(e){switch(e){case 1:return"UNCOMMON";case 2:return"RARE";case 3:return"LEGENDARY";default:return"COMMON"}}(Z(n.te,e.tier))}${n._.length>1?" — TIER "+e.tier:""}</div><h3 style="color: ${function(e){let t=_t[e.id];if(!t)return"#8bc34a";switch(Z(t.te,e.tier)){case 1:return"#55ceff";case 2:return"#ff4a4a";case 3:return"#e75dff";default:return"#8bc34a"}}(e)}; margin-top: 0;">${n.Qe}</h3><p>${0===n.ee?"Weapon":1===n.ee?"Companion":n._[e.tier-1]||"Enhancement"}</p></div>`:"<div>Unknown Upgrade</div>"}).join("")}</div></div>`}(e);case 1:return function(e){return bt`<div><div style="position:absolute;left:50%;transform:translate(-50%,-50%);animation:top-forwards 1s ease forwards" onanimationend="$(${8})"><h2>DUEL&nbsp;${e.be.currentLevel}</h2></div></div>`}(e);case 3:return function(e){return bt`<div class="rotate-background">${e.be.currentLevel>33?'\n<h2>VICTORY!</h2>\n<h2>THANKS FOR PLAYING</h2>\n<button onclick="window.$(4)">PLAY AGAIN</button>\n':`\n<h2>DUEL ${e.be.currentLevel-1} WON!</h2>\n<h2>+2 LIFE!</h2>\n<button onclick="window.$(3)">CONTINUE</button>\n`}</div>`}(e);case 4:return function(e){return bt`<div class="rotate-background"><h2>OH NO!</h2><h2>DUEL ${e.be.currentLevel} LOST!</h2><button onclick="window.$(${4})">TRY AGAIN</button></div>`}(e);case 2:return function(e){let{cn:t,un:n,fn:o,sn:i}=function(e){let t=null,n=null,o=null,i=null;for(let r=0;r<e.o.i.length;r++)if(!(1040&~e.o.i[r])){let a=e.o.re[r],l=e.o._e[r];if(!a||!l.Qe)continue;let u=null;if(512&e.o.i[r]){let t=e.o.Le[r];t&&(u={current:Math.ceil(t.He),max:t.Pe})}let c=null;void 0!==a.Ce&&(c={current:a.Ce,max:5}),"p"===l.Qe?(t=u,o=c):"o"===l.Qe&&(n=u,i=c)}return{cn:t,un:n,fn:o,sn:i}}(e);const r=(e,t,n)=>{const o=n?"LIFE":"MANA";return bt`<div style="position: absolute;${t?"left: 20px;":"right: 20px;"}top: ${n?"20px":"calc(30px + 3vh)"};width:calc(100%/2-15vw);height:3vh;background:#222;border:3px solid #000;box-shadow:3px 3px 0 #000c;${t?"transform: skewX(-15deg) rotate(-3deg);":"transform: skewX(15deg) rotate(3deg);"} overflow:hidden"><div style="width: ${e?e.current/e.max*100:0}%;height: 100%;background: ${n?t?"#2196F3":"#F44336":t?"#4CAF50":"#FF9800"};${t?"":"float: right;"} transition: width 0.3s ease"></div><div style="position:absolute;top:0;left:0;right:0;bottom:0;color:#fff;text-shadow:1px 1px 0 #000;text-align: center;">${e?Math.ceil(e.current):0} ${o}</div></div>`};return bt`<div>${r(t,!0,!0)} ${r(n,!1,!0)}${r(o,!0,!1)} ${r(i,!1,!1)}</div>`}(e)}}(e);t!==Mt&&(e.Yt.innerHTML=Mt=t)}(this)}},hn=document.querySelector("img");hn.complete?wt():hn.onload=wt</script>