/**
 * @license almond 0.2.9 Copyright (c) 2011-2014, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/jrburke/almond for details
 */
var requirejs,require,define;!function(e){function t(e,t){return E.call(e,t)}function n(e,t){var n,i,r,o,a,l,u,c,d,s,f,m=t&&t.split("/"),p=h.map,v=p&&p["*"]||{};if(e&&"."===e.charAt(0))if(t){for(m=m.slice(0,m.length-1),e=e.split("/"),a=e.length-1,h.nodeIdCompat&&g.test(e[a])&&(e[a]=e[a].replace(g,"")),e=m.concat(e),d=0;d<e.length;d+=1)if(f=e[d],"."===f)e.splice(d,1),d-=1;else if(".."===f){if(1===d&&(".."===e[2]||".."===e[0]))break;d>0&&(e.splice(d-1,2),d-=2)}e=e.join("/")}else 0===e.indexOf("./")&&(e=e.substring(2));if((m||v)&&p){for(n=e.split("/"),d=n.length;d>0;d-=1){if(i=n.slice(0,d).join("/"),m)for(s=m.length;s>0;s-=1)if(r=p[m.slice(0,s).join("/")],r&&(r=r[i])){o=r,l=d;break}if(o)break;!u&&v&&v[i]&&(u=v[i],c=d)}!o&&u&&(o=u,l=c),o&&(n.splice(0,l,o),e=n.join("/"))}return e}function i(t,n){return function(){return d.apply(e,R.call(arguments,0).concat([t,n]))}}function r(e){return function(t){return n(t,e)}}function o(e){return function(t){m[e]=t}}function a(n){if(t(p,n)){var i=p[n];delete p[n],v[n]=!0,c.apply(e,i)}if(!t(m,n)&&!t(v,n))throw new Error("No "+n);return m[n]}function l(e){var t,n=e?e.indexOf("!"):-1;return n>-1&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function u(e){return function(){return h&&h.config&&h.config[e]||{}}}var c,d,s,f,m={},p={},h={},v={},E=Object.prototype.hasOwnProperty,R=[].slice,g=/\.js$/;s=function(e,t){var i,o=l(e),u=o[0];return e=o[1],u&&(u=n(u,t),i=a(u)),u?e=i&&i.normalize?i.normalize(e,r(t)):n(e,t):(e=n(e,t),o=l(e),u=o[0],e=o[1],u&&(i=a(u))),{f:u?u+"!"+e:e,n:e,pr:u,p:i}},f={require:function(e){return i(e)},exports:function(e){var t=m[e];return"undefined"!=typeof t?t:m[e]={}},module:function(e){return{id:e,uri:"",exports:m[e],config:u(e)}}},c=function(n,r,l,u){var c,d,h,E,R,g,T=[],A=typeof l;if(u=u||n,"undefined"===A||"function"===A){for(r=!r.length&&l.length?["require","exports","module"]:r,R=0;R<r.length;R+=1)if(E=s(r[R],u),d=E.f,"require"===d)T[R]=f.require(n);else if("exports"===d)T[R]=f.exports(n),g=!0;else if("module"===d)c=T[R]=f.module(n);else if(t(m,d)||t(p,d)||t(v,d))T[R]=a(d);else{if(!E.p)throw new Error(n+" missing "+d);E.p.load(E.n,i(u,!0),o(d),{}),T[R]=m[d]}h=l?l.apply(m[n],T):void 0,n&&(c&&c.exports!==e&&c.exports!==m[n]?m[n]=c.exports:h===e&&g||(m[n]=h))}else n&&(m[n]=l)},requirejs=require=d=function(t,n,i,r,o){if("string"==typeof t)return f[t]?f[t](n):a(s(t,n).f);if(!t.splice){if(h=t,h.deps&&d(h.deps,h.callback),!n)return;n.splice?(t=n,n=i,i=null):t=e}return n=n||function(){},"function"==typeof i&&(i=r,r=o),r?c(e,t,n,i):setTimeout(function(){c(e,t,n,i)},4),d},d.config=function(e){return d(e)},requirejs._defined=m,define=function(e,n,i){n.splice||(i=n,n=[]),t(m,e)||t(p,e)||(p[e]=[e,n,i])},define.amd={jQuery:!0}}(),define("../node_modules/almond/almond",function(){}),define("data/dimensions",[],function(){var e=768,t=432,n=Math.min(window.innerHeight/t,window.innerWidth/e);n=Math.max(.5,Math.floor(2*n)/2);var i=function(e){return Math.round(e*n)};return{WIDTH:i(e),HEIGHT:i(t),BORDER:i(28),CORNER:i(32),BLOCK:{MARGIN:{X:i(68),Y:i(68)},RATIO:1.618,RADIUS:i(2)},PADDLE:{SIZE:{X:i(64),Y:i(8)},MARGIN:{X:i(32),Y:i(8)}},BALL:{RADIUS:i(5)},PERCENT:i(100)}}),define("data/colours",[],function(){return{BACKGROUND:"#000",FOREGROUND:"#FFF",BALL:"#999",PADDLE:"#CCC",FIXTURES:{BORDER:"#888",CORNER:"#BBB",SLOT:"#333"},BLOCK:"#CCC",NOTES:{1:"#FF0000",1.5:"#7F3300",2:"#FF6A00",2.5:"#7F6A00",3:"#FFD800",4:"#267F00",4.5:"#004A7F",5:"#0094FF",5.5:"#00137F",6:"#0026FF",6.5:"#57007F",7:"#B200FF"},ELEMENTS:{EARTH:["#855723","#613318"],AIR:["#FFFFFF","#CCE0E9"],FIRE:["#FF0","#F00"],WATER:["#0FF","#00F"]}}}),define("data/levels",[],function(){return[{name:"Tutorial",par:[180,120,60],notes:[[5,5,5,5,5,5,5],[3,3,3,3,3,3,3],[1,1,1,1,1,1,1]]},{name:"Level 1",par:[180,120,60],notes:[[5,5,6,6,7,7,5,5],[3,3,4,4,5,5,3,3],[1,1,1,1,2,2,1,1]]},{name:"Level 2",par:[180,120,60],notes:[[1,1,5,5,6,6,1,1],[5,5,7,7,6,6,5,5],[3,3,5,5,4,4,3,3],[1,1,2,2,1,1,1,1]]},{name:"Level 3",par:[180,120,60],notes:[[4,4,3,3,2,2,1,1],[6,6,6,6,6,6,5,5],[4,4,3,3,4,4,3,3],[1,1,1,1,2,2,1,1]]},{name:"Level 4",par:[180,120,60],notes:[[1,1,1,1,3,3,1,1,1,1],[5,5,6,6,7,7,6,6,5,5],[3,3,3,3,5,5,3,3,3,3],[1,1,1,1,3,3,1,1,1,1]]}]}),define("data/progress",[],function(){var e=function(e){return"timeForLevel"+e};return{getTime:function(t){var n=parseInt(localStorage[e(t)]);return isNaN(n)?null:n},saveTime:function(t,n){var i=parseInt(localStorage[e(t)]);(isNaN(i)||i>n)&&(localStorage[e(t)]=n)}}}),define("views/util",[],function(){return{drawCircle:function(e,t,n,i,r){e.beginPath(),e.fillStyle=t,e.arc(Math.round(n),Math.round(i),r,2*Math.PI,!1),e.fill(),e.closePath()},drawRoundedRect:function(e,t,n,i,r,o){e.beginPath(),e.arc(t+o,n+o,o,Math.PI,3*Math.PI/2,!1),e.lineTo(t+i-o,n),e.arc(t+i-o,n+o,o,3*Math.PI/2,0,!1),e.lineTo(t+i,n+r-o),e.arc(t+i-o,n+r-o,o,0,Math.PI/2,!1),e.lineTo(t+o,n+r),e.arc(t+o,n+r-o,o,Math.PI/2,Math.PI,!1),e.lineTo(t,n+o)},formatTime:function(e){return e=Math.round(e),Math.floor(e/60)+(10>e%60?":0":":")+e%60},drawText:function(e,t,n,i,r,o,a,l){e.save(),e.font=o+'px "Gill Sans MT","Gill Sans",Calibri,sans-serif',e.fillStyle=n,e.textAlign=a,e.textBaseline=l,e.fillText(t,i,r),e.restore()}}}),define("views/fixtures",["data/colours","data/dimensions","views/util"],function(e,t,n){return{init:function(i,r){var o=t.CORNER-t.BORDER,a=t.BORDER-o,l=r.remainingLives,u=["AIR","FIRE","EARTH","WATER"],c=[],d=-1,s=-1,f=document.createElement("canvas");f.width=t.WIDTH,f.height=t.HEIGHT;for(var m=f.getContext("2d"),p=0;2>p;++p)for(var h=0;2>h;++h){for(var v=p*(t.WIDTH-t.CORNER)+t.CORNER/2,E=h*(t.HEIGHT-t.CORNER)+t.CORNER/2,R=m.createRadialGradient(v,E,0,v,E,t.CORNER/2),g=0;2>g;++g)R.addColorStop(g,e.ELEMENTS[u[p+2*h]][g]);c[p+2*h]=R}return{drawBorder:function(r){if(s!==r.remainingElements.length||d!==r.remainingLives){m.fillStyle=e.FIXTURES.BORDER,m.fillRect(0,o,t.WIDTH,a),m.fillRect(o,0,a,t.HEIGHT),m.fillRect(t.WIDTH-t.CORNER+o,0,a,t.HEIGHT);for(var p=0;l>=p;++p){var h=(p-l/2)*t.BORDER+t.WIDTH/2,v=(t.BORDER+o)/2;n.drawCircle(m,e.FIXTURES.SLOT,h,v,t.BALL.RADIUS+2),r.remainingLives>p&&n.drawCircle(m,e.BALL,h,v,t.BALL.RADIUS)}m.fillStyle=e.FIXTURES.CORNER,m.strokeStyle=e.FIXTURES.SLOT;for(var E=0;2>E;++E)for(var R=0;2>R;++R)m.fillRect(E*(t.WIDTH-t.CORNER),R*(t.HEIGHT-t.CORNER),t.CORNER,t.CORNER),m.save(),m.lineWidth=4,m.fillStyle=-1!==r.remainingElements.indexOf(u[E+2*R])?c[E+2*R]:e.FIXTURES.SLOT,n.drawRoundedRect(m,E*(t.WIDTH-t.CORNER)+t.CORNER/6,R*(t.HEIGHT-t.CORNER)+t.CORNER/6,2*t.CORNER/3,2*t.CORNER/3,t.CORNER/12),m.stroke(),m.fill(),m.restore();s=r.remainingElements.length,d=r.remainingLives}i.drawImage(f,0,0);var g=2*t.BORDER/3;n.drawText(i,n.formatTime(r.gameTime/1e3),e.FOREGROUND,t.WIDTH-t.BLOCK.MARGIN.X,(t.BORDER+o)/2,g,"right","middle"),n.drawText(i,r.levelName,e.FOREGROUND,t.BLOCK.MARGIN.X,(t.BORDER+o)/2,g,"left","middle")}}}}}),define("views/blocks",["data/colours","data/dimensions","views/util"],function(e,t,n){return{init:function(i,r){var o=function(e){var i=document.createElement("canvas");i.width=r.blockWidth,i.height=r.blockHeight;var o=i.getContext("2d");return o.fillStyle=e,o.beginPath(),n.drawRoundedRect(o,0,0,r.blockWidth,r.blockHeight,t.BLOCK.RADIUS),o.fill(),i},a=o(e.BLOCK),l={},u=1e3;for(var c in e.NOTES)e.NOTES.hasOwnProperty(c)&&(l[c]=o(e.NOTES[c]));return{drawBlock:function(e,t){e.hit?(i.save(),i.globalAlpha=Math.max(125,u+e.hit-t)/u,i.drawImage(l[e.note],e.x,e.y),i.restore()):i.drawImage(a,e.x,e.y)}}}}}),define("views/paddle",["data/colours","data/dimensions"],function(e,t){return{init:function(n){return{drawPaddle:function(i){n.fillStyle=e.PADDLE,n.fillRect(i.x-t.PADDLE.SIZE.X/2,i.top,t.PADDLE.SIZE.X,t.PADDLE.SIZE.Y)}}}}}),define("views/ball",["data/colours","data/dimensions","views/util"],function(e,t,n){return{init:function(i){return{drawBall:function(r,o){var a;if("number"==typeof r.mode.getNote(o))a=e.NOTES[r.mode.getNote(o)];else if(r.mode.element){a=i.createRadialGradient(r.x,r.y,0,r.x,r.y,t.BALL.RADIUS);for(var l=0;2>l;++l)a.addColorStop(l,e.ELEMENTS[r.mode.element][l])}else a=e.BALL;n.drawCircle(i,a,Math.round(r.x),Math.round(r.y),t.BALL.RADIUS)},drawWave:function(r){i.save(),i.globalAlpha=.65,i.fillStyle=e.ELEMENTS.WATER[0],n.drawRoundedRect(i,r.x-t.BALL.RADIUS,r.top,2*t.BALL.RADIUS,r.bottom-r.top,t.BALL.RADIUS),i.fill(),i.restore()}}}}}),define("input/keyboard",[],function(){var e=[];e[68]=1,e[82]=1.5,e[70]=2,e[84]=2.5,e[71]=3,e[72]=4,e[85]=4.5,e[74]=5,e[73]=5.5,e[75]=6,e[79]=6.5,e[76]=7;var t=[];return t[32]="LAUNCH",t[49]="EARTH",t[50]="AIR",t[51]="FIRE",t[52]="WATER",t[80]="PAUSE",{noteMap:e,actionMap:t,init:function(){var n={},i=null,r=0,o=null,a=function(t){return e[t]},l=function(e){return 191===e?1:90===event.keyCode?-1:void 0},u=function(e){return t[e]};return document.onkeydown=function(e){a(e.keyCode)?i=a(e.keyCode):l(e.keyCode)?r=l(e.keyCode):u(e.keyCode)&&(o=u(e.keyCode))},document.onkeyup=function(e){l(e.keyCode)===r?r=0:u(e.keyCode)===o?o=null:a(e.keyCode)===i&&(i=null)},n.getNote=function(){return i},n.getDirection=function(){return r},n.getAction=function(){return o},n.clearAction=function(){o=null},n}}}),define("views/help",["data/colours","data/dimensions","views/util","input/keyboard"],function(e,t,n,i){return{init:function(){var r=document.createElement("canvas");r.width=t.WIDTH,r.height=t.HEIGHT,r.classList.add("keyMap");var o=r.getContext("2d"),a=t.CORNER,l=function(e,t,i,r,l){n.drawRoundedRect(o,e,t,a,a,a/8),o.fillStyle=i,o.fill(),n.drawText(o,l,r,e+7*a/8,t+7*a/8,a/2,"right","bottom")},u=a/3,c=t.HEIGHT-2*t.BLOCK.MARGIN.Y,d=(t.WIDTH-7*a-6*u)/2,s=function(t){var n=d+(t-1)*a+Math.floor(t-1)*u,r=c;t===Math.floor(t)&&(r+=a+u),l(n,r,e.NOTES[t],e.FOREGROUND,String.fromCharCode(i.noteMap.indexOf(t)))};for(var f in e.NOTES)e.NOTES.hasOwnProperty(f)&&s(parseFloat(f));for(var m=function(r){var u=a/2,c="left",d=u;r>2&&(u=t.WIDTH-3*a/2,c="right",d=u+a);var s=a/2,f=s+3*a/2;(1===r||4===r)&&(s=t.HEIGHT-3*a/2,f=s-a/2),l(u,s,e.FOREGROUND,e.BACKGROUND,r),n.drawText(o,i.actionMap[r.toString().charCodeAt(0)],e.FOREGROUND,d,f,2*a/3,c,"middle")},p=1;4>=p;++p)m(p);var h=function(t,i,r){var s=d+3*a+3*u+4.5*t*(a+u),f=c+2*(a+u);l(s,f,e.BACKGROUND,e.FOREGROUND,i),n.drawText(o,r.toUpperCase(),e.FOREGROUND,s+(-2*t+1)*a/2,f+a/2,2*a/3,r,"middle")};return h(-1,"Z","left"),h(1,"/","right"),r},drawHint:function(i,r){r.getHint()&&n.drawText(i,r.getHint(),e.FOREGROUND,t.WIDTH/2,t.HEIGHT-t.BLOCK.MARGIN.Y,3*t.CORNER/4,"center","middle")}}}),define("views/game",["data/colours","data/dimensions","views/fixtures","views/blocks","views/paddle","views/ball","views/help"],function(e,t,n,i,r,o,a){var l={CLEARED:"Level cleared!",FAILED:"Game over!",PAUSED:"Paused"};return{init:function(u,c){var d=document.createElement("canvas");d.setAttribute("width",t.WIDTH),d.setAttribute("height",t.HEIGHT),d.style.backgroundColor=e.BACKGROUND,u.appendChild(d);var s=document.createElement("div");s.style.display="none",s.style.width=t.WIDTH+"px",s.style.height=t.HEIGHT+"px",s.classList.add("pause");var f=document.createElement("h2"),m=document.createTextNode(""),p=document.createElement("p"),h=document.createTextNode("Press SPACE to continue");f.appendChild(m),p.appendChild(h),s.appendChild(f),s.appendChild(p),s.appendChild(a.init()),u.appendChild(s);var v=d.getContext("2d"),E=(new Date).getTime(),R=0,g=E,T=n.init(v,c),A=i.init(v,c.blocks),I=r.init(v),N=o.init(v),C=!1,y=function(e){if(e-g>100)return R+=e-g,void 0;var n=e-E-R,i=c.update(n);i&&(s.style.display="block",C=i,l.hasOwnProperty(i)&&m.replaceWholeText(l[i]));var r=function(e){A.drawBlock(e,n)};v.clearRect(0,0,t.WIDTH,t.HEIGHT),T.drawBorder(c,n),c.blocks.all.forEach(function(e){e.forEach(r)}),I.drawPaddle(c.paddle),c.ball&&N.drawBall(c.ball,c.input),c.wave&&N.drawWave(c.wave),a.drawHint(v,c)},O=function(){var e=(new Date).getTime();if(C&&"LAUNCH"===c.input.getAction()){if("PAUSED"!==C)return window.location.reload(),void 0;C=!1,s.style.display="none",c.input.clearAction()}else C||(y(e),g=e);window.requestAnimationFrame(O)};window.requestAnimationFrame(O)}}}),define("models/maths",[],function(){var e=function(e){for(var t=0,n=0;n<e.length;++n)t+=e[n]*e[n];return Math.sqrt(t)};return{dotProduct:function(e,t){for(var n=0,i=0;i<e.length&&i<t.length;++i)n+=e[i]*t[i];return n},magnitude:e,cartesianDistance:function(e,t){for(var n=0,i=0;i<e.length&&i<t.length;++i)n+=(e[i]-t[i])*(e[i]-t[i]);return Math.sqrt(n)},normalise:function(t){for(var n=e(t),i=[],r=0;r<t.length;++r)i[r]=t[r]/n;return i}}}),define("models/physics",["models/maths"],function(e){var t=function(t,n){var i=[t.position()[0]+n.r*t.positionNormal()[0],t.position()[1]+n.r*t.positionNormal()[1]];return e.dotProduct([n.x,n.y],t.positionNormal())-e.dotProduct(i,t.positionNormal())},n=function(t,n){var i=t.distance(n),r=-e.dotProduct([n.dx,n.dy],t.positionNormal(n)),o=i/r;return o};return{reflectionV:function(t,n){var i=e.dotProduct(t,n);return[t[0]-2*n[0]*i,t[1]-2*n[1]*i]},createPoint:function(t,n,i,r){var o=[n,i],a={type:t,position:function(){return o},positionNormal:function(t){return e.normalise([t.x-n,t.y-i])},collideAt:function(t,o,a,l){return!r||r(t,o,a,l)?e.normalise([t-n,o-i]):null}};return a.distance=function(t){return e.cartesianDistance(o,[t.x,t.y])-t.r},a},createPlane:function(e,n,i,r){if("number"==typeof i){var o=[Math.abs(n[0])*i,Math.abs(n[1])*i];i=function(){return o}}var a={type:e,positionNormal:function(){return n},position:i,collideAt:r||function(){return n}};return a.distance=function(e){return t(a,e)},a},sortByCollisionTime:function(e,t){var i=e.concat();return i.forEach(function(e){e.collisionTime=n(e,t)}),i.sort(function(e,t){return e.collisionTime-t.collisionTime}),i}}}),define("models/fixtures",["data/dimensions","models/physics"],function(e,t){var n=t.createPlane("FIXTURE",[1,0],e.BORDER),i=t.createPlane("FIXTURE",[0,1],e.BORDER),r=t.createPlane("FIXTURE",[-1,0],e.WIDTH-e.BORDER),o=t.createPoint("FIXTURE",e.CORNER,e.HEIGHT-e.CORNER),a=t.createPoint("FIXTURE",e.CORNER,e.HEIGHT-e.CORNER),l=t.createPoint("FIXTURE",e.CORNER,e.HEIGHT-e.CORNER),u=t.createPoint("FIXTURE",e.CORNER,e.HEIGHT-e.CORNER),c=[i,n,r,o,a,l,u];return{init:function(){return{getCollisionObjects:function(){return c}}}}}),define("output/sound",[],function(){var e=[1,1.5,2,2.5,3,4,4.5,5,5.5,6,6.5,7],t=60;return{getMidiNote:function(n){return t+e.indexOf(n)},init:function(e){var t=e.getChannel();return{playHit:function(e){t.playNote(e,1e3)},playBounce:function(e){t.playNote(e,1e3)},startNote:function(e){return t.startNote(e)}}}}}),define("models/blocks",["data/dimensions","models/physics","output/sound"],function(e,t,n){var i=function(i,r){function o(e){for(var n=[],i=function(t){var n=d>=(t-l)%f;if(n){var i=Math.floor((t-l)/f);if(i>=0&&i<e.length)return i}return null},r=function(n,i){return t.createPlane("BLOCK",[0,i],p(n)+d*(i+1)/2,function(t,r,o,a){var l=h(e,t);return null!==l&&v(e[n][l],o,a)?[0,i]:null})},o=function(n,r){return t.createPlane("BLOCK",[r,0],m(n)+c*(r+1)/2,function(t,o,a,l){var u=i(o);return null!==u&&v(e[u][n],a,l)?[r,0]:null})},a=0;a<e.length;++a)n.push(r(a,-1)),n.push(r(a,1));for(var u=0;u<e[0].length;++u)n.push(o(u,-1)),n.push(o(u,1));return n}var a=e.BLOCK.MARGIN.X,l=e.BLOCK.MARGIN.Y,u=(e.WIDTH-2*e.BLOCK.MARGIN.X)/(4*i[0].length+i[0].length-1),c=Math.round(4*u),d=Math.round(c/e.BLOCK.RATIO),s=Math.round(5*u),f=Math.round((e.HEIGHT-3*e.BLOCK.MARGIN.Y)/i.length),m=function(e){return a+e*s},p=function(e){return l+e*f},h=function(e,t){var n=c>=(t-a)%s;if(n){var i=Math.floor((t-a)/s);if(i>=0&&i<e[0].length)return i}return null},v=function(e,t,n){return e.hit?void 0:n===!0||e.note===n?(r.playHit(e.midiNote),e.hit=t,n===!0):(r.playBounce(e.midiNote),!0)},E=function(e){for(var n=[],i=function(e){var i=function(t,n,i,r){return v(e,i,r)};n.push(t.createPoint("BLOCK",e.x,e.y,i)),n.push(t.createPoint("BLOCK",e.x+c,e.y,i)),n.push(t.createPoint("BLOCK",e.x,e.y+d,i)),n.push(t.createPoint("BLOCK",e.x+c,e.y+d,i))},r=0;r<e.length;++r)for(var o=0;o<e[r].length;++o)i(e[r][o]);return n},R=function(e,t,n){var i=h(I,e);if(null!==i){var r=Math.max(0,Math.floor((t-l+(f-d))/f));if(r<I.length){var o=Math.min(I.length-1,(n-l)/f);if(o>=0){for(var a=[],u=r;o>=u;++u)a.push(I[u][i]);return a}}}return[]},g=function(e){return{note:e,midiNote:n.getMidiNote(e)}},T=function(e){for(var t,n,i,r=!0;r;)for(r=!1,n=0;n<e[0].length;++n)for(t=0,i=e.length-1;i>=0;--i)e[i][n].midiNote<t&&(e[i][n].midiNote+=12,r=!0),t=e[i][n].midiNote;return e},A=function(e){for(var t=0;t<e[0].length;++t)for(var n=e.length-1;n>=0;--n)e[n][t].x=m(t),e[n][t].y=p(n);return e},I=A(T(i.map(function(e){return e.map(g)}))),N=o(I),C=E(I);return{all:I,blockWidth:c,blockHeight:d,getCollisionObjects:function(){return N.concat(C)},getCollisionPlanes:function(){return N},getCollisionPoints:function(){return C},getIntersection:R}};return{init:i}}),define("models/paddle",["data/dimensions","models/physics"],function(e,t){return{init:function(){var n={},i=e.WIDTH/2500,r=e.PADDLE.MARGIN.X+e.PADDLE.SIZE.X/2,o=e.WIDTH-e.PADDLE.MARGIN.X-e.PADDLE.SIZE.X/2,a=e.PADDLE.SIZE.X/2,l=.95*Math.PI/4,u=.99*Math.PI/4;return n.update=function(e,t){n.x+=t*i*e,n.x<r?n.x=r:n.x>o&&(n.x=o)},n.getCollisionObjects=function(){return[t.createPlane("PADDLE",[0,-1],n.top,n.positionNormal)]},n.positionNormal=function(t){var i,r,o=t-n.x;return Math.abs(o)<a?(i=o/a,r=l*Math.PI/4*i*i*i,[Math.sin(r),-Math.cos(r)]):Math.abs(o)<a+e.BALL.RADIUS?(i=Math.abs(o)-a,r=(l+(u-l)*(i/e.BALL.RADIUS))*o/Math.abs(o),[Math.sin(r),-Math.cos(r)]):null},n.x=e.WIDTH/2,n.top=e.HEIGHT-e.PADDLE.MARGIN.Y-e.PADDLE.SIZE.Y,n}}}),define("models/ball",["data/dimensions","models/physics","models/maths","output/sound"],function(e,t,n,i){var r=function(){return!0},o=function(){return!1},a=e.WIDTH/3e3,l=null,u={STANDARD:{speed:a,getNote:function(e){return null===e.getNote()?l:e.getNote()},isSolid:r,isSticky:o},EARTH:{element:"EARTH",speed:5*a/6,getNote:function(e){return e.getNote()},isSolid:r,isSticky:function(e){return"PADDLE"===e}},AIR:{element:"AIR",speed:5*a/4,getNote:o,isSolid:function(e){return"BLOCK"!==e},isSticky:o},FIRE:{element:"FIRE",speed:5*a/3,getNote:r,isSolid:r,isSticky:o}};return{init:function(r,o,a,c){var d={};l=null,d.alive=!0,d.released=!1,d.x=r.x,d.y=r.top-e.BALL.RADIUS,d.mode=u.STANDARD;var s=d.r=e.BALL.RADIUS,f=0,m=-u.STANDARD.speed,p=function(n,r){for(var l,u=d.x+f*n,p=d.y+m*n,h=null,v=t.sortByCollisionTime(o,{x:d.x,y:d.y,dx:f,dy:m,r:s}),E=n;!h&&(l=v.shift())&&!(l.collisionTime>E);){var R=l.distance(d),g=l.distance({x:u,y:p,r:s});if(R>-e.BALL.RADIUS&&R>g&&0>=g){var T=n*R/(R-g);if(u=d.x+f*T,p=d.y+m*T,h=l.collideAt(u,p,r,d.mode.getNote(a)),h&&d.mode.isSolid(l.type)){var A=t.reflectionV([f,m],h);f=A[0],m=A[1],"number"==typeof d.mode.getNote(a)&&c.playBounce(i.getMidiNote(d.mode.getNote(a)))}if(h&&d.mode.isSticky(l.type)){d.released=!1;continue}u+=f*(n-T),p+=m*(n-T)}}d.x=u,d.y=p};return d.update=function(t,i,o){if(null!==a.getNote()&&(l=a.getNote()),d.released?(p(t,o),d.y>e.HEIGHT&&(d.alive=!1)):d.x=r.x,"LAUNCH"===i)d.released||(d.released=!0,f=0,m=-d.mode.speed);else if(u.hasOwnProperty(i)){d.mode=u[i];var c=n.normalise([f,m]);f=c[0]*d.mode.speed,m=c[1]*d.mode.speed}},d}}}),define("models/wave",["data/dimensions"],function(e){var t=e.HEIGHT/4800;return{init:function(n,i,r){var o={},a=!0,l=[];return o.alive=!0,o.x=n.x,o.bottom=n.top,o.top=n.top,o.update=function(u){if(o.x=n.x,a?(o.top-=t*u,o.top<e.BORDER&&(o.top=e.BORDER,a=!1)):(o.bottom-=t*u/2,o.bottom<o.top+2*e.BALL.RADIUS&&(o.bottom=o.top,o.alive=!1)),o.alive){var c=i.getIntersection(o.x,o.top,o.bottom);l.concat().forEach(function(e){var t=c.indexOf(e.block);-1===t?(e.note.stop(),e.toDelete=!0):c.splice(t,1)}),l=l.filter(function(e){return!e.toDelete}),c.forEach(function(e){e.hit||l.push({block:e,note:r.startNote(e.midiNote)})})}},o}}}),define("models/game",["data/progress","models/fixtures","models/blocks","models/paddle","models/ball","models/wave"],function(e,t,n,i,r,o){function a(e){for(var t=0;t<e.all.length;++t)for(var n=0;n<e.all[t].length;++n)if(!e.all[t][n].hit)return!1;return!0}var l=["EARTH","AIR","FIRE","WATER"];return{init:function(u,c,d){var s={};s.gameTime=0,s.input=c,s.remainingLives=3,s.remainingElements=l.concat(),s.fixtures=t.init(),s.blocks=n.init(u.notes,d),s.paddle=i.init(),s.levelName=u.name;var f=s.fixtures.getCollisionObjects().concat(s.blocks.getCollisionObjects(),s.paddle.getCollisionObjects()),m=function(){return r.init(s.paddle,f,c,d)},p=function(){return s.ball||s.wave};return s.ball=m(),s.update=function(t){var n=t-s.gameTime,i=c.getAction();if("PAUSE"===i)return"PAUSED";var r=s.remainingElements.indexOf(i);if(-1===r?-1!==l.indexOf(i)&&(i=null):(s.remainingLives++,s.remainingElements.splice(r,1),s.wave&&(s.wave=null,s.ball=m())),s.paddle.update(n,c.getDirection()),"WATER"===i&&(s.ball=null,s.wave=o.init(s.paddle,s.blocks,d)),null!==s.ball?s.ball.update(n,i,t):null!==s.wave&&s.wave.update(n),!p().alive){if(--s.remainingLives,s.remainingLives<0)return"FAILED";s.wave=null,s.ball=m()}return s.gameTime=t,a(s.blocks)?(e.saveTime(u.id,Math.round(t/1e3)),"CLEARED"):void 0},s.getHint=function(){if(s.input.getHint){var e=s.input.getHint(s);if(e)return e}else if(s.ball&&!s.ball.released)return"Press SPACE to launch the ball (or P to pause the game)";return null},s}}}),define("input/tutorial",["input/keyboard"],function(e){return{init:function(){var t,n=e.init(),i=!1,r=[],o=null,a=function(e,n){o=e,t={},l[e].init(n)},l=[{hint:"Press SPACE to launch the ball..",test:function(e){return e.ball.released},init:function(){r.push("LAUNCH")}},{hint:"To clear the block, the ball must match its note.\nTry pressing D...",test:function(e){return e.blocks.all[2][3].hit},init:function(){}},{hint:"This next block has a different note. Try pressing G...",test:function(e){return e.blocks.all[1][3].hit},init:function(){}},{hint:"This block has another note again. Try pressing J...",test:function(e){return e.blocks.all[0][3].hit},init:function(){}},{hint:"You can move the paddle left and right with the Z and / keys..",test:function(e){return e.paddle.x!==t.initialPaddleX},init:function(e){i=!0,t.initialPaddleX=e.paddle.x}},{hint:"Finally, you can activate special elemental powers. Try pressing 3 now!",test:function(e){return e.remainingElements.length<4&&!e.ball.mode.element},init:function(){r.push("FIRE")}},{hint:"You can pause the game at any time and view help by pressing P...",test:function(){return"PAUSE"===n.getAction()},init:function(){r.push("PAUSE","EARTH","AIR","WATER")}},{hint:null,test:function(){return!1},init:function(){}}];return a(0),self.getHint=function(e){var t=l[o];return t.test(e)&&a(o+1,e),t.hint},self.getNote=function(){return n.getNote()},self.getDirection=function(){return i?n.getDirection():0},self.getAction=function(){var e=n.getAction();return-1!==r.indexOf(e)?e:null},self.clearAction=function(){return n.clearAction()},self}}}),/** @license http://chromium.googlecode.com/svn/trunk/samples/audio/index.html
 Copyright 2009, Google Inc.
 All rights reserved.

 Redistribution and use in source and binary forms, with or without
 modification, are permitted provided that the following conditions are
 met:

 * Redistributions of source code must retain the above copyright
 notice, this list of conditions and the following disclaimer.
 * Redistributions in binary form must reproduce the above
 copyright notice, this list of conditions and the following disclaimer
 in the documentation and/or other materials provided with the
 distribution.
 * Neither the name of Google Inc. nor the names of its
 contributors may be used to endorse or promote products derived from
 this software without specific prior written permission.

 THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS
 "AS IS" AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT
 LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR
 A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT
 OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL,
 SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT
 LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE,
 DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY
 THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
 (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE
 OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
 */
define("output/wavetable-5",[],function(){return{uncompress:function(e){return e/1e5},real:[0,12677,1797,-1823,-57,1813,-190,294,-732,586,95,129,-184,-206,121,-75,125,-189,-208,174,-20,17,-88,224,-241,223,218,-327,324,-95,-102,218,-308,212,-215,-129,259,-215,-294,250,272,-108,90,188,-274,278,-276,151,-102,-127,143,-248,261,-191,131,-26,-123,215,-236,223,-98,60,32,-44,182,-193,52,-68,-30,131,-185,159,-164,65,-61,-76,74,-151,138,-118,80,72,-84,120,-144,122,-118,-29,-42,-136,43,-135,113,-64,-37,92,-113,22,-127,126,-64,20,-1,-105,-124,-124,111,-95,-100,12,-112,89,-105,-69,111,-92,-60,-103,9,-62,49,-22,-82,20,-110,-21,-110,-89,-100,-97,-102,-104,-101,-101,-92,-68,-103,-81,-101,-76,-84,-102,-62,-86,-100,-100,-93,-99,-98,-80,-90,-98,-94,-97,-91,-75,-97,-80,-87,-80,-86,-78,-86,-86,-82,-78,-85,-85,-85,-82,-74,-84,-84,-80,-79,-83,-83,-79,-81,-76,-79,-70,-78,-81,-80,-74,-80,-78,-74,-76,-76,-64,-76,-74,-74,-76,-74,-74,-75,-76,-74,-69,-73,-75,-74,-74,-74,-74,-71,-73,-74,-73,-72,-71,-71,-69,-67,-63,-60,-56,-48,-44,-34,-28,-17,-9,1,10,18,27,35,42,47,53,58,61,63,64,62,63,62,62,63,63,62,62,62,62,61,61,61,62,60,60,61,61,60,59,60,60,59,58,59,60,59,58,59,60,58,57,58,59,57,57,58,59,57,56,58,58,57,56,57,58,56,55,57,57,56,55,56,57,55,54,56,57,55,54,56,56,55,53,55,56,54,53,55,56,54,53,55,55,54,52,54,55,53,52,54,55,53,52,54,55,53,51,53,54,52,51,53,54,52,51,53,54,52,51,53,53,52,50,52,53,51,50,52,53,51,50,52,53,51,50,52,52,50,49,51,52,50,49,51,52,50,49,51,52,50,49,51,51,49,48,50,51,49,48,50,51,49,48,50,51,49,48,50,50,49,47,49,50,48,47,49,50,48,47,49,50,48,47,49,49,48,47,48,49,48,46,48,49,47,46,48,49,47,46,48,49,47,46,48,48,47,46,47,48,47,45,47,48,46,45,47,48,46,45,47,47,46,45,47,47,46,45,46,47,46,44,46,47,45,44,46,47,45,44,46,46,45,44,46,46,45,44,45,46,45,44,45,46,45,44,45,46,44,43,45,46,44,43,45,45,44,43,45,45,44,43,44,45,44,43,44,45,44,42,44,44,44,42,45,46,46,45,46,47,46,45,46,47,46,44,46,47,46,44,46,47,45,44,46,46,45,44,46,46,45,44,46,46,45,44,45,46,45,44,45,46,45,44,45,46,45,43,45,45,44,43,45,45,44,43,45,45,44,43,44,45,44,43,44,45,44,43,44,45,44,42,44,44,44,42,44,44,43,42,44,44,43,42,44,44,43,42,43,44,43,42,43,44,43,42,43,44,43,42,43,43,43,41,43,43,42,41,43,43,42,41,43,43,42,41,42,43,42,41,42,43,42,41,42,43,42,41,42,42,42,41,42,42,42,41,42,42,41,40,42,42,41,40,42,42,41,40,41,42,41,40,41,42,41,40,41,42,41,40,41,41,41,40,41,41,41,40,42,42,42,41,42,42,42,41,42,42,42,41,42,42,41,40,42,42,41,40,42,42,41,40,41,42,41,40,41,42,41,40,41,41,41,40,41,41,41,40,41,41,41,40,41,41,41,40,41,41,40,39,41,41,40,39,41,41,40,39,40,41,40,39,40,41,40,39,40,40,40,39,40,40,40,39,40,40,40,39,40,40,40,39,40,40,39,39,40,40,39,38,40,40,39,38,39,40,39,38,39,40,39,38,39,39,39,38,39,39,39,38,39,39,39,38,39,39,39,38,39,39,39,38,39,39,39,38,39,39,38,38,39,39,38,37,39,39,38,37,38,39,38,37,38,38,38,37,38,38,38,37,38,38,38,37,38,38,38,37,38,38,38,37,38,38,38,37,38,38,38,37,38,38,37,37,38,38,37,37,38,38,37,36,37,38,37,36,37,37,37,36,37,37,37,36,37,37,37,36,37,37,37,36,37,37,37,36,37,37,37,36,37,37,37,36,37,37,37,36,37,37,36,36,37,37,36,36,37,37,36,36,36,37,36,35,36,36,36,35,36,36,36,35,36,36,36,35,36,36,36,35,36,36,36,35,36,36,36,35,36,36,36,35,36,36,36,35,36,36,36,35,36,36,35,35,36,36,35,35,36,36,35,35,35,35,35,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,34,34,35,35,34,34,35,35,33,34,34,34,34,34,34,34,34,33,34,34,34,33,34,34,34,34,34,34,34,34,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,33,33,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,32,33,33,33,33,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,34,35,35,35,34,35,35,35,34,35,35,35,34,35,35,34,34,35,35,34,34,34,34,34,34,34,34,34,34,34,34,34,33,34,34,34,34,34,34,34,33,34,34,34,34,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,32,33,33,33,32,33,33,33,33,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,32,33,32,33,33,33,32,33,32,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,31,32,32,32,32,32,32,32,31,32,32,32,31,32,32,32,31,32,32,32,32,32,32,32,31,32,32,32,31,32,32,32,31,32,32,32,31,32,32,32,31,32,32,32,31,32,32,32,31,32,31,32,31,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,33,33,33,33,32,33,33,33,33,33,33,33,33,33,33,33,32,33,33,33,33,33,33,33,33,33,33,33,32,33,33,33,33,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,32,33,32,33,33,33,32,33,32,33,32,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,31,32,32,32,32,32,32,32,31,32,32,30,30,32,32,32,31,32,32,32,31,32,32,32,31,32,32,32,31,32,32,32,31,32,32,32,31,32,31,32,31,31,31,32,32,31,31,32,31,32,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,31,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,34,33,34,34,34,33,34,34,34,33,34,34,34,33,34,33,34,33,34,33,34,33,34,33,34,33,34,33,34,33,34,33,34,33,34,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,32,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,33,33,32,33,32,33,32,33,33,33,32,33,32,33,32,33,32,33,32,33,32,33,32,33,32,33,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,32,31,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,36,37,37,37,37,37,37,37,36,37,37,37,37,37,37,37,37,37,37,37,36,37,37,37,36,37,37,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,37,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,35,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,35,36,36,36,35,36,35,36,36,36,36,36,36,36,40,41,40,41,40,41,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,40,39,40,39,40,39,40,39,40,39,40,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36,36],imag:[0,-4906,-6626,5304,-364,1612,-1670,-366,218,251,381,-263,143,-105,195,209,-175,89,-17,139,245,336,-350,315,292,-297,183,-74,-63,310,-302,225,-79,-231,222,-286,168,-216,-66,161,-109,279,-281,223,-92,66,59,-235,257,-242,230,-101,47,157,-207,241,-207,104,-14,-72,211,-223,226,-223,108,83,-202,195,-203,131,-2,91,78,-169,141,-133,132,-7,-58,90,-125,128,-120,81,11,-66,72,-134,130,6,128,0,-71,117,-127,94,-65,128,-27,27,111,-126,127,-70,-18,-16,-56,80,-73,122,49,-83,61,-99,46,-76,103,59,118,100,106,115,-82,114,34,-113,31,71,36,44,-29,18,27,27,-49,79,5,64,20,-68,58,-5,-80,-52,-10,-11,-36,-5,-14,58,39,-4,27,-4,35,-62,-2,36,11,35,-9,37,6,0,26,-35,-11,6,0,22,40,8,1,25,25,4,1,26,15,31,22,41,23,0,12,33,7,4,23,14,13,43,9,19,21,6,18,16,7,3,12,29,17,1,11,9,-3,-9,20,6,0,10,14,16,15,23,26,36,40,45,53,56,63,66,69,71,71,70,68,65,61,56,51,46,39,33,30,26,20,16,16,17,14,13,15,17,15,14,17,19,16,14,18,20,16,15,18,20,17,15,19,21,17,15,19,21,17,14,19,21,17,14,19,22,17,14,19,22,17,14,19,22,17,14,19,22,17,13,19,22,16,13,19,22,16,13,19,22,16,13,19,21,16,12,19,21,16,12,18,21,15,12,18,21,15,12,18,21,15,11,18,21,15,11,18,21,15,11,18,20,14,11,17,20,14,10,17,20,14,10,17,20,14,10,17,20,13,9,16,20,13,9,16,19,13,9,16,19,13,9,16,19,13,9,16,19,12,8,15,19,12,8,15,19,12,8,15,18,12,8,15,18,12,8,15,18,11,7,14,18,11,7,14,18,11,7,14,17,11,7,14,17,11,7,14,17,11,6,13,17,11,6,13,17,10,6,13,17,10,6,13,17,10,6,13,16,10,6,13,16,10,5,13,16,10,5,12,16,9,5,12,16,9,5,12,16,9,5,12,16,9,4,12,15,9,4,12,15,9,4,11,15,9,4,11,15,9,4,11,15,9,4,11,15,8,4,11,15,8,3,11,15,8,3,11,15,8,3,10,14,8,3,10,13,8,3,10,14,5,8,10,15,14,10,10,14,8,3,11,15,8,3,10,15,8,3,10,15,8,3,10,14,7,3,10,14,7,3,10,14,8,2,10,14,7,2,10,14,7,2,10,14,7,3,10,14,7,2,9,14,7,2,9,13,7,2,9,13,7,2,9,14,7,2,9,13,7,1,9,13,7,2,9,13,7,2,9,13,7,1,9,13,6,2,9,13,7,1,8,13,7,2,8,13,6,1,8,13,6,1,8,13,6,1,8,13,6,1,8,12,6,1,8,12,6,0,8,12,6,1,8,12,6,1,8,12,6,1,7,12,6,1,8,12,6,1,7,11,6,1,7,12,5,0,7,12,5,0,7,11,5,0,7,11,5,0,7,11,5,0,7,11,5,0,7,11,5,0,7,12,5,0,7,11,5,0,7,11,5,1,7,11,5,0,7,11,5,0,6,11,5,0,7,11,5,0,7,11,5,0,6,11,5,0,6,11,5,0,7,11,4,0,6,11,5,0,6,11,4,0,6,10,4,0,6,10,4,0,6,10,5,0,6,11,4,0,6,10,4,0,6,10,4,0,6,11,4,0,6,10,4,0,6,10,4,0,5,10,4,0,5,10,4,0,6,10,4,0,5,10,4,0,6,10,4,0,5,10,4,0,5,9,4,0,5,10,4,0,5,10,4,0,5,10,4,0,5,10,4,-1,5,9,3,0,5,9,4,-1,5,9,4,0,5,10,3,0,5,9,3,0,5,9,3,0,4,9,3,0,5,9,4,-1,5,10,3,-1,5,9,3,-1,5,9,3,-1,5,9,3,0,4,9,3,-1,4,9,3,-1,4,9,3,-1,5,9,3,-1,4,9,3,-1,4,8,3,-1,4,9,3,-1,4,9,3,-1,4,9,3,-1,4,8,3,-1,5,8,3,-1,4,8,3,0,4,7,3,-1,4,8,3,-1,4,8,3,-1,3,8,3,-2,3,7,3,0,3,8,3,-1,4,9,3,-1,4,9,3,0,4,8,3,0,4,9,3,-1,4,8,3,-1,4,8,2,-2,3,8,2,-1,4,8,3,-2,4,9,3,-1,3,8,3,-2,4,8,2,-1,3,8,3,-1,3,8,3,-1,4,8,3,-2,4,7,2,-2,3,7,3,-2,4,8,2,-1,3,8,2,-2,4,8,4,-2,5,7,2,0,8,7,1,1,9,3,3,-3,3,7,1,-1,3,9,2,-2,2,8,2,-2,2,7,3,-3,3,6,3,-1,2,7,2,-2,3,7,2,-1,3,6,2,-2,3,7,2,-2,3,8,2,-2,3,7,2,-2,3,8,2,-1,3,7,2,-2,4,7,2,-2,3,7,2,-2,3,7,2,-2,2,6,2,-1,3,7,2,-2,3,7,2,-2,3,6,2,0,2,7,2,0,2,7,2,-2,3,7,2,-2,3,7,2,-1,3,7,2,-2,2,7,2,-1,3,7,1,-2,2,7,2,-4,2,6,2,-2,2,7,2,-2,3,7,2,-2,3,7,2,-2,3,7,2,-2,3,7,2,-3,2,7,2,-2,3,7,2,-3,2,7,1,-2,3,7,1,-3,2,6,2,-3,2,7,2,-2,3,7,2,-2,3,7,2,-3,3,7,1,-1,3,6,1,-2,2,6,2,-2,2,7,2,-2,2,6,2,-2,3,6,2,-3,3,7,2,-2,3,6,1,-2,2,7,2,-3,2,6,1,-2,2,7,2,-2,2,7,1,-3,2,6,1,-2,2,6,1,-3,2,7,1,-2,2,6,2,-2,2,5,1,-2,2,6,1,-2,2,6,1,-2,2,6,1,-2,2,5,1,-2,2,7,1,-2,2,6,1,-3,2,6,1,-2,2,6,1,-2,2,6,2,-3,2,5,3,-2,1,6,1,-3,1,6,1,-3,2,6,2,-2,2,6,0,-2,2,6,1,-2,2,7,1,-2,2,6,2,-3,2,7,1,-2,1,6,1,-2,1,6,1,-3,2,5,0,-3,1,5,1,-3,1,5,1,-2,2,6,1,-3,1,6,1,-2,1,6,1,-3,2,5,1,-3,1,6,1,-2,1,6,1,-2,2,7,1,-3,2,5,1,-3,2,7,1,-3,1,5,1,-2,2,6,1,-3,2,6,1,-2,1,7,1,-2,2,6,1,-3,2,6,1,-3,2,6,2,-2,1,6,1,-3,2,5,0,-4,1,6,1,-3,2,5,0,-2,2,5,1,-3,1,6,0,-3,1,7,1,-3,2,5,1,-3,1,5,1,-3,1,6,1,-2,1,6,0,-3,1,5,1,-3,2,5,1,-3,1,5,1,-3,1,6,1,-3,2,5,1,-4,1,6,1,-3,1,5,0,-3,1,4,1,-3,1,4,1,-3,1,5,0,-3,2,5,1,-3,1,5,1,-2,1,6,0,-3,1,5,0,-4,0,8,0,-1,10,10,-1,-3,1,5,1,-3,1,5,0,-3,2,6,1,-4,1,5,0,-2,1,5,1,-3,1,6,1,-4,1,5,2,-6,1,1,2,-4,1,6,0,-3,1,4,0,-3,0,5,2,-3,0,5,0,-3,1,5,1,-4,0,4,1,-4,0,6,0,-3,1,6,1,-2,1,6,1,-3,1,4,1,-4,0,5,0,-5,1,5,1,-3,3,2,-2,-2,4,4,1,-4,1,5,1,-3,0,5,0,-3,0,6,0,-4,2,6,0,-4,1,5,1,-3,1,5,0,-4,1,5,0,-4,1,6,0,-4,1,5,1,-5,1,7,1,-3,1,5,0,-3,1,4,1,-4,1,5,0,-3,0,6,1,-5,1,4,0,-2,0,5,0,-3,0,5,1,-4,0,3,0,-3,0,5,0,-5,0,5,0,-3,0,7,0,-3,2,6,0,-4,1,6,1,-4,1,4,0,-4,0,5,0,-3,1,6,1,-3,1,5,0,-4,1,5,1,-4,0,5,1,-3,1,5,0,-4,0,5,0,-3,0,5,0,-4,1,4,0,-2,1,5,0,-3,1,5,0,-3,0,5,0,-2,0,5,0,-4,0,5,0,-3,0,4,0,-5,0,4,0,-4,0,5,0,-4,0,5,0,-4,0,4,0,-3,-1,6,0,-4,0,4,0,-4,0,5,0,-4,1,5,0,-3,0,5,0,-4,0,5,0,-6,1,4,0,-5,0,6,0,-5,1,6,0,-5,0,6,0,-3,0,5,0,-4,0,5,1,-6,1,6,1,-4,0,5,0,-4,0,7,0,-5,0,5,0,-4,0,6,0,-5,0,5,0,-4,0,4,0,-5,1,6,0,-4,0,5,0,-4,0,5,0,-5,0,6,0,-5,0,5,0,-5,0,6,0,-4,0,5,0,-5,0,5,0,-4,0,5,0,-5,0,5,0,-5,0,5,0,-4,0,7,0,-4,0,5,0,-5,0,5,0,-4,0,5,0,-4,0,6,0,-4,0,5,0,-4,0,6,0,-8,0,5,0,0,0,5,0,-3,0,5,0,-5,1,4,0,-5,0,4,0,-5,0,5,0,-5,1,5,0,-5,0,6,0,-4,0,5,0,-6,0,3,0,-4,1,4,0,-4,0,7,0,-5,0,6,0,-4,0,5,0,-5,0,6,0,-7,0,5,0,-5,0,6,0,-3,0,5,-1,-5,0,5,0,-6,-1,5,1,-5,0,5,0,-5,2,7,4,-8,0,9,3,-9,0,7,0,-5,0,6,0,-4,0,3,0,-5,0,5,0,-3,0,5,0,-5,0,5,0,-5,0,5,1,-5,0,4,1,-4,0,5,0,-4,1,5,0,-3]}}),define("output/audio",["output/wavetable-5"],function(e){var t=440;return{init:function(n){if(window.AudioContext){for(var i=[],r=0;128>r;++r)i[r]=Math.pow(2,(r-69)/12)*t;var o=new AudioContext,a=o.createPeriodicWave(new Float32Array(e.real.map(e.uncompress)),new Float32Array(e.imag.map(e.uncompress))),l=function(){var e=function(e,t){var n=o.createOscillator();n.type=4,n.setPeriodicWave(a),n.frequency.value=i[e];var r=o.createGain();n.connect(r),r.connect(o.destination),n.start(o.currentTime),r.gain.setValueAtTime(1,o.currentTime),r.gain.linearRampToValueAtTime(0,o.currentTime+t/1e3),n.stop(o.currentTime+t/1e3)},t=function(e){var t=o.createOscillator();t.type=4,t.setPeriodicWave(a),t.frequency.value=i[e];var n=o.createGain();return t.connect(n),n.connect(o.destination),t.start(o.currentTime),n.gain.setValueAtTime(1,o.currentTime),{stop:function(){n.gain.linearRampToValueAtTime(0,o.currentTime+.3),t.stop(o.currentTime+.3)}}};return{playNote:e,startNote:t}},u={getChannel:l};n(u)}}}}),define("views/menu",["data/colours","data/dimensions","data/levels","data/progress","views/util","views/game","models/game","input/keyboard","input/tutorial","output/sound","output/audio"],function(e,t,n,i,r,o,a,l,u,c,d){return{init:function(s){d.init(function(d){var f=document.createElement("div");f.style.width=t.WIDTH+"px",f.style.height=t.HEIGHT+"px",f.setAttribute("id","menu");var m=document.createElement("h1");m.appendChild(document.createTextNode("Menu")),f.appendChild(m),n.forEach(function(n,s){n.id=s;var m=document.createElement("a");m.classList.add("level"),m.style.display="block",m.style.height=.4*t.HEIGHT+"px";var p=function(e){e.preventDefault(),f.style.display="none";var t=0===s?u:l;o.init(f.parentNode,a.init(n,t.init(),c.init(d)))},h=document.createElement("h2"),v=[h],E=i.getTime(s);if(E){h.appendChild(document.createTextNode(n.name)),m.style.borderColor=e.NOTES[1+s%7];var R=document.createElement("h3");R.innerHTML="&#8987; "+r.formatTime(E),v.push(R);var g=document.createElement("h4");v.push(g);for(var T="",A=0;A<n.par.length;++A)T+=E<n.par[A]?"&#9733;":"&#9734;";g.innerHTML=T,m.onclick=p}else if(2>s||i.getTime(s-1)||i.getTime(s-2)){h.appendChild(document.createTextNode(n.name));var I=document.createElement("h3");I.appendChild(document.createTextNode("Click to start")),v.push(I),m.onclick=p}else m.classList.add("locked"),h.appendChild(document.createTextNode("?"));v.forEach(function(e){m.appendChild(e)}),f.appendChild(m)}),s(f)})}}}),require(["data/dimensions","views/menu"],function(e,t){var n=document.getElementById("game");n.style.width=e.WIDTH+"px",n.style.height=e.HEIGHT+"px",n.style.fontSize=e.PERCENT+"%",n.style.marginTop=(window.innerHeight-e.HEIGHT)/4+"px",t.init(function(e){document.getElementById("warning").remove(),n.appendChild(e)})}),define("main",function(){});