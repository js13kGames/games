<!doctype html><meta content="width=device-width,user-scalable=0,user-scalable=no,minimum-scale=1,maximum-scale=1" name=viewport><style>#c,body,html{margin:0;padding:0;border:0;position:absolute}body,html{width:100%;height:100%;background-color:#000;overscroll-behavior:none}@media (min-aspect-ratio:9/16){#c{max-height:100%}}@media (max-aspect-ratio:9/16){#c{max-width:100%}}</style><title>13 Curses</title><canvas height=1920 id=c width=1080></canvas><script>"use strict";let zzfxV=.3,zzfxX=new AudioContext,zzfx=(e=1,t=.05,f=220,z=0,a=0,n=.1,r=0,o=1,s=0,x=0,c=0,u=0,i=0,d=0,X=0,b=0,l=0,m=1,h=0,B=0,C=0)=>{let V=Math,g=2*V.PI,w=44100,A=s*=500*g/w/w,D=f*=(1-t+2*t*V.random(t=[]))*g/w,I=0,M=0,P=0,S=1,j=0,k=0,p=0,q=C<0?-1:1,v=g*q*C*2/w,y=V.cos(v),E=V.sin,F=E(v)/4,G=1+F,H=-2*y/G,J=(1-F)/G,K=(1+q*y)/2/G,L=-(q+y)/G,N=K,O=0,Q=0,R=0,T=0;for(x*=500*g/w**3,X*=g/w,c*=g/w,u*=w,i=w*i|0,e*=zzfxV,q=(z=w*z+9)+(h*=w)+(a*=w)+(n*=w)+(l*=w)|0;P<q;t[P++]=p*e)++k%(100*b|0)||(p=r?1<r?2<r?3<r?E(I**3):V.max(V.min(V.tan(I),1),-1):1-(2*I/g%2+2)%2:1-4*V.abs(V.round(I/g)-I/g):E(I),p=(i?1-B+B*E(g*P/i):1)*(p<0?-1:1)*V.abs(p)**o*(P<z?P/z:P<z+h?1-(P-z)/h*(1-m):P<z+h+a?m:P<q-l?(q-P-l)/n*m:0),p=l?p/2+(l>P?0:(P<q-l?1:(q-P)/l)*t[P-l|0]/2/e):p,C&&(p=T=N*O+L*(O=Q)+K*(Q=p)-J*R-H*(R=T))),v=(f+=s+=x)*V.cos(X*M++),I+=v+v*d*E(P**5),S&&++S>u&&(f+=c,D+=c,S=0),!i||++j%i||(f=D,s=A,S=S||1);(e=zzfxX.createBuffer(1,q,w)).getChannelData(0).set(t),(f=zzfxX.createBufferSource()).buffer=e,f.connect(zzfxX.destination),f.start()}</script><script>!function(t){"use strict";var e=function(){return b.__string_rec(this,"")},n=n||{};function s(t,e){var n,s=Object.create(t);for(n in e)s[n]=e[n];return e.toString!==Object.prototype.toString&&(s.toString=e.toString),s}function i(){this.alive=!0}function r(){this.backgroundStyle="#094"}function a(){}function h(){this.dead=[],this.alive=[]}function o(){this.focusCard=null,this.gameOverSprites=[],this.effectManager=new h,this.selectedHandIndex=-1,this.shopButtons=[],this.handButtons=[],this.dice=new C(1080,760),this.coin=new k(1500,750,!0),this.shop=[],this.aiHand=[],this.playerHand=[],this.playerTurn=-1,this.roundTurn=0,this.round=0,this.phaseStep=0,this.board=new g,r.call(this),this.phaseFunc=j(this,this.gameStartPhase),this.flipButton=new P("Flip",100,0,1248,-1,120),this.flipButton.x=540-this.flipButton.w/2,this.flipButton.gesture=1,this.rollButton=new P("Roll",100,0,1248,-1,120),this.rollButton.x=540-this.flipButton.w/2,this.rollButton.gesture=1,this.endTurnButton=new P("End Turn",40,0,970,-1,130),this.endTurnButton.x=972-this.endTurnButton.w/2,this.handButtons.push(new H(20,1520,this.playerHand,0)),this.handButtons.push(new H(236,1520,this.playerHand,1)),this.handButtons.push(new H(452,1520,this.playerHand,2)),this.handButtons.push(new H(668,1520,this.playerHand,3)),this.handButtons.push(new H(884,1520,this.playerHand,4));var t=new H(232.5,820,this.shop,0);this.shopButtons.push(t),t=new H(437.5,820,this.shop,1),this.shopButtons.push(t),t=new H(642.5,820,this.shop,2),this.shopButtons.push(t),this.backButton=new P("Back",40,0,1152,-1,130),this.backButton.x=135-this.backButton.w/2,this.playButton=new P("Play",40,0,1152,-1,130),this.playButton.x=1080-(135-this.playButton.w/2)-this.playButton.w,this.playButton.gesture=1,this.buyButton=new P("Buy",40,0,1152,-1,130),this.buyButton.x=1080-(135-this.playButton.w/2)-this.playButton.w,this.buyButton.gesture=2,this.endGameButton=new P("Restart",100,0,1248,-1,120),this.endGameButton.x=540-this.endGameButton.w/2}r.__name__=i.__name__=!0,r.prototype={update:function(t){u.c.fillStyle=this.backgroundStyle,u.c.fillRect(0,0,1080,1920)}},a.__name__=!0,a.init=function(){var t;null==a.d&&((t=window.document.createElement("canvas")).width=1e3,t.height=1e3,a.d=t.getContext("2d",null))},a.get=function(t){return a.repo.get(t)},a.createImage=function(t){a.init(),a.d.clearRect(0,0,540,840),a.d.lineWidth=9,a.d.strokeStyle="#000",a.d.fillStyle="#"+m.COLOUR[t.effects[0]],I.roundRect(a.d,5,5,530,830,30,!0),a.d.fillStyle="#fff",I.roundRect(a.d,40,40,460,760,15,!0,!1),a.renderFace(m.FACE[t.effects[0]][t.effects.length-1]),a.d.lineWidth=6,a.d.strokeStyle="#000",a.d.fillStyle="#fff",I.roundRect(a.d,4,4,162,162,15,!0),a.d.font="100px sans-serif",a.d.fillStyle="#000",I.centeredText(a.d,null==t.cost?"null":""+t.cost,4,162,113.39999999999999,!0),a.d.lineWidth=6,a.d.strokeStyle="#999",a.d.beginPath(),a.d.moveTo(40,570),a.d.lineTo(500,570),a.d.stroke(),a.d.font="45px sans-serif",a.d.fillStyle="#000";for(var e=650,n=0,s=a.getDescription(t.effects[0],t.effects.length).split("_");n<s.length;){var i=s[n];++n,I.centeredText(a.d,i,0,540,e,!0),e+=45}a.d.font="20px sans-serif",a.d.fillStyle="#999";var r=a.d.measureText(t.getSerial()).width;return a.d.fillText(t.getSerial(),495-r,795),r=a.d.getImageData(0,0,540,840),window.createImageBitmap(r).then((function(e){return a.repo.set(t.getSerial(),e),e}))},a.getDescription=function(t,e){var n=1<e?"s":"";switch(t){case 0:return"Add "+e+" Curse"+n+" to_your opponent";case 1:return"Add "+e+" Curse"+n+" to_yourself";case 2:return"Remove "+e+" Curse"+n+"_from your opponent";case 3:return"Remove "+e+" Curse"+n+"_from yourself";case 4:return"Take "+e+" Curse"+n+" from_your opponent to_yourself";case 5:return"Give "+e+" of your_Curses to your_opponent";case 6:return"Gain "+4*e+" Points";case 7:return"Remove "+8*e+" Points_from your opponent";default:return""}},a.createBack=function(){a.init(),a.d.clearRect(0,0,540,840),a.d.lineWidth=9,a.d.strokeStyle="#000",a.d.fillStyle="#888",I.roundRect(a.d,5,5,530,830,30,!0),a.d.fillStyle="#bbb",I.roundRect(a.d,40,40,460,760,15,!0,!1),a.d.font="100px sans-serif",a.d.fillStyle="#555",I.centeredText(a.d,"13",0,540,390,!0),I.centeredText(a.d,"Curses",0,540,520,!0);for(var t=0;t<13;){var e=t++,n=2*Math.PI/13*e;e=270+216*Math.cos(n),n=420+216*Math.sin(n);a.d.fillStyle="#85a",a.d.beginPath(),a.d.ellipse(e,n,20,20,0,0,2*Math.PI),a.d.fill()}var s=a.d.getImageData(0,0,540,840);return window.createImageBitmap(s).then((function(t){return a.repo.set("",t),t}))},a.renderFace=function(t){if(null!=t)for(var e=0,n=t.split("|");e<n.length;){var s=n[e];switch(++e,s.charAt(0)){case"p":a.renderPathFace(c.substr(s,1,null));break;case"s":a.renderStringFace(c.substr(s,1,null))}}},a.renderStringFace=function(t){var e=c.substr(t,0,3),n=p.parseInt(c.substr(t,3,1))/10*460,s=40+p.parseInt(c.substr(t,4,1))/10*460,i=110+p.parseInt(c.substr(t,5,1))/10*460;t=c.substr(t,6,null);a.d.font=n+"px sans-serif",a.d.fillStyle="#"+e,e=a.d.measureText(t).width,a.d.fillText(t,s-e/2,i+n/2)},a.renderPathFace=function(t){for(var e=c.substr(t,0,3),n=p.parseInt(c.substr(t,3,1))/10*460/2,s=c.substr(t,4,null).split(""),i=p.parseInt,r=new Array(s.length),h=0,o=s.length;h<o;)r[u=h++]=i(s[u]);var u;for(s=r,i=a.facePosX,r=new Array(s.length),h=0,o=s.length;h<o;)r[u=h++]=i(s[u]);var l=r;for(a.d.lineWidth=n,a.d.strokeStyle="#"+e,a.d.beginPath(),a.d.moveTo(l.shift(),l.shift()+70),h=0,o=Math.floor(l.length/2);h<o;)h++,a.d.lineTo(l.shift(),l.shift()+70);a.d.stroke()},a.facePosX=function(t){return 40+t/10*460},a.createCoinImages=function(){var t=[];a.d.font="350px sans-serif",a.d.clearRect(0,0,540,840),a.d.lineWidth=3,a.d.strokeStyle="#000",a.d.fillStyle="#fc0",a.d.beginPath(),a.d.ellipse(210,210,207,207,0,0,2*Math.PI),a.d.fill(),a.d.stroke(),a.d.fillStyle="#880",I.centeredText(a.d,"▼",0,420,357);var e=a.d.getImageData(0,0,420,420);return t.push(window.createImageBitmap(e).then((function(t){return a.repo.set("a",t),t}))),a.d.clearRect(0,0,540,840),a.d.lineWidth=3,a.d.strokeStyle="#000",a.d.fillStyle="#fc0",a.d.beginPath(),a.d.ellipse(210,210,207,207,0,0,2*Math.PI),a.d.fill(),a.d.stroke(),a.d.fillStyle="#880",I.centeredText(a.d,"▲",0,420,308),e=a.d.getImageData(0,0,420,420),t.push(window.createImageBitmap(e).then((function(t){return a.repo.set("b",t),t}))),Promise.all(t)},h.__name__=!0,h.prototype={update:function(t){this.dead=this.alive.slice(),this.alive=[];for(var e=0,n=this.dead;e<n.length;){var s=n[e];++e,s.update(t),s.alive&&this.alive.push(s)}},add:function(t){this.alive.push(t)},hasAlive:function(){return 0<this.alive.length},count:function(){return this.alive.length}},o.__name__=!0,o.__super__=r,o.prototype=s(r.prototype,{update:function(t){r.prototype.update.call(this,t),u.c.strokeStyle="#ccc",u.c.fillStyle="#094",u.c.lineWidth=8,u.c.beginPath(),u.c.moveTo(0,960),u.c.lineTo(1080,960),u.c.stroke(),u.c.lineWidth=4,I.roundRect(u.c,232.5,820,180,280,5,!0,!0),I.roundRect(u.c,437.5,820,180,280,5,!0,!0),I.roundRect(u.c,642.5,820,180,280,5,!0,!0),u.c.fillStyle="#000",u.c.font="40px sans-serif",I.centeredText(u.c,"Round "+this.round,0,232.5,900),u.c.font="100px sans-serif",I.centeredText(u.c,p.string(this.board.players[0].points),0,232.5,1060),u.c.font="100px sans-serif",I.centeredText(u.c,p.string(this.board.players[1].points),835,232.5,930);for(var e=0,n=this.shop;e<n.length;){var s=n[e];++e,null!=s&&s!=this.focusCard&&s.update(t)}for(e=0,n=this.playerHand;e<n.length;)s=n[e],++e,s!=this.focusCard&&s.update(t);for(e=0,n=this.aiHand;e<n.length;)s=n[e],++e,s!=this.focusCard&&s.update(t);for(u.c.strokeStyle="#000",u.c.fillStyle="#fff",u.c.lineWidth=3,e=0;e<16;){var i=e++;u.c.fillStyle=i<this.board.players[1].curses?"#f0f":"#094",u.c.beginPath(),u.c.ellipse(67.5*i+3+30.75,43.75,30.75,30.75,0,0,2*Math.PI),u.c.stroke(),u.c.fill(),u.c.fillStyle=i<this.board.players[0].curses?"#f0f":"#094",u.c.beginPath(),u.c.ellipse(67.5*i+3+30.75,1876.25,30.75,30.75,0,0,2*Math.PI),u.c.stroke(),u.c.fill(),u.c.fillStyle="#fff";var a=46.125;u.c.font=a+"px sans-serif";var h=S.getPointsMultiplier(1+i);12==i?(u.c.font=a+"px sans-serif",I.centeredText(u.c,"☠",67.5*i,67.5,58.425),I.centeredText(u.c,"☠",67.5*i,67.5,1889.25)):1<h&&(u.c.font="36.9px sans-serif",I.centeredText(u.c,h+"X",67.5*i,67.5,58.425),I.centeredText(u.c,h+"X",67.5*i,67.5,1889.25))}this.phaseFunc(t);var o=this.focusCard;for(null!=o&&o.update(t),this.effectManager.update(t),e=0,n=this.gameOverSprites;e<n.length;){var c=n[e];++e,c.update(t)}},setPhase:function(t){this.phaseFunc=null==t?function(t){}:t,this.phaseStep=0,this.focusCard=null},gameStartPhase:function(t){var e=this;this.setPhase();for(var n=null,s=0;s<6;){var i=s++,r=i%2,a=this.board.drawCard();this.board.players[r].cards.push(a),a=[new B(a,1080,820)],(1==r?this.aiHand:this.playerHand).push(a[0]),i=[216*Math.floor(i/2)+20],r=[1==r?120:1520],n=null==n?(d.slide(),Y.start(a[0],{x:i[0],y:r[0]},.3)):n.then(function(t,e,n){return function(s){return d.slide(),Y.start(n[0],{x:e[0],y:t[0]},.3)}}(r,i,a))}n=n.then((function(t){return A.sec(.5)}));s=0;for(var h=this.playerHand;s<h.length;){var o=[h[s]];++s,n=n.then(function(t){return function(e){return t[0].flip()}}(o))}n.then((function(t){return A.sec(.5)})).then((function(t){e.setPhase(j(e,e.startRoundPhase))}))},startRoundPhase:function(t){var e=this;this.setPhase(),this.round++,this.board.resetShop();for(var n=Promise.resolve(null),s=0,i=this.shop;s<i.length;){var r=[i[s]];++s,null!=r[0]&&(n=n.then(function(t){return function(e){return d.slide(),Y.start(t[0],{x:-t[0].w},.5)}}(r)))}n=n.then((function(t){return e.shop.length=0,Promise.resolve(e.shop)}));var a=0;for(s=0,i=this.board.shop;s<i.length;){var h=i[s];++s;var o=[new B(h,1080,820)];h=[232.5+205*a];++a,n=n.then(function(t,n){return function(s){return e.shop.push(n[0]),n[0].flip(),Y.start(n[0],{x:t[0]},.3)}}(h,o))}n.then((function(t){return A.sec(.5)})).then((function(t){e.nextRound()}))},chooseLeaderPhase:function(t){var e=this;this.coin.update(t),0==this.phaseStep&&(this.phaseStep=-1,Y.start(this.coin,{x:540-this.coin.w/2},.5).then((function(t){return e.phaseStep=1}))),1==this.phaseStep&&(this.flipButton.update(),this.flipButton.clicked&&(this.phaseStep=2,this.coin.flip().then((function(t){return e.playerTurn=t?0:1})).then((function(t){return A.sec(.5)})).then((function(t){return Y.start(e.coin,{x:1080+e.coin.w},.5)})).then((function(t){e.setPhase(j(e,e.startTurnPhase))}))))},startTurnPhase:function(t){var e=this;this.dice.update(t),0==this.phaseStep&&(this.phaseStep=-1,Y.start(this.dice,{x:540-this.dice.w/2},.5).then((function(t){return e.phaseStep=1==e.playerTurn?2:1}))),1==this.phaseStep&&(this.rollButton.update(),this.rollButton.clicked&&(this.phaseStep=2)),2==this.phaseStep&&(this.phaseStep=3,this.dice.roll().then((function(t){return e.board.players[e.playerTurn].addPoints(t),A.sec(.5)})).then((function(t){return Y.start(e.dice,{x:1080},.5)})).then((function(t){e.setPhase(j(e,e.mainTurnPhase))})))},mainTurnPhase:function(t){1==this.playerTurn?this.aiTurnPhase(t):this.playerTurnPhase(t)},aiTurnPhase:function(t){for(var e=this,n=Promise.resolve(),s=x.getActions(this.board),i=0;i<s.length;){var r=[s[i]];switch(++i,r[0].type._hx_index){case 0:n=n.then(function(t){return function(n){var s=e.shop[t[0].index];return e.board.players[1].points-=s.card.cost,d.slide(),Y.start(s,{x:216*e.board.players[1].cards.length+20,y:120},.5)}}(r)).then(function(t){return function(n){var s=e.shop[t[0].index];return e.board.shop[t[0].index]=null,e.shop[t[0].index]=null,e.board.players[1].cards.push(s.card),e.aiHand.push(s),s.flip()}}(r));break;case 1:n=n.then(function(t){return function(n){return e.selectedHandIndex=t[0].index,Promise.resolve(t[0].index)}}(r)).then((function(t){return e.aiHand[e.selectedHandIndex].flip().then((function(t){return e.focusCard=e.aiHand[e.selectedHandIndex],d.slide(),Y.start(e.aiHand[e.selectedHandIndex],{scaleX:3,scaleY:3,x:450,y:540},.2)}))})).then((function(t){return A.sec(.5)})).then((function(t){var n=e.aiHand[e.selectedHandIndex];return Y.start(n,{scaleX:0,scaleY:0,y:960},.5)})).then((function(t){var n=e.aiHand[e.selectedHandIndex];return e.playCard(1,n)}));break;case 2:n.then((function(t){e.board.gameOver()?e.setPhase(j(e,e.gameEndPhase)):e.nextTurn()}))}}this.setPhase()},playerTurnPhase:function(t){var e,n,s,i=this;if(0==this.phaseStep){this.endTurnButton.update(),this.endTurnButton.clicked&&this.nextTurn();for(var r=0,a=this.handButtons;r<a.length;){var h=a[r];if(++r,h.cardIndex>=this.playerHand.length)break;h.update(t),h.clicked&&(this.phaseStep=-1,this.selectedHandIndex=h.cardIndex,this.playButton.enabled=this.playerHand[this.selectedHandIndex].card.canPlay(this.board.players[0],this.board.players[1]),this.focusCard=this.playerHand[this.selectedHandIndex],d.slide(),Y.start(this.playerHand[this.selectedHandIndex],{scaleX:3,scaleY:3,x:450,y:540},.2).then((function(t){return i.phaseStep=1})))}for(r=0,a=this.shopButtons;r<a.length;){var o=a[r];++r,null!=this.shop[o.cardIndex]&&(o.update(t),o.clicked&&(this.phaseStep=-1,this.selectedHandIndex=o.cardIndex,this.buyButton.enabled=this.shop[this.selectedHandIndex].card.cost<=this.board.players[0].points&&this.board.players[0].cards.length<5,this.focusCard=this.shop[this.selectedHandIndex],d.slide(),Y.start(this.shop[this.selectedHandIndex],{scaleX:3,scaleY:3,x:450,y:540},.2).then((function(t){return i.phaseStep=2}))))}}1==this.phaseStep&&(this.playButton.update(),this.backButton.gesture=2,this.backButton.update(),this.backButton.clicked&&(this.phaseStep=-1,d.slide(),Y.start(this.playerHand[this.selectedHandIndex],{scaleX:1,scaleY:1,x:216*this.selectedHandIndex+20,y:1520},.2).then((function(t){return i.phaseStep=0,i.focusCard=null}))),this.playButton.clicked&&(this.phaseStep=-1,e=this.playerHand[this.selectedHandIndex],Y.start(e,{scaleX:0,scaleY:0,y:960},.5).then((function(t){return i.playCard(0,e)})).then((function(t){i.board.gameOver()?i.setPhase(j(i,i.gameEndPhase)):i.phaseStep=0})))),2==this.phaseStep&&(this.buyButton.update(),this.backButton.gesture=1,this.backButton.update(),this.backButton.clicked&&(this.phaseStep=-1,d.slide(),Y.start(this.shop[this.selectedHandIndex],{scaleX:1,scaleY:1,x:232.5+205*this.selectedHandIndex,y:820},.2).then((function(t){return i.phaseStep=0}))),this.buyButton.clicked&&(this.phaseStep=-1,this.board.players[0].points-=this.shop[this.selectedHandIndex].card.cost,n=this.shop[this.selectedHandIndex],s=this.playerHand.length,d.slide(),Y.start(n,{scaleX:1,scaleY:1,x:216*s+20,y:1520},.5).then((function(t){return i.board.shop[i.selectedHandIndex]=null,i.shop[i.selectedHandIndex]=null,i.board.players[0].cards.push(n.card),i.playerHand.push(n),i.phaseStep=0}))))},playCard:function(t,e){for(var n=this,s=Promise.resolve(),i=0,r=0,a=e.card.effects;r<a.length;){var h=a[r];++r,h=[this.createCardEffect(h,t,i)],++i,s=s.then(function(t){return function(e){return n.effectManager.add(t[0]),t[0].play()}}(h))}return s.then((function(s){var i=1==t?n.aiHand:n.playerHand;c.remove(i,e),c.remove(n.board.players[t].cards,e.card);for(var r=Promise.resolve(),a=0;a<i.length;){var h=[i[a]];++a,r=r.then(function(e){return function(s){var i=n.board.players[t].cards.indexOf(e[0].card);return Y.start(e[0],{x:216*i+20},.2)}}(h))}return r}))},createCardEffect:function(t,e,n){var s=m.FUNC[t];switch(t){case 0:return new O(e,this.board,s,!1,n);case 1:return new O(e,this.board,s,!0,n);case 2:return new U(e,this.board,s,!1,n);case 3:return new U(e,this.board,s,!0,n);case 4:return new L(e,this.board,s,!0,n);case 5:return new L(e,this.board,s,!1,n);case 6:return new z(e,this.board,s);case 7:return new G(e,this.board,s);default:return null}},nextTurn:function(){this.roundTurn++,this.roundTurn<2?(this.playerTurn=0==this.playerTurn?1:0,this.setPhase(j(this,this.startTurnPhase))):this.setPhase(j(this,this.startRoundPhase))},nextRound:function(){this.roundTurn=0,this.playerTurn=this.board.getTurnLeader(),-1==this.playerTurn?this.setPhase(j(this,this.chooseLeaderPhase)):this.setPhase(j(this,this.startTurnPhase))},gameEndPhase:function(t){var e,n,s,i=this;0==this.phaseStep&&(this.phaseStep=-1,e=this.board.getWinner(),n=new R(813,0==e?43.75:1876.25,"☠",46.125,"#fff"),this.gameOverSprites.push(n),s=new R(1080,860,0==e?"You Win!":"You Lose!",150,"#000"),this.gameOverSprites.push(s),Y.start(n,{scaleX:3,scaleY:3,a:0,x:813-.8*n.w},1).then((function(t){return Y.start(s,{x:540-s.w/2},.5)})).then((function(t){return i.phaseStep=1}))),1==this.phaseStep&&(this.endGameButton.update(t),this.endGameButton.clicked&&(this.phaseStep=-1,u.cs=new l))}});var c=function(){};c.__name__=!0,c.substr=function(t,e,n){if(null==n)n=t.length;else if(n<0){if(0!=e)return"";n=t.length+n}return t.substr(e,n)},c.remove=function(t,e){return-1!=(e=t.indexOf(e))&&(t.splice(e,1),!0)},c.now=function(){return Date.now()};var u=function(){};u.__name__=!0,u.main=function(){u.ca=window.document.getElementById("c"),u.c=u.ca.getContext("2d",null),window.onresize=u.onResize,u.onResize(),u.cs=new l,E.i(),window.requestAnimationFrame(u.update)},u.update=function(t){var e=t-u.l;u.tm.update(e/1e3);var n=u.cs;null!=n&&n.update(e/1e3),u.l=t,E.u(),window.requestAnimationFrame(u.update)},u.onResize=function(){var t=window.innerWidth,e=window.innerHeight;u.ca.style.top=(e-u.ca.clientHeight)/2+"px",u.ca.style.left=(t-u.ca.clientWidth)/2+"px"};var l=function(){if(r.call(this),this.playButton=new P("Play",100,0,960,0,140),this.playButton.x=540-this.playButton.w/2,this.playButton.onClick=function(){u.cs=new o},!l.loaded){for(var t=0,e=m.DECK.length;t<e;)for(var n=t++,s=0,i=m.DECK[n].length;s<i;){for(var h=s++,c=l.cardLoadQueue,f=[],d=0,p=1+h;d<p;)d++,f.push(n);c.push(new v(f))}a.createBack().then((function(t){return l.loadNext=!0}))}};function f(){}l.__name__=!0,l.__super__=r,l.prototype=s(r.prototype,{update:function(t){r.prototype.update.call(this,t),u.c.fillStyle="#000",u.c.font="100px sans-serif",I.centeredText(u.c,u.TITLE,0,1080,480),l.loaded?this.playButton.update():l.loadNext&&(l.loadNext=!1,u.c.font="70px sans-serif",I.centeredText(u.c,"Loading...",0,1080,960),null!=(t=l.cardLoadQueue.pop())?a.createImage(t).then((function(t){return l.loadNext=!0})):a.createCoinImages().then((function(t){return l.loaded=!0})))}}),Math.__name__=!0,f.__name__=!0,f.getProperty=function(t,e){var n;return null==t?null:!!t.__properties__&&(n=t.__properties__["get_"+e])?t[n]():t[e]},f.setProperty=function(t,e,n){var s;!!t.__properties__&&(s=t.__properties__["set_"+e])?t[s](n):t[e]=n},f.fields=function(t){var e=[];if(null!=t){var n,s=Object.prototype.hasOwnProperty;for(n in t)"__id__"!=n&&"hx__closures__"!=n&&s.call(t,n)&&e.push(n)}return e};var d=function(){};d.__name__=!0,d.flip=function(){zzfx(.5,.1,196,.1,0,.1,4,1.5,0,0,50,0,0,0,0,0,.05,1,0,0,0)},d.slide=function(){zzfx(.1,.1,196,.25,0,.1,4,1.5,0,0,50,0,0,0,0,0,0,1,0,0,0)},d.button=function(){zzfx(.8,.05,419,0,.01,.008,0,3,2,56,0,0,0,.8,0,0,0,.54,0,.04,-1040)},d.curse=function(){zzfx(1,1,123.4708,.15,0,.1,1,1,0,100,300,.06,.07,0,20,.1,.08,.51,.11,.35,0)},d.uncurse=function(){zzfx(.6,.2,140,.1,.07,.2,1,1,-1,85,290,0,.1,.4,0,.1,0,.5,.08,0,0)},d.gainCoin=function(){zzfx(.3,.1,450,.01,.07,.12,1,2.4,0,1,280,.05,0,0,0,0,0,.7,.04,0,152)},d.loseCoin=function(){zzfx(.4,.5,350,0,.2,.3,2,.5,1,0,0,0,.03,1.9,0,0,0,1,0,.48,-2500)},d.roll=function(){zzfx(.5,1,82.40689,.02,.02,.03,0,.6,0,16,-191,.15,0,0,42,0,0,.74,.02,.06,-657)},d.coinFlip=function(){zzfx(.5,2,70,.1,.05,.1,0,1.6,7,27,0,0,0,.9,0,0,0,.7,.02,0,-856)};var p=function(){};function _(){}p.__name__=!0,p.string=function(t){return b.__string_rec(t,"")},p.parseInt=function(t){return t=parseInt(t),isNaN(t)?null:t},_.__name__=!0,_.lpad=function(t,e,n){if(e.length<=0)return t;var s="";for(n-=t.length;s.length<n;)s+=null==e?"null":""+e;return s+(null==t?"null":""+t)};var y=n["game.ActionType"]={__ename__:!0,__constructs__:null,BUY:{_hx_name:"BUY",_hx_index:0,__enum__:"game.ActionType",toString:e},PLAY:{_hx_name:"PLAY",_hx_index:1,__enum__:"game.ActionType",toString:e},END:{_hx_name:"END",_hx_index:2,__enum__:"game.ActionType",toString:e}};y.__constructs__=[y.BUY,y.PLAY,y.END];var x=function(){};x.__name__=!0,x.getActions=function(t){for(var e=t.players[0].copy(),n=t.players[1].copy(),s=[],i=0,r=t.shop;i<r.length;){var a=r[i];++i,null!=a&&x.shouldBuy(a,n,e)&&(s.push({type:y.BUY,index:t.shop.indexOf(a)}),n.cards.push(a),n.points-=a.cost)}var h=x.getStateScore(n,e),o=null;for(i=0,r=n.cards;i<r.length;){var c=r[i];++i;var u=x.getPlayScore(c,n,e);h<u&&(h=u,o=c)}return null!=o&&s.push({type:y.PLAY,index:n.cards.indexOf(o)}),s.push({type:y.END,index:-1}),s},x.shouldBuy=function(t,e,n){if(t.cost>e.points||4<e.cards.length)return!1;for(var s=0,i=0,r=0,a=e.cards;r<a.length;){var h=a[r];++r,x.isOffensive(h)?++i:++s}return t=x.isOffensive(t),!!(i<3&&t)||s<2&&!t},x.isOffensive=function(t){switch(t.effects[0]){case 0:case 5:case 6:case 7:return!0;default:return!1}},x.getPlayScore=function(t,e,n){for(var s=e.copy(),i=n.copy(),r=0,a=t.effects;r<a.length;){var h=a[r];++r,m.FUNC[h](s,i)}return x.getStateScore(s,i)},x.getStateScore=function(t,e){if(13==t.curses||!t.validState()||!e.validState())return-1e4;if(13==e.curses)return 1e4;var n=t.points-e.points;return t.curses<13?n+=13-t.curses:n+=6*(t.curses-13),e.curses<13?n+=e.curses:n-=6*(e.curses-13),n};var g=function(){this.players=[new S,new S],this.shop=[]};g.__name__=!0,g.prototype={getTurnLeader:function(){var t=this.players[0].curses-this.players[1].curses;return 0==t?-1:0<t?0:1},drawCard:function(){return w.getRandomCard()},resetShop:function(){this.shop=[],this.shop.push(this.drawCard()),this.shop.push(this.drawCard()),this.shop.push(this.drawCard())},gameOver:function(){return 13==this.players[0].curses||13==this.players[1].curses},getWinner:function(){return 13==this.players[0].curses?1:13==this.players[1].curses?0:-1}};var v=function(t){this.cost=0,this.effects=t;for(var e=0;e<t.length;){var n=t[e];++e,this.cost+=m.COST[n]}};v.__name__=!0,v.prototype={canPlay:function(t,e){for(var n=t.copy(),s=e.copy(),i=0,r=this.effects;i<r.length;){var a=r[i];++i,m.FUNC[a](n,s)}return!!n.validState()&&s.validState()},getSerial:function(){return _.lpad(p.string(this.effects[0]),"0",2)+"-x"+p.string(this.effects.length)}};var m=function(){};m.__name__=!0;var w=function(){};w.__name__=!0,w.getRandomCard=function(){for(var t=m.DECK,e=Math.floor(267*Math.random()),n=0,s=t.length;n<s;)for(var i=n++,r=0,a=t[i].length;r<a;){var h=r++;if((e-=t[i][h])<=0){for(var o=[],c=0,u=1+h;c<u;)c++,o.push(i);return new v(o)}}return new v([0])};var S=function(){this.points=3,this.cards=[],this.curses=0};S.__name__=!0,S.getPointsMultiplier=function(t){return 13<t?4:9<t?3:6<t?2:1},S.prototype={copy:function(){var t=new S;return t.curses=this.curses,t.cards=this.cards.slice(),t.points=this.points,t},validState:function(){return 0<=this.curses&&this.curses<=16&&0<=this.points&&this.cards.length<=5},addPoints:function(t){this.points+=t*S.getPointsMultiplier(this.curses)}},(e=function(t){this.current=0,this.array=t}).__name__=!0,e.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]}};var b=function(){};function T(t,e,n,s){this.clickSound=d.button,this.gesture=-1,this.enabled=!0,this.clicked=!1,this.x=t,this.y=e,this.w=n,this.h=s}b.__name__=!0,b.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var s=typeof t;switch(s="function"==s&&(t.__name__||t.__ename__)?"object":s){case"function":return"<function>";case"object":if(t.__enum__){var i=n[t.__enum__].__constructs__[t._hx_index],r=i._hx_name;return i.__params__?(e+="\t",r+"("+function(){for(var n=[],s=0,r=i.__params__;s<r.length;){var a=r[s];s+=1,n.push(b.__string_rec(t[a],e))}return n}().join(",")+")"):r}if(t instanceof Array){var a="[";e+="\t";for(var h=0,o=t.length;h<o;){var c=h++;a+=(0<c?",":"")+b.__string_rec(t[c],e)}return a+"]"}try{u=t.toString}catch(h){return"???"}if(null!=u&&u!=Object.toString&&"function"==typeof u){var u=t.toString();if("[object Object]"!=u)return u}a="{\n",e+="\t";var l=null!=t.hasOwnProperty,f=null;for(f in t)l&&!t.hasOwnProperty(f)||"prototype"!=f&&"__class__"!=f&&"__super__"!=f&&"__interfaces__"!=f&&"__properties__"!=f&&(2!=a.length&&(a+=", \n"),a+=e+f+" : "+b.__string_rec(t[f],e));return a+"\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},T.__name__=!0,T.prototype={update:function(t){null==t&&(t=0),this.state=0,this.clicked=!1,this.enabled&&!(E.X<this.x||E.Y<this.y||E.X>this.x+this.w||E.Y>this.y+this.h)&&(this.state=E.D?2:1,this.clicked=E.C,this.clicked&&(this.clickSound(),null!=this.onClick&&this.onClick())),this.enabled&&E.GESTURE==this.gesture&&(this.clicked=E.C,this.clickSound(),null!=this.onClick&&this.onClick())}};var P=function(t,e,n,s,i,r){T.call(this,n,s,i,r),u.c.font=e+"px sans-serif",this.textWidth=u.c.measureText(t).width,this.w<=0&&(this.w=this.textWidth+40),this.label=t,this.fontSize=e};function M(t,e,n,s){this.a=1,this.scaleY=1,this.scaleX=1,i.call(this),this.x=t,this.y=e,this.w=n,this.h=s}P.__name__=!0,P.__super__=T,P.prototype=s(T.prototype,{update:function(t){var e;switch(T.prototype.update.call(this,t=null==t?0:t),u.c.lineWidth=3,u.c.strokeStyle="#000",this.state){case 1:e="#0c4";break;case 2:e="#084";break;default:e="#094"}u.c.fillStyle=e,I.roundRect(u.c,this.x,this.y,this.w,this.h,10,!0,!0),u.c.font=this.fontSize+"px sans-serif",u.c.lineWidth=10,u.c.lineJoin="round",u.c.fillStyle="#000",u.c.strokeStyle="#fff",I.centeredText(u.c,this.label,this.x,this.w,this.y+(this.h/2- -.35*this.fontSize)),this.enabled||(u.c.strokeStyle="#000",u.c.moveTo(this.x,this.y+this.h/2),u.c.lineTo(this.x+this.w,this.y+this.h/2),u.c.stroke())}}),M.__name__=!0,M.__super__=i,M.prototype=s(i.prototype,{});var B=function(t,e,n,s){null==s&&(s=!0),this.faceDown=!0,this.imgBack=null,this.imgFront=null,M.call(this,e,n,180,280),this.card=t,this.imgBack=a.get(""),this.imgFront=a.get(t.getSerial())};B.__name__=!0,B.__super__=M,B.prototype=s(M.prototype,{update:function(t){null!=this.imgBack&&null!=this.imgFront&&u.c.drawImage(this.faceDown?this.imgBack:this.imgFront,0,0,this.imgBack.width,this.imgBack.height,this.x+(this.w-this.scaleX*this.w)/2,this.y,this.w*this.scaleX,this.h*this.scaleY)},flip:function(){var t=this;return d.flip(),Y.start(this,{scaleX:0},.2).then((function(e){return t.faceDown=!t.faceDown,Y.start(t,{scaleX:1},.2)}))}});var k=function(t,e,n){this.c=null,this.soundTimer=0,this.flipTime=0,this.flipSpeed=0,this.f=0,M.call(this,t,e,420,420),this.scaleY=n?1:-1,this.face=[a.get("a"),a.get("b")]};k.__name__=!0,k.__super__=M,k.prototype=s(M.prototype,{update:function(t){0<this.flipTime?(this.flipTime-=t,this.f+=this.flipSpeed*t,this.scaleY=Math.cos(this.f),this.soundTimer-=this.flipSpeed*t,this.soundTimer<=0&&(this.soundTimer=Math.PI/2,d.coinFlip())):null!=this.c&&(this.scaleY=0<this.scaleY?1:-1,this.c(0<this.scaleY)),u.c.drawImage(0<this.scaleY?this.face[0]:this.face[1],0,0,this.w,this.h,this.x,this.y+(this.h/2-Math.abs(this.h*this.scaleY)/2),this.w,Math.abs(this.h*this.scaleY))},flip:function(){var t=this;return this.flipSpeed=2*Math.random()*Math.PI+5*Math.PI,this.flipTime=.2*Math.random()+.8,this.soundTimer=Math.PI/2,new Promise((function(e,n){t.c=e}))}});var I=function(){};I.__name__=!0,I.roundRect=function(t,e,n,s,i,r,a,h){null==h&&(h=!0),null==a&&(a=!1),null==r&&(r=5),t.beginPath(),t.moveTo(e+r,n),t.lineTo(e+s-r,n),t.quadraticCurveTo(e+s,n,e+s,n+r),t.lineTo(e+s,n+i-r),t.quadraticCurveTo(e+s,n+i,e+s-r,n+i),t.lineTo(e+r,n+i),t.quadraticCurveTo(e,n+i,e,n+i-r),t.lineTo(e,n+r),t.quadraticCurveTo(e,n,e+r,n),t.closePath(),a&&t.fill(),h&&t.stroke()},I.centeredText=function(t,e,n,s,i,r,a){null==a&&(a=!1),null==r&&(r=!0);var h=t.measureText(e).width;r&&t.fillText(e,n+s/2-h/2,i),a&&t.strokeText(e,n+s/2-h/2,i)},I.circle=function(t,e,n,s,i){u.c.ellipse(e,n,s,null==i?s:i,0,0,2*Math.PI)};var C=function(t,e){this.r=.1,this.f=1,this.c=null,this.t=1,M.call(this,t,e,400,400)};C.__name__=!0,C.__super__=M,C.prototype=s(M.prototype,{update:function(t){null!=this.c&&(this.t-=t,this.r-=t,this.t<0&&(this.c(this.f),this.c=null),this.r<0&&(this.r=.1,(e=Math.ceil(6*Math.random()))!=this.f&&(d.roll(),this.f=e))),u.c.lineWidth=3,u.c.strokeStyle="#000",u.c.fillStyle="#f00",I.roundRect(u.c,this.x,this.y,this.w,this.h,40,!0),u.c.font="300px sans-serif",u.c.fillStyle="#fff";var e=p.string(this.f);I.centeredText(u.c,e,this.x,this.w,this.y+(this.h/2+105))},roll:function(){var t=this;return new Promise((function(e,n){t.c=e,t.t=1}))}});var H=function(t,e,n,s){T.call(this,t,e,180,280),this.hand=n,this.cardIndex=s};H.__name__=!0,H.__super__=T,H.prototype=s(T.prototype,{update:function(t){var e,n,s;null==t&&(t=0),T.prototype.update.call(this),this.cardIndex>=this.hand.length||null!=(e=this.hand[this.cardIndex])&&(s=(n=1==this.state?this.y-50:this.y)-e.y,Math.abs(s)<1?e.y=n:s<0?e.y-=200*t:0<s&&(e.y+=200*t))}});var E=function(){};E.__name__=!0,E.i=function(){u.ca.onmousemove=E.m,window.onmousedown=E.o,window.onmouseup=E.p,window.ontouchstart=E.ots,window.ontouchmove=E.otm,window.ontouchend=E.ote,window.ontouchcancel=E.ote},E.m=function(t){E.X=t.offsetX/u.ca.clientWidth*1080,E.Y=t.offsetY/u.ca.clientHeight*1920},E.o=function(t){E.D=!0},E.p=function(t){E.D=!1,E.C=!0},E.ots=function(t){t.preventDefault();for(var e=0,n=t.changedTouches;e<n.length;){var s=n[e];++e;var i=E.tpx(s),r=E.tpy(s);E.mTouch<0&&(E.mTouch=s.identifier,E.X=i,E.Y=r,E.tsx=i,E.tsy=r,E.D=!0)}},E.otm=function(t){t.preventDefault();for(var e=0,n=t.changedTouches;e<n.length;){var s=n[e];++e;var i=E.tpx(s),r=E.tpy(s);E.mTouch==s.identifier&&(E.X=i,E.Y=r)}},E.ote=function(t){t.preventDefault();for(var e=0,n=t.changedTouches;e<n.length;){var s=n[e];++e,s.identifier==E.mTouch&&(E.C=!0,E.mTouch=-1,E.D=!1,E.GESTURE=E.getGesture(E.tsx,E.tsy,E.tpx(s),E.tpy(s)))}},E.tpx=function(t){return(t.clientX-u.ca.offsetLeft)/u.ca.clientWidth*1080},E.tpy=function(t){return(t.clientY-u.ca.offsetTop)/u.ca.clientHeight*1920},E.getGesture=function(t,e,n,s){return 150<n-t?4:n-t<-150?3:150<s-e?2:s-e<-150?1:0},E.u=function(){E.C=!1,E.GESTURE=0};var R=function(t,e,n,s,i){M.call(this,t,e,0,s),this.text=n,this.size=s,this.fillStyle=i,u.c.font=s+"px sans-serif",this.w=u.c.measureText(n).width};R.__name__=!0,R.__super__=M,R.prototype=s(M.prototype,{update:function(t){u.c.fillStyle=this.fillStyle,u.c.font=this.size*this.scaleY+"px sans-serif",u.c.fillText(this.text,this.x,this.y+this.h)}});var Y=function(t,e,n){this.p=0,i.call(this),this.sc=t,this.props=e,this.cb=n};Y.__name__=!0,Y.start=function(t,e,n){for(var s=1/n,i=[],r=0,a=f.fields(e);r<a.length;){var h=a[r];++r;var o=f.getProperty(t,h),c=f.getProperty(e,h);o!=c&&i.push({tgt:t,name:h,start:o,scale:c-o})}return new Promise((function(t,e){0<i.length?u.tm.add(new Y(s,i,t)):t(null)}))},Y.__super__=i,Y.prototype=s(i.prototype,{update:function(t){this.p+=t*this.sc,1<=this.p&&(this.p=1,this.alive=!1,this.updateProps(1),this.cb(this)),this.updateProps(this.p)},updateProps:function(t){for(var e=0,n=this.props;e<n.length;){var s=n[e];++e;var i=s.start+s.scale*t;f.setProperty(s.tgt,s.name,i)}}});var A=function(t,e){i.call(this),this.s=t,this.c=e};function F(t,e,n,s){M.call(this,t,e,40,40),t=Math.random()*(2*Math.PI),e=20+100*Math.random(),this.xs=Math.cos(t)*e,this.ys=Math.sin(t)*e,this.tx=n,this.ty=s}function D(t,e,n){M.call(this,540,960,10,10),this.playerIndex=t,this.board=e,this.effectFunction=n}A.__name__=!0,A.sec=function(t){return new Promise((function(e,n){u.tm.add(new A(t,e))}))},A.__super__=i,A.prototype=s(i.prototype,{update:function(t){this.s-=t,this.s<=0&&(this.alive=!1,this.c(this))}}),F.__name__=!0,F.__super__=M,F.prototype=s(M.prototype,{update:function(t){var e=Math.atan2(this.ty-this.y,this.tx-this.x);this.xs+=1500*Math.cos(e)*t,this.ys+=1500*Math.sin(e)*t,this.x+=this.xs*t,this.y+=this.ys*t,u.c.fillStyle="#ff0",u.c.beginPath(),I.circle(u.c,this.x,this.y,this.w/2),u.c.fill(),Math.abs(this.x-this.tx)<60&&Math.abs(this.y-this.ty)<40&&(d.gainCoin(),this.alive=!1)}}),D.__name__=!0,D.__super__=M,D.prototype=s(M.prototype,{applyEffect:function(){this.effectFunction(this.board.players[this.playerIndex],this.board.players[0==this.playerIndex?1:0])}});var O=function(t,e,n,s,i){D.call(this,t,e,n),t=s?t:0==t?1:0,i=e.players[t].curses+i,this.ty=0==t?1876.25:43.75,this.tx=67.5*i+3+30.75};O.__name__=!0,O.__super__=D,O.prototype=s(D.prototype,{update:function(t){u.c.fillStyle="#f0f",u.c.beginPath(),I.circle(u.c,this.x,this.y,30.75),u.c.fill()},play:function(){var t=this;return Y.start(this,{x:this.tx,y:this.ty},.5).then((function(e){return d.curse(),t.applyEffect(),t.alive=!1,t}))}});var z=function(t,e,n){this.callback=null,this.coinManager=new h,D.call(this,t,e,n),this.ty=0==t?1010:880,this.tx=0==t?116.25:951.25};function X(t,e){M.call(this,t,e,10.25,10.25),t=Math.random()*(2*Math.PI),e=30.75+30.75*Math.random(),this.xs=Math.cos(t)*e,this.ys=Math.sin(t)*e,this.alt=1/(.1+.7*Math.random())}z.__name__=!0,z.__super__=D,z.prototype=s(D.prototype,{update:function(t){this.coinManager.update(t),null!=this.callback&&this.coinManager.count()<4&&(this.applyEffect(),this.callback(this),this.callback=null,this.coinManager.add(new W(this.tx,this.ty,"+4","50px sans-serif","#0F0"))),this.alive=this.coinManager.hasAlive()},play:function(){var t=this;return this.coinManager.add(new F(this.x,this.y,this.tx,this.ty)),this.coinManager.add(new F(this.x,this.y,this.tx,this.ty)),this.coinManager.add(new F(this.x,this.y,this.tx,this.ty)),this.coinManager.add(new F(this.x,this.y,this.tx,this.ty)),new Promise((function(e,n){t.callback=e}))}}),X.__name__=!0,X.__super__=M,X.prototype=s(M.prototype,{update:function(t){this.a-=this.alt*t,this.x+=this.xs*t,this.y+=this.ys*t,u.c.fillStyle="#f0f",u.c.globalAlpha=Math.max(0,this.a),u.c.beginPath(),I.circle(u.c,this.x,this.y,this.w/2),u.c.fill(),u.c.globalAlpha=1,this.alive=0<this.a}});var W=function(t,e,n,s,i){M.call(this,t,e,1,1),this.str=n,this.fnt=s,this.sty=i};W.__name__=!0,W.__super__=M,W.prototype=s(M.prototype,{update:function(t){this.y+=-80*t,this.a-=t,u.c.globalAlpha=Math.max(0,this.a),u.c.font=this.fnt,u.c.fillStyle=this.sty,I.centeredText(u.c,this.str,this.x,0,this.y),u.c.globalAlpha=1,this.alive=0<this.a}});var L=function(t,e,n,s,i){D.call(this,t,e,n),s=0==(n=s?t:0==t?1:0)?1:0,t=e.players[n].curses+i,i=e.players[s].curses-1-i,this.ty=0==n?1876.25:43.75,this.tx=67.5*t+3+30.75,this.sy=0==s?1876.25:43.75,this.sx=67.5*i+3+30.75,this.x=this.sx,this.y=this.sy};function N(t,e){M.call(this,t,e,40,40),t=Math.random()*(2*Math.PI),e=40+200*Math.random(),this.xs=Math.cos(t)*e,this.ys=Math.sin(t)*e}L.__name__=!0,L.__super__=D,L.prototype=s(D.prototype,{update:function(t){u.c.strokeStyle="#000",u.c.lineWidth=3,u.c.fillStyle="#094",u.c.beginPath(),I.circle(u.c,this.sx,this.sy,30.75),u.c.stroke(),u.c.fill(),u.c.fillStyle="#f0f",u.c.beginPath(),I.circle(u.c,this.x,this.y,30.75),u.c.fill()},play:function(){var t=this;return Y.start(this,{x:this.tx,y:this.ty},.5).then((function(e){return t.applyEffect(),d.curse(),t.alive=!1,t}))}}),N.__name__=!0,N.__super__=M,N.prototype=s(M.prototype,{update:function(t){this.ys+=1500*t,this.x+=this.xs*t,this.y+=this.ys*t,this.a-=2*t,this.a<=0&&(this.alive=!1),u.c.fillStyle="#ff0",u.c.globalAlpha=Math.max(0,this.a),u.c.beginPath(),I.circle(u.c,this.x,this.y,this.w/2),u.c.fill(),u.c.globalAlpha=1}});var U=function(t,e,n,s,i){this.done=!1,this.pt=new h,D.call(this,t,e,n),t=s?t:0==t?1:0,i=e.players[t].curses-1-i,this.ty=0==t?1876.25:43.75,this.tx=67.5*i+3+30.75,this.done=i<0};U.__name__=!0,U.__super__=D,U.prototype=s(D.prototype,{update:function(t){u.c.lineWidth=3,u.c.strokeStyle="#FF0",u.c.globalAlpha=Math.max(0,this.a),u.c.beginPath(),u.c.moveTo(540,960),u.c.lineTo(this.x,this.y),u.c.stroke(),u.c.globalAlpha=1,this.pt.update(t),this.done&&!this.pt.hasAlive()&&(this.alive=!1)},play:function(){var t=this;return this.done?Promise.resolve(this):Y.start(this,{x:this.tx,y:this.ty},.2).then((function(e){t.applyEffect(),d.uncurse();for(var n=0;n<13;){n++;var s=Math.random()*(2*Math.PI),i=30.75*Math.random();t.pt.add(new X(t.tx+Math.cos(s)*i,t.ty+Math.sin(s)*i))}return Y.start(t,{a:0},.2)})).then((function(e){return t.done=!0,t}))}});var G=function(t,e,n){this.coinManager=new h,D.call(this,t,e,n),this.y=1==t?1010:880,this.x=1==t?116.25:951.25};function j(e,n){return null==n?null:(null==n.__id__&&(n.__id__=t.$haxeUID++),null==e.hx__closures__?e.hx__closures__={}:s=e.hx__closures__[n.__id__],null==s&&(s=n.bind(e),e.hx__closures__[n.__id__]=s),s);var s}G.__name__=!0,G.__super__=D,G.prototype=s(D.prototype,{update:function(t){this.coinManager.update(t),this.alive=this.coinManager.hasAlive()},play:function(){var t=this;return this.applyEffect(),d.loseCoin(),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new W(this.x,this.y,"-8","50px sans-serif","#F00")),A.sec(.5).then((function(e){return t}))}}),t.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(c.now=performance.now.bind(performance)),String.__name__=!0,Array.__name__=!0,b.__toStr={}.toString,a.repo=new Map,u.TITLE="13 Curses",u.l=0,u.tm=new h,l.loaded=!1,l.cardLoadQueue=[],l.loadNext=!0,m.COST=[3,2,2,3,2,4,2,3],m.DECK=[[30,20,10],[15,7,3],[10,5,2],[20,10,5],[15,7,3],[20,10,5],[20,10,5],[20,10,5]],m.COLOUR=["F70","E48","CE0","87E","E44","8C4","FC0","04F"],m.FUNC=[function(t,e){e.curses++},function(t,e){t.curses++},function(t,e){e.curses=0|Math.max(0,e.curses-1)},function(t,e){t.curses=0|Math.max(0,t.curses-1)},function(t,e){e.curses--,t.curses++},function(t,e){e.curses++,t.curses--},function(t,e){t.points+=4},function(t,e){e.points=0|Math.max(0,e.points-8)}],m.FACE=[["pf0f1135093|sf0f355🔥","pf0f1135093|sf0f335🔥|sf0f375🔥","pf0f1135093|sf0f337🔥|sf0f355🔥|sf0f377🔥"],["pf0f1165996|sf0f354🔥","pf0f1165996|sf0f334🔥|sf0f374🔥","pf0f1165996|sf0f334🔥|sf0f352🔥|sf0f374🔥"],["pf0f1135093|sf0f355🔥|p00012488|p00018428","pf0f1135093|sf0f335🔥|sf0f375🔥|p00012488|p00018428","pf0f1135093|sf0f337🔥|sf0f355🔥|sf0f377🔥|p00012488|p00018428"],["pf0f1165996|sf0f354🔥|p00013276|p00017236","pf0f1165996|sf0f334🔥|sf0f374🔥|p00013276|p00017236","pf0f1165996|sf0f334🔥|sf0f352🔥|sf0f374🔥|p00013276|p00017236"],["sf0f365🔥|pf0f12922|pf0f1182938","sf0f363🔥|sf0f367🔥|pf0f12922|pf0f1182938","sf0f354🔥|sf0f371🔥|sf0f377🔥|pf0f12922|pf0f1182938"],["sf0f365🔥|pf0f12922|pf0f1132233","sf0f363🔥|sf0f367🔥|pf0f12922|pf0f1132233","sf0f354🔥|sf0f371🔥|sf0f377🔥|pf0f12922|pf0f1132233"],["s000354💰|s000357+4","s000354💰💰|s000357+8","s000354💰💰💰|s000357+12"],["s000356💰|s000352-8","s000356💰💰|s000352-16","s000356💰💰💰|s000352-24"]],E.X=0,E.Y=0,E.C=!1,E.D=!1,E.GESTURE=0,E.mTouch=-1,E.tsx=0,E.tsy=0,u.main()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this)</script>