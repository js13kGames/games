<!doctype html><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1,user-scalable=0,user-scalable=no,minimal-ui,minimum-scale=1,maximum-scale=1"><style>#c,body,html{margin:0;padding:0;border:0;position:absolute}body,html{width:100%;height:100%;background-color:#000;overscroll-behavior:none}@media (min-aspect-ratio:9/16){#c{max-height:100%}}@media (max-aspect-ratio:9/16){#c{max-width:100%}}</style><title>13 Curses</title><canvas id=c width=1080 height=1920></canvas><script>"use strict";let zzfxV=.3,zzfxX=new AudioContext,zzfx=(e=1,t=.05,f=220,z=0,a=0,n=.1,r=0,o=1,s=0,x=0,c=0,u=0,i=0,d=0,X=0,b=0,l=0,m=1,h=0,B=0,C=0)=>{let V=Math,g=2*V.PI,w=44100,A=s*=500*g/w/w,D=f*=(1-t+2*t*V.random(t=[]))*g/w,I=0,M=0,P=0,S=1,j=0,k=0,p=0,q=C<0?-1:1,v=g*q*C*2/w,y=V.cos(v),E=V.sin,F=E(v)/4,G=1+F,H=-2*y/G,J=(1-F)/G,K=(1+q*y)/2/G,L=-(q+y)/G,N=K,O=0,Q=0,R=0,T=0;for(z=w*z+9,h*=w,a*=w,n*=w,l*=w,x*=500*g/w**3,X*=g/w,c*=g/w,u*=w,i=w*i|0,e*=zzfxV,q=z+h+a+n+l|0;P<q;t[P++]=p*e)++k%(100*b|0)||(p=r?1<r?2<r?3<r?E(I**3):V.max(V.min(V.tan(I),1),-1):1-(2*I/g%2+2)%2:1-4*V.abs(V.round(I/g)-I/g):E(I),p=(i?1-B+B*E(g*P/i):1)*(p<0?-1:1)*V.abs(p)**o*(P<z?P/z:P<z+h?1-(P-z)/h*(1-m):P<z+h+a?m:P<q-l?(q-P-l)/n*m:0),p=l?p/2+(l>P?0:(P<q-l?1:(q-P)/l)*t[P-l|0]/2/e):p,C&&(p=T=N*O+L*(O=Q)+K*(Q=p)-J*R-H*(R=T))),v=(f+=s+=x)*V.cos(X*M++),I+=v+v*d*E(P**5),S&&++S>u&&(f+=c,D+=c,S=0),!i||++j%i||(f=D,s=A,S=S||1);(e=zzfxX.createBuffer(1,q,w)).getChannelData(0).set(t),(f=zzfxX.createBufferSource()).buffer=e,f.connect(zzfxX.destination),f.start()}</script><script>!function(s){"use strict";var t=function(){return T.__string_rec(this,"")},f=f||{};function e(t,e){var n,s=Object.create(t);for(n in e)s[n]=e[n];return e.toString!==Object.prototype.toString&&(s.toString=e.toString),s}function i(){this.alive=!0}function u(){this.backgroundStyle="#094"}u.__name__=i.__name__=!0,u.prototype={update:function(t){_.c.fillStyle=this.backgroundStyle,_.c.fillRect(0,0,1080,1920)}};function l(){}l.__name__=!0,l.init=function(){var t;null==l.d&&((t=window.document.createElement("canvas")).width=1e3,t.height=1e3,l.d=t.getContext("2d",null))},l.get=function(t){return l.repo.get(t)},l.createImage=function(e){l.init(),l.d.clearRect(0,0,540,840),l.d.lineWidth=9,l.d.strokeStyle="#000",l.d.fillStyle="#"+S.COLOUR[e.effects[0]],I.roundRect(l.d,5,5,530,830,30,!0),l.d.fillStyle="#fff",I.roundRect(l.d,40,40,460,760,15,!0,!1),l.renderFace(S.FACE[e.effects[0]][e.effects.length-1]),l.d.lineWidth=6,l.d.strokeStyle="#000",l.d.fillStyle="#fff",I.roundRect(l.d,4,4,162,162,15,!0),l.d.font="100px sans-serif",l.d.fillStyle="#000",I.centeredText(l.d,null==e.cost?"null":""+e.cost,4,162,113.39999999999999,!0),l.d.lineWidth=6,l.d.strokeStyle="#999",l.d.beginPath(),l.d.moveTo(40,570),l.d.lineTo(500,570),l.d.stroke(),l.d.font="45px sans-serif",l.d.fillStyle="#000";for(var t=650,n=0,s=l.getDescription(e.effects[0],e.effects.length).split("_");n<s.length;){var i=s[n];++n,I.centeredText(l.d,i,0,540,t,!0),t+=45}l.d.font="20px sans-serif",l.d.fillStyle="#999";var r=l.d.measureText(e.getSerial()).width;l.d.fillText(e.getSerial(),495-r,795);r=l.d.getImageData(0,0,540,840);return window.createImageBitmap(r).then(function(t){return l.repo.set(e.getSerial(),t),t})},l.getDescription=function(t,e){var n=1<e?"s":"";switch(t){case 0:return"Add "+e+" Curse"+n+" to_your opponent";case 1:return"Add "+e+" Curse"+n+" to_yourself";case 2:return"Remove "+e+" Curse"+n+"_from your opponent";case 3:return"Remove "+e+" Curse"+n+"_from yourself";case 4:return"Take "+e+" Curse"+n+" from_your opponent to_yourself";case 5:return"Give "+e+" of your_Curses to your_opponent";case 6:return"Gain "+4*e+" Points";case 7:return"Remove "+8*e+" Points_from your opponent";default:return""}},l.createBack=function(){l.init(),l.d.clearRect(0,0,540,840),l.d.lineWidth=9,l.d.strokeStyle="#000",l.d.fillStyle="#888",I.roundRect(l.d,5,5,530,830,30,!0),l.d.fillStyle="#bbb",I.roundRect(l.d,40,40,460,760,15,!0,!1),l.d.font="100px sans-serif",l.d.fillStyle="#555",I.centeredText(l.d,"13",0,540,390,!0),I.centeredText(l.d,"Curses",0,540,520,!0);for(var t=0;t<13;){var e=t++,n=2*Math.PI/13*e,e=270+216*Math.cos(n),n=420+216*Math.sin(n);l.d.fillStyle="#85a",l.d.beginPath(),l.d.ellipse(e,n,20,20,0,0,2*Math.PI),l.d.fill()}var s=l.d.getImageData(0,0,540,840);return window.createImageBitmap(s).then(function(t){return l.repo.set("",t),t})},l.renderFace=function(t){if(null!=t)for(var e=0,n=t.split("|");e<n.length;){var s=n[e];switch(++e,s.charAt(0)){case"p":l.renderPathFace(p.substr(s,1,null));break;case"s":l.renderStringFace(p.substr(s,1,null))}}},l.renderStringFace=function(t){var e=p.substr(t,0,3),n=g.parseInt(p.substr(t,3,1))/10*460,s=40+g.parseInt(p.substr(t,4,1))/10*460,i=110+g.parseInt(p.substr(t,5,1))/10*460,t=p.substr(t,6,null);l.d.font=n+"px sans-serif",l.d.fillStyle="#"+e;e=l.d.measureText(t).width;l.d.fillText(t,s-e/2,i+n/2)},l.renderPathFace=function(t){for(var e=p.substr(t,0,3),n=g.parseInt(p.substr(t,3,1))/10*460/2,s=p.substr(t,4,null).split(""),i=g.parseInt,r=new Array(s.length),a=0,h=s.length;a<h;)r[o=a++]=i(s[o]);for(var o,s=r,i=l.facePosX,r=new Array(s.length),a=0,h=s.length;a<h;)r[o=a++]=i(s[o]);var c=r;l.d.lineWidth=n,l.d.strokeStyle="#"+e,l.d.beginPath(),l.d.moveTo(c.shift(),c.shift()+70);for(a=0,h=Math.floor(c.length/2);a<h;){a++;l.d.lineTo(c.shift(),c.shift()+70)}l.d.stroke()},l.facePosX=function(t){return 40+t/10*460},l.createCoinImages=function(){var t=[];l.d.font="350px sans-serif",l.d.clearRect(0,0,540,840),l.d.lineWidth=3,l.d.strokeStyle="#000",l.d.fillStyle="#fc0",l.d.beginPath(),l.d.ellipse(210,210,207,207,0,0,2*Math.PI),l.d.fill(),l.d.stroke(),l.d.fillStyle="#880",I.centeredText(l.d,"â–¼",0,420,357);var e=l.d.getImageData(0,0,420,420);t.push(window.createImageBitmap(e).then(function(t){return l.repo.set("a",t),t})),l.d.clearRect(0,0,540,840),l.d.lineWidth=3,l.d.strokeStyle="#000",l.d.fillStyle="#fc0",l.d.beginPath(),l.d.ellipse(210,210,207,207,0,0,2*Math.PI),l.d.fill(),l.d.stroke(),l.d.fillStyle="#880",I.centeredText(l.d,"â–²",0,420,308);e=l.d.getImageData(0,0,420,420);return t.push(window.createImageBitmap(e).then(function(t){return l.repo.set("b",t),t})),Promise.all(t)};function r(){this.dead=[],this.alive=[]}r.__name__=!0,r.prototype={update:function(t){this.dead=this.alive.slice(),this.alive=[];for(var e=0,n=this.dead;e<n.length;){var s=n[e];++e,s.update(t),s.alive&&this.alive.push(s)}},add:function(t){this.alive.push(t)},hasAlive:function(){return 0<this.alive.length},count:function(){return this.alive.length}};function d(){this.focusCard=null,this.gameOverSprites=[],this.effectManager=new r,this.selectedHandIndex=-1,this.shopButtons=[],this.handButtons=[],this.dice=new C(1080,760),this.coin=new k(1500,750,!0),this.shop=[],this.aiHand=[],this.playerHand=[],this.playerTurn=-1,this.roundTurn=0,this.round=0,this.phaseStep=0,this.board=new a,u.call(this),this.phaseFunc=j(this,this.gameStartPhase),this.flipButton=new P("Flip",100,0,1248,-1,120),this.flipButton.x=540-this.flipButton.w/2,this.flipButton.gesture=1,this.rollButton=new P("Roll",100,0,1248,-1,120),this.rollButton.x=540-this.flipButton.w/2,this.rollButton.gesture=1,this.endTurnButton=new P("End Turn",40,0,970,-1,130),this.endTurnButton.x=972-this.endTurnButton.w/2,this.handButtons.push(new H(20,1520,this.playerHand,0)),this.handButtons.push(new H(236,1520,this.playerHand,1)),this.handButtons.push(new H(452,1520,this.playerHand,2)),this.handButtons.push(new H(668,1520,this.playerHand,3)),this.handButtons.push(new H(884,1520,this.playerHand,4));var t=new H(232.5,820,this.shop,0);this.shopButtons.push(t),t=new H(437.5,820,this.shop,1),this.shopButtons.push(t),t=new H(642.5,820,this.shop,2),this.shopButtons.push(t),this.backButton=new P("Back",40,0,1152,-1,130),this.backButton.x=135-this.backButton.w/2,this.playButton=new P("Play",40,0,1152,-1,130),this.playButton.x=1080-(135-this.playButton.w/2)-this.playButton.w,this.playButton.gesture=1,this.buyButton=new P("Buy",40,0,1152,-1,130),this.buyButton.x=1080-(135-this.playButton.w/2)-this.playButton.w,this.buyButton.gesture=2,this.endGameButton=new P("Restart",100,0,1248,-1,120),this.endGameButton.x=540-this.endGameButton.w/2}d.__name__=!0,d.__super__=u,d.prototype=e(u.prototype,{update:function(t){u.prototype.update.call(this,t),_.c.strokeStyle="#ccc",_.c.fillStyle="#094",_.c.lineWidth=8,_.c.beginPath(),_.c.moveTo(0,960),_.c.lineTo(1080,960),_.c.stroke(),_.c.lineWidth=4,I.roundRect(_.c,232.5,820,180,280,5,!0,!0),I.roundRect(_.c,437.5,820,180,280,5,!0,!0),I.roundRect(_.c,642.5,820,180,280,5,!0,!0),_.c.fillStyle="#000",_.c.font="40px sans-serif",I.centeredText(_.c,"Round "+this.round,0,232.5,900),_.c.font="100px sans-serif",I.centeredText(_.c,g.string(this.board.players[0].points),0,232.5,1060),_.c.font="100px sans-serif",I.centeredText(_.c,g.string(this.board.players[1].points),835,232.5,930);for(var e=0,n=this.shop;e<n.length;){var s=n[e];++e,null!=s&&s!=this.focusCard&&s.update(t)}for(e=0,n=this.playerHand;e<n.length;){s=n[e];++e,s!=this.focusCard&&s.update(t)}for(e=0,n=this.aiHand;e<n.length;){s=n[e];++e,s!=this.focusCard&&s.update(t)}_.c.strokeStyle="#000",_.c.fillStyle="#fff",_.c.lineWidth=3;for(e=0;e<16;){var i=e++;_.c.fillStyle=i<this.board.players[1].curses?"#f0f":"#094",_.c.beginPath(),_.c.ellipse(67.5*i+3+30.75,43.75,30.75,30.75,0,0,2*Math.PI),_.c.stroke(),_.c.fill(),_.c.fillStyle=i<this.board.players[0].curses?"#f0f":"#094",_.c.beginPath(),_.c.ellipse(67.5*i+3+30.75,1876.25,30.75,30.75,0,0,2*Math.PI),_.c.stroke(),_.c.fill(),_.c.fillStyle="#fff";var r=46.125;_.c.font=r+"px sans-serif";var a=b.getPointsMultiplier(1+i);12==i?(_.c.font=r+"px sans-serif",I.centeredText(_.c,"â˜ ",67.5*i,67.5,58.425),I.centeredText(_.c,"â˜ ",67.5*i,67.5,1889.25)):1<a&&(_.c.font="36.9px sans-serif",I.centeredText(_.c,a+"X",67.5*i,67.5,58.425),I.centeredText(_.c,a+"X",67.5*i,67.5,1889.25))}this.phaseFunc(t);var h=this.focusCard;null!=h&&h.update(t),this.effectManager.update(t);for(e=0,n=this.gameOverSprites;e<n.length;){var o=n[e];++e,o.update(t)}},setPhase:function(t){this.phaseFunc=null==t?function(t){}:t,this.phaseStep=0,this.focusCard=null},gameStartPhase:function(t){var e=this;this.setPhase();for(var n=null,s=0;s<6;){var i=s++,r=i%2,a=this.board.drawCard();this.board.players[r].cards.push(a);a=[new B(a,1080,820)];(1==r?this.aiHand:this.playerHand).push(a[0]);i=[216*Math.floor(i/2)+20],r=[1==r?120:1520],n=null==n?(c.slide(),Y.start(a[0],{x:i[0],y:r[0]},.3)):n.then(function(e,n,s){return function(t){return c.slide(),Y.start(s[0],{x:n[0],y:e[0]},.3)}}(r,i,a))}n=n.then(function(t){return A.sec(.5)});for(var s=0,h=this.playerHand;s<h.length;){var o=[h[s]];++s,n=n.then(function(e){return function(t){return e[0].flip()}}(o))}n.then(function(t){return A.sec(.5)}).then(function(t){e.setPhase(j(e,e.startRoundPhase))})},startRoundPhase:function(t){var s=this;this.setPhase(),this.round++,this.board.resetShop();for(var e=Promise.resolve(null),n=0,i=this.shop;n<i.length;){var r=[i[n]];++n,null!=r[0]&&(e=e.then(function(e){return function(t){return c.slide(),Y.start(e[0],{x:-e[0].w},.5)}}(r)))}for(var e=e.then(function(t){return s.shop.length=0,Promise.resolve(s.shop)}),a=0,n=0,i=this.board.shop;n<i.length;){var h=i[n];++n;var o=[new B(h,1080,820)],h=[232.5+205*a];++a,e=e.then(function(e,n){return function(t){return s.shop.push(n[0]),n[0].flip(),Y.start(n[0],{x:e[0]},.3)}}(h,o))}e.then(function(t){return A.sec(.5)}).then(function(t){s.nextRound()})},chooseLeaderPhase:function(t){var e=this;this.coin.update(t),0==this.phaseStep&&(this.phaseStep=-1,Y.start(this.coin,{x:540-this.coin.w/2},.5).then(function(t){return e.phaseStep=1})),1==this.phaseStep&&(this.flipButton.update(),this.flipButton.clicked&&(this.phaseStep=2,this.coin.flip().then(function(t){return e.playerTurn=t?0:1}).then(function(t){return A.sec(.5)}).then(function(t){return Y.start(e.coin,{x:1080+e.coin.w},.5)}).then(function(t){e.setPhase(j(e,e.startTurnPhase))})))},startTurnPhase:function(t){var e=this;this.dice.update(t),0==this.phaseStep&&(this.phaseStep=-1,Y.start(this.dice,{x:540-this.dice.w/2},.5).then(function(t){return e.phaseStep=1==e.playerTurn?2:1})),1==this.phaseStep&&(this.rollButton.update(),this.rollButton.clicked&&(this.phaseStep=2)),2==this.phaseStep&&(this.phaseStep=3,this.dice.roll().then(function(t){return e.board.players[e.playerTurn].addPoints(t),A.sec(.5)}).then(function(t){return Y.start(e.dice,{x:1080},.5)}).then(function(t){e.setPhase(j(e,e.mainTurnPhase))}))},mainTurnPhase:function(t){1==this.playerTurn?this.aiTurnPhase(t):this.playerTurnPhase(t)},aiTurnPhase:function(t){for(var s=this,e=Promise.resolve(),n=m.getActions(this.board),i=0;i<n.length;){var r=[n[i]];switch(++i,r[0].type._hx_index){case 0:e=e.then(function(n){return function(t){var e=s.shop[n[0].index];return s.board.players[1].points-=e.card.cost,c.slide(),Y.start(e,{x:216*s.board.players[1].cards.length+20,y:120},.5)}}(r)).then(function(n){return function(t){var e=s.shop[n[0].index];return s.board.shop[n[0].index]=null,s.shop[n[0].index]=null,s.board.players[1].cards.push(e.card),s.aiHand.push(e),e.flip()}}(r));break;case 1:e=e.then(function(e){return function(t){return s.selectedHandIndex=e[0].index,Promise.resolve(e[0].index)}}(r)).then(function(t){return s.aiHand[s.selectedHandIndex].flip().then(function(t){return s.focusCard=s.aiHand[s.selectedHandIndex],c.slide(),Y.start(s.aiHand[s.selectedHandIndex],{scaleX:3,scaleY:3,x:450,y:540},.2)})}).then(function(t){return A.sec(.5)}).then(function(t){var e=s.aiHand[s.selectedHandIndex];return Y.start(e,{scaleX:0,scaleY:0,y:960},.5)}).then(function(t){var e=s.aiHand[s.selectedHandIndex];return s.playCard(1,e)});break;case 2:e.then(function(t){s.board.gameOver()?s.setPhase(j(s,s.gameEndPhase)):s.nextTurn()})}}this.setPhase()},playerTurnPhase:function(t){var e,n,s,i=this;if(0==this.phaseStep){this.endTurnButton.update(),this.endTurnButton.clicked&&this.nextTurn();for(var r=0,a=this.handButtons;r<a.length;){var h=a[r];if(++r,h.cardIndex>=this.playerHand.length)break;h.update(t),h.clicked&&(this.phaseStep=-1,this.selectedHandIndex=h.cardIndex,this.playButton.enabled=this.playerHand[this.selectedHandIndex].card.canPlay(this.board.players[0],this.board.players[1]),this.focusCard=this.playerHand[this.selectedHandIndex],c.slide(),Y.start(this.playerHand[this.selectedHandIndex],{scaleX:3,scaleY:3,x:450,y:540},.2).then(function(t){return i.phaseStep=1}))}for(r=0,a=this.shopButtons;r<a.length;){var o=a[r];++r,null!=this.shop[o.cardIndex]&&(o.update(t),o.clicked&&(this.phaseStep=-1,this.selectedHandIndex=o.cardIndex,this.buyButton.enabled=this.shop[this.selectedHandIndex].card.cost<=this.board.players[0].points&&this.board.players[0].cards.length<5,this.focusCard=this.shop[this.selectedHandIndex],c.slide(),Y.start(this.shop[this.selectedHandIndex],{scaleX:3,scaleY:3,x:450,y:540},.2).then(function(t){return i.phaseStep=2})))}}1==this.phaseStep&&(this.playButton.update(),this.backButton.gesture=2,this.backButton.update(),this.backButton.clicked&&(this.phaseStep=-1,c.slide(),Y.start(this.playerHand[this.selectedHandIndex],{scaleX:1,scaleY:1,x:216*this.selectedHandIndex+20,y:1520},.2).then(function(t){return i.phaseStep=0,i.focusCard=null})),this.playButton.clicked&&(this.phaseStep=-1,e=this.playerHand[this.selectedHandIndex],Y.start(e,{scaleX:0,scaleY:0,y:960},.5).then(function(t){return i.playCard(0,e)}).then(function(t){i.board.gameOver()?i.setPhase(j(i,i.gameEndPhase)):i.phaseStep=0}))),2==this.phaseStep&&(this.buyButton.update(),this.backButton.gesture=1,this.backButton.update(),this.backButton.clicked&&(this.phaseStep=-1,c.slide(),Y.start(this.shop[this.selectedHandIndex],{scaleX:1,scaleY:1,x:232.5+205*this.selectedHandIndex,y:820},.2).then(function(t){return i.phaseStep=0})),this.buyButton.clicked&&(this.phaseStep=-1,this.board.players[0].points-=this.shop[this.selectedHandIndex].card.cost,n=this.shop[this.selectedHandIndex],s=this.playerHand.length,c.slide(),Y.start(n,{scaleX:1,scaleY:1,x:216*s+20,y:1520},.5).then(function(t){return i.board.shop[i.selectedHandIndex]=null,i.shop[i.selectedHandIndex]=null,i.board.players[0].cards.push(n.card),i.playerHand.push(n),i.phaseStep=0})))},playCard:function(r,a){for(var h=this,t=Promise.resolve(),e=0,n=0,s=a.card.effects;n<s.length;){var i=s[n];++n;i=[this.createCardEffect(i,r,e)];++e,t=t.then(function(e){return function(t){return h.effectManager.add(e[0]),e[0].play()}}(i))}return t.then(function(t){var e=1==r?h.aiHand:h.playerHand;p.remove(e,a),p.remove(h.board.players[r].cards,a.card);for(var n=Promise.resolve(),s=0;s<e.length;){var i=[e[s]];++s,n=n.then(function(n){return function(t){var e=h.board.players[r].cards.indexOf(n[0].card);return Y.start(n[0],{x:216*e+20},.2)}}(i))}return n})},createCardEffect:function(t,e,n){var s=S.FUNC[t];switch(t){case 0:return new O(e,this.board,s,!1,n);case 1:return new O(e,this.board,s,!0,n);case 2:return new U(e,this.board,s,!1,n);case 3:return new U(e,this.board,s,!0,n);case 4:return new L(e,this.board,s,!0,n);case 5:return new L(e,this.board,s,!1,n);case 6:return new z(e,this.board,s);case 7:return new G(e,this.board,s);default:return null}},nextTurn:function(){this.roundTurn++,this.roundTurn<2?(this.playerTurn=0==this.playerTurn?1:0,this.setPhase(j(this,this.startTurnPhase))):this.setPhase(j(this,this.startRoundPhase))},nextRound:function(){this.roundTurn=0,this.playerTurn=this.board.getTurnLeader(),-1==this.playerTurn?this.setPhase(j(this,this.chooseLeaderPhase)):this.setPhase(j(this,this.startTurnPhase))},gameEndPhase:function(t){var e,n,s,i=this;0==this.phaseStep&&(this.phaseStep=-1,e=this.board.getWinner(),n=new R(813,0==e?43.75:1876.25,"â˜ ",46.125,"#fff"),this.gameOverSprites.push(n),s=new R(1080,860,0==e?"You Win!":"You Lose!",150,"#000"),this.gameOverSprites.push(s),Y.start(n,{scaleX:3,scaleY:3,a:0,x:813-.8*n.w},1).then(function(t){return Y.start(s,{x:540-s.w/2},.5)}).then(function(t){return i.phaseStep=1})),1==this.phaseStep&&(this.endGameButton.update(t),this.endGameButton.clicked&&(this.phaseStep=-1,_.cs=new y))}});var p=function(){};p.__name__=!0,p.substr=function(t,e,n){if(null==n)n=t.length;else if(n<0){if(0!=e)return"";n=t.length+n}return t.substr(e,n)},p.remove=function(t,e){e=t.indexOf(e);return-1!=e&&(t.splice(e,1),!0)},p.now=function(){return Date.now()};var _=function(){};_.__name__=!0,_.main=function(){_.ca=window.document.getElementById("c"),_.c=_.ca.getContext("2d",null),window.onresize=_.onResize,_.onResize(),_.cs=new y,E.i(),window.requestAnimationFrame(_.update)},_.update=function(t){var e=t-_.l;_.tm.update(e/1e3);var n=_.cs;null!=n&&n.update(e/1e3),_.l=t,E.u(),window.requestAnimationFrame(_.update)},_.onResize=function(){var t=window.innerWidth,e=window.innerHeight;_.ca.style.top=(e-_.ca.clientHeight)/2+"px",_.ca.style.left=(t-_.ca.clientWidth)/2+"px"};var y=function(){if(u.call(this),this.playButton=new P("Play",100,0,960,0,140),this.playButton.x=540-this.playButton.w/2,this.playButton.onClick=function(){_.cs=new d},!y.loaded){for(var t=0,e=S.DECK.length;t<e;)for(var n=t++,s=0,i=S.DECK[n].length;s<i;){for(var r=s++,a=y.cardLoadQueue,h=[],o=0,c=1+r;o<c;){o++;h.push(n)}a.push(new w(h))}l.createBack().then(function(t){return y.loadNext=!0})}};y.__name__=!0,y.__super__=u,y.prototype=e(u.prototype,{update:function(t){u.prototype.update.call(this,t),_.c.fillStyle="#000",_.c.font="100px sans-serif",I.centeredText(_.c,_.TITLE,0,1080,480),y.loaded?this.playButton.update():y.loadNext&&(y.loadNext=!1,_.c.font="70px sans-serif",I.centeredText(_.c,"Loading...",0,1080,960),null!=(t=y.cardLoadQueue.pop())?l.createImage(t).then(function(t){return y.loadNext=!0}):l.createCoinImages().then(function(t){return y.loaded=!0}))}}),Math.__name__=!0;function x(){}x.__name__=!0,x.getProperty=function(t,e){var n;if(null==t)return null;var s=!!t.__properties__&&(n=t.__properties__["get_"+e]);return s?t[n]():t[e]},x.setProperty=function(t,e,n){var s,i=!!t.__properties__&&(s=t.__properties__["set_"+e]);i?t[s](n):t[e]=n},x.fields=function(t){var e=[];if(null!=t){var n,s=Object.prototype.hasOwnProperty;for(n in t)"__id__"!=n&&"hx__closures__"!=n&&s.call(t,n)&&e.push(n)}return e};var c=function(){};c.__name__=!0,c.flip=function(){zzfx(.5,.1,196,.1,0,.1,4,1.5,0,0,50,0,0,0,0,0,.05,1,0,0,0)},c.slide=function(){zzfx(.1,.1,196,.25,0,.1,4,1.5,0,0,50,0,0,0,0,0,0,1,0,0,0)},c.button=function(){zzfx(.8,.05,419,0,.01,.008,0,3,2,56,0,0,0,.8,0,0,0,.54,0,.04,-1040)},c.curse=function(){zzfx(1,1,123.4708,.15,0,.1,1,1,0,100,300,.06,.07,0,20,.1,.08,.51,.11,.35,0)},c.uncurse=function(){zzfx(.6,.2,140,.1,.07,.2,1,1,-1,85,290,0,.1,.4,0,.1,0,.5,.08,0,0)},c.gainCoin=function(){zzfx(.3,.1,450,.01,.07,.12,1,2.4,0,1,280,.05,0,0,0,0,0,.7,.04,0,152)},c.loseCoin=function(){zzfx(.4,.5,350,0,.2,.3,2,.5,1,0,0,0,.03,1.9,0,0,0,1,0,.48,-2500)},c.roll=function(){zzfx(.5,1,82.40689,.02,.02,.03,0,.6,0,16,-191,.15,0,0,42,0,0,.74,.02,.06,-657)},c.coinFlip=function(){zzfx(.5,2,70,.1,.05,.1,0,1.6,7,27,0,0,0,.9,0,0,0,.7,.02,0,-856)};var g=function(){};g.__name__=!0,g.string=function(t){return T.__string_rec(t,"")},g.parseInt=function(t){t=parseInt(t);return isNaN(t)?null:t};function n(){}n.__name__=!0,n.lpad=function(t,e,n){if(e.length<=0)return t;var s="";for(n-=t.length;s.length<n;)s+=null==e?"null":""+e;return s+=null==t?"null":""+t};var v=f["game.ActionType"]={__ename__:!0,__constructs__:null,BUY:{_hx_name:"BUY",_hx_index:0,__enum__:"game.ActionType",toString:t},PLAY:{_hx_name:"PLAY",_hx_index:1,__enum__:"game.ActionType",toString:t},END:{_hx_name:"END",_hx_index:2,__enum__:"game.ActionType",toString:t}};v.__constructs__=[v.BUY,v.PLAY,v.END];var m=function(){};m.__name__=!0,m.getActions=function(t){for(var e=t.players[0].copy(),n=t.players[1].copy(),s=[],i=0,r=t.shop;i<r.length;){var a=r[i];++i,null!=a&&m.shouldBuy(a,n,e)&&(s.push({type:v.BUY,index:t.shop.indexOf(a)}),n.cards.push(a),n.points-=a.cost)}for(var h=m.getStateScore(n,e),o=null,i=0,r=n.cards;i<r.length;){var c=r[i];++i;var u=m.getPlayScore(c,n,e);h<u&&(h=u,o=c)}return null!=o&&s.push({type:v.PLAY,index:n.cards.indexOf(o)}),s.push({type:v.END,index:-1}),s},m.shouldBuy=function(t,e,n){if(t.cost>e.points||4<e.cards.length)return!1;for(var s=0,i=0,r=0,a=e.cards;r<a.length;){var h=a[r];++r,m.isOffensive(h)?++i:++s}t=m.isOffensive(t);return!!(i<3&&t)||s<2&&!t},m.isOffensive=function(t){switch(t.effects[0]){case 0:case 5:case 6:case 7:return!0;default:return!1}},m.getPlayScore=function(t,e,n){for(var s=e.copy(),i=n.copy(),r=0,a=t.effects;r<a.length;){var h=a[r];++r,S.FUNC[h](s,i)}return m.getStateScore(s,i)},m.getStateScore=function(t,e){if(13==t.curses||!t.validState()||!e.validState())return-1e4;if(13==e.curses)return 1e4;var n=t.points-e.points;return t.curses<13?n+=13-t.curses:n+=6*(t.curses-13),e.curses<13?n+=e.curses:n-=6*(e.curses-13),n};var a=function(){this.players=[new b,new b],this.shop=[]};a.__name__=!0,a.prototype={getTurnLeader:function(){var t=this.players[0].curses-this.players[1].curses;return 0==t?-1:0<t?0:1},drawCard:function(){return h.getRandomCard()},resetShop:function(){this.shop=[],this.shop.push(this.drawCard()),this.shop.push(this.drawCard()),this.shop.push(this.drawCard())},gameOver:function(){return 13==this.players[0].curses||13==this.players[1].curses},getWinner:function(){return 13==this.players[0].curses?1:13==this.players[1].curses?0:-1}};var w=function(t){this.cost=0,this.effects=t;for(var e=0;e<t.length;){var n=t[e];++e,this.cost+=S.COST[n]}};w.__name__=!0,w.prototype={canPlay:function(t,e){for(var n=t.copy(),s=e.copy(),i=0,r=this.effects;i<r.length;){var a=r[i];++i,S.FUNC[a](n,s)}return!!n.validState()&&s.validState()},getSerial:function(){return n.lpad(g.string(this.effects[0]),"0",2)+"-x"+g.string(this.effects.length)}};var S=function(){};S.__name__=!0;var h=function(){};h.__name__=!0,h.getRandomCard=function(){for(var t=S.DECK,e=Math.floor(267*Math.random()),n=0,s=t.length;n<s;)for(var i=n++,r=0,a=t[i].length;r<a;){var h=r++;if((e-=t[i][h])<=0){for(var o=[],c=0,u=1+h;c<u;){c++;o.push(i)}return new w(o)}}return new w([0])};var b=function(){this.points=3,this.cards=[],this.curses=0};b.__name__=!0,b.getPointsMultiplier=function(t){return 13<t?4:9<t?3:6<t?2:1},b.prototype={copy:function(){var t=new b;return t.curses=this.curses,t.cards=this.cards.slice(),t.points=this.points,t},validState:function(){return 0<=this.curses&&this.curses<=16&&0<=this.points&&this.cards.length<=5},addPoints:function(t){this.points+=t*b.getPointsMultiplier(this.curses)}};t=function(t){this.current=0,this.array=t};t.__name__=!0,t.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]}};var T=function(){};T.__name__=!0,T.__string_rec=function(i,r){if(null==i)return"null";if(5<=r.length)return"<...>";var t=typeof i;switch(t="function"==t&&(i.__name__||i.__ename__)?"object":t){case"function":return"<function>";case"object":if(i.__enum__){var a=f[i.__enum__].__constructs__[i._hx_index],e=a._hx_name;return a.__params__?(r+="\t",e+"("+function(){for(var t=[],e=0,n=a.__params__;;){if(!(e<n.length))break;var s=n[e];e+=1,t.push(T.__string_rec(i[s],r))}return t}().join(",")+")"):e}if(i instanceof Array){var n="[";r+="\t";for(var s=0,h=i.length;s<h;){var o=s++;n+=(0<o?",":"")+T.__string_rec(i[o],r)}return n+="]"}try{c=i.toString}catch(s){return"???"}if(null!=c&&c!=Object.toString&&"function"==typeof c){var c=i.toString();if("[object Object]"!=c)return c}n="{\n";r+="\t";var u=null!=i.hasOwnProperty,l=null;for(l in i)u&&!i.hasOwnProperty(l)||"prototype"!=l&&"__class__"!=l&&"__super__"!=l&&"__interfaces__"!=l&&"__properties__"!=l&&(2!=n.length&&(n+=", \n"),n+=r+l+" : "+T.__string_rec(i[l],r));return n+="\n"+(r=r.substring(1))+"}";case"string":return i;default:return String(i)}};function o(t,e,n,s){this.clickSound=c.button,this.gesture=-1,this.enabled=!0,this.clicked=!1,this.x=t,this.y=e,this.w=n,this.h=s}o.__name__=!0,o.prototype={update:function(t){null==t&&(t=0),this.state=0,this.clicked=!1,this.enabled&&!(E.X<this.x||E.Y<this.y||E.X>this.x+this.w||E.Y>this.y+this.h)&&(this.state=E.D?2:1,this.clicked=E.C,this.clicked&&(this.clickSound(),null!=this.onClick&&this.onClick())),this.enabled&&E.GESTURE==this.gesture&&(this.clicked=E.C,this.clickSound(),null!=this.onClick&&this.onClick())}};var P=function(t,e,n,s,i,r){o.call(this,n,s,i,r),_.c.font=e+"px sans-serif",this.textWidth=_.c.measureText(t).width,this.w<=0&&(this.w=this.textWidth+40),this.label=t,this.fontSize=e};P.__name__=!0,P.__super__=o,P.prototype=e(o.prototype,{update:function(t){var e;switch(o.prototype.update.call(this,t=null==t?0:t),_.c.lineWidth=3,_.c.strokeStyle="#000",this.state){case 1:e="#0c4";break;case 2:e="#084";break;default:e="#094"}_.c.fillStyle=e,I.roundRect(_.c,this.x,this.y,this.w,this.h,10,!0,!0),_.c.font=this.fontSize+"px sans-serif",_.c.lineWidth=10,_.c.lineJoin="round",_.c.fillStyle="#000",_.c.strokeStyle="#fff",I.centeredText(_.c,this.label,this.x,this.w,this.y+(this.h/2- -.35*this.fontSize)),this.enabled||(_.c.strokeStyle="#000",_.c.moveTo(this.x,this.y+this.h/2),_.c.lineTo(this.x+this.w,this.y+this.h/2),_.c.stroke())}});function M(t,e,n,s){this.a=1,this.scaleY=1,this.scaleX=1,i.call(this),this.x=t,this.y=e,this.w=n,this.h=s}M.__name__=!0,M.__super__=i,M.prototype=e(i.prototype,{});var B=function(t,e,n,s){null==s&&(s=!0),this.faceDown=!0,this.imgBack=null,this.imgFront=null,M.call(this,e,n,180,280),this.card=t,this.imgBack=l.get(""),this.imgFront=l.get(t.getSerial())};B.__name__=!0,B.__super__=M,B.prototype=e(M.prototype,{update:function(t){null!=this.imgBack&&null!=this.imgFront&&_.c.drawImage(this.faceDown?this.imgBack:this.imgFront,0,0,this.imgBack.width,this.imgBack.height,this.x+(this.w-this.scaleX*this.w)/2,this.y,this.w*this.scaleX,this.h*this.scaleY)},flip:function(){var e=this;return c.flip(),Y.start(this,{scaleX:0},.2).then(function(t){return e.faceDown=!e.faceDown,Y.start(e,{scaleX:1},.2)})}});var k=function(t,e,n){this.c=null,this.soundTimer=0,this.flipTime=0,this.flipSpeed=0,this.f=0,M.call(this,t,e,420,420),this.scaleY=n?1:-1,this.face=[l.get("a"),l.get("b")]};k.__name__=!0,k.__super__=M,k.prototype=e(M.prototype,{update:function(t){0<this.flipTime?(this.flipTime-=t,this.f+=this.flipSpeed*t,this.scaleY=Math.cos(this.f),this.soundTimer-=this.flipSpeed*t,this.soundTimer<=0&&(this.soundTimer=Math.PI/2,c.coinFlip())):null!=this.c&&(this.scaleY=0<this.scaleY?1:-1,this.c(0<this.scaleY)),_.c.drawImage(0<this.scaleY?this.face[0]:this.face[1],0,0,this.w,this.h,this.x,this.y+(this.h/2-Math.abs(this.h*this.scaleY)/2),this.w,Math.abs(this.h*this.scaleY))},flip:function(){var n=this;return this.flipSpeed=2*Math.random()*Math.PI+5*Math.PI,this.flipTime=.2*Math.random()+.8,this.soundTimer=Math.PI/2,new Promise(function(t,e){n.c=t})}});var I=function(){};I.__name__=!0,I.roundRect=function(t,e,n,s,i,r,a,h){null==h&&(h=!0),null==a&&(a=!1),null==r&&(r=5),t.beginPath(),t.moveTo(e+r,n),t.lineTo(e+s-r,n),t.quadraticCurveTo(e+s,n,e+s,n+r),t.lineTo(e+s,n+i-r),t.quadraticCurveTo(e+s,n+i,e+s-r,n+i),t.lineTo(e+r,n+i),t.quadraticCurveTo(e,n+i,e,n+i-r),t.lineTo(e,n+r),t.quadraticCurveTo(e,n,e+r,n),t.closePath(),a&&t.fill(),h&&t.stroke()},I.centeredText=function(t,e,n,s,i,r,a){null==a&&(a=!1),null==r&&(r=!0);var h=t.measureText(e).width;r&&t.fillText(e,n+s/2-h/2,i),a&&t.strokeText(e,n+s/2-h/2,i)},I.circle=function(t,e,n,s,i){_.c.ellipse(e,n,s,null==i?s:i,0,0,2*Math.PI)};var C=function(t,e){this.r=.1,this.f=1,this.c=null,this.t=1,M.call(this,t,e,400,400)};C.__name__=!0,C.__super__=M,C.prototype=e(M.prototype,{update:function(t){null!=this.c&&(this.t-=t,this.r-=t,this.t<0&&(this.c(this.f),this.c=null),this.r<0&&(this.r=.1,(e=Math.ceil(6*Math.random()))!=this.f&&(c.roll(),this.f=e))),_.c.lineWidth=3,_.c.strokeStyle="#000",_.c.fillStyle="#f00",I.roundRect(_.c,this.x,this.y,this.w,this.h,40,!0),_.c.font="300px sans-serif",_.c.fillStyle="#fff";var e=g.string(this.f);I.centeredText(_.c,e,this.x,this.w,this.y+(this.h/2+105))},roll:function(){var n=this;return new Promise(function(t,e){n.c=t,n.t=1})}});var H=function(t,e,n,s){o.call(this,t,e,180,280),this.hand=n,this.cardIndex=s};H.__name__=!0,H.__super__=o,H.prototype=e(o.prototype,{update:function(t){var e,n,s;null==t&&(t=0),o.prototype.update.call(this),this.cardIndex>=this.hand.length||null!=(e=this.hand[this.cardIndex])&&(s=(n=1==this.state?this.y-50:this.y)-e.y,Math.abs(s)<1?e.y=n:s<0?e.y-=200*t:0<s&&(e.y+=200*t))}});var E=function(){};E.__name__=!0,E.i=function(){_.ca.onmousemove=E.m,window.onmousedown=E.o,window.onmouseup=E.p,window.ontouchstart=E.ots,window.ontouchmove=E.otm,window.ontouchend=E.ote,window.ontouchcancel=E.ote},E.m=function(t){E.X=t.offsetX/_.ca.clientWidth*1080,E.Y=t.offsetY/_.ca.clientHeight*1920},E.o=function(t){E.D=!0},E.p=function(t){E.D=!1,E.C=!0},E.ots=function(t){t.preventDefault();for(var e=0,n=t.changedTouches;e<n.length;){var s=n[e];++e;var i=E.tpx(s),r=E.tpy(s);E.mTouch<0&&(E.mTouch=s.identifier,E.X=i,E.Y=r,E.tsx=i,E.tsy=r,E.D=!0)}},E.otm=function(t){t.preventDefault();for(var e=0,n=t.changedTouches;e<n.length;){var s=n[e];++e;var i=E.tpx(s),r=E.tpy(s);E.mTouch==s.identifier&&(E.X=i,E.Y=r)}},E.ote=function(t){t.preventDefault();for(var e=0,n=t.changedTouches;e<n.length;){var s=n[e];++e,s.identifier==E.mTouch&&(E.C=!0,E.mTouch=-1,E.D=!1,E.GESTURE=E.getGesture(E.tsx,E.tsy,E.tpx(s),E.tpy(s)))}},E.tpx=function(t){return(t.clientX-_.ca.offsetLeft)/_.ca.clientWidth*1080},E.tpy=function(t){return(t.clientY-_.ca.offsetTop)/_.ca.clientHeight*1920},E.getGesture=function(t,e,n,s){return 150<n-t?4:n-t<-150?3:150<s-e?2:s-e<-150?1:0},E.u=function(){E.C=!1,E.GESTURE=0};var R=function(t,e,n,s,i){M.call(this,t,e,0,s),this.text=n,this.size=s,this.fillStyle=i,_.c.font=s+"px sans-serif",this.w=_.c.measureText(n).width};R.__name__=!0,R.__super__=M,R.prototype=e(M.prototype,{update:function(t){_.c.fillStyle=this.fillStyle,_.c.font=this.size*this.scaleY+"px sans-serif",_.c.fillText(this.text,this.x,this.y+this.h)}});var Y=function(t,e,n){this.p=0,i.call(this),this.sc=t,this.props=e,this.cb=n};Y.__name__=!0,Y.start=function(t,e,n){for(var s=1/n,i=[],r=0,a=x.fields(e);r<a.length;){var h=a[r];++r;var o=x.getProperty(t,h),c=x.getProperty(e,h);o!=c&&i.push({tgt:t,name:h,start:o,scale:c-o})}return new Promise(function(t,e){0<i.length?_.tm.add(new Y(s,i,t)):t(null)})},Y.__super__=i,Y.prototype=e(i.prototype,{update:function(t){this.p+=t*this.sc,1<=this.p&&(this.p=1,this.alive=!1,this.updateProps(1),this.cb(this)),this.updateProps(this.p)},updateProps:function(t){for(var e=0,n=this.props;e<n.length;){var s=n[e];++e;var i=s.start+s.scale*t;x.setProperty(s.tgt,s.name,i)}}});var A=function(t,e){i.call(this),this.s=t,this.c=e};A.__name__=!0,A.sec=function(n){return new Promise(function(t,e){_.tm.add(new A(n,t))})},A.__super__=i,A.prototype=e(i.prototype,{update:function(t){this.s-=t,this.s<=0&&(this.alive=!1,this.c(this))}});function F(t,e,n,s){M.call(this,t,e,40,40),t=Math.random()*(2*Math.PI),e=20+100*Math.random(),this.xs=Math.cos(t)*e,this.ys=Math.sin(t)*e,this.tx=n,this.ty=s}F.__name__=!0,F.__super__=M,F.prototype=e(M.prototype,{update:function(t){var e=Math.atan2(this.ty-this.y,this.tx-this.x);this.xs+=1500*Math.cos(e)*t,this.ys+=1500*Math.sin(e)*t,this.x+=this.xs*t,this.y+=this.ys*t,_.c.fillStyle="#ff0",_.c.beginPath(),I.circle(_.c,this.x,this.y,this.w/2),_.c.fill(),Math.abs(this.x-this.tx)<60&&Math.abs(this.y-this.ty)<40&&(c.gainCoin(),this.alive=!1)}});function D(t,e,n){M.call(this,540,960,10,10),this.playerIndex=t,this.board=e,this.effectFunction=n}D.__name__=!0,D.__super__=M,D.prototype=e(M.prototype,{applyEffect:function(){this.effectFunction(this.board.players[this.playerIndex],this.board.players[0==this.playerIndex?1:0])}});var O=function(t,e,n,s,i){D.call(this,t,e,n);t=s?t:0==t?1:0,i=e.players[t].curses+i;this.ty=0==t?1876.25:43.75,this.tx=67.5*i+3+30.75};O.__name__=!0,O.__super__=D,O.prototype=e(D.prototype,{update:function(t){_.c.fillStyle="#f0f",_.c.beginPath(),I.circle(_.c,this.x,this.y,30.75),_.c.fill()},play:function(){var e=this;return Y.start(this,{x:this.tx,y:this.ty},.5).then(function(t){return c.curse(),e.applyEffect(),e.alive=!1,e})}});var z=function(t,e,n){this.callback=null,this.coinManager=new r,D.call(this,t,e,n),this.ty=0==t?1010:880,this.tx=0==t?116.25:951.25};z.__name__=!0,z.__super__=D,z.prototype=e(D.prototype,{update:function(t){this.coinManager.update(t),null!=this.callback&&this.coinManager.count()<4&&(this.applyEffect(),this.callback(this),this.callback=null,this.coinManager.add(new W(this.tx,this.ty,"+4","50px sans-serif","#0F0"))),this.alive=this.coinManager.hasAlive()},play:function(){var n=this;return this.coinManager.add(new F(this.x,this.y,this.tx,this.ty)),this.coinManager.add(new F(this.x,this.y,this.tx,this.ty)),this.coinManager.add(new F(this.x,this.y,this.tx,this.ty)),this.coinManager.add(new F(this.x,this.y,this.tx,this.ty)),new Promise(function(t,e){n.callback=t})}});function X(t,e){M.call(this,t,e,10.25,10.25),t=Math.random()*(2*Math.PI),e=30.75+30.75*Math.random(),this.xs=Math.cos(t)*e,this.ys=Math.sin(t)*e,this.alt=1/(.1+.7*Math.random())}X.__name__=!0,X.__super__=M,X.prototype=e(M.prototype,{update:function(t){this.a-=this.alt*t,this.x+=this.xs*t,this.y+=this.ys*t,_.c.fillStyle="#f0f",_.c.globalAlpha=Math.max(0,this.a),_.c.beginPath(),I.circle(_.c,this.x,this.y,this.w/2),_.c.fill(),_.c.globalAlpha=1,this.alive=0<this.a}});var W=function(t,e,n,s,i){M.call(this,t,e,1,1),this.str=n,this.fnt=s,this.sty=i};W.__name__=!0,W.__super__=M,W.prototype=e(M.prototype,{update:function(t){this.y+=-80*t,this.a-=t,_.c.globalAlpha=Math.max(0,this.a),_.c.font=this.fnt,_.c.fillStyle=this.sty,I.centeredText(_.c,this.str,this.x,0,this.y),_.c.globalAlpha=1,this.alive=0<this.a}});var L=function(t,e,n,s,i){D.call(this,t,e,n);n=s?t:0==t?1:0,s=0==n?1:0,t=e.players[n].curses+i,i=e.players[s].curses-1-i;this.ty=0==n?1876.25:43.75,this.tx=67.5*t+3+30.75,this.sy=0==s?1876.25:43.75,this.sx=67.5*i+3+30.75,this.x=this.sx,this.y=this.sy};L.__name__=!0,L.__super__=D,L.prototype=e(D.prototype,{update:function(t){_.c.strokeStyle="#000",_.c.lineWidth=3,_.c.fillStyle="#094",_.c.beginPath(),I.circle(_.c,this.sx,this.sy,30.75),_.c.stroke(),_.c.fill(),_.c.fillStyle="#f0f",_.c.beginPath(),I.circle(_.c,this.x,this.y,30.75),_.c.fill()},play:function(){var e=this;return Y.start(this,{x:this.tx,y:this.ty},.5).then(function(t){return e.applyEffect(),c.curse(),e.alive=!1,e})}});function N(t,e){M.call(this,t,e,40,40),t=Math.random()*(2*Math.PI),e=40+200*Math.random(),this.xs=Math.cos(t)*e,this.ys=Math.sin(t)*e}N.__name__=!0,N.__super__=M,N.prototype=e(M.prototype,{update:function(t){this.ys+=1500*t,this.x+=this.xs*t,this.y+=this.ys*t,this.a-=2*t,this.a<=0&&(this.alive=!1),_.c.fillStyle="#ff0",_.c.globalAlpha=Math.max(0,this.a),_.c.beginPath(),I.circle(_.c,this.x,this.y,this.w/2),_.c.fill(),_.c.globalAlpha=1}});var U=function(t,e,n,s,i){this.done=!1,this.pt=new r,D.call(this,t,e,n);t=s?t:0==t?1:0,i=e.players[t].curses-1-i;this.ty=0==t?1876.25:43.75,this.tx=67.5*i+3+30.75,this.done=i<0};U.__name__=!0,U.__super__=D,U.prototype=e(D.prototype,{update:function(t){_.c.lineWidth=3,_.c.strokeStyle="#FF0",_.c.globalAlpha=Math.max(0,this.a),_.c.beginPath(),_.c.moveTo(540,960),_.c.lineTo(this.x,this.y),_.c.stroke(),_.c.globalAlpha=1,this.pt.update(t),this.done&&!this.pt.hasAlive()&&(this.alive=!1)},play:function(){var i=this;return this.done?Promise.resolve(this):Y.start(this,{x:this.tx,y:this.ty},.2).then(function(t){i.applyEffect(),c.uncurse();for(var e=0;e<13;){e++;var n=Math.random()*(2*Math.PI),s=30.75*Math.random();i.pt.add(new X(i.tx+Math.cos(n)*s,i.ty+Math.sin(n)*s))}return Y.start(i,{a:0},.2)}).then(function(t){return i.done=!0,i})}});var G=function(t,e,n){this.coinManager=new r,D.call(this,t,e,n),this.y=1==t?1010:880,this.x=1==t?116.25:951.25};function j(t,e){return null==e?null:(null==e.__id__&&(e.__id__=s.$haxeUID++),null==t.hx__closures__?t.hx__closures__={}:n=t.hx__closures__[e.__id__],null==n&&(n=e.bind(t),t.hx__closures__[e.__id__]=n),n);var n}G.__name__=!0,G.__super__=D,G.prototype=e(D.prototype,{update:function(t){this.coinManager.update(t),this.alive=this.coinManager.hasAlive()},play:function(){var e=this;return this.applyEffect(),c.loseCoin(),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new N(this.x,this.y)),this.coinManager.add(new W(this.x,this.y,"-8","50px sans-serif","#F00")),A.sec(.5).then(function(t){return e})}}),s.$haxeUID|=0,"undefined"!=typeof performance&&"function"==typeof performance.now&&(p.now=performance.now.bind(performance)),String.__name__=!0,Array.__name__=!0,T.__toStr={}.toString,l.repo=new Map,_.TITLE="13 Curses",_.l=0,_.tm=new r,y.loaded=!1,y.cardLoadQueue=[],y.loadNext=!0,S.COST=[3,2,2,3,2,4,2,3],S.DECK=[[30,20,10],[15,7,3],[10,5,2],[20,10,5],[15,7,3],[20,10,5],[20,10,5],[20,10,5]],S.COLOUR=["F70","E48","CE0","87E","E44","8C4","FC0","04F"],S.FUNC=[function(t,e){e.curses++},function(t,e){t.curses++},function(t,e){e.curses=0|Math.max(0,e.curses-1)},function(t,e){t.curses=0|Math.max(0,t.curses-1)},function(t,e){e.curses--,t.curses++},function(t,e){e.curses++,t.curses--},function(t,e){t.points+=4},function(t,e){e.points=0|Math.max(0,e.points-8)}],S.FACE=[["pf0f1135093|sf0f355ðŸ”¥","pf0f1135093|sf0f335ðŸ”¥|sf0f375ðŸ”¥","pf0f1135093|sf0f337ðŸ”¥|sf0f355ðŸ”¥|sf0f377ðŸ”¥"],["pf0f1165996|sf0f354ðŸ”¥","pf0f1165996|sf0f334ðŸ”¥|sf0f374ðŸ”¥","pf0f1165996|sf0f334ðŸ”¥|sf0f352ðŸ”¥|sf0f374ðŸ”¥"],["pf0f1135093|sf0f355ðŸ”¥|p00012488|p00018428","pf0f1135093|sf0f335ðŸ”¥|sf0f375ðŸ”¥|p00012488|p00018428","pf0f1135093|sf0f337ðŸ”¥|sf0f355ðŸ”¥|sf0f377ðŸ”¥|p00012488|p00018428"],["pf0f1165996|sf0f354ðŸ”¥|p00013276|p00017236","pf0f1165996|sf0f334ðŸ”¥|sf0f374ðŸ”¥|p00013276|p00017236","pf0f1165996|sf0f334ðŸ”¥|sf0f352ðŸ”¥|sf0f374ðŸ”¥|p00013276|p00017236"],["sf0f365ðŸ”¥|pf0f12922|pf0f1182938","sf0f363ðŸ”¥|sf0f367ðŸ”¥|pf0f12922|pf0f1182938","sf0f354ðŸ”¥|sf0f371ðŸ”¥|sf0f377ðŸ”¥|pf0f12922|pf0f1182938"],["sf0f365ðŸ”¥|pf0f12922|pf0f1132233","sf0f363ðŸ”¥|sf0f367ðŸ”¥|pf0f12922|pf0f1132233","sf0f354ðŸ”¥|sf0f371ðŸ”¥|sf0f377ðŸ”¥|pf0f12922|pf0f1132233"],["s000354ðŸ’°|s000357+4","s000354ðŸ’°ðŸ’°|s000357+8","s000354ðŸ’°ðŸ’°ðŸ’°|s000357+12"],["s000356ðŸ’°|s000352-8","s000356ðŸ’°ðŸ’°|s000352-16","s000356ðŸ’°ðŸ’°ðŸ’°|s000352-24"]],E.X=0,E.Y=0,E.C=!1,E.D=!1,E.GESTURE=0,E.mTouch=-1,E.tsx=0,E.tsy=0,_.main()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this)</script>