<!doctype html><meta name=viewport content="width=device-width,maximum-scale=1,minimum-scale=1"><title>Biralo - js13kGames 2025</title><style>*{margin:0;padding:0}body{overflow:hidden;user-select:none;background-color:#272d37;width:100%;height:100%}canvas{image-rendering:auto;image-rendering:crisp-edges;image-rendering:pixelated;pointer-events:auto;display:block;outline:0;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}#bg{background-color:#1a1c2c}</style><body><script>var e=Math.pow;function $(e){return e+"px"}var t={};function A(e){if(!t[e]){let $=document.createElement("canvas"),A=$.getContext("2d");t[e]={canvas:$,ctx:A}}return t[e]}function i(e){t[e]&&delete t[e]}var a=0;function l(){return a+=1}function n(e,$,t=1,A=1){var i=e.x<$.x+$.width*t&&e.x+e.width*t>$.x,a=e.y<$.y+$.height*A&&e.y+e.height*A>$.y;return i&&a}function d(e,$){return e.findIndex(e=>e.uid===$.uid)}function r(e,$){let t=e.x+e.width*e.pvx,A=e.y+e.height*e.pvy;e.roundPixels&&(t=e.x+e.width*e.pvx|0,A=e.y+e.height*e.pvy|0),$.setTransform(e.scx,0,0,e.scy,t,A)}function s(){let e=1,$={x:0,y:0,alpha:1,width:0,height:0,scx:1,scy:1,pvx:0,pvy:0,rot:0,visible:!0,uid:l(),gx:0,gy:0,detach(){$.parent&&$.parent.remove($)},render(){},update(){}};return Object.defineProperties($,{alpha:{get:()=>$.parent?$.parent.alpha*e:e,set($){e=$}},gx:{get:()=>$.parent?$.x+$.parent.gx:$.x},gy:{get:()=>$.parent?$.y+$.parent.gy:$.y}}),$}function o(e,$,t,A=0,i=0){let a=$.frames,l=$.w,n=$.palette,d=a.split("|")[t];d=d.replace(/(\D)(\d+)/g,(e,$,t)=>$.repeat(t)),[...d].forEach(($,t)=>{let a=n[$];if(void 0===a)return;let d=t%l,r=Math.floor(t/l);e.fillStyle=a,e.fillRect(d+A,r+i,1,1)})}function h(e,$=!0,t=!0){let i=e.frames,a=e.fps,l=i.split("|").length,n=s(),d=n.detach,h=0,B=0,c=$,f=Array.from({length:l},(e,$)=>A(n.uid+"_"+$)),g=Object.assign(n,{texture:e,loop:t,roundPixels:!0,render(e){if(!g.visible||!g.texture)return;let $=f[h],t=$.canvas,A=$.ctx;if($.cached)return r(g,e),void e.drawImage(t,0,0);$.cached=!0,t.width=e.canvas.width,t.height=e.canvas.height,o(A,g.texture,h),r(g,A)},update(){if(c){if(!g.loop&&h==l-1)return g.stop(),void(g.onComplete&&g.onComplete(g.name));for(B+=ce.timer.fdt;B*a>=1;)h=++h%l,B-=1/a}},start(e=0){g.playing||(p(),u(e),c=!0)},stop(e){u(e),c=!1},destroy(){p()},detach(){d(),p()}});function p(){g.stop(),c=!1,h=0,B=0}function u(e){h=void 0!==e?e:h}return Object.defineProperties(g,{playing:{get:()=>c},currentFrame:{get:()=>h},totalFrames:{get:()=>l}}),e&&(g.width=e.w,g.height=e.h),g}function B(e,$,t,A,i="#000"){let a=s(),l=Object.assign(a,{color:i,x:e,y:$,width:t,height:A,render(e){l.visible&&(e.fillStyle=l.color,e.fillRect(l.x,l.y,l.width,l.height),r(l,e))}});return l}function c(){let e=Object.assign(function(){let e=0,$=0,t=[],A=Object.assign(s(),{children:t,add(e){e.parent&&e.detach(),e.parent=A,A.children.push(e),i()},addAt(e,$){e.parent&&e.detach(),e.parent=A,t.splice($,0,e),i()},swap(e,$){if(e.uid===$.uid)return;let A=d(t,e),i=d(t,$);A<0||i<0||(t[A]=$,t[i]=e)},remove(e){e.parent&&e.parent.uid===A.uid&&(function(e,$){for(var t=$.length;t>=0;t--)if($[t]===e)return $.splice(t,1),$}(e,A.children),e.parent=null,i())},removeAll(){t.forEach(e=>{A.remove(e)}),t.length=0,i()},render(e){t.forEach($=>{e.globalAlpha=$.alpha,r(A,e),$.render&&$.render(e),A.onEachRender&&A.onEachRender($)})},update(){t.forEach(e=>{e.update&&e.update()})},destroy(){t.forEach(e=>{e.destroy&&e.destroy()}),A.removeAll()}});function i(){t.length>0&&(e=0,$=0,t.forEach(t=>{t.x+t.width>e&&(e=t.x+t.width),t.y+t.height>$&&($=t.y+t.height)}),A.width=e,A.height=$)}return A}(),{isStage:!0,name:"stage"});return{uid:l(),stage:e,render($){e.render($)},update(){e.update()},destroy(){e.destroy()}}}function f(){let e;return{set($){e&&e.destroy(),e=$()},render($){let t=$.canvas;e?($.setTransform(1,0,0,1,0,0),$.clearRect(0,0,t.width,t.height),e.render($)):$.clearRect(0,0,t.width,t.height)},update(){e&&e.update()},clear(){e&&e.destroy(),e=null}}}var g={};function p(){for(let e in g)g[e]&&g[e].kill()}function u(e=0){let $=l(),t=ce.timer,A=!0,i=t.time,a=t.time,n={dt:0,uid:$,_update(){a=t.time},kill(){A=!1,delete g[$]},reset(){i=t.time}};return Object.defineProperties(n,{dt:{get:()=>t.time-i-e},running:{get:()=>A}}),g[$]=n,n}function C(e,$){let t=u(e),A=t._update,i=t.kill;return t.kill=()=>{i(),$&&$()},t._update=()=>{t.running&&t.dt>e&&t.kill(),A()},t}var D=[{name:"background",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,tileset:"tileset",data:[13,16,13,12,16,12,12,12,13,13,14,12,12,15,16,12,12,16,12,12,12,16,12,16,4,-1,-1,2,25,3,24,12,28,4,28,12,-1,-1,-1,-1,-1,-1,-1,-1,3,-1,2,-1,9,-1,-1,7,9,-1,-1,-1,-1,8,-1,-1,18,18,22,16,22,0,0,0,22,15,18,18,4,28,3,24,2,1,1,4,4,1,4,1,1,3,3,2,-1,-1,3,4,4,1,-1,0,-1,4,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]},{name:"collision",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"platform",id:1,x:-8,y:0,width:8,height:48},{name:"platform",id:2,x:96,y:0,width:8,height:48},{name:"platform",id:8,x:0,y:40,width:40,height:8},{name:"platform",id:14,x:56,y:16,width:8,height:8},{name:"platform",id:15,x:88,y:16,width:8,height:8},{name:"platform",id:16,x:64,y:40,width:32,height:8}]},{name:"entities",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"player",id:10,x:8,y:32,width:8,height:8},{name:"exit",id:11,x:0,y:88,width:96,height:8},{name:"fireflies",id:12,x:24,y:16,width:24,height:24},{name:"alice",id:13,x:72,y:24,width:16,height:16},{name:"fallingTiles",id:14,x:40,y:32,width:24,height:24}]},{name:"texts",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"text",id:0,x:0,y:80,width:8,height:8,values:{text:"'A' and 'D' to Move",name:"",visible:!0}}]}],m=[{name:"background",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,tileset:"tileset",data:[3,0,0,12,16,12,14,12,12,12,13,12,-1,4,4,4,1,1,25,3,28,12,15,13,-1,-1,-1,2,0,-1,-1,3,4,4,24,2,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,2,-1,9,-1,8,9,-1,-1,4,-1,-1,-1,-1,-1,18,18,19,22,-1,2,2,0,-1,-1,-1,-1,12,28,25,12,-1,-1,-1,-1,-1,-1,-1,15,13,3,2,12,-1,-1,-1,10,-1,-1,-1,12,3,-1,2,15,11,5,21,22,22,20,12,13,-1,-1,-1,23,17,23,23,3,27,0,0,12,-1,-1,-1,3,1,-1,-1,-1,-1,2,4,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]},{name:"collision",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"platform",id:1,x:-8,y:0,width:8,height:56},{name:"platform",id:2,x:104,y:-8,width:8,height:88},{name:"platform",id:5,x:88,y:48,width:16,height:32},{name:"platform",id:8,x:0,y:40,width:32,height:8},{name:"platform",id:9,x:24,y:48,width:8,height:24},{name:"platform",id:10,x:48,y:64,width:40,height:8},{name:"platform",id:15,x:16,y:72,width:48,height:16}]},{name:"entities",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"player",id:10,x:8,y:8,width:8,height:8},{name:"hurt",id:11,x:32,y:64,width:16,height:8},{name:"exit",id:13,x:96,y:16,width:8,height:32},{name:"totem",id:14,x:72,y:40,width:24,height:24,values:{flipH:-1,attackTime:3}}]},{name:"texts",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"text",id:0,x:24,y:80,width:8,height:8,values:{text:"'K' to Jump",name:"",visible:!0}},{name:"text",id:1,x:24,y:88,width:8,height:8,values:{text:"'J' to Attack",name:"",visible:!0}}]}],y=[{name:"background",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,tileset:"tileset",data:[13,13,12,12,16,12,12,12,13,13,14,12,12,15,12,13,12,16,12,12,12,16,12,16,-1,-1,-1,2,25,3,24,-1,28,4,28,1,-1,-1,-1,-1,-1,-1,-1,-1,3,-1,4,-1,-1,10,-1,-1,-1,3,-1,-1,-1,-1,-1,-1,18,21,12,-1,2,-1,-1,-1,-1,-1,-1,-1,12,28,24,-1,-1,-1,2,13,0,-1,-1,12,13,3,2,5,11,11,11,11,5,11,11,12,16,-1,-1,23,23,23,23,17,23,17,23,13,2,-1,-1,1,28,3,-1,-1,27,2,1,1,-1,-1,-1,3,-1,-1,-1,-1,-1,-1,4,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]},{name:"collision",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"platform",id:1,x:-8,y:0,width:8,height:64},{name:"platform",id:2,x:104,y:-8,width:8,height:80},{name:"platform",id:8,x:0,y:40,width:24,height:32},{name:"platform",id:10,x:24,y:64,width:64,height:8},{name:"platform",id:14,x:88,y:48,width:16,height:24},{name:"platform",id:15,x:56,y:48,width:8,height:8}]},{name:"entities",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"player",id:10,x:0,y:32,width:8,height:8},{name:"torch",id:11,x:32,y:32,width:8,height:8},{name:"hurt",id:12,x:24,y:56,width:64,height:8},{name:"torch",id:13,x:72,y:24,width:8,height:8},{name:"exit",id:14,x:96,y:16,width:8,height:32}]},{name:"texts",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"text",id:0,x:24,y:80,width:8,height:8,values:{text:"'J' to Swing",name:"",visible:!0}}]}],x=[{name:"background",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,tileset:"tileset",data:[1,2,2,1,4,1,4,12,13,13,14,12,2,-1,13,12,12,16,12,12,12,16,12,16,-1,-1,-1,2,25,3,24,0,28,4,28,12,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,12,-1,-1,-1,7,9,-1,-1,0,-1,-1,-1,13,18,18,22,16,22,-1,2,0,0,-1,-1,12,12,28,3,24,11,11,-1,-1,10,-1,-1,12,13,3,-1,2,17,23,15,21,22,-1,-1,12,16,-1,-1,-1,28,3,-1,0,27,-1,-1,13,12,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,12,13,-1,-1,-1,-1,8,2,-1,3,-1,-1,16,12,-1,14,12,12,21,11,11,5,14,12,16]},{name:"collision",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"platform",id:0,x:0,y:104,width:80,height:8},{name:"platform",id:1,x:-8,y:-8,width:8,height:56},{name:"platform",id:4,x:16,y:8,width:48,height:8},{name:"platform",id:5,x:88,y:16,width:8,height:72},{name:"platform",id:6,x:16,y:88,width:32,height:16},{name:"platform",id:8,x:0,y:40,width:40,height:8},{name:"platform",id:10,x:32,y:56,width:40,height:8},{name:"platform",id:13,x:0,y:48,width:8,height:56},{name:"platform",id:14,x:72,y:88,width:24,height:24}]},{name:"entities",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"player",id:10,x:0,y:32,width:8,height:8},{name:"boulder",id:11,x:40,y:-8,width:16,height:16,values:{flipH:-1}},{name:"totem",id:12,x:16,y:64,width:24,height:24,values:{flipH:1,attackTime:3}},{name:"torch",id:13,x:56,y:80,width:8,height:8},{name:"hurt",id:14,x:48,y:88,width:24,height:16},{name:"hurt",id:15,x:32,y:48,width:16,height:8},{name:"exit",id:16,x:8,y:96,width:8,height:8}]},{name:"reversers",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"reverser",id:0,x:0,y:32,width:8,height:8,values:{side:1}},{name:"reverser",id:1,x:48,y:48,width:8,height:8,values:{side:1}},{name:"reverser",id:2,x:80,y:80,width:8,height:8,values:{side:-1}}]},{name:"stoppers",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"stopper",id:0,x:56,y:96,width:8,height:8}]},{name:"triggers",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"trigger",id:0,x:8,y:16,width:8,height:24,nodes:[{x:40,y:-8}],values:{delay:0}}]}],E=[{name:"background",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,tileset:"tileset",data:[15,-1,13,12,13,12,5,11,5,13,15,12,12,-1,13,12,12,13,12,12,12,16,12,14,13,-1,0,28,2,28,4,28,27,2,2,13,16,-1,-1,-1,-1,-1,-1,2,-1,-1,-1,12,12,-1,4,4,-1,-1,-1,-1,-1,-1,4,12,12,-1,-1,1,4,0,-1,-1,2,-1,0,15,13,-1,4,-1,2,-1,-1,-1,-1,1,0,16,12,-1,-1,-1,-1,-1,-1,-1,-1,4,-1,13,13,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,14,15,-1,-1,8,10,-1,-1,-1,8,-1,-1,13,13,13,13,22,22,12,14,15,22,19,22,15,28,27,3,-1,2,1,1,3,4,1,3,28]},{name:"collision",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"platform",id:1,x:0,y:0,width:8,height:80},{name:"platform",id:2,x:88,y:0,width:8,height:80},{name:"platform",id:8,x:0,y:80,width:96,height:8}]},{name:"entities",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"player",id:10,x:8,y:8,width:8,height:8},{name:"frog",id:11,x:72,y:64,width:16,height:16}]}],v=[{name:"background",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,tileset:"tileset",data:[15,14,13,12,13,12,12,12,15,13,15,12,12,15,13,12,12,13,12,12,12,16,12,14,4,28,0,2,-1,-1,28,2,28,4,28,25,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,3,9,-1,-1,8,8,-1,-1,-1,-1,-1,-1,10,21,18,18,22,22,12,13,12,22,19,22,21,28,27,3,-1,2,1,1,3,4,1,3,28,3,3,3,-1,-1,-1,3,3,-1,-1,4,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]},{name:"collision",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"platform",id:1,x:-8,y:0,width:8,height:48},{name:"platform",id:2,x:96,y:0,width:8,height:48},{name:"platform",id:8,x:0,y:40,width:96,height:8}]},{name:"entities",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"player",id:10,x:8,y:32,width:8,height:8},{name:"alice",id:13,x:72,y:24,width:16,height:16}]},{name:"texts",gridCellWidth:8,gridCellHeight:8,gridCellsX:12,gridCellsY:12,entities:[{name:"text",id:0,x:32,y:64,width:8,height:8,values:{text:"The End",name:"",visible:!1}},{name:"text",id:1,x:24,y:80,width:8,height:8,values:{text:"'R' to Restart",name:"",visible:!1}}]}],w=(()=>{let $=!1,t=new AudioContext,A=t.createGain(),i=[],a=[],l=!0;["focus","blur"].map(e=>{window.addEventListener(e,()=>{l=e.includes("f"),r(!l)})});let n={punch(e){if(e>2e4)return null;var $=function(e){return(2e4-e)/2e4}(e);return 33&Math.pow(30*e,.3)?$:-$},lash:e=>(2*Math.random()-1)*Math.sin(e/50)*Math.exp(-e/5e3),landed:e=>.8*(2*Math.random()-1)*Math.exp(-e/800)};function d(){i.forEach(e=>e.close()),i.length=0,a.forEach(e=>clearTimeout(e)),a.length=0,$=!1}function r(e=!0){i.forEach($=>e?$.suspend():$.resume())}function s($){d(),function($,t,A,a,l,n){let d=new AudioContext,r=d.createGain();[[0,14],[1,14],[2,11],[3,9],[4,14],[5,14],[6,11],[7,9],[8,14],[9,14],[10,11],[11,9],[12,9],[13,9],[14,14],[15,16],[16,6],[17,11],[18,11],[19,14],[20,14],[21,9],[22,14],[23,9],[24,16],[25,6],[26,14],[27,11],[28,9],[29,6],[30,16],[31,6],[32,6],[33,9],[34,14],[35,14],[36,9],[37,11],[38,11],[39,14]].forEach(function($){var t=d.createOscillator();t&&(t.connect(r),r.connect(d.destination),t.start($[0]*n),t.frequency.setValueAtTime(100*e(1.06,13-$[1]),$[0]*n),t.type="sawtooth",r.gain.setValueAtTime(.008,$[0]*n),r.gain.setTargetAtTime(1e-5,$[0]*n+.005,.2),t.stop($[0]*n+.1))}),i.push(d)}(0,0,0,0,0,.18),l||r();let t=setTimeout(()=>s($),$);a.push(t)}return{play:function(e){var $=n[e];$&&function(e,$){A.gain.value=$||1,A.connect(t.destination);let i=t.createBuffer(1,96e3,48e3),a=i.getChannelData(0);for(var l=96e3;l--;)a[l]=e(l);let n=t.createBufferSource();n.buffer=i,n.connect(A),n.start()}($,"punch"===e?.05:.1)},music:function(){$||($=!0,function(){let e=setTimeout(()=>s(7e3),1e3);a.push(e)}(),r(!1))},killMusic:d}})(),b={w:16,h:16,frames:"$38A2B3A2$9A1C1B3A1C1$9B8$8B1D7$7B2E6B1$7B2E6B1$7B2E6B1D1$4B2D1B1E6D2$2B4D2E7B1$2B1D1B2E9B1$2B1D2B1E9B1$2B1D1$3E7B2$2B1D1$10B2$1D4$9D3|$6A1C1B3A1C1$9A2B3A2$9B8$8B1D7$7B2E6$8B2E6B1$6B3E6B2$5D2E7B1D1$6E8$8B1E7$7B2E7B1$6B3E5B2$6B3$5B2$6B3$5B2$6B3$5B2$5D4$5D3$1",palette:{A:"#ffcd75",B:"#38b764",C:"#29366f",D:"#257179",E:"#a7f070"},fps:4},k={w:16,h:16,frames:"$71A5$10B2A3B2$9B1C1A3B1C1$9A8$8A1D7$7A3E5$5A2$1A3E5$5A1D1A2D1A1E5A1$4A1D1A1D2A1E5A1$4A1D1E2A2E5A1$4A1D1E2A2E5A1$3D4E1A1D3E2D3$1|$70B1C1A3B1C1$9B2A3B2$9A8$8A1D7$7A2E6$8A2E7$4A2$1A2E7$4A1D1A2D1E7$4A1D1A1D2E7$4A1D1E2A1E7$4A1D1E2A1E7$3D4E1A1D2E3D3$1",palette:{A:"#38b764",B:"#ffcd75",C:"#29366f",D:"#257179",E:"#a7f070"},fps:4},F={w:16,h:16,frames:"$5A6$9A1B6A1$6B12$2B16$1B14$2B14$2B14$2B3C3B2C3B3$2B2C4B2C4B2$2B2C10B2$3B1C10B1$4B2C3B2C3B2$4B12$3B4$6B4$1A1B2$10B2A1$1A1$12A1$1|$21A6$6B1$2B8$2B1$3B12$4B12$4B12$4B12$4B12$4B12$4B2C3B3C3B1$4B1C4B3C4$4B1C11$4B1C11$4B2C3B3C3B1$4B12$3A1B1$10B1A1$1",palette:{A:"#257179",B:"#38b764",C:"#a7f070"},fps:4},H={w:16,h:16,frames:"$40A5$10B1C1A3B1C1$9B1C1A3B1C1$8A2D7$7A2C7$7A2C7$7A2C7$6A3C7$3A6C7$3A2D1A3E5C2$3A2D1A2D1E6C1$3A2D1F1D9$3A2D1F2A2F5A1$2D5F1A1D3F2D3|$71A5$10B1C1A3B1C1$9B1C1A3B1C1$9A8$8A1D7$7A2C7$4A2$1A2E5C2$4A1D1A2D1E6C1$4A1D1A1D9$4A1D1F2A2F5A1$4A1D1F2A2F5A1$3D4F1A1D3F2D3$1",palette:{A:"#38b764",B:"#ffcd75",C:"#29366f",D:"#257179",E:"#ef7d57",F:"#a7f070"},fps:4};function I(e){let $={name:e,type:e,x:0,y:0,width:0,height:0,addTo(e,t){void 0!==t?(e.addAt($.body,t),e.addAt($.skin,t)):(e.add($.body),e.add($.skin)),$.parent=e},setBody(e,t,A){$.body.width=e,$.body.height=t,$.body.color=A||$.body.color},update(){$.skin.x=$.body.x,$.skin.y=$.body.y,$.body.update(),$.skin.update()},render(e){},kill(){$.body.detach(),$.skin.detach(),$.parent=null,$.reserved=!1},attachProps:function(){Object.defineProperties($,{x:{set(e){$.body.x=e},get:()=>$.body.x},y:{set(e){$.body.y=e},get:()=>$.body.y},width:{set(e){$.body.width=e},get:()=>$.body.width},height:{set(e){$.body.height=e},get:()=>$.body.height},scx:{set(e){$.body.scx=e},get:()=>$.body.scx},active:{get:()=>!(!$.body.parent||!$.skin.parent),configurable:!0,enumerable:!0}})}};return $}function G(e,$=0,t=0,A="#fff"){let i=B(0,0,$,t,A);i.name=`${e}.body`;let a=I(e),d=Object.assign(a,{uid:l(),width:$,height:t,health:1,alpha:1,vx:0,vy:0,sx:.8,jForce:2,flipH:1,dg:.5,jg:.2,g:.5,body:i,setVisible(e,$){d.body.visible=e,d.skin.visible=$},update(){d.body.update(),d.updateSkin(),d.vy+=d.g,d.y+=d.vy,d.x+=d.vx,!d.grounded&&d.vy>0&&(d.falling=!0),d.grounded&&d.falling&&(d.onLanded(),d.falling=!1)},render(e){d.body.render(e),d.skin.render(e)},addSkin($){d.skin=function(e){var $;let t,A={};for(let i in e){let a=e[i],l=h(a.texture,!1);l.loop=null!=($=a.loop)?$:l.loop,l.name=i,A[i]=l,t=l}let i=s(),a=Object.assign(i,{render(e){!a.visible||!t||t.render(e)},update(){t.update(),function(){for(let e in A){let $=A[e];l(a,$)}}()},play(e,$){(function(e){return t&&t.playing&&e===t.name})(e)||(t&&(t.stop(),t.onComplete=null),t=A[e],t.onComplete=e=>{a.onComplete&&a.onComplete(e)},t.start($))},stop(e){t&&t.stop(e)}});function l(e,$){["x","y","alpha","width","height","scx","scy","pvx","pvy","rot","visible"].forEach(t=>{$[t]=e[t]})}return Object.defineProperties(a,{width:{get:()=>t.width},height:{get:()=>t.height}}),a}($),d.skin.name=`${e}.skin`},vsPlatforms(e){e.forEach(e=>{var $=function(e,$){let t=e.x+e.width/2-($.x+$.width/2),A=e.y+e.height/2-($.y+$.height/2),i=(e.width+$.width)/2,a=(e.height+$.height)/2,l={side:"",overlap:null};return Math.abs(t)<i&&Math.abs(A)<a&&(l.overlap={x:i-Math.abs(t),y:a-Math.abs(A)},l.overlap.x>=l.overlap.y?l.side=A>0?"t":"b":l.side=t>0?"l":"r"),l.hit=!!l.side,l}(d.body,e);$.hit&&("b"===$.side?(d.g=d.dg,d.y=d.y-$.overlap.y,d.resetVy()):"t"===$.side?(d.y=d.y+$.overlap.y,d.resetVy()):"r"===$.side?(d.x=d.x-$.overlap.x,d.vx-=d.sx):"l"===$.side&&(d.x=d.x+$.overlap.x,d.vx+=d.sx),d.grounded="b"===$.side,d.onWall="r"===$.side||"l"===$.side)})},vsHurts(e){for(let $=0;$<e.length;$++){let t=e[$];if(n(d.body,t,1,.1)){d.receiveDamage(1,t);break}}},addSfx(e,$,t){let A=ge.sfxPool.get(e);A&&(d.parent.addAt(A,3),A.x=null!=$?$:d.x+d.width/2-A.width/2,A.y=null!=t?t:d.y+d.height-A.height,A.start(0))},receiveDamage(e,$){d.dead||(d.health-=e,d.onDamage(),d.health<=0&&(d.health=0,d.kill()))},onDamage(){},doFlipH(){d.flipH*=-1},kill(){d.dead=!0},reset(){d.skin&&d.skin.stop(),d.parent=null,d.flipH=1,d.health=1,d.dead=!1,d.moving=!1,d.grounded=!1,d.onWall=!1,d.jumping=!1,d.falling=!1,d.attacking=!1,d.resetVx(),d.resetVy(),d.resetGrav()},detach(){d.skin.stop(),d.skin.detach(),d.body.detach(),d.parent=null,d.reserved=!1},resetVx(){d.vx=0},resetVy(){d.vy=0},voidGrav(){d.g=0},resetGrav(){d.g=d.dg},isFlipH:()=>-1===d.flipH,onLanded(){},updateSkin(){let e=d.skin;e&&(d.flipHSkinDisabled?e.x=d.body.x:(e.scx=d.flipH,e.x=d.body.x+d.body.width,d.isFlipH()?e.x=d.body.x+d.body.width:e.x=d.body.x),e.y=d.body.y,e.update())}});return d.attachProps(),Object.defineProperties(d,{active:{get:()=>d.skin.parent&&d.body.parent&&!d.dead&&d.skin.visible,configurable:!0,enumerable:!0}}),d}var j={sceneIndex:1,endSceneIndex:6,lockedMovement:()=>j.sceneIndex===j.endSceneIndex||1===j.sceneIndex,reset(){j.gWon=!1}},S={w:8,h:8,frames:"A1$2B5$1A1$2B1C1B1C1$1B7$1A1B2A2B1$1A2$4A3$23|$12B1$2B1$4B4$2A1$1B1C1B1C1$1A1$2B1C1B1C1$1B7$1A1B3A1$4A1$1A1$3",palette:{A:"#3b5dc9",B:"#29366f",C:"#73eff7"},fps:6},T={w:8,h:8,frames:"$3A3$4B1C1B1C1B1$2A1B1C1B1C1B1A1$2B5$2B1A5B1$3A3$4A1B1$1B1$3A1$1B1$1B1$2|$3C1A1C1$3A1B1C1B1C1B1A1$2B5$3B5$2B1A5B1$3B1A2$4A1B1$1B1$4A1B1$1B1$2",palette:{A:"#29366f",B:"#3b5dc9",C:"#73eff7"},fps:4},P={w:8,h:8,frames:"$2A1$3B1$3A2B3$3A1C1A2D1$3A5$4B2A1$2B1$2A3B1$2B1A4$5B1$1B1$2|$2A1$3B1$3A2B3$3A5$3A1C1A2D1$4A3B1$2B1$1B1A2$3B1A4$5B1$1B1$2",palette:{A:"#29366f",B:"#3b5dc9",C:"#41a6f6",D:"#73eff7"},fps:4},W={w:8,h:8,frames:"$2A1$3A1$3B1C1B1C1B1$2A1B1C1B1C1B1A1$2A1B3A1$1A1$2B3$3A1B4$4A2B1A2$3A1$3A1$1|$3A1$1A1$4B5$2A1B1C1B1C1B1A2$1A1C1B1C1A1$2A1$1B3$4A2B1A2$3A1$3A1$9",palette:{A:"#3b5dc9",B:"#29366f",C:"#73eff7"},fps:4},O={w:8,h:8,frames:"$1A1$3B1$3A2B3$3A1C1A2D1$3A5$4A3$6A1B1A1B1$3B1A3$5B1$1B1$2|$2A1$3B1$3A2B3$3A1C1A2D1$3A5$4A1B1A1$5A3B1$3B1A3$5B1$1B1$2|$4A1$2B1$4A2B2$4A4$4A1C1A1D1$3A3$5A1B1A1B1$3B1A3$5B1$1B1$2|$4A1$2B1$4A2B2$4A4$4A1C1A1D1$3A3$5A1B1A1B1$3B1A3$5B1$1B1$2|$4A1$2B1$4A2B2$4A1C1A1D1$4A4$3A1B1A1B1$3B1A3$3B1$1A3$5B1$1B1$2",palette:{A:"#29366f",B:"#3b5dc9",C:"#41a6f6",D:"#73eff7"},fps:10},V={w:24,h:24,frames:"$201A5$20B1C1B1C1$20B2A2C3$17B1A1B4C1$16A1B1A2C3$17A1B5$19B1A1B1A1$19A6$18A1B5$18B2C1B2C1$18B6$16D2B2A4D2$14E1D1B2A1C2A1D1E1$15D1B2A1C2A1D1$17B2A4$19A1B1A1B1$10",palette:{A:"#ef7d57",B:"#ffcd75",C:"#b13e53",D:"#f4f4f4",E:"#41a6f6"},fps:8},X={w:24,h:24,frames:"$153A5$20B1C1B1C1$20B2A2C3$17B1A1B4C1$16A1B1A2C3$17A1B5$19B1A1B1A1$67A6$18A1B5$18B2C1B2C1$18B6$16D2B2A4D2$14E1D1B2A1C2A1D1E1$15D1B2A1C2A1D1$17B2A4$19A1B1A1B1$10|$81A5$20B1C1B1C1$20B2A2C3$17B1A1B4C1$16A1B1A2C3$17A1B5$19B1A1B1A1$139A6$18A1B5$18B2C1B2C1$18B6$16D2B2A4D2$14E1D1B2A1C2A1D1E1$15D1B2A1C2A1D1$17B2A4$19A1B1A1B1$10|$58A1$1A2$20A1$1A2$20A4$19A5$19A2C1A1C1$20A1C1A1C1$19A2C1A1C1$20B1C1A1C3$18B2A5$17B1A1B4C1$16A1B1A2C3$17A1B5$19B1A1B1A1$19A6$18A1B5$18B2C1B2C1$18B6$16D2B2A4D2$14E1D1B2A1C2A1D1E1$15D1B2A1C2A1D1$17B2A4$19A1B1A1B1$10|$249A5$20B1C1B1C1$20B2A2C3$17B1A1B4C1$16A1B1A2C3$17A1B5$19B1A1B1A1$18A4C1A2C1$16B8$14D4B1A1C4D2$12E1D1E1D1B1C5D1E1$13D1B1D1B1C5D1$15B8$18B1A1B1A1$10|$201A5$20B1C1B1C1$20B2A2C3$17B1A1B4C1$16A1B1A2C3$17A1B5$19B1A1B1A1$19A2C1A2C1$18B6$18B1A1C4$18B1C5$16D2B1C5D2$14E1D1B1C5D1E1$15D1B1C5D1$17B6$19A1B1A1B1$10",palette:{A:"#ef7d57",B:"#ffcd75",C:"#b13e53",D:"#f4f4f4",E:"#41a6f6"},fps:8},Y={w:8,h:8,frames:"$12A1$1A1$3A1$1A2$5B1C1B1$5D2E1$6B1$7B1$7D1$3|$6A1$5C1A1$5A1C1$1A1$4A1C1B1$5D1E2$6B1$7B1$7D1$3|$4A1$7A1B1$6C1A1$5B1A1B1$5D2E1$6B1$7B1$7D1$3",palette:{A:"#ef7d57",B:"#b13e53",C:"#ffcd75",D:"#566c86",E:"#333c57"},fps:4},J={w:24,h:24,frames:"$387A2$21A1$2A1$20A1$2A1$20A1$2A1$20A1$2A1$21A1$2A1$20A1$2A1$17A3$4A1$16|$434A3$20A1$3A1$19A1$3A1$18A1$5A1$23A1$41|$455A1$21A3$15A6$10A8$15A1$41|$479A1$15A9$7A8$15A1$41",palette:{A:"#3b5dc9"},fps:10},K={w:8,h:8,frames:"$36A1B1A1$5A3$6A1$10|B1A1$1A1B1$3A2B1A2$3A5$4A3$6B1$29",palette:{A:"#b13e53",B:"#5d275d"},fps:2},M={w:24,h:24,frames:"$347A1$175A1$9A1$42|$205A1$219A1$34A1$115|$87A1$244A1$32A1$210|$257A1$37A1$214A1$65|$163A1$33A1$341A1$36|$101A1$62A1$176A1$103A1$130|$250A1$246A1$78",palette:{A:"#ffcd75"},fps:4},L={w:24,h:24,frames:"$115A1$23B1$21A1$1B1C1$20A1C3A1$2D2C1A2B1A1B1D17E1C1A1B4D1E6F1D1E6F1D1E1C2B4D1E6F1D1E6F1E1F1E1C2B2C1D1E6F1D1E6F1E1F1E2F1C2F1D1E6F1D1E6F2E2F1E2F2D1E6F1D1E6F2E1F2E3F1D1E6F1D1E6F9D1F7D1F7$192|$163A1$23B1$4D2C1$16B1C1$3D1E1C1$16C2A1$2D1E1C1$16D5E1F1E1$16E4F1E1F1E1A2B1A1B1$9A1$1E4F2E2A1B4$9A1C1E4F2E1F1C1B4$8D3E4F4C2B2C1$8D1E6F1$3E1F1C2F1D9E6F1$3F1E2F2D1E6F1D1E2F5$3F1E3F1D1E6F1D1E2$8F5D1E6F1D1E2$13D1E6F1D1E2$13D1E6F1D1F2$13D1E6F1$16D1F7$8|$242D1$22D2$45D2C1$21D1E1C1$19C1$1D1E1C1$19C2E1F1E1$1B1$7E1$6A1$4E1F1E1$9E2$5B1C1$3F1E2$3B1$10A1$1B1C1A1$2F1E1F1$5D4$5A1C2D4F3A2B1A1B1D1E3$4D4E3F1$3A1B4D1E3D5E6F1$3C1B4D1E6F1D1E3$7C2B2C1D1E6F1$8|$458D1$16A1$18D1$26A1$1B1$4D2$3B1A1B1$4D4$1A1C1B1C1$3D1E1$3B3$1D1$2E3F1$2D1C2A1$2|$576",palette:{A:"#38b764",B:"#257179",C:"#29366f",D:"#ef7d57",E:"#b13e53",F:"#5d275d"},fps:6},R={w:16,h:16,frames:"$53A1B1A1C2B1A1$8B2A1C4A1C1$6B3A1C3B2C2$4A1B2A1B1A1C1A1B1D1C2A1$3A1B1A1C2D1A1B1D2C3$3B1A1B1C1D1A1C2B4A1$3B2A1C2B1C1D1C1B1A2C1$3B2C1A1B1C1D1C2A1C3$3B2A1C1A1C2A1B1C4$3A2B3A2B1A1C3A1$4B3A1C4A1C2$6B3A1B1C3A1$8A1B1A1B3A1$4|$54A1B4$9B1A2B3A1B1A1$6B4A1C1B1A1B3$4B4C1A3C1A1B3$3A3B1A1B1C1D1C1B1A3$3B2C1A1C1A3D1A2B2$3B1C2A1C1D1C2A1C4$3B1C2A1B1C1D1C1A1C4$3A1C1A1B1A1C2A1D1A1C3$3B1A1C3A2B1D1B1A3$4C4A1B2C4$6A1C3A1B1C3$10B2A2$5|$53C3A1B2$8C1B1A1C1A1C2B2$6C3B1A1C3B1A1B1A1$3A1C3A1B1A2B1C1A1B2$3B1A2B1A1C3B1A2B3$1A1C2B1A1C1D2C1A1B2A1B2$2C3D1A1C2B1A1B1C1A2B1$2B1C1D2A4C1A2B2A1$2B2A2C1A1D2C1A1B3$4A1C4A1C2A1B3$4B1C3B1A4B2$6B1C2A1B4A2$8B2A1B2$6",palette:{A:"#333c57",B:"#566c86",C:"#94b0c2",D:"#f4f4f4"},fps:6},_={w:16,h:16,frames:"$38A4$12B1C1B1A1$12C3A2$11C3A2$10D5$1A1$9D5$10D1$1D3$1D1$7C1D1$2D3$1D1$11A3$1C1$11A3$13A1$1A1$13A1$1A1$13A1$1A1$13A1$1A1$7|$37A4$12B1C1B1A1$7C1$4B1C1B1A2$7D2$2C3A3$8D6$1A1$10D5$11D3$1D1$12D4$12A3C1$12A3$13A1$1A1$13A1$1A1$13A1$1A1$13A1$1A1$7|$35C1$15D1$2A4$9D1$2B1C1B1A1$10D1$1C3A2$10D1C3A3$10D5$11D3$1D1$11D3$1D1$11A3$1C1$11A3$13A1$1A1$13A1$1A1$13A1$1A1$13A1$1A1$7|$23C1$14D1$15D1A4$10D1$1B1C1B1A1$10D1$1C3A1$10D2C3A2$10D4A2$10D5$11D5$11A3$1D1$11A3$1C1$11A1$1A1$13A1$1A1$13A1$1A1$13A1$1A1$7",palette:{A:"#b13e53",B:"#5d275d",C:"#ef7d57",D:"#ffcd75"},fps:4},q={w:16,h:16,frames:"$37A4$12B3A1$12C1B1C1A2$11B3A3$10D4$1A1$9D6$9D1$1D3$1D1$8B1$3D3$1D1$11A3$1B1$11A3$13A1$1A1$13A1$1A1$13A1$1A1$13A1$1A1$7|$37A4$12A4$12B3A1$12C1B1C1A2$11B3A2$11D5$10D4$1D1$9B1$2D4$12A3B1$12A3$13A1$1A1$13A1$1A1$13A1$1A1$13A1$1A1$7",palette:{A:"#b13e53",B:"#ef7d57",C:"#5d275d",D:"#ffcd75"},fps:2};function z(e,$,t,A){let i,a=G(e,$,t,A),l=a.detach,n=a.kill,d=a.addTo,r=Object.assign(a,{type:e,attackTime:1,addTo(e,$){d(e,$),r.setVisible(!1,!0)},update(){r.body.update(),r.updateSkin()},changeState(e){switch(i=e,e){case"idle":r.skin.play("idle"),C(r.attackTime,s);break;case"attack":s()}},vsPlatforms(){},kill(){n(),r.setVisible(!1,!1),r.addSfx("blast"),w.play("punch"),C(1,r.detach)},detach(){r.parent&&l()}});function s(){r.skin.play("attack")}return r.addSkin({idle:{texture:V,loop:!1},attack:{texture:X,loop:!1}}),r.skin.stop(),r.skin.onComplete=e=>{"attack"===e&&(r.changeState("idle"),function(){let e=ge.powerPool.get("fireball");if(!e)return;let $=r.isFlipH()?8:0;e.addTo(r.parent),e.x=r.x+r.body.width/2-$,e.y=r.y+r.body.width/2+4,e.flipH=r.flipH,e.play(),w.play("punch")}())},r}function N(){let e,$,t={},A={init(){e=function(){let e=!1,$=G("player",8,8,void 0),t=$.addTo,A=$.update,i=$.reset,a=$.kill,l=!1,r=Object.assign($,{type:"player",jForce:2,swung:!1,addTo(e,$){t(e,$),r.setVisible(!1,!0)},update(){A(),r.moving=!1,j.gWon?r.changeState("idle"):(Be.is("right").down?(r.flipH=1,r.moving=!0):Be.is("left").down&&(r.flipH=-1,r.moving=!0),r.moving?r.vx=r.flipH*r.sx:r.vx=0,r.swung&&(r.vx=1.6*r.flipH),r.grounded&&(r.jumping=!1,r.swung=!1,e=!1),Be.is("right").down||Be.is("left").down?r.attacking||r.changeState("run"):r.grounded&&!r.attacking&&r.changeState("idle"),r.falling&&!r.attacking&&r.changeState("fall"),r.attacking&&(r.resetVx(),r.resetVy(),r.voidGrav()))},vsExits(e){for(let $=0;$<e.length;$++){let t=e[$];if(n(r.body,t)){ge.scene.next();break}}},vsTriggers(e,$,t){e.forEach((A,i)=>{if(n(r.body,A)){let e=A.nodes;$.forEach($=>{if($.reserved)for(let t=0;t<e.length;t++){let a=e[t];if(a.x===$.x&&a.y===$.y){$.onTrigger(A,A.delay),A.register(i);break}}}),t.forEach($=>{if(!$.visible)for(let t=0;t<e.length;t++){let a=$.width/2,l=e[t];if(l.x+a===$.x&&l.y===$.y){$.visible=!0,A.register(i);break}}})}if(A.isJobDone()){let $=d(e,A);e.splice($,1),A.kill()}})},vsAlice(e,$){l||n(r.body,e.body,.5)&&e.active&&(e.doLove(),l=!0,r.addSfx("love",r.x,r.y-r.body.height),j.gWon||(j.gWon=!0),$&&$())},vsFrog(e){n(r.body,e.body,.8,.8)&&e.smash()&&r.receiveDamage(1,e)},vsFallTiles(e){n(r.body,e.body,.2)&&e.active&&(r.g=.1,e.play())},vsBoulders(e){for(let $=0;$<e.length;$++){let t=e[$];if(n(r.body,t.body,.8,.8)){r.receiveDamage(1,t);break}}},changeState($){switch(r.currentState=$,$){case"idle":s();break;case"run":r.grounded&&!r.falling&&r.skin.play("run");break;case"jump":o();break;case"fall":r.skin.play("fall");break;case"attack":r.attacking=!0,r.jumping&&!e&&(e=!0),function(e){if(r.active)switch(e){case"tailwhip":{let $=ge.powerPool.get(e);if(!$)return;$.addTo(r.parent,3),$.flipH=r.flipH,$.scx=r.flipH;let t=0;$.x=r.isFlipH()?r.x-$.width/2-t:r.x-r.width/2-t,$.y=r.y-$.height+r.height,$.play(),w.play("lash");break}}}("tailwhip"),r.skin.play("attack");break;case"swing":h()}},reset(){i(),l=!1,e=!1,r.swung=!1},kill(){a(),r.setVisible(!1,!1),w.play("punch"),r.addSfx("blast"),C(1,f)},doSwing(){r.swung||(B(),h())},onLanded(){r.addSfx("impactDusts"),w.play("landed")}});function s(){r.moving=!1,r.resetVx(),r.skin.play("idle")}function o(e=r.jForce){r.jumping=!0,r.grounded=!1,r.g=r.jg,r.vy-=e,r.moving||r.skin.play("jump")}function h(){r.swung=!0,o(1.8),C(1,c)}function B(){r.attacking=!1,r.g=r.jumping?r.jg:r.dg}function c(){r.swung=!1}function f(){r.detach(),ge.scene.reload()}return r.sx=.5,r.jForce=3,Be.is("jump").onDown(()=>{j.lockedMovement()||r.jumping||r.grounded&&!r.attacking&&r.changeState("jump")}),Be.is("attack").onDown(()=>{j.lockedMovement()||r.dead||r.attacking||e||r.changeState("attack")}),r.addSkin({idle:{texture:P},run:{texture:S},fall:{texture:W},jump:{texture:T},attack:{texture:O,loop:!1}}),r.skin.onComplete=e=>{"attack"===e&&B()},s(),r}(),function(){var e;e={max:4,pool:[]},t.totem=e;for(let e in t){let $=t[e],A=$.max,i=$.pool;for(let $=0;$<A;$++){let t=z(`${e}_${$}`,8,8);i.push(t)}}}(),$=function(e){let $,t=G(e,8,8,void 0),A=t.detach,i=t.kill,a=t.addTo,l=t.update,n=t.reset,d=!1,r=-1,s=!1,o=!1,h=!1,B=!1,c=null,f=["idle","attack","idle","jump","idle","attack","idle","fly"],g=Object.assign(t,{type:e,addTo(e,$){a(e,$),g.setVisible(!1,!0)},update(){l(),(g.jumping||h)&&(g.vx=.6*g.flipH),o&&(g.vx=0),g.onWall&&!s&&(s=!0),h&&(g.vy=0,s&&(g.vx=0,g.g=g.dg)),g.grounded&&(g.jumping&&(g.jumping=!1,s?(g.doFlipH(),p(!0)):d||g.changeState("jump")),h&&s&&p(),g.vx=0,g.vy=0),g.skin.alpha=+!B},changeState(e){switch(g.attacking=!1,$=e,e){case"idle":g.skin.play("idle"),C(3,()=>{p(!0)});break;case"attack":r+=1,g.attacking=!0,g.skin.play("attack"),m(),C(.5,()=>{p(!0)});break;case"fly":o=!0,D("fly",0,.5),c=function(e,$){let t=u(1),A=t._update;return t._update=()=>{t.running&&t.dt>1&&($&&$(),t.reset()),A()},t}(0,()=>{m(!1,!0)}),C(2,()=>{o=!1,h=!0});break;case"jump":d=!0,g.skin.play("idle"),C(1,()=>{D()})}},kill(){i(),g.setVisible(!1,!1),g.addSfx("blast"),w.play("punch"),g.detach(),x(),C(3,()=>{ge.scene.next()})},detach(){x(),g.parent&&A()},start(){p(!0)},onDamage(){B||(B=!0,C(.1,()=>{B=!1}),C(.2,()=>{B=!0}),C(.3,()=>{B=!1}))},reset(){x(),n()},weak:()=>g.active&&!g.attacking&&g.g,smash:()=>g.active&&g.jumping&&g.falling,onLanded(){g.addSfx("impactDusts"),w.play("landed")}});function p(e=!1){s=!1,o=!1,h=!1,y(),r+=1,r>f.length-1&&(r=0);let $=f[r];return e&&g.changeState($),$}function D(e="jump",$=g.jg,t=3){d=!1,g.jumping=!0,g.grounded=!1,g.g=$,g.vy-=t,g.moving||g.skin.play(e)}function m(e=!0,$=!1){let t=ge.powerPool.get("fireball");!g.active||!t||(t.addTo(g.parent),t.x=g.x+4,t.y=g.y+g.body.width/2,t.flipH=g.flipH,t.toVx=e,t.toVy=$,t.play(),w.play("punch"))}function y(){c&&c.kill(),c=null}function x(){y(),d=!1,s=!1,o=!1,h=!1,r=-1}return g.addSkin({idle:{texture:k},attack:{texture:H},jump:{texture:b,loop:!1},fly:{texture:F}}),g.skin.stop(),g}("frog")},getPlayer:()=>e,getTotem(){let e=t.totem.pool,$=null;for(let t=0;t<e.length;t++){let A=e[t];if(!A.active){$=A;break}}return $},getFrog:()=>$,detach(){e.detach(),e.reset(),function(){for(let e in t)t[e].pool.forEach(e=>{e.detach(),e.reset()})}(),$.detach(),$.reset()}};return A.init(),A}var U={w:8,h:8,frames:"$19A2$5A1B1C1A1$4A1B2A1$5A2$19|$19A2$5A1D2A1$4A1D2A1$5A2$19|$19D2$5D1A2D1$4D1A2D1$5D2$19",palette:{A:"#b13e53",B:"#5d275d",C:"#ffcd75",D:"#ef7d57"},fps:12};function Q(e,$){let t=I(e),A=t.kill,i=Object.assign(t,{loop:!0,addBody(){i.body=B(0,0,$.w,$.h),i.body.name=`${e}.body`,i.body.visible=!1},addSkin(){i.skin=h($,!1,i.loop),i.skin.name=`${e}.skin`,i.skin.onComplete=i.onComplete},play(){i.skin.visible=!0,i.skin.start()},stop(e){i.skin.stop(e)},kill(){i.skin.stop(),A()}});return i}function Z(e,$){let t=Q(e,$),A=Object.assign(t,{name:e,type:"power",flipH:1,sx:1,sy:1,vx:0,vy:0,scx:1,vsPlatforms(e){if(A.allowHit)for(let $=0;$<e.length&&A.active;$++){let t=e[$];n(A.body,t)&&(A.onHitPlatform(t),A.kill())}},onHitPlatform(e){}});return A.attachProps(),A}function ee(e,$){let t=Z(e,$),A=t.update,i=t.kill,a=Object.assign(t,{toVx:!0,update(){a.active&&(A(),a.toVx&&(a.vx=a.flipH*a.sx,a.x+=a.vx),a.toVy&&(a.vx=0,a.vy=a.sy,a.y+=a.vy))},onHitPlatform(e){!function(){let e=ge.sfxPool.get("fireballImpact");e&&(e.x=-1===a.flipH?a.x+a.width:a.x,e.y=a.y,e.scx=a.flipH,e.start(),a.parent.add(e))}()},vsPlayer(e){a.active&&e.active&&n(a.body,e.body,.5,.5)&&e.receiveDamage(1,a)},kill(){a.toVx=!0,a.toVy=!1,i()}});return a.allowHit=!0,a.addBody(),a.addSkin(),a}function $e(e,$){let t=Z(e,$),A=t.update,i=Object.assign(t,{update(){i.active&&(A(),i.skin.scx=i.body.scx,i.body.scx<0?i.skin.x=i.x+i.skin.width:i.skin.x=i.x,i.skin.y=i.body.y-i.skin.height+i.body.height)},onComplete(e){i.kill()},vsPlatforms(){},vsTotems(e){for(let $=0;$<e.length;$++){let t=e[$];n(i.body,t.body,.8,.8)&&t.active&&a()&&t.receiveDamage(1,i)}},vsTorches(e,$){for(let t=0;t<e.length;t++){let A=e[t];n(i.body,A.body,.8,.8)&&a()&&!$.swung&&$.doSwing()}},vsFrog(e){e&&n(i.body,e.body)&&e.weak()&&a()&&e.receiveDamage(1,i)}});function a(){return i.skin.currentFrame>=i.skin.totalFrames-1}return i.loop=!1,i.addBody(),i.addSkin(),i.body.height=8,i}var te={w:16,h:16,frames:"$195A2$13A3$7A2$4A2$7A3$5A3$4A3$3|$194A3$6A2$5A3$6A2$6A2$7A2$4A2$8A2$2|$178A2$8A2$3A3$8A3$2A2$10A2$33|$177A2$11A5$11A4$46|$174A4$13A3$62|$174A1$2A1$15A1$62",palette:{A:"#f4f4f4"},fps:10},Ae={w:8,h:8,frames:"$13A2$5A3B1$1A2$1A2B2$1A2$3C2$4A2C2$4A3B1$5A2$1|$12A2$3A2$1A2B2$1A2$3B2$10A2$3B1$2A2$2B2$8|$10A1$3B1$6B2$1A1$3B2$15B1$3A1$3B1$10|$13B2$5B2$42|$12B1$51",palette:{A:"#b13e53",B:"#5d275d",C:"#ef7d57"},fps:12},ie={w:16,h:16,frames:"$70A4$11A6$9A8$8A8$8A8$8A8$9A6$11A4$70|$70B4$11B6$9B3C1B4$8B2C1B3C1B1$8B5C1B2$8B3C1B4$9B6$11B4$70|$18D1$8D1$7D2$5D1$9D2$3D2$9D3$1D2$3D3$5D10$6D4B2D3$4D4B2D1B1D3$7D3B4D2$8D3B3D2$9D2B1D4$9D6$9D7$8D5$11D2$13D1$12|$3D2$6D1$7D1$20A2$11D2A4$7D1$1E1D2E1A3D2$3D2$2D1E3A2D2E2D5$2E1D2E2D1E3A1D1$1D2$1A2D5E2A2$4A4E1D2E1A2$6A4E1D2A4$6A2E1D1E2D1A2$8A1D3E1D1A1$10A1E3$12A3$11D1$15D2$10|$8A1$4D2$7A3$5D1$5D2E1A1$2E1D2$6E1D1A3$1E1D3E2$4E2A3$1A2E4$3A1E2D1A1$2A2$2E2A1$3A1D2$2A2$4A2D2$6A1D3$4D1$2A1$3A3D2E1$5A3$2A4E2A1$5A1$4A1D2E1A3$10A1E2$1A1$6E2A1$13A1D2E2$12A1D2$24|$8A2$8E1D1$4A2$1E3$3E1D1$2A1$7E2$3D1$1A3$7E1$6A1$13A1$5E2$7A3$5D2$2A2$3A1$4A2E1D1$2A2$1A2$5A2E2$5A2$6E2$17A1$6E1$2A2$3A3$5E1D1$1A2$4A1$7E1D1E1$14E3$24|$6A3$9E1$4A1$5E2$3E2$10E2$1E1$3A1$14A2$19E1$16E1$20A1$2A2$4A2$4A2$2A2$4A1$19E2$2A1$6A1$4E1$4A1$6A1$2E1$7E1$16E2$16E1$9",palette:{A:"#333c57",B:"#f4f4f4",C:"#566c86",D:"#ffcd75",E:"#ef7d57"},fps:12};function ae(e,$,t=!1){let A=h($,!1,t),i=Object.assign(A,{name:e,onComplete(e){i.kill()},kill(){i.stop(),i.detach(),i.reserved=!1}});return i.visible=!0,Object.defineProperties(i,{active:{get:()=>i.parent}}),i}var le=[[" ",4],["!",1],['"',3],["#",5],["$",4],["%",5],["&",5],["'",1],["(",2],[")",2],["*",3],["+",3],[",",2],["-",3],[".",1],["/",5],["0",4],["1",2],["2",4],["3",4],["4",4],["5",4],["6",4],["7",4],["8",4],["9",4],[":",1],[";",1],["<",3],["=",3],[">",3],["?",4],["@",5],["A",4],["B",4],["C",3],["D",4],["E",3],["F",3],["G",4],["H",4],["I",3],["J",4],["K",4],["L",3],["M",5],["N",4],["O",4],["P",4],["Q",4],["R",4],["S",4],["T",3],["U",4],["V",4],["W",5],["X",4],["Y",4],["Z",3],["[",2],["\\",5],["]",2],["^",3],["_",4],["`",2],["a",4],["b",4],["c",3],["d",4],["e",4],["f",3],["g",4],["h",4],["i",1],["j",2],["k",4],["l",1],["m",5],["n",4],["o",4],["p",4],["q",4],["r",3],["s",4],["t",3],["u",4],["v",4],["w",5],["x",3],["y",4],["z",4],["{",3],["|",1],["}",3],["~",4]],ne={w:8,h:8,frames:"$64|A1$7A1$7A1$15A1$31|A1$1A1$5A1$1A1$53|$1A1$1A1$4A5$4A1$1A1$4A5$4A1$1A1$28|$2A1$6A3$4A2$8A2$4A3$7A1$21|A1$2A1$7A1$6A1$6A1$7A1$2A1$27|$1A2$5A1$8A2$1A1$3A1$2A1$5A2$1A1$27|A1$7A1$55|$1A1$6A1$7A1$7A1$8A1$30|A1$8A1$7A1$7A1$6A1$31|A1$1A1$6A1$6A1$1A1$45|$9A1$6A3$6A1$38|$33A1$6A1$23|$16A3$45|$32A1$31|$4A1$6A1$6A1$6A1$6A1$31|$1A2$5A1$2A1$4A1$2A1$4A1$2A1$5A2$29|A2$7A1$7A1$7A1$7A1$30|A3$8A1$5A2$5A1$7A4$28|A3$8A1$5A2$8A1$4A3$29|$2A1$6A2$5A1$1A1$5A4$6A1$29|A4$4A1$7A3$8A1$4A3$29|$1A2$5A1$7A3$5A1$2A1$5A2$29|A4$7A1$6A1$6A1$7A1$30|$1A2$5A1$2A1$5A2$5A1$2A1$5A2$29|$1A2$5A1$2A1$5A3$7A1$5A2$29|$8A1$15A1$39|$8A1$15A1$7A1$31|$2A1$6A1$6A1$8A1$8A1$29|$8A3$13A3$37|A1$8A1$8A1$6A1$6A1$31|A3$8A1$5A2$14A1$30|$1A3$4A1$3A1$3A1$1A3$3A1$1A1$1A1$4A3$28|$1A2$5A1$2A1$4A1$2A1$4A4$4A1$2A1$28|A3$5A1$2A1$4A3$5A1$2A1$4A3$29|$1A2$5A1$7A1$7A1$8A2$29|A3$5A1$2A1$4A1$2A1$4A1$2A1$4A3$29|A3$5A1$7A3$5A1$7A3$29|A3$5A1$7A3$5A1$7A1$31|$1A3$4A1$7A1$1A2$4A1$2A1$5A3$28|A1$2A1$4A1$2A1$4A4$4A1$2A1$4A1$2A1$28|A3$6A1$7A1$7A1$6A3$29|$2A2$7A1$7A1$4A1$2A1$5A2$29|A1$2A1$4A1$1A1$5A2$6A1$1A1$5A1$2A1$28|A1$7A1$7A1$7A1$7A3$29|A1$3A1$3A2$1A2$3A1$1A1$1A1$3A1$3A1$3A1$3A1$27|A1$2A1$4A2$1A1$4A1$1A2$4A1$2A1$4A1$2A1$28|$1A2$5A1$2A1$4A1$2A1$4A1$2A1$5A2$29|A3$5A1$2A1$4A1$2A1$4A3$5A1$31|$1A2$5A1$2A1$4A1$2A1$4A1$2A1$5A2$8A1$20|A3$5A1$2A1$4A1$2A1$4A3$5A1$2A1$28|$1A3$4A1$8A2$8A1$4A3$29|A3$6A1$7A1$7A1$7A1$30|A1$2A1$4A1$2A1$4A1$2A1$4A1$2A1$5A2$29|A1$2A1$4A1$2A1$4A1$1A1$5A1$1A1$6A1$30|A1$3A1$3A1$1A1$1A1$3A1$1A1$1A1$3A1$1A1$1A1$4A1$1A1$28|A1$2A1$4A1$2A1$5A2$5A1$2A1$4A1$2A1$28|A1$2A1$4A1$2A1$5A3$7A1$5A2$29|A3$7A1$6A1$6A1$7A3$29|A2$6A1$7A1$7A1$7A2$30|A1$8A1$8A1$8A1$8A1$27|A2$7A1$7A1$7A1$6A2$30|$1A1$6A1$1A1$53|$32A4$28|A1$8A1$54|$9A3$4A1$2A1$4A1$2A1$5A3$28|A1$7A3$5A1$2A1$4A1$2A1$4A3$29|$9A2$5A1$7A1$8A2$29|$3A1$5A3$4A1$2A1$4A1$2A1$5A3$28|$9A2$5A1$1A2$4A2$7A2$29|$2A1$6A1$6A3$6A1$7A1$30|$9A3$4A1$2A1$4A1$2A1$5A3$7A1$5A2$13|A1$7A3$5A1$2A1$4A1$2A1$4A1$2A1$28|A1$15A1$7A1$7A1$31|$1A1$15A1$7A1$7A1$7A1$6A1$15|A1$7A1$2A1$4A1$1A1$5A3$5A1$2A1$28|A1$7A1$7A1$7A1$7A1$31|$8A4$4A1$1A1$1A1$3A1$1A1$1A1$3A1$1A1$1A1$27|$8A3$5A1$2A1$4A1$2A1$4A1$2A1$28|$9A2$5A1$2A1$4A1$2A1$5A2$29|$8A3$5A1$2A1$4A1$2A1$4A3$5A1$7A1$15|$9A3$4A1$2A1$4A1$2A1$5A3$7A1$7A1$12|$8A1$1A1$5A2$6A1$7A1$31|$9A3$4A2$8A2$4A3$29|$1A1$6A3$6A1$7A1$8A1$29|$8A1$2A1$4A1$2A1$4A1$2A1$5A3$28|$8A1$2A1$4A1$2A1$4A1$1A1$6A1$30|$8A1$1A1$1A1$3A1$1A1$1A1$4A1$1A1$5A1$1A1$28|$8A1$1A1$6A1$7A1$6A1$1A1$29|$8A1$2A1$4A1$2A1$4A1$2A1$5A3$7A1$5A2$13|$8A4$6A1$6A1$6A4$28|$1A2$6A1$6A1$8A1$7A2$29|A1$7A1$7A1$7A1$7A1$31|A2$7A1$8A1$6A1$6A2$30|$1A1$1A1$4A1$1A1$53|$64|$64|$64",palette:{A:"#ffffff"}};function de(e){return function(e,$,t,a,l=1){let n=s(),d=(n.render,a),h=l,B=A(String(n.uid)),c=B.canvas,f=B.ctx,g=Object.assign(n,{text:d,texture:e,render(A){if(!g.visible||!g.texture)return;if(B.cached)return r(g,A),void A.drawImage(c,0,0);B.cached=!0;let i=function(){let e=d.split(""),t=$.map(e=>e[0]),A=$.map(e=>e[1]);return e.map(e=>{let $=t.indexOf(e);return{id:$,w:A[$],l:e}})}(),a=e.w,l=t;c.width=A.canvas.width,c.height=A.canvas.height,i.forEach((e,$)=>{let t=e.id,A=$%l*a;$&&(A=i.map(e=>e.w).filter((e,t)=>t<$).reduce((e,$)=>e+$,0)+g.gap*$),o(f,g.texture,t,A,0)}),r(g,f)},destroy(){i(String(n.uid))}});function p(){B=A(String(n.uid)),c=B.canvas,f=B.ctx}return e&&(g.width=e.w,g.height=e.h),Object.defineProperties(g,{text:{set(e){d!==e&&(d=e,g.destroy(),p())},get:()=>d},gap:{set(e){h=e,g.destroy(),p()},get:()=>h}}),g}(ne,le,14,e)}var re={w:8,h:8,frames:"$8A1$4A5$9A2$6A3$10A1$4A2$1A2$6|A2$1A3$1A2$3A2$12A4$2A1$1A4$2A1$6A4$2A4$1A2$2A1$1|$4A2$2A3$2A2$1A1$1A1$12A1$2A4$5A1$1A1$1A1$7A1$5A2$1|A1$7A2$1A2$1A3$2A2$1A2$10A2$2A1$3A2$4A1$7A2$6|$8A1$3A3$2A1$9A1$7A2$12A2$2A2$3A1$5|$18B1$4B1$2B1$4B1$2C1$2B1$1B1$1B1C1$2B1$1C1$1C2$2C1$1C1D2C1$1B1C1$1C1|$42E1$2E1$3E2$1E1F1$1E1F2G2F2G2|$34E1$5E1$1E1$2E1$2E1F1G1E1F2$1E1F1G5F2|$41E1$7F1$1F1$3E1F1G3$2F2|$42E1$6G1E1$5G3F1$4|$35E1$7F1$5E1$1F1G1$4E1G3E1$2|$24B1$5B1$1B1$2B1$2B1$1C1$2B1$1B1C1$1C1$2D1$1C2$1D1$1D2$1C1D2|H9I6A1H1I6A1H1I6A1H1I6A1H1I6A1H1I6A1H1A7|H9I6A1H1I1H4I1A1H1I1H1I2A1I1A1H1I1H1I2A1I1A1H1I1H1A3I1A1H1I6A1H1A7|H9I6A1H1I1H1A3I1A1H1I1A1H1A2I1A1H1I1A2H1A1I1A1H1I1A3H1I1A1H1I6A1H1A7|H9I6A1H1I1A1I2A1I1A1H1I6A1H1I6A1H1I1A1I2A1I1A1H1I6A1H1A7|H9I6A1H1I1A4I1A1H1I1A4I1A1H1I1A4I1A1H1I1A4I1A1H1I6A1H1A7|B9C2D1C3D1B1D7B1C2D2C2D1B1C4D1C1D1B1D7B1C1D1C4D1B1D7|E1F2E3F1E1F8G1F3G1F3G1F2G2F3H1G2I1G1F2G1H1I4G2A1H1I2A1I3A1I1A7|E2F1E2G1H2F4E1G1I1A1F4G2A2G1F2G2I1A2H1G2I4A1H1I3A1I2A1I3A2I2A1I1A7|H2G1E2F1E1F1H1I1G1E1F4H1I1G2F4I1A1I1G2F2G1I1A1I2A1G2A2I2A1I2A3I1A2I3A9|E2F1E3F1E1F11G1F6G2F1G2F1G1F1G1I1G1A1G2H1G1I2A1I2A1H1A1I3A1I1A1I1A7|H1E3F1E1F1H1I1F6I1H1F2G1F3A1H1G1F1G2F1G1A3G1I2G1I2A1I3A2I2H1I1A1I2A1I1A1I1A7|B9C3D1C2D1B1D1C1D5B1C1D1C4D1B1D3C1D3B1C3D4B1C2D1C3D1B1D7|G1$2G1$1G1$1G1J1$2F1$1G1$1F1E1$2F1$1J1$1E2$2E1$1J1$1E1K1$2E1$1J1$1E1K1$3E2K1$6K1$7K1$2|G1$2G1$3G2$2F1$3F1J1$2F1$3E1J1$2E1$3E1J1$2E1$3E2$3E2K1$1K1$7K1$7|G1$2G1$3G1J1$2E1$3G1E1$2E1$3J1E1$2K1$3J1K1$6J1K1$6E1$7K1$7K1|G1$2G1$1G1$1G2$2F1$1G1$1F1J1$2F1$1F1$1E1J1$2E1$1F1$1E2$2E1$1F1$1E1K1$3E1K2$2K1$2F1$5E2$4|G1$2G1$2G1$1E1$2G1$2J1$1E1$2J1$2E1$1K1$2J1$2E1$4J1$2K1$4E1$2K1$4K1$7K1$4|$64",palette:{A:"#5d275d",B:"#94b0c2",C:"#566c86",D:"#333c57",E:"#38b764",F:"#257179",G:"#29366f",H:"#ef7d57",I:"#b13e53",J:"#3b5dc9",K:"#a7f070"},fps:1};function se(e){let $,t,A,i,a,l=ge.actorPool,d=ge.sfxPool,r=ge.powerPool,s=c(),o=s.destroy,h=Object.assign(s,{destroy(){l.detach(),d.detach(),r.detach(),o()}}),f=h.stage,g=[],p=[],u=[],D=[],m=[],y=[],x=[],E=[],v=[],w=[];e.forEach((e,d)=>{if(d){let d=e.name;e.entities.forEach((e,r)=>{var s,o;let h=e.name,c=null!=(s=e.width)?s:re.w,b=null!=(o=e.height)?o:re.h,k=e.x,F=e.y,H=e.values,I=e.nodes,j=e=>{var $,t,A,i;let a=B(0,0,null!=($=e.w)?$:c,null!=(t=e.h)?t:b,e.color);return a.x=null!=(A=e.x)?A:k,a.y=null!=(i=e.y)?i:F,a.name=e.name,a.visible=!1,f.addAt(a,3),a},S=(e,$,t,A,i)=>{let a=Q(e,$);return a.addBody(),a.addSkin(),a.attachProps(),a.setBody(c,b),a.x=k,a.y=F,a.loop=null!=i?i:a.loop,A?a.play():a.stop(0),a.addTo(f,t),a};if("entities"===d){if("player"===h&&($=l.getPlayer(),$.reset(),$.setBody(c,b),$.x=k,$.y=F,$.body.visible=!0,$.addTo(f,2)),"totem"===h){let e=H.flipH,$=H.attackTime,t=l.getTotem();t.reset(),t.setBody(c,b),t.flipH=e,t.attackTime=$,t.x=k,t.y=F,t.changeState("idle"),t.addTo(f,1),u.push(t)}if("frog"===h&&(t=l.getFrog(),t.reset(),t.setBody(c,b),t.flipH=-1,t.health=10,t.x=k,t.y=F,t.start(),t.addTo(f,1)),"boulder"===h){let e=H.flipH,$=function(e,$,t){let A,i=G(e,$,t,void 0),a=i.detach,l=i.kill,d=i.addTo,r=i.update,s=!1,o=!1,h=Object.assign(i,{startTime:4,type:"boulder",sx:.3,addTo(e,$){d(e,$),h.setVisible(!1,!0)},update(){r(),h.moving?h.vx=h.flipH*h.sx:h.vx=0,!h.grounded&&s&&h.changeState("idle")},changeState(e){switch(A=e,e){case"idle":c();break;case"roll":h.moving=!0,h.skin.play("roll");break;case"stop":c(!0)}},kill(){l(),h.setVisible(!1,!1)},detach(){h.parent&&a()},start(){s||(s=!0),C(s?.5:h.startTime,f)},vsReversers(e){for(let $=0;$<e.length;$++){let t=e[$];if(n(h.body,t)){h.flipH=t.side;break}}},vsStoppers(e){if(!o)for(let $=0;$<e.length;$++){let t=e[$];if(n(h.body,t)){h.changeState("stop");break}}},onTrigger(e,$){h.reserved=!1,h.startTime=$,h.changeState("idle")},onLanded(){h.addSfx("impactDusts")}});function B(){h.skin.stop(),h.moving=!1}function c(e=!1){B(),e?o=!0:h.start()}function f(){h.changeState("roll")}return h.addSkin({roll:{texture:R}}),B(),h}(h+r,c,b);$.flipH=e,$.x=k,$.y=F,$.reserved=!0,$.addTo(f,1),m.push($)}if("torch"===h){let e=S(h,Y,0,!0);D.push(e)}if("fireflies"===h&&(A=S(h,M,3,!0)),"alice"===h&&(a=function(e,$){let t="alice",A=G(t,e,$,void 0),i=A.kill,a=Object.assign(A,{g:0,type:t,kill(){i(),a.setVisible(!1,!1),a.detach()},doLove(){a.skin.play("love")},vsPlatforms(){},vsHurts(){}});return a.addSkin({wave:{texture:_},love:{texture:q}}),a.skin.play("wave"),a}(c,b),a.x=k,a.y=F,a.body.visible=!1,a.addTo(f,3)),"fallingTiles"===h&&(i=S(h,L,0,!1,!1)),"hurt"===h){let e=h+r;v.push(j({name:e}))}if("exit"===h){let e=h+r;p.push(j({name:e}))}}if("triggers"===d&&"trigger"===h){let e=H.delay,$=h+r,t=function(e,$,t){let A=e,i=A.map(()=>!1),a=B(0,0,$,t,void 0),l=Object.assign(a,{nodes:A,width:$,height:t,delay:0,register(e){i[e]=!0},isJobDone:()=>!i.includes(!1),kill(){l.detach()}});return l}(I,c,b);t.name=$,t.x=k,t.y=F,t.delay=e,t.visible=!1,f.addAt(t,3),E.push(t)}if("reversers"===d&&"reverser"===h){let e=H.side,$=function(e,$,t,A,i){let a=B($,t,A,i);return Object.assign(a,{name:e,side:1})}(h+r,k,F,c,b);$.side=e,$.visible=!1,f.addAt($,3),y.push($)}if("stoppers"===d&&"stopper"===h){let e=h+r;x.push(j({name:e}))}if("collision"===d&&"platform"===h){let e=h+r;g.push(j({name:e}))}if("texts"===d){let e=de(H.text);e.name=H.name,e.visible=H.visible,e.x=k+c/2,e.y=F,f.addAt(e,3),w.push(e)}})}}),h.update=()=>{j.loaded=!0,function(){if($&&$.active){if($.update(),$.vsPlatforms(g),$.vsHurts(v),$.vsExits(p),$.vsBoulders(m),$.vsTriggers(E,m,w),a){let e=()=>{w.forEach(e=>e.visible=!0)};$.vsAlice(a,j.endSceneIndex?e:null)}i&&$.vsFallTiles(i),t&&$.vsFrog(t),u.forEach(e=>{e.active&&(e.update(),e.vsPlatforms(g))})}A&&A.update(),i&&i.update(),a&&a.update(),t&&t.active&&(t.update(),t.vsPlatforms(g)),D.forEach(e=>{e.update()}),m.forEach(e=>{e.update(),e.vsPlatforms(g),e.vsReversers(y),e.vsStoppers(x)}),d.update(),r.update(f,g,u,$,D,t)}()};let b=s.render;return h.render=e=>{b(e)},Be.is("restart").onDown(()=>{j.gWon&&(j.reset(),ge.scene.set(1))}),h}function oe(e,$){let t=c(),a=t.stage,l=function(e,$,t){let a=s(),l=A(String(a.uid)),n=l.canvas,d=l.ctx,r=Object.assign(a,{texture:e,render(A){if(!r.visible||!r.texture)return;if(l.cached)return void A.drawImage(n,0,0);l.cached=!0,n.width=A.canvas.width,n.height=A.canvas.height;let i=e.w;$.forEach((e,$)=>{if(e>-1){let A=$%t*i,a=Math.floor($/t)*i;o(d,r.texture,e,A,a)}})},destroy(){i(String(a.uid))}});return e&&(r.width=e.w,r.height=e.h),r}(re,e,$);return a.addAt(l,0),t}var he=!1,Be=function(e,$){let t={};for(let $ in e){let A={code:e[$],down:!1,downHandlers:new Map,onDown:e=>{let $=A.downHandlers.size;return A.downHandlers.set($,e),()=>{A.downHandlers.delete($)}}};t[$]=A}function A(e,$){Object.keys(t).forEach(A=>{let i=t[A];e===i.code&&($&&(i.down||i.downHandlers.forEach(e=>{e()})),i.down=$)})}return window.addEventListener("keydown",function(e){$&&$(),A(e.key,!0),[" ","ArrowUp","ArrowDown","ArrowLeft","ArrowRight"].includes(e.key)&&e.preventDefault()},!1),window.addEventListener("keyup",function(e){A(e.key,!1)},!1),{is:e=>t[e]}}({left:"a",right:"d",jump:"k",attack:"j",restart:"r"},()=>{he||(he=!0,w.music())}),ce=function(){let e=performance.now(),$=0,t=0,A=0,i=1e3/60,a={dt:0,fdt:1/60,edt:0,time:Number.MIN_VALUE},l={},n={};function d(){for(let e in l)l[e]()}return function t(){requestAnimationFrame(t);let A=performance.now();if(a.edt=A-e,e=A,a.dt=1*Math.min(a.edt,.05),a.time+=a.dt,!(a.edt>1e3)){for($+=a.edt;$>=i;)d(),$-=i;!function(){for(let e in n)n[e]()}()}}(),{add:function(e,$){let i="update"===e?t:A,a="update"===e?l:n;return i+=1,a[i]||(a[i]=$),"update"===e?t=i:A=i,i},remove:function(e,$){let t="update"===$?l:n;t[e]&&delete t[e]},timer:a}}(),fe=["bg","fg"],ge=(()=>{let e=[D,m,y,x,E,v].map(e=>(e=>{let $=e[0];return[()=>se(e),()=>oe($.data,$.gridCellsX)]})(e)),t=[[null,null],...e];j.endSceneIndex=e.length;let A=function(){let e=[];return{add:function(t,A,i){let a=document.createElement("canvas");a.setAttribute("width",$(A)),a.setAttribute("height",$(i)),a.setAttribute("tabindex","-1"),a.setAttribute("id",t),a.setAttribute("opa",t);let l=a.getContext("2d");l.imageSmoothingEnabled=!1;let n={id:t,canvas:a,ctx:l};return e.push(n),n},remove:function($){for(let t=0;t<e.length;t++)if(e[t].id===$)return void e.splice(t,1)},get:function($){let t=e.filter(e=>e.id===$);return t.length?t[0]:void 0}}}(),i=f(),a=f(),l=N(),n=function(){let e=0,$={},t={},A={init(){i("impactDusts",{max:3,pool:[]}),i("fireballImpact",{max:20,pool:[]}),i("love",{max:1,pool:[]}),i("blast",{max:3,pool:[]});for(let e in $){let t=e,A=$[t],i=A.max,a=A.pool;for(let e=0;e<i;e++){let $=`${t}_${e}`;switch(t){case"impactDusts":a.push(ae($,te));break;case"fireballImpact":a.push(ae($,Ae));break;case"love":a.push(ae($,K,!0));break;case"blast":a.push(ae($,ie))}}}},update(){for(let e in t){let $=t[e];$.active?$.update():delete t[e]}},get(A){let i,a=$[A].pool;for(let $=0;$<a.length;$++){let A=a[$];if(!A.active&&!A.reserved){i=A,e+=1,t[e]=i,i.reserved=!0;break}}return i},detach(){for(let e in $)$[e].pool.forEach(e=>{e.kill()});!function(){for(let e in t)delete t[e]}()}};function i(e,t){$[e]=t}return A.init(),A}(),d=function(){let e=0,$={},t={},A={init(){i("fireball",{max:8,pool:[]}),i("tailwhip",{max:1,pool:[]});for(let e in $){let t=e,A=$[t],i=A.max,a=A.pool;for(let e=0;e<i;e++){let $=`${t}_${e}`;switch(t){case"fireball":a.push(ee($,U));break;case"tailwhip":a.push($e($,J))}}}},update(e,$,A,i,a,l){for(let e in t){let n=t[e];n.active?(n.update(),n.vsPlatforms($),n.vsTotems&&n.vsTotems(A),n.vsPlayer&&n.vsPlayer(i),n.vsTorches&&n.vsTorches(a,i),n.vsFrog&&n.vsFrog(l)):delete t[e]}},render(e){for(let $ in t){let A=t[$];A.active&&A.render(e)}},get(A){let i,a=$[A].pool;for(let $=0;$<a.length;$++){let A=a[$];if(!A.active&&!A.reserved){i=A,e+=1,t[e]=i,i.reserved=!0;break}}return i},detach(){for(let e in $)$[e].pool.forEach(e=>{e.kill()});!function(){for(let e in t)delete t[e]}()}};function i(e,t){$[e]=t}return A.init(),A}(),r={set(e){let[$,A]=t[e];a.clear(),i.clear(),$&&a.set($),A&&i.set(A),j.sceneIndex=e},render([e,$]){i.render(e.ctx),a.render($.ctx)},update(){a.update()},reload(){p(),j.reset(),r.set(j.sceneIndex)},next(){p(),j.sceneIndex+=1,r.set(j.sceneIndex)}};return{scene:r,layers:A,actorPool:l,sfxPool:n,powerPool:d}})();window.onload=()=>{(function(){let e=ge.scene,t=ge.layers,A=fe.map(e=>{let $=t.add(e,96,96);return document.body.appendChild($.canvas),$});ce.add("update",()=>{(function(){for(let e in g)g[e]&&g[e]._update()})(),e.update()}),ce.add("render",()=>{e.render(A)}),e.reload(),function(e,t){let A=()=>{let A=window.innerWidth,i=window.innerHeight,a=t.width/t.height,l=0,n=0;A/i<=a?(l=A,n=l/a):(n=i,l=n*a),e.forEach(e=>{let t=e.canvas;t.style.width=$(l),t.style.height=$(n)})};window.onresize=A,A()}(A,{width:96,height:96})})(),window.focus(),document.body.addEventListener("click",function(){window.focus()},!1)}</script>