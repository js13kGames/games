<!doctype html><title>Sub13 - js13kGames 2024</title><style>#exp,#out,#out .t,.box{font-weight:400}.box,body,html{box-sizing:border-box;overflow:hidden}#logo,#op{position:relative;color:#fff}#ui,canvas{display:block}#ui,body,html{pointer-events:none;width:100vw;height:100vh}#speed .l,.t{font-family:Arial}#left,#minimap{width:10vw;position:absolute}#pm,body,html{background-color:#fff}#bl,#bottom,#exp,#intro,#left,#lm,#log1,#log2,#minimap,#minimap .p,#out,#outro,#place,#pm,#retry,#speed,#start,#time,#top,#ui,canvas{position:absolute}#bl,#logo,#op,#speed .l,.box{color:#fff}body,html{transition:background-color 4s;margin:0;padding:0;touch-action:none;-webkit-touch-callout:none;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}#intro,#outro{top:6vh;left:10vw;width:80vw;height:80vh;display:flex;align-items:center;justify-content:center;flex-direction:column;transform:scale(1);opacity:1;transition:transform 1s,opacity .8s}#logo{width:0;height:0;letter-spacing:-3vw;top:-24vh;left:-4vh;transform:skewX(10deg)}#log1,#log2{font-size:14vw;top:0}#log1{left:-15vw;text-shadow:0 0 2vw #444}#log2{color:#45abff;text-shadow:0 0 2vw #3c3c97;left:6vw}#exp,#out{top:40vh}.box{background-color:rgba(0,0,0,.4);border-left:1vw solid #fff;padding:6vh 4vh}#retry,#speed .l,#start,.h{font-weight:700}#retry,#start{font-size:2vh;left:-.4vh;text-transform:uppercase;bottom:-.4vh}#op{text-shadow:0 0 2vw #3c3c3c;top:-8vh}#bl{font-weight:400;opacity:.4;bottom:-4vw;left:0}.t{letter-spacing:1;line-height:1;font-size:1.5vh}.h{font-size:12vh}#ui{opacity:0;transition:opacity 1s}#bottom,#top{left:25vw;top:5vh;height:20vh;width:50vw}#bottom{top:auto;bottom:10vh;height:10vh}#speed{display:flex;justify-content:center;align-items:center;width:60vw;height:10vh;left:-5vw;top:10vh;transform:skew(20deg)}#speed .l{width:3vh;height:2vh;margin:.2vw;background:linear-gradient(180deg,#afafaf,#7e7e7e);transition:.2s ease-in;text-align:center}#speed #l12{width:6vw;height:2vh;transform:scaleY(3);background:linear-gradient(180deg,#e42,#421)!important;margin:.5vw;display:flex;align-items:center;justify-content:center}#speed .l.x{transform:scaleY(3);background:linear-gradient(180deg,#ffcf32,#fc9c36);opacity:1;animation:.3s bounce}#left{left:12vw;top:35vh;height:40vh}#minimap{top:20vh;left:0;height:0}#minimap .p,#pm{width:2vh;height:2vh;top:1vh;left:1vh;border-left:1vh solid #fff;border-top:1vh solid #fff;transform:scaleX(.6) rotate(45deg)}#lm{height:40vh;top:-20vh;left:2.25vh;width:.5vh;border-left:.5vh solid #fff}#pm{height:.5vh;width:6vh;border-radius:0;transform:none;border:none;left:-.5vh;top:0}#place,#time{width:10vw;height:10vh;font-size:3vh;display:flex;justify-content:center;align-items:center;top:1vh;left:0;color:#fff}#place{transform:skewX(-20deg)}#time{transform:skewX(20deg);left:auto;right:0}#time .s{font-size:6vh}@keyframes bounce{from{background:#fff;transform:scaleY(0)}to{background:#fff;transform:scaleY(10)}}</style><body id=body><canvas id=glcanvas></canvas><div id=intro><div id=logo><div id=log1 class="t h">SUB</div><div id=log2 class="t h">13</div></div><div id=exp class="t box">► Race ahead of the competition<br><br>► Your speed is constantly decreasing<br><br>► Build up speed by picking up <b>boosts</b><br><br>► If a <b>boost</b> takes you over <b>12</b> speed, you <b>lose</b> it instead<br><br>► Use sound<br><br><br><div id=start class="t h">SPACE/TAP: Start</div></div><div id=bl class=t>A JS13K entry by <b>Charlie Norin</b> and <b>Felix Magnell</b></div></div><div id=outro><div id=op class="t h">5th</div><div id=out class=box><div id=ot class=t>Could be worse, but not by a lot. Go again!</div><div id=retry class="t h">SPACE/TAP: Restart</div></div></div><div id=ui><div id=top><div id=speed></div></div><div id=left><div id=minimap><div id=pm></div><div id=lm></div></div></div><div id=bottom><div id=time class=t><div class=h>60</div>s</div><div id=place class=t><div class=h>5</div>/5</div></div></div><script>const e=()=>Math.floor(5*Math.random()+1);function t(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);return[e[0]/t,e[1]/t,e[2]/t]}function n(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function a(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}var r=new Float32Array([-1,-1,1,1,-1,1,1,1,1,-1,1,1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1,-1,-1,1,-1,-1,1,1,1,1,1,1,1,-1,-1,-1,-1,1,-1,-1,1,-1,1,-1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,-1,1,-1,-1,-1,-1,-1,1,-1,1,1,-1,1,-1]),o=new Uint16Array([0,1,2,2,3,0,4,5,6,6,7,4,8,9,10,10,11,8,12,13,14,14,15,12,16,17,18,18,19,16,20,21,22,22,23,20]);!function(){const c={canvas:document.getElementById("glcanvas"),ka:0,v:{M:0,J:0,H:0,F:0}};var i,s;c.h=function(){function e(e){var t=a.createFramebuffer();return a.bindTexture(a.TEXTURE_2D,e),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.canvas.width,a.canvas.height,0,a.RGBA,a.UNSIGNED_BYTE,null),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.LINEAR),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.LINEAR),a.bindFramebuffer(a.FRAMEBUFFER,t),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,e,0),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,i),t}function t(e,t){return e=a.createShader(e),a.shaderSource(e,t),a.compileShader(e),a.getShaderParameter(e,a.COMPILE_STATUS)?e:(console.error(a.getShaderInfoLog(e)),a.deleteShader(e),null)}function n(e,n){e=t(a.VERTEX_SHADER,e),n=t(a.FRAGMENT_SHADER,n);var r=a.createProgram();return a.attachShader(r,e),a.attachShader(r,n),a.linkProgram(r),a.useProgram(r),a.getProgramParameter(r,a.LINK_STATUS)?r:(console.error(a.getProgramInfoLog(r)),a.deleteProgram(r),null)}const a=c.canvas.getContext("webgl2"),r=(a.enable(a.DEPTH_TEST),a.enable(a.BLEND),[]),o=[],i=a.createRenderbuffer(),s=(a.bindRenderbuffer(a.RENDERBUFFER,i),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,a.canvas.width,a.canvas.height),a.createTexture()),u=e(s),l=a.createTexture(),f=e(l),m=n("#version 300 es\n\n  precision mediump float;\n\n  const vec2 positions[3] = vec2[3](\n      vec2(-1.0, -1.0),\n      vec2(3.0, -1.0),\n      vec2(-1.0, 3.0)\n  );\n\n  void main() {\n      gl_Position = vec4(positions[gl_VertexID], -1.0, 1.0);\n  }\n  ","#version 300 es\n\n  precision mediump float;\n\n  uniform vec2 uResolution;\n  uniform sampler2D uTexture;\n\n  out vec4 outColor;\n\n  void main() {\n    vec2 uv = gl_FragCoord.xy / uResolution;\n    outColor = texture(uTexture, uv);\n  }\n  "),v=(a.useProgram(m),a.getUniformLocation(m,"uTexture")),p=a.getUniformLocation(m,"uResolution");return{m:a,createProgram:n,A:function(e,t,n,r=!0){var o=new Float32Array([]);a.useProgram(e),e=a.getAttribLocation(e,t);const c=a.createBuffer(),i=(a.bindBuffer(a.ARRAY_BUFFER,c),a.vertexAttribPointer(e,n,a.FLOAT,!1,0,0),a.enableVertexAttribArray(e),r&&a.vertexAttribDivisor(e,1),()=>{a.bindBuffer(a.ARRAY_BUFFER,c),a.bufferData(a.ARRAY_BUFFER,o,a.DYNAMIC_DRAW)});return{V:()=>a.bindBuffer(a.ARRAY_BUFFER,c),i:e=>{o=new Float32Array([...o,...e]),i()},aa:()=>o,la:e=>{o=e,i()}}},ja:e,ga:e=>{for(var t of(a.viewport(0,0,a.canvas.width,a.canvas.height),a.canvas.width=window.innerWidth,a.canvas.height=window.innerHeight,a.bindTexture(a.TEXTURE_2D,l),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.canvas.width,a.canvas.height,0,a.RGBA,a.UNSIGNED_BYTE,null),a.bindTexture(a.TEXTURE_2D,s),a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.canvas.width,a.canvas.height,0,a.RGBA,a.UNSIGNED_BYTE,null),a.bindFramebuffer(a.FRAMEBUFFER,u),a.bindRenderbuffer(a.RENDERBUFFER,i),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,a.canvas.width,a.canvas.height),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),r))t(e);var n=f,c=s;for(t of o)a.bindFramebuffer(a.FRAMEBUFFER,n),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,c),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),t(e),n=n==u?f:u,c=c==s?l:s;a.bindFramebuffer(a.FRAMEBUFFER,null),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),a.useProgram(m),a.activeTexture(a.TEXTURE0),a.bindTexture(a.TEXTURE_2D,c),a.uniform2f(p,a.canvas.width,a.canvas.height),a.uniform1i(v,0),a.drawArrays(a.TRIANGLES,0,3)},Y:e=>r.push(e),R:e=>o.push(e)}}(),c.s=function(e){function t(){return"undefined"!=typeof InstallTrigger}function n(e,t,n,a,r=1){return(e=e.createBiquadFilter()).type=n,e.frequency.value=a,e.Q.value=r,t.connect(e),e}const a={M:0,J:0,H:0,F:0};let r=!1,o=0,c=0,i=.5/6,s=.5/3,u=.14,l=.07;const f={C0:16.35,"C#0":17.32,D0:18.35,"D#0":19.45,E0:20.6,F0:21.83,"F#0":23.12,G0:24.5,"G#0":25.96,A0:27.5,"A#0":29.14,B0:30.87,C1:32.7,"C#1":34.65,D1:36.71,"D#1":38.89,E1:41.2,F1:43.65,"F#1":46.25,G1:49,"G#1":51.91,A1:55,"A#1":58.27,B1:61.74,C2:65.41,"C#2":69.3,D2:73.42,"D#2":77.78,E2:82.41,F2:87.31,"F#2":92.5,G2:98,"G#2":103.83,A2:110,"A#2":116.54,B2:123.47,C3:130.81,"C#3":138.59,D3:146.83,"D#3":155.56,E3:164.81,F3:174.61,"F#3":185,G3:196,"G#3":207.65,A3:220,"A#3":233.08,B3:246.94,C4:261.63,"C#4":277.18,D4:293.66,"D#4":311.13,E4:329.63,F4:349.23,"F#4":369.99,G4:392,"G#4":415.3,A4:440,"A#4":466.16,B4:493.88,C5:523.25,"C#5":554.37,D5:587.33,"D#5":622.25,E5:659.26,F5:698.46,"F#5":739.99,G5:783.99,"G#5":830.61,A5:880,"A#5":932.33,B5:987.77,C6:1046.5,"C#6":1108.73,D6:1174.66,"D#6":1244.51,E6:1318.51,F6:1396.91,"F#6":1479.98,G6:1567.98,"G#6":1661.22,A6:1760,"A#6":1864.66,B6:1975.53,C7:2093,"C#7":2217.46,D7:2349.32,"D#7":2489.02,E7:2637.02,F7:2793.83,"F#7":2959.96,G7:3135.96,"G#7":3322.44,A7:3520,"A#7":3729.31,B7:3951.07,C8:4186.01,"C#8":4434.92,D8:4698.63,"D#8":4978.03,E8:5274.04,F8:5587.65,"F#8":5919.91,G8:6271.93,"G#8":6644.88,A8:7040,"A#8":7458.62,B8:7902.13},m=t()?[[[0,4]],[[0,4]],[[0,4]],[[0,4]],[[0,.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],[0,.125],["E4",.125],["A4",.125],["F#4",.125],[0,.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]],[[0,.125],["B4",.125],["A4",.125],["F#5",.125],[0,.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],[0,.125],["F#4",.125],["B4",.125],["E4",.125],[0,.125],["F#4",.125],["C#5",.125],[0,.5]],[[0,.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],[0,.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125]],[[0,.125],["B4",.125],[0,.125],["F#5",.125],["E4",.125],[0,.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]]]:[[[0,4]],[[0,4]],[[0,4]],[[0,4]],[["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]],[["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]],[["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125]],[["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5],["E4",.125],["B4",.125],["A4",.125],["F#5",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],["E4",.125],["A4",.125],["F#4",.125],["B4",.125],["E4",.125],["A4",.125],["F#4",.125],["C#5",.125],[0,.5]]],v=[[["B3",.5],["E4",.5],["G4",.5],["F#4",.5],[0,.25],["D4",.25],["B3",.5],["E4",1]],[["B3",.5],["E4",.5],["G4",.5],["F#4",.5],[0,.25],["D4",.25],["B3",.5],["E4",1]],[["D4",.5],["G4",.5],["A#4",.5],["A4",.5],["G4",.5],["A#4",.5],["C5",.5],["F5",.5]],[["D4",.5],["G4",.5],["A#4",.5],["A4",.5],["G4",.5],["A#4",.5],["C5",.5],["D5",.5]],[[0,4]],[[0,4]],[[0,4]],[[0,4]]],p=[[[0,4]],[[0,4]],[["D3",s],["G3",s],["A3",s],["A#3",s],["D4",s],["G4",s],["A4",s],["A#4",s],["D5",s],["G5",s],["A5",s],["A#5",s],["G3",s],["A#3",s],["C4",s],["F4",s],["G4",s],["A#4",s],["C5",s],["F5",s],["G5",s],["A#5",s],["C6",s],["F6",s]],[["G3",s],["A3",s],["A#3",s],["D4",s],["G4",s],["A4",s],["A#4",s],["D5",s],["G5",s],["A5",s],["A#5",s],["D6",s],["A#3",s],["C4",s],["D4",s],["G4",s],["A#4",s],["C5",s],["D5",s],["G5",s],["A#5",s],["C6",s],["D6",s],["G6",s]],[[0,4]],[[0,4]],[[0,4]],[[0,4]]],A=[[[0,4]],[[0,4]],[["D3",i],["G3",i],["A3",i],["A#3",i],["D4",i],["G4",i],["A4",i],["A#4",i],["D5",i],["G5",i],["A5",i],["A#5",i],["A#5",i],["A5",i],["G5",i],["D5",i],["A#4",i],["A4",i],["G4",i],["D4",i],["A#3",i],["A3",i],["G3",i],["D3",i],["G3",i],["A#3",i],["C4",i],["F4",i],["G4",i],["A#4",i],["C5",i],["F5",i],["G5",i],["A#5",i],["C6",i],["F6",i],["F6",i],["C6",i],["A#5",i],["G5",i],["F5",i],["C5",i],["A#4",i],["G4",i],["F4",i],["C4",i],["A#3",i],["G3",i]],[["G3",i],["A3",i],["A#3",i],["D4",i],["G4",i],["A4",i],["A#4",i],["D5",i],["G5",i],["A5",i],["A#5",i],["D6",i],["D6",i],["A#5",i],["A5",i],["G5",i],["D5",i],["A#4",i],["A4",i],["G4",i],["D4",i],["A#3",i],["A3",i],["G3",i],["A#3",i],["C4",i],["D4",i],["G4",i],["A#4",i],["C5",i],["D5",i],["G5",i],["A#5",i],["C6",i],["D6",i],["G6",i],["G6",i],["D6",i],["C6",i],["A#5",i],["G5",i],["D5",i],["C5",i],["A#4",i],["G4",i],["D4",i],["C4",i],["A#3",i]],[[0,4]],[[0,4]],[[0,4]],[[0,4]]],d=[[[0,4]],[[0,4]],[["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["G4",.25],["A#4",.25],["A4",.25],["G4",.25]],[["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["G4",.25],["A#4",.25],["A4",.25],["G4",.25],["D4",.25],["A4",.25],["F#4",.25],["D4",.25],["D4",.25],["A4",.25],["F#4",.25],["D4",.25]],[[0,4]],[[0,4]],[[0,4]],[[0,4]]],h=[[[["B2","E3"],2],[["C3","F#3"],2]],[[["D3","G3"],2],[["E3","A3"],2]],[[["G3","D4"],2],[["A3","D#4"],2]],[[["A#3","F4"],2],[["C4","G4"],2]],[[["F#4","A4"],2],[["B3","E4"],2]],[[["A3","D4"],2],[["E3","B3"],2]],[[["F#4","A4"],2],[["B3","E4"],2]],[[["A3","D4"],2],[["E3","B3"],2]]],g=[[[0,4]],[[1,.5],[0,.25],[1,.25],[0,.25],[1,.25],[0,.5],[0,.125],[1,.25],[1,.125],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]],[[1,.5],[0,.25],[1,.25],[0,.125],[1,.125],[0,.25],[1,.5],[1,.125],[1,.25],[1,.125],[0,.25],[1,.25],[1,.25],[0,.125],[1,.125],[0,.25],[0,.125],[1,.125]],[[0,4]],[[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25],[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25]],[[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25],[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25]],[[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25],[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25]],[[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25],[1,.25],[0,.125],[1,.125],[0,.125],[1,.25],[1,.125],[0,.25],[1,.125],[1,.125],[0,.125],[1,.125],[0,.25]]],T=[[[0,4]],[[0,4]],[[0,4]],[[0,4]],[[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125],[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]],[[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125],[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]],[[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125],[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]],[[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125],[0,.5],[0,.5],[1,.5],[0,.25],[0,.125],[1,.125]]],E=[[["E1",4]],[["E1",4]],[["G1",4]],[["G1",4]],[["E2",4]],[["G1",4]],[["E2",4]],[["G1",4]]],F=[[[0,4]],[[0,4]],[[0,4]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]],[[0,.25],[1,.25],[1,.5],[1,.125],[1,.125],[1,.25],[0,.125],[1,.25],[1,.125],[0,.125],[1,.125],[1,.25],[1,.125],[1,.125],[1,.25],[1,.25],[1,.25],[1,.5]]];return{keys:Object.keys(a),v:a,fa:function(e){a.M=Math.max(0,a.M-e/1e3),a.H=Math.max(0,a.H-e/500),a.J=Math.max(0,a.J-e/500),a.F=Math.max(0,a.F-e/500)},T:function(){function i(e){var t=S.createOscillator(),n=S.createGain(),r=(t.type="sine",t.frequency.setValueAtTime(150,e),t.frequency.exponentialRampToValueAtTime(.01,e+.5),n.gain.setValueAtTime(1,e),n.gain.exponentialRampToValueAtTime(.001,e+.5),S.createBiquadFilter());r.type="peaking",r.frequency.value=120,r.gain.value=3,t.connect(n),n.connect(r),r.connect(L),setTimeout(function(){return a.F=1},1e3*(e-S.currentTime)),t.start(e),t.stop(e+.5)}function s(e){for(var t=(r=S.createBuffer(1,.2*S.sampleRate,S.sampleRate)).getChannelData(0),n=0;n<r.length;n++)t[n]=2*Math.random()-1;(t=S.createBufferSource()).buffer=r,(r=S.createBiquadFilter()).type="highpass",r.frequency.setValueAtTime(1500,e),(n=S.createGain()).gain.setValueAtTime(1,e),n.gain.exponentialRampToValueAtTime(.01,e+.2),t.connect(r),r.connect(n),n.connect(O);for(var r=(n=S.createBuffer(1,.05*S.sampleRate,S.sampleRate)).getChannelData(0),o=0;o<n.length;o++)r[o]=2*Math.random()-1;(r=S.createBufferSource()).buffer=n,(n=S.createBiquadFilter()).type="highpass",n.frequency.setValueAtTime(1e3,e),(o=S.createGain()).gain.setValueAtTime(1,e),o.gain.exponentialRampToValueAtTime(.01,e+.05),r.connect(n),n.connect(o),o.connect(O),(n=S.createOscillator()).type="square",n.frequency.setValueAtTime(400,e),n.connect(O),t.start(e),r.start(e),n.start(e),t.stop(e+.2),r.stop(e+.05),n.stop(e+.01),setTimeout(function(){return a.H=1},1e3*(e-S.currentTime))}function y(e){for(var t=S.createBuffer(1,.05*S.sampleRate,S.sampleRate),n=t.getChannelData(0),a=0;a<t.length;a++)n[a]=2*Math.random()-1;(n=S.createBufferSource()).buffer=t,(t=S.createBiquadFilter()).type="highpass",t.frequency.setValueAtTime(8e3,e),(a=S.createGain()).gain.setValueAtTime(.5,e),a.gain.exponentialRampToValueAtTime(.01,e+.05),n.connect(t),t.connect(a),a.connect(P),n.start(e),n.stop(e+.05)}function D(e,n,a){var r=S.createGain(),o=(r.gain.value=u,S.createOscillator()),c=(o.type="triangle",o.frequency.setValueAtTime(e,n),S.createBiquadFilter());if(c.type="lowpass",c.frequency.setValueAtTime(800,n),t())o.connect(c),c.connect(r),r.connect(M),o.start(n),o.stop(n+a);else{const t=S.createOscillator();t.frequency.value=5;var i=S.createGain();i.gain.value=7,t.connect(i),i.connect(o.frequency),o.frequency.setTargetAtTime(e,n,.1),o.connect(c),c.connect(r),r.connect(M),o.start(n),t.start(n),o.stop(n+a),t.stop(n+a)}}function G(e,t,n){var a=S.createGain(),r=(a.gain.value=.5,[]);for(let n=0;n<4;n++){var o=S.createOscillator(),c=(o.type="sine",10*(n-2));o.frequency.setValueAtTime(2*e,t),o.detune.setValueAtTime(c,t),o.connect(a),r.push(o)}(e=S.createConvolver()).buffer=function(){var e=.8*S.sampleRate,t=S.createBuffer(2,e,S.sampleRate);for(let a=0;a<t.numberOfChannels;a++){var n=t.getChannelData(a);for(let t=0;t<e;t++)n[t]=(2*Math.random()-1)*Math.pow(1-t/e,2)}return t}(),a.connect(e),e.connect(_),_.connect(M),M.connect(S.destination),r.forEach(e=>{e.start(t),e.stop(t+n)})}function C(e,t,n){var r=S.createOscillator(),o=(r.type="sawtooth",r.frequency.value=e,r.detune.value=0,S.createGain()),c=(o.gain.value=.3,r.connect(o),S.createBiquadFilter()),i=(c.type="notch",c.frequency.value=.3*S.sampleRate,c.Q.value=.3,(e=S.createBiquadFilter()).type="lowpass",e.frequency.setTargetAtTime(500,S.currentTime,0),e.Q.value=.04,e.gain.value=1,S.createBiquadFilter());i.type="highpass",i.frequency.setTargetAtTime(200,S.currentTime,0),i.Q.value=1,o.connect(c),c.connect(e),e.connect(i),(o=S.createGain()).gain.value=.9,i.connect(o),o.connect(M),M.connect(S.destination),i=S.createOscillator(),o=S.createGain(),i.type="sine",i.frequency.value=3,o.gain.value=100,i.connect(o),o.connect(e.frequency),setTimeout(function(){return a.J=1},1e3*(t-S.currentTime)),r.start(t),i.start(t),r.stop(t+n),i.stop(t+n)}function B(e,t,n){var a=S.createOscillator(),r=(a.type="sawtooth",a.frequency.value=e,a.detune.value=0,S.createGain()),o=(r.gain.value=.5,a.connect(r),S.createBiquadFilter()),c=(o.type="notch",o.frequency.value=.3*S.sampleRate,o.Q.value=.3,S.createBiquadFilter());c.type="lowpass",c.frequency.setTargetAtTime(500,S.currentTime,0),c.Q.value=.04,c.gain.value=1,(e=S.createBiquadFilter()).type="highpass",e.frequency.setTargetAtTime(200,S.currentTime,0),e.Q.value=1,r.connect(o),o.connect(c),c.connect(e),(r=S.createGain()).gain.value=.5,e.connect(r),r.connect(M),M.connect(S.destination),a.start(t),a.stop(t+n)}function x(e,t,n){var a=S.createGain(),r=S.createOscillator(),o=S.createOscillator();r.type="sine",r.frequency.setValueAtTime(2*e,t),o.type="sine",o.frequency.setValueAtTime(4*e,t),o.detune.value=3,r.connect(a),o.connect(a),a.gain.setValueAtTime(l,t),a.gain.exponentialRampToValueAtTime(1e-4,t+n),r.start(t),o.start(t),r.stop(t+n),o.stop(t+n),a.connect(M),M.connect(S.destination)}function R(e,t,n){var a=S.createOscillator(),r=S.createOscillator(),o=S.createOscillator(),c=(a.type="sawtooth",r.type="sawtooth",o.type="sawtooth",a.frequency.value=e,r.frequency.value=4*e,o.frequency.value=2*e,a.detune.value=0,r.detune.value=2,o.detune.value=-3,S.createGain()),i=S.createGain(),s=S.createGain(),u=(c.gain.value=.8,i.gain.value=.6,s.gain.value=.6,a.connect(c),r.connect(i),o.connect(s),S.createBiquadFilter());u.type="notch",u.frequency.value=120,u.Q.value=1,(e=S.createBiquadFilter()).type="lowpass",e.frequency.setTargetAtTime(400,S.currentTime,0),c.connect(u),i.connect(u),s.connect(u),u.connect(e),e.connect(U),c=S.createOscillator(),i=S.createGain(),c.type="sine",c.frequency.value=3,i.gain.value=100,c.connect(i),i.connect(e.frequency),a.start(t),r.start(t),o.start(t),c.start(t),a.stop(t+n),r.stop(t+n),o.stop(t+n),c.stop(t+n)}function b(e,t,n){let a=t;e[c].forEach(([e,t])=>{1===e&&n(a),a+=t})}function w(e,t,n){let a=n;return e[o].forEach(([e,n])=>{0!==e&&t(f[e],a,n),a+=n}),a}const S=new(window.AudioContext||window.webkitAudioContext),M=S.createGain();M.gain.value=.5,M.connect(S.destination);var q=S.createDynamicsCompressor();q.threshold.setValueAtTime(-20,S.currentTime),q.knee.setValueAtTime(30,S.currentTime),q.ratio.setValueAtTime(4,S.currentTime),q.attack.setValueAtTime(.005,S.currentTime),q.release.setValueAtTime(.25,S.currentTime),q.connect(M);const U=S.createGain();U.gain.value=.9,n(S,U,"lowpass",150).connect(q);var V=S.createGain();V.gain.value=.6,n(S,V,"highpass",500).connect(q);const _=S.createGain(),L=(_.gain.value=.12,n(S,_,"bandpass",300,1).connect(q),S.createGain()),O=(L.gain.value=.4,S.createGain()),P=(O.gain.value=.25,S.createGain());let I;P.gain.value=.3,L.connect(q),O.connect(q),P.connect(q);const k=S.currentTime+.5;!function n(){var a=w(E,R,I||k),M=(w(v,D,I||k),w(m,C,I||k),w(d,x,I||k),I||k);if(b(g,M,i),b(T,M,s),b(F,M,y),!t()){var q=G;let e=I||k;(M=h)[o].forEach(([t,n])=>{t.forEach(t=>{q(f[t],e,n)}),e+=n})}r&&(.9<e.g.speed?w(A,B,I||k):.4<e.g.speed&&w(p,B,I||k)),o<7?o++:(o=2,l=.02,u=.1,r=!0),6<c?c=4:c++,I=a,setTimeout(n,1e3*(I-S.currentTime))}()}}}(c),c.$=function(e){function t(e,t,n){e[0]+=(t[0]-e[0])*n*.001,e[1]+=(t[1]-e[1])*n*.001,e[2]+=(t[2]-e[2])*n*.001}const n=document.getElementById("body");var a;const r=[{u:[.7,.7,.9],track:[1,1,1],D:[.3,.2,.4],g:[.8,.8,.8]},{u:[.7,.6,.4],track:[1,.8,.4],D:[.8,.5,.5],g:[.9,.9,.7]},{u:[.2,.1,.4],track:[.4,.9,.1],D:[.5,.9,.5],g:[.2,.8,.2]},{u:[.1,.1,.1],track:[.8,.9,1],D:[.8,.8,.9],g:[1,1,1]}],o={u:[...r[0].u],track:[...r[0].track],D:[...r[0].D],g:[...r[0].g]};return{update:function(c){var i=r[Math.abs(Math.floor(e.g.speed/.3))];i!==a&&(n.style.backgroundColor=`rgb(${i.u.map(e=>Math.floor(255*e)).join(",")})`,a=i),t(o.u,a.u,c),t(o.track,a.track,c),t(o.D,a.D,c),t(o.g,a.g,c)},current:o,keys:Object.keys(o)}}(c),c.g=function(e){const t={G:0,level:2,N:0,speed:.2,position:{x:0,y:0,z:0},P:{x:0,y:0,z:0}};var n=0,a=0;t.update=r=>{a+=.02*r*t.speed,t.N+=r/50*(.3*t.G-t.N),t.position.x+=r/100*(t.N-t.position.x),t.P.x=.01*Math.cos(.1*a),t.P.y=.02*-Math.sin(.05*a),t.speed+=r/50*(t.level/12-t.speed)*.1,2e3<(n+=r*e.j.o)&&(n=0,t.level=Math.max(2,t.level-1))};const r=new(window.AudioContext||window.webkitAudioContext);return t.da=e=>{var a=t.level+e,o=t.level,c=e;function i(){var e=.5*r.sampleRate,t=r.createBuffer(2,e,r.sampleRate);for(let a=0;a<t.numberOfChannels;a++){var n=t.getChannelData(a);for(let t=0;t<e;t++)n[t]=(2*Math.random()-1)*Math.pow(1-t/e,3)}return t}var s=[261.63,293.66,329.63,349.23,392,440,493.88,554.37,659.26,739.99,830.61,987.77];if(12<(l=o+c))for(o=0;o<c;o++){var u=s[Math.max(11-o,0)],l=r.createOscillator(),f=r.createOscillator(),m=(l.type="triangle",f.type="triangle",l.frequency.setValueAtTime(u,r.currentTime+.04*o),f.frequency.setValueAtTime(.99*u,r.currentTime+.04*o),(u=r.createGain()).gain.setValueAtTime(.1*(1-.15*o),r.currentTime+.04*o),u.gain.exponentialRampToValueAtTime(.2,r.currentTime+.04*o+.2),r.createBiquadFilter()),v=(m.type="lowpass",m.frequency.setValueAtTime(1500,r.currentTime),r.createConvolver());v.buffer=i(),l.connect(u),f.connect(u),u.connect(m),m.connect(v),v.connect(r.destination),l.start(r.currentTime+.04*o),f.start(r.currentTime+.04*o),l.stop(r.currentTime+.04*o+.2),f.stop(r.currentTime+.04*o+.2)}else for(c=o;c<l;c++){m=s[c%s.length],f=r.createOscillator(),u=r.createOscillator(),f.type="triangle",u.type="triangle",f.frequency.setValueAtTime(m,r.currentTime+.04*(c-o)),u.frequency.setValueAtTime(.99*m,r.currentTime+.04*(c-o)),(m=r.createGain()).gain.setValueAtTime(.1*(1-.15*(c-o)),r.currentTime+.04*(c-o)),m.gain.exponentialRampToValueAtTime(.2,r.currentTime+.04*(c-o)+.2),(v=r.createBiquadFilter()).type="lowpass",v.frequency.setValueAtTime(1500,r.currentTime);const e=r.createConvolver();e.buffer=i(),f.connect(m),u.connect(m),m.connect(v),v.connect(e),e.connect(r.destination),f.start(r.currentTime+.04*(c-o)),u.start(r.currentTime+.04*(c-o)),f.stop(r.currentTime+.04*(c-o)+.2),u.stop(r.currentTime+.04*(c-o)+.2)}12<a?t.level-=e:t.level=a,n=0},t}(c),c.track=function(e){const t={offset:{x:0,y:0}};var n=5e3,a={x:0,y:0},r=0,o=0;return t.update=c=>{var i,s=n/1e4;1<=s?(i=.1*e.g.speed,a={...t.offset},s=-.1-i,r=Math.random()*(.1+i-s)+s,o=Math.random()*(.2+i-i)+i,n=0):s<1&&(i=a.x,t.offset.x=i+(r-i)*Math.sin(Math.PI*s),i=a.y,t.offset.y=i+(o-i)*Math.sin(Math.PI*s)),n+=c*e.g.speed},t}(c),c.j=function(e){const c={o:0},i=e.h.m,s=e.h.createProgram("#version 300 es\n\n  precision mediump float;\n\n  in vec3 a;\n  in vec3 b;\n  in vec3 c;\n  in vec3 d;\n  in vec4 e;\n  in vec4 f;\n  in vec4 g;\n  in vec4 r;\n\n  uniform float h;\n  uniform vec2 i;\n  uniform mat4 j;\n  uniform vec4 k;\n  uniform vec4 l;\n  uniform vec4 q;\n  uniform vec4 m;\n  uniform float n;\n  uniform vec3 o;\n  uniform vec3 p;\n\n  out float vDepth;\n  out vec3 vColor;\n\n  void main() {\n    float levelScale = length(f * k);\n    float powerupScale = length(g * l);\n    float powerupValue = length(g * m);\n    vec4 opponentVec = (r * q);\n\n    vec3 scaledVertex = a * c * (.4 + (levelScale * 0.4));\n\n    vec3 bgTrans = b;\n    bgTrans.z -= (n / 100.);\n    bgTrans.z = mod(bgTrans.z, 20.) - 5.;\n    bgTrans *= e.x;\n\n    vec3 oTrans = b;\n    oTrans += vec3(0., 0., powerupScale);\n    oTrans.x -= step((powerupValue * 0.12) - 0.3, b.y) * 9999.;\n    oTrans *= e.y;\n\n    vec3 playerTrans = b;\n    playerTrans += o;\n    playerTrans *= e.z;\n\n    vec3 opponentTrans = b;\n    opponentTrans.z += opponentVec.x + opponentVec.y + opponentVec.z + opponentVec.w;\n\n    opponentTrans.x = (\n      smoothstep(.0, .4, cos((opponentTrans.z + (n * 0.02)) * 0.01))\n      - smoothstep(.7, 1.,sin((opponentTrans.z + (n * 0.05)) * 0.01))\n    ) * .3;\n\n    opponentTrans *= e.w;\n\n    vec3 combined = bgTrans + oTrans + playerTrans + opponentTrans;\n    float plainMod = 1. - step(0.01, abs(length(combined)));\n    combined += (b * plainMod);\n\n    vec4 vertexPosition = j * vec4(scaledVertex + combined, 1.);\n    float depth = max(vertexPosition.z * vertexPosition.z * 0.1, 0.);\n    vDepth = (depth / vertexPosition.w);\n\n    vec3 color = d + (vec3(f.rgb * levelScale));\n\n    vColor = color * ((1. + (h * .6)) * (0.2 + (vDepth * 0.6)));\n    vColor += (plainMod * vec3(.3));\n\n    gl_Position = vertexPosition + vec4(i * depth, 0, 0.);\n  }","#version 300 es\n\n  precision mediump float;\n\n  const float fn = 0.3;\n  const float ff = 1.4;\n\n  in float vDepth;\n  in vec3 vColor;\n\n  out vec4 oColor;\n\n  void main() {\n    float fog = smoothstep(fn, ff, vDepth);\n    oColor = mix(vec4(vColor, 1.), vec4(0.), fog);\n  }"),u=i.createVertexArray();i.bindVertexArray(u);var l=i.createBuffer();i.bindBuffer(i.ELEMENT_ARRAY_BUFFER,l),i.bufferData(i.ELEMENT_ARRAY_BUFFER,o,i.STATIC_DRAW);const f=e.h.A(s,"a",3,!1),m=(f.i(r),e.h.A(s,"d",3)),v=e.h.A(s,"f",4),p=e.h.A(s,"e",4),A=e.h.A(s,"g",4),d=e.h.A(s,"b",3),h=e.h.A(s,"c",3),g=e.h.A(s,"r",4),T=(i.bindVertexArray(null),i.getUniformLocation(s,"i")),E=i.getUniformLocation(s,"k"),F=i.getUniformLocation(s,"j"),y=i.getUniformLocation(s,"n"),D=i.getUniformLocation(s,"h"),G=i.getUniformLocation(s,"o"),C=i.getUniformLocation(s,"p"),B=i.getUniformLocation(s,"l"),x=i.getUniformLocation(s,"m"),R=i.getUniformLocation(s,"q");c.X=(e,t)=>{d.i([.3*e,.1*t-.3,0]),m.i([.5,.5,t/5]),h.i([.3,.05,.2]),p.i([0,1,0,0]),A.i([-1==e?1:0,0==e?1:0,1==e?1:0,0]),v.i([0,0,0,0]),g.i([0,0,0,0])},c.Z=(e,t)=>{d.i([e,-.3,t]),m.i([.8,.8,.8]),h.i([.2,.02,.37]),p.i([0,0,0,0]),A.i([0,0,0,0]),v.i([0,0,0,0]),g.i([0,0,0,0])},c.L=(e,t,n,a,r,o=-1)=>{d.i([e,-.2,t]),m.i([Math.max(.4,9*n),Math.max(.4,10*n),Math.max(.4,12*n)]),h.i([n,a,r]),p.i([0,0,-1===o?1:0,-1===o?0:1]),A.i([0,0,0,0]),v.i([0,0,0,0]),g.i([0===o?1:0,1===o?1:0,2===o?1:0,3===o?1:0])},c.W=()=>{var e=2*Math.random()*Math.PI;d.i([1.6*Math.cos(e),1.6*Math.sin(e),20*Math.random()-4]),e=Math.random()*(1-.9)+.9,m.i([e,e,e]),e=.4+.2*Math.random(),h.i([e,e,.6+.4*Math.random()]),p.i([1,0,0,0]),A.i([0,0,0,0]),e=Math.random(),v.i([+(0<e&&e<.1),+(.1<e&&e<.2),+(.2<e&&e<.3),+(.3<e&&e<.4)]),g.i([0,0,0,0])};let b=1010*Math.random()+1304;return c.ha=r=>{b+=r*e.g.speed*1.6*c.o,i.useProgram(s),i.bindVertexArray(u),r=1/Math.tan((Math.PI/3+.4*e.g.speed)/2),r=new Float32Array([r/(i.canvas.width/i.canvas.height),0,0,0,0,r,0,0,0,0,1/-999.9*1000.1,-1,0,0,1/-999.9*200,0]);var l=[1.2*e.g.N,0,0],v=[10*(1-c.o),10*(1-c.o),10],p=(v=t([l[0]-v[0],l[1]-v[1],l[2]-v[2]]),t(n([0,1,0],v))),A=n(v,p);for(l=new Float32Array([p[0],A[0],v[0],0,p[1],A[1],v[1],0,p[2],A[2],v[2],0,-a(p,l),-a(A,l),-a(v,l),1]),v=new Float32Array(16),p=0;p<4;p++)for(A=0;A<4;A++)for(let e=v[4*A+p]=0;e<4;e++)v[4*A+p]+=r[4*e+p]*l[4*A+e];i.uniformMatrix4fv(F,!1,v),i.uniform1f(y,b),i.uniform1f(D,e.g.speed),i.uniform2f(T,e.track.offset.x,e.track.offset.y),i.uniform4f(B,e.C.l[0],e.C.l[1],e.C.l[2],0),i.uniform4f(x,e.C.values[0],e.C.values[1],e.C.values[2],0),i.uniform3f(G,e.g.position.x+e.g.P.x,e.g.position.y+e.g.P.y,e.g.position.z+e.g.P.z),i.uniform3f(C,.2,-.1,.1),i.uniform4f(E,e.s.v.H,e.s.v.F,e.s.v.M,e.s.v.J),i.uniform4f(R,e.B.l[0],e.B.l[1],e.B.l[2],e.B.l[3]),f.V(),i.drawElementsInstanced(i.TRIANGLES,o.length,i.UNSIGNED_SHORT,0,m.aa().length/3),i.bindVertexArray(null)},c}(c),c.S=(i=c,{ba:(s=(e,t="")=>{const n=i.h.createProgram("#version 300 es\n\n  precision mediump float;\n\n  const vec2 positions[3] = vec2[3](\n      vec2(-1.0, -1.0),\n      vec2(3.0, -1.0),\n      vec2(-1.0, 3.0)\n  );\n\n  void main() {\n      gl_Position = vec4(positions[gl_VertexID], -1.0, 1.0);\n  }\n  ",`#version 300 es\nprecision mediump float;const float tau = 3.1415 * 2.;uniform float c;uniform float f;uniform vec2 b;uniform sampler2D a;uniform vec4 d;uniform vec2 e;out vec4 outColor;${e}void main() {vec2 uv = gl_FragCoord.xy / b;${t}}`),a=i.h.m.getUniformLocation(n,"a"),r=i.h.m.getUniformLocation(n,"b"),o=i.h.m.getUniformLocation(n,"c"),c=i.h.m.getUniformLocation(n,"d"),s=i.h.m.getUniformLocation(n,"e"),u=i.h.m.getUniformLocation(n,"f");var l=0;return e=>{l+=e,i.h.m.useProgram(n),i.h.m.uniform1f(o,l),i.h.m.uniform2f(r,i.h.m.canvas.width,i.h.m.canvas.height),i.h.m.uniform4f(c,i.s.v.H,i.s.v.F,i.s.v.M,i.s.v.J),i.h.m.uniform1i(a,0),i.h.m.uniform1f(u,i.g.speed),i.h.m.uniform2f(s,i.track.offset.x,i.track.offset.y),i.h.m.drawArrays(i.h.m.TRIANGLES,0,3)}})("\n  vec4 avgS(vec2 uv, float xd, float yd) {\n    const float samples = 6.;\n    vec4 r = vec4(0.);\n\n    for (float i = 0.; i < (samples * 2.); i++) {\n      float baseOffset = mod(i, samples) - (samples / 2.);\n      float xOffset = (baseOffset / (samples / 2.)) * (1. - step(samples, i));\n      float yOffset = (baseOffset / (samples / 2.)) * step(samples, i);\n      vec2 sampleUv = uv + vec2(xOffset * xd, yOffset * yd);\n\n      r += texture(a, sampleUv);\n    }\n\n    return r / (samples * 2.);\n  }\n","\n  const float size = 6.;\n  float sDistX = 1. / b.x;\n  float sDistY = 1. / b.y;\n\n  vec4 baseSample = texture(a, uv);\n  vec4 glowSample = avgS(uv, sDistX * 10., sDistY * 10.);\n  glowSample += avgS(uv, sDistX * 6., sDistY * 6.);\n  glowSample += avgS(uv, sDistX * 4., sDistY * 4.);\n  glowSample += avgS(uv, sDistX * 2., sDistY * 2.);\n  glowSample /= (4. - (d.b * 1.5));\n  glowSample = clamp(glowSample - smoothstep(.2, 0.4, baseSample), 0., 1.);\n  outColor = baseSample += glowSample;\n"),u:s("","\n  vec4 baseSample = texture(a, uv);\n  vec2 offset = (e * .5);\n  vec2 c = vec2(.5, .5) + offset;\n  float sizeMod = f * 0.4 + (d.g * 0.2);\n  float cDist = 1. - smoothstep(0., 1. + sizeMod, distance(uv, c));\n  vec4 xSample = texture(a, uv - ((uv - c) * (cDist * .01)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .02)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .03)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .05)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .06)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .07)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .08)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .10)));\n  xSample += texture(a, uv - ((uv - c) * (cDist * .12)));\n  xSample *= 0.25;\n\n  vec3 shadowSample = ((xSample.rgb * cDist) * .7);\n  vec4 color = vec4(cDist + .2, cDist + .2, cDist + .7, 1.) * 0.6;\n  color.rgb -= (shadowSample * 0.6);\n  color.rgb *= vec3(1., .8, .7);\n  color.rgb *= (cDist * cDist * 1.2) + 0.4;\n  outColor = mix(color, baseSample, baseSample.a);\n  outColor += vec4(vec3(pow(cDist, 40.) * 0.2), 0.);\n"),ca:s("","\n  vec4 baseSample = texture(a, uv);\n  vec2 offset = (e * .5);\n  vec2 c = vec2(.5, .5) + offset;\n  float cDist = 1. - smoothstep(0., 1., distance(uv, c));\n\n  vec3 solarColor = vec3(\n    smoothstep(.1, .7, baseSample.r),\n    smoothstep(.1, .5, baseSample.g),\n    smoothstep(.2, .9, baseSample.b)\n  );\n\n  outColor = vec4(mix(vec3(\n      smoothstep(cos(f * 5.) * 0.1, 1. - (f * .1), baseSample.r),\n      smoothstep(sin(f * 14.) * 0.2, .7 + (f * .4), baseSample.g),\n      smoothstep(sin(f * 28.) * 0.3, 1. - (f * .3), baseSample.b)\n    ), solarColor, 0.1),\n    1.\n  );\n")}),c.C=function(t){const n={l:[25*Math.random()+5,25*Math.random()+5,25*Math.random()+5],values:[e(),e(),e()],reset:()=>{n.l=[25*Math.random()+5,25*Math.random()+5,25*Math.random()+5],n.values=[e(),e(),e()]},update:a=>{for(var r=0;r<3;r++){var o=.6<n.l[r],c=(n.l[r]-=a*t.g.speed*.012*t.j.o,n.l[r]<=.6);o&&c&&t.g.G===r-1&&t.g.da(n.values[r]),n.l[r]<0&&(n.l[r]=20*Math.random()+10,n.values[r]=e())}}};return n}(c),c.controls=function(e){function t(t,n){if(a||(a=!0,e.s.T())," "===t.key&&e.j.o<.01&&!e.race.I&&e.race.start(),!(e.j.o<.9))switch(t.key.toLowerCase()){case"a":case"h":case"arrowleft":!r.left&&n?e.g.G=1:r.right||n||(e.g.G=0),r.left=n;break;case"arrowright":case"l":case"d":!r.right&&n?e.g.G=-1:r.left||n||(e.g.G=0)}}function n(e,n){var a=e.changedTouches.item(0).clientX<window.innerWidth/2,r=e.changedTouches.item(0).clientY>window.innerHeight/2;t({key:a?"arrowleft":"arrowright"},n),r&&t({key:" "},n),e.preventDefault()}var a=!1;const r={left:!1,right:!1};return document.addEventListener("keydown",function(e){t(e,!0)}),document.addEventListener("keyup",function(e){t(e,!1)}),document.addEventListener("touchstart",function(e){n(e,!0)}),document.addEventListener("touchend",function(e){n(e,!1)}),document.addEventListener("touchcancel",function(e){n(e,!1)}),r}(c),c.B=function(e){const t=[1,3,5,7],n=[.67,.75,.82,.88],a={l:[...t],U:[...n],reset:()=>{a.l=[...t],a.U=[...n]},update:t=>{a.ea=5;for(var n=0;n<4;n++)a.l[n]+=(t/100*a.U[n]-t/100*e.g.speed)*e.j.o,a.l[n]<.2&&--a.ea}};return a}(c),c.ia=function(e){const t=document.querySelector("#intro"),n=document.querySelector("#ui"),a=document.querySelector("#speed"),r=document.querySelector("#place .h"),o=document.querySelector("#time .h"),c=document.querySelector("#outro"),i=document.querySelector("#op"),s=document.querySelector("#ot"),u=document.querySelector("#minimap"),l=(e,t,...n)=>{var a,r=document.createElement("div");for(a of(r.id=t,e.appendChild(r),n))r.classList.add(a);return r},f=Array.from({length:13},(e,t)=>l(a,"l"+t,"l")),m=(f[12].textContent="13",Array.from({length:4},(e,t)=>l(u,"p"+t,"p")));var v=0;return{update:()=>{if(e.g.level!==v){v=e.g.level;for(var a=0;a<13;a++){const t=a<e.g.level;l=t?"o":"x",p=t?"x":"o",(u=f[a]).classList.remove(l),u.classList.add(p)}}var u,l,p;if(!e.race.I&&e.race.finished){switch(c.style.opacity=1,a=[],e.race.O){case 1:a.push("1st"),a.push("You did it! Absolute legend! But can you do it again?");break;case 2:a.push("2nd"),a.push("Awesome, almost there! Next time, surely.");break;case 3:a.push("3rd"),a.push("Nice work! It's a placement. By a hair.");break;case 4:case 5:case 6:a.push(e.race.O+"th"),a.push("Could be worse, but not by a lot. Go again!")}i.textContent=a[0],s.textContent=a[1]}else c.style.opacity=0;m.forEach((t,n)=>{t.style.top=Math.max(-18,Math.min(18,-.2*e.B.l[n]))-1+"vh"}),r.textContent=e.race.O,o.textContent=Math.floor(e.race.K),n.style.opacity=1<=e.j.o?1:0,t.style.opacity=e.race.I||e.race.finished?0:1}}}(c),c.race=function(e){const t={K:90,I:!1,finished:!1,O:5,start:()=>{e.B.reset(),e.C.reset(),e.g.level=5,t.K=90,t.I=!0,t.finished=!1},update:n=>{if(!t.I||t.finished)0<e.j.o&&(e.j.o=Math.max(0,e.j.o-5e-4*n),e.g.level*=.9);else for(var a of(e.j.o<1&&(e.j.o=Math.min(1,e.j.o+5e-4*n)),t.K-=n/1e3,t.K<0&&(t.K=0,t.finished=!0,t.I=!1),t.O=5,e.B.l))a<0&&--t.O}};return t}(c);for(var u,l,f=0;f<200;f++)c.j.W();for(u of[-.3,0,.3])for(f=-4;f<20;f+=.27)c.j.Z(u,f);for((u=(e=-1)=>{c.j.L(0,.55,.12,.02,.03,e),c.j.L(0,.6,.01,.1,.2,e),c.j.L(0,.52,.04,.03,.08,e),c.j.L(-.04,.6,.04,.01,.23,e),c.j.L(.04,.6,.04,.01,.23,e)})(),f=0;f<4;f++)u(f);for(l of[-1,0,1])for(var m of[1,2,3,4,5])c.j.X(l,m);c.h.Y(c.j.ha),c.h.R(c.S.ba),c.h.R(c.S.u),c.h.R(c.S.ca);var v=performance.now();!function e(){var t=Math.min(performance.now()-v,20);v=performance.now(),c.g.update(t),c.h.ga(t),c.B.update(t),c.$.update(t),c.track.update(t),c.ia.update(t),c.C.update(t),c.s.fa(t),c.race.update(t),requestAnimationFrame(e)}(),document.getElementById("glcanvas").addEventListener("click",c.s.T)}()</script>