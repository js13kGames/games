<!doctype html><title>Chesspursuit</title><style>body{background-color:#000;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}body,canvas,html{margin:0;padding:0}canvas,svg{display:block;position:absolute;top:0;left:0}svg{overflow:hidden}#root{cursor:pointer}.help{box-sizing:border-box;font-size:14px;padding:8px;color:#999;font-family:sans-serif;text-align:center;position:absolute;left:0;bottom:0;width:100%}</style><div class=help>Use arrow keys or mouse to move around.<br>You can use the 'return' key to pause the game (but that's cheating !).<br>You don't need to really know the <a href=https://en.wikipedia.org/wiki/Chess#Movement>chess rules</a> to play, but that could definitely help!</div><script>function e(){this.B=function(e){for(var t=0;24>t;t++)this[String.fromCharCode(97+t)]=e[t]||0;.01>this.c&&(this.c=.01),.18>(e=this.b+this.c+this.e)&&(e=.18/e,this.b*=e,this.c*=e,this.e*=e)}}var t,i=new function(){var t,i,r,l,n,a,o,p,c,s,f,d;this.A=new e,this.reset=function(){var e=this.A;l=100/(e.f*e.f+.001),n=100/(e.g*e.g+.001),a=1-e.h*e.h*e.h*.01,o=-e.i*e.i*e.i*1e-6,e.a||(f=.5-e.n/2,d=5e-5*-e.o),p=1+e.l*e.l*(0<e.l?-.9:10),c=0,s=1==e.m?0:(1-e.m)*(1-e.m)*2e4+32},this.D=function(){this.reset();var e=this.A;return t=e.b*e.b*1e5,i=e.c*e.c*1e5,r=e.e*e.e*1e5+12,3*((t+i+r)/3|0)},this.C=function(e,h){var u=1!=(q=this.A).s||q.v,y=q.v*q.v*.1,v=1+3e-4*q.w,L=q.s*q.s*q.s*.1,m=1+1e-4*q.t,w=1!=q.s,k=q.x*q.x,g=q.g,b=q.q||q.r,x=q.r*q.r*q.r*.2,C=q.q*q.q*(0>q.q?-1020:1020),S=q.p?32+((1-q.p)*(1-q.p)*2e4|0):0,E=q.d,N=q.j/2,A=q.k*q.k*.01,T=q.a,M=t,I=1/t,P=1/i,R=1/r;(q=5/(1+q.u*q.u*20)*(.01+L))>.8&&(q=.8);for(var Q,X,z,B,D,q=1-q,Y=!1,j=0,F=0,K=0,U=0,O=0,G=0,H=0,W=0,V=0,_=0,J=Array(1024),Z=Array(32),$=J.length;$--;)J[$]=0;for($=Z.length;$--;)Z[$]=2*Math.random()-1;for($=0;h>$;$++){if(Y)return $;if(S&&++V>=S&&(V=0,this.reset()),s&&++c>=s&&(s=0,l*=p),(l*=a+=o)>n&&(l=n,g>0&&(Y=!0)),X=l,N>0&&(_+=A,X*=1+Math.sin(_)*N),8>(X|=0)&&(X=8),T||(0>(f+=d)?f=0:f>.5&&(f=.5)),++F>M)switch(F=0,++j){case 1:M=i;break;case 2:M=r}switch(j){case 0:K=F*I;break;case 1:K=1+2*(1-F*P)*E;break;case 2:K=1-F*R;break;case 3:K=0,Y=!0}b&&(0>(z=0|(C+=x))?z=-z:z>1023&&(z=1023)),u&&v&&(1e-5>(y*=v)?y=1e-5:y>.1&&(y=.1)),D=0;for(var ee=8;ee--;){if(++H>=X&&(H%=X,3==T))for(Q=Z.length;Q--;)Z[Q]=2*Math.random()-1;switch(T){case 0:B=f>H/X?.5:-.5;break;case 1:B=1-H/X*2;break;case 2:B=.225*((0>(B=1.27323954*(B=6.28318531*((B=H/X)>.5?B-1:B))+.405284735*B*B*(0>B?1:-1))?-1:1)*B*B-B)+B;break;case 3:B=Z[Math.abs(32*H/X|0)]}u&&(Q=G,0>(L*=m)?L=0:L>.1&&(L=.1),w?(O+=(B-G)*L,O*=q):(G=B,O=0),U+=(G+=O)-Q,B=U*=1-y),b&&(J[W%1024]=B,B+=J[(W-z+1024)%1024],W++),D+=B}D=.125*D*K*k,e[$]=D>=1?32767:-1>=D?-32768:32767*D|0}return h}};window.jsfxr=function(e){i.A.B(e);var t=i.D();e=new Uint8Array(4*((t+1)/2|0)+44),t=2*i.C(new Uint16Array(e.buffer,44),t),(r=new Uint32Array(e.buffer,0,44))[0]=1179011410,r[1]=t+36,r[2]=1163280727,r[3]=544501094,r[4]=16,r[5]=65537,r[6]=44100,r[7]=88200,r[8]=1048578,r[9]=1635017060,r[10]=t,t+=44;for(var r=0,l="data:audio/wav;base64,";t>r;r+=3){var n=e[r]<<16|e[r+1]<<8|e[r+2];l+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&n]}return l},function(){function e(){this.sounds={}}e.prototype.add=function(e,t,i){this.sounds[e]=[],i.forEach(function(i,r){this.sounds[e].push({tick:0,count:t,pool:[]});for(var l=0;t>l;l++){var n=new Audio;n.src=jsfxr(i),this.sounds[e][r].pool.push(n)}},this)},e.prototype.play=function(e){var t=this.sounds[e],i=t.length>1?t[Math.floor(Math.random()*t.length)]:t[0];i.pool[i.tick].play(),i.tick<i.count-1?i.tick++:i.tick=0},(t=new e).add("check",1,[[2,,.1747,,.1291,.6731,.2,-.2999,,,,,,.4368,.1862,,.28,,1,,,.1596,,.5]]),t.add("move",5,[[3,,.0316,,.1483,.5871,,-.6609,,,,,,,,,,,1,,,.0227,,.25]]),t.add("capture",5,[[0,,.3065,,.2516,.36,,.1584,,,,,,.1149,,,,,1,,,.2188,,.25]]),t.add("checkmate",1,[[1,,.2402,,.3917,.2242,,.1535,,,,,,,,.5609,,,1,,,,,.5]])}(),window.onload=function(){function e(){for(var e=pe.length-1,t=0;t<pe.length;t++)if(ne<pe[t]){t>0&&(e=t-1);break}i(e),N=null,ce=-1}function i(e){function t(){var e=q.ceil(l/2);pe.push(a+e);for(var t=0;l>t;t++){if(oe[a]=[],t==e)for(var i=0;U>i;i++)oe[a][i]={checkPoint:!0};a++}}function i(){var t,i=Array.prototype.slice.call(arguments);t="object"==typeof i[0]?i.shift():{};var l,o,p,c,s=e<pe.length,f=a;for(p=i.length-1;p>=0;p--){if((o=i[p]).length>U)throw new Error;if(oe[a]=[],s&&""!==o)for(c=0;c<o.length;c++){var d=o.charAt(c);if(" "!==d&&"."!==d){var h=d.toLowerCase(),u=r(h,a,c);t.showThreat==h&&(l=oe[a][c]),t.intro&&(u.piece.intro=!0)}}a++}if(l)for(l.piece.showThreat=!0,p=f;a>p;p++)for(o=oe[p],c=0;U>c;c++){var y=n(p,c);y&&y.piece==l.piece&&(oe[p][c]||(oe[p][c]={}),oe[p][c].showThreat=!0)}}oe&&function(){for(var e in oe)if(oe[e])for(var t in oe[e]){var i=oe[e][t];i&&i.piece&&k(i.piece)}}(),oe=[],pe=[0];var l=5,a=0;i({intro:!0},"","","",me?"  reqr":"",me?"   kk":"","","","","","","","kkkkkkkk"),i({showThreat:"p"},"","","    p","","","","",""),i("  pppp","  pppp","","  p","","     p",""," p"),i("","pppppp","","  pppppp","","pppppp","",""),i("","pp   ppp","  p p","   p","","","",""),i("","   pp","p p  p p"," p    p","","","",""),i("","    ppp","     p","ppp"," p   ppp","      p","",""),t(),i({showThreat:"r"},"","   p","","   r","","   p","",""),i("","","r"," r","  r","   r","    r","     r","pppppp"),i("","","","       p","    rp r","","","pp","r   p  p","p"),i("","p     r","r     p","r    p","","   p","   p","p  ppppp",""),t(),i({showThreat:"b"},"","","","","...b","","","",""),i(""," p p p","b b b b","","","","","",""),i("","r.p..p.r","p......p","","b      b","pp....pp","",""),i("","r"," r  p..b","     ..r","....p","...p","..p","pp.....p"),t(),i({showThreat:"k"},"","","   k","","","","",""),i("p","r.....p","","","......kk","","pkk",""),i("p   pppp","r    b r","   p b p","","",""," k","","",""),t(),i({showThreat:"l"},"","","","   l","","","",""),i("l.llllll","l.l....l","..l.llll",".ll.l   ","l...l l ","l.lll l ","l.    l ","lllllll "),i(" p  pll"," l p   l","lpl p p ","     lp","ll ll l"," l  l","",""),i("","  r","  llk","     .","   l ..","   p  pb","  . .  l","  p  l","","","","",""),t(),i("","c","","","","",""),A=a,0===e?(de=r(be,5,4).piece,ne=2):(ne=pe[e],de=r(be,ne,3).piece,ne-=4)}function r(e,t,i){var r={shape:null,type:e,row:t,col:i,showThreat:!1};if(oe[t]||(oe[t]=[]),oe[t][i]||(oe[t][i]={}),oe[t][i].piece=r,e==Ae)for(var l=0;U>l;l++)3!=l&&4!=l&&(oe[t][l]||(oe[t][l]={}),oe[t][l].wall=!0);return oe[t][i]}function l(e,i){var r=de.col,l=de.row;0>i?i=0:i>=U&&(i=U-1);var a=q.floor(ne),o=ce-2;if(a>e?e=a:e>=o&&(e=o),i!=r||e!=l){var c=oe[l][r];oe[e]||(oe[e]=[]);var s=oe[e][i];if(s||(s={},oe[e][i]=s),!s.wall){var f=n(e,i);f?(t.play("check"),de.invalid=!0,de.invalidCol=i,de.invalidRow=e,de.threateningPiece=f.piece,i=r,e=l):(de.invalid=!1,s.piece?(function(e){if(fe.push(e),e.removedTime=$,e.justRemoved=!0,e.showThreat)for(var t=e.row-U;t<e.row+U;t++){var i=oe[t];if(i)for(var r=e.col-U;r<e.col+U;r++)i[r]&&(i[r].showThreat=!1)}}(s.piece),t.play("capture")):t.play("move"),c.piece=null,s.piece=de),de.oldCol=r,de.oldRow=l,de.anim=!0,de.animStartTime=$,de.col=i,de.row=e,e>=A&&p(!0,!0)}}}function n(e,t){var i,r,l,n;if(i=a(e,t,Ne))return i;if(i=a(e+1,t-1,xe)||a(e+1,t+1,xe))return i;for(l=t-1;l>=0;l--)if((n=a(e,l))&&n.piece){if(n.piece.type==Ce)return n;break}for(l=t+1;U>=l;l++)if((n=a(e,l))&&n.piece){if(n.piece.type==Ce)return n;break}for(r=e+1;e+U>=r;r++)if((n=a(r,t))&&n.piece){if(n.piece.type==Ce)return n;break}for(r=e-1;r>=e-U;r--)if((n=a(r,t))&&n.piece){if(n.piece.type==Ce)return n;break}for(l=t-1,r=e-1;l>=0;l--,r--)if((n=a(r,l))&&n.piece){if(n.piece.type==Se)return n;break}for(l=t+1,r=e-1;U>l;l++,r--)if((n=a(r,l))&&n.piece){if(n.piece.type==Se)return n;break}for(l=t-1,r=e+1;l>=0;l--,r++)if((n=a(r,l))&&n.piece){if(n.piece.type==Se)return n;break}for(l=t+1,r=e+1;U>l;l++,r++)if((n=a(r,l))&&n.piece){if(n.piece.type==Se)return n;break}return a(e+2,t-1,Ee)||a(e-2,t-1,Ee)||a(e+2,t+1,Ee)||a(e-2,t+1,Ee)||a(e+1,t-2,Ee)||a(e-1,t-2,Ee)||a(e+1,t+2,Ee)||a(e-1,t+2,Ee)}function a(e,t,i){var r=oe[e];if(r){var l=r[t];if(l&&l.piece&&(!i||l.piece.type==i))return l}}function o(){window.stb&&stb(),re?(0===pt.space||Qe.click)&&(p(!1),pt.space=-1):(me?(ge>=0&&(0===pt.space||Qe.click)&&(pt.space=-1,s()),function(){var e,t,i,r,l=oe[8][3].piece,n=de;$=Date.now();var a=!T;if(a&&(T=$,function(){if(Q)for(var e=0;e<Q.length;e++){var t=Q[e];if(t.e)for(var i in t.to)t.e[i]=t.to[i]}Q=[]}(),l&&(l.talking=!1,l.talkingStarTime=$),n.talking=!1,n.talkingStarTime=$),-1==ge)V.style.opacity=0,J.style.opacity=0,we=0,c(),N=null,ge=0;else if(0===ge);else if(1==ge)a&&(g(!0,["Surrender Black King !","Your army is defeated, and your Queen is mine !"]),l.talking=!0);else if(2==ge){if(a)for(b(),t=0;U>t;t++)f((i=oe[0][t]).piece,{row:2,col:t+(t%2==0?1:-1)},.1*t,.5)}else if(3==ge)a&&(g(!0,["You thought I'd only bring two knights to battle ?","You are surrounded,","admit defeat now and I shall be merciful."]),l.talking=!0);else if(4==ge)a&&(g(!1,["Never !"]),n.talking=!0);else if(5==ge)a&&(g(!0,["As you wish...","I am taking the prisoner back to the castle.","Knights, capture him, I want him alive."]),l.talking=!0);else if(6==ge){if(a){for(b(),t=2;5>=t;t++)(i=oe[8][t])&&(f(i.piece,{row:9},0,.5),f(i.piece,{row:10},1,.5));f(oe[7][3].piece,{row:8,col:1},.5,.5),f(oe[7][3].piece,{row:10,col:2},1.5,.5),f(oe[7][4].piece,{row:8,col:6},.5,.5),f(oe[7][4].piece,{row:10,col:5},1.5,.5)}}else if(7==ge){if(a)for(g(!1,['It looks like our roles are <tspan fill="red" font-family="impact">REVERSED<animate attributeType="CSS" attributeName="fill" from="red" to="orange" dur="0.5s" repeatCount="indefinite"/></tspan> my Queen.',"Today, it is my turn to protect you !"]),n.talking=!0,e=1;2*U>e;e++)if(r=oe[e])for(t=0;U>t;t++)(i=r[t])&&i.piece&&i.piece.intro&&(k(i.piece),r[t]={})}else 8==ge&&(a&&(b(),ye.style.display="none"),(ke=($-T)/4e3)>1?ge=9:(ke=q.sin(ke*Y/2),0>(we=(ke-.2)/.6)?we=0:we>1&&(we=1),V.style.opacity=we,ke>.8&&(Le.style.opacity=(1-ke)/.2,J.style.opacity=1-Le.style.opacity)));if(a)if(Q.length){ye.style.opacity=0;var o=Q[0].e==M&&Q[0].to._y==tt,p=Q[Q.length-1],d=p.du+p.de;o?f(ye.style,{opacity:1},d+2,.1):ge>1&&8>ge&&function(e,t){Q.push({cb:e,de:0,du:t})}(s,d)}else ye.style.opacity=1;(function(){for(var e,t=($-T)*ee,i=0;i<Q.length;i++){var r=Q[i];if(t<=r.de);else if(t>=r.de+r.du)r.cb&&(r.cb(),r.cb=null);else if(r.e){if(!r.from)for(e in r.from={},r.to)r.from[e]=r.e[e];var l=(t-r.de)/r.du;for(e in l=q.sin(l*Y/2),r.to)r.e[e]=r.from[e]*(1-l)+r.to[e]*l}}M.setAttributeNS(null,"y",M._y)})(),9==ge&&(me=!1,we=1,Le.style.display="none",V.style.opacity=1,J.style.opacity=1,ye.style.display="none",b(),de.talking=!1),N=$}()):(function(){if(!(0>=ce||de.invalid||me)){var e,t=0,i=0;if(Re||((pt.down==Ie||0===pt.down)&&(i=-1),(pt.up==Ie||0===pt.up)&&(i=1),(pt.left==Ie||0===pt.left)&&(t=-1),(pt.right==Ie||0===pt.right)&&(t=1),(t||i)&&(t?(pt.up<=Ie&&pt.up>0&&(i=1),pt.down<=Ie&&pt.down>0&&(i=-1)):(pt.left<=Ie&&pt.left>0&&(t=-1),pt.right<=Ie&&pt.right>0&&(t=1)),l(de.row+i,de.col+t),Re=!0)),Re){var r=!0;for(e in ot)if(ot[e]){r=!1;break}Re=!r}for(e in pt)pt[e]>=1?pt[e]++:pt[e]>Pe&&pt[e]--;!de.anim&&Qe.x>0&&Qe.x<K&&Qe.y>F&&Qe.y<K+F?(y(Qe.x/K,(Qe.y-F)/K),ze=q.floor(y.res.x*U),Xe=q.floor(y.res.y*U+ne),(t=ze-de.col)>1?t=1:-1>t&&(t=-1),(i=Xe-de.row)>1?i=1:-1>i&&(i=-1),Xe=de.row+i,ze=de.col+t,Qe.click&&(t||i)&&l(Xe,ze)):(ze=-1,Xe=-1)}}(),c()),function(){for(var e,t,i=ce-G-5;ce>=i;i++)if(t=oe[i])for(var r=0;U>r;r++)if(t[r]&&t[r].piece){var l=t[r].piece;if(d(l.row,l.col,l),l.talking){var n=-q.abs(q.sin(($-l.talkingStarTime)*Y/800))*O*.2;l.y+=n}h(l),l.y>de.y&&(!e||e.y>l.y)&&(e=l)}var a;if(de.anim)if(0>(a=de.invalid?ee*($-de.animStartTime)/ue:ee*($-de.animStartTime)/he)||a>=1)de.anim=!1,de.invalid&&de.threateningPiece&&(de.threateningPiece.shape.style.filter="none"),de.invalid=!1;else if(a=q.sin(a*Y*.5),de.invalid){d(de.row,de.col);var o=.4*(.5>a?a:1-a)*O,p=q.sin(6*a*Y)*o;de.x+=p,h(de),de.threateningPiece.shape.style.filter="url(#"+Te+")"}else d(de.oldRow,de.oldCol),de.opacity=a*de.opacity+(1-a)*d.res.opacity,de.scale=a*de.scale+(1-a)*d.res.scale,de.x=a*de.x+(1-a)*d.res.x,de.y=a*de.y+(1-a)*d.res.y,h(de);for(f=0,v=fe.length;v>f;f++){var c=fe[f],s=($-c.removedTime)/1e3;s>1?(k(c),fe[f]=fe[v-1],v--,f--,fe=fe.slice(0,v)):(c.justRemoved&&(c.justRemoved=!1,c.removedX=c.x,c.removedY=c.y),c.x=c.x<.5*K?c.removedX-s*K:c.removedX+s*K,c.y=c.removedY-q.sin(s*Y)*K*.4,h(c))}de.anim&&de.invalid?(R||(R={onTop:!0,type:Me}),R.shape||(w(R),R.row=de.invalidRow,R.col=de.invalidCol),d(de.invalidRow,de.invalidCol,R),R.scale=1,R.y-=a*R.scale*O*.2,R.opacity=.8>a?1:1-(a-.8)/(1-.8),h(R)):R&&R.shape&&k(R),e&&e.shape&&de.shape&&de.shape.nextSibling!=e.shape&&rt.insertBefore(de.shape,e.shape),W.save(),W.translate(0,F),W.fillStyle=Be,W.beginPath(),W.rect(0,0,K,K),W.fill(),W.clip();var f,y,v,L=q.floor(ne),m=-(ne-q.floor(ne)),g={},b={},x={},C={};for(f=-1;G>f;f++)for(y=0;U>y;y++){if(u(y/U,(f+m)/U,g),u(y/U,(f+1+m)/U,C),u((y+1)/U,(f+1+m)/U,x),u((y+1)/U,(f+m)/U,b),W.beginPath(),W.moveTo(g.x*K,g.y*K),W.lineTo(b.x*K,b.y*K),W.lineTo(x.x*K,x.y*K),W.lineTo(C.x*K,C.y*K),W.closePath(),W.lineWidth=1,W.fillStyle=-1!=Xe&&-1!=ze&&f+L==Xe&&y==ze?Ye:(f+y+L)%2==0?De:qe,W.fill(),(t=oe[f+L])&&t[y]){var S=t[y];S.showThreat&&(W.fillStyle="rgba("+Ke+",0.5)",W.fill()),S.checkPoint&&(W.fillStyle=Ue,W.fill())}if(de.invalid&&de.invalidCol==y&&de.invalidRow==f+L){var E=1.5*(.5>a?a:1-a);W.fillStyle="rgba("+Ke+","+E+")",W.fill()}}W.restore()}()),Qe.click=!1,window.ste&&ste(),se&&requestAnimationFrame(o)}function p(t,i){i?(se=!1,re=!0,te.style.display="block"):t!=re&&((re=t)?ie.style.display="block":(ie.style.display="none",e()))}function c(){if($=Date.now(),N&&(ne+=ae*($-N)*ee),de.row<ne-.9){if(le)if(n(de.row+1,de.col))if(n(de.row+1,de.col+1)){if(n(de.row+1,de.col-1))return void p(!0);l(de.row+1,de.col+1)}else l(de.row+1,de.col+1);else l(de.row+1,de.col);else p(!0);t.play("checkmate")}var e=q.floor(ne)+G;if(!N||e>ce){for(var i,r,a=e-G-5;a>ce-G-5;a--)if(i=oe[a])for(r=0;U>r;r++)i[r]&&i[r].piece&&k(i[r].piece);for(a=ce+1;e>=a;a++)if(i=oe[a])for(r=0;U>r;r++){var o=U/2;r%2==0?o+=r/2:o-=(r+1)/2,i[o]&&i[o].piece&&w(i[o].piece)}ce=e}N=$}function s(){ge++,T=null}function f(e,t,i,r){Q.push({e:e,to:t,de:i||0,du:r})}function d(e,t,i){i=i||d.res,u((t+.5)/U,(e-ne+.5)/U);var r=1;return u.res.y<Oe?r=0:u.res.y<Ge&&(r=1-(.02-u.res.y)/(Ge-Oe)),i.opacity=r,i.x=u.res.x*K,i.y=u.res.y*K+F,i.scale=u.res.scaleX,i}function h(e){e.shape&&(e.shape.style.opacity=e.opacity,e.scale>0&&e.shape.setAttributeNS(null,"transform","scale("+e.scale+") translate("+e.x/e.scale+","+e.y/e.scale+")"))}function u(e,t,i){return(i=i||u.res).y=v(t,He,We,Ve),i.scaleX=v(t,_e,Je,Ze),i.scaleY=i.scaleX,i.x=(1-i.scaleX)/2+e*i.scaleX,me&&(i.x=we*i.x+(1-we)*e,i.y=we*i.y+(1-we)*(1-t),i.scaleX=we*i.scaleX+1*(1-we),i.scaleY=i.scaleX),i}function y(e,t,i){(i=i||y.res).y=function(e,t,i,r){return(-i-q.sqrt(i*i-4*t*(r-e)))/(2*t)}(t,He,We,Ve);var r=v(i.y,_e,Je,Ze);return i.x=(e-(1-r)/2)/r,i}function v(e,t,i,r){return t*e*e+i*e+r}function L(e,t,i){var r=z.createElement("canvas");return i&&(r.id=i),r.width=e,r.height=t,r}function m(e){return e.getContext("2d")}function w(e){var t;if(lt[e.type]||(lt[e.type]=[]),t=lt[e.type].length?lt[e.type].pop():$e(e.type),rt.firstChild&&!e.onTop?rt.insertBefore(t,rt.firstChild):rt.appendChild(t),e.shape)throw new Error;e.shape=t,t.style.filter="none"}function k(e){e.shape&&(lt[e.type].push(e.shape),rt.removeChild(e.shape),e.shape=null)}function g(e,t){x(I,e?"White King :":"Black King :");for(var i="",r=0;r<t.length;r++)i+='<tspan x="10" '+(0===r?"":'dy="1.2em"')+">"+t[r]+"</tspan>";x(P,i),f(M,{_y:tt},0,.5)}function b(){f(M,{_y:it},0,.5)}function x(e,t){for(;e.firstChild;)e.removeChild(e.firstChild);var i="<svg>"+t+"</svg>";nt.innerHTML=i,Array.prototype.slice.call(nt.childNodes[0].childNodes).forEach(function(t){e.appendChild(t)})}function C(e,t){if(t)for(var i in t)e.setAttributeNS(null,i,t[i]);return e}function S(e,t,i,r){var l={};return void 0!==t&&(l.fill=t),void 0!==i&&(l.stroke=i),void 0!==r&&(l.strokeWidth=r),C(e,l),e}function E(e,t){t||(t=window.e);var i=t.keyCode;t.charCode&&!i&&(i=t.charCode);var r=at[i];r&&ot[r]!==e&&(ot[r]=e,void 0===pt[r]&&(pt[r]=-1),e?pt[r]<1&&(pt[r]=1):pt[r]>0&&(pt[r]=0))}var N,A,T,M,I,P,R,Q,X=window,z=X.document,B=z.body,D=null,q=X.Math,Y=q.PI,j=(q.sqrt,q.random,1),F=100*j,K=400*j,U=8,O=K/U,G=2*U+3,H=L(K,K,"bg"),W=m(H),V=L(K,K,"shadow"),_=m(V),J=L(K,2*K,"sky"),Z=m(J),$=0,ee=.001,te=null,ie=null,re=!1,le=!1,ne=0,ae=1,oe=null,pe=null,ce=-1,se=!0,fe=[],de=null,he=.05,ue=.5,ye=null,ve=null,Le=null,me=!0,we=0,ke=0,ge=-1,be="h",xe="p",Ce="r",Se="b",Ee="k",Ne="l",Ae="c",Te="ef",Me="ct",Ie=6,Pe=-1,Re=!1,Qe={},Xe=-1,ze=-1,Be="#193441",De="#D1DBBD",qe="#3E606F",Ye="#794",je="#eee",Fe="#555",Ke="255,0,0",Ue="rgba(93, 255, 182, 0.56)",Oe=-.02,Ge=.02;d.res={};var He=3/16,We=-.875,Ve=1,_e=-2.5/16,Je=0,Ze=1;u.res={},y.res={};var $e,et,tt,it,rt=null,lt={},nt=z.createElement("div"),at={37:"left",65:"left",81:"left",38:"up",90:"up",87:"up",83:"down",40:"down",39:"right",68:"right",32:"space",27:"esc",13:"enter"},ot={},pt={};z.onkeyup=function(e){me||!ot.enter||re||(se=!se,ve.style.display=se?"none":"block",se&&(N=Date.now(),o())),E(!1,e)},z.onkeydown=function(e){E(!0,e)},z.onmousedown=function(e){!function(e,t){Qe.click=!0,z.onmousemove(t)}(0,e)},z.onmousemove=function(e){Qe.x=e.clientX-D.offsetLeft,Qe.y=e.clientY},function(){(D=z.createElement("div")).id="root",B.appendChild(D);var e=D.style;e.position="absolute",e.left="50%",e.top="0",e.marginLeft=-K/2+"px ",D.appendChild(H),H.width=K,H.height=K+F,function(){var e=.02*K;J.width=K,J.height=F+e;var t=Z;t.clearRect(0,0,K,K),t.save(),t.fillStyle="#FF8601",t.beginPath(),t.rect(0,0,K,F),t.fill(),t.clip(),t.fillStyle="#FFE7CA";var i=K/4;t.beginPath(),t.arc(K/2,F+.3*i,i,0,Y,!0),t.fill(),t.restore(),t.beginPath(),t.fillStyle="rgb(10,20,25)";for(var r=[0,.7,.1,.3,.2,1,.3,.5,.35,.8,.42,.5,.55,.9,.7,.45,.8,1.1,.88,.4,1,.8],l=0;l<r.length;l+=2){var n=r[l]*K,a=F-40*r[l+1];0===l?t.moveTo(n,a):t.lineTo(n,a)}t.lineTo(K,F),t.lineTo(0,F),t.fill(),t.restore(),t.save(),t.translate(0,F);var o=t.createLinearGradient(0,0,0,e),p="rgba(10,20,25,";o.addColorStop(0,p+1+")"),o.addColorStop(1,p+0+")"),t.fillStyle=o,t.fillRect(0,0,K,e),t.restore(),D.appendChild(J)}(),function(){function e(e,t){return l(["M",[e,t],"L",[e+1,t],"L",[e+.5,t-3],"L",[e,t]])}function t(e,t,r){var l=z.createElementNS(a,"g");l.setAttributeNS(null,"id",e),r||l.appendChild(i());for(var n=0;n<t.length;n++){var o=t[n];o.getAttributeNS(null,"x")||(o.setAttributeNS(null,"x",-O/2),o.setAttributeNS(null,"y",-O)),l.appendChild(o)}return s.appendChild(l),l}function i(){var e=function(e,t,i,r){var l=z.createElementNS(a,"ellipse");return C(l,{cx:n(e-f),cy:n(t-d),rx:n(i),ry:n(r)}),l}(5,8,3.1,1.8);return S(e,"rgba(0,0,0,0.2)","none"),e}function r(e,t,i){var r=z.createElementNS(a,"circle");return C(r,{cx:n(e-f),cy:n(t-d),r:n(i)}),r}function l(e,t){var i=z.createElementNS(a,"path");return i.setAttributeNS(null,"d",function(e){for(var t="",i=0;i<e.length;i++){var r=e[i];"object"==typeof r&&(r=n(r[0]-f)+","+n(r[1]-d)),t+=r+" "}return t}(e)),t&&C(i,t),i}function n(e){return.1*q.round(O*e)}$e=function(e,t){var i=z.createElementNS(a,"use");return C(i,t),i.setAttributeNS(o,"xlink:href","#"+e),i.setAttribute("xmlns:xlink",o),i};var a="http://www.w3.org/2000/svg",o="http://www.w3.org/1999/xlink",p=K,c=K+F;(et=z.createElementNS(a,"svg")).setAttribute("xmlns",a),et.setAttributeNS(null,"viewBox","0 0 "+p+" "+c),et.setAttributeNS(null,"width",p),et.setAttributeNS(null,"height",c),D.appendChild(et);var s=z.createElementNS(a,"defs");et.appendChild(s),rt=z.createElementNS(a,"g"),et.appendChild(rt),function(){Le=z.createElementNS(a,"g"),et.appendChild(Le);var e=z.createElementNS(a,"rect");C(e,{x:0,y:0,width:"100%",height:F,fill:Be,stroke:"#000"}),Le.appendChild(e);var t=z.createElementNS(a,"text");C(t,{x:"50%",y:"60","font-size":"48px",fill:"orange",stroke:"red","stroke-width":"2px","text-anchor":"middle","font-family":"Impact"}),x(t,'CHESS<tspan style="font-style:italic;">PURSUIT</tspan>'),Le.appendChild(t)}(),function(e){var t=z.createElementNS(a,"filter");t.setAttributeNS(null,"id",e),C(t,{x:"0",y:"0",width:"100%",height:"100%","color-interpolation-filters":"sRGB"}),x(t,'<feFlood flood-color="rgba(255,0,0,0.3)" result="COLOR"></feFlood><feComposite operator="atop" in="COLOR" in2="SourceGraphic"></feComposite>'),s.appendChild(t)}(Te),function(e,t){var i=z.createElementNS(a,"text");i.setAttributeNS(null,"id",e),C(i,{x:"-40","font-size":"28",fill:"red",stroke:"black","stroke-width":"1","font-family":"Impact"}),x(i,t),s.appendChild(i)}(Me,"CHECK"),function(){(ie=z.createElementNS(a,"g")).style.display="none",et.appendChild(ie);var e=z.createElementNS(a,"rect");C(e,{x:0,y:0,width:"100%",height:"100%",fill:"rgba(0,0,0,0.5)"}),ie.appendChild(e);var t=z.createElementNS(a,"text");C(t,{x:"50%",y:"50%","font-size":"48px",fill:"orange",stroke:"red","stroke-width":"2px","text-anchor":"middle","font-family":"Impact"}),x(t,"CHECKMATE !"),ie.appendChild(t),C(t=z.createElementNS(a,"text"),{x:"50%",y:"60%","font-size":"22px",fill:"white",stroke:"black","stroke-width":"1px","text-anchor":"middle","font-family":"Impact"}),x(t,'<tspan x="50%">Press <tspan style="fill:orange;">SPACE</tspan> or <tspan style="fill:orange;">CLICK</tspan></tspan><tspan x="50%" dy="1.5em">to restart from the last checkpoint.</tspan>'),ie.appendChild(t)}(),function(){var e=K-12,t=.3*K-12;it=K+F,tt=F+K-t-6,(M=z.createElementNS(a,"svg"))._y=it,C(M,{x:6,y:it,width:e,height:t}),et.appendChild(M);var i=z.createElementNS(a,"rect");C(i,{width:"100%",height:"100%",fill:"rgba(0,0,0,0.8)",stroke:"#fff","stroke-width":2}),M.appendChild(i),C(I=z.createElementNS(a,"text"),{x:10,y:20,"font-size":"18px",fill:"#fff","text-anchor":"left","font-family":"Impact"}),M.appendChild(I),C(P=z.createElementNS(a,"text"),{x:10,y:40,"font-size":"16px",fill:"#fff","text-anchor":"left","font-family":"sans-serif"}),M.appendChild(P)}(),C(ye=z.createElementNS(a,"text"),{x:"50%",y:F+K-10,"font-size":"22px",fill:"white",stroke:"black","stroke-width":"1px","text-anchor":"middle","font-family":"Impact"}),x(ye,'Press <tspan style="fill:orange;">SPACE</tspan> or <tspan style="fill:orange;">CLICK</tspan>'),et.appendChild(ye),C(ve=z.createElementNS(a,"text"),{x:"50%",y:"50%","font-size":"32px",fill:"orange",stroke:"black","stroke-width":"1px","text-anchor":"middle","font-family":"Impact"}),x(ve,"PAUSED"),ve.style.display="none",et.appendChild(ve),function(){(te=z.createElementNS(a,"g")).style.display="none",et.appendChild(te);var e=z.createElementNS(a,"rect");C(e,{x:0,y:0,width:"100%",height:"100%",fill:"rgba(0,0,0,0.5)"}),te.appendChild(e);var t=z.createElementNS(a,"text");C(t,{x:"50%",y:"50%","font-size":"48px",fill:"#5f7",stroke:"black","stroke-width":"2px","text-anchor":"middle","font-family":"Impact"}),x(t,"YOU WIN !"),te.appendChild(t),C(t=z.createElementNS(a,"text"),{x:"50%",y:"60%","font-size":"22px",fill:"white",stroke:"black","stroke-width":"1px","text-anchor":"middle","font-family":"Impact"}),x(t,"Alas, your Queen is in another castle..."),te.appendChild(t)}();var f=5,d=8;S(t(xe,[l(["M",[2,8],"Q",[5,10],[8,8],"L",[5,3],"L",[2,8]]),r(5,3,2)]),je,Fe,0),S(t("e",[l(["M",[4.6,1.4],"L",[5.4,1.4],"L",[5.4,-.6],"L",[6.4,-.6],"L",[6.4,-1.4],"L",[5.4,-1.4],"L",[5.4,-2.4],"L",[4.6,-2.4],"L",[4.6,-1.4],"L",[3.6,-1.4],"L",[3.6,-.6],"L",[4.6,-.6],"L",[4.6,1.4]]),l(["M",[2,8],"Q",[5,10],[8,8],"L",[6,3],"L",[7,1],"Q",[5,0],[3,1],"L",[4,3],"L",[2,8]])]),je,Fe,0),S(t(Ee,[l(["M",[2,8],"Q",[5,10],[8,8],"L",[7,6],"Q",[8,3],[7,0],"L",[6,1],"L",[5,1],"L",[2,4],"L",[3,5],"L",[5,4],"L",[2,8]])]),je,Fe,0),S(t(Ce,[l(["M",[2,8],"Q",[5,10],[8,8],"L",[6.5,3],"L",[8,2],"L",[8,0],"L",[7,0],"L",[7,1],"L",[6,1],"L",[6,0],"L",[4,0],"L",[4,1],"L",[3,1],"L",[3,0],"L",[2,0],"L",[2,2],"L",[3.5,3],"L",[2,8]])]),je,Fe,0),S(t(Se,[l(["M",[2,8],"Q",[5,10],[8,8],"L",[6,4],"Q",[8,1.1],[5,0],"Q",[2,1.1],[4,4],"L",[2,8]]),r(5,0,.7),l(["M",[3.8,.8],"L",[4.4,2.5]],{"stroke-width":2})]),je,Fe,0),S(t("w",[l(["M",[2,8],"Q",[5,10],[8,8],"L",[8.5,6],"L",[7,7],"L",[7,5],"L",[6,6],"L",[5,4.5],"L",[4,6],"L",[3,5],"L",[3,7],"L",[1.5,6],"L",[2,8]])]),je,Fe,0),S(t(Ne,[e(2,9.5),e(5,9),e(8,10),e(7,8),e(4,7.5),e(1,8.5)],!0),je,Fe,0),S(t(be,[l(["M",[4.6,1.4],"L",[5.4,1.4],"L",[5.4,-.6],"L",[6.4,-.6],"L",[6.4,-1.4],"L",[5.4,-1.4],"L",[5.4,-2.4],"L",[4.6,-2.4],"L",[4.6,-1.4],"L",[3.6,-1.4],"L",[3.6,-.6],"L",[4.6,-.6],"L",[4.6,1.4]]),l(["M",[2,8],"Q",[5,10],[8,8],"L",[6,3],"L",[7,1],"Q",[5,0],[3,1],"L",[4,3],"L",[2,8]])]),"#002","#333",0),S(t("q",[r(5,.4,.6),l(["M",[2,8],"Q",[5,10],[8,8],"L",[6,3],"L",[7.5,1],"L",[5.8,1.5],"L",[5,.8],"L",[4.2,1.5],"L",[2.5,1],"L",[4,3],"L",[2,8]])]),"#002","#333",0),f=2.5,d=50,S(t(Ae,[l(["M",[25,30],"L",[50,30],"L",[50,5],"L",[45,5],"L",[45,10],"L",[40,10],"L",[40,5],"L",[35,5],"L",[35,10],"L",[30,10],"L",[30,5],"L",[25,5],"L",[25,30]]),l(["M",[0,50],"L",[0,50],"L",[27.5,50],"L",[27.5,35],"L",[47.5,35],"L",[47.5,50],"L",[75,50],"L",[75,20],"L",[70,20],"L",[70,25],"L",[65,25],"L",[65,20],"L",[60,20],"L",[60,25],"L",[55,25],"L",[55,20],"L",[50,20],"L",[50,25],"L",[45,25],"L",[45,20],"L",[40,20],"L",[40,25],"L",[35,25],"L",[35,20],"L",[30,20],"L",[30,25],"L",[25,25],"L",[25,20],"L",[20,20],"L",[20,25],"L",[15,25],"L",[15,20],"L",[10,20],"L",[10,25],"L",[5,25],"L",[5,20],"L",[0,20],"L",[0,50]])],!0),je,Fe,0)}(),function(){var e=_,t=e.createLinearGradient(0,0,0,K),i="rgba(10,20,25,";t.addColorStop(0,i+0+")"),t.addColorStop(.2,i+0+")"),t.addColorStop(1,i+.5+")"),e.fillStyle=t,e.fillRect(0,0,K,K),e.restore(),V.style.top=F+"px",V.style.pointerEvents="none",D.appendChild(V)}(),i(0),o()}()}</script>