<title>Magna Carta - js13kGames 2023</title><style>body{margin:0;overflow:hidden}body{background:#000}</style><body><script>function t(t,i){return void 0===i&&(i=1),(t=void 0===t?0:t)+Math.random()*(i-t)}function U(t,i,o,e,n,s){void 0===e&&(e=0),void 0===n&&(n=1),void 0===s&&(s=1),t.translate(i,o),t.rotate(e),t.scale(n,s),t.translate(-i,-o)}function G(t,i,o,e,n,s){t.beginPath(),t.moveTo(i+s,o),t.lineTo(i+e-s,o),t.quadraticCurveTo(i+e,o,i+e,o+s),t.lineTo(i+e,o+n-s),t.quadraticCurveTo(i+e,o+n,i+e-s,o+n),t.lineTo(i+s,o+n),t.quadraticCurveTo(i,o+n,i,o+n-s),t.lineTo(i,o+s),t.quadraticCurveTo(i,o,i+s,o),t.closePath()}var s,h={x:0,y:0},Z=(q.prototype.h=function(t,i,o){var e=this;void 0===o&&(o=0),this.t=t,this.i=o/360*Math.PI,setTimeout(function(){return e.reset()},1e3*i)},q.prototype.update=function(){this.offset={x:t(-this.t,this.t),y:t(-this.t,this.t)},this.rotation=t(-this.i,this.i)},q.prototype.reset=function(){this.t=0,this.i=0},q),J="#D5573B",i="#F1EE95",r="#F5D0C5",l=(A.prototype.scale=function(t,i){this.type="scale";var o=this.o.scale;this.start={x:o.x,y:o.y},this.v(t,i)},A.prototype.move=function(t,i){this.type="move";var o=this.o.l;this.start={x:o.x,y:o.y},this.v(t,i)},A.prototype.v=function(t,i){this.target=t,this.duration=1e3*i,this.active=!0,this.startTime=-1},A.prototype.update=function(t){var i,o;this.startTime<0||"none"==this.type?this.startTime=t:this.active&&(this.time=(t=(t-this.startTime)/this.duration,Math.min(Math.max(t,0),1)),this.start)&&this.target&&(t=this.start,i=this.target,o=this.time,o=(0,this.u)(o),o={x:t.x+o*(i.x-t.x),y:t.y+o*(i.y-t.y)},"move"==this.type&&(this.o.l={x:o.x,y:o.y}),"scale"==this.type&&(this.o.scale={x:o.x,y:o.y}),this.active=this.time<1)},A),z=function(t){return t<4/11?121*t*t/16:t<8/11?9.075*t*t-9.9*t+3.4:t<.9?4356/361*t*t-35442/1805*t+16061/1805:10.8*t*t-20.52*t+10.72},o=(D.prototype.update=function(t,i){this.p.update(t)},D.prototype.M=function(t){},D.prototype._=function(){return{x:this.l.x+.5*this.s.x,y:this.l.y+.5*this.s.y}},D.prototype.setPosition=function(t,i){this.l={x:t,y:i}},D.prototype.j=function(t){var i=this._();return t.x>i.x-.5*this.s.x*this.scale.x&&t.x<i.x+.5*this.s.x*this.scale.x&&t.y>i.y-.5*this.s.y*this.scale.y&&t.y<i.y+.5*this.s.y*this.scale.y},D),$=(s=function(t,i){return(s=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}s(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}(j,ti=o),j.prototype.open=function(t){void 0===t&&(t=function(){}),this.p.scale({x:0,y:0},.5),setTimeout(t,500)},j.prototype.close=function(t){void 0===t&&(t=function(){}),this.p.scale({x:1,y:1},.4),setTimeout(t,500)},j.prototype.M=function(t){t.fillStyle="#000",t.fillRect(0,0,this.s.x*this.scale.x,this.s.y),t.fillRect(this.s.x-this.s.x*this.scale.x,0,this.s.x*this.scale.x,this.s.y)},j),V=function(t,i){return(V=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},a=((T=function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}V(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)})(C,Qt=o),C.prototype.update=function(i,o){Qt.prototype.update.call(this,i,o),this.children.forEach(function(t){return t.update(i,o)}),this.children.some(function(t){return t.O})&&(this.children=this.children.filter(function(t){return!t.O}))},C.prototype.hide=function(t){this.p.scale({x:0,y:0},t=void 0===t?.3:t)},C.prototype.show=function(t){this.p.scale({x:1,y:1},t=void 0===t?.3:t)},C.prototype.M=function(i){i.save();var t=this.l;U(i,t.x,t.y,0,this.scale.x,this.scale.y),this.children.forEach(function(t){return t.M(i)}),i.restore()},C.prototype.m=function(t){return this.children[t]},C.prototype.A=function(){return this.children},C.prototype.add=function(t){this.children.push(t)},C),X=function(t,i){return(X=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},Q=((T=function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}X(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)})(hi,Xt=o),hi.prototype.update=function(t,i){this.O||this.T<0||(this.l={x:this.l.x+this.g.x,y:this.l.y+this.g.y},this.ratio=1-(t-this.start)/(1e3*this.T),this.start<0&&(this.start=t),t-this.start>1e3*this.T&&(this.O=!0))},function(t,i){return(Q=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)}),tt=((d=function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}Q(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)})(S,Vt=T=hi),S.prototype.update=function(t,i){var o;null!=(o=this.options)&&o.force&&(this.g={x:this.g.x+this.options.force.x,y:this.g.y+this.options.force.y}),Vt.prototype.update.call(this,t,i)},S.prototype.M=function(t){var i;t.fillStyle=null!=(i=null==(i=this.options)?void 0:i.color)?i:"#fff",t.fillRect(this.l.x-.5*this.s.x,this.l.y-.5*this.s.y,this.s.x,this.s.y)},S),it=function(t,i){return(it=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},ot=((d=function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}it(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)})(O,$t=o),O.prototype.update=function(t,i){$t.prototype.update.call(this,t,i)},O.prototype.show=function(t){var i=this,o=(this.D=t,this.p.scale({x:1,y:1},.5),this.k=0,clearTimeout(this.B),setInterval(function(){0<=i.k&&i.k<i.D.join("").length?(i.k++," "==i.D.join("").substring(i.k,i.k+1)&&i.S()):clearInterval(o)},25))},O.prototype.hide=function(){var t=this;this.p.scale({x:0,y:0},.3),this.B=setTimeout(function(){t.D=[],t.k=-1},300)},O.prototype.M=function(t){t.save(),U(t,20,this.s.y-20,0,this.scale.x,this.scale.y),t.strokeStyle="#000",t.lineWidth=10,t.fillStyle="#000",G(t,0,0,this.s.x,this.s.y,20),t.fill(),t.fillStyle="#fff",t.beginPath(),t.moveTo(20,this.s.y-20),t.quadraticCurveTo(50,this.s.y-20,0,this.s.y+40),t.quadraticCurveTo(100,this.s.y,100,this.s.y-20),t.closePath(),t.fill(),t.stroke(),t.fillStyle="#fff",G(t,10,10,this.s.x-20,this.s.y-20,20),t.fill(),t.fillStyle="#000",t.font="30px arial black",this.D[0]&&t.fillText(this.I(0),.5*this.s.x,.5*this.s.y-30-22),this.D[1]&&t.fillText(this.I(1),.5*this.s.x,.5*this.s.y+10-22),this.D[2]&&t.fillText(this.I(2),.5*this.s.x,.5*this.s.y+50-22),this.D[3]&&t.fillText(this.I(3),.5*this.s.x,.5*this.s.y+90-22),t.restore()},O.prototype.I=function(t){var i=this.D.slice(0,t).reduce(function(t,i){return t+i.length},0);return this.D[t].substring(0,Math.max(this.k-i,0))},O),f=(zt=function(t,i){return(zt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},Y);if("function"!=typeof(v=Jt=o)&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function et(){this.constructor=f}zt(f,v),f.prototype=null===v?Object.create(v):(et.prototype=v.prototype,new et),Y.prototype.update=function(t,i){Jt.prototype.update.call(this,t,i),this.N=(t=this.N)+(t<(i=this.F)?Math.min(i-t,.075):Math.max(i-t,-.075))},Y.prototype.M=function(t){var i=this.l,o=this.s.x,e=this.s.y*this.N;t.beginPath(),t.fillStyle="#000",t.ellipse(i.x,i.y,o,e,0,0,2*Math.PI),t.fill()},Y.prototype.blink=function(t){var i=this;clearTimeout(this.B),this.F=0,this.B=setTimeout(function(){return i.open()},t)},Y.prototype.open=function(){this.F=1};var nt=Y,st=function(t,i){return(st=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},y=k;if("function"!=typeof(v=Zt=o)&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function rt(){this.constructor=y}st(y,v),y.prototype=null===v?Object.create(v):(rt.prototype=v.prototype,new rt),k.prototype.blink=function(t,i){var o=this;setTimeout(function(){return o.left.blink(t)},u(0,i)),setTimeout(function(){return o.right.blink(t)},u(0,i)),setTimeout(function(){return o.blink(t,i)},u(1e3,4e3))},k.prototype.update=function(t,i){Zt.prototype.update.call(this,t,i),this.N=E(this.N,this.F,.075),this.left.update(t,i),this.right.update(t,i)},k.prototype.M=function(t){n(t,{x:-65,y:20},15,10,this.G),n(t,{x:65,y:20},15,10,this.G),t.beginPath(),t.lineWidth=7,t.strokeStyle="#000",t.fillStyle="#000",t.moveTo(-40,20),t.quadraticCurveTo(0,40-20*this.N,40,20),t.quadraticCurveTo(0,40+60*this.N,-40,20),t.stroke(),t.fill(),this.left.M(t),this.right.M(t)},k.prototype.H=function(t,i){var o=this;clearTimeout(this.L),this.F=t,this.L=setTimeout(function(){return o.q()},1e3*i)},k.prototype.q=function(){this.F=0};var ht=k,lt=function(t,i){return(lt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},at=M;if("function"!=typeof(v=Gt=o)&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function ut(){this.constructor=at}lt(at,v),at.prototype=null===v?Object.create(v):(ut.prototype=v.prototype,new ut),M.prototype.speak=function(){this.visible&&(this.face.H(u(.4,.9),.08),this.R.K.speak())},M.prototype.P=function(){clearTimeout(this.J),this.U.hide()},M.prototype.V=function(t){this.U.show(t)},M.prototype.show=function(t){var i=this;this.visible||this.R.K.W(),this.p.move({x:200,y:650},.4),this.visible=!0,this.J=setTimeout(function(){return i.U.show(t)},500)},M.prototype.hide=function(){this.visible=!1,this.U.hide(),this.p.move({x:200,y:1150},.4),this.R.K.W()},M.prototype.update=function(t,i){Gt.prototype.update.call(this,t,i),this.Y=.8*Math.abs(Math.sin(.0025*t)),this.U.update(t,i),this.face.update(t,i)},M.prototype.M=function(t){t.save(),p(t,this.l.x,this.l.y,0,.9,.9),t.beginPath(),t.strokeStyle="#000",t.lineWidth=10,e(t,{x:this.l.x-60,y:this.l.y-220-10*this.Y},20,"#fff"),t.stroke(),t.beginPath(),e(t,{x:this.l.x+60,y:this.l.y-220-10*this.Y},20,"#fff"),t.stroke(),e(t,c(this.l,0,-300-20*this.Y),100,"#000"),e(t,c(this.l,-98,-300-30*this.Y),25,"#000"),e(t,c(this.l,98,-300-30*this.Y),25,"#000"),t.beginPath(),t.fillStyle="#D5573B",t.moveTo(this.l.x-150+7*this.Y,this.l.y+20),t.quadraticCurveTo(this.l.x,this.l.y-500-50*this.Y,this.l.x+150-7*this.Y,this.l.y+20),t.fill(),t.stroke(),t.fillStyle=r,t.beginPath(),t.moveTo(this.l.x-55,this.l.y-200-15*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-300,this.l.x+55,this.l.y-200-15*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-160-10*this.Y,this.l.x-55,this.l.y-200-15*this.Y),t.fill(),e(t,c(this.l,0,-300-20*this.Y),90,r),e(t,c(this.l,10,-300-40*this.Y),70,"#fff4"),e(t,c(this.l,-98,-300-30*this.Y),15,r),e(t,c(this.l,98,-300-30*this.Y),15,r),t.lineWidth=20,t.fillStyle=i,t.beginPath(),t.moveTo(this.l.x-75,this.l.y-370-25*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-360-25*this.Y,this.l.x+75,this.l.y-370-25*this.Y),t.lineTo(this.l.x+75,this.l.y-450-25*this.Y),t.lineTo(this.l.x+37,this.l.y-420-25*this.Y),t.lineTo(this.l.x,this.l.y-460-25*this.Y),t.lineTo(this.l.x-37,this.l.y-420-25*this.Y),t.lineTo(this.l.x-75,this.l.y-450-25*this.Y),t.closePath(),t.stroke(),t.fill(),t.fillStyle="#777DA7",t.lineWidth=10,t.beginPath(),t.moveTo(this.l.x-55,this.l.y-200-15*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-90,this.l.x-50,this.l.y+30),t.lineTo(this.l.x+50,this.l.y+30),t.quadraticCurveTo(this.l.x,this.l.y-90,this.l.x+55,this.l.y-200-15*this.Y),t.lineTo(this.l.x+50,this.l.y-200-15*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-150-15*this.Y,this.l.x-55,this.l.y-200-15*this.Y),t.fill(),t.stroke(),t.lineWidth=44,t.setLineDash([0,25]),t.lineCap="round",t.beginPath(),t.moveTo(this.l.x-55,this.l.y-200-15*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-90,this.l.x-50,this.l.y+30),t.stroke(),t.beginPath(),t.moveTo(this.l.x+55,this.l.y-200-15*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-90,this.l.x+50,this.l.y+30),t.stroke(),t.lineWidth=27,t.strokeStyle="#fff",t.beginPath(),t.moveTo(this.l.x-55,this.l.y-200-15*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-90,this.l.x-50,this.l.y+30),t.stroke(),t.beginPath(),t.moveTo(this.l.x+55,this.l.y-200-15*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-90,this.l.x+50,this.l.y+30),t.stroke(),t.setLineDash([]),t.save(),t.translate(this.l.x,this.l.y-290-45*this.Y),this.face.M(t),t.restore(),t.save(),t.translate(this.l.x+130,this.l.y-500-60*this.Y),this.U.M(t),t.restore(),t.restore()};var ct=M,pt="Arial Black, HelveticaNeue-CondensedBlack, sans-serif",ft=function(t,i){return(ft=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},yt=ri;if("function"!=typeof(v=Ut=T)&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function dt(){this.constructor=yt}ft(yt,v),yt.prototype=null===v?Object.create(v):(dt.prototype=v.prototype,new dt),ri.prototype.M=function(t){t.save(),t.rotate(null!=(u=null==(u=this.options)?void 0:u.angle)?u:0);var i,o,e,n,s,r,h,l,a,u=null!=(u=this.options)&&u.X?this.ratio:1;t.font="".concat(this.fontSize*u,"px ").concat(pt),t.textAlign=null!=(u=null==(u=this.options)?void 0:u.align)?u:"center",null!=(u=this.options)&&u.Z&&(t.fillStyle="#000",t.fillText(this.content.replace(/\|/g,""),this.l.x+this.options.Z,this.l.y+this.options.Z)),o=t,u=this.content,e=this.l.x,n=this.l.y,s=null!=(i=null==(i=this.options)?void 0:i.color)?i:"#fff",r=null!=(i=null==(i=this.options)?void 0:i.$)?i:[],u=u.split("|"),h=!1,a=l=0,u.forEach(function(t){o.fillStyle=h?r[a]:s,h&&(a=(a+1)%r.length),o.fillText(t,e+l,n),h=!h,l+=o.measureText(t).width}),t.restore()};var vt=ri,xt=function(t,i){return(xt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},wt=si;if("function"!=typeof(v=w=o)&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function Tt(){this.constructor=wt}xt(wt,v),wt.prototype=null===v?Object.create(v):(Tt.prototype=v.prototype,new Tt),si.prototype.update=function(t,i){w.prototype.update.call(this,t,i),t=this.tt,this.tt=!i.it&&this.j(i),t&&!this.tt&&this.nt(),t||!this.tt||this.locked&&!this.st||this.ht(),i.ot||(this.pressed&&!i.it&&this.tt&&this.click(),this.pressed=!1),this.tt&&this.st&&i.ot&&!this.pressed&&!i.it?this.pressed=!0:this.locked||(this.tt&&i.ot&&!i.it&&!this.it&&(this.rt(),this.start={x:this.l.x,y:this.l.y},this.it=!0,this.offset=c(i,-this.l.x,-this.l.y),i.it=!0),this.it&&(this.l=c(i,-this.offset.x,-this.offset.y),i.ot||(this.it=!1,i.it=!1,this.ut())))};var d=si,mt=function(t,i){return(mt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},bt=ni;if("function"!=typeof(v=Ht=T)&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function _t(){this.constructor=bt}mt(bt,v),bt.prototype=null===v?Object.create(v):(_t.prototype=v.prototype,new _t),ni.prototype.M=function(t){var i=Math.max(0,Math.min(1-this.ratio,1)),o="#ffffff"+Math.round(i*this.alpha).toString(16).padStart(2,"0");t.beginPath(),e(t,this.l,i*this.et,0<this.ft?"#ffffff00":o),0<this.ft&&(t.strokeStyle=o,t.lineWidth=this.ft,t.stroke())};var gt=ni,Pt=function(t,i){return(Pt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},Mt=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}Pt(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}(P,Ft=d),P.prototype.xt=function(){return this.bt?0:this.ct.length},P.prototype._t=function(){return this.it},P.prototype.update=function(t,i){Ft.prototype.update.call(this,t,i),this.time=t,this.it&&(this.lt&&!i.right||this.dt&&!i.jt)&&(this.R.Ot(new gt(this.l.x+this.offset.x,this.l.y+this.offset.y,50,.8,10,100)),this.rotation=(this.rotation+1)%4,this.vt=this.rotation%2==1,this.ct=1<this.rotation?this.Mt.split("").reverse().join(""):this.Mt,this.offset={x:this.offset.y,y:this.offset.x},this.R.At(),this.R.K.rotate()),this.yt=E(this.yt,0,.05),this.lt=i.right,this.dt=i.jt,t=this.vt?0:1,i=this.vt?1:0,this.s={x:30+30*(this.ct.length-1)*t,y:30+30*(this.ct.length-1)*i}},P.prototype.M=function(n){var s=this,r=(n.font="15px arial black",n.textAlign="center",this.it&&(t=this.Tt(),n.strokeStyle="#fff9",n.lineWidth=5,n.setLineDash([5,5]),L(n,t.x+2,t.y+2,this.s.x-4,this.s.y-4,5),n.stroke(),n.setLineDash([])),this.vt?0:1),h=this.vt?1:0,l=((this.tt||this.it)&&(n.strokeStyle="#fff",n.lineWidth=7,n.strokeRect(this.l.x-3,this.l.y-3,this.s.x+3,this.s.y+3)),n.fillStyle="#000",n.fillRect(this.l.x-3,this.l.y-3,this.s.x+3,this.s.y+3),n.fillStyle="#BAE89B",n.fillRect(this.l.x,this.l.y,this.s.x-3,this.s.y-3),this.Tt()),t=this.ct.split("").map(function(i,t){var o={x:s.l.x+30*t*r+15,y:s.l.y+30*t*h+15},e=c(l,30*t*r,30*t*h);return t=s.R.gt(o,s),{Ct:o,Et:i,St:0<t.length,Dt:t.some(function(t){return!t.is(e,i)}),kt:!s.R.Bt(e)}}),a=(this.bt=t.some(function(t){return t.kt||t.Dt}),t.some(function(t){return!t.kt})&&this.bt);t.forEach(function(t,i){n.fillStyle="#C6ECAE",(t.St||a&&t.kt)&&(n.fillStyle=t.Dt||t.kt?"pink":"#F1EE95"),n.fillRect(s.l.x+30*i*r,s.l.y+30*i*h,27,27),n.fillStyle="#000";var o=s.it||s.tt?2*Math.sin(.008*s.time+i*Math.PI*.1):0,e=(o={x:s.l.x+30*i*r+15-1,y:s.l.y+19+30*i*h+o},n.save(),1+.4*Math.abs(Math.sin(s.yt*Math.PI)));p(n,o.x,o.y-5,0,e,e),n.fillText(t.Et,o.x,o.y),n.restore(),(t.St||t.Dt||a&&t.kt)&&(n.strokeStyle=t.Dt||t.kt?"#D5573B":"#000",n.setLineDash([]),n.lineWidth=4,n.strokeRect(s.l.x+30*i*r-2,s.l.y+30*i*h-2,31,31),t.kt||l.x==s.wt.x&&l.y==s.wt.y||!t.St||t.Dt||s.R.Ot(new gt(l.x+i*r*30+15,l.y+i*h*30+15,40,u(.8,.9),5,60)))}),this.wt=l},P.prototype.is=function(t,i){return t=this.vt?(t.y-this.l.y)/30:(t.x-this.l.x)/30,this.ct.at(t)===i},P.prototype.ht=function(){this.R.It++,this.d=this.R.It,this.R.K.Nt()},P.prototype.nt=function(){},P.prototype.rt=function(){this.R.It++,this.d=this.R.It,this.R.P(),this.R.Ft(),this.R.K.rt()},P.prototype.click=function(){},P.prototype.ut=function(){this.l=this.Tt(),c(this.l,15,15),this.R.evaluate(),this.R.K.ut(),this.yt=1},P.prototype.Tt=function(){return{x:30*Math.round(this.l.x/30),y:30*Math.round(this.l.y/30)}},P),kt=function(t,i){return(kt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},Yt=g;if("function"!=typeof(v=Nt=o)&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function Ot(){this.constructor=Yt}kt(Yt,v),Yt.prototype=null===v?Object.create(v):(Ot.prototype=v.prototype,new Ot),g.prototype.open=function(){this.p.scale({x:1,y:1},.5)},g.prototype.update=function(t,i){Nt.prototype.update.call(this,t,i),this.Lt.update(t,i),t=this.Ht>=this.Gt?Math.min(this.Ht-this.Gt,100):Math.max(this.Ht-this.Gt,-100),this.Gt=this.Gt+t,this.Lt.m(1).content=this.Gt.toString().replace(/\B(?=(\d{3})+(?!\d))/g," ")},g.prototype.qt=function(t,i){this.Lt.m(0).content=t,this.Ht=i},g.prototype.M=function(t){t.save(),t.translate(60,0),t.lineWidth=5,t.strokeStyle="#000",t.fillStyle=r,t.save(),t.translate(382.5,585),t.scale(1,this.scale.y),t.translate(-382.5,-585),t.beginPath(),t.rect(405,215,360,370),t.fill(),t.stroke(),t.fillStyle="#D5573B22";for(var i=0;i<121;i++)t.fillRect(420+i%11*30,240+30*Math.floor(i/11),27,25);t.restore();var o=360-360*this.scale.y;t.beginPath(),t.moveTo(390,185+o),t.quadraticCurveTo(375,205+o,390,225+o),t.lineTo(780,225+o),t.lineTo(780,185+o),t.closePath(),t.fill(),t.stroke(),this.Lt.m(1).l={x:745,y:216+o},n(t,{x:780,y:205+o},10,20,r),t.stroke(),t.beginPath(),t.moveTo(390,585),t.quadraticCurveTo(375,605,390,625),t.lineTo(780,625),t.lineTo(780,585),t.closePath(),t.fill(),t.stroke(),n(t,{x:780,y:605},10,20,r),t.stroke(),this.Lt.M(t),t.restore()};var v,St=g,Ct=function(t,i){return(Ct=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},jt=_;if("function"!=typeof(v=Kt=vt)&&null!==v)throw new TypeError("Class extends value "+String(v)+" is not a constructor or null");function Dt(){this.constructor=jt}Ct(jt,v),jt.prototype=null===v?Object.create(v):(Dt.prototype=v.prototype,new Dt),_.prototype.update=function(t,i){Kt.prototype.update.call(this,t,i),this.time=t},_.prototype.M=function(e){var n=this,t=(e.save(),e.rotate(null!=(t=null==(t=this.options)?void 0:t.angle)?t:0),null!=(t=this.options)&&t.X?this.ratio:1),s=(e.font="".concat(this.fontSize*t,"px ").concat(pt),e.textAlign=null!=(t=null==(t=this.options)?void 0:t.align)?t:"center",null!=(t=null==(t=this.options)?void 0:t.spacing)?t:0),r=0;this.content.split("").forEach(function(t,i){var o;null!=(o=n.options)&&o.Z&&(e.fillStyle="#000",e.fillText(t,n.l.x+s*i+n.options.Z+r,n.l.y+n.options.Z+Math.sin(.005*n.time+i*n.frequency)*n.amplitude)),e.fillStyle=null!=(o=null==(o=n.options)?void 0:o.color)?o:"#fff",null!=(o=n.options)&&o.outline&&(e.strokeStyle="#000",e.lineWidth=n.options.outline,e.strokeText(t,n.l.x+s*i+r,n.l.y+Math.sin(.005*n.time+i*n.frequency)*n.amplitude)),e.fillText(t,n.l.x+s*i+r,n.l.y+Math.sin(.005*n.time+i*n.frequency)*n.amplitude),r+=e.measureText(t).width}),e.restore()};var At=_,qt=function(t,i){return(qt=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},x=i,Rt=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}qt(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}(b,Bt=o),b.prototype.Ut=function(){var t=this;this.visible?this.hide():(this.Yt=Math.random()<.1,this.Rt=u(-500,500),this.rotation=Math.random()<.7?0:1,this.show(),setTimeout(function(){return t.Jt()},300),setTimeout(function(){return t.hide()},900))},b.prototype.Jt=function(t){var i=this;void 0===t&&(t=1),this.face.H(.6,.1),this.R.K.Jt(),Math.random()<.5&&t<2&&setTimeout(function(){return i.Jt(t+1)},200+200*Math.random())},b.prototype.show=function(){this.visible||this.R.K.W(),this.visible=!0,this.p.move({x:this.l.x,y:650},.4)},b.prototype.hide=function(){this.R.K.W(),this.visible=!1,this.p.move({x:this.l.x,y:1150},.9)},b.prototype.update=function(t,i){Bt.prototype.update.call(this,t,i),this.Y=.7*Math.abs(Math.sin(.003*t)),this.face.update(t,i)},b.prototype.M=function(t){t.save(),t.lineDashOffset=0,p(t,450,325,Math.PI*this.rotation),p(t,this.l.x-this.Rt,this.l.y+170,0,.7,.7),t.lineWidth=60,t.strokeStyle="#000",t.setLineDash([0,40]),t.lineCap="round",t.beginPath(),t.ellipse(this.l.x,this.l.y-300-20*this.Y,80,80,0,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.strokeStyle="#000",t.moveTo(this.l.x-150+7*this.Y,this.l.y+20),t.lineDashOffset=25*-this.Y,t.quadraticCurveTo(this.l.x,this.l.y-500-50*this.Y,this.l.x+150-7*this.Y,this.l.y+20),t.stroke(),t.setLineDash([]),t.fillStyle=x,t.lineWidth=13,t.strokeStyle="#000",t.save(),t.translate(this.l.x+60,this.l.y-340-20*this.Y),t.rotate(.25*Math.PI+.3*this.Y),t.beginPath(),t.moveTo(20,0),t.quadraticCurveTo(30,-40,0,-80),t.quadraticCurveTo(-30,-40,-20,0),t.closePath(),t.fill(),t.stroke(),t.restore(),t.save(),t.translate(this.l.x-60,this.l.y-340-20*this.Y),t.rotate(.25*-Math.PI-.3*this.Y),t.beginPath(),t.moveTo(20,0),t.quadraticCurveTo(30,-40,0,-80),t.quadraticCurveTo(-30,-40,-20,0),t.closePath(),t.fill(),t.stroke(),t.restore(),t.lineDashOffset=0,t.lineWidth=40,t.strokeStyle=x,t.fillStyle=x,t.setLineDash([0,40]),t.lineCap="round",t.beginPath(),t.ellipse(this.l.x,this.l.y-300-20*this.Y,80,80,0,0,2*Math.PI),t.closePath(),t.stroke(),t.beginPath(),t.moveTo(this.l.x-150+7*this.Y,this.l.y+20),t.lineDashOffset=25*-this.Y,t.quadraticCurveTo(this.l.x,this.l.y-500-50*this.Y,this.l.x+150-7*this.Y,this.l.y+20),t.fill(),t.stroke(),e(t,c(this.l,0,-300-20*this.Y),87,x),t.strokeStyle="#f7f5bf",t.lineDashOffset=10*-this.Y,e(t,c(this.l,10,-300-40*this.Y),50,"#f7f5bf"),t.stroke(),n(t,c(this.l,10,0-40*this.Y),80,200,"#f7f5bf"),t.stroke(),t.setLineDash([]),t.lineWidth=10,t.strokeStyle="#000",t.fillStyle="#f7f5bf",t.save(),t.translate(this.l.x-50,this.l.y-170-40*this.Y),t.beginPath(),t.moveTo(20,10),t.quadraticCurveTo(30,75-20*this.Y,0,80-20*this.Y),t.quadraticCurveTo(-40,75-20*this.Y,-20,0),t.fill(),t.stroke(),t.beginPath(),t.lineWidth=7,t.moveTo(-10,75-20*this.Y),t.lineTo(-10,55-20*this.Y),t.moveTo(7,80-20*this.Y),t.lineTo(7,60-20*this.Y),t.stroke(),t.restore(),t.save(),t.lineWidth=10,t.translate(this.l.x+50,this.l.y-170-40*this.Y),t.beginPath(),t.moveTo(20,0),t.quadraticCurveTo(40,75,0,80-20*this.Y),t.quadraticCurveTo(-30,75-20*this.Y,-20,10),t.fill(),t.stroke(),t.beginPath(),t.lineWidth=7,t.moveTo(-7,80-20*this.Y),t.lineTo(-7,60-20*this.Y),t.moveTo(10,75-20*this.Y),t.lineTo(10,55-20*this.Y),t.stroke(),t.restore(),t.save(),t.translate(this.l.x,this.l.y-310-45*this.Y),this.face.M(t),t.fillStyle="#000",t.beginPath(),t.moveTo(0,30),t.lineTo(-15,0),t.lineTo(15,0),t.closePath(),t.fill(),n(t,{x:0,y:5},20,12,"#000"),t.restore(),this.Yt&&(t.save(),p(t,this.l.x,this.l.y-420,0,.7,.7),t.lineWidth=25,t.fillStyle=i,t.beginPath(),t.moveTo(this.l.x-75,this.l.y-370-25*this.Y),t.quadraticCurveTo(this.l.x,this.l.y-360-25*this.Y,this.l.x+75,this.l.y-370-25*this.Y),t.lineTo(this.l.x+75,this.l.y-450-25*this.Y),t.lineTo(this.l.x+37,this.l.y-420-25*this.Y),t.lineTo(this.l.x,this.l.y-460-25*this.Y),t.lineTo(this.l.x-37,this.l.y-420-25*this.Y),t.lineTo(this.l.x-75,this.l.y-450-25*this.Y),t.closePath(),t.stroke(),t.fill(),t.restore()),t.restore()},b),Et={Kt:[{Pt:[1,60,128,0,0,191,116,9,0,0,6,22,34,0,0,0,0,69,3,1,1,23,167,0,32,77,6,25,6],l:[,,,1,2,3,4,1],c:[{n:[142,140,142,143,145,143,142,140,142,140,138,140,142,,,,142,140,138,140,142,,140,138,137],f:[]},{n:[142,140,138,140,142,144,145,144,142,140,138,140,142,,,,142,140,138,142,140,138,137,133,135],f:[]},{n:[135,137,138,,138,137,138,,138,140,142,140,142,,142,144,145,147,149,147,145,144,142,140,142],f:[]},{n:[142,,147,145,147,,142,,142,,147,145,147,,,,147,145,142,,140,138,135,133,135],f:[]}]},{Pt:[3,192,116,0,3,192,128,0,0,0,7,12,22,0,0,0,0,0,0,0,2,255,0,0,32,61,3,29,4],l:[,1,2,1,2,,,4,3],c:[{n:[,,154,152,154,,,,,,154,152,154,,,,154,152,150,152,154,,152,150,152,150,149,150,152],f:[]},{n:[154,152,150,152,154,,,,,147,154,152,154,,,,154,152,150,,152,150,149,,150,149,147,145,147],f:[]},{n:[154,152,150,152,154,,,,,147,154,152,154,,,,154,152,150,,152,150,149,,150,149,147,145,147,,,,142,,147,145,147,,142,,142,,147,145,147,,,,147,145,142,,140,138,135,133,135],f:[]},{n:[,,154,152,154,,,,,,154,152,154,,,,154,,,,,,152,150,152],f:[]}]},{Pt:[0,127,116,64,0,127,116,0,64,0,4,6,35,0,0,0,0,0,0,0,2,14,1,1,32,0,0,0,0],l:[,1,1,1,1,1,1,,1],c:[{n:[147,,,,,,,,147,,,,,,,,147,,,,,,,,147],f:[]}]},{Pt:[0,160,128,64,0,160,128,0,64,127,4,7,52,85,0,0,0,60,4,1,2,255,0,0,32,61,5,32,6],l:[1,1,2,1,2,1,2],c:[{n:[135,,,,135,,,135,135,,,135,135,,,,135,,135,135,135,,,,135,,,135,135],f:[]},{n:[135,,,,135,,,,135,,,,135,,,,135,,135,,135,,,,135,,135,,135],f:[]}]},{Pt:[2,100,128,0,3,201,128,0,0,0,0,6,29,0,0,0,0,195,4,1,3,50,184,119,244,147,6,84,6],l:[1,1,1,1,1,1,1,1],c:[{n:[111,,111,,109,,109,,106,,106,,109,,109,,111,,111,,109,,109,,106,,106,,109,,109],f:[]}]}],zt:8820,Qt:32,Vt:8,Wt:5};function Wt(t,i,o){if(o||2===arguments.length)for(var e,n=0,s=i.length;n<s;n++)!e&&n in i||((e=e||Array.prototype.slice.call(i,0,n))[n]=i[n]);return t.concat(e||Array.prototype.slice.call(i))}function It(){function q(t){return Math.sin(6.283184*t)}function R(t){return.003959503758*Math.pow(2,(t-128)/12)}var E,W,I,L,B,K=[q,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){return(t=t%1*4)<2?t-1:3-t}];this.init=function(t){W=(E=t).Vt,I=0,L=t.zt*t.Qt*(W+1)*2,B=new Int32Array(L)},this.ai=function(){for(var t,i,o,e,n,s,r,h=new Int32Array(L),l=E.Kt[I],a=E.zt,u=E.Qt,c=0,p=0,f=!1,y=[],d=0;d<=W;++d)for(o=l.l[d],t=0;t<u;++t){for(var v=K[l.Pt[16]],x=l.Pt[17]/512,w=Math.pow(2,l.Pt[18]-9)/a,T=l.Pt[19],m=l.Pt[20],b=43.23529*l.Pt[21]*3.141592/44100,_=1-l.Pt[22]/255,g=1e-5*l.Pt[23],P=l.Pt[24]/32,M=l.Pt[25]/512,k=6.283184*Math.pow(2,l.Pt[26]-9)/a,Y=l.Pt[27]/255,O=l.Pt[28]*a&-2,S=(d*u+t)*a,C=0;C<4;++C)if(i=o?l.c[o-1].n[t+C*u]:0){y[i]||(y[i]=function(t,i){for(var o,e,n,s,r=K[t.Pt[0]],h=t.Pt[1],l=t.Pt[3]/32,a=K[t.Pt[4]],u=t.Pt[5],c=t.Pt[8]/32,p=t.Pt[9],f=t.Pt[10]*t.Pt[10]*4,y=t.Pt[11]*t.Pt[11]*4,d=t.Pt[12]*t.Pt[12]*4,v=1/d,x=-t.Pt[13]/16,w=t.Pt[14],T=(Math.pow(2,2-t.Pt[15]),new Int32Array(f+y+d)),m=0,b=0,_=0,g=0;_<f+y+d;_++,g++)0<=g&&(n=R(i+(15&w)+t.Pt[2]-128),s=R(i+(15&w)+t.Pt[6]-128)*(1+8e-4*t.Pt[7])),o=1,_<f?o=_/f:f+y<=_&&(o=(1-(o=(_-f-y)*v))*Math.pow(3,x*o)),e=r(m+=n*Math.pow(o,l))*h,e+=a(b+=s*Math.pow(o,c))*u,p&&(e+=(2*Math.random()-1)*p),T[_]=80*e*o|0;return T}(l,i));for(var j=y[i],D=0,A=2*S;D<j.length;D++,A+=2)h[A]+=j[D]}for(D=0;D<a;D++)(n=h[e=2*(S+D)])||f?(s=b,T&&(s*=v(w*e)*x+.5),p+=(s=1.5*Math.sin(s))*(s=_*(n-p)-(c+=s*p)),n=3==m?p:1==m?s:c,g&&(n=(n*=g)<1?-1<n?q(.25*n):-1:1,n/=g),f=1e-5<(n*=P)*n,r=n*(1-(s=Math.sin(k*e)*M+.5)),n*=s):r=0,O<=e&&(r+=h[e-O+1]*Y,n+=h[e-O]*Y),h[e]=0|r,h[1+e]=0|n,B[e]+=0|r,B[1+e]+=0|n}return++I/E.Wt},this.vi=function(t){for(var i=t.createBuffer(2,L/2,44100),o=0;o<2;o++)for(var e=i.getChannelData(o),n=o;n<L;n+=2)e[n>>1]=B[n]/65536;return i},this.li=function(){var t=44+2*L-8,i=t-36,o=new Uint8Array(44+2*L);o.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&i,i>>8&255,i>>16&255,i>>24&255]);for(var e=0,n=44;e<L;++e){var s=B[e];o[n++]=255&(s=s<-32767?-32767:32767<s?32767:s),o[n++]=s>>8&255}return o},this.getData=function(t,i){for(var o=2*Math.floor(44100*t),e=new Array(i),n=0;n<2*i;n+=1){var s=o+n;e[n]=0<t&&s<B.length?B[s]/32768:0}return e}}var Lt,Bt,Kt,Nt,Ft,Ht,w,Ut,Gt,Zt,Jt,zt,$t,Vt,Xt,Qt,ti,ii=function(t,i){return(ii=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(t,i){t.__proto__=i}:function(t,i){for(var o in i)Object.prototype.hasOwnProperty.call(i,o)&&(t[o]=i[o])}))(t,i)},oi=["JOHN","by","the","grace","of","God","King","of","England","Lord","of","Ireland","Duke","of","Normandy","and","Aquitaine","and","Count","of","Anjou","to","his","archbishops","bishops","abbots","earls","barons","justices","foresters","sheriffs","stewards","servants","and","to","all","his","officials","and","loyal","subjects","Greeting"],ei=[7,5,4,4,3,1,1,1,2,1,1,1,1,1,4,1,2,1,1],T=(function(t,i){if("function"!=typeof i&&null!==i)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");function o(){this.constructor=t}ii(t,i),t.prototype=null===i?Object.create(i):(o.prototype=i.prototype,new o)}(m,Lt=o),m.prototype.Ot=function(t){this.$t.add(t)},m.prototype.ui=function(t,i){for(var o=0;o<i;o++)this.$t.add(new tt(t.x,t.y,5,5,1,{x:u(-3,3),y:u(-8,0)},{force:{x:0,y:.2},color:"#fff3"}))},m.prototype.update=function(i,o){var t;this.Y=Math.abs(Math.sin(.002*i)),Lt.prototype.update.call(this,i,o),Wt([],this.Zt,!0).sort(function(t,i){return i.d-t.d}).forEach(function(t){return t.update(i,o)}),this.si.update(i,o),this.hi.update(i,o),this.$t.update(i,o),this.ri.update(i,o),this.ti.update(i,o),null!=(t=this.Lt)&&t.update(i,o),this.ni.update(i,o)},m.prototype.M=function(i){var t;i.fillStyle="#94C9A9",i.fillRect(0,0,900,650),i.strokeStyle="#777DA725",i.lineCap="round",this.ei(i,64,0,0,0+5*this.Y),this.ei(i,48,16,32,50+7*this.Y),this.ei(i,32,32,0,80+9*this.Y),this.ei(i,32,32,32,95+11*this.Y),this.ei(i,24,40,0,110+13*this.Y),i.save(),p(i,450,325,Math.PI),this.ei(i,64,0,0,0+5*this.Y),this.ei(i,48,16,32,50+7*this.Y),this.ei(i,32,32,0,80+9*this.Y),this.ei(i,32,32,32,95+11*this.Y),this.ei(i,24,40,0,110+13*this.Y),i.restore(),i.lineCap="butt",i.setLineDash([]),this.ti.M(i),this.$t.M(i),Wt([],this.Zt,!0).sort(I).forEach(function(t){return t.M(i)}),this.ni.M(i),this.si.M(i),this.hi.M(i),i.lineJoin="round",null!=(t=this.Lt)&&t.M(i),this.ri.M(i)},m.prototype.ei=function(t,i,o,e,n){t.lineWidth=i,t.setLineDash([0,i+o]),t.lineDashOffset=e,t.beginPath(),t.moveTo(0,650-n),t.lineTo(1500,650-n),t.stroke()},m.prototype.Bt=function(t){return 450<t.x&&t.x<810&&210<t.y&&t.y<570},m.prototype.gt=function(i,o){return this.Zt.filter(function(t){return!t._t()&&t!==o&&t.j(i)})},m.prototype.At=function(){this.fi=!0},m.prototype.evaluate=function(){for(var t=this,i=this.Zt.reduce(function(t,i){return t+i.xt()},0),o=0,e=0;e<11;e++)for(var n=0;n<11;n++)0==this.gt({x:495+30*e,y:255+30*n},null).length&&o++;var s=i/oi.join("").length,i=Math.floor(i*i+o*i);return this.ti.qt(Math.floor(100*s)+"% DONE",i),clearTimeout(this.ci),1<=s?(this.si.show(["Good job!","Didn't even know","if a feat like","that was possible!"]),this.ci=setTimeout(function(){return t.si.hide()},5e3),void this.hi.Ut()):2e3<i&&!this.fi?void this.si.show(["You can also rotate","the words by right","clicking while","dragging them..."]):(0==i&&this.si.V(["Almost there!","You need to fully","fit the word on the","parchment over there."]),i>this.ii&&this.hi.Ut(),0<(this.ii=i)?(this.si.V(["","Yes indeed, just","like that!",""]),void(this.ci=setTimeout(function(){return t.si.hide()},2e3))):void 0)},m.prototype.P=function(){this.si.P()},m.prototype.Ft=function(){var t=this;this.Lt&&(this.Lt.hide(.3),setTimeout(function(){return t.Lt=null}))},m);function m(t,i){var o=Lt.call(this,0,0,0,0)||this,e=(o.Xt=t,o.K=i,o.It=0,o.Zt=[],o.$t=new a,o.ti=new St,o.Y=1,o.ii=0,o.ni=new a(450,325),o.si=new ct(o),o.hi=new Rt(o),o.Lt=new a(0,0,[new At("MAGNA CARTA",80,100,580,.6,5,{align:"left",outline:20,spacing:5}),new At("by Antti Haavikko",35,240,630,.2,5,{align:"left",outline:12,spacing:5})]),i.oi(Et),0),n=0,s=0;return oi.forEach(function(t,i){o.Zt.push(new Mt(t.toUpperCase(),30+30*e,30+30*n,o)),s++,e+=t.length,ei[n]<=s&&(e=s=0,n++)}),o.ri=new $(900,650),o}function b(t){var i=Bt.call(this,450,1150,0,0)||this;return i.R=t,i.Y=0,i.face=new ht(150,150,J),i.visible=!0,i.Rt=250,i.rotation=0,i.Yt=!1,i.p=new l(i,z),i.show(),i}function _(t,i,o,e,n,s,r){return(t=Kt.call(this,t,i,o,e,-1,h,r)||this).frequency=n,t.amplitude=s,t.time=0,t}function g(){var t=Nt.call(this,0,0,0,0)||this;return t.Gt=0,t.Ht=0,t.Lt=new a(0,0,[new vt("0% DONE",18,750,612,-1,h,{align:"right",color:"#D5573B99"}),new vt("0",28,750,216,-1,h,{align:"right",color:"#D5573B99"})]),t.scale={x:1,y:0},setTimeout(function(){return t.open()},1100),t}function P(t,i,o,e){return(i=Ft.call(this,i,o,30*t.length,30)||this).ct=t,i.R=e,i.vt=!1,i.lt=!1,i.dt=!1,i.rotation=0,i.yt=0,i.wt={x:0,y:0},i.Mt=t,i}function ni(t,i,o,e,n,s){return void 0===e&&(e=1),void 0===n&&(n=0),void 0===s&&(s=40),(t=Ht.call(this,t,i,o,o,(.3+.1*Math.random())*e,h)||this).et=o,t.ft=n,t.alpha=s,t}function si(){var t=null!==w&&w.apply(this,arguments)||this;return t.offset={x:0,y:0},t}function ri(t,i,o,e,n,s,r){return(o=Ut.call(this,o,e,0,0,n,s)||this).content=t,o.fontSize=i,o.options=r,o}function M(t){var i=Gt.call(this,200,1150,0,0)||this;return i.R=t,i.Y=0,i.face=new ht(150,150,J),i.U=new ot(430,220,function(){return i.speak()}),i.visible=!1,i.p=new l(i,W),i.U.scale={x:0,y:0},i.J=setTimeout(function(){return i.show(["Hey there! Could","you be so kind to","fit all this content","on that parchment?"])},500),i}function k(t,i,o){var e=Zt.call(this,0,0,0,0)||this;return e.G=o,e.N=0,e.F=0,e.left=new nt(-50,0,10),e.right=new nt(50,0,10),e.blink(t,i),e}function Y(t,i,o){return(t=Jt.call(this,t,i,o,o)||this).N=1,t.F=1,t}function O(t,i,o){return(t=$t.call(this,0,0,t,i)||this).S=o,t.D=[],t.k=0,t}function S(t,i,o,e,n,s,r){var h=this;return(h=Vt.call(this,t,i,o,e,n,s)||this).options=r,null!=(t=h.options)&&t.C&&(h.d=h.options.C),h}function hi(t,i,o,e,n,s){return(t=Xt.call(this,t,i,o,e)||this).T=n,t.g=s,t.ratio=1,t.start=-1,t}function C(t,i,o){return void 0===o&&(o=[]),(t=Qt.call(this,t=void 0===t?0:t,i=void 0===i?0:i,0,0)||this).children=[],(i=t.children).push.apply(i,o),t}function j(t,i){return(t=ti.call(this,0,0,t,i)||this).d=500,t.open(),t}function D(t,i,o,e){this.scale={x:1,y:1},this.d=0,this.l={x:t,y:i},this.s={x:o,y:e},this.p=new l(this)}function A(t,i){void 0===i&&(i=z),this.o=t,this.u=i,this.time=0,this.type="none"}function q(){this.offset=h,this.t=0,this.i=0}function R(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return li.play.apply(li,t)}var li={volume:.3,sampleRate:44100,x:new AudioContext,play:function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];return this.di(this.yi.apply(this,t))},di:function(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var o=this.x.createBuffer(t.length,t[0].length,this.sampleRate),e=this.x.createBufferSource();return t.map(function(t,i){return o.getChannelData(i).set(t)}),e.buffer=o,e.connect(this.x.destination),e.start(),e},yi:function(t,i,o,e,n,s,r,h,l,a,u,c,p,f,y,d,v,x,w,T){void 0===t&&(t=1),void 0===i&&(i=.05),void 0===o&&(o=220),void 0===e&&(e=0),void 0===n&&(n=0),void 0===s&&(s=.1),void 0===r&&(r=0),void 0===h&&(h=1),void 0===l&&(l=0),void 0===a&&(a=0),void 0===u&&(u=0),void 0===c&&(c=0),void 0===p&&(p=0),void 0===f&&(f=0),void 0===y&&(y=0),void 0===d&&(d=0),void 0===v&&(v=0),void 0===x&&(x=1),void 0===w&&(w=0),void 0===T&&(T=0);var m,b,_=2*Math.PI,g=this.sampleRate,P=l*=500*_/g/g,M=o*=(1+2*i*Math.random()-i)*_/g,k=[],Y=0,O=0,S=0,C=1,j=0,D=0,A=0;for(e=e*g+9,w*=g,n*=g,s*=g,v*=g,a*=500*_/Math.pow(g,3),y*=_/g,u*=_/g,c*=g,p=p*g|0,b=e+w+n+s+v|0;S<b;k[S++]=A)++D%(100*d|0)||(A=r?1<r?2<r?3<r?Math.sin(Math.pow(Y%_,3)):Math.max(Math.min(Math.tan(Y),1),-1):1-(2*Y/_%2+2)%2:1-4*Math.abs(Math.round(Y/_)-Y/_):Math.sin(Y),A=(p?1-T+T*Math.sin(_*S/p):1)*(0<A?1:-1)*Math.pow(Math.abs(A),h)*t*this.volume*(S<e?S/e:S<e+w?1-(S-e)/w*(1-x):S<e+w+n?x:S<b-v?(b-S-v)/s*x:0),A=v?A/2+(S<v?0:(S<b-v?1:(b-S)/v)*k[S-v|0]/2):A),Y+=(m=(o+=l+=a)*Math.cos(y*O++))-m*f*(1-1e9*(Math.sin(S)+1)%2),C&&++C>c&&(o+=u,M+=u,C=0),!p||++j%p||(o=M,l=P,C=C||1);return k}},B=(N.prototype.oi=function(t){var i,o,e=this;this.wi||(this.K=document.createElement("audio"),this.wi=!0,(i=new It).init(t),i.ai(),this.loaded=!1,o=setInterval(function(){var t;!e.loaded&&(e.loaded=1<=i.ai(),e.loaded)&&(t=i.li(),e.K.src=URL.createObjectURL(new Blob([t],{type:"audio/wav"})),e.K.loop=!0,clearInterval(o))},5))},N.prototype.play=function(){var t=this,i=setInterval(function(){t.loaded&&(t.K.play(),clearInterval(i))},5)},N.prototype.ht=function(){},N.prototype.click=function(){},N.prototype.Jt=function(){R.apply(void 0,[.3,,77,.06,.07,0,,.05,17,-28,-51,.13,.13,,,.1]),R.apply(void 0,[.3,,15,.06,.1,0,,.05,15,-28,-1200,.13,.13,.5,.1,.4,,.7])},N.prototype.rt=function(){R.apply(void 0,[1.03,,712,.01,.1,.06,,.2,-36,,,,,,,,,.05]),R.apply(void 0,[1.5,,429,.03,.02,0,,3,-18,,,,,,,,.13,.76,.01])},N.prototype.ut=function(){R.apply(void 0,[.3,,36,,.09,.12,,.35,,,-833,.05,.09,,,,,.77,,.01]),R.apply(void 0,[.8,,712,.01,.1,.06,,.2,-36,,,,,,,,,.05]),R.apply(void 0,[1.5,,538,,.01,.01,,.89,,-29,,,,.1,,,.11])},N.prototype.rotate=function(){R.apply(void 0,[1,,26,.23,.02,.17,1,.44,-.9,,,,,.1,,,.21,,,.01]),R.apply(void 0,[20,,6,,,.02,4,.33,,,,,.09,,170,,.33,.48,.12]),R.apply(void 0,[1.01,,437,.02,.05,.09,,1.55,7.5,3.5,,,,1,,,,.48,.01])},N.prototype.W=function(){R.apply(void 0,[.2,,233,.01,.06,.07,1,1.8,7.1,,,,,1.9,,,,.95,.05]),R.apply(void 0,[.3,,93,.01,.08,.06,1,1.28,-14,,,,,,,,,.54,.1]),R.apply(void 0,[.5,,365,.03,.02,.09,,1.2,-1,-.5,,,,1.2,,,,.89,.07])},N.prototype.Nt=function(){R.apply(void 0,[1.5,,538,,.01,.01,,.89,,-29,,,,.1,,,.11])},N.prototype.speak=function(){var t=(t=[[.3,,1496,.09,.09,.01,3,.14,,,-870,,,,3.2,.2,,.31,.02],[.3,,1497,.09,.09,.01,1,.14,,-.2,-870,,,,2.2,.2,,.31,.02],[.3,,1497,.09,.09,.01,1,.14,,-.2,-870,.01,,,1.2,.2,,.31,.03,.01],[.5,,8,.15,,.04,1,1.38,-11,-44,1,,,,,.2],[1,,478,.01,.09,.08,1,1.18,-1.1,,,,,.6,1,.3,.04,.46,.02]])[Math.floor(Math.random()*t.length)];R.apply(void 0,t)},d=N,document.createElement("canvas")),ai=B.getContext("2d"),K={x:0,y:0},ui=new T(new Z,new d);function N(){this.wi=!1}function ci(){F=Math.min(window.innerWidth/900,window.innerHeight/650),B.style.transformOrigin="top left",pi=.5*(window.innerWidth-900*F),fi=.5*(window.innerHeight-650*F),B.style.transform="translate(".concat(pi,"px,").concat(fi,"px) scale(").concat(F,")")}B.id="game",B.width=900,B.height=650,document.body.appendChild(B);var F,pi,fi,H=!1;document.onfullscreenchange=function(){return H=!H},document.onmousemove=function(t){K.x=H?t.x/window.innerWidth*900:t.offsetX,K.y=H?t.y/window.innerHeight*650:t.offsetY},ci(),window.onresize=ci,document.onkeyup=function(t){" "==t.key&&(K.jt=!1)},document.onkeydown=function(t){" "==t.key&&(K.jt=!0),"f"==t.key&&B.requestFullscreen()},document.onmousedown=function(t){ui.K.play(),0==t.button&&(K.ot=!0),0<t.button&&(K.right=!0)},document.oncontextmenu=function(t){return t.preventDefault()},document.onmouseup=function(t){0==t.button&&(K.ot=!1),0<t.button&&(K.right=!1)},requestAnimationFrame(function t(i){ui.update(i,K),ui.M(ai),requestAnimationFrame(t)})</script>