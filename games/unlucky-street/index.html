<!doctype html><title>Unlucky Street - js13kGames 2025</title><meta name=viewport content="width=device-width,user-scalable=0"><style>html{height:100%;padding:0}*{box-sizing:border-box}body{position:relative;margin:0 auto;padding:0;max-width:720px;height:100%;font-family:sans-serif;overflow:hidden;background:#000}canvas{background:#3c2c6b;-webkit-user-select:none;user-select:none}img{image-rendering:pixelated;image-rendering:crisp-edges}#ui{position:absolute;-webkit-user-select:none;user-select:none}#lives{padding:6px;display:flex}.life{width:64px;height:auto}#death-screen{display:none}.menu-c{position:absolute;z-index:2;top:0;background:#00000080}.menu{background:#3c2c6b;width:50%;height:50%;border:1px solid #fff;color:#fff;padding:0 10px}.menu-buttons{margin-top:32px}.menu-buttons button{width:140px}header>img{width:calc(32px + 1vw)}#l{background:#3c2c6b;color:#fff}.spinning{animation:1.5s spin linear infinite;width:64px}@keyframes spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}.c{display:flex;justify-content:center;align-items:center}.f{display:flex}.f1{flex:1}.fc{flex-direction:column}.g{gap:10px}.full{width:100%;height:100%}.tc{text-align:center}button{background:#e50;padding:.718rem 1.618rem;color:#fff;letter-spacing:1px;text-shadow:0 1px 2px rgba(0,0,0,.8),0 -1px 2px rgba(0,0,0,.2);border:1px solid rgba(0,0,0,.35);border-radius:10px;transition:all .15s linear 0s;-webkit-user-select:none;user-select:none;text-transform:uppercase;font-weight:600;margin:.618rem;cursor:pointer;-webkit-tap-highlight-color:transparent}button:active,button:hover{box-shadow:0 1px #ffffff40,0 1px #ffffff40 inset,0 1.1em #ffffff40 inset,0 -1.1em 1.25em #00000052 inset,0 1.1rem 1.25em #ffffff0d inset,0 1.1em 6px #ffffff1a inset;-webkit-filter:saturate(120%);filter:saturate(120%)}h2{color:#e50}#score{font-size:24px;color:#fff;padding-left:16px}#mobile{position:absolute;z-index:1}#left,#right{position:absolute;top:80%;width:96px;height:96px;border-radius:50%;font-size:32px}@media screen and (min-width:1025px){#left,#right{display:none}}#left{left:10%}#right{right:10%}#t{display:none;position:absolute;z-index:3}#t>div{position:relative}#t-window{position:absolute;width:fit-content;max-width:50%;height:fit-content;transition:.3s ease-in-out}</style><div id=l class="c full fc"><img src=happy.png class=spinning><p>Loading...</div><div id=t class=full><div class=full><div id=t-window class=menu><p id=t-text></p><button class=tc>ok</button></div></div></div><div id=mobile class=full><div class=full><button id=left>L</button><button id=right>R</button></div></div><div id=ui class=full><div id=lives></div><div id=score></div><div id=start-menu class="c menu-c full"><div class="fc menu"><header class="f g c"><img src=happy.png><h2>Unlucky street</h2><img src=angry.png></header><div class="c fc menu-buttons"><button id=s>Start</button> <button id=t-b>Tutorial</button></div></div></div><div id=death-screen class="c menu-c full"><div class="fc c menu"><p>Oops! Humans have noticed you a bit too much...<p>Your final score:<p id=final-score></p><button id=restart>Restart</button></div></div></div><canvas id=game></canvas><script type=module>async function t(t,s,i=16,h=16){const e=[],n=new Map;for(const s of t){const t=new Image(i,h);t.src=`${s}.png`,n.set(s,t),e.push(new Promise((s,i)=>{t.onload=()=>s(t),t.onerror=t=>i(t)}))}return await Promise.all(e),n}function s(t){return Math.random()<=t}function i(t,s){return Math.random()*(s-t)+t}function h(t,s,i,h){return!(t<h||s>i)}function e(t){return document.getElementById(t)}const n=class{static t(t,s){return-t+this.y-s}};n.y=0;let o=n;const a=class{};a.ratio=1;let r=a;const c=class{static update(){for(const t of this.i)r.h.fillStyle="#FFF",r.h.fillText(t.text,t.x,o.t(t.y,0))}static o(t,s){this.i.add(t),setTimeout(()=>{this.i.delete(t)},s)}};c.i=new Set;let d=c;class l{constructor(){this.l=0,this.u=performance.now()}p(){this.u=performance.now()}start(t,s,i=0){if(this.l)return t.destroy(),void(this.l=0);const h=(i-this.u)/1e3;this.u=i,r.h.clearRect(0,0,r.c.width,r.c.height),s.update(h),t.update(h),d.update(),requestAnimationFrame(this.start.bind(this,t,s))}stop(){this.l=1}}const u=class s{static async init(){s.m=await async function(){const t=[],s=["1"];for(const i of s){const s=new Image(16,16);s.src=`${i}.png`,t.push(new Promise((t,i)=>{s.onload=()=>t(s),s.onerror=t=>i(t)}))}return Promise.all(t)}(),s.k=await async function(){return await t(["back-cat","side-cat"])}(),s.M=await async function(){return await t(["human","hat1","hat2","hat3","hat4"],0,16,32)}(),s.v=await async function(){return await t(["angry","happy","pockerface","empty"],0,16,16)}(),s.A=await async function(){return await t(["fish"],0,8,5)}()}};u.m=[];let f=u;const y=class{static I(t){for(const s of Object.keys(this))this[s]*=t}};y.T=96,y.D=100,y.O=80,y.C=160,y.A=32;let p=y;class w{constructor(){this.R=0,this.H=0,this.x=0,this.y=0}}class g extends w{constructor(t){super(),this.x=t.x,this.image=t.image,this.K=t.K,this.H=p.D,this.R=p.D}L(){r.h.drawImage(this.image,0,0,16,16,this.x,o.t(this.K.y-this.R/2,this.K.height),this.H,this.R)}}class m{constructor(){this.P=[[1,0,0,1,0,0,0],[0,0,1,0,0,1,0],[1,0,1,0,0,0,0],[0,0,0,0,1,0,1]],this.S=Math.floor(i(0,this.P.length)),this.F=this.P.length-1}W(t){const i=this.P[this.S];let h=0;for(const[e,n]of i.entries()){if(!n)continue;if(s(.4)&&!h){h=1;continue}const i=e*p.D,o=f.m[0];t.Y(new g({x:i,image:o,K:t}))}this.S===this.F?(this.S=0,this.$()):this.S++}$(){for(const t of this.P)t.reverse()}}class x extends w{constructor(t){super(),this.N=0,this.K=t.K,this.direction=t.d,this.s=t.s*r.ratio,this.x=t.x,this.U=f.M.get(`hat${Math.round(i(1,4))}`),this.q=setInterval(this.X.bind(this),750)}X(){if(Math.random()>=.6)return this.N=1,void setTimeout(()=>{this.N=0},2e3);const t=Math.random()>=.5;this.direction=t?-1:1}update(t){if(this.N)return;const s=this.x+this.direction*this.s*t;s>=-this.H&&s<=r.c.offsetWidth&&(this.x=s)}L(t){this.update(t);const s=f.M.get("human");this.H=p.O,this.R=p.C;const i=o.t(this.K.y,this.K.height)-20;r.h.save(),-1===this.direction?(r.h.scale(-1,1),r.h.drawImage(s,0,0,16,32,-this.x-this.H,i,this.H,this.R),r.h.drawImage(this.U,0,0,16,32,-this.x-this.H,i,this.H,this.R)):(r.h.drawImage(s,0,0,16,32,this.x,i,this.H,this.R),r.h.drawImage(this.U,0,0,16,32,this.x,i,this.H,this.R)),r.h.restore()}j(){clearInterval(this.q)}}const v=class{static init(){this.c=document.getElementById("score"),this.G(0)}static G(t,s=0){s?this._=0:this._+=t,this.c.textContent=this._.toString()}static B(){return this._}};v._=0;let b=v;class k extends w{constructor(t,s,i){super(),this.image=f.A.get("fish"),this.J=0,this.duration=.4,this.x=t,this.V=s,this.y=s,this.K=i,this.H=32*r.ratio,this.R=24*r.ratio}L(t){if(this.J<this.duration){this.J+=t;const s=Math.min(this.J/this.duration,1);this.y=this.V+(this.K.y-this.V)*s}else this.y=this.K.y;const s=o.t(this.K.y-this.K.height/2,this.K.height),i=this.y-this.K.y;r.h.drawImage(this.image,0,0,8,5,this.x,s+i,this.H,this.R)}}class L extends w{constructor(t,s){super(),this.m=[],this.Z=[],this.A=null,this.y=s,this.height=t,this.width=r.c.width,this.L(0)}Y(t){this.m.push(t)}tt(t){return null!=this.A&&h(t+p.T,t,this.A.x+p.A,this.A.x)?1:0}st(t){for(const s of this.m)if(h(t+p.T,t,s.x+p.D,s.x))return 1;return 0}it(t){for(const s of this.Z)if(h(t+p.T,t,s.x+p.O,s.x))return 1;return 0}ht(){const t=function(t){let s=Math.random(),i=0;for(let h in t)if(i+=t[h],s<=i)return parseInt(h);return 0}({1:.6,2:.3,3:.1});for(let h=0;h<t;h++)this.Z.push(new x({K:this,d:s(.5)?-1:1,s:i(200,240),x:Math.round(i(-p.O,r.c.offsetWidth))}))}et(){this.A=null}nt(t,s){this.A=new k(t,s,this)}ot(t){let i=0,h=0,e=-1,n=0;for(const o of this.Z){const a=t-o.x;if(a*o.direction<0)continue;const c=Math.abs(a);if(c<=450*r.ratio){i++;const t=100*r.ratio,a=c<=t?150:Math.round(150*Math.exp(-(c-t)/100));a>=100&&s(.4)&&(e=o.x,n=o.K.y+o.K.height+o.R),h+=a}}let o=1;2===i?o=1.25:i>=3&&(o=2);const a=Math.round(h*o);return a>0&&d.o({text:a.toString(),x:t,y:this.y},2e3),b.G(a),[e,n]}L(t){for(const t of this.m)t.L();this.A?.L(t);for(const s of this.Z)s.L(t)}destroy(){for(const t of this.Z)t.j()}}class M{constructor(){this.ct=null,this.rt=1,this.lt=new m,this.rows=[];const t=r.c.height/8;for(let s=0;s<8;s++){const i=new L(t,t*s);s>0&&this.lt.W(i),s>3&&i.ht(),this.rows.push(i)}this.ct=this.rows[0],o.y=r.c.height}ut(t){const s=this.rows[this.rt];if(s.st(t.x))return;if(this.ct=s,t.y=s.y,this.rt<4)return void this.rt++;const i=this.rows[this.rt-1];if(null!=i){const[s,h]=i.ot(t.x);-1!==s&&this.ft(s,h)}const h=this.rows.shift(),e=this.rows[this.rows.length-1],n=e.y+e.height,a=new L(e.height,n);o.y=n+s.height,this.rows.push(a),this.lt.W(a),a.ht(),h.destroy()}update(t){for(const s of this.rows)s.L(t)}ft(t,s){this.rows[this.rt].nt(t,s)}}class A{static init(){this.c=e("lives")}static dt(t){this.c.replaceChildren();let s="happy";t<=3?s="angry":t<=6&&(s="pockerface");for(let i=0;i<9;i++){i+1>t&&(s="empty");const h=f.v.get(s)?.cloneNode();h.classList.add("life"),this.c.appendChild(h)}}}class K{static init(){this.c=e("mobile")}static wt(t,s){this.yt=t,this.gt=s,this.c.addEventListener("touchstart",t),this.c.addEventListener("touchend",s)}static bt(){this.c.removeEventListener("touchstart",this.yt),this.c.removeEventListener("touchend",this.gt),this.gt=null,this.yt=null}}class H extends w{constructor(t,s){super(),this.kt=new Set,this.s=250*r.ratio,this.xt=0,this.Mt=9,this.a=1,this.vt=t,this.At=s,this.H=p.T,this.R=p.T,null!=t.ct&&(this.x=t.ct.width/2-this.H/2,this.y=t.ct.y),K.wt(this.It.bind(this),this.Tt.bind(this)),this.Dt=this.Ot.bind(this),this.Ct=this.Rt.bind(this),document.body.addEventListener("keydown",this.Dt),document.body.addEventListener("keyup",this.Ct),A.dt(this.Mt),this.L()}L(){const t=f.k.get("back-cat"),s=f.k.get("side-cat"),i=o.t(this.y,this.R);r.h.save(),r.h.globalAlpha=this.a,this.kt.has("left")?(r.h.scale(-1,1),r.h.drawImage(s,0,0,16,16,-this.x-this.H,i,this.H,this.R)):this.kt.has("right")?r.h.drawImage(s,0,0,16,16,this.x,i,this.R,this.R):r.h.drawImage(t,0,0,16,16,this.x,i,this.H,this.R),r.h.restore()}update(t){let s=0;this.kt.has("left")?s-=1:this.kt.has("right")&&(s+=1);const i=this.x+s*this.s*t;this.vt.ct?.tt(i)&&(this.vt.ct.et(),this.Mt++,A.dt(this.Mt));const h=this.vt.ct?.st(i);i>=0&&i<=r.c.offsetWidth-this.H&&!h&&(this.x=i),!this.xt&&this.vt.ct?.it(this.x)&&(this.Mt--,0===this.Mt&&(this.At.stop(),S.show()),A.dt(this.Mt),this.xt=1,this.Ht(),setTimeout(()=>{this.a=1,this.xt=0,clearInterval(this.Kt)},1e3)),this.L()}destroy(){document.body.removeEventListener("keydown",this.Dt),document.body.removeEventListener("keyup",this.Ct),K.bt()}Ht(){let t=-.5;this.Kt=setInterval(()=>{this.a+=t,t*=-1},100)}Lt(){this.vt.ut(this)}Tt(t){t.preventDefault(),t.target instanceof HTMLElement&&("left"!==t.target.id&&"right"!==t.target.id||this.kt.delete(t.target.id))}It(t){t.preventDefault(),t.target instanceof HTMLElement&&("left"===t.target.id?this.kt.add("left"):"right"===t.target.id?this.kt.add("right"):this.Lt())}Ot(t){switch(t.code){case"KeyW":case"ArrowUp":this.Lt();break;case"KeyA":case"ArrowLeft":this.kt.add("left");break;case"KeyD":case"ArrowRight":this.kt.add("right")}}Rt(t){switch(t.code){case"KeyA":case"ArrowLeft":this.kt.delete("left");break;case"KeyD":case"ArrowRight":this.kt.delete("right")}}}class S{static init(t){this.c=e("death-screen"),this.c.querySelector("button")?.addEventListener("click",()=>{b.G(0,1);const s=new M,i=new H(s,t);this.hide(),t.p(),t.start(i,s)})}static show(){this.c.style.display="flex",e("final-score").textContent=b.B().toString()}static hide(){this.c.style.display="none"}}class R{constructor(){this.Pt=[{St:"You play as a black cat crossing a Halloween street.",Ft:"50%",top:"50%",c:1},{St:"Move with WASD/Arrows (PC). On mobile, tap left/right or any place on the screen to go up. (Disabled in tutorial)",Ft:"50%",top:"50%",c:1},{St:"Your goal is to earn points by crossing peoples' roads. The closer you are while crossing, the more points!",Ft:"10px",top:"20%"},{St:"Cross close to humans to have a chance of them dropping fish crackers. +1 happiness each!",Ft:"10px",top:"30%"},{St:"Obstacles block path — find another way.",Ft:"10px",top:"40%"},{St:"Your cat starts with 9 happiness. Each time it bumps into a human, it loses 1. At 0, your cat gets annoyed and quits.",Ft:"10px",top:"10%"},{St:"After a bump, you’re briefly invincible — use it!",Ft:"10px",top:"10%"},{St:"That’s it. Good luck! ;)",Ft:"50%",top:"40%",c:1}],this.Wt=0}init(t,s,i){return this.c=e("t"),this.Yt=e("t-window"),this.$t=e("t-text"),this.Yt.querySelector("button")?.addEventListener("click",()=>{if(this.Wt++,this.Wt===this.Pt.length)return this.c.style.display="",void(this.Wt=0);this.Et(this.Wt)}),{start:()=>{this.c.style.display="block",i.start(s,t),this.Et(this.Wt)}}}Et(t){const s=this.Pt[t];this.Yt.style.left=s.Ft,this.Yt.style.top=s.top,this.$t.textContent=s.St,s.c?this.Yt.style.transform="translateX(-50%)":this.Yt.style.transform=""}}class E{static init(t){this.c=e("start-menu");const s=new M,i=new H(s,t);i.L(),s.update(0);const h=(new R).init(s,i,t);e("s").addEventListener("click",()=>{this.hide(),t.p(),t.start(i,s)}),e("t-b").addEventListener("click",()=>{h.start(),this.hide()})}static show(){this.c.style.display="flex"}static hide(){this.c.style.display="none"}}window.addEventListener("DOMContentLoaded",async()=>{const t=new l;S.init(t);const s=e("l");b.init(),A.init(),K.init(),await f.init(),s.remove();const i=e("game");i.width=document.body.offsetWidth,i.height=document.body.offsetHeight;const h=i.getContext("2d");h.imageSmoothingEnabled=0,h.font="32px sans-serif",r.c=i,r.h=h;let n=1;i.width<720&&(n=i.width/720),r.ratio=n,p.I(n),E.init(t)})</script>