<!doctype html><meta name=viewport content="width=device-width,maximum-scale=1,user-scalable=no"><title>RLL - js13kGames 2025</title><audio id=attack_sound src=attack.mp3></audio><audio id=magic_sound src=magic_attack.mp3></audio><audio id=eme_die_sound src=enemy_die.mp3></audio><audio id=player_die_sound src=player_die.mp3></audio><body><style>body{touch-action:manipulation;overflow:hidden;background-color:#fff}</style><canvas id=main style=height:100%;width:100%></canvas><script>const t=document.getElementById("attack_sound"),e=document.getElementById("magic_sound"),i=document.getElementById("eme_die_sound"),s=document.getElementById("player_die_sound");var h=!1,l=document.getElementById("main"),o=l.getContext("2d"),n=window.innerHeight,r=window.innerWidth,c=n/2,d=0,g=!0,f=[],p=[],u=new Image;u.src="./claw.svg";var v=.02,w={oriplace:[-1,-1],id:-1},x={oriplace:[-1,-1],id:-1};l.height=n-10,n-=10,l.width=r,console.log(l.height);const y={w:!1,a:!1,s:!1,d:!1,o:!1,p:!1};var m=(t="#fff")=>{o.fillStyle=t,o.fillRect(0,0,r,n),o.fillStyle="#000"},_=async t=>{await new Promise(e=>setTimeout(e,1e3*t))},k=t=>n-c-t-60,T=(t,e)=>Math.floor(Math.random()*(e-t)+t);async function E(t){f.forEach(function(t,e){o.fillText("<>",t[0],t[1]),f[e][0]+=f[e][3],f[e][2]-=1,f[e][2]<=0&&f.splice(e,1)}),p.forEach(function(e,i){e.update(),e.draw(),Math.abs(e.x-t.x)<10&&e.y-t.y>=0&&e.running&&(t.hp.value-=1)}),a.hp.value<=0&&await M()}o.fillStyle="black",o.strokeStyle="black",o.font="32px Arial",o.fillText("RLL - RogueLikeLike",r/2,n/2),o.fillText("Press R or Press Screen to start",r/2,n/2+30),window.addEventListener("touchstart",t=>{var e=t.changedTouches;for(let t=0;t<e.length;t++)e[t].pageX<r/2?w={oriplace:[e[t].pageX,e[t].pageY],id:e[t].identifier}:(y.o=!0,x.id=e[t].identifier,x.oriplace=[e[t].pageX,e[t].pageY])}),window.addEventListener("touchmove",t=>{const e=t.changedTouches;for(let t=0;t<e.length;t++)e[t].identifier==w.id&&(console.log("Move ctl moved!"),e[t].pageX<w.oriplace[0]-20?(y.d=!1,y.a=!0):e[t].pageX>w.oriplace[0]+20&&(y.d=!0,y.a=!1),e[t].pageY<w.oriplace[1]-25&&(y.w=!0))}),window.addEventListener("touchend",t=>{if(console.log("touch end"),h){const e=t.changedTouches;for(let t=0;t<e.length;t++)e[t].identifier==w.id?(w={},y.a=y.d=y.w=!1):e[t].identifier==x.id&&(e[t].pageY<x.oriplace[1]-25&&(y.p=!0,console.log("P")),y.o=!1)}else g&&(h=!0,g=!1,I())}),window.addEventListener("keydown",t=>{var e=t.key.toLowerCase();e in y&&(y[e]=!0),"r"==e&&!h&&g&&(console.log("Start Main!"),h=!0,g=!1,I())}),window.addEventListener("keyup",t=>{var e=t.key.toLowerCase();e in y&&(y[e]=!1)});class L{constructor(t,e,i,a,s,h){this.dmg=e,this.x=t,this.y=h,this.hp=T(10,20),this.target=i,this.father=a,this.index=s,this.running=!0,this.spd=T(1,5)}draw(){var t=k(this.y);o.beginPath(),o.arc(this.x,t-T(8,12),10,0,2*Math.PI),o.fillRect(this.x-8,t-10,16,70),o.fill()}async update(){this.running&&(this.hp<=0&&await this.die(),this.target.x>this.x?this.x+=this.spd:this.x-=this.spd);var t=this.x,e=this.y,i=this.hp,a=[];f.forEach(function(s,h){Math.abs(s[0]-t)<10&&Math.abs(k(e)-s[1])<50&&(i-=5,a.push(h))});var s=f;a.forEach(function(t,e){s=s.slice(e,1)}),f=s,this.hp=i}async die(){i.play(),this.running=!1;for(var t=this.index+1;t<this.father.length;t++)this.father[t].index-=1;for(this.father.splice(this.index,1),console.log(this.father),d++,this.target.mp.value<100&&(this.target.mp.value+=T(10,20)),this.target.mp.value>=100&&(this.target.mp.value=100,this.target.hp.value<100&&(this.target.hp.value+=5)),t=0;t<10;t++)this.y-=1,this.draw(),await _(.02)}}class S{constructor(t){this.dmg=t,this.x_velo=0,this.y_velo=0,this.x=r/2,this.y=0,this.acc=1,this.jump=15,this.face_right=!0,this.can_attack=!0,this.hp=new b(100,100,0),this.mp=new b(100,0,1)}draw(){var t=k(this.y);o.beginPath(),o.arc(this.x,t,10,0,2*Math.PI),o.fill(),o.fillRect(this.x-5,t,10,70),o.moveTo(this.x,t-10),this.face_right?(o.lineTo(this.x-10,t-20),o.lineTo(this.x-10,t)):(o.lineTo(this.x+10,t-20),o.lineTo(this.x+10,t)),o.fill(),this.hp.draw(),this.mp.draw()}update(){this.y<=50&&(y.a?(this.x_velo-=this.acc,this.face_right=!1):y.d?(this.x_velo+=this.acc,this.face_right=!0):this.x_velo*=.9),this.x>=r&&this.x_velo>0?this.x_velo=-5:this.x<=0&&this.x_velo<0&&(this.x_velo=5),y.w&&this.y<=0?this.y_velo+=this.jump:this.y>0?this.y_velo-=1:this.y_velo=0,y.o&&this.can_attack&&(f.push([this.x,k(this.y-30),10,2*(this.face_right-.5)*(Math.abs(this.x_velo)+20),!1]),this.can_attack=!1,t.play(),console.log("Attack!")),y.o||(this.can_attack=!0),this.y+=this.y_velo,this.x+=this.x_velo,y.p&&this.mp.value>=100&&this.big_hit()}big_hit(){e.play(),m("#000"),o.drawImage(u,(r-u.width)/2,(n-u.height)/2),d+=p.length,p=[],y.p=!1,this.mp.value=0,v=.2}}class b{constructor(t,e,i){this.full=t,this.value=e,this.col=i}draw(){o.fillRect(10,25*this.col,r/4*(this.value/this.full),20),o.strokeRect(10,25*this.col,r/4,20)}}var M=async(t="Game Over")=>{s.play(),h=!1,g=!1,await _(1),g=!0,m("#000"),o.fillStyle="#fff",o.fillText(t,r/2,n/2),o.fillText("Score:"+String(d),r/2,n/2+30),o.fillText("Press or R to replay",r/2,n/2+60)},R=(t=c)=>{o.fillRect(0,n-t,r,n)};async function I(){d=0,hurt=[],p=[],a=new S(25),a.draw();for(var t=0;h;)(t+=1)>=50/((d+1)/5)**.1&&(console.log("generate time delay:",50/((d+1)/5)**.1),p.push(new L(T(0,2)*r,10,a,p,p.length,60*!Boolean(T(0,5)))),t=0),R(),a.update(),a.draw(),E(a),o.fillText("Score:"+String(d),r/2,40),await _(v),.02!=v&&(v=.02),m()}</script>