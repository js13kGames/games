<!doctype html><title>Skull Ocean</title><meta name=viewport content="width=device-width"><meta property=og:image content=https://platane.github.io/skull-ocean/images/800x800.jpg><meta name=description content="A grim wave simulation. It was made for the 2022 js13kGames.com competition."><meta name=viewport content="width=device-width"><style>html{font-family:monospace,sans-serif;background-color:#ede5d2;color:#42372b}canvas{position:fixed;top:0;left:0;width:100%;height:100%;background-image:linear-gradient(#ede5d2,#d7c69f);touch-action:none}footer{position:fixed;bottom:0;right:0;padding:0 4px;font-size:16px}div{position:fixed;top:10px;left:10px}h1{margin-top:0}</style><canvas></canvas><div><h1>Skull Ocean</h1><span>Tap to create waves<br>Slide to rotate</span></div><footer><a href=https://github.com/platane/skull-ocean>source</a></footer><script>let t=document.getElementsByTagName("canvas")[0],a=t.getContext("webgl2"),r=Math.min(window.devicePixelRatio??1,2),n=()=>{const e=window.innerWidth*r,n=window.innerHeight*r;t.width=e,t.height=n,a.viewport(0,0,e,n)};n(),window.addEventListener("resize",n);var o,e="undefined"!=typeof Float32Array?Float32Array:Array;function l(){var a=new e(9);return e!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[5]=0,a[6]=0,a[7]=0),a[0]=1,a[4]=1,a[8]=1,a}function i(a,t){a[0]=t[0],a[1]=t[1],a[2]=t[2],a[3]=t[4],a[4]=t[5],a[5]=t[6],a[6]=t[8],a[7]=t[9],a[8]=t[10]}function h(a,t){var r=t[0],e=t[1],n=t[2],o=t[3],i=t[4],l=t[5],f=t[6],h=t[7],A=t[8],u=t[9],c=t[10],s=t[11],R=t[12],v=t[13],m=t[14],F=r*l-e*i,M=r*f-n*i,d=r*h-o*i,g=e*f-n*l,b=e*h-o*l,_=n*h-o*f,p=A*v-u*R,B=A*m-c*R,w=u*m-c*v;(s=F*(c=c*(t=t[15])-s*m)-M*(u=u*t-s*v)+d*w+g*(A=A*t-s*R)-b*B+_*p)&&(a[0]=(l*c-f*u+h*w)*(s=1/s),a[1]=(f*A-i*c-h*B)*s,a[2]=(i*u-l*A+h*p)*s,a[3]=(n*u-e*c-o*w)*s,a[4]=(r*c-n*A+o*B)*s,a[5]=(e*A-r*u-o*p)*s,a[6]=(v*_-m*b+t*g)*s,a[7]=(m*d-R*_-t*M)*s,a[8]=(R*b-v*d+t*F)*s)}function M(){var a=new e(16);return e!=Float32Array&&(a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=0,a[12]=0,a[13]=0,a[14]=0),a[0]=1,a[5]=1,a[10]=1,a[15]=1,a}function v(a){a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1}function c(a,t,r){var e=t[0],n=t[1],o=t[2],i=t[3],l=t[4],f=t[5],h=t[6],A=t[7],u=t[8],c=t[9],s=t[10],R=t[11],v=t[12],m=t[13],F=t[14];t=t[15];var M=r[0],d=r[1],g=r[2],b=r[3];a[0]=M*e+d*l+g*u+b*v,a[1]=M*n+d*f+g*c+b*m,a[2]=M*o+d*h+g*s+b*F,a[3]=M*i+d*A+g*R+b*t,a[4]=(M=r[4])*e+(d=r[5])*l+(g=r[6])*u+(b=r[7])*v,a[5]=M*n+d*f+g*c+b*m,a[6]=M*o+d*h+g*s+b*F,a[7]=M*i+d*A+g*R+b*t,a[8]=(M=r[8])*e+(d=r[9])*l+(g=r[10])*u+(b=r[11])*v,a[9]=M*n+d*f+g*c+b*m,a[10]=M*o+d*h+g*s+b*F,a[11]=M*i+d*A+g*R+b*t,a[12]=(M=r[12])*e+(d=r[13])*l+(g=r[14])*u+(b=r[15])*v,a[13]=M*n+d*f+g*c+b*m,a[14]=M*o+d*h+g*s+b*F,a[15]=M*i+d*A+g*R+b*t}function u(a,t,r){var e=t[0],n=t[1],o=t[2],i=t[3],l=e+e,f=n+n,h=o+o;t=e*l;var A=e*f;e*=h;var u=n*f;n*=h,l*=i,f*=i,i*=h,a[0]=1-(u+(o*=h)),a[1]=A+i,a[2]=e-f,a[3]=0,a[4]=A-i,a[5]=1-(t+o),a[6]=n+l,a[7]=0,a[8]=e+f,a[9]=n-l,a[10]=1-(t+u),a[11]=0,a[12]=r[0],a[13]=r[1],a[14]=r[2],a[15]=1}function s(){var a=L,t=1/Math.tan(S/2);a[0]=t/z,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=t,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[11]=-1,a[12]=0,a[13]=0,a[15]=0,a[10]=2000.005*(t=1/-1999.995),a[14]=20*t}function f(){var a=new e(3);return e!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a}function w(a,t){var r=new e(3);return r[0]=a,r[1]=t,r[2]=0,r}function m(a,t,r,e){return a[0]=t,a[1]=r,a[2]=e,a}function y(a,t,r){a[0]=t[0]-r[0],a[1]=t[1]-r[1],a[2]=t[2]-r[2]}function p(a,t,r,e){a[0]=t[0]+r[0]*e,a[1]=t[1]+r[1]*e,a[2]=t[2]+r[2]*e}function g(a,t){var r=t[0],e=t[1],n=t[2];0<(r=r*r+e*e+n*n)&&(r=1/Math.sqrt(r)),a[0]=t[0]*r,a[1]=t[1]*r,a[2]=t[2]*r}function A(a,t){return a[0]*t[0]+a[1]*t[1]+a[2]*t[2]}function _(a,t,r){var e=t[0],n=t[1],o=r[0],i=r[1];a[0]=n*(r=r[2])-(t=t[2])*i,a[1]=t*o-e*r,a[2]=e*i-n*o}function d(a,t,r){var e=t[0],n=t[1],o=r[3]*e+r[7]*n+r[11]*(t=t[2])+r[15];a[0]=(r[0]*e+r[4]*n+r[8]*t+r[12])/(o=o||1),a[1]=(r[1]*e+r[5]*n+r[9]*t+r[13])/o,a[2]=(r[2]*e+r[6]*n+r[10]*t+r[14])/o}function F(){var a=new e(4);return e!=Float32Array&&(a[0]=0,a[1]=0,a[2]=0),a[3]=1,a}function x(a){return a[0]=0,a[1]=0,a[2]=0,a[3]=1,a}function X(a,t,r){r*=.5;var e=t[0],n=t[1],o=t[2];t=t[3];var i=Math.sin(r);r=Math.cos(r),a[0]=e*r+t*i,a[1]=n*r+o*i,a[2]=o*r-n*i,a[3]=t*r-e*i}function Y(a,t,r){r*=.5;var e=t[0],n=t[1],o=t[2];t=t[3];var i=Math.sin(r);r=Math.cos(r),a[0]=e*r-o*i,a[1]=n*r+t*i,a[2]=o*r+e*i,a[3]=t*r-n*i}function C(a,t,r,e){var n=t[0],o=t[1],i=t[2],l=r[0],f=r[1],h=r[2],A=n*l+o*f+i*h+(t=t[3])*(r=r[3]);if(0>A&&(A=-A,l=-l,f=-f,h=-h,r=-r),1e-6<1-A){var u=Math.acos(A),c=Math.sin(u);A=Math.sin((1-e)*u)/c,e=Math.sin(e*u)/c}else A=1-e;a[0]=A*n+e*l,a[1]=A*o+e*f,a[2]=A*i+e*h,a[3]=A*t+e*r}function D(a){var t=360*Math.random(),r=360*Math.random(),e=360*Math.random(),n=.5*Math.PI/180;t*=n,r*=n,e*=n,n=Math.sin(t),t=Math.cos(t);var o=Math.sin(r);r=Math.cos(r);var i=Math.sin(e);e=Math.cos(e),a[0]=n*r*e-t*o*i,a[1]=t*o*e+n*r*i,a[2]=t*r*i-n*o*e,a[3]=t*r*e+n*o*i}Math.hypot||(Math.hypot=function(){for(var a=0,t=arguments.length;t--;)a+=arguments[t]*arguments[t];return Math.sqrt(a)}),f(),o=new e(4),e!=Float32Array&&(o[0]=0,o[1]=0,o[2]=0,o[3]=0);var P=(()=>{var a=f(),t=w(1,0),r=w(0,1);return(e,n,o)=>{var i=A(n,o);return-.999999>i?(_(a,t,n),1e-6>Math.hypot(a[0],a[1],a[2])&&_(a,r,n),g(a,a),n=Math.PI,n*=.5,o=Math.sin(n),e[0]=o*a[0],e[1]=o*a[1],e[2]=o*a[2],e[3]=Math.cos(n),e):.999999<i?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):(_(a,n,o),e[0]=a[0],e[1]=a[1],e[2]=a[2],e[3]=1+i,((a,t)=>{var r=t[0],e=t[1],n=t[2],o=r*r+e*e+n*n+(t=t[3])*t;return 0<o&&(o=1/Math.sqrt(o)),a[0]=r*o,a[1]=e*o,a[2]=n*o,a[3]=t*o,a})(e,e))}})();function b(){var a=new e(2);return e!=Float32Array&&(a[0]=0,a[1]=0),a}F(),F(),l(),b();let j=new Float32Array(36),I=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,I),a.bufferData(a.ARRAY_BUFFER,j,a.DYNAMIC_DRAW);let L=new Float32Array(16),S=Math.PI/3,z=window.innerWidth/window.innerHeight;s();let k=1.2,q=1,U=5,B=[0,0,0],E=[0,0,1],G=[0,1,0],H=M(),J=l(),K=M(),N=l(),O=()=>{var t=12+U*U*.18,r=Math.sin(k)*t;E[0]=r*Math.sin(q),E[1]=Math.cos(k)*t,E[2]=r*Math.cos(q),t=E[0],r=E[1];var e=E[2],n=G[0],o=G[1],l=G[2],f=B[0],A=B[1],u=B[2];if(1e-6>Math.abs(t-f)&&1e-6>Math.abs(r-A)&&1e-6>Math.abs(e-u))v(H);else{f=t-f,A=r-A;var s=e-u,R=1/Math.hypot(f,A,s);u=o*(s*=R)-l*(A*=R),l=l*(f*=R)-n*s,n=n*A-o*f,(R=Math.hypot(u,l,n))?(u*=R=1/R,l*=R,n*=R):n=l=u=0,o=A*n-s*l;var m=s*u-f*n,F=f*l-A*u;(R=Math.hypot(o,m,F))?(o*=R=1/R,m*=R,F*=R):F=m=o=0,H[0]=u,H[1]=o,H[2]=f,H[3]=0,H[4]=l,H[5]=m,H[6]=A,H[7]=0,H[8]=n,H[9]=F,H[10]=s,H[11]=0,H[12]=-(u*t+l*r+n*e),H[13]=-(o*t+m*r+F*e),H[14]=-(f*t+A*r+s*e),H[15]=1}for(c(K,L,H),i(J,H),h(N,H),r=Math.hypot(E[0],E[2]),t=9999,.81<E[1]&&(t=(17*1.4+r)/((E[1]-.8)/(E[1]- -4))-r),r=0;4>r;r++)e=2*Math.PI*r/4+Math.PI/4,f=2*Math.PI*(r+1)/4+Math.PI/4,j[9*r]=0,j[9*r+1]=-4,j[9*r+2]=0,j[9*r+3]=Math.sin(e)*t,j[9*r+4]=-4,j[9*r+5]=Math.cos(e)*t,j[9*r+6]=Math.sin(f)*t,j[9*r+7]=-4,j[9*r+8]=Math.cos(f)*t;a.bindBuffer(a.ARRAY_BUFFER,I),a.bufferSubData(a.ARRAY_BUFFER,0,j)};O();let Q=0,R=null,T=null,V=null,W=a=>{1===a.length?(R=null,(([{pageX:a,pageY:t}])=>{T=a,V=t})(a)):1<a.length&&(T=null,(([{pageX:a,pageY:t},{pageX:r,pageY:e}])=>{Q=U,R=Math.sqrt((a-r)**2+(t-e)**2)})(a))};t.addEventListener("wheel",(a=>{U=Math.min(Math.max(U+(0>a.deltaY?-1:1),0),10),O()}),{passive:1}),window.addEventListener("resize",(()=>{z=window.innerWidth/window.innerHeight,s(),O()}),{passive:1});let Z=[],$=(a,t,r,e)=>{var n=K[0],o=K[1],i=K[2],l=K[3],f=K[4],h=K[5],A=K[6],u=K[7],c=K[8],s=K[9],R=K[10],v=K[11],m=K[12],F=K[13],M=K[14],b=K[15],_=n*h-o*f,p=n*A-i*f,B=n*u-l*f,w=o*A-i*h,Y=o*u-l*h,x=i*u-l*A,D=c*F-s*m,U=c*M-R*m,H=c*b-v*m,J=s*M-R*F,L=s*b-v*F,T=R*b-v*M,C=_*T-p*L+B*J+w*H-Y*U+x*D;C&&(Z[0]=(h*T-A*L+u*J)*(C=1/C),Z[1]=(i*L-o*T-l*J)*C,Z[2]=(F*x-M*Y+b*w)*C,Z[3]=(R*Y-s*x-v*w)*C,Z[4]=(A*H-f*T-u*U)*C,Z[5]=(n*T-i*H+l*U)*C,Z[6]=(M*B-m*x-b*p)*C,Z[7]=(c*x-R*B+v*p)*C,Z[8]=(f*L-h*H+u*D)*C,Z[9]=(o*H-n*L-l*D)*C,Z[10]=(m*Y-F*B+b*_)*C,Z[11]=(s*B-c*Y-v*_)*C,Z[12]=(h*U-f*J-A*D)*C,Z[13]=(n*J-o*U+i*D)*C,Z[14]=(F*p-m*w-M*_)*C,Z[15]=(c*w-s*p+R*_)*C),d(t,[r,e,.5],Z),y(t,t,E),g(t,t),a[0]=E[0],a[1]=E[1],a[2]=E[2]},tt=f(),at=f(),rt=(a,t)=>{var r=lt;a[0]=r[3*t],a[1]=r[3*t+1],a[2]=r[3*t+2]},nt=(a,t,r)=>{a[0]=t[4*r],a[1]=t[4*r+1],a[2]=t[4*r+2],a[3]=t[4*r+3]},ot=(a,t)=>{var r=va;a[3*t]=r[0],a[3*t+1]=r[1],a[3*t+2]=r[2]},et=(a,t,r)=>{a[4*t]=r[0],a[4*t+1]=r[1],a[4*t+2]=r[2],a[4*t+3]=r[3]},lt=new Float32Array(7500),it=new Float32Array(1e4),ht=f(),Mt=f(),vt=f(),ct=0,ut=0,st=0,ft=f(),wt=f(),mt=f(),yt=F();x(yt),mt[1]=2;let pt=f();pt[2]=1;let gt=[],At=b(),_t=f(),dt=17*1.6,Ft=Array.from({length:2}).map(((a,t,{length:r})=>{a=t/r,(t=b())[1]=1;var e=(Math.random()-.5)*Math.PI*.1;r=t[0]-At[0];var n=t[1]-At[1],o=Math.sin(e);return e=Math.cos(e),t[0]=r*e-n*o+At[0],t[1]=r*o+n*e+At[1],r=f(),n=Math.random(),{n:t,t:25.5,o:a*dt*2-dt,l:3,i:0,h:4,force:m(r,0,-(.5*(1-n)+.6*n),0)}}));gt.push(...Ft);let xt={n:b(),t:0,o:1,i:1,l:1,h:0,force:m(f(),0,0,0),s:0,M:1/0};gt.push(xt);let Xt,Yt=f(),Ct=f(),Dt=b(),Pt=0,bt=null,jt=a=>{a[0]&&(bt={pageX:a[0].pageX,pageY:a[0].pageY,timeStamp:Date.now()}),W(a)},It=a=>{if(bt&&40<Math.hypot(a[0].pageX-bt.pageX,a[0].pageY-bt.pageY)&&(bt=null),null!==R){const[{pageX:t,pageY:r},{pageX:e,pageY:n}]=a;U=Math.min(Math.max(Q/Math.sqrt((t-e)**2+(r-n)**2)*R,0),10),O()}(([{pageX:a,pageY:t}])=>{null!==T&&(q-=(a-T)/window.innerHeight*4,k-=(t-V)/window.innerHeight*4,k=Math.min(Math.max(k,.14*Math.PI),.45*Math.PI),document.getElementsByTagName("div")[0].style.opacity=""+Math.min(Math.max(4*k-3.4,0),1),T=a,V=t,O())})(a);const{pageX:t,pageY:r}=a[0];$(Mt,vt,t/window.innerWidth*2-1,-(r/window.innerHeight*2-1)),p(ht,Mt,vt,(0-Mt[1])/vt[1]),Xt=a;let e=0,n=0;for(const{pageX:t,pageY:r}of a)e+=t,n+=r;e/=a.length,n/=a.length,$(tt,at,e/window.innerWidth*2-1,-(n/window.innerHeight*2-1)),p(_t,tt,at,(1-tt[1])/at[1])},Lt=a=>{T=R=null,W(a),bt&&Date.now()<bt.timeStamp+300&&(0<ut?st=1:(st=0,ct=1,ut=.2,console.log("acc")),(()=>{if(!(Pt+3>Date.now()/1e3)){Pt=Date.now()/1e3;var[{pageX:a,pageY:t}]=Xt;$(Yt,Ct,a/window.innerWidth*2-1,-(t/window.innerHeight*2-1)),p(_t,Yt,Ct,(1-Yt[1])/Ct[1]);var r=b();r[0]=-Ct[0],r[1]=-Ct[2],((a,t)=>{var r=t[0],e=t[1];0<(r=r*r+e*e)&&(r=1/Math.sqrt(r)),a[0]=t[0]*r,a[1]=t[1]*r})(r,r),Dt[0]=_t[0],Dt[1]=_t[2];var e=Math.max(...[(17-Dt[0])/r[0],(17-Dt[1])/r[1],(-17-Dt[1])/r[1],(-17-Dt[0])/r[0]].filter((a=>0>a)));((a,t)=>{var r=Dt,e=Dt;r[0]=e[0]+a[0]*t,r[1]=e[1]+a[1]*t})(r,e),e=4+6*Math.random();var n=1.3+.5*Math.random(),o={n:r,t:.5,v:e,u:n,h:5,o:r[0]*Dt[0]+r[1]*Dt[1],i:-r[1]*Dt[0]+r[0]*Dt[1],l:1,force:f(),s:0,M:1/0};o.force[1]=.2*Math.random()-1.2,gt.push(o),(e={n:r,t:1.5,v:e+2,u:n,h:5,o:r[0]*Dt[0]+r[1]*Dt[1]-3.5,i:-r[1]*Dt[0]+r[0]*Dt[1],l:1,force:f(),s:0,M:1/0}).force[0]=.2*r[0],e.force[1]=.8,e.force[2]=.2*r[1],gt.push(e)}})())};t.addEventListener("mousedown",(a=>jt([a]))),t.addEventListener("mousemove",(a=>It([a]))),t.addEventListener("mouseup",(()=>Lt([]))),t.addEventListener("touchstart",(a=>jt(Array.from(a.touches))),{passive:1}),t.addEventListener("touchmove",(a=>It(Array.from(a.touches))),{passive:1}),t.addEventListener("touchend",(a=>Lt(Array.from(a.touches))),{passive:1});let St=(a,t,r)=>(0>r&&(r+=1),1<r&&--r,r<1/6?a+6*(t-a)*r:.5>r?t:r<2/3?a+(t-a)*(2/3-r)*6:a),zt=a.createBuffer(),kt=a.createBuffer(),qt=a.createBuffer(),Ut=new Float32Array(1e4);Ut.fill(1);let Bt=new Float32Array(4e4),Et=Array.from({length:2500},((a,t)=>new Float32Array(Bt.buffer,64*t,16))),Gt=new Float32Array(4e4),Ht=Array.from({length:2500},((a,t)=>(v(a=new Float32Array(Gt.buffer,64*t,16)),a))),Jt=l();a.bindBuffer(a.ARRAY_BUFFER,zt),a.bufferData(a.ARRAY_BUFFER,Bt,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,kt),a.bufferData(a.ARRAY_BUFFER,Gt,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,qt),a.bufferData(a.ARRAY_BUFFER,Ut,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null);let Kt=f(),Nt=F(),Ot=[0,0,0],Qt=[0,0,0],Rt=[0,0,0],Tt=[0,0,0],Vt=[0,0,0],Wt=[0,0,0],Zt=[0,0,0],$t=a=>{const t=new Float32Array(a.length);for(let r=0;r<a.length/3;r+=3){const e=3*(r+0),n=3*(r+1),o=3*(r+2);m(Tt,a[e+0],a[e+1],a[e+2]),m(Vt,a[n+0],a[n+1],a[n+2]),m(Wt,a[o+0],a[o+1],a[o+2]),y(Qt,Tt,Vt),y(Rt,Tt,Wt),_(Zt,Qt,Rt),g(Zt,Zt),t[e+0]=t[n+0]=t[o+0]=Zt[0],t[e+1]=t[n+1]=t[o+1]=Zt[1],t[e+2]=t[n+2]=t[o+2]=Zt[2]}return t},ta=a.createBuffer(),aa=a.createBuffer(),ra=a.createBuffer(),na=[[0,0,1.5],[.6,0,.5],[-.6,0,.5],[-.6,0,.5],[.6,0,.5],[.4,0,-1.5],[-.6,0,.5],[.4,0,-1.5],[-.4,0,-1.5]],oa=$t(na.flat()),ea=Array.from({length:na.length},((a,t)=>[oa[3*t],oa[3*t+1],oa[3*t+2]])),la=new Float32Array(Array.from({length:100},(()=>[.2,.78,.85])).flat()),ia=M(),ha=M(),Ma=l(),va=f(),ca=new Float32Array(3*na.length),ua=new Float32Array(3*na.length);a.bindBuffer(a.ARRAY_BUFFER,ta),a.bufferData(a.ARRAY_BUFFER,ca,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,aa),a.bufferData(a.ARRAY_BUFFER,ca,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,ra),a.bufferData(a.ARRAY_BUFFER,la,a.STATIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,null);let sa,fa=(t,r)=>{t=wa(t,a.VERTEX_SHADER),r=wa(r,a.FRAGMENT_SHADER);const e=a.createProgram();return a.attachShader(e,t),a.attachShader(e,r),a.linkProgram(e),e},wa=(t,r)=>(r=a.createShader(r),a.shaderSource(r,t),a.compileShader(r),r),ma=t=>{for(let r=0;4>r;++r){const e=t+r;a.enableVertexAttribArray(e),a.vertexAttribPointer(e,4,a.FLOAT,0,64,16*r),a.vertexAttribDivisor(e,1)}},ya=async()=>{const a=await fetch("skull-vertices.bin").then((a=>a.arrayBuffer())),t=new Uint16Array(a);return new Float32Array(Array.from({length:t.length},((a,r)=>.95*(t[r]/65536-.5))))},pa=fa("#version 300 es\nin vec4 a_position;in vec4 a_normal;in vec4 a_color;in mat4 a_matrix;in mat4 a_normalMatrix;uniform mat4 u_matrix;out vec3 v_color;out vec3 v_normal;void main(){gl_Position=u_matrix*a_matrix*a_position;v_normal=vec3(a_normalMatrix*a_normal);v_color=a_color.rgb;}","#version 300 es\nprecision highp float;in vec3 v_color;in vec3 v_normal;out vec4 outColor;void main(){vec3 staticLightDirection=vec3(0.615457,0.492365,0.615457);float staticLightPower=dot(v_normal,staticLightDirection);outColor=vec4(v_color,1.0);outColor.rgb*=0.6+clamp(staticLightPower,-0.47,10.0)*0.45;}"),ga=a.getUniformLocation(pa,"u_matrix"),Aa=a.createVertexArray();a.bindVertexArray(Aa);var _a=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,_a),a.bufferData(a.ARRAY_BUFFER,new Float32Array,a.STATIC_DRAW);let da=a.getAttribLocation(pa,"a_position");a.enableVertexAttribArray(da),a.vertexAttribPointer(da,3,a.FLOAT,0,0,0);var Fa=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,Fa),a.bufferData(a.ARRAY_BUFFER,new Float32Array,a.STATIC_DRAW);let xa=a.getAttribLocation(pa,"a_normal");a.enableVertexAttribArray(xa),a.vertexAttribPointer(xa,3,a.FLOAT,0,0,0),a.bindBuffer(a.ARRAY_BUFFER,qt);let Xa=a.getAttribLocation(pa,"a_color");a.enableVertexAttribArray(Xa),a.vertexAttribPointer(Xa,4,a.FLOAT,0,0,0),a.vertexAttribDivisor(Xa,1),a.bindBuffer(a.ARRAY_BUFFER,zt),ma(a.getAttribLocation(pa,"a_matrix")),a.bindBuffer(a.ARRAY_BUFFER,kt),ma(a.getAttribLocation(pa,"a_normalMatrix")),a.bindVertexArray(null);let Ya=0;(async()=>{var a=await(sa||(sa=ya()));return{m:a=new Float32Array(a.buffer,0,1314),p:$t(a)}})().then((({m:t,p:r})=>{a.bindBuffer(a.ARRAY_BUFFER,_a),a.bufferData(a.ARRAY_BUFFER,t,a.DYNAMIC_DRAW),a.bindBuffer(a.ARRAY_BUFFER,Fa),a.bufferData(a.ARRAY_BUFFER,r,a.DYNAMIC_DRAW),Ya=t.length/3}));let Ca=fa("#version 300 es\nin vec4 a_position;in mat4 a_matrix;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*a_matrix*a_position;}","#version 300 es\nprecision highp float;out vec4 outColor;void main(){outColor=vec4(0.18,0.09,0.08,1);}"),Da=a.getUniformLocation(Ca,"u_matrix"),Pa=a.createVertexArray();a.bindVertexArray(Pa);var ba=a.createBuffer();a.bindBuffer(a.ARRAY_BUFFER,ba),a.bufferData(a.ARRAY_BUFFER,new Float32Array,a.STATIC_DRAW);let ja=a.getAttribLocation(Ca,"a_position");a.enableVertexAttribArray(ja),a.vertexAttribPointer(ja,3,a.FLOAT,0,0,0),a.bindBuffer(a.ARRAY_BUFFER,zt),ma(a.getAttribLocation(Ca,"a_matrix")),a.bindVertexArray(null);let Ia=0;(async()=>{var a=await(sa||(sa=ya())),t=(a=>Array.from({length:a.length/9},((t,r)=>[[a[9*r],a[9*r+1],a[9*r+2]],[a[9*r+3],a[9*r+4],a[9*r+5]],[a[9*r+6],a[9*r+7],a[9*r+8]]])))(a=new Float32Array(a.buffer,1188,1134));a=Float32Array,t=(a=>{const t=(a=>{const t=f(),r=f();for(var e of(m(t,9999,9999,9999),m(r,-9999,-9999,-9999),a))for(var n of e){var o=a=t,i=n;a[0]=Math.min(o[0],i[0]),a[1]=Math.min(o[1],i[1]),a[2]=Math.min(o[2],i[2]),o=a=r,i=n,a[0]=Math.max(o[0],i[0]),a[1]=Math.max(o[1],i[1]),a[2]=Math.max(o[2],i[2])}return n=t[1],a=t[2],t[0]=(e=t[0])+.5*(r[0]-e),t[1]=n+.5*(r[1]-n),t[2]=a+.5*(r[2]-a),t})(a);return a.map((a=>a.map((a=>{const r=f();return y(r,a,t),g(r,r),p(r,a,r,.1),r})).reverse()))})(t).flat();var r=[];for(let a=0;a<t.length;a++)for(let e=0;e<t[a].length;e++)r.push(t[a][e]);return{m:new a(r)}})().then((({m:t})=>{a.bindBuffer(a.ARRAY_BUFFER,ba),a.bufferData(a.ARRAY_BUFFER,t,a.DYNAMIC_DRAW),Ia=t.length/3}));let La=fa("#version 300 es\nin vec4 a_position;uniform mat4 u_matrix;void main(){gl_Position=u_matrix*a_position;}","#version 300 es\nprecision highp float;out vec4 outColor;void main(){outColor=vec4(0.258,0.215,0.168,1);}"),Sa=a.getUniformLocation(La,"u_matrix"),za=a.createVertexArray();a.bindVertexArray(za),a.bindBuffer(a.ARRAY_BUFFER,I);let ka=a.getAttribLocation(La,"a_position");a.enableVertexAttribArray(ka),a.vertexAttribPointer(ka,3,a.FLOAT,0,0,0),a.bindVertexArray(null),a.clearColor(0,0,0,0),a.viewport(0,0,a.drawingBufferWidth,a.drawingBufferHeight),a.enable(a.DEPTH_TEST),a.depthFunc(a.LESS);let qa=Math.floor(34/1.2)+2,Ua=Array.from({length:qa**2},(()=>new Set)),Ba=(a,t,r)=>{const e=Math.floor((t- -18)/1.2),n=Math.floor((r- -18)/1.2);a.pop(),a.pop(),a.pop(),a.pop(),0>e||e>=qa||0>n||n>=qa||(a.push(Ua[e*qa+n]),r=.6<1-(r-1.2*n)&&n+1<qa,(t=.6<1-(t-1.2*e)&&e+1<qa)&&a.push(Ua[(e+1)*qa+n]),r&&(a.push(Ua[e*qa+(n+1)]),t&&a.push(Ua[(e+1)*qa+(n+1)])))},Ea=[],Ga=[],Ha=F(),Ja=F(),Ka=F(),Na=f(),Oa=f(),Qa=f(),Ra=x(F()),Ta=new Float32Array(4800),Va=new Float32Array(6400);x(Ha);for(let a=1600;a--;)et(Va,a,Ha);for(let a=1600;a--;)x(Ha),X(Ha,Ha,.1*Math.random()),Y(Ha,Ha,.1*Math.random()),et(Va,a,Ha);let Wa=new Float32Array(4800),Za=[{n:m(f(),0,0,1),d:0,g:m(f(),0,0,-17)},{n:m(f(),0,0,-1),d:0,g:m(f(),0,0,17)},{n:m(f(),-1,0,0),d:0,g:m(f(),17,0,0)},{n:m(f(),1,0,0),d:0,g:m(f(),-17,0,0)}];for(let a of Za)a.d=-A(a.n,a.g);let $a=[],tr=new Set,ar=(a,t,r)=>{Wa[3*a]+=t[0]*r,Wa[3*a+1]+=t[1]*r,Wa[3*a+2]+=t[2]*r},rr=0,nr=[],or=Math.floor(1156/.81),er=1600;for(;0<er;){let a=Math.min(er,or);nr.push(Math.sqrt(1156/a)),er-=a}for(let a=1600;a--;){D(Ha),et(it,a,Ha);let t=Math.floor(a/or),r=nr[t],e=Math.ceil(34/r),n=Math.floor(a%or/e);lt[3*a]=a%or%e*r-17+.5,lt[3*a+1]=t*r+.8*Math.random(),lt[3*a+2]=n*r-17+.5,Ba($a,lt[3*a],lt[3*a+2]);for(let t=$a.length;t--;)$a[t].add(a)}let lr=F(),ir=0,hr=Math.ceil(34/1.05)**2,Mr=[],vr=900;for(;0<vr;){let a=Math.min(vr,hr);Mr.push(Math.sqrt(1156/a)),vr-=a}for(let a=1600;2500>a;a++){D(lr),et(it,a,lr);let t=a-1600,r=Math.floor(t/hr),e=Mr[r],n=Math.ceil(34/e),o=t%hr%n,i=Math.floor(t%hr/n);lt[3*a]=(o+.5)*e+.36+Math.random()*(e-.72)-17,lt[3*a+2]=(i+(o%2?.5:0))*e+.36+Math.random()*(e-.72)-17,lt[3*a+1]=-(2.2+1.5*r)+.6*Math.random()}for(let a=1600;2500>a;a++){let t=1600+Math.floor(900*Math.random()),r=lt[3*a],e=lt[3*a+1],n=lt[3*a+2];lt[3*a]=lt[3*t],lt[3*a+1]=lt[3*t+1],lt[3*a+2]=lt[3*t+2],lt[3*t]=r,lt[3*t+1]=e,lt[3*t+2]=n}let cr=1/60,ur=()=>{rr=(rr+1)%1024;const t=(rr%37)**2+rr%19*7;Wa.fill(0);for(let a=0;1600>a;a++){rt(Na,a),Wa[3*a]+=.018*-Ta[3*a]/cr,Wa[3*a+1]+=.018*-Ta[3*a+1]/cr,Wa[3*a+2]+=.018*-Ta[3*a+2]/cr,nt(Ka,Va,a),C(Ka,Ka,Ra,.06),.7<Math.abs(Ta[3*a+1])&&a%47==t%47&&(X(Ka,Ka,.1*(Math.random()-.5)),Y(Ka,Ka,.1*(Math.random()-.5))),et(Va,a,Ka),Wa[3*a+1]-=7,0>Na[1]&&(Wa[3*a+1]+=30*-Na[1]);for(let t=gt.length;t--;){const r=gt[t];ar(a,r.force,1/Math.max(.2,Math.abs(r.n[0]*Na[0]+r.n[1]*Na[2]-r.o))/Math.max(Math.abs(-r.n[1]*Na[0]+r.n[0]*Na[2]-r.i)-r.t,.2))}for(let t=Za.length;t--;){const r=Za[t],e=A(Na,r.n)+r.d-.5;0>e&&ar(a,r.n,20*(Math.min(-e,.16)/.16)**2)}tr.clear(),Ba($a,Na[0],Na[2]);for(let t=$a.length;t--;)for(const i of $a[t])if(i<a&&!tr.has(i)){rt(Oa,i),tr.add(i),y(Qa,Na,Oa);var r=Qa[0],e=Qa[1],n=Qa[2];const t=r*r+e*e+n*n;if(1>t){const r=Math.sqrt(t);if(1e-4<r){var o=1/r,l=Qa,f=Qa;l[0]=f[0]*o,l[1]=f[1]*o,l[2]=f[2]*o}else m(Qa,0,1,0);const e=60*Math.min(.25,1/(1-r/1));ar(a,Qa,e),ar(i,Qa,-e),Na[1]>Oa[1]?Wa[3*a+1]+=.7*e:Wa[3*i+1]+=.7*e}}}for(let a=1600;a--;){const t=lt[3*a],r=lt[3*a+2];Ta[3*a]+=cr*Wa[3*a],Ta[3*a+1]+=cr*Wa[3*a+1],Ta[3*a+2]+=cr*Wa[3*a+2],lt[3*a]+=cr*Ta[3*a],lt[3*a+1]+=cr*Ta[3*a+1],lt[3*a+2]+=cr*Ta[3*a+2],nt(Ja,it,a),nt(Ka,Va,a);var s=Ja,R=Ja[0],v=Ja[1],F=Ja[2],M=Ja[3],b=Ka[0],_=Ka[1],B=Ka[2],w=Ka[3];s[0]=R*w+M*b+v*B-F*_,s[1]=v*w+M*_+F*b-R*B,s[2]=F*w+M*B+R*_-v*b,s[3]=M*w-R*b-v*_-F*B,et(it,a,Ja);var E=a,D=lt[3*a],U=lt[3*a+2];if(Ba(Ea,t,r),Ba(Ga,D,U),Ea[0]!==Ga[0]||Ea[1]!==Ga[1]||Ea[2]!==Ga[2]){for(let a=Ea.length;a--;)Ea[a].delete(E);for(let a=Ga.length;a--;)Ga[a].add(E)}}y(vt,ht,mt),vt[1]=0,g(vt,vt),x(yt),P(yt,pt,vt),wt.fill(0),p(wt,wt,ft,-7.2),ut=Math.max(0,ut-cr),0===ut&&st&&(st=0,ct=1,ut=.2,console.log("acc")),p(wt,wt,vt,100*ct),ct*=.85,p(ft,ft,wt,cr),p(mt,mt,ft,cr),mt[1]=(()=>{var a=mt[0],t=mt[2];const r=[];for(let e=0;1600>e;e++)4>(lt[3*e]-a)**2+(lt[3*e+2]-t)**2&&r.push(e);return 0===r.length?1.5:r.map((a=>lt[3*a+1])).sort().slice(-2).reduce(((a,t,r,{length:e})=>a+t/e),0)+.5})();const T=ir;ir+=cr;for(let a=1600;2500>a;a++){const t=733*a%17/17*Math.PI*2;var I=619*a%13/13;const r=2.8*(1-I)+3.8*I;var W=157*a%7/7;const e=.1*(1-W)+.2*W;lt[3*a+1]+=Math.sin(r*ir+t)*e-Math.sin(r*T+t)*e}for(let a=gt.length;a--;){const t=gt[a];t.o+=t.h*cr,t.u&&(t.t=Math.min(t.t+t.u*cr,t.v??1/0)),t!==xt&&25.5<Math.abs(t.o)&&gt.splice(a,1)}for(const a of Ft)a.o>17*1.15&&(a.o-=1.15*34);a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT);for(let a=2500;a--;){rt(Kt,a),nt(Nt,it,a);var S=1.088+a%37/37*.05,V=.25+79*a%23/23*.1,N=.4+.55*Math.min(Math.max((lt[3*a+1]- -1)/3.2,0),1),Z=Ot,q=.5>N?N*(1+V):N+V-N*V,O=2*N-q;Z[0]=St(O,q,S+1/3),Z[1]=St(O,q,S),Z[2]=St(O,q,S-1/3),u(Et[a],Nt,Kt),i(Jt,Et[a]);var G=Jt,j=J[0],k=J[1],Q=J[2],$=J[3],z=J[4],ra=J[5],oa=J[6],la=J[7],fa=J[8],sa=Jt[0],ma=Jt[1],Fa=Jt[2],da=Jt[3],ba=Jt[4],_a=Jt[5],wa=Jt[6],ya=Jt[7],xa=Jt[8];G[0]=sa*j+ma*$+Fa*oa,G[1]=sa*k+ma*z+Fa*la,G[2]=sa*Q+ma*ra+Fa*fa,G[3]=da*j+ba*$+_a*oa,G[4]=da*k+ba*z+_a*la,G[5]=da*Q+ba*ra+_a*fa,G[6]=wa*j+ya*$+xa*oa,G[7]=wa*k+ya*z+xa*la,G[8]=wa*Q+ya*ra+xa*fa;var Ua=Jt,Ha=Jt[0],qa=Jt[1],Xa=Jt[2],ja=Jt[3],ka=Jt[4],at=Jt[5],tt=Jt[6],At=Jt[7],Rt=Jt[8],Mt=Rt*ka-at*At,dt=-Rt*ja+at*tt,bt=At*ja-ka*tt,_t=Ha*Mt+qa*dt+Xa*bt;_t&&(Ua[0]=Mt*(_t=1/_t),Ua[1]=(-Rt*qa+Xa*At)*_t,Ua[2]=(at*qa-Xa*ka)*_t,Ua[3]=dt*_t,Ua[4]=(Rt*Ha-Xa*tt)*_t,Ua[5]=(-at*Ha+Xa*ja)*_t,Ua[6]=bt*_t,Ua[7]=(-At*Ha+qa*tt)*_t,Ua[8]=(ka*Ha-qa*ja)*_t);var Yt=Jt,Dt=Jt;if(Yt===Dt){var Lt=Dt[1],Tt=Dt[2],Ct=Dt[5];Yt[1]=Dt[3],Yt[2]=Dt[6],Yt[3]=Lt,Yt[5]=Dt[7],Yt[6]=Tt,Yt[7]=Ct}else Yt[0]=Dt[0],Yt[1]=Dt[3],Yt[2]=Dt[6],Yt[3]=Dt[1],Yt[4]=Dt[4],Yt[5]=Dt[7],Yt[6]=Dt[2],Yt[7]=Dt[5],Yt[8]=Dt[8];Ht[a][0]=Jt[0],Ht[a][1]=Jt[1],Ht[a][2]=Jt[2],Ht[a][4]=Jt[3],Ht[a][5]=Jt[4],Ht[a][6]=Jt[5],Ht[a][8]=Jt[6],Ht[a][9]=Jt[7],Ht[a][10]=Jt[8],Ut[4*a]=Ot[0],Ut[4*a+1]=Ot[1],Ut[4*a+2]=Ot[2]}a.bindBuffer(a.ARRAY_BUFFER,zt),a.bufferSubData(a.ARRAY_BUFFER,0,Bt),a.bindBuffer(a.ARRAY_BUFFER,kt),a.bufferSubData(a.ARRAY_BUFFER,0,Gt),a.bindBuffer(a.ARRAY_BUFFER,qt),a.bufferSubData(a.ARRAY_BUFFER,0,Ut),u(ia,yt,mt),c(ia,H,ia),c(ha,L,ia),h(Ma,ia);for(let a=0;a<na.length;a++){d(va,na[a],ha),ot(ca,a);var It=ea[a],Wt=va,Pt=Ma,Vt=It[0],Zt=It[1],Xt=It[2];Wt[0]=Vt*Pt[0]+Zt*Pt[3]+Xt*Pt[6],Wt[1]=Vt*Pt[1]+Zt*Pt[4]+Xt*Pt[7],Wt[2]=Vt*Pt[2]+Zt*Pt[5]+Xt*Pt[8],ot(ua,a)}a.bindBuffer(a.ARRAY_BUFFER,ta),a.bufferSubData(a.ARRAY_BUFFER,0,ca),a.bindBuffer(a.ARRAY_BUFFER,aa),a.bufferSubData(a.ARRAY_BUFFER,0,ua),a.useProgram(La),a.uniformMatrix4fv(Sa,0,K),a.bindVertexArray(za),a.enable(a.CULL_FACE),a.cullFace(a.BACK),a.drawArrays(a.TRIANGLES,0,12),a.bindVertexArray(null),a.useProgram(pa),a.uniformMatrix4fv(ga,0,K),a.bindVertexArray(Aa),a.enable(a.CULL_FACE),a.cullFace(a.BACK),a.drawArraysInstanced(a.TRIANGLES,0,Ya,2500),a.bindVertexArray(null),a.useProgram(Ca),a.uniformMatrix4fv(Da,0,K),a.bindVertexArray(Pa),a.enable(a.CULL_FACE),a.cullFace(a.BACK),a.drawArraysInstanced(a.TRIANGLES,0,Ia,2500),a.bindVertexArray(null),requestAnimationFrame(ur)};ur()</script>