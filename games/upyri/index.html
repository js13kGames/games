<title>UPYRI - js13kGames 2025</title><style>#tmpl,canvas,svg{width:min(100vw,calc(100vh * 16/9));position:absolute;aspect-ratio:16/9;text-anchor:middle}body,html{margin:0;background-color:#000;display:grid;place-items:center;height:100%}svg{font-family:sans-serif;font-size:80px;font-weight:700}#Fullscreen,#Start{fill:#777;cursor:pointer}</style><canvas height=1080 id=c3d width=1920></canvas><div id=tmpl></div><script>async function _(){var t=$,e=new Qe;await t.g.Ra?.(),t.g={xa:()=>{}},await e.wa?.(),t.g=e}class U{constructor(t,...e){this.g=t,this.g.wa?.(...e)}}let $;function G(t){return new y(t.x,t.y,t.z,t.w)}function N(t,e,i){return t.x=e.x-i.x,t.y=e.y-i.y,t.z=e.z-i.z,t}function O(t,e){return N(t,t,e),t}function j(t,e,i){var a=e.z*i.x-e.x*i.z,n=e.x*i.y-e.y*i.x;return t.x=e.y*i.z-e.z*i.y,t.y=a,t.z=n,t}function H(t,e){return t.x*e.x+t.y*e.y+t.z*e.z}function K(t){return[t.x,t.y,t.z]}function s(t){var e=t.ga;return 0===e?new y:(t.x/=e,t.y/=e,t.z/=e,t)}function X(t,e){2<(e=N(new y,e,t)).ga&&(e=s(e).o(.6),t.D(e))}function k(t,e){return t.x===e.x&&t.y===e.y&&t.z===e.z}class y extends DOMPoint{D(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}set(t,e,i){return t&&"object"==typeof t&&(e=t.y,i=t.z,t=t.x),this.x=t??this.x,this.y=e??this.y,this.z=i??this.z,this}o(t){return this.x*=t,this.y*=t,this.z*=t,this}get ga(){return Math.hypot(...K(this))}}let r=new class{constructor(){this.j=!1,this.l=new y,this.g=new Map,document.addEventListener("keydown",t=>{this.g.set(t.code,!0)}),document.addEventListener("keyup",t=>{this.g.set(t.code,!1)}),document.addEventListener("mousedown",()=>{this.g.set("KeyE",!0)}),document.addEventListener("mouseup",()=>{this.g.set("KeyE",!1)}),document.addEventListener("mousemove",t=>{this.l.x=t.movementX,this.l.y=t.movementY,this.B?.(this.l)}),this.h=new y}},o=(t,...e)=>`<svg ${u(t)} xmlns="http://www.w3.org/2000/svg">${e.join("")}</svg>`,Y=(t,...e)=>`<g ${u(t)}>${e.join("")}</g>`,c=(t,...e)=>`<filter ${u(t)}>${e.join("")}</filter>`,e=t=>`<ellipse ${u(t)}/>`,V=(t,e)=>`<text ${u(t)}>${e??""}</text>`,J=(t,...e)=>`<radialGradient ${u(t)}>${e.join("")}</radialGradient>`,W=(t,...e)=>`<mask ${u(t)}>${e.join("")}</mask>`;function u(t){return Object.entries({baseFrequency:t.I,"color-interpolation-filters":t.Xa,cx:t.cx,cy:t.cy,fill:t.fill,filter:t.filter&&`url(#${t.filter})`,fr:t.Ya,fx:t.fx,fy:t.fy,gradientTransform:t.gradientTransform,height:t.v,id:t.A,in:t.ja,in2:t.in2,k2:t.k2,k3:t.k3,"lighting-color":t.Ga,mask:t.Ha,mode:t.mode,numOctaves:t.M,offset:t.P,operator:t.operator,primitiveUnits:t.primitiveUnits,radius:t.Za,result:t.result,rx:t.rx,ry:t.ry,scale:t.o,seed:t.da,stitchTiles:t.ea,"stop-color":t.R,style:t.style,surfaceScale:t.surfaceScale,type:t.O,values:t.values,viewBox:t.viewBox,width:t.s,x:t.x,y:t.y}).map(([t,e])=>null!=e?t+`="${e}"`:"").join(" ")}let f=t=>`<feTurbulence ${u(t)} />`,Z=(...t)=>`<feComponentTransfer color-interpolation-filters="sRGB">${t.join("")}</feComponentTransfer>`;function w(t,e,i){return`<feFunc${t} type="${e}" ${"gamma"===e?'amplitude="1" exponent="0.55"':`tableValues="${i}"`}/>`}let q=(t,...e)=>`<feDiffuseLighting ${u(t)}>${e.join("")}</feDiffuseLighting>`;async function n(t){let e=new Image;return e.src=URL.createObjectURL(new Blob([t],{type:"image/svg+xml"})),new Promise(t=>e.addEventListener("load",()=>t(e)))}async function Q(t,e){return[...(t=await n(t),(i=new OffscreenCanvas(t.width,t.height).getContext("2d")).drawImage(t,0,0),(await i.getImageData(0,0,t.width,t.height)).data)].filter((t,e)=>!(e%4)).map(t=>(t/255-.5)*e);var i}function tt(e,i){var a=[];for(let t=0;t<e;t++)a.push(i(t));return a}function h(t){return 180/Math.PI*t}function et(t){var e=O(G(t[2]),t[1]);return t=O(G(t[0]),t[1]),j(new y,e,t)}class l{constructor(t){this.$=[0,0,0,0],this.Y=!1,this.i=t?.i,this.$=(t?.$?t:this).$,this.Y=t?.Y??this.Y}}let x=new class{constructor(){this.g=c3d.getContext("webgl2");var t=this.createShader(this.g.VERTEX_SHADER,"#version 300 es\nlayout(location=0) in vec3 E;layout(location=1) in vec3 B;layout(location=2) in vec2 K;layout(location=3) in float L;uniform mat4 M,N,f;out vec2 i;out float n;out vec3 o;out mat4 l;out vec4 u;void main(){vec4 v=vec4(E,1);gl_Position=M*v;i=K;n=L;o=B;l=N;u=f*v;}"),e=this.createShader(this.g.FRAGMENT_SHADER,"#version 300 es\nprecision highp float;\nin vec4 e;in vec2 i;in float n;in vec3 o;in mat4 l;in vec4 u;uniform vec2 h;uniform vec4 t;uniform mediump sampler2DArray s;uniform mediump sampler2DShadow z;out vec4 g;vec3 d=vec3(-1,1.5,-1);float A=.2f,C=.6f;vec2 D[5]=vec2[](vec2(0),vec2(-1,0),vec2(1,0),vec2(0,1),vec2(0,-1));float F=1.,J=5555.;void main(){for(int v=0;v<5;v++){vec3 m=vec3(u.xy+D[v]/J,u.z-.001);float f=texture(z,m);F*=max(f,.87);}vec3 v=normalize(mat3(l)*o),f=normalize(d);float m=max(dot(f,v)*F,A);vec3 e=length(t)>0.?t.xyz:m*vec3(1);vec4 C=vec4(e.xyz,1);g=n<0.?C:texture(s,vec3(i*h,n))*C;}");this.h=this.createProgram(t,e),t=this.createShader(this.g.VERTEX_SHADER,"#version 300 es\nlayout(location=0) in vec4 E;out vec4 G;void main(){G=E;gl_Position=E;gl_Position.z=1.;}"),e=this.createShader(this.g.FRAGMENT_SHADER,"#version 300 es\nprecision highp float;\nuniform samplerCube I;uniform mat4 H;in vec4 G;out vec4 g;void main(){vec4 v=H*G;g=texture(I,v.xyz);}"),this.l=this.createProgram(t,e),t=this.createShader(this.g.VERTEX_SHADER,"#version 300 es\nprecision highp float;\nlayout(location=0) in vec4 m;uniform mat4 f;void main(){gl_Position=f*m;}"),e=this.createShader(this.g.FRAGMENT_SHADER,"#version 300 es\nprecision highp float;\nout float v;void main(){v=gl_FragCoord.z;}"),this.j=this.createProgram(t,e),t=this.g.getUniformLocation(this.h,"z"),e=this.g.getUniformLocation(this.h,"s"),this.g.useProgram(this.h),this.g.uniform1i(e,0),this.g.uniform1i(t,1)}createShader(t,e){return t=this.g.createShader(t),this.g.shaderSource(t,e),this.g.compileShader(t),t}createProgram(t,e){var i=this.g.createProgram();return this.g.attachShader(i,t),this.g.attachShader(i,e),this.g.linkProgram(i),this.g.getProgramParameter(i,this.g.LINK_STATUS),i}},v=x.g;class it{constructor(t,e){this.za=new y(1,1),this.source=e,this.id=t}}function i(t,e){return e=new it(t.g.length,e),t.g.push(e),e}let a=new class{constructor(){this.g=[]}},m=t=>({x:0,y:0,s:"100%",v:"100%",...t});var at,nt,M,st,rt,ot,ht,lt,ct,ut,d,ft,wt,xt,vt;function mt(){return c(m({A:"s"}),f({I:.2,ea:"stitch"}),`<feColorMatrix ${u({values:[0,0,0,9,-5.5,0,0,0,9,-5.5,0,0,0,9,-5.5,0,0,0,0,1]})}/>`)}function Mt(t=!0,e=!0){return n(o({s:512,v:512},(e?`<pattern id="p" width="${t?160:75}" height="${t?256:1}" patternUnits="userSpaceOnUse"><path d="m 0 246 h 148 V 125 H 0 V112 h72 V0 h15 v112 h 74 V 0 H 0"/></pattern>`:"")+([t=!0]=[t],c(m({A:"rw"}),`<feDropShadow dx="${t?1:300}" dy="${t?1:930}" result="s"/>`+f({O:"fractalNoise",I:t?.007:[.1,.007],M:t?9:6,ea:"stitch"}),`<feComposite ${u({ja:"s",operator:"arithmetic",k2:.5,k3:.5})} />`,Z(w("A","table",[0,.1,.2,.3,.4,.2,.4,.2,.4])),q({surfaceScale:2.5,Ga:t?"#ffd":"#6e5e42"},`<feDistantLight azimuth="${t?265:110}" elevation="${t?4:10}"/>`),navigator.userAgent.includes("fox")?Z(w("R","gamma",[]),w("G","gamma",[]),w("B","gamma",[]),w("A","gamma",[])):"")),`<rect ${u({x:0,y:0,s:"100%",v:"100%",fill:e?"url(#p)":void 0,filter:"rw"})}/>`))}function p(t,e,i=70){return dt(V({style:"font-size: 360px; transform: scaleY(1.5);",...t,filter:"d"},e),i)}function dt(t,e=70,i=[.13,.02]){return c({A:"d"},f({I:i,M:1,O:"fractalNoise",result:"d"}),`<feDisplacementMap ${u({ja:"SourceGraphic",in2:"d",o:e})} />`)+c({A:"b"},f({I:.04,M:1,O:"fractalNoise"}),`<feColorMatrix ${u({values:[.4,.2,.2,0,-.1,0,2,0,0,-1.35,0,2,0,0,-1.35,0,0,0,0,1]})}/>`,`<feComposite ${u({in2:"SourceGraphic",operator:"in"})} />`)+Y({filter:"b"},t)}let pt=[[.4,.5,.4,0,.3,.2,.6,.2,0,.3,0,0,.1,0,0,1,0,0,0,1],[.1,.1,.1,0,-.05,.1,.1,.1,0,-.05,.1,.1,.1,0,-.05,0,0,0,0,1],[.07,.05,.06,0,-.1,.07,.05,.06,0,-.1,.07,.05,.06,0,-.1,0,0,0,0,1]];function yt(t,e=!1){return(e?Q:n)(o({s:e?32:512,v:e?32:512},c({A:"b"},f({I:t<2?[.1,.004]:1.2,M:t<2?1:5,O:"fractalNoise"}),`<feColorMatrix ${u({values:pt[t]})}/>`),`<rect ${u(m({filter:"b"}))}/>`),1)}async function gt(){return Q(o({s:256,v:256},c({A:"n"},f({da:6,I:.05,M:3,O:"fractalNoise"})),J({A:"l"},`<stop ${u({P:"10%",R:"#0004"})} />`,`<stop ${u({P:"22%",R:"#0000"})} />`),`<rect ${u({x:0,y:0,s:"100%",v:"100%",filter:"n"})}/>`,e({cx:128,cy:128,fill:"url(#l)",rx:200,ry:200}),e({cx:128,cy:128,fill:"#afafaf",rx:26,ry:26}),`<rect ${u({x:125,y:10,s:6,v:80,fill:"#afafaf"})}/>`),113)}function At(t,e,i,a){t.N=new DOMMatrix,t.F.set(h(e),h(i),h(a)),t.N.rotateSelf(h(e),h(i),h(a))}function Et(t){var e,i;t.B=(e=t,(i=new DOMMatrix).translateSelf(e.m.x,e.m.y,e.m.z),e.V?i.multiplySelf(e.N):i.rotateSelf(e.F.x,e.F.y,e.F.z),i.scaleSelf(e.o.x,e.o.y,e.o.z),i),t.S=t.ka?t.ka.S.multiply(t.B):DOMMatrix.fromMatrix(t.B),t.T.forEach(t=>Et(t))}function Tt(t){var e=[];return function e(t,i){t.T.forEach(t=>{i.push(t),e(t,i)})}(t,e),e}function Ct(t,e){t.V=!0,s(N(t.g,t.m,e)),s(j(t.h,t.ia,t.g)),s(j(t.l,t.g,t.h)),t.N=new DOMMatrix([t.h.x,t.h.y,t.h.z,0,t.l.x,t.l.y,t.l.z,0,t.g.x,t.g.y,t.g.z,0,0,0,0,1])}class Dt{constructor(...t){this.F=new y,this.V=!1,this.h=new y,this.l=new y,this.g=new y,this.m=new y,this.o=new y(1,1,1),this.T=[],this.B=new DOMMatrix,this.S=new DOMMatrix,this.ia=new y(0,1,0),this.N=new DOMMatrix,t&&this.D(...t)}D(...t){t.forEach(t=>{t.ka&&(t.ka.T=t.ka.T.filter(t=>t!==this)),(t.ka=this).T.push(t)})}j(e){this.T=this.T.filter(t=>t!==e)}C(t,e,i){this.F.D({x:h(t),y:h(e),z:h(i)}),this.N.rotateSelf(h(t),h(e),h(i))}}class g extends Dt{constructor(t,e){A(t,0,new Float32Array(t.K.flatMap(t=>K(t))),3),super(),this.X=t,this.ca=e}}function Ft(t,e,i){return Array((t+1)*(e+1)).fill().map(()=>i.id)}function A(t,e,i,a){return t.Z.set(e,{data:i,size:a}),t}function zt(t,e,i,a,n,s,r){return e=Ft(t.h,t.j,e),i=Ft(t.h,t.j,i),a=Ft(t.l,t.h,a),n=Ft(t.l,t.h,n),s=Ft(t.l,t.j,s),r=Ft(t.l,t.j,r),A(t,3,new Float32Array([...a,...n,...e,...i,...s,...r]),1),t}function E(t,e=!1){return e=function(e,i){var a=e.map(()=>new y);for(let t=0;t<i.length;t+=3){var n=et([e[i[t]],e[i[t+1]],e[i[t+2]]]);a[i[t]].D(n),a[i[t+1]].D(n),a[i[t+2]].D(n)}return a.map(t=>s(t))}(t.K,e?function(t){let e=[],n=t.W.slice();return t.g.forEach(i=>{var a;e.find(t=>k(i,t))||(e.push(i),a=t.K.findIndex(t=>k(i,t)),t.K.forEach((t,e)=>{k(i,t)&&(n[n.indexOf(e)]=a)}))}),n}(t):t.W),A(t,1,new Float32Array(e.flatMap(t=>K(t))),3),t}function T(t){return t.g=t.K,t}function Rt(e){return e.g=e.K.filter(t=>!e.g.includes(t)),e}function C(t,e){return t.g=t.K.filter(e),t}function D(t,e=0,i=0,a=0){return t.g.forEach(t=>t.D({x:e,y:i,z:a})),t}function Pt(t,e){return t.g.forEach(e),t}function F(a,n){var t=n.W.map(t=>t+a.K.length);return a.W=new Uint16Array([...a.W,...t]),a.K.push(...n.K),tt(3,t=>{var e,i=a.Z.get(t+1);i&&(e=n.Z.get(t+1).data,e=new Float32Array([...i.data,...e]),A(a,t+1,e,i.size))}),a}function z(t,i,a="y",n={x:0,y:0,z:0}){return Pt(t,t=>{var e=t[a];t[a]=0,s(O(t,n)).o(i),t[a]=e}),t}function R(t,i=12,a=12,n=0,s=0){let r,o,h=(t.l-1+2)*(t.h-1+2)*2,l=h+(t.h-1+2)*(t.j-1+2)*2,c=t.Z.get(2).data;return t.K.forEach((t,e)=>{o=e<h?(r=t.x,t.z):(r=e<l?t.z:t.x,t.y),c.set([r/i+n,o/a+s],2*e)}),A(t,2,c,2),t}function It(t){let e=[...t.Z.values()].reduce((t,e)=>t+e.data.length,0),i=new Float32Array(e),a=0,n=(t.Z.forEach(t=>{i.set(t.data,a),a+=t.data.length}),v.bindBuffer(v.ARRAY_BUFFER,v.createBuffer()),v.bufferData(v.ARRAY_BUFFER,i,v.STATIC_DRAW),v.bindVertexArray(t.qa),0);t.Z.forEach((t,e)=>{v.vertexAttribPointer(e,t.size,v.FLOAT,!1,0,n),v.enableVertexAttribArray(e),n+=t.data.length*t.data.BYTES_PER_ELEMENT}),v.bindBuffer(v.ELEMENT_ARRAY_BUFFER,v.createBuffer()),v.bufferData(v.ELEMENT_ARRAY_BUFFER,t.W,v.STATIC_DRAW)}class P{constructor(t=1,e=1,i=1,a=1,n=1,s=1,r=6){this.K=[],this.g=[],this.Z=new Map,this.l=a,this.h=s,this.j=n,this.qa=v.createVertexArray();let M=[],d=[],p=0,o=(i,a,n,s,r,o,t,h,l,c)=>{var u=o/l,f=t/c,w=(o/=2,t/2),x=h/2;h=l+1,t=c+1;for(let e=0;e<t;e++){var v=e*f-w;for(let t=0;t<h;t++){var m=new y;m[i]=(t*u-o)*s,m[a]=v*r,m[n]=x,this.K.push(m),d.push(t/l),d.push(1-e/c)}}for(i=0;i<c;i++)for(a=0;a<l;a++)n=p+a+h*(i+1),s=p+(a+1)+h*(i+1),r=p+(a+1)+h*i,M.push(p+a+h*i,n,r),M.push(n,s,r);p+=h*t},h=[["x","z","y",1,1,t,i,e,a,s],["x","z","y",1,-1,t,i,-e,a,s],["z","y","x",-1,-1,i,e,t,s,n],["z","y","x",1,-1,i,e,-t,s,n],["x","y","z",1,-1,t,e,i,a,n],["x","y","z",-1,-1,t,e,-i,a,n]];tt(r,t=>o(...h[t])),A(this,2,new Float32Array(d),2),this.W=new Uint16Array(M),T(E(this))}o(t=1,e=1,i=1){let a=(new DOMMatrix).scaleSelf(t,e,i);return this.g.forEach(t=>t.set(a.transformPoint(t))),this}C(t=0,e=0,i=0){let a=(new DOMMatrix).rotateSelf(h(t),h(e),h(i));return this.g.forEach(t=>t.set(a.transformPoint(t))),this}}let Lt=t=>t.reduce((t,e)=>F(t,e));class I extends P{constructor(a,n,t,s,r=0,o=2,h=!1,l=!1){let c=0,u=0;super(a[0],t[0],o,h?6:1,1,1,6),this.Aa=0,R(D(this,0,n-t[0]/2+r)),t.forEach((t,e)=>{var i=1===a.length?a[0]:a[e];0<e&&0<t&&F(this,R(D(new P(i,t,o,h?6:1,1,1,6),0+c+i/2,n-t/2+r))),0<s[e]&&F(this,R(D(new P(i,s[e],o,l?6:1,1,1,6),0+c+i/2,s[e]/2+r))),c+=0===e?i/2:i,u+=i}),this.Aa=u,E(D(T(this),(a[0]-u)/2,0))}}function St(t,e,i){return F(D(t,0,0,i),D(e,0,0,-i))}function Bt(t,e,i,a){return E(F(St(t,e,(i.Aa+2)/2),St(i,a,(t.Aa-2)/2).C(0,Math.PI/2)))}function bt(e,t){return tt(t,t=>e[t%e.length])}var _t=void 0;let Ut=t=>t.map(t=>t.map(t=>t.map(t=>t.split("").map(t=>t.charCodeAt()-65)))),$t=Ut([[["JEFCC","MFMGM","AAACA"],["LL","MM","AA"],["EDN","FMM","AAA"],["KK","MM","AA"]],[["JEECD","MFMEM","AAADA"],["KCK","MDM","ACA"],["CCEEI","MEMFM","ACAAA"],["JCJ","MDM","ACA"]]]),Gt=structuredClone($t),Nt=(Gt[0][0]=[[9.25,3.5,6.25,3],[12,5,12,5],[0]],Gt[1][0]=[[9,4,4,2,3],[12,5,12,4,12],[0,0,0,2,0]],Ut([[["CCFEFCC","MGMFMGM","ACAAACA"],["DCMCD","MGMMM","ACAAA"],["BCOCB","MGMMM","ACAAA"],["BCOCB","MGMGM","ACACA"]],[["CCFEFCC","MGMFMGM","ACAAACA"],["DCFCFCD","MGMGMGM","ACACACA"],["BCOCB","MGMGM","ACACA"],["DEGED","MGMGM","ACACA"]]])),L=t=>t.reduce((t,e)=>t+e);function Ot(t,e,i,a,n){var s=t=>a?z(t,12):t,r=R(s(D(new P(t,1,e,a?4:1,1,a?4:1),0,a?-.3:-.4)));return n||F(r,R(s(D(new P(t,1,e,a?4:1,1,a?4:1),0,23)))),i||F(r,R(s(D(new P(t,1,e,a?4:1,1,a?4:1),0,11)))),r}function S(t,e,i,a=!1){return t=bt([1,2],2*t),E(D(new I(t,3,bt([1.1,3],t.length/3),[0,0],0,2,a,a).C(0,0,Math.PI),0,e+3,i))}function jt(t,e){return D(F(F(new I([36,12,36],11.5,[12,e?1:12,12],[0,0,0],0,8),D(S(e?76:82,11.5,4),e?-4:0)),D(S(e?85:13,11.5,-4),e?0:33.5)),0,0,t)}function Ht(t){var e=[new I(bt([5,2,5],24),12,bt([12,3,12],24),bt([0,2,0],24),0),R(new P(96,24,2))];return 0<t&&e.reverse(),E(D(F(F(F(St(...e,5),S(95,12,6)),S(95,12,-6)),Ot(98,9,!1,!1,!0)).C(0,Math.PI/2,0),t))}function Kt(t,i){var e=t.map((t,e)=>(t=t.map(t=>new I(t[0],12,t[1],t[2],12*e,2,i,i)),i?Xt(Bt(...t),10,11,13.5):Bt(...t)));return t=Bt(S(L(t[0][0][0])+2,24,0,i),S(L(t[0][0][0])+2,24,0,i),S(L(t[0][2][0]),24,0,i),S(L(t[0][2][0]),24,0,i)),e.push(i?Xt(t,11,12,14):t),Lt(e)}function Xt(t,e,i,a){return T(E(z(Rt(z(C(t,t=>Math.abs(t.x)<=e&&Math.abs(t.z)<=e),i,"y")),a,"y"),!0))}function kt(t,e,i=!0){function a(t,i,e,a,n){let s=Math.floor(t/2),r=t/s,o=(e-i)/s;return Lt(tt(s,t=>{var e=i+t*o+o;return R(n(D(T(D(C(new P(r,e,a),t=>t.x<0&&0<t.y),0,-o)),t*r+r/2,e/2)))}))}let n=e?-1:1;return e=F(F(a(11,0,5,5,t=>D(t,-7,0,-7.5*n)),R(D(new P(5,5,5,3),6.5,2.5,-7.5*n))),D(a(10,5,11.5,5,t=>t).C(0,-Math.PI/2*n),6.5,0,-5*n)),i&&F(F(e,R(D(new P(18,1,5,4),0,11,7.5*n))),R(D(new P(5,1,15,1,1,6),-6.5,11,-2.5*n))),t?T(z(Rt(C(e,t=>Math.abs(t.x)<=8&&Math.abs(t.z)<=5)),12)):e}class Yt extends P{constructor(...t){super(),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!1),v.bindTexture(v.TEXTURE_CUBE_MAP,v.createTexture()),t.forEach((t,e)=>{v.texImage2D(v.TEXTURE_CUBE_MAP_POSITIVE_X+e,0,v.RGBA,v.RGBA,v.UNSIGNED_BYTE,t)}),v.generateMipmap(v.TEXTURE_CUBE_MAP),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!0),A(this,0,new Float32Array([-1,-1,1,-1,-1,1,-1,1,1,-1,1,1]),2)}}class Vt extends Dt{constructor(){super(...arguments),this.ma=[],this.pa=[]}D(...t){super.D(...t),[...t,...t.flatMap(t=>Tt(t))].forEach(t=>{t.X&&(It(t.X),(t.ca.Y?this.pa:this.ma).push(t))})}j(t){super.j(t),[t,...Tt(t)].forEach(e=>{e.X&&(e.ca.Y?this.pa=this.pa.filter(t=>t!==e):this.ma=this.ma.filter(t=>t!==e))})}}class Jt extends Dt{constructor(t){var e=Math.PI/3,i=(super(),e=Math.tan(.5*Math.PI-.5*e),1/(1-t));this.Ka=new DOMMatrix([e/(16/9),0,0,0,0,e,0,0,0,0,(1+t)*i,-1,0,0,+t*i*2,0])}}v.enable(v.CULL_FACE),v.enable(v.DEPTH_TEST),v.enable(v.BLEND),v.blendFunc(v.SRC_ALPHA,v.ONE_MINUS_SRC_ALPHA),v.pixelStorei(v.UNPACK_FLIP_Y_WEBGL,!0);let Wt=v.getUniformLocation(x.h,"M"),Zt=v.getUniformLocation(x.h,"N"),qt=v.getUniformLocation(x.h,"t"),Qt=v.getUniformLocation(x.h,"h"),te=v.getUniformLocation(x.l,"I"),ee=v.getUniformLocation(x.l,"H"),ie=new y(0,0,0),ae=new DOMMatrix([2/210,0,0,0,0,2/210,0,0,0,0,-.0025,0,-0,-0,-0,1]),ne=s(new y(-.8,1.5,-1)),se=new Dt,re=(se.m.set(ne),Ct(se,ie),se.N.invertSelf(),ae.multiply(se.N)),oe=v.getUniformLocation(x.j,"f"),he=(v.useProgram(x.j),v.uniformMatrix4fv(oe,!1,re.toFloat32Array()),new DOMMatrix([.5,0,0,0,0,.5,0,0,0,0,.5,0,.5,.5,.5,1]).multiplySelf(re)),le=v.getUniformLocation(x.h,"f");v.useProgram(x.h),v.uniformMatrix4fv(le,!1,he.toFloat32Array());var ce,ue=v.createTexture();v.activeTexture(v.TEXTURE1),v.bindTexture(v.TEXTURE_2D,ue),v.texStorage2D(v.TEXTURE_2D,1,v.DEPTH_COMPONENT32F,4096,4096),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_COMPARE_MODE,v.COMPARE_REF_TO_TEXTURE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_S,v.CLAMP_TO_EDGE),v.texParameteri(v.TEXTURE_2D,v.TEXTURE_WRAP_T,v.CLAMP_TO_EDGE);let fe=v.createFramebuffer();function we(i,t){var e=i.S.inverse();let a=e.scale(),n=i.Ka.multiply(e),s=(e=t=>{v.useProgram(x.l),v.uniform1i(te,0),a.m41=0,a.m42=0,a.m43=0;var e=i.Ka.multiply(a).inverse();v.uniformMatrix4fv(ee,!1,e.toFloat32Array()),v.bindVertexArray(t.qa),v.drawArrays(v.TRIANGLES,0,6)},(t,e)=>{v.useProgram(x.h),v.texParameteri(v.TEXTURE_2D_ARRAY,v.TEXTURE_MIN_FILTER,v.LINEAR_MIPMAP_LINEAR),e=e.multiply(t.S),v.uniform4fv(qt,t.ca.$),v.vertexAttrib1f(3,t.ca.i?.id??-1),v.uniform2fv(Qt,[t.ca.i?.za.x??1,t.ca.i?.za.y??1]),v.bindVertexArray(t.X.qa),v.uniformMatrix4fv(Zt,!0,t.color?t.Wa:t.S.inverse().toFloat32Array()),v.uniformMatrix4fv(Wt,!1,e.toFloat32Array()),t.ca.Y||v.uniformMatrix4fv(le,!1,he.multiply(t.S).toFloat32Array()),v.drawElements(v.TRIANGLES,t.X.W.length,v.UNSIGNED_SHORT,0)});v.useProgram(x.j),v.bindFramebuffer(v.FRAMEBUFFER,fe),v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT),v.viewport(0,0,4096,4096),t.ma.forEach((t,e)=>{0<e&&(v.bindVertexArray(t.X.qa),v.uniformMatrix4fv(oe,!1,re.multiply(t.S).toFloat32Array()),v.drawElements(v.TRIANGLES,t.X.W.length,v.UNSIGNED_SHORT,0))}),v.viewport(0,0,1920,1080),v.bindFramebuffer(v.FRAMEBUFFER,null),v.cullFace(v.BACK),v.clear(v.COLOR_BUFFER_BIT|v.DEPTH_BUFFER_BIT),t.ma.forEach(t=>s(t,n)),t.la&&(v.depthFunc(v.LEQUAL),e(t.la),v.depthFunc(v.LESS)),t.pa.forEach(t=>s(t,n))}v.bindFramebuffer(v.FRAMEBUFFER,fe),v.framebufferTexture2D(v.FRAMEBUFFER,v.DEPTH_ATTACHMENT,v.TEXTURE_2D,ue,0);class xe{constructor(t){this.points=t,this.L=s(et(t)),this.Ia=-H(this.L,t[0]),t=t.map(t=>t.y),this.Va=Math.max(...t),this.Qa=Math.min(...t)}}function ve(t,e,i){return(new y).set(i.transformPoint(new y(e[t],e[t+1],e[t+2])))}function me(t){return t.flatMap(e=>{var i=e.X.W,a=e.X.Z.get(0),n=[];for(let t=0;t<i.length;t+=3){var s=3*i[t+1],r=3*i[t+2],o=ve(3*i[t],a.data,e.S),s=ve(s,a.data,e.S),r=ve(r,a.data,e.S);n.push([o,s,r])}return n.map(t=>new xe(t))})}function Me(t){let e={fa:[],ba:[]};return t.forEach(t=>{(.2<t.L.y?e.fa:e.ba).push(t)}),e}let de=new AudioContext,pe=(...t)=>{let e=de.createBufferSource(),i=de.createBuffer(t.length,t[0].length,44100);return t.map((t,e)=>i.getChannelData(e).set(t)),e.buffer=i,e},B=(t=1,e=.05,i=220,a=0,n=0,s=.1,r=0,o=1,h=0,l=0,c=0,u=0,f=0,w=0,x=0,v=0,m=0,M=1,d=0,p=0)=>{let y,g,A=2*Math.PI,E=h*=500*A/44100/44100,T=i*=(1-e+2*e*Math.random(e=[]))*A/44100,C=0,D=0,F=0,z=1,R=0,P=0,I=0;for(l*=500*A/44100**3,x*=A/44100,c*=A/44100,u*=44100,f=44100*f|0,g=(a=44100*a+9)+(d*=44100)+(n*=44100)+(s*=44100)+(m*=44100)|0;F<g;e[F++]=I)++P%(100*v|0)||(I=r?1<r?2<r?3<r?Math.sin((C%A)**3):Math.max(Math.min(Math.tan(C),1),-1):1-(2*C/A%2+2)%2:1-4*Math.abs(Math.round(C/A)-C/A):Math.sin(C),I=(f?1-p+p*Math.sin(A*F/f):1)*(0<I?1:-1)*Math.abs(I)**o*t*.7*(F<a?F/a:F<a+d?1-(F-a)/d*(1-M):F<a+d+n?M:F<g-m?(g-F-m)/s*M:0),I=m?I/2+(m>F?0:(F<g-m?1:(g-F)/m)*e[F-m|0]/2):I),y=(i+=h+=l)*Math.cos(x*D++),C+=y-y*w*(1-1e9*(Math.sin(F)+1)%2),z&&++z>u&&(i+=c,T+=c,z=0),!f||++R%f||(i=T,h=E,z=z||1);return e};function ye(i){return t=>{t=new PannerNode(de,{distanceModel:"linear",positionX:t.x,positionY:t.y,positionZ:t.z,maxDistance:60,rolloffFactor:40,coneOuterGain:.4});var e=pe(i);return e.connect(t).connect(de.destination),e}}function b(e){return()=>{var t=pe(e);return t.connect(de.destination),t}}function ge(t,e){return tt(44100*e,()=>t.push(0)),t}let Ae=navigator.userAgent.includes("fox")?b:ye,Ee=b(ge(B(.1,.65,986,.01,.03,.03,4,2.63,void 0,void 0,void 0,void 0,.25,6.8,void 0,void 0,.09,.14,.01),.3)),Te=b(B(.1,.65,1100,void 0,.03,.42,4,2.63,void 0,void 0,void 0,void 0,void 0,2.2,void 0,void 0,void 0,.14,.01)),Ce=Ae(B(.1,void 0,349,.57,.51,1,2,void 0,2.4,-2,void 0,.09,void 0,.4,void 0,void 0,.02,1.3,.72)),De=Ae(B(.05,0,50,.1,1.3,void 0,4,9,void 0,void 0,-10,.01,void 0,void 0,void 0,-.2,void 0,.87,1)),Fe=Ae(B(.2,.15,50,.34,.91,.31,void 0,.11,-1.9,-.9,20,3,.01,7.2,void 0,void 0,.15,1.01,1)),ze=b(B(void 0,0,146.8324,.3,.3,.9,void 0,.83,10.5,void 0,40,.3,-.01,void 0,void 0,.1,.2,void 0,.3)),Re=b(B(3,void 0,87.30706,.08,.41,1.41,1,.83,10.5,void 0,3,.5,-.01,.1,void 0,.1,.78,void 0,.11,.14)),Pe=b(B(1.09,void 0,152,.01,.08,1,void 0,2.19,void 0,void 0,void 0,void 0,.05,1.1,51,.2,.02,.86,.04)),Ie=(t=1)=>b(ge(B(t,0,50,.6,.1,1,void 0,.11,-.1,-.1,void 0,void 0,.18,void 0,void 0,void 0,.3,1.01,.5,.08),.8)),Le=b(B(3.2,0,276,void 0,2,void 0,void 0,.71,7.5,void 0,void 0,void 0,void 0,.1,-430,.5,.19,.2,.2)),Se=b(B(2.4,0,50,.01,.1,1,void 0,.11,-.1,-.1,void 0,void 0,.18,void 0,void 0,void 0,.31,.3,.5,.08)),Be=ye(B(1.65,void 0,57,.01,.09,.08,4,.11,void 0,void 0,void 0,void 0,.15,1.3,void 0,.2,.08,.72,.04)),be=(ce=[.25,.25,1,.25,.25,1,.25,.25,.25,.25,2],b([65.41,82.41,77.78,65.41,82.41,77.78,65.41,82.41,77.78,61.74,65.41].flatMap((t,e)=>B(void 0,0,t,.1,ce[e],.26,2,1.18,void 0,void 0,void 0,void 0,void 0,.2,void 0,void 0,.11,.38,.03))));class _e extends Dt{constructor(t,e,i=1,a=1,n,s){super(t),this.Ja=0,this.Ta=i,this.Ua=a,this.m.set(e.x-2*i,e.y,e.z),this.T[0].m.x=2*i,this.ua=new g(D(new P(s?6:4,7,1),e.x-(n?4:0),e.y,e.z),new l),this.ya=new g(D(new P(4,7,1).C(0,Math.PI/2),e.x-2*i,e.y,e.z-2*a),new l),n&&(t=this.ua,this.ua=this.ya,this.ya=t,this.Ja=this.F.y=90),this.Pa=Fe(e),this.Oa=Ce(e)}}function Ue(t){t.oa=!0,t.aa.start(),t.U.forEach(t=>{t.Pa.start(),t.Oa.start()})}class $e extends Dt{constructor(t,e,i=0){var a=new g(R(new P(1,2,1)),d),n=new g(E(F(z(new P(1,1,4,3,3),.25,"z"),D(z(new P(3,1,1,1,3,3),.25,"x"),0,0,2)),!0),M);super(a,n),this.U=[],this.H=this.oa=!1,this.U=e,this.La=t,this.m.set(t),this.F.y=i,n.F.x=-45,this.ha=e.flatMap(t=>t.ua),this.na=e.flatMap(t=>t.ya),this.Na=Me(me(this.ha)).ba,this.Sa=Me(me(this.na)).ba,this.aa=De(t)}update(){this.oa&&!this.H&&this.U.forEach(t=>{t.F.y+=t.Ua*t.Ta*.6,this.T[1].F.x+=1/this.U.length*.6,90<=Math.abs(t.F.y)-t.Ja&&(this.H=!0)})}}function Ge(){return new g(R(T(D(C(new P(.5,.5,2,2,2),t=>0<t.z&&0===t.x),0,0,1).o(1,0,1))),M)}function Ne(){var t,e=()=>A(D(T(C(z(new P(2,.5,2,3,1,3),.08),t=>0<t.y).o(0,1,0)),0,.3,.53).C(.2),3,new Float32Array(Ft(9,9,ut.i)),1);return(e=new g(T(E(F(F(zt(C(C((Pt(t=new P(1,1,1,6,6,6),t=>{s(t).o(.8)}),t.o(1,1.3,.8)),t=>.7<t.y).o(3,1,1),t=>.8<t.y).o(1.5,8,2),d.i,d.i,d.i,d.i,ht.i,ht.i),D(e(),-.2)),D(e(),.2)),!0)).C(Math.PI),ht)).m.set(0,54,2),e}function Oe(){return R(D(T(D(C(new P(3,.5,7.5,1,1,2),t=>0===t.z),0,0,-1).o(1.5)),0,-.2,9))}function je(){function t(t=1){return R(D(T(D(C(new P(.5,2,7.5,1,1,2),t=>0===t.z),t,0,-1)),1.5*t,.4,9))}function e(e=!1){return R(D(T(C(new P(3,2,.5),t=>0<(e?-t.z:t.z)).o(1.17)),0,.4,e?13:5))}return E(F(F(F(F(t(-1),t()),e()),e(!0)),Oe()))}function He(){return new g(D(new I([.25,...bt([.5,.1],11),.25],7,bt([7,1],13),bt([0,1],13),0,.15),0,-3.5),ut)}function Ke(t=!1,e=4,i=7){i=zt(new P(e,i,1),M.i,M.i,M.i,M.i,st.i,st.i);var a=R(zt(D(new P(e+.05,.5,1.2),0,4===e?2.5:5),d.i,d.i,d.i,d.i,d.i,d.i)),n=(e=R(zt(D(new P(e+.05,.5,1.2),0,4===e?-2.5:-1),d.i,d.i,d.i,d.i,d.i,d.i)),D(zt(new P(1,1,1.2),ct.i,ct.i,ct.i,ct.i,ft.i,ft.i),-1.4));return F(F(i,a),e),t&&F(i,n),new g(i,new l)}function Xe(){return[new $e(new y(42,36,-60),[new _e(He(),new y(53,36.5,-49))],-90),new $e(new y(57,24,42),[new _e(Ke(),new y(-2,24.5,-15)),new _e(Ke(),new y(2,24.5,-15),-1,1),new _e(Ke(),new y(53,24.5,47),-1,-1)],-90),new $e(new y(23,0,37.5),[new _e(Ke(!0),new y(23,24.5,37.5),-1)]),new $e(new y(3,58,-12),[new _e(Ke(!1,6,15),new y(-3,24,-60),1,1,!1,!0),new _e(Ke(!1,6,15),new y(3,24,-60),-1,1,!1,!0)]),new $e(new y(-11,36,50),[new _e(He(),new y(-25,36,61.5),1,1,!0)],-90)]}function ke(i,e){var t=E(R(T(Pt(C(R(E(Pt(new P(64,1,64,31,0,31,1),(t,e)=>{t.y=i[e]}))),t=>t.z<=20),t=>t.z-=e?0:Math.abs(t.x)/3)),60,12,.5,.18).o(e?.5:.05,e?2:1,.2).C(e?0:-Math.PI/2,e?Math.PI/2:0),!0),a=t.K.map(t=>(!e&&t.y<-2.6&&-5<t.y?xt:wt).i.id);return A(t,3,new Float32Array(a),1),t}function Ye(t){return new g(F(F(D(ke(t),18,32,-16.6),D(ke(t),-18,32,-16.6)),D(ke(t,!0),0,21.7,8)),wt)}function Ve(){return new g(E(D(F(R(z(new P(3,3,2,12,12,1),1.1,"z"),40,40),D(T(z(Rt(D(z(C(F(F(R(D(new P(3,.5,2,8,1,1),0,1.25),40,40),R(D(new P(.4,1,2,1,8,1),-1.3,.5),40,40)),R(D(new P(.4,1,2,1,8,1),1.3,.5),40,40)),t=>Math.abs(t.y)<=1&&Math.abs(t.x)<=1.2),1,"z",new y(0,-1,0)),0,-.2)),1.2,"z")),0,-2.3)).o(3,3),0,35,30),!0),ut)}function Je(t,e){var i,a=[];for(i of t){var{x:n,z:s}=i.points[0],{x:r,z:o}=i.points[1],{x:h,z:l}=i.points[2];(s-e.z)*(r-n)-(n-e.x)*(o-s)<0||(o-e.z)*(h-r)-(r-e.x)*(l-o)<0||(l-e.z)*(n-h)-(h-e.x)*(s-l)<0||(t=-(e.x*i.L.x+i.L.z*e.z+i.Ia)/i.L.y,e.y-(t+-3)<0)||a.push({height:t,floor:i})}return a.sort((t,e)=>e.height-t.height)[0]}function We(t,s){var r,e=t.G,o=0,h=0,l=[],c=0,{x:u,z:f}=e,w=e.y+1.1;for(r of s)if(!(w<r.Qa||r.Va<w||(s=H(r.L,e)+r.Ia)<-1.5||1.5<s)){let t=(x=r.L.x<-.707||.707<r.L.x)?-f:u,e=x?r.L.x:r.L.z,i=-r.points[0].z,a=-r.points[1].z,n=-r.points[2].z;x||(i=r.points[0].x,a=r.points[1].x,n=r.points[2].x);var x=r.points[0].y,v=r.points[1].y,m=r.points[2].y;0<((x-w)*(a-i)-(i-t)*(v-x))*(e=0<e?1:-1)||0<((v-w)*(n-a)-(a-t)*(m-v))*e||0<((m-w)*(i-n)-(n-t)*(x-m))*e||(o+=r.L.x*(1.5-s),h+=r.L.z*(1.5-s),l.push(r),c++)}t.G.x+=o,t.G.z+=h,0<c&&(t.J.x=0,t.J.z=0)}class Ze{constructor(t){this.l=!1,this.G=new y(0,0,0),this.J=new y(0,0,0),this.isFrozen=!1,this.h=new y(0,0,0),this.H=this.B=!0,this.G.set(44,21,-26),this.u=t,this.j=de.listener,this.g=Ee(),this.g.loop=!0,this.g.playbackRate.value=0,this.g.start(),r.B=t=>{this.h.x+=-.002*t.y,this.h.y+=-.002*t.x,this.h.x=Math.min(Math.max(this.h.x,-Math.PI/2),Math.PI/2),this.h.y%=2*Math.PI}}update(t){var e,i;this.isFrozen||(e=Math.sin(this.h.y)*r.h.y,i=Math.sin(this.h.y+Math.PI/2)*r.h.x,this.J.z=Math.cos(this.h.y)*r.h.y+Math.cos(this.h.y+Math.PI/2)*r.h.x,this.J.x=e+i,e=this.J.y,s(this.J).o(.18),this.J.y=e),!this.l&&0<this.J.ga?this.H&&(this.g.stop(),this.g=(21===this.G.y?Ee:Te)(),this.g.loop=!0,this.g.start(),this.H=!1):(this.H=!0,this.g.loop=!1),this.J.y-=.003,this.G.D(this.J),We(this,(t=t[this.G.x<0?0:1]).ba),(t=Je(t.fa,this.G))&&0<(e=t.height-this.G.y)?(this.G.y+=e,this.J.y=0,this.B&&21<t.height&&(this.g.stop(),this.g=(21===t.height?Ee:Te)(),this.g.loop=!0,this.g.start(),this.B=!1),this.B||21!==t.height||(this.g.stop(),this.g=(21===t.height?Ee:Te)(),this.g.loop=!0,this.g.start(),this.B=!0),this.l=!1):this.l=!0,this.u.m.set(this.G),this.u.m.y+=3.5,At(this.u,...K(this.h)),Et(this.u),this.j.positionX&&(this.j.positionX.value=this.u.m.x,this.j.positionY.value=this.u.m.y,this.j.positionZ.value=this.u.m.z,t=new y(0,0,-1),t=this.u.N.transformPoint(t),this.j.forwardX.value=t.x,this.j.forwardY.value=t.y,this.j.forwardZ.value=t.z)}}function qe(e){e.Ba.forEach(t=>t.check(e.g.u.m,e.g.u.F))}class Qe{constructor(){this.V=[],this.h=[],this.aa=Ge(),this.Ca=!1,this.key=new g(D(F(z(new P(1,1,.5,1,3),1,"z"),D(new I([1,.5,.5,.5],1,[.25,1,.25,1],[0],0,.5),2,-.75)).o(.5,.5,.5).C(0,Math.PI/2),-32,36,60),ct),this.l=Ne(),this.ha=this.ra=this.Da=!1,this.sa=0,this.B=new g(D(Oe(),0,56.35,-9),M),this.H=new g(D(new P(3,1,3),0,55.95,-.5),lt),this.Ma=new y,this.na=this.ta=0,this.Fa=!1,this.Ea=0,this.Ba=[new t(new y(41,21,42),()=>(Re().start(),!0),new y(11,-90)),new t(new y(0,58,8),()=>(Ie()().start(),!0)),new t(new y(-51,24,-65),()=>(tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 250px; text-shadow: 1px 1px 20px"},"GOT STAKE",40)),Pe().start(),this.Ca=!0,this.aa.m.y=-50,setTimeout(()=>tmpl.innerHTML="",3e3),!0),void 0,3),new t(new y(-32,36,60.5),()=>(tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 250px; text-shadow: 1px 1px 20px"},"GOT KEY",40)),Pe().start(),this.key.m.y=-50,this.h[2].La.y=24,setTimeout(()=>tmpl.innerHTML="",3e3),!0),void 0,4),new t(new y(0,58.5,-1),()=>{var t=new DOMPoint(0,0,-1);if(H((new y).set(this.g.u.N.transformPoint(t)),(new y).set(this.l.N.transformPoint(t)))<-.7&&r.j){if(this.Ca)return Be(this.l.m).start(),tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 250px; text-shadow: 1px 1px 20px"},"UPYRI KILLED",40)),this.aa.m.set(0,57,-.5),At(this.aa,Math.PI/2,0,0),this.ra=this.Da=!0,setTimeout(()=>tmpl.innerHTML="",3e3),!0;tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 250px; text-shadow: 1px 1px 20px"},"NEED STAKE",40)),setTimeout(()=>tmpl.innerHTML="",3e3)}},void 0,7),new t(new y(0,58.5,0),()=>{if(!this.Da&&this.h[3].oa){this.ta++,this.l.m.y=61,this.B.m.y=-1,this.B.m.x=-5.5,this.B.F.y=25,this.ia||(Be(new y(-7,58,-3)).start(),this.ia=!0);var t=new DOMPoint(0,0,-1);if(H((new y).set(this.g.u.N.transformPoint(t)),(new y).set(this.l.N.transformPoint(t)))<-.7||240<this.ta||10<this.g.u.m.z)return setTimeout(()=>{Le().start(),Se().start(),this.ha=!0},500),!0}},void 0,12),new t(new y(0,24.5,-72),()=>(tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 250px; text-shadow: 1px 1px 20px"},"ESCAPED",40)),this.Fa=!0,this.g.isFrozen=!0,this.g.J.set(0,0,-.1),setTimeout(()=>{tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 160px; text-shadow: 1px 1px 20px"},"THANKS FOR PLAYING",40))},3e3),!0),void 0,6),new t(new y(32,24,-40),()=>(ze().start(),!0),new y(28,-15),8),new t(new y(44,21,-26),()=>(setTimeout(()=>{tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 160px; text-shadow: 1px 1px 20px"},"ESCAPE THE CASTLE",40)),setTimeout(()=>tmpl.innerHTML="",5e3)},2e3),!0)),new t(new y(15,48,48),()=>(be().start(),!0))],this.ia=!1,this.j=new Vt,this.h=Xe()}async wa(){function t(t,e,i){return i.indexOf(t)===e}var e=new Jt(500);this.g=new Ze(e);let i=await gt();var e=new g(R(E(Pt(new P(1024,1,1024,255,0,255,1),(t,e)=>{t.y=i[e]}))),at),a=new g(D(new P(1024,1,1024,4,0,4,1),0,20.5),at),n=new g(_t,nt),s=new g(D(new P(1,6,6).C(.2),57.4,26,43),rt),r=new g(D(new P(1,6,6).C(.2),47.4,24,42),ot),o=new g(D(je(),0,55,-9),M),h=new g(D(new P(18,1,65),0,20.5,-125),st),l=(this.H.o.set(0,1,0),this.aa.m.set(-51,21.5,-65),At(this.aa,0,-1,0),this.h.flatMap(t=>t.U)),c=(a=Me(me([a,n,o,this.B])),await yt(1,!0));a.fa.forEach(e=>{e.points.map(t=>t.x<0?0:1).filter(t).forEach(t=>{this.V[t]||(this.V[t]={fa:[],ba:[]}),this.V[t].fa.push(e)})}),a.ba.forEach(e=>{e.points.map(t=>t.x<0?0:1).filter(t).forEach(t=>{this.V[t]||(this.V[t]={fa:[],ba:[]}),this.V[t].ba.push(e)})}),this.j.D(s,r,e,n,...this.h,...l,this.aa,this.key,this.l,o,this.B,this.H,h,Ye(c),Ve()),this.j.la=new Yt(...vt),It(this.j.la),tmpl.innerHTML="",tmpl.addEventListener("click",()=>{tmpl.requestPointerLock()}),this.g.h.set(0,90,0)}xa(){this.g.update(this.V),we(this.g.u,this.j),qe(this),this.h.forEach(t=>{t.oa?We(this.g,t.Sa):(N(this.Ma,this.g.u.m,t.La).ga<7&&r.j&&Ue(t),We(this.g,t.Na)),t.update()}),Ct(this.l,this.g.u.m),Et(this.j),this.Fa&&(this.Ea++,1800<this.Ea)&&(tmpl.style.backgroundColor=`rgba(0, 0, 0, ${this.na})`,this.na+=.004),this.ra&&(this.H.o.x+=.03,this.H.o.z+=.03,1<=this.H.o.x)&&(this.ra=!1),this.ha&&(c3d.style.filter="blur(9px) brightness(0.8)",X(this.l.m,this.g.u.m),this.sa++,30<this.sa)&&(tmpl.style.backgroundColor="rgb(0, 0, 0)",this.ha=!1,setTimeout(()=>{c3d.style.filter="",tmpl.style.backgroundColor="",this.l.m.set(0,54,2),this.ha=!1,this.sa=this.ta=0,this.B.m.set(0,0,0),this.B.F.y=0,this.ia=!1,this.g.G.set(0,49,22),this.Ba[5].va=!1,this.j.j(this.h[3]),this.j.j(this.h[3].U[0]),this.j.j(this.h[3].U[1]),this.h[3]=Xe()[3],this.j.D(this.h[3]),this.j.D(this.h[3].U[0]),this.j.D(this.h[3].U[1]),tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 150px; text-shadow: 1px 1px 20px"},"YOU WOKE UPYRI",40)),setTimeout(()=>{tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:"90%",style:"font-size: 150px; text-shadow: 1px 1px 20px"},"KILL HIM IN HIS COFFIN",40)),setTimeout(()=>tmpl.innerHTML="",3e3)},3e3)},4e3))}}class t{constructor(t,e,i,a=6){this.l=t,this.h=e,this.g=i,this.j=a,this.va=!1}check(t,e){!this.va&&N(new y,t,this.l).ga<this.j&&((t=this.g?N(new y,e,this.g).ga%360:0)<20||340<t)&&(this.va=this.h())}}class ti{constructor(){this.l=be(),this.j=Ie(.6)(),this.B=!1,this.g=new y,this.u=new Jt(600),this.u.m.y=32,this.u.m.z=120,this.h=new Vt}async wa(){let i=await gt(),t=new g(R(E(Pt(new P(1024,1,1024,255,0,255,1),(t,e)=>{t.y=i[e]}))),at),e=new g(_t,nt),a=new g(D(new P(18,1,65),0,20.5,-125),st),n=await yt(1,!0);this.h.D(t,e,a,...Xe().flatMap(t=>t.U),Ye(n),Ve()),this.h.la=new Yt(...vt),Et(this.h),It(this.h.la),tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},p({x:"50%",y:300},"UPYRI"),V({x:"50%",y:900,A:"Start"},"Start"),V({x:"50%",y:1010,A:"Fullscreen"},"Fullscreen")),tmpl.querySelectorAll("feTurbulence").forEach(t=>{t.innerHTML='<animate attributeName="baseFrequency" values="0.13 0.08;0.13 0.007" dur="80s" repeatCount="indefinite" />'}),Start.onclick=()=>{this.j.stop(),this.l.stop(),Pe().start(),tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},`<rect ${u({x:0,y:0,s:"100%",v:"100%"})}/>`,p({x:"50%",y:"52%",style:"font-size: 200px; text-shadow: 1px 1px 20px"},"LOADING",40)),setTimeout(()=>_(),10)},Fullscreen.onclick=()=>{document.fullscreenElement?document.exitFullscreen():document.documentElement.requestFullscreen()},this.B||(this.l.loop=!0,this.l.start(),this.j.loop=!0,this.j.start(de.currentTime+2),this.B=!0)}xa(){we(this.u,this.h),this.g.x-=.0015,this.g.y-=.003,this.g.z-=.0015,this.u.m.x=125*Math.cos(this.g.x),this.u.m.y=35*Math.cos(this.g.y)+50,this.u.m.z=125*Math.sin(this.g.z),Ct(this.u,new y(.1,31,.1)),Et(this.u)}Ra(){this.u=this.h=void 0}}let ei=0;function ii(t){var e,i,a,n=t-ei;1e3/60<=n&&(ei=t-n%(1e3/60),t=r.g.get("KeyA")||r.g.get("ArrowLeft")?-1:0,e=r.g.get("KeyD")||r.g.get("ArrowRight")?1:0,i=r.g.get("KeyW")||r.g.get("ArrowUp")?-1:0,a=r.g.get("KeyS")||r.g.get("ArrowDown")?1:0,r.h.x=t+e,r.h.y=i+a,r.j=r.g.get("KeyE"),$.g.xa(n)),requestAnimationFrame(ii)}tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},`<rect ${u({x:0,y:0,s:"100%",v:"100%"})}/>`,p({x:"50%",y:"52%",style:"font-size: 200px; text-shadow: 1px 1px 20px"},"CLICK TO START",40)),document.onclick=async()=>{tmpl.innerHTML=o({viewBox:"0 0 1920 1080"},`<rect ${u({x:0,y:0,s:"100%",v:"100%"})}/>`,p({x:"50%",y:"52%",style:"font-size: 200px; text-shadow: 1px 1px 20px"},"LOADING",40)),at=new l({i:i(a,await n(o({s:512,v:512},c(m({A:"n"}),f({da:3,O:"fractalNoise",I:.04,M:4,ea:"stitch"}),Z(w("R","table",[.2,.2]),w("G","table",[.2,.2]),w("B","table",[.25,.25]))),`<rect ${u(m({fill:"#181818"}))}/>`,`<rect ${u(m({filter:"n"}))}/>`)))}),(nt=new l({i:i(a,await Mt(!0,!0))})).i?.za.set(1.5,1.5),M=new l({i:i(a,await Mt(!1,!1))}),st=new l({i:i(a,await Mt(!1,!0))}),rt=new l({i:i(a,await n(o({s:512,v:512},p({x:10,y:"30%",style:"font-size: 120px; transform: scaleY(1.5); font-family: sans-serif"},"KEEP",30)))),Y:!0,$:[.5,.5,.5,.5]}),ot=new l({i:i(a,await n(o({s:512,v:512},p({x:10,y:"30%",style:"font-size: 120px; transform: scaleY(1.5); font-family: sans-serif"},"üñêÔ∏è",50)))),Y:!0,$:[.5,.5,.5,.5]}),ht=new l({i:i(a,await n(o({s:512,v:512,style:"filter: invert()",viewBox:"0 0 512 512"},c({A:"filter",x:"-0.01%",primitiveUnits:"objectBoundingBox",s:"100%",v:"100%"},f({da:7,O:"fractalNoise",I:.005,M:5,result:"n"}),`<feComposite ${u({ja:"SourceAlpha",operator:"in"})} />`,`<feDisplacementMap ${u({in2:"n",o:.9})} />`),`<rect ${u(m({A:"l",filter:"filter",y:-14}))}/>`,`<rect ${u({fill:"#fff",s:"100%",v:"100%"})}/>`,'\n    <use href="#l" x="22%" y="42" transform="scale(2.2, 1.2)"></use>\n    <use href="#l" x="-22%" y="42" transform="rotate(.1) scale(-2.2 1.2)"></use>',`<rect ${u({fill:"#777",x:220,y:230,s:50,v:50})}/>`)))}),lt=new l({i:i(a,await n(o({s:512,v:512},dt(e({cx:256,cy:256,rx:220,ry:220,filter:"d"}),250,[.03,.03])))),Y:!0}),ct=new l({i:i(a,await yt(0)),$:[.7,.7,.7,.7]}),ut=new l({i:i(a,await yt(1))}),d=new l({i:i(a,await yt(2))}),ft=new l({i:i(a,await n(o({s:512,v:512},c({A:"b"},f({I:[.1,.004],M:1,O:"fractalNoise"}),`<feColorMatrix ${u({values:pt[0]})}/>`),`<rect ${u(m({filter:"b"}))}/>`,e({cx:256,cy:170,rx:100,ry:100,fill:"#000"}),`<rect ${u({x:216,y:260,s:80,v:160})}/>`)))}),wt=new l({i:i(a,await n(o({s:512,v:512},`<rect ${u(m({fill:"#460c0c"}))}/>`)))}),xt=new l({i:i(a,await n(o({s:512,v:512},`<rect ${u(m({fill:"#460c0c"}))}/>`,e({cx:256,cy:128,ry:128,rx:128,fill:"#ce9b3c"}),e({cx:256,cy:384,ry:128,rx:128,fill:"#ce9b3c"}),e({cx:256,cy:448,ry:128,rx:128,fill:"#460c0c"}))))}),t=[await(t=function(){var t={s:8192,v:2048,style:"background: #000;"},e=[function(){let n=[2,4],s=[6,6],r=[.005,.003],o=[160,820],h=[800,0],l=[[0,0,.6],[0,0,1.5]],t=tt(2,t=>{var e=c(m({A:"f"+t}),f({da:n[t],O:"fractalNoise",M:s[t],I:r[t],ea:"stitch"}),Z(w("R","table",[.2,.2]),w("G","table",[.2,.2]),w("B","table",[.25,.25]),w("A","table",l[t]))),i={A:"g"+t,gradientTransform:"rotate(90)"},a=[`<stop ${u({P:0,R:"black"})} />`,`<stop ${u({P:.3,R:"white"})} />`,`<stop ${u({P:.7,R:"white"})} />`,`<stop ${u({P:1,R:"black"})} />`];return e+`<linearGradient ${u(i)}>${a.join("")}</linearGradient>`+W({A:"m"+t},`<rect ${u({x:0,y:h[t],s:8192,v:o[t],fill:`url(#g${t})`})}/>`)+`<rect ${u({filter:"f"+t,v:o[t],s:8192,x:0,y:h[t],Ha:`url(#m${t})`})}/>`}).join("");return mt()+`<rect ${u(m({filter:"s"}))}/>`+t}(),c({A:"f",x:0,s:"100%",v:"150%"},f({O:"fractalNoise",I:[.008,0],M:4,da:15,ea:"stitch"}),`<feDisplacementMap ${u({ja:"SourceGraphic",o:100})} />`)+c({A:"g",x:0,s:"100%"},f({I:[.02,.01],M:4,O:"fractalNoise",result:"n",da:15,ea:"stitch"}),q({ja:"n",Ga:"#1c1d2d",surfaceScale:22},'<feDistantLight azimuth="45" elevation="60"/>'),`<feComposite ${u({in2:"SourceGraphic",operator:"in"})} />`)+Y({filter:"g"},`<rect ${u({x:0,y:1e3,s:8192,v:"50%",filter:"f"})}/>`)];let i=0,a=new OffscreenCanvas(2048,2048).getContext("2d");return async()=>(a.drawImage(await n(o(t,...e)),i,0),i-=2048,a.getImageData(0,0,2048,2048))}())(),await t(),await t(),await t()],vt=[t[3],t[1],await n(o({s:2048,v:2048,style:"background: #000;"},mt()+c(m({A:"f"}),f({da:2,O:"fractalNoise",M:6,I:.003,ea:"stitch"}),Z(w("R","table",[.8,.8]),w("G","table",[.8,.8]),w("B","table",[1,1]),w("A","table",[0,0,1])))+W({A:"mask"},J({A:"g"},`<stop ${u({P:"20%",R:"white"})} />`,`<stop ${u({P:"30%",R:"#666"})} />`,`<stop ${u({P:"100%",R:"black"})} />`),e({cx:1e3,cy:1e3,rx:"50%",ry:"50%",fill:"url(#g)"}))+J({A:"l"},`<stop ${u({P:"10%",R:"#fff"})} />`,`<stop ${u({P:"30%",R:"#0000"})} />`)+`<rect ${u(m({filter:"s"}))}/>`+e({cx:1e3,cy:1e3,rx:200,ry:200,fill:"url(#l)"})+`<rect ${u(m({filter:"f",Ha:"url(#mask)"}))}/>`)),t[0],t[2],t[0]],t=a,v.activeTexture(v.TEXTURE0),v.bindTexture(v.TEXTURE_2D_ARRAY,v.createTexture()),v.texStorage3D(v.TEXTURE_2D_ARRAY,8,v.RGBA8,512,512,t.g.length),t.g.forEach((t,e)=>{v.texSubImage3D(v.TEXTURE_2D_ARRAY,0,0,0,e,512,512,1,v.RGBA,v.UNSIGNED_BYTE,t.source)}),await!v.generateMipmap(v.TEXTURE_2D_ARRAY),_t=D(F(F(F(F(F(F(F(F(F(F(jt(-60,!0),E(D(F(F(Kt(Nt),kt()),D(S(5,0,0).C(Math.PI/2,-1,0),-20,1,13)),53,0,-60))),D(F(Kt($t),Ot(L($t[0][2][0]),L($t[0][0][0]))),-53,0,-60)),D(F(F(E(Kt(Nt,!0).o(-1,1,-1),!0),kt(!0,!0).C(0,-Math.PI/2)),Ot(L(Nt[0][2][0]),L(Nt[0][0][0]),!0,!0)),-53,0,60)),D(F(F(E(Kt(Gt,!0).C(0,Math.PI),!0),kt(!0,!0).C(0,-Math.PI/4)),Ot(L(Gt[0][2][0]),L(Gt[0][0][0]),!0,!0)),53,0,60)),jt(60)),Ht(-53)),Ht(53)),E(D(F(F(F(F(F(F(F(F(F(F(F(F(F(F(F(F(Kt(Ut([[["w","M","A"],["TCCICCT","MCMFMCM","ADAAADA"],["SCICICICS","MEMEMEMEM","ADADADADA"],["SCICICICS","MEMEMEMEM","ADADADADA"]],[["DMh","MGM","ACA"],["PCFCGCFCP","MDMDMDMDM","ADADADADA"],["SCICICICS","MEMEMEMEM","ADADADADA"],["SCICICICS","MEMEMEMEM","ADADADADA"]]])),R(D(new P(22,12,24),0,6,22))),D(new I([2.5,9,4,19,4,9,2.5],69,[69,5,69,7.5,69,50,69],[0,5,0,45,0,5,0],0,2).C(Math.PI/2),0,22.5,-34.5)),D(R(D(new P(9,2,38),-18,22.5,0)),0,0,1.5)),D(kt(!1,!1,!1).C(0,-Math.PI/2),16,.5,25)),F(R(D(T(D(C(new P(4,12,20),t=>0<t.y&&t.z<0),0,-12)),-18,6,16)),R(D(new P(14,12,8),-18,6,30)))),D(F(Kt(Ut([[["CSC","MBF","A"],["W","M","A"],["EQ","FM","A"],["U","M","A"]],[["W","M","A"],["W","M","A"],["BEP","MFM","A"],["U","M","A"]]])),kt(!1,!1,!1)),0,12,22)),D(F(T(D(C(Kt(Ut([[["W","M","A"],["KCK","MMM","A"],["U","M","A"],["U","M","A"]],[["JEJ","MFM","A"],["KCK","MHM","ABA"],["U","M","A"],["U","M","A"]]])),(t,e)=>263<e&&e<268),0,-1,0)),Ot(21,20)),0,22.5,-22)),D(kt(!1,!0,!1),-6.5,23,-5)),R(D(new P(10,24,12),16,10,23))),R(new P(53,.5,68))),R(E(D(z(new P(2,24,2,3,1,3),2),-10,11),!0))),R(E(D(z(new P(2,24,2,3,1,3),2),-10,11,-20),!0))),R(E(D(z(new P(2,24,2,3,1,3),2),10,11),!0))),R(E(D(z(new P(2,24,2,3,1,3),2),10,11,-20),!0))),R(D(new P(5,.8,1.5),18,18,-36))),R(D(new P(5,.8,1.5),-18,18,-36))),0,0,20))),R(D(z(new P(2,3,2,2,1,2),1.2),-32,13.1,59.5))),E(D(new I([1.5,4,1.5],8,[8,1,8],[0],0,.5).C(0,Math.PI/2),-27,11.5,59.5))),0,21);var t=new ti;$=new U(t),ii(0),document.onclick=null}</script>