<!DOCTYPE html><html> <head> <title>Snooffline</title> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, minimum-scale=1.0">
  <script>
     (function () {function a(){this.switch=0,this.buildings={color:"#4744FF",count:35,heights:[]},this.lineColor="#9B30FF"}a.prototype.init=function(t){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.canvas.width=t.canvas.width,this.canvas.height=t.canvas.height;for(var i=0;i<this.buildings.count;++i)this.buildings.heights.push(15+90*Math.random());this.renderStatic(t)},a.prototype.renderStatic=function(t){this.ctx.shadowBlur=10,this.ctx.shadowColor="white",this.drawBackground(t),this.drawCity(t),this.drawRoad(t)},a.prototype.render=function(t){t.ctx.drawImage(this.canvas,0,0),this.drawRoadLines(t),this.drawScore(t)},a.prototype.drawBackground=function(t){var i=t.geometry.environment;this.ctx.fillStyle="black",this.ctx.fillRect(0,0,i.width,i.height)},a.prototype.drawCity=function(t){this.ctx.strokeStyle=this.buildings.color;for(var i=0;i<this.buildings.count;++i)this.drawBuilding(t,30*i-5,this.buildings.heights[i],30),this.drawBuilding(t,33*i+5,this.buildings.heights[i]+10,30)},a.prototype.drawScore=function(t){this.ctx.shadowBlur=0,t.ctx.fillStyle=this.lineColor,t.ctx.font="22px monospace",t.ctx.textBaseline="middle",t.ctx.textAlign="center",t.ctx.fillText("-snooffline-",this.canvas.width/2,30),t.ctx.font="14px monospace",t.ctx.fillText("Total snooffed: "+(~~t.player.totalScore).toFixed(2)+"mg",this.canvas.width/2,60),t.ctx.fillText((25e-5*~~t.player.score).toFixed(2)+" mg/L",this.canvas.width/2,80);for(var i=1;i<t.config.scoreIncrementFactor;i++)t.ctx.drawImage(t.cache.heroin,this.canvas.width-25-25*i,this.canvas.height-50,40,40);var o=t.player.score/5;t.ctx.strokeStyle=this.lineColor,t.ctx.strokeRect(this.canvas.width/2-200,100,400,15),t.ctx.fillStyle="white",t.ctx.fillRect(this.canvas.width/2-200,100,o,15)},a.prototype.drawPause=function(t){t.ctx.fillStyle="black",t.ctx.fillRect(0,10,this.canvas.width,30),t.ctx.fillStyle=this.lineColor,t.ctx.font="22px monospace",t.ctx.fillText("-paused-press-P-to-continue-",this.canvas.width/2,30)},a.prototype.drawOverdose=function(t){t.ctx.fillStyle="black",t.ctx.fillRect(0,10,this.canvas.width,30),t.ctx.fillStyle=this.lineColor,t.ctx.font="22px monospace",t.ctx.fillText("-overdosed-press-R-to-restart-",this.canvas.width/2,30)},a.prototype.drawUnderdose=function(t){t.ctx.fillStyle="black",t.ctx.fillRect(0,10,this.canvas.width,30),t.ctx.fillStyle=this.lineColor,t.ctx.font="22px monospace",t.ctx.fillText("-depression-kicked-in-press-R-to-restart-",this.canvas.width/2,30)},a.prototype.drawBuilding=function(t,i,o,n){var e=t.geometry.environment,r=[i,e.horizontAtY,i,e.horizontAtY-o,i+n,e.horizontAtY-o,i+n,e.horizontAtY];for(this.ctx.beginPath(),this.ctx.moveTo(r[0],r[1]),item=2;item<r.length-1;item+=2)this.ctx.lineTo(r[item],r[item+1]);this.ctx.stroke()},a.prototype.drawRoad=function(t){var i=t.geometry.environment,o=this.ctx;o.shadowBlur=10,o.shadowColor="white",o.strokeStyle=this.lineColor,o.beginPath(),o.moveTo(0,t.canvas.height),o.lineTo(i.horizontLeft.x,i.horizontLeft.y);for(var n=0;n<63;++n){var e=n*(i.width/63),r=pointAtY(i.focalPoint,{x:e,y:i.horizontAtY},t.canvas.height).x;r=r<0?0:r>t.canvas.width?t.canvas.width:r,o.moveTo(e,i.horizontAtY),o.lineTo(r,pointAtX(i.focalPoint,{x:e,y:i.horizontAtY},r).y)}o.moveTo(t.canvas.width,t.canvas.height),o.lineTo(i.horizontRight.x,i.horizontRight.y),o.moveTo(0,i.horizontAtY),o.lineTo(t.canvas.width,i.horizontAtY),o.stroke()},a.prototype.drawRoadLines=function(t){t.ctx.save();var i=t.geometry.environment,o=t.time.now%20;t.ctx.shadowBlur=10,t.ctx.shadowColor="white",t.ctx.strokeStyle=this.lineColor,t.ctx.beginPath();for(var n=0;n<20;++n){var e=i.horizontAtY+20*n+o,r=pointAtY(i.focalPoint,i.bottomLeft,e),a=pointAtY(i.focalPoint,i.bottomRight,e);t.ctx.moveTo(r.x,r.y),t.ctx.lineTo(a.x,a.y)}t.ctx.stroke(),t.ctx.restore()},window.Environment=a;!function(t,e,a){function o(t){t&&(t.setTargetAtTime||(t.setTargetAtTime=t.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var t=this.internal_createGain();return o(t.gain),t},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(t){var e=t?this.internal_createDelay(t):this.internal_createDelay();return o(e.delayTime),e},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var t=this.internal_createBufferSource();return t.start?(t.internal_start=t.start,t.start=function(e,a,o){void 0!==o?t.internal_start(e||0,a,o):t.internal_start(e||0,a||0)}):t.start=function(t,e,a){e||a?this.noteGrainOn(t||0,e,a):this.noteOn(t||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(t){this.noteOff(t||0)},o(t.playbackRate),t},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var t=this.internal_createDynamicsCompressor();return o(t.threshold),o(t.knee),o(t.ratio),o(t.reduction),o(t.attack),o(t.release),t},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var t=this.internal_createBiquadFilter();return o(t.frequency),o(t.detune),o(t.Q),o(t.gain),t},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var t=this.internal_createOscillator();return t.start?(t.internal_start=t.start,t.start=function(e){t.internal_start(e||0)}):t.start=function(t){this.noteOn(t||0)},t.stop?(t.internal_stop=t.stop,t.stop=function(e){t.internal_stop(e||0)}):t.stop=function(t){this.noteOff(t||0)},t.setPeriodicWave||(t.setPeriodicWave=t.setWaveTable),o(t.frequency),o(t.detune),t})),window.hasOwnProperty("webkitOfflineAudioContext")&&!window.hasOwnProperty("OfflineAudioContext")&&(window.OfflineAudioContext=webkitOfflineAudioContext)}(window);var b=new AudioContext;window.soundEffect=function(t,e,a,o,r,n,i,c,u,s,p,d,l,$){var v,y,x,f;void 0===t&&(t=200),void 0===e&&(e=0),void 0===a&&(a=1),void 0===o&&(o="sine"),void 0===r&&(r=1),void 0===n&&(n=0),void 0===i&&(i=0),void 0===c&&(c=0),void 0===u&&(u=!1),void 0===s&&(s=0),void 0===p&&(p=0),void 0===d&&(d=void 0),void 0===l&&(l=void 0),void 0===$&&($=void 0),v=b.createOscillator(),y=b.createGain(),x=b.createStereoPanner?b.createStereoPanner():b.createPanner(),v.connect(y),y.connect(x),x.connect(b.destination),y.gain.value=r,b.createStereoPanner?x.pan.value=n:x.setPosition(n,0,1-Math.abs(n)),v.type=o;var w,A;function C(t){t.gain.value=0,t.gain.linearRampToValueAtTime(0,b.currentTime+i),t.gain.linearRampToValueAtTime(r,b.currentTime+i+e)}function m(t){t.gain.linearRampToValueAtTime(r,b.currentTime+e+i),t.gain.linearRampToValueAtTime(0,b.currentTime+i+e+a)}function h(t){var o=t.frequency.value;u?(t.frequency.linearRampToValueAtTime(o,b.currentTime+i),t.frequency.linearRampToValueAtTime(o+c,b.currentTime+i+e+a)):(t.frequency.linearRampToValueAtTime(o,b.currentTime+i),t.frequency.linearRampToValueAtTime(o-c,b.currentTime+i+e+a))}function T(t){t.start(b.currentTime+i),t.stop(b.currentTime+i+1)}s>0?(w=t-s/2,A=t+s/2,f=Math.floor(Math.random()*(A-w+1))+w):f=t,v.frequency.value=f,e>0&&C(y),m(y),c>0&&h(v),p>0&&function(){var t=b.createOscillator(),o=b.createOscillator(),n=b.createGain(),i=b.createGain();n.gain.value=r,i.gain.value=r,t.connect(n),n.connect(b.destination),o.connect(i),i.connect(b.destination),t.type="sawtooth",o.type="sawtooth",t.frequency.value=f+p,o.frequency.value=f-p,e>0&&(C(n),C(i));a>0&&(m(n),m(i));c>0&&(h(t),h(o));d&&(addEcho(n),addEcho(i));l&&(addReverb(n),addReverb(i));T(t),T(o)}(),T(v)};window.midiTable=[8.1757989156,8.661957218,9.1770239974,9.7227182413,10.3008611535,10.9133822323,11.5623257097,12.2498573744,12.9782717994,13.75,14.5676175474,15.4338531643,16.3515978313,17.3239144361,18.3540479948,19.4454364826,20.6017223071,21.8267644646,23.1246514195,24.4997147489,25.9565435987,27.5,29.1352350949,30.8677063285,32.7031956626,34.6478288721,36.7080959897,38.8908729653,41.2034446141,43.6535289291,46.249302839,48.9994294977,51.9130871975,55,58.2704701898,61.735412657,65.4063913251,69.2956577442,73.4161919794,77.7817459305,82.4068892282,87.3070578583,92.4986056779,97.9988589954,103.826174395,110,116.5409403795,123.470825314,130.8127826503,138.5913154884,146.8323839587,155.563491861,164.8137784564,174.6141157165,184.9972113558,195.9977179909,207.65234879,220,233.081880759,246.9416506281,261.6255653006,277.1826309769,293.6647679174,311.1269837221,329.6275569129,349.228231433,369.9944227116,391.9954359817,415.3046975799,440,466.1637615181,493.8833012561,523.2511306012,554.3652619537,587.3295358348,622.2539674442,659.2551138257,698.456462866,739.9888454233,783.9908719635,830.6093951599,880,932.3275230362,987.7666025122,1046.5022612024,1108.7305239075,1174.6590716696,1244.5079348883,1318.5102276515,1396.912925732,1479.9776908465,1567.981743927,1661.2187903198,1760,1864.6550460724,1975.5332050245,2093.0045224048,2217.461047815,2349.3181433393,2489.0158697766,2637.020455303,2793.825851464,2959.9553816931,3135.963487854,3322.4375806396,3520,3729.3100921447,3951.066410049,4186.0090448096,4434.92209563,4698.6362866785,4978.0317395533,5274.0409106059,5587.6517029281,5919.9107633862,6271.926975708,6644.8751612791,7040,7458.6201842894,7902.132820098,8372.0180896192,8869.8441912599,9397.272573357,9956.0634791066,10548.0818212118,11175.3034058561,11839.8215267723,12543.853951416];window.ENUMS={SPACE:32,LEFT:37,UP:38,RIGHT:39,DOWN:40,PAUSE:19,P:80,RESTART:82};window.collision=function(n,x){var i=n.x-x.x,r=n.y-x.y,t=n.radius+x.radius;return i*i+r*r<=t*t},window.pointAtY=function(n,x,i){if(n.x-x.x==0)return{x:n.x,y:i};var r=(n.y-x.y)/(n.x-x.x);return{x:(i-(n.y-r*n.x))/r,y:i}},window.pointAtX=function(n,x,i){var r=(n.y-x.y)/(n.x-x.x);return{x:i,y:i*r+(n.y-r*n.x)}};function j(e){var t=document.createElement("canvas"),i=t.getContext("2d");t.width=6,t.height=3;var a=i.createImageData(t.width,t.height);return setPixel(a,2,0,255,255,255,255),setPixel(a,3,0,255,255,255,255),setPixel(a,1,1,255,255,255,255),setPixel(a,2,1,255,255,255,255),setPixel(a,3,1,255,255,255,255),setPixel(a,4,1,255,255,255,255),setPixel(a,0,2,255,255,255,255),setPixel(a,1,2,255,255,255,255),setPixel(a,2,2,255,255,255,255),setPixel(a,3,2,255,255,255,255),setPixel(a,4,2,255,255,255,255),setPixel(a,5,2,255,255,255,255),i.putImageData(a,0,0),t}window.drawCocaine=j;function i(){var e=this;this.pressed={},this.isDown=function(n){return e.controls.pressed[n]},this.onKeydown=function(n){e.pressed[n.keyCode]=!0},this.onKeyup=function(n){delete e.pressed[n.keyCode]}}i.prototype.init=function(e){var n=this;window.addEventListener("keyup",function(e){e.keyCode!==ENUMS.PAUSE&&e.keyCode!==ENUMS.P?e.keyCode!==ENUMS.RESTART?n.onKeyup(e):n.handleGameRestart():n.handleGamePause()},!1),window.addEventListener("keydown",function(e){n.onKeydown(e)},!1),this.handleGamePause=function(n){e.paused?e.sound.startMusic():e.sound.stopMusic(),e.paused=!e.paused},this.handleGameRestart=function(n){e.restartGame()}},window.Controls=i;function f(){this.x=null,this.y=null,this.velocityY=0,this.velocityX=0,this.acceleration=1,this.radius=5,this.score=1e3,this.totalScore=0,this.didJump=!1}f.prototype.init=function(t){this.y=t.geometry.player.y,this.x=t.geometry.player.x,this.radius=t.geometry.player.radius},f.prototype.render=function(t){var i=t.geometry.player;t.ctx.drawImage(t.cache.player,~~(this.x-5),~~(this.y-i.height+5),i.width,i.height)},f.prototype.incrementScore=function(t){this.didJump||(this.score+=t.config.scoreIncrementFactor,this.totalScore++),this.score>=t.config.scoreLimit&&t.hasOverdosed()},f.prototype.decrementScore=function(t){this.score-=1.5*t.config.scoreDecrementFactor,this.score<=0&&t.hasUnderdosed()},f.prototype.bonusPickup=function(t){t.config.scoreIncrementFactor+=1,t.config.scoreDecrementFactor+=.5},f.prototype.update=function(t){!this.didJump&&t.controls.pressed[ENUMS.SPACE]&&(this.jump(t.config.jumpImpulse),t.sound.playSound(t.sound.sounds.JUMP)),t.controls.pressed[ENUMS.RIGHT]&&("right"!==this.direction&&(this.velocityX=0,this.direction="right"),this.velocityX+=this.acceleration),t.controls.pressed[ENUMS.LEFT]&&("left"!==this.direction&&(this.velocityX=0,this.direction="left"),this.velocityX-=this.acceleration),this.y<t.config.groundPoint?(this.y-=t.config.gravity*t.time.delta,this.velocityY+=t.config.gravity*t.time.delta):(this.y=t.config.groundPoint,this.didJump=!1),(this.velocityX>0||this.velocityX<0)&&(this.velocityX+=t.config.friction*("right"===this.direction?-1:1)),this.x<t.config.leftBorder&&(this.x=t.config.leftBorder,this.velocityX=0),this.x>t.config.rightBorder&&(this.x=t.config.rightBorder,this.velocityX=0),this.x+=this.velocityX,this.y+=this.velocityY},f.prototype.jump=function(t){this.didJump=!0,this.velocityY=-t},window.Player=f;function d(e){var t=this;this.items={cocaine:[],decorations:[],bonus:[]},this.updates={cocaine:function(e){return t.updateCocaine(e,"cocaine")},decorations:function(e){return t.updateDecorations(e,"decorations")},bonus:function(e){return t.updateBonus(e,"bonus")}},this.spawn={direction:-1,interval:20,changeInterval:300,lastPosition:void 0,edgeOffset:20},this.spawnIntervalHandler=null,this.changeIntervalHandler=null,this.environmentIntervalHandler=null,this.bonusIntervalHandler=null,this.decoration={interval:1e3,initialX_left:300,initialX_right:500,switch:-1},this.bonus={interval:3e4}}d.prototype.init=function(e){var t=this;this.spawn.lastPosition=e.canvas.width/2,this.spawnIntervalHandler=setInterval(function(){e.paused||(t.spawn.lastPosition+=1*t.spawn.direction,(t.spawn.lastPosition<=e.geometry.environment.horizontLeft.x+t.spawn.edgeOffset||t.spawn.lastPosition>=e.geometry.environment.horizontRight.x-t.spawn.edgeOffset)&&(t.spawn.direction=-t.spawn.direction),t.spawn.lastPosition<=e.geometry.environment.horizontLeft.x+t.spawn.edgeOffset&&(t.spawn.lastPosition=e.geometry.environment.horizontLeft.x+t.spawn.edgeOffset),t.spawn.lastPosition>=e.geometry.environment.horizontRight.x-t.spawn.edgeOffset&&(t.spawn.lastPosition=e.geometry.environment.horizontRight.x-t.spawn.edgeOffset),t.create(new Cocaine(t.spawn.lastPosition,e.geometry.environment.horizontAtY,t.items.cocaine[t.items.cocaine.length-1]),"cocaine"))},this.spawn.interval),this.environmentIntervalHandler=setInterval(function(){if(!e.paused)for(var n=0;n<1;n++)t.decoration.switch>0?t.create(new Decoration(t.decoration.initialX_left-10*n,e.geometry.environment.horizontAtY),"decorations"):t.create(new Decoration(t.decoration.initialX_right+10*n,e.geometry.environment.horizontAtY),"decorations"),t.decoration.switch=-t.decoration.switch},this.decoration.interval),this.changeIntervalHandler=setInterval(function(){e.paused||(t.spawn.direction=Math.random()>.5?-1:1)},this.spawn.changeInterval),this.bonusIntervalHandler=setInterval(function(){t.create(new Decoration(e.canvas.width/2-33+33*Math.floor(3*Math.random()),e.geometry.environment.horizontAtY,"heroin"),"bonus")},this.bonus.interval)},d.prototype.create=function(e,t){this.items[t].push(e)},d.prototype.destroy=function(e,t){var n=this.items[t][e],o=this.items[t][e+1];o&&n===o.previous&&(o.previous=void 0),this.items[t].splice(e,1)},d.prototype.render=function(e){this.renderLine(e,"cocaine"),this.renderArray(e,"decorations"),this.renderArray(e,"bonus")},d.prototype.renderLine=function(e,t){var n=e.ctx;n.save(),n.shadowBlur=20,n.shadowColor="white",n.strokeStyle="white",n.lineCap="round",n.lineWidth=5,this.items[t].forEach(function(e,t){var o=e.previous;o&&(n.beginPath(),n.moveTo(o.x,o.y),n.lineTo(e.x,e.y),n.stroke())}),n.restore()},d.prototype.renderArray=function(e,t){this.items[t].forEach(function(t,n){t.render(e)})},d.prototype.update=function(e){this.updates.cocaine(e),this.updates.decorations(e),this.updates.bonus(e)},d.prototype.updateCocaine=function(e,t){var n=this;this.items[t].forEach(function(o,r){!e.player.didJump&&o.y<=e.player.y&&collision(o,e.player)?(n.destroy(r,t),e.sound.playSound(e.sound.sounds.PICKUP_COCAINE,e.player.score),e.player.incrementScore(e)):o.y>e.canvas.height?(n.destroy(r,t),e.player.decrementScore(e)):o.update(e)})},d.prototype.updateDecorations=function(e,t){var n=this;this.items[t].forEach(function(o,r){o.y>e.canvas.height?n.destroy(r,t):o.update(e)})},d.prototype.updateBonus=function(e,t){var n=this;this.items[t].forEach(function(o,r){!e.player.didJump&&o.y<=e.player.y&&collision(o,e.player)?(n.destroy(r,t),e.sound.playSound(e.sound.sounds.PICKUP_BONUS,e.player.score),e.player.bonusPickup(e)):o.y>e.canvas.height?n.destroy(r,t):o.update(e)})},window.Generator=d;function g(t,i,s){this.x=t,this.y=i,this.startPosX=t,this.startPosY=i,this.width=10,this.height=10,this.radius=10,this.speed=.1,this.previous=s}g.prototype.render=function(t){t.ctx.save(),t.ctx.beginPath(),t.ctx.strokeStyle="green",t.ctx.arc(this.x,this.y,this.radius,0,2*Math.PI,!1),t.ctx.stroke(),t.ctx.restore()},g.prototype.update=function(t){var i=t.geometry.environment;this.y+=this.speed*t.time.delta,this.x=pointAtY(i.focalPoint,{x:this.startPosX,y:this.startPosY},this.y).x-this.width/2},window.Cocaine=g;function h(t,i){var h=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;this.x=t,this.y=i,this.startPosX=t,this.startPosY=i,this.width=200,this.height=200,this.radius=50,this.speed=.1,this.color="#4744FF",this.images=["girl1","cards","dice"],this.image=h||this.images[Math.floor(Math.random()*this.images.length)]}h.prototype.render=function(t){t.ctx.strokeStyle="red";var i=t.cache[this.image],h=this.y/t.geometry.environment.height;t.ctx.drawImage(i,this.x-this.width*h/2,this.y-this.height*h/2,this.width*h,this.height*h)},h.prototype.update=function(t){var i=t.geometry.environment;this.y+=this.speed*t.time.delta,this.x=pointAtY(i.focalPoint,{x:this.startPosX,y:i.horizontAtY},this.y).x},window.Decoration=h;function e(){}e.prototype.init=function(n){this.sounds={PICKUP_COCAINE:1,JUMP:2,PICKUP_BONUS:3},this.startMusic()},e.prototype.playSound=function(n,o){switch(n){case this.sounds.PICKUP_COCAINE:this.pickupSound(o);break;case this.sounds.PICKUP_BONUS:this.bonusSound();break;case this.sounds.JUMP:this.jumpSound();break;default:console.warn("No such sound:",n);}},e.prototype.startMusic=function(){this.music=setInterval(this.backgroundMusic,4e3)},e.prototype.stopMusic=function(){clearInterval(this.music)},e.prototype.jumpSound=function(){soundEffect(523.25,.05,.2,"sine",3,.8,0,600,!0,100,0,void 0,void 0)},e.prototype.pickupSound=function(n){soundEffect(midiTable[66]+.1*n,.02,.04,"triangle",1,0,0)},e.prototype.bonusSound=function(){soundEffect(587.33,0,.2,"square",1,0,0),soundEffect(880,0,.2,"square",1,0,.1),soundEffect(1174.66,0,.3,"square",1,0,.2)},e.prototype.backgroundMusic=function(){var n=function(n,o){var t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:.2;soundEffect(midiTable[o],.05,t,"triangle",1,0,n/4,0),soundEffect(midiTable[o+7],.05,t,"triangle",1,0,n/4,0),soundEffect(midiTable[o+12],.05,t,"triangle",1,0,n/4,0)},o=function(n){return soundEffect(40,0,.1,"triangle",15,0,n/4,0)},t=function(n){return soundEffect(80,0,.1,"triangle",15,0,n/4,0)};o(0),n(0,52),n(1,52),t(2),n(2,50),n(3,52),o(4),n(5,47),t(6),n(6,52),n(7,50,.8),o(8),t(10),o(12),t(14)},window.Sound=e;function c(){this.restarting=!1,this.cache={},this.assetLoading=Promise.all([this.addToCache("girl1","./girl.svg"),this.addToCache("player","./player.svg"),this.addToCache("cards","./cards.svg"),this.addToCache("dice","./dice.svg"),this.addToCache("heroin","./heroin.svg")])}c.prototype.addToCache=function(t,e){var i=this;return new Promise(function(n,s){var o=document.createElement("canvas"),r=o.getContext("2d"),a=new Image;a.src=e,a.onload=function(){o.width=a.width,o.height=a.height,r.drawImage(a,0,0),i.cache[t]=o,n()}})},c.prototype.init=function(t){var e=this;this.config={canvasId:t||"display",fps:t||60,mute:!1,gravity:.05,friction:.5,jumpImpulse:20,groundPoint:500,leftBorder:150,rightBorder:650,scoreLimit:2e3,scoreIncrementFactor:1,scoreDecrementFactor:2},this.time={now:0,then:performance.now(),interval:1e3/60,delta:0},this.overdosed=!1,this.underdosed=!1,this.paused=!1,this.canvas=document.getElementById(this.config.canvasId),this.canvas.width=800,this.canvas.height=600,this.ctx=this.canvas.getContext("2d"),this.geometry={player:{x:400,y:200,width:50,height:90,radius:16},environment:this.calculateEnvironment({x:this.canvas.width/2,y:150})},this.windowBlurHandler=window.onblur=function(){e.paused=!0,e.sound.stopMusic()},this.environment=new Environment,this.player=new Player,this.generator=new Generator,this.sound||(this.sound=new Sound,this.sound.init(this)),this.controls||(this.controls=new Controls,this.controls.init(this)),this.assetLoading.then(function(){e.environment.init(e),e.generator.init(e),e.player.init(e),e.loop()})},c.prototype.calculateEnvironment=function(t){var e={width:this.canvas.width,height:this.canvas.height,horizontAtY:this.canvas.height/3,focalPoint:t,bottomLeft:{x:0,y:this.canvas.height},bottomRight:{x:this.canvas.width,y:this.canvas.height}};return e.horizontLeft=pointAtY(e.focalPoint,e.bottomLeft,e.horizontAtY),e.horizontRight=pointAtY(e.focalPoint,e.bottomRight,e.horizontAtY),e},c.prototype.loop=function(t){var e=this.time;e.now=t||0,e.delta=e.now-e.then,e.delta>e.interval&&(e.then=e.now-e.delta%e.interval),this.paused?this.overdosed?this.renderOverdose():this.underdosed?this.renderUnderdose():this.renderPause():e.delta>e.interval&&(this.update(),this.render()),requestAnimationFrame(this.loop.bind(this))},c.prototype.render=function(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.environment.render(this),this.generator.render(this),this.player.render(this)},c.prototype.renderPause=function(){this.environment.drawPause(this)},c.prototype.renderOverdose=function(){this.environment.drawOverdose(this)},c.prototype.renderUnderdose=function(){this.environment.drawUnderdose(this)},c.prototype.update=function(t){this.generator.update(this),this.player.update(this)},c.prototype.hasOverdosed=function(){this.paused=!0,this.sound.stopMusic(),this.overdosed=!0},c.prototype.hasUnderdosed=function(){this.paused=!0,this.sound.stopMusic(),this.underdosed=!0},c.prototype.restartGame=function(){delete this.environment,delete this.player,delete this.generator,this.init()},window.Game=c;})();
   </script>
   <style>body,html{width:100%;height:100%;margin:0;padding:0}canvas{display:block;position:fixed;top:0;left:0;right:0;bottom:0;margin:auto;transform:translateZ(0)}</style> </head> <body> <canvas id="display"></canvas> <script>const snooffline=new Game;snooffline.init();</script> </body> </html>