<script>document.write('<!doctype html><html><meta content="width=device-width" name=viewport><title>SnapCat - js13kGames 2025</title><style>:root{font-family:system-ui,sans-serif;color:#111;background-color:#ccc;touch-action:none}body{margin:0;height:calc(100vh - 10px);align-content:space-around}.card{font-size:larger}#app{margin:0 auto;text-align:center}button{border-radius:8px;border:1px solid transparent;padding:.6em 1.2em;font-size:1em;font-weight:500;font-family:inherit;background-color:#f9f9f9;cursor:pointer;transition:border-color .25s}button:hover{border-color:#646cff}button:focus,button:focus-visible{outline:-webkit-focus-ring-color auto 4px}#game{max-width:min(calc(100vw - 10px),40rem);max-height:min(calc(100vh - 10px),60rem);touch-action:none;border:2px solid #000;border-radius:5px;box-shadow:#000 1px 1px 10px}.draggable{touch-action:none;cursor:move;transition:x .3s ease-in-out,y .3s ease-in-out;filter:drop-shadow(0 0 10px rgba(0,0,0,.7))}.draggable:hover .body{stroke:#fff;stroke-width:2px}.dragging{opacity:.7}.row{stroke:#666;stroke-width:1}.row-line{stroke:transparent}path{stroke-linecap:round}.selected{filter:opacity(.9)}.far{filter:blur(2px)}.likes{filter:drop-shadow(0 0 5px #0f0);stroke:#0f0!important}.dislikes{filter:drop-shadow(0 0 5px red);stroke:red!important}.score{font-weight:700}@keyframes camera-flash{0%,to{opacity:0}10%{opacity:1}}@keyframes sepia-fade{0%{filter:sepia(0)}to{filter:sepia(1)}}#flash{pointer-events:none;mix-blend-mode:screen}.fire{animation:.3s ease-out camera-flash}.sepia{animation:.5s ease-out sepia-fade;filter:sepia(1)}#catInfo tr td:last-child{width:1%;text-wrap:nowrap}span.like{filter:hue-rotate(30deg) saturate(3)}span.dislike{filter:hue-rotate(310deg) saturate(3)}#catInfo tr:nth-child(odd){background:#ddd}#objectives{background:#ddd;border-radius:10px}#objectives i{background:#fff;padding:1px}#objectives b{background:wheat}#objectives li.check{list-style-type:"‚úî ";color:green}#photo>use[href="#xmark"]{display:none}#photo.no>use[href="#xmark"]{display:block}foreignObject{font-size:larger;text-wrap:balance;text-align:left}foreignObject li{padding-bottom:10px}audio{display:none}.sunglasses{mix-blend-mode:difference}.accessories{stroke:#231f20}.level{text-anchor:middle;dominant-baseline:middle}.level .score{fill:green}#end{text-anchor:middle;display:none}#score{font-weight:700}</style><div id=app></div><audio id=click1 preload=auto src=./click3.wav></audio><audio id=click2 preload=auto src=./click2.wav></audio><audio id=click3 preload=auto src=./click3.wav></audio>');const e={head:.7,eye:.5,neck:.8,hand:.5},t=["head","eye","neck","hand"],n={head:{cap:100,beanie:100,hat:100,band:100},eye:{glasses:100,sunglasses:100},neck:{tie:100,bowtie:100,scarf:100},hand:{umbrella:100,bag:100,cane:100,balloon:100}},a={cap:2,beanie:2,hat:2,band:2,glasses:2,sunglasses:4,tie:2,bowtie:2,scarf:2,umbrella:3,bag:2,cane:2,balloon:3},o=()=>{const e=function(e,t,n,a){return function(){const o=((e|=0)+(t|=0)|0)+(a|=0)|0;return a=a+1|0,e=t^t>>>9,t=(n|=0)+(n<<3)|0,n=(n=n<<21|n>>>11)+o|0,(o>>>0)/4294967296}}(3735928559,3203386110,915948055,2208665809);for(let t=0;t<32;t++)e();const t=(t,n)=>Math.floor(e()*(n-t+1))+t,n=(t,n=.5)=>{let a=0;if(e()>=n){const n=e(),o=t.length/2;a=Math.floor(Math.log2(1+n*(Math.pow(2,o)-1)))}const o=[...t];for(let t=o.length-1;t>0;t--){const n=Math.floor(e()*(t+1));[o[t],o[n]]=[o[n],o[t]]}return o.slice(0,a)};return{random:e,rand:t,randf:(t,n)=>e()*(n-t)+t,randb:(t=.5)=>e()<t,choose:e=>e[t(0,e.length-1)],popRandom:e=>{if(0===e.length)return;const n=t(0,e.length-1),a=e[n];return e.splice(n,1),a},randomItem:(t,n=.5)=>e()<n?null:t[Math.floor(e()*t.length)],randomItems:n,randomWeightedItem:(t,n=.5)=>{const o=Object.entries(t).sort(([e],[t])=>e.localeCompare(t));if(e()<n)return null;const r=o.reduce((e,[,t])=>e+t,0);let l=e()*r;for(const[e,n]of o){if(l<n)return t[e]/=a[e],e;l-=n}return null},randomTrait:(e,t,a,o=.5,r)=>{const l=n(a,o);return null===l||!1!==r&&0===l.length?null:(a.splice(0,a.length,...a.filter(e=>!l.includes(e))),"likes"===t?{kind:e,likes:l}:{kind:e,dislikes:l})}}},r={black:"#111",gray:"#80828f",orange:"#faaf69",cream:"#f7e7cd",white:"#eee"},l=["black","gray","orange","cream","white"],s=["plain","tuxedo","tabby"],i={black:["Shadow","Midnight","Salem","Jinx","Nyx","Smudge","Raven","Loki","Onyx","Coal"],orange:["Ginger","Simba","Tigger","Honey","Maple","Peaches","Pumpkin"],cream:["Pudding","Cookie","Muffin","Latte","Waffle","Tofu","Noodle"],gray:["Smokey","Cinder","Ash","Pebbles","Dusty","Steel","Fog"],white:["Snowball","Ivory","Pearl","Cotton","Ghost"]},c={cat:3,color:2,pattern:1,accessory:2,place:1},d=[-13,-6,6,13],m=["miserable","downcast","content","pleased","cheerful"],f=Object.fromEntries(m.map((e,t)=>[e,t])),u={LT:(e,t)=>f[e]<f[t],LE:(e,t)=>f[e]<=f[t],GT:(e,t)=>f[e]>f[t],GE:(e,t)=>f[e]>=f[t],EQ:(e,t)=>f[e]===f[t]};function p(e){return e.map(t=>e.map(e=>function(e,t){if(e.name===t.name)return 0;const n=e.traits,{name:a,color:o,patterns:r,accessories:l}=t;let s=0;return n.forEach(e=>{const[t,n]="likes"in e?["likes",e.likes]:["dislikes",e.dislikes];("cat"===e.kind&&n.includes(a)||"color"===e.kind&&n.includes(o)||"pattern"===e.kind&&(r.some(e=>n.includes(e))||0===r.length&&0===n.length)||"accessory"===e.kind&&l.some(([e])=>n.includes(e))||"place"===e.kind&&l.some(([e,t])=>!n.includes(e)&&n.includes(t)))&&(s+=c[e.kind]*("likes"===t?1:-1))}),s}(t,e)))}const h=Object.fromEntries(Object.entries(n).sort().map(([e,t])=>[e,Object.fromEntries(Object.entries(t).sort().map(([e,t])=>[e,t]))])),g=[{cats:[25]},{cats:[34,30]},{cats:[19,31,27]},{cats:[17,2,29,30]},{cats:[0,26,4,8,28]},{cats:[27,8,31,4,2,11]},{cats:[23,18,3,35,32,26,19]},{cats:[9,0,4,30,1,31,2,10]},{cats:[31,0,3,20,14,7,15,35,21]},{cats:[7,10,9,22,0,4,14,8,30,31]},{cats:[26,9,29,14,34,4,30,11,0,31,7]}],b=[["color","black"],["pattern","plain"]],y=[{catCount:1,text:"<li>Cats differ in color, pattern and accessories.</li><li><u>Black Cats</u> are solid black.</li><li><u>Black Cats</u> enjoy group photos. But, this one is a bit lonely.</li><li>Drag & drop it to practice.</li>",doneFn:e=>{let t=0,n="";document.querySelectorAll(".draggable").forEach(a=>{const o=()=>{n=a.parentNode.dataset.index},r=()=>{window.requestAnimationFrame(()=>{n!==a.parentNode.dataset.index&&t++,3===t?(a.removeEventListener("pointerdown",o),a.removeEventListener("pointerup",r),e("<li>Great! Now, snap the first photo.</li>",!0)):1===t&&e("<li>Great! The cat will sit where its bottom is.</li><li>Keep trying to get the hang of it.</li>")})};a.addEventListener("pointerdown",o,!0),a.addEventListener("pointerup",r)})}},{catCount:2,objectives:[{value:b,mood:"content",comp:"GE"}],text:'<li>A cat‚Äôs mood depends on its <span class="like">üëç</span>likes and <span class="dislike">üëé</span>dislikes.</li><li>Check the help menu for details.<span style="border: 1px solid black;padding: 0 .5rem;margin-left: 1rem;background: #eee;">?</span></li><li>Nearby cats influence moods.</li><li>Distant cats look blurred and have no effect.</li><li>Try placing cats far apart.</li>',doneFn:e=>{const t=[...document.querySelectorAll(".draggable")];t.forEach(n=>{const a=()=>{t.some(e=>e.classList.contains("far"))&&(e("<li>Great! Now, you‚Äôre ready to be a CATographer.</li>",!0),n.removeEventListener("pointerup",a))};n.addEventListener("pointerup",a)})}},{catCount:3,objectives:[{value:b,mood:"pleased",comp:"GE"},{value:[["accessory","balloon"]],mood:"pleased",comp:"GE"},{value:[["pattern","tuxedo"]],mood:"cheerful",comp:"EQ"}],text:"<li>All cats like or dislike <u>Black Cats</u>, but other colors may not matter.</li><li>All levels have an objective for <u>Black Cats</u>.</li><li>Some levels have additional objectives.</li><li>Try to meet all of them.</li>"},{catCount:4,objectives:[{value:b,mood:"downcast",comp:"LE"},{value:[["color","cream"]],mood:"downcast",comp:"LE"},{value:[["pattern","tuxedo"]],mood:"pleased",comp:"GE"}]},{catCount:5,objectives:[{value:b,mood:"cheerful",comp:"EQ"},{value:[["accessory","umbrella"]],mood:"downcast",comp:"LE"},{value:[["accessory","scarf"]],mood:"pleased",comp:"GE"}]},{catCount:6,objectives:[{value:b,mood:"pleased",comp:"EQ"},{value:[["accessory","bowtie"]],mood:"cheerful",comp:"EQ"},{value:[["accessory","tie"]],mood:"pleased",comp:"GE"},{value:[["pattern","tuxedo"]],mood:"content",comp:"EQ"}]},{catCount:7,objectives:[{value:b,mood:"pleased",comp:"GE"},{value:[["accessory","balloon"]],mood:"cheerful",comp:"EQ"},{value:[["pattern","tuxedo"]],mood:"cheerful",comp:"EQ"},{value:"fallback",mood:"pleased",comp:"GE"}]},{catCount:8,objectives:[{value:b,mood:"cheerful",comp:"EQ"},{value:[["accessory","beanie"]],mood:"cheerful",comp:"EQ"},{value:[["accessory","scarf"]],mood:"cheerful",comp:"EQ"},{value:[["accessory","hat"]],mood:"content",comp:"EQ"}]},{catCount:9,objectives:[{value:b,mood:"miserable",comp:"EQ"},{value:[["color","gray"]],mood:"cheerful",comp:"EQ"},{value:[["color","white"]],mood:"pleased",comp:"GE"},{value:[["pattern","tabby"]],mood:"pleased",comp:"GE"},{value:[["accessory","umbrella"]],mood:"cheerful",comp:"LE"}]},{catCount:10,objectives:[{value:b,mood:"cheerful",comp:"EQ"},{value:[["color","gray"]],mood:"cheerful",comp:"EQ"},{value:[["pattern","tuxedo"]],mood:"cheerful",comp:"EQ"},{value:[["accessory","umbrella"],["accessory","sunglasses"]],mood:"cheerful",comp:"EQ"},{value:[["accessory","tie"]],mood:"pleased",comp:"GE"},{value:[["accessory","bowtie"]],mood:"pleased",comp:"GE"}]},{catCount:11,objectives:[{value:b,mood:"cheerful",comp:"GE"},{value:[["accessory","cap"]],mood:"cheerful",comp:"GE"},{value:[["accessory","bag"]],mood:"downcast",comp:"LE"},{value:[["accessory","band"],["accessory","bag"]],mood:"downcast",comp:"LE"},{value:[["color","white"]],mood:"content",comp:"EQ"},{value:[["pattern","tuxedo"]],mood:"pleased",comp:"GE"}]}],x=640,k=4e4,v=function(){const{randf:t,randomWeightedItem:a,randomTrait:r,randb:s}=o(),c=(o,c)=>{const d=t(.6,1.4).toFixed(3),m=t(.6,1.4).toFixed(3);let f=["tuxedo","tabby"];"black"===c?f=["tuxedo"]:"white"===c&&(f=[]);let u=f.filter(()=>s());0===u.length&&(u=["plain"]);const p=Object.entries(h).slice().sort((e,t)=>e[0].localeCompare(t[0])).map(([t,n])=>[a(n,1-e[t]),t]).filter(([e,t])=>null!==e),g=(({catName:t,catColor:a})=>{const o=Object.values(i).flat().slice().sort().filter(e=>e!==t),c=l.filter(e=>"black"!==e),d=["plain","tuxedo","tabby"],m=Object.values(n).flatMap(e=>Object.keys(e)).slice().sort(),f=Object.keys(e).slice().sort(),u=["likes","dislikes"],p=u[Number(s("black"===a?.1:.4))];return u.flatMap(e=>[r("cat",e,o,0),(()=>{const t=r("color",e,c,.3,!1),n=t[e];return e===p&&n.push("black"),0===n.length?null:t})(),r("pattern",e,d,.4),r("accessory",e,m,0),r("place",e,f,.7)]).filter(e=>null!==e)})({catName:o,catColor:c});return{color:c,patterns:u,accessories:p,xScale:d,yScale:m,traits:g}},d={};return Object.entries(i).slice().sort((e,t)=>e[0].localeCompare(t[0])).forEach(([e,t])=>{t.slice().sort().forEach(t=>{d[t]=c(t,e)})}),d}(),{rand:w}=o(),E=document.getElementById("click1");E.volume=.3;const $=document.getElementById("click2"),C=document.getElementById("click3");let M,j,S={},L={},B=[],I={},A={levels:g.map(e=>null)};function q(){M=document.querySelector("#app"),console.debug("Returning to menu"),M.innerHTML='\n    <div class="card">\n      <h1>SnapCat !</h1>\n      <p>Complete the Black Cats\' Album</p>\n      <h1>üì∏ üò∫</h1>\n      <br>\n      <button id="game" type="button">Play Game</button>\n    </div>\n',document.querySelector("#game").addEventListener("click",()=>function(){console.debug("Game started");const e=localStorage.getItem("snapcat-levels");if(e){A=JSON.parse(e);let t=A.levels.findIndex(e=>null===e);-1===t&&(t=0),z(t)}else z(0)}())}function O(){let e=A.levels.findIndex(e=>null===e);-1===e&&(e=A.levels.length);const t=document.getElementById("overlay");t.innerHTML=`<rect width="640" height="1000" fill="#333c" />\n  <text x="320" y="162" fill="#fff" font-size="48" text-anchor="middle">Level Select</text>\n  ${g.map((t,n)=>`\n  <g id="level${n}" class="level ${n<=e?"unlocked":""}" data-level="${n}" transform="translate(${n%5*125+20} ${125*Math.floor(n/5)+200})" style="cursor:pointer">\n    <rect width="100" height="100" fill="#fff" />\n    ${n>e?'<use href="#lock" transform="translate(25 25)scale(2)"/>':`<text x="50" y="40" fill="#000" font-size="36" font-weight="bold">${n+1}</text>`}\n          ${n<e?`<text class="score" x="50" y="80" font-size="24" >‚úî ${A.levels[n]?.score.toFixed(1)??0}</text>`:""}\n  </g>\n`).join("")}\n    <g id="mainMenuBtn" style="cursor:pointer" transform="translate(320 938)">\n      <rect fill="#eee" width="250" height="40" x="-125" y="-20" rx="5" ry="5"/>\n      <text fill="#111" font-size="24" text-anchor="middle" dominant-baseline="middle">Return to Main Menu</text>\n    </g>\n    `,t.querySelector("#mainMenuBtn").addEventListener("click",q),t.querySelector("rect").addEventListener("click",H),t.querySelectorAll(".level.unlocked").forEach(e=>{e.addEventListener("click",()=>{const t=e.dataset.level;t&&z(parseInt(t))})})}function T(){const e=L.black.slice(0,5),t=document.getElementById("overlay"),a=s.map(e=>[e]).concat([["tabby","tuxedo"]]),o=[["cap","sunglasses","tie","balloon"],["beanie",null,"scarf","cane"],["hat","glasses","bowtie","bag"],["band",null,null,"umbrella"]].map(([e,t,n,a])=>[[e,"head"],[t,"eye"],[n,"neck"],[a,"hand"]]).map(e=>e.filter(([e])=>null!==e)),r={name:"Shadow",color:"black",patterns:["plain"],accessories:[],xScale:.8,yScale:.8,traits:[]};t.innerHTML=`<rect width="640" height="1000" fill="#333c" />\n  <g fill="#eee" font-size="24">\n  <text id="moods" transform="translate(40,150)rotate(-90)">Moods</text>\n  <text transform="translate(40,325)rotate(-90)">Colors</text>\n  <text transform="translate(40,500)rotate(-90)">Patterns</text>\n  <text transform="translate(40,700)rotate(-90)">Accessories</text>\n  </g>\n  ${e.map(e=>G({...r,name:e}))}\n  ${l.map(e=>G({...r,name:L[e][5],color:e}))}\n  ${a.map(e=>G({...r,name:"Honey",color:"orange",patterns:e}))}\n  ${o.map(e=>G({...r,name:"Ash",color:"gray",accessories:e}))}\n  ${["none","likes","dislikes"].map((e,t)=>`<g id="${e}Btn" style="cursor:pointer" transform="translate(${(t+1)*x/4} 938)">\n    <rect fill="#eee" width="100" height="40" x="-50" y="-20" rx="5" ry="5"/>\n    <text fill="#111" font-size="24" text-anchor="middle" dominant-baseline="middle">${e}</text>\n  </g>`)}\n  `;const i=[...t.querySelectorAll(".draggable")];let c=[];i.slice(0,5).forEach((e,t)=>{e.setAttribute("transform",`translate(${120*t+60}, 50)`),c.push(e.querySelector(".cathead"));const n=e.querySelector(".face"),a=m[t];n?.setAttribute("xlink:href",`#${a}`),e.insertAdjacentHTML("beforeend",`<text transform="translate(40 -10)" fill="#eee" text-anchor="middle">${a}</text>`)}),i.slice(5,10).forEach((e,t)=>{c.push(e.querySelector(".body")),e.setAttribute("transform",`translate(${120*t+60}, 225)`),e.insertAdjacentHTML("beforeend",`<text transform="translate(40 -10)" fill="#eee" text-anchor="middle">${l[t]}</text>`)}),i.slice(10,14).forEach((e,t)=>{c.push(...e.querySelectorAll(".tuxedo, .tabby")),e.setAttribute("transform",`translate(${120*t+60}, 400)`),e.insertAdjacentHTML("beforeend",`<text transform="translate(40 -10)" fill="#eee" text-anchor="middle">${a[t].join("+")}</text>`)});const d=Object.keys(n);d.forEach((e,n)=>{t.insertAdjacentHTML("beforeend",`<text transform="translate(40 ${750+30*n})" fill="#eee" text-anchor="middle" font-weight="bold">${e}</text>`)}),i.slice(14,18).forEach((e,t)=>{c.push(e.querySelector(".accessories")),e.setAttribute("transform",`translate(${120*t+100}, 600)`),o[t].forEach(([t,n])=>e.insertAdjacentHTML("beforeend",`<text transform="translate(40 ${150+30*d.indexOf(n)})" fill="#eee" text-anchor="middle">${t}</text>`))}),t.querySelector("rect").addEventListener("click",H);const f=n=>{t.querySelector("#moods").textContent=n?"Cats":"Moods",[...t.querySelectorAll(".draggable text:last-child")].slice(0,5).forEach((t,a)=>t.textContent=n?e[a]:m[a])};["likes","dislikes"].map(e=>t.querySelector(`#${e}Btn`)?.addEventListener("click",()=>{f(!0),R(c,e)})),t.querySelector("#noneBtn")?.addEventListener("click",()=>{f(!1),K()})}function H(){document.getElementById("overlay").innerHTML=""}function z(e,t=!1){L=Object.assign({},i);const n=localStorage.getItem(`snapcat-level-${e+1}`),a=n?JSON.parse(n):null;j={level:e,done:!1,objectivesMet:!1,cats:a?.cats??{}};const o=Array.from({length:5},(e,t)=>function(e){const t=890-60*e,n=10+10*e,a=t+20-10;return`<g class="row" data-index="${e}">\n    <polygon points="${n},${t} ${x-n},${t} ${x-n+10},${t+20} ${n-10},${t+20}" fill="#e0e0e0"/>\n    <rect x="${n-10}" y="${t+20}" width="${x-2*n+20}" height="40" fill="#a0a0a0"/>\n    <line class="row-line" x1="0" y1="${a}" x2="640" y2="${a}" />\n  </g>`}(5-t-1)).join("");S={};const r=g[e];let l=function(e){return Object.entries(e).sort(([e],[t])=>e.localeCompare(t)).map(([e,t])=>{const{xScale:n,yScale:a}=t,o=parseFloat(n),r=parseFloat(a);return{...t,name:e,xScale:o,yScale:r}})}(v);l=r.cats.map(e=>l[e]),B=p(l),l.forEach((e,t)=>{S[e.name]=e,I[e.name]=t});const s=Object.values(S).map(e=>G(e)).join("");M.innerHTML=`\n  <svg id="game" height="100%" viewBox="0 0 640 1000" >\n  <defs>\n    <pattern id="tabby" width="24" height="10" fill="#ccc" patternTransform="scale(3)" patternUnits="userSpaceOnUse">\n        <path d="M12-2C9.2-2 7.2-.6 5.4.7 3.7 1.9 2.2 3 0 3v2c2.8 0 4.8-1.4 6.6-2.7C8.3 1.1 9.8 0 12 0s3.7 1 5.4 2.3C19.2 3.6 21.2 5 24 5V3c-2.2 0-3.7-1-5.4-2.3C16.8-.6 14.8-2 12-2Z"/>\n        <path d="M12 3C9.2 3 7.2 4.4 5.4 5.7 3.7 6.9 2.2 8 0 8v2c2.8 0 4.8-1.4 6.6-2.7C8.3 6.1 9.8 5 12 5s3.7 1 5.4 2.3C19.2 8.6 21.2 10 24 10V8c-2.2 0-3.7-1-5.4-2.3C16.8 4.4 14.8 3 12 3Z"/>\n        <path d="M12 8c-2.8 0-4.8 1.4-6.6 2.7C3.7 11.9 2.2 13 0 13v2c2.8 0 4.8-1.4 6.6-2.7C8.3 11.1 9.8 10 12 10s3.7 1 5.4 2.3c1.8 1.3 3.8 2.7 6.6 2.7v-2c-2.2 0-3.7-1-5.4-2.3C16.8 9.4 14.8 8 12 8Z"/>\n    </pattern>\n    <pattern id="strips" width="4" height="1" fill="rgba(199, 11, 11, 1)" patternTransform="rotate(45 -3.3 .6) scale(2)" patternUnits="userSpaceOnUse">\n      <rect fill="rgba(0, 0, 167, 0.5)" width="100%" height="100%" />\n      <path id="rect152" stroke="none" d="M0-.5h1v2H0z"/>\n    </pattern>\n    <pattern id="wave" width="24" height="10" fill="#e87e7e" patternTransform="matrix(20 50 0 20 28 0)" patternUnits="userSpaceOnUse">\n        <rect width="100%" height="100%" fill="#ffb3b3ff"/>\n        <path id="path3" d="M12-2C9.2-2 7.2-.6 5.4.7 3.7 1.9 2.2 3 0 3v2c2.8 0 4.8-1.4 6.6-2.7C8.3 1.1 9.8 0 12 0s3.7 1 5.4 2.3C19.2 3.6 21.2 5 24 5V3c-2.2 0-3.7-1-5.4-2.3C16.8-.6 14.8-2 12-2Z"/>\n        <path id="path4" d="M12 3C9.2 3 7.2 4.4 5.4 5.7 3.7 6.9 2.2 8 0 8v2c2.8 0 4.8-1.4 6.6-2.7C8.3 6.1 9.8 5 12 5s3.7 1 5.4 2.3C19.2 8.6 21.2 10 24 10V8c-2.2 0-3.7-1-5.4-2.3C16.8 4.4 14.8 3 12 3Z"/>\n        <path id="path7" d="M12 8c-2.8 0-4.8 1.4-6.6 2.7C3.7 11.9 2.2 13 0 13v2c2.8 0 4.8-1.4 6.6-2.7C8.3 11.1 9.8 10 12 10s3.7 1 5.4 2.3c1.8 1.3 3.8 2.7 6.6 2.7v-2c-2.2 0-3.7-1-5.4-2.3C16.8 9.4 14.8 8 12 8Z"/>\n    </pattern>\n    <path id="body" d="M52.8 149.5a203 203 0 0 1-44-4c-5.8-.6-7-6.8-7.4-12.2a314 314 0 0 1 2.6-70C8 36 12.5 29.5 5.3 1c0 0 9.7 5 28.5 17 10.5-.8 23.3 1 32.9 0C86.2 3.2 92 1.3 92 1.3c-6.4 30.8.3 37.8 4 65.3 3.8 27.6 4 52 2.6 67.6.2 6.5-4.8 10.7-10.2 11.7a138.6 138.6 0 0 1-35.7 3.7Z" />\n    \n  <g id="menu"><path d="M3 5H21" stroke="#000" stroke-width="1.5"></path><path d="M3 12H21" stroke="#000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M3 19H21" stroke="#000000" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g>\n  <path id="camera" fill-rule="evenodd" clip-rule="evenodd" d="M7.72 2.79L5.5 5.75C5.26393 6.06475 4.89344 6.25 4.5 6.25H4C2.48122 6.25 1.25 7.48122 1.25 9V19C1.25 20.5188 2.48122 21.75 4 21.75H20C21.5188 21.75 22.75 20.5188 22.75 19V9C22.75 7.48122 21.5188 6.25 20 6.25H19.5C19.1066 6.25 18.7361 6.06474 18.5 5.75L16.28 2.79C16.0251 2.45007 15.625 2.25 15.2 2.25H8.8C8.37508 2.25 7.97495 2.45007 7.72 2.79ZM12 8.25C9.37664 8.25 7.25 10.3767 7.25 13C7.25 15.6233 9.37664 17.75 12 17.75C14.6233 17.75 16.75 15.6233 16.75 13C16.75 10.3767 14.6233 8.25 12 8.25Z" fill="#000000"></path>\n  <path id="xmark" d="M6.75827 17.2426L12.0009 12M17.2435 6.75736L12.0009 12M12.0009 12L6.75827 6.75736M12.0009 12L17.2435 17.2426" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>\n  <path id="lock" d="M16 12H17.4C17.7314 12 18 12.2686 18 12.6V19.4C18 19.7314 17.7314 20 17.4 20H6.6C6.26863 20 6 19.7314 6 19.4V12.6C6 12.2686 6.26863 12 6.6 12H8M16 12V8C16 6.66667 15.2 4 12 4C8.8 4 8 6.66667 8 8V12M16 12H8" fill="none" stroke="chocolate" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path>\n  <g id="restart"><path d="M6.67742 20.5673C2.53141 18.0212 0.758026 12.7584 2.71678 8.1439C4.87472 3.0601 10.7453 0.68822 15.8291 2.84617C20.9129 5.00412 23.2848 10.8747 21.1269 15.9585C20.2837 17.945 18.8736 19.5174 17.1651 20.5673" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path><path d="M17 16V20.4C17 20.7314 17.2686 21 17.6 21H22" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"></path></g>\n  \n    \n    <g id="miserable" stroke-width="2" >\n      <use xlink:href="#eye1" stroke-width="2" transform="matrix(-.997 0 0 .992 99 .3)"/>\n      <path id="eye1" fill="none" stroke-width="3" d="m65 36.6 8.5 4.9"  />\n      <path fill="none" stroke-width="2" d="M57.6 59.4c.3-3.4-1.2-6.3-7.4-7.8l-.4-7 .4 7c-7.2 1-7 7.8-7 7.8" />\n    </g>\n    <g id="downcast" stroke-width="2" >\n      <use xlink:href="#eye2" stroke-width="2"  transform="matrix(-.997 0 0 .992 99 .3)"/>\n      <path id="eye2" fill="none" stroke-width="5" d="M67.7 38.4h.4"  />\n      <path fill="none" stroke-width="2" d="M49.8 45.3v11.2" />\n    </g>\n    <g id="content" stroke-width="2" >\n      <use xlink:href="#eye3" transform="matrix(-.997 0 0 .992 99.9 .3)"/>\n      <path id="eye3" fill="none" d="M75.7 34.3c-.6 3.6-10.3 2.7-10.8-1"  />\n      <path fill="none" d="m49.8 45 .5 11.8s-1 .8-1 1.3.7 1.1 1.1 1.1c.5 0 1-.6 1-1.1 0-.5-1.1-1.3-1.1-1.3"/>\n    </g>\n    <g id="pleased" stroke-width="2" >\n      <use xlink:href="#eye4" transform="matrix(-.997 0 0 .992 99 .3)"/>\n      <path id="eye4" fill="none" d="M65.4 37.4c-1.4-4.4 6.5-6.8 8-.6"  />\n      <path fill="none" d="M62.7 52.9c-1 3.7-13.2 7.8-13-1.3V45v6.8c-.3 9.1-11.9 6.3-13 1" />\n    </g>\n    <g id="cheerful" stroke-width="2" >\n      <use xlink:href="#eye5" transform="matrix(-.997 0 0 .992 100.3 .3)"/>\n      <path id="eye5" fill="none" d="M76.6 36.8c-19 .7-16 .3-1.4-5"  />\n      <path fill="#ff8080" d="M60.2 49.3C50.5 59.8 49.8 45 49.8 45s0 15.3-10.4 4c0 0-.6 12 10.2 12 10.8-.1 10.6-11.7 10.6-11.7Z" />\n    </g>\n  \n    \n    <path id="glasses" fill="#1a1a1a" d="M28.2 24.3c-5 .1-10 .4-14.7 1.8-3.2 3 1.7 6 2 9 1.1 4.7 2 10.4 6.5 13 4.4 2.3 9.6 2 14.2 1.2 5.3-1.3 8.9-6 10.4-11 .1-3.7 5-5.2 6.3-1.3 1 3 1.8 6 4.1 8.3 2.8 3.2 7 4.6 11.1 4.6 5 .3 10.9-1 13.4-5.7 2-3.5 2.4-7.7 3.4-11.6 3-1.2 3.8-6.8-.3-6.9a61.4 61.4 0 0 0-31.4 1.6c-6.1 1.3-12-1.8-18-2.4-2.3-.4-4.7-.6-7-.6Zm41.5 3c3.7.2 8 .1 11 2.7 2.1 3.4.8 7.7 0 11.3a9 9 0 0 1-8.1 6.4c-5.5 1-12-.1-15.2-5.2A14 14 0 0 1 54.7 32c1.5-3.5 5.7-4 9-4.4 2-.3 4-.4 6-.4zm-39.5 0c4.7.3 10 .2 14 3.1 2.4 3.2.6 7.4-1 10.6-2 3.9-6 7-10.5 6.8-4.5.5-10.2 0-12.6-4.5a15.3 15.3 0 0 1-1.3-12.6c2.6-3.5 7.6-3 11.4-3.4z" />\n    <path id="sunglasses" fill="#3f0a00ff" fill-opacity=".9" d="M28.2 24.3c-5 .1-10 .4-14.7 1.8-3.2 3 1.7 6 2 9 1.1 4.7 2 10.4 6.5 13 4.4 2.3 9.6 2 14.2 1.2 5.3-1.3 8.9-6 10.4-11 .1-3.7 5-5.2 6.3-1.3 1 3 1.8 6 4.1 8.3 2.8 3.2 7 4.6 11.1 4.6 5 .3 10.9-1 13.4-5.7 2-3.5 2.4-7.7 3.4-11.6 3-1.2 3.8-6.8-.3-6.9a61.4 61.4 0 0 0-31.4 1.6c-6.1 1.3-12-1.8-18-2.4-2.3-.4-4.7-.6-7-.6Z" />\n    <path id="cap" fill="rgba(248, 67, 43, 1)" d="m27 12.6 22.2-.2-.3-20.3.3 20.4h21.7M48.2-8.3C30.7-8.4 26.1 1 26.1 12.8l1.2-.3s-3.7 5.6-2.6 7.8c2.6 5.5 12.6-1.3 24.7-1.3 12 0 21.5 6.8 24.1 1.3 1-2.2-2.6-7.7-2.6-7.8l1.2.3C72.1 2 65.1-8 49.4-8.4c-.7 0 5-1.2-.4-1.2-6.5 0 .2 1.2-.8 1.2z" />\n    <path id="beanie" fill="rgba(2, 185, 73, 1)" d="m42.9-12.3-.1-1a6.6 6.6 0 1 1 13 1M73 9.7l-5.2 11.9m0-12-5.3 12m0-12-5.2 12m0-12-5.2 12m0-12-5.3 12m0-12-5.2 12m0-12-5.3 12m0-12-5.2 12m0-12-5.2 12m47.1 0H25.8v-12h47.1Zm-44.1-12V7.2a20.6 20.6 0 0 1 41.2 0v2.4" />\n    <g id="hat" >\n      <path id="path8" fill="#deaa87" d="M49.5-12.5a20 20 0 0 0-9.6 2.3C33.9-6.9 29.4 0 29.4 11.3c-5-1.5-8-2.6-8.4-.4-1 4.3 11.6 9.2 28.5 9.2 17 0 29.6-4.9 28.6-9.2-.5-2.2-3.4-1.1-8.4.4 0-17-9.9-23.8-20.2-23.8Z"/>\n      <path id="path9-4" fill="#000" fill-opacity=".6" d="M69.8 11.4A47.8 47.8 0 0 1 50 14a52 52 0 0 1-20.6-2.7l.4-5.2a47.8 47.8 0 0 0 19.8 2.7c8.2 0 16-.6 19.8-2.7z"/>\n    </g>\n    <path id="band" fill="rgba(49, 144, 253, 1)" d="M90.3 28c-7.8 2.3-23.4 2.8-40.1 2.8-16.8 0-34-.5-41.7-2.7l.7-5.2c7.7 2.2 23.4 2.7 40.1 2.7 16.7 0 32.3-.5 40-2.7z" />\n    <path id="tie" fill="url(#strips)" d="M47.9 70.4 54 70l4.6 45.6-9 9.1L42 115z" />\n    <path id="bowtie" fill="rgba(204, 0, 0, 1)" d="m50.7 70.7-.4 6.2 3.6-.3 11 4.9-.2-16.3-10.8 6 .2 5.6-.2-5.5-3.2-.2L39 64.6l-1 16.8L50.4 77" />\n    <g id="scarf" fill="url(#wave)" transform="translate(.6 8.7)">\n      <path d="M83.5 97c-14.8.7-30-3.2-44.5 1.2-4 1.5-7-8.6-6-5.9L28.8 81c1-4.2 21.3-2.1 12-2.5 9 .7 18.2-.2 27.3-1.1 5.4-.4 10.9-.7 16.2 0 5.4 3.7 7.4 16.5 6.2 12 .7 3 1.3 8.3-3.5 7.5a62 62 0 0 1-3.4.3z" transform="rotate(90 58 90)"/>\n      <path d="M93 49.3a49.9 49.9 0 0 1-16.8 14.5 61 61 0 0 1-40.6 5A70.5 70.5 0 0 1 6.6 51c-4.8-4.5-3.8-10-1.4-12.5.2-4 1.6-8 5.9-5 6.8 3.4 13.3 8.2 21 13.6 14.3 9.8 22.8 6.5 37.6-1.8 4.8-2.2 10.4-8 14.6-10.9 4.8-2.8 8.3-2.3 8.3 3.3-.2 3.9 2.1 8.1.4 11.6z"/>\n    </g>\n    <path id="cane" transform="translate(-55 0)" fill="#803300" d="M100.2 81.6c1.5.2 3 1 4.2 2 1.5 1.2 2.5 2.8 3.2 4.7.5 1.2.7 2.2 1 3.5v54.8c-.2 1.2-.9 2.2-1.8 2.6l-.7.1c-.6 0-.8 0-1.2-.3a3.4 3.4 0 0 1-1.4-2.1V92.6l-.2-.3c-.2-1-.5-1.7-1-2.4a4 4 0 0 0-1.4-1.2c-.8-.5-1.8-.6-2.7-.2a4.8 4.8 0 0 0-2.8 3.3 8 8 0 0 0-.2 1.8 4 4 0 0 1-.3 1.6c-.6 1.1-1.3 1.7-2.3 1.7-1 0-1.9-.7-2.3-1.9a13.1 13.1 0 0 1 1.7-8.7c.3-.6 1.3-1.8 1.7-2.3a9 9 0 0 1 4.3-2.3h2.2z"/>\n    <g id="umbrella" transform="scale(0.7 1)translate(30 -5)rotate(30.4 57.4 -17.7)">\n      <path id="path1-7" transform="rotate(7 30 -10)" fill="#333" d="m48.1 2.8 23.5 38.7 23.5 38.8v.6c1.6 3.3 2.9 6.7.1 8.1-2.7 1.5-5.1-.6-6.7-1-5.5-3.2-2.9 3.2 3.5 5.1 2.9-.2 5.3.4 7.3-2.5 1.9-2.8 2.4-5.6 1.5-8.3A39685 39685 0 0 0 51.6 1.1" display="inline"/>\n      <path id="path1-1" fill="navy" d="M18.5-44.4c-1.3.7-2 3-2 3l-3.1 2A73.3 73.3 0 0 0-14.5-7.5a64 64 0 0 0-3 10 59.1 59.1 0 0 0 10 43.7l.5.8.9-1.7A51.3 51.3 0 0 1 5.2 31.6a29.4 29.4 0 0 1 27.1-5l.3-1.1c.6-3.4 3-7.9 6.1-11.4A54.3 54.3 0 0 1 55.3 2.2c8-3.6 15.1-5.1 21.3-4.5l1.7.1.2-.8c1.1-6 3.4-10.7 7-14.7a36.1 36.1 0 0 1 16.8-9.6c2.4-.7 6.7-1.3 9.2-1.4l2.1-.1-1.4-2c-13.4-19.3-29.9-28.4-50-27.7a81.3 81.3 0 0 0-38.5 12.7l-2 1.2s-2-.6-3.2.2z"/>\n    </g>\n    <path id="bag" transform="translate(-55 0)" fill="#f4eed7" d="M82.4 100.6S80 85.9 94 86c13.8.2 11.5 14 11.5 14l-3.7-.2s1.4-11.5-8-11.5c-9.6 0-8.7 12.4-8.7 12.4s25.3-2.3 28.7 1.6c3.3 4 5.3 21.4 2.5 24.8-2.9 3.4-41.3 2.4-44.6-.2-3.4-2.7 0-21.9 2.6-24.8 2.7-3 8-1.6 8-1.6z"/>\n    <path id="balloon" transform="translate(-55 0)" fill="#fd5" d="M95.3-55.6a20 20 0 0 0-5.4 2 22.3 22.3 0 0 0-11.3 17.1 29 29 0 0 0 3 15.1 71.1 71.1 0 0 0 10.2 15 16.3 16.3 0 0 0 5.4 4c.2.2-.2.9-1.3 2.5-.7 1.2-.7 1.3-.2 1.3l.5.1 1.6.4c.4 0 .4 0 .3.3-.1.4-.2 88.7 0 89 0 .4.3.6.4.3l.2-28.9.1-60.3 1 .2 1 .2.3-.4c.2-.3.7-.6 1.1-.8.5-.2.8-.4.8-.6 0 0-.2-.5-.7-1-1-1.2-1.5-2-1.5-2.3a24.4 24.4 0 0 0 8.4-8 76 76 0 0 0 6.5-10.4 25 25 0 0 0 3.4-12.4 23.4 23.4 0 0 0-3.7-13.6c-3.1-4.6-8.1-8-13.2-8.8a39 39 0 0 0-6.9 0z" />\n  \n  </defs>\n    <foreignObject x="0" y="0" width="320" height="500"><ul id="objectives"></ul></foreignObject>\n    <foreignObject x="0" y="300" width="640" height="500"><div id="info"></div></foreignObject>\n\n    <foreignObject x="330" y="0" width="300" height="500" id="catInfo"></foreignObject>\n    <g id="gameArea">\n    ${o}\n    ${s}\n    </g>\n    <rect id="flash" x="0" y="0" width="640" height="1000" fill="#eff" opacity="0" />\n    <g id="menuBtn" transform="translate(580 10)" style="cursor:pointer">\n      <rect width="48" height="48" fill="#eee" rx="5" ry="5"/>\n      <use href="#menu" transform="scale(2)" style="cursor:pointer">\n    </g>\n    <g id="helpBtn" transform="translate(540 34)" style="cursor:pointer">\n      <rect x="-24" y="-24" width="48" height="48" fill="#eee" rx="5" ry="5"/>\n      <text font-size="48" text-anchor="middle" dominant-baseline="central">?</text>\n    </g>\n    <g id="nxtLvlBtn" style="cursor:pointer" transform="translate(320 938)">\n      <rect fill="#eee" width="250" height="40" x="-125" y="-20" rx="5" ry="5"/>\n      <text fill="#111" font-size="24" text-anchor="middle" dominant-baseline="middle">Next Level</text>\n    </g>\n    <text id="score" x="200" y="200" font-size="48" fill="green"></text>\n    <g id="end">\n    <rect fill="#eee" x="170" width="135" height="40" y="270" />\n    <text y="300" font-size="48" fill="black" font-weight="bold"></text>\n    </g>\n    <g id="blackBar" transform="translate(0 920)">\n      <rect  width="645" height="80" fill="#111" />\n      <text fill="#eee" font-size="36" transform="translate(50 54)">${e+1}</text>\n      <use id="replay" href="#restart" stroke="#eee" transform="translate(570 16)scale(2)"/>\n      <g transform="translate(320 40)" id="photo" style="cursor:pointer">\n        <circle cx="0" cy="0" r="35" fill="#eee" />\n        <use href="#camera" transform="scale(2)translate(-12 -12)" />\n        <use href="#xmark" stroke="rgba(187, 0, 0, 1)" transform="scale(4)translate(-12 -12)" />\n      </g>\n    </g>\n    <g id="overlay" />\n  </svg>\n  `;const c=function(){const e=document.querySelector("#game"),t=U(),n=document.querySelectorAll(".draggable");let a,o=null,r={x:0},l={x:0,y:0};const s=t=>{const n=e.getScreenCTM();return{x:(t.clientX-n.e)/n.a,y:(t.clientY-n.f)/n.d}},i=t=>{t.stopPropagation(),t.preventDefault(),o=t.currentTarget,o.setPointerCapture(t.pointerId),a=o.parentNode;const n=parseInt(a.dataset.index);K(),_(o,n),e.appendChild(o);const i=s(t),c=o.transform.baseVal.getItem(0).matrix;r={x:c.e,y:c.f},l={x:i.x-c.e,y:i.y-c.f}},c=e=>{if(!o)return;e.preventDefault();const t=s(e);o.setAttribute("transform",`translate(${t.x-l.x}, ${t.y-l.y})`)},d=e=>{if(!o)return;o.releasePointerCapture(e.pointerId);const i=s(e),{f:c}=o.transform.baseVal.getItem(0).matrix,{height:d,y:m}=o.getBBox();let f=null;for(const e of t){const t=e.querySelector(".row-line"),n=parseFloat(t.getAttribute("y1")),a=c+d+m;if(a>n-60&&a<=n+10){f=e;break}}let u=i.x-l.x,p=!0;f||(f=a,u=r.x,p=!1),P(o,f,u,p);const h=parseInt(f.dataset.index);n.forEach(V),K(),_(o,h),o=null},m=e=>{o=null,K(),document.querySelector("#catInfo").innerHTML=""};return n.forEach(e=>{e.addEventListener("pointerdown",i)}),e.addEventListener("pointerdown",m),e.addEventListener("pointermove",c),e.addEventListener("pointerup",d,!0),e.addEventListener("pointerleave",d),()=>{n.forEach(e=>{e.removeEventListener("pointerdown",i)}),e.removeEventListener("pointerdown",m),e.removeEventListener("pointermove",c),e.removeEventListener("pointerup",d),e.removeEventListener("pointerleave",d)}}();document.getElementById("score").textContent="",document.getElementById("photo").onclick=()=>function(e){if(document.getElementById("photo")?.classList.contains("no"))return;["objectives","info","catInfo","blackBar"].forEach(e=>{document.getElementById(e).style.display="none"});const t=j.level===g.length-1;t||(document.getElementById("nxtLvlBtn").style.display="block");const n=document.getElementById("flash");n.classList.add("fire"),n.onanimationend=()=>{document.getElementById("gameArea")?.classList.add("sepia"),n.style.animation=""},C.play(),window.setTimeout(()=>$.play(),150);const a=Array.from(document.querySelectorAll(".draggable"));let o=a.map(e=>Number(e.dataset.score)||0).reduce((e,t)=>e+t,0)/a.length;if(o=50+Math.min(15,Math.max(-15,o))*(50/15),document.getElementById("score").innerHTML="Score: "+o.toFixed(1),t){const e=document.getElementById("end");e.style.display="block",e.querySelector("text").innerHTML="<tspan font-size='30' x='300'>The Black Cat Album is full</tspan><tspan x='300' dy='70'>üì∏ Thanks, folks ! üêæ</tspan>"}const{level:r,cats:l}=j;A.levels[r]={score:o},localStorage.setItem("snapcat-levels",JSON.stringify(A)),localStorage.setItem(`snapcat-level-${r+1}`,JSON.stringify({cats:l})),e()}(c),document.getElementById("menuBtn").onclick=O,document.getElementById("helpBtn").onclick=T,document.getElementById("replay").onclick=()=>z(e,!0);const d=document.getElementById("nxtLvlBtn");d.onclick=()=>{z(e+1)},d.style.display="none";const m=document.querySelectorAll(".draggable");m.forEach(e=>{const n=t?null:j.cats[e.id];P(e,function(e){return document.querySelector(`.row[data-index="${e}"]`)}(n?.row??w(0,4)),n?.x??w(110,530))}),m.forEach(e=>V(e));const f=y[e].objectives?.map(Q).join("");document.getElementById("objectives").innerHTML=f?"<h3>Objectives</h3>"+f:"";const{doneFn:u}=y[e];u&&u(F),F(y[e].text??""),N()}function G({name:e,color:n,patterns:a,accessories:o,xScale:l,yScale:s}){"black"===n?a=a.filter(e=>"tabby"!==e):"white"===n&&(a=a.filter(e=>"tuxedo"!==e&&"tabby"!==e));const i="#100f0d",c="black"===n,d=a.includes("tabby"),m=a.includes("tuxedo");return`<g class="draggable ${m?"white":""} ${[n,,].join(" ")}" id="${e}" style="--color:${r[n]}">\n  <g transform="scale(${l} ${s})">\n    <use class="body" href="#body" fill="var(--color)" stroke="${i}" />\n    <circle class="cathead" cx="50" cy="50" r="35" fill="var(--color)" stroke="none" />\n    ${d?'<use class="tabby" href="#body" fill="url(#tabby)" stroke="none" style="mix-blend-mode:multiply"/>':""}\n    ${m?'<path class="tuxedo" fill="#fbfcfc" stroke="none" stroke-width="1" d="M5.4 93c-12.4 0 34.4 15.7 9.5 52.6 34.7 4 38.3 4.4 73.8-1.4-34.3-35.5 20-50.7 7.8-50.8-42.4-.4-35.9-58-47-73.3C37.8 38.3 53.1 93.4 5.4 93Z" />':""}\n    <use class="face" xlink:href="#content" style="${c?"stroke:#fff; mix-blend-mode:difference":"stroke:"+i}"/>\n    <path id="nose" fill="${i}" stroke="#999" stroke-linecap="butt" stroke-linejoin="miter" stroke-width="1" d="M44.8 40.9c0-1.3 9.7-1.4 9.8-.2 0 0-2.5 4.6-4.8 4.6-2.4 0-5-4.4-5-4.4Z"/>\n    <path id="ear" fill="#faa" stroke="${i}" stroke-width="1" d="m86.3 10-11.2 7 9.5 5.7Z"/>\n    <use xlink:href="#ear" id="earl" stroke-width="1" transform="matrix(-.997 0 0 .992 98 0)"/>\n    <g class="accessories">\n    ${o.sort((e,n)=>t.indexOf(e[1])-t.indexOf(n[1])).map(([e,t])=>`<use xlink:href="#${e}" class="${e} ${t}"/>`)}\n    </g>\n    <g id="hand${e}" style="${c&&!m?"stroke:#aaa":"stroke:"+i}" fill="${m?"#fbfcfc":"var(--color)"}" stroke-width="1.5" transform="translate(-.4)rotate(90,77,87)">\n      <path id="paw" d="M83.6 75.2c0-.4 1.7-7.4.2-10.4-.7-1.4-2.6-2.2-5.2-2.1h-.5c-2.5.1-5.3 1-6.2 2.6-1.5 2.8-.4 10-.4 10.4"/>\n      <path id="finger" stroke-linejoin="miter" d="M79.8 63.1v2.6"/>\n      <use xlink:href="#finger" id="finger2" transform="matrix(.988 0 0 .992 -3 .8)"/>\n    </g>\n    <use xlink:href="#hand${e}" fill="#fff" stroke-width="1" transform="matrix(-.997 0 0 .992 99.6 .5)rotate(180,78,87)"/>\n  </g>\n  \x3c!--<g transform="translate(${50*l-25} ${150*s-50})">\n    <rect width="50" height="50" fill="#eee9" />\n    <text class="score" x="25" y="12" text-anchor="middle" dominant-baseline="central" fill="#000">0</text>\n    <text class="contrib" x="25" y="38" text-anchor="middle" dominant-baseline="central" fill="#000">0</text>\n  </g>--\x3e\n  </g>`}function V(e){const t=e.parentNode,n=J(e,parseInt(t.dataset.index)).map(e=>[e.el.id,e]),a=function(e,t){let n=0;const a=I[e];return t.forEach(([t,{dist_sq:o}])=>{if(e===t)return 0;const r=Math.max(0,k-o)/k*B[a][I[t]];n+=r}),n}(e.id,n);e.dataset.score=String(a),function(e,t){const n=d.findIndex(e=>e>t);e.querySelector(".face")?.setAttribute("xlink:href",`#${m.at(n)}`)}(e,a)}function Q(e){let t="";if("fallback"===e.value)t="any other cat";else if(e.value===b)t="the <i>black cats</i>";else{const n={};e.value.forEach(([e,t])=>{n[e]?n[e].push(t):n[e]=[t]}),t="cats "+[n.cat?`the <i>${n.cat.join("/")}</i>`:"",n.color?`<i>${n.color.join("/")}</i> colored`:"",n.pattern?`<i>${n.pattern.join("/")}</i> patterned`:"",n.accessory?`with <i>${n.accessory.join("/")}</i>`:"",n.place?`with accessories on the <i>${n.place.join("/")}</i>`:""].filter(e=>""!==e).join(", ")}return`<li>${t} are <u>${{EQ:"exactly",LT:"less than",GT:"more than",LE:"at most",GE:"at least"}[e.comp]}</u> <b>${e.mood}</b></li>`}function N(){const e=y[j.level];if(!e.objectives||0===e.objectives.length)return void Z();const t=e.objectives,n=Object.values(S);let a=n.map(()=>!1),o=!0;t?.map((e,t)=>{let r=function(e,t){const n=t.map(()=>!0);if("fallback"===e.value)return n;for(const[a,o]of e.value)switch(a){case"cat":n.forEach((e,a)=>n[a]=e&&t[a].name===o);break;case"color":n.forEach((e,a)=>n[a]=e&&t[a].color===o);break;case"pattern":n.forEach((e,a)=>n[a]=e&&t[a].patterns.includes(o));break;case"accessory":n.forEach((e,a)=>n[a]=e&&t[a].accessories.some(([e,t])=>e===o));break;case"place":n.forEach((e,a)=>n[a]=e&&t[a].accessories.some(([e,t])=>t===o))}return n}(e,n);"fallback"===e.value&&(r=r.map((e,t)=>e&&!a[t])),a=a.map((e,t)=>e||r[t]&&!a[t]);const l=n.filter((e,t)=>r[t]).every(t=>{const n=document.querySelector(`#${t.name} .face`).getAttribute("xlink:href");return u[e.comp](n.slice(1),e.mood)});document.querySelectorAll("#objectives li")[t].classList.toggle("check",l),o=o&&l}),j.objectivesMet=o,Z()}function Z(){const{level:e,done:t,objectivesMet:n}=j;let a=!(t||n);"doneFn"in y[e]&&(a||=!t),document.getElementById("photo")?.classList.toggle("no",a)}function F(e,t=!1){j.done=t,document.getElementById("info").innerHTML=e?`<h3 style="text-align:center">Tutorial</h3><ul>${e}</ul>`:"",Z()}function P(e,t,n,a=!0){const{height:o,y:r}=e.getBBox(),l=o+r,s=parseFloat(t.querySelector(".row-line").getAttribute("y1"));e.setAttribute("transform",`translate(${n}, ${s-l})`),a&&X(e,t),t.appendChild(e),E.play(),j.cats[e.id]={row:parseInt(t.dataset.index),x:n}}function U(){return[...document.querySelectorAll(".row")]}function D(e){return[...e?.querySelectorAll(".draggable")??[]]}function J(e,t){const{height:n,y:a,width:o,x:r}=e.getBBox(),l=e.transform.baseVal.getItem(0).matrix,s=U();return Array.from(s).flatMap(s=>{const i=parseInt(s.dataset.index),c=t-i;return D(s).filter(t=>t!==e).map(e=>{let{dx:t,dy:s,xSpatial:i}=function(e,t,n){const{height:a,y:o,width:r,x:l}=e.getBBox(),s=e.transform.baseVal.getItem(0).matrix,i=s.e,c=s.e+r+l,d=n.e,m=n.e+t.width+t.x,f=Math.max(0,i>=d?i-m:d-c);return{dx:f,dy:Math.abs(s.f+a+o-(n.f+t.height+t.y)),xSpatial:f>0?0:i>=d&&c<=m||i<=d&&c>=m?2:1}}(e,{width:o,height:n,x:r,y:a},l);return{el:e,dRow:c,dx:t,dy:s,xSpatial:i,dist_sq:t*t+s*s}})})}function R(e,t){e.forEach(e=>e?.classList.add(t))}function W(e){document.querySelectorAll("."+e).forEach(t=>t?.classList.remove(e))}function _(e,t){const n=J(e,t).filter(({dist_sq:e})=>e>k).map(({el:e})=>e);R([e],"selected"),R(n,"far"),function(e){const t=function(e,t){const n=Object.values(S).filter(e=>e.name!==t),a=new Set(n.map(e=>e.name)),o=new Set(n.map(e=>e.color)),r=new Set(n.flatMap(e=>e.patterns)),l=new Set(n.flatMap(e=>e.accessories.map(([e])=>e))),s=new Set(n.flatMap(e=>e.accessories.map(([e,t])=>t)));return e.map(e=>{const[t,n]="likes"in e?["likes",e.likes]:["dislikes",e.dislikes],i=n.filter(t=>{switch(e.kind){case"cat":return a.has(t);case"color":return o.has(t);case"pattern":return r.has(t);case"accessory":return l.has(t);case"place":return s.has(t)}});return i.length>0?{kind:e.kind,[t]:i}:null}).filter(e=>null!==e)}(S[e].traits,e);t.forEach(t=>{const[n,a]=function(e,t){const[n,a]="likes"in e?["likes",e.likes]:["dislikes",e.dislikes];let o;switch(e.kind){case"cat":o=document.querySelectorAll(a.map(e=>`#${e}:not(#${t}) .cathead`).join(","));break;case"color":o=document.querySelectorAll(a.map(e=>`.${e}:not(#${t}) .body`).join(","));break;case"pattern":o=document.querySelectorAll(a.map(e=>`:not(#${t}) .${e}`).join(","));break;case"accessory":case"place":o=document.querySelectorAll(a.map(e=>`.draggable:not(#${t}) .${e}`).join(","))}return[n,o??[]]}(t,e);a&&R([...a],n)}),function(e,t){const n=t.map(e=>{const t=c[e.kind],[n,a]="likes"in e?[`${t}‚®Ø <span class="like">üëç</span> ${e.kind}`,e.likes]:[`${t}‚®Ø <span class="dislike">üëé</span> ${e.kind}`,e.dislikes];return 0===a.length?null:`<tr><td>${a.join(", ")}</td><td>${n}</td></tr>`}).filter(e=>null!==e).join("");document.querySelector("#catInfo").innerHTML=`<h3>Cat: ${e}</h3>\n    <table>${n}</table>`}(e,t)}(e.id),N()}function K(){W("selected"),W("far"),W("likes"),W("dislikes")}const X=(e,t)=>{const n=D(t),a=-3,o=e.transform.baseVal.getItem(0).matrix.e,{width:r,x:l}=e.getBBox(),s=o+l+r,i=o+(l+r)/2;n.filter(t=>{const{width:n,x:a}=t.getBBox();return t!==e&&t.transform.baseVal.getItem(0).matrix.e+(n+a)/2>=i}).sort((e,t)=>e.transform.baseVal.getItem(0).matrix.e-t.transform.baseVal.getItem(0).matrix.e).reduce((e,t)=>{const{width:n,x:o}=t.getBBox(),r=t.transform.baseVal.getItem(0).matrix;return r.e<e?(t.setAttribute("transform",`translate(${e}, ${r.f})`),e+n+o+a):r.e+n+o+a},s+a),n.filter(t=>{const{width:n,x:a}=t.getBBox();return t!==e&&t.transform.baseVal.getItem(0).matrix.e+(n+a)/2<i}).sort((e,t)=>t.transform.baseVal.getItem(0).matrix.e-e.transform.baseVal.getItem(0).matrix.e).reduce((e,t)=>{const n=t.transform.baseVal.getItem(0).matrix,{width:o,x:r}=t.getBBox(),l=o+r;return n.e+l>e?(t.setAttribute("transform",`translate(${e-l}, ${n.f})`),e-l-a):n.e-a},o-a)};q()</script>