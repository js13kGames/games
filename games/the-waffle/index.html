<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><style>*{margin:0;padding:0}body,html{margin:0!important;padding:0!important;overflow:hidden}body{background-color:#000}#board{margin:auto}</style></head><body><div id="board"><canvas></div><script type="text/javascript">!function(t){var e={};function i(s){if(e[s])return e[s].exports;var o=e[s]={i:s,l:!1,exports:{}};return t[s].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(s,o,function(e){return t[e]}.bind(null,o));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=4)}([function(t,e){t.exports='<svg width="50" height="150" xmlns="http://www.w3.org/2000/svg" version="1.1"><g><rect height="72" width="25" y="41" x="12" fill="silver"></rect><rect height="1" width="1" y="431" x="242" fill="silver"></rect><rect height="42" width="9" y="106" x="12" fill="silver"></rect><rect transform="rotate(12 30,127)" height="42" width="9" y="106" x="25" fill="silver"></rect><rect height="46" width="9" y="52" x="5" stroke-width="1.5" fill="silver"></rect><ellipse ry="23" rx="23" cy="24" cx="24" fill="lightblue" stroke-width="1" stroke="white"></ellipse><ellipse ry="4" rx="4" cy="14" cx="34" fill="white"></ellipse></g></svg>'},function(t,e){t.exports='<svg width="50" height="150" xmlns="http://www.w3.org/2000/svg" version="1.1"><g><rect height="72" width="25" y="41" x="12" fill="silver"></rect><rect height="1" width="1" y="431" x="242" fill="silver"></rect><rect transform="rotate(12 30,127)" height="42" width="9" y="106" x="12" fill="silver"></rect><rect height="42" width="9" y="106" x="25" fill="silver"></rect><rect height="46" width="9" y="52" x="5" stroke-width="1.5" fill="silver"></rect><ellipse ry="23" rx="23" cy="24" cx="24" fill="lightblue" stroke-width="1" stroke="white"></ellipse><ellipse ry="4" rx="4" cy="14" cx="34" fill="white"></ellipse></g></svg>'},function(t,e){t.exports='<svg width="50" height="150" xmlns="http://www.w3.org/2000/svg" version="1.1"><g><rect height="72" width="25" y="41" x="12" fill="silver"></rect><rect height="1" width="1" y="431" x="242" fill="silver"></rect><rect height="42" width="9" y="106" x="12" fill="silver"></rect><rect height="42" width="9" y="92" x="28" fill="silver"></rect><ellipse ry="23" rx="23" cy="24" cx="24" fill="lightblue" stroke-width="1" stroke="white"></ellipse><ellipse ry="4" rx="4" cy="14" cx="34" fill="white"></ellipse></g></svg>'},function(t,e){t.exports='<svg width="50" height="150" xmlns="http://www.w3.org/2000/svg" version="1.1"><g><rect height="72" width="25" y="41" x="12" fill="silver"></rect><rect height="1" width="1" y="431" x="242" fill="silver"></rect><rect height="42" width="9" y="94" x="12" fill="silver"></rect><rect height="42" width="9" y="106" x="28" fill="silver"></rect><ellipse ry="23" rx="23" cy="24" cx="24" fill="lightblue" stroke-width="1" stroke="white"></ellipse><ellipse ry="4" rx="4" cy="14" cx="34" fill="white"></ellipse></g></svg>'},function(t,e,i){"use strict";i.r(e);let s,o,h={};function r(t,...e){(h[t]||[]).map(t=>t(...e))}function n(){return o}const a=()=>{};function l(t){let e=t.canvas;t.clearRect(0,0,e.width,e.height)}function c({fps:t=60,clearCanvas:e=!0,update:i=a,render:s,context:o=n()}={}){if(!s)throw Error("You must provide a render() function");let h,c,u,g,d,m=0,f=1e3/t,y=1/t,x=e?l:a;function w(){if(c=requestAnimationFrame(w),u=performance.now(),g=u-h,h=u,!(g>1e3)){for(r("tick"),m+=g;m>=f;)d.update(y),m-=f;x(o),d.render()}}return d={update:i,render:s,isStopped:!0,start(){h=performance.now(),this.isStopped=!1,requestAnimationFrame(w)},stop(){this.isStopped=!0,cancelAnimationFrame(c)},_frame:w,set _last(t){h=t}},d}function u(t,e){return t.rotation||e.rotation?null:([t,e]=[t,e].map(t=>function(t){let{x:e,y:i,width:s,height:o}=t.world||t;t.anchor&&(e-=s*t.anchor.x,i-=o*t.anchor.y);s<0&&(e+=s,s*=-1);o<0&&(i+=o,o*=-1);return{x:e,y:i,width:s,height:o}}(t)),t.x<e.x+e.width&&t.x+t.width>e.x&&t.y<e.y+e.height&&t.y+t.height>e.y)}let g={},d={},m={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"left",ArrowUp:"up",ArrowRight:"right",ArrowDown:"down"};function f(t){let e=m[t.code];d[e]=!0,g[e]&&g[e](t)}function y(t){d[m[t.code]]=!1}function x(){d={}}function w(t){return!!d[t]}class p{constructor(t,e){this.xCount=t,this.yCount=e,this.values=[t*e]}getValue(t,e){if(!(t<0||this.xCount<=t||e<0||this.yCount<=e))return this.values[t*this.yCount+e]}setValue(t,e,i){t<0||this.xCount<=t||e<0||this.yCount<=e||(this.values[t*this.yCount+e]=i)}}const v={songData:[{i:[2,59,116,0,2,59,128,4,0,0,47,48,255,156,1,0,139,4,1,3,64,160,3,32,147,4,121,5],p:[25,2],c:[{n:[146,,,,139,,,,137,,,,140,,,,139,,,,142,,,,140,,,,144],f:[6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,27]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,139],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[146],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,238]}]}],rowLen:5513,patternLen:32,endPattern:1,numChannels:1},T={songData:[{i:[0,255,106,1,0,255,106,0,1,0,5,7,164,0,0,0,0,0,0,2,255,0,2,32,83,5,25,1],p:[1],c:[{n:[147],f:[]}]}],rowLen:5513,patternLen:20,endPattern:0,numChannels:1},b={songData:[{i:[0,192,104,1,0,80,99,0,0,0,4,0,66,0,0,3,0,0,0,1,0,1,2,32,0,12,60,8],p:[1],c:[{n:[137],f:[27,28,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,60,8]}]}],rowLen:5513,patternLen:8,endPattern:0,numChannels:1},S={songData:[{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[,,,,1,1,1,1,1,1,1,1,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[146,,,,139,,,,137,,,,140,,,,139,,,,142,,,,140,,,,144],f:[6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,27]}]},{i:[2,192,128,0,2,192,140,18,0,0,158,119,158,6,2,0,0,0,0,2,5,0,0,32,0,0,24,8],p:[1,2,1,2,1,2,1,2,1,2,1,,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[134],f:[]},{n:[127],f:[]}]},{i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,0,0,2,14,0,1,39,76,5,0,0],p:[,,,,,,,,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[125,,,,125,,,,125,,,,125,,,,125,,,,125,,,,125,,,,125],f:[]}]},{i:[0,25,128,1,0,29,128,0,1,23,4,7,41,0,0,0,60,4,1,2,255,0,0,32,61,5,32,6],p:[,,,,,,,,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,,,125,,,,,,,,125,,,,,,,,125,,,,,,125,,125],f:[10,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,23]}]},{i:[3,255,128,0,0,255,140,0,0,127,2,2,23,0,0,0,96,3,1,3,94,79,0,32,84,2,12,4],p:[,,,,,,,,,,,,1,1,1,1,1,1,1,1,1,1,1,,1,1,1],c:[{n:[,,123,,,,123,,,,123,,,,123,,,,123,,,,123,,,,123,,,,123,123],f:[]}]},{i:[0,61,104,1,0,61,104,0,1,8,4,40,21,0,0,0,231,6,1,3,183,15,0,32,232,4,74,6],p:[,,,,,,,,,,,1],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,140,139,137,135],f:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,10,10,10,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,8,25,60]}]}],rowLen:5513,patternLen:32,endPattern:31,numChannels:6},k={songData:[{i:[0,0,140,0,0,0,140,0,0,255,158,158,158,0,0,0,51,2,1,2,58,239,0,32,88,1,157,2],p:[1,2],c:[{n:[147],f:[]},{n:[],f:[]}]}],rowLen:5513,patternLen:32,endPattern:1,numChannels:1},M={songData:[{i:[0,0,104,1,0,0,104,0,1,27,0,255,255,0,0,0,198,8,1,3,183,15,0,32,255,4,74,6],p:[1,2],c:[{n:[135],f:[25,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,255]},{n:[],f:[]}]}],rowLen:5513,patternLen:32,endPattern:1,numChannels:1},P={songData:[{i:[0,36,152,0,0,255,152,12,0,0,2,0,25,0,0,0,0,0,0,2,255,0,0,32,47,3,25,2],p:[1],c:[{n:[111],f:[2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,36]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1};function C(){var t,e,i,s,o,h=function(t){return Math.sin(6.283184*t)},r=function(t){return.003959503758*Math.pow(2,(t-128)/12)},n=function(t,e,i){var s,o,h,n,l,c,u,g=a[t.i[0]],d=t.i[1],m=t.i[3],f=a[t.i[4]],y=t.i[5],x=t.i[8],w=t.i[9],p=t.i[10]*t.i[10]*4,v=t.i[11]*t.i[11]*4,T=t.i[12]*t.i[12]*4,b=1/T,S=t.i[13],k=i*Math.pow(2,2-t.i[14]),M=new Int32Array(p+v+T),P=0,C=0;for(s=0,o=0;s<p+v+T;s++,o++)o>=0&&(o-=k,c=r(e+(15&(S=S>>8|(255&S)<<4))+t.i[2]-128),u=r(e+(15&S)+t.i[6]-128)*(1+8e-4*t.i[7])),h=1,s<p?h=s/p:s>=p+v&&(h-=(s-p-v)*b),n=c,m&&(n*=h*h),l=g(P+=n)*d,n=u,x&&(n*=h*h),l+=f(C+=n)*y,w&&(l+=(2*Math.random()-1)*w),M[s]=80*l*h|0;return M},a=[h,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){var e=t%1*4;return e<2?e-1:3-e}];this.init=function(h){t=h,e=h.endPattern,i=0,s=h.rowLen*h.patternLen*(e+1)*2,o=new Int32Array(s)},this.generate=function(){var r,l,c,u,g,d,m,f,y,x,w,p,v,T,b=new Int32Array(s),S=t.songData[i],k=t.rowLen,M=t.patternLen,P=0,C=0,R=!1,Y=[];for(c=0;c<=e;++c)for(m=S.p[c],u=0;u<M;++u){var A=m?S.c[m-1].f[u]:0;A&&(S.i[A-1]=S.c[m-1].f[u+M]||0,A<16&&(Y=[]));var X=a[S.i[15]],V=S.i[16]/512,D=Math.pow(2,S.i[17]-9)/k,O=S.i[18],L=S.i[19],E=43.23529*S.i[20]*3.141592/44100,_=1-S.i[21]/255,W=1e-5*S.i[22],F=S.i[23]/32,H=S.i[24]/512,I=6.283184*Math.pow(2,S.i[25]-9)/k,B=S.i[26]/255,G=S.i[27]*k&-2;for(w=(c*M+u)*k,g=0;g<4;++g)if(d=m?S.c[m-1].n[u+g*M]:0){Y[d]||(Y[d]=n(S,d,k));var j=Y[d];for(l=0,r=2*w;l<j.length;l++,r+=2)b[r]+=j[l]}for(l=0;l<k;l++)(x=b[f=2*(w+l)])||R?(p=E,O&&(p*=X(D*f)*V+.5),C+=(p=1.5*Math.sin(p))*(v=_*(x-C)-(P+=p*C)),x=3==L?C:1==L?v:P,W&&(x=(x*=W)<1?x>-1?h(.25*x):-1:1,x/=W),R=(x*=F)*x>1e-5,T=x*(1-(y=Math.sin(I*f)*H+.5)),x*=y):T=0,f>=G&&(T+=b[f-G+1]*B,x+=b[f-G]*B),b[f]=0|T,b[f+1]=0|x,o[f]+=0|T,o[f+1]+=0|x}return++i/t.numChannels},this.createWave=function(){var t=44+2*s-8,e=t-36,i=new Uint8Array(44+2*s);i.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var h=0,r=44;h<s;++h){var n=o[h];n=n<-32767?-32767:n>32767?32767:n,i[r++]=255&n,i[r++]=n>>8&255}return i},this.getData=function(t,e){for(var i=2*Math.floor(44100*t),s=new Array(e),h=0;h<2*e;h+=1){var r=i+h;s[h]=t>0&&r<o.length?o[r]/32768:0}return s}}const R=document.createElement("audio"),Y=document.createElement("audio"),A=document.createElement("audio"),X=document.createElement("audio"),V=document.createElement("audio"),D=document.createElement("audio"),O=document.createElement("audio"),L=(t,e,i)=>new Promise(s=>{var o=new C;o.init(e);var h=!1;setInterval((function(){if(!h&&(h=o.generate()>=1)){var e=o.createWave();t.src=URL.createObjectURL(new Blob([e],{type:"audio/wav"})),t.loop=i,s()}}),0)}),E=(t,e=0)=>{var i=t.volume;if(t.volume>e)var s=setInterval((function(){(i=(parseFloat(i)-.1).toFixed(1))>e?t.volume=i:(t.volume=e,0===e&&t.pause(),clearInterval(s))}),100)},_=(t,e=1)=>{t.play();var i=t.volume;if(t.volume<e)var s=setInterval((function(){(i=(parseFloat(i)+.1).toFixed(1))<e?t.volume=i:(t.volume=e,clearInterval(s))}),100)},W=t=>{switch(t){case"main":X.volume>0&&E(X),V.volume>0&&E(V),_(R,.9);break;case"end":_(A,.5),_(V,.2),X.currentTime=0,_(X,.8),E(R);break;case"jump":Y.currentTime=0,Y.play();break;case"empty":_(V,.2),E(R,.05);break;case"laser":_(D,.2);break;case"switch":O.currentTime=0,O.volume=.4,O.play();break;case"finished":_(V,.2),E(R,.05);break;case"start":V.volume=0,_(V,.2);var e=V.play();void 0!==e&&e.then(()=>{}).catch(t=>{console.log("No for autoplay!"+t)}),E(D),E(R),E(X),R.currentTime=0}},F=40;const H=(t,e,i)=>({width:10,height:t,drawHeight:i||t,perspective:e,render(t){const e=this.drawHeight/5,i=1===this.perspective?this.width:5,s=1===this.perspective?(this.height-this.drawHeight)/2:this.height-this.drawHeight;let o=i/3;0===this.perspective?o=0:2===this.perspective&&(o=2*i/3),t.save(),t.translate(this.x,this.y),t.fillStyle="rgb(60,60,60)",t.fillRect(o,s,i/3,this.drawHeight);for(let o=0;o<e;o++)t.fillStyle="rgb(60,30,30)",t.fillRect(0,s+5*o+2.5,i,2.5);t.restore()}}),I=t=>3===t||404===t||0===t;class B{constructor(t,e,i,s,o){this.ladders=[],this.lasers=[],this.setPosition(t,e,i,s),this.isMissing=o.isMissing,this.isExit=o.isExit||!1,this.isFinish=o.isFinish||!1,this.isFinish&&(this.height=130,this.bottom=this.y+130,this.roomEnterTime=performance.now()),this.text=o.text||void 0,this.textX=this.x+.2*this.width+Math.random()*this.width/8,this.textY=this.y+.78*this.height,this.textAngle=-Math.PI/20+Math.random()*Math.PI/10,this.doors={left:2,right:2,top:2,bottom:2},this.wires=o.wires||{},this.xMoveDirection=0,this.actions=o.actions||[],void 0!==o.switch&&(this.switch={x:this.x+182,y:this.y+195,width:20,height:50,on:o.switch,lastToggleTime:performance.now()}),this.isMissing||this.isFinish||this.addLadders()}setPosition(t,e,i,s){const o=this.x,h=this.y;this.outerX=t,this.outerY=e,this.x=t+20,this.y=e+20,this.ix=i,this.iy=s,this.right=this.x+260,this.bottom=this.y+260,this.width=260,this.height=260;const r=this.x-o,n=this.y-h;for(let t=0;t<this.ladders.length;t++){const e=this.ladders[t];e.x+=r,e.y+=n}for(let t=0;t<this.lasers.length;t++){const e=this.lasers[t];null!=e.x?e.x+=r:e.y+=n}this.switch&&(this.switch.x+=r,this.switch.y+=n)}hasWires(){const t=this.wires;return t&&(t.left||t.right||t.top||t.bottom)}hasActions(){return this.actions&&this.actions.length>0}toggleAction(t){for(let e=0;e<this.actions.length;e++){switch(this.actions[e]){case 1:this.xMoveDirection=t?1:-1;break;case 2:t?this.lasers.push({x:this.x+.75*this.width,speed:.5}):this.lasers=[];break;case 3:t?this.lasers.push({y:this.y+.25*this.height,speed:-.5}):this.lasers=[]}}}resetTraps(t){for(let e=0;e<this.lasers.length;e++){const i=this.lasers[e];null!=i.x?(i.x=this.x+.4*this.width,t.x<this.x+.25*this.width?i.speed=.5:i.speed=-.5):(i.y=this.y+.4*this.height,t.y<this.y+.25*this.height?i.speed=.5:i.speed=-.5)}this.roomEnterTime=performance.now()}addLadders(){const t=H(260,1,220);t.x=this.x+130-t.width/2,t.y=this.y,this.ladders.push(t);const e=H(130,0,90);e.x=this.x,e.y=this.y+130-5,this.ladders.push(e);const i=H(130,2,90);i.x=this.x+260-i.width+5,i.y=this.y+130-5,this.ladders.push(i)}getOuterBoundingBox(){return{x:this.outerX,y:this.outerY,width:300,height:300}}isAtLeftDoor(t){return I(this.doors.left)&&t.x-this.x<10&&(0===this.doors.left||this.atDoorY(t))}isAtRightDoor(t){return I(this.doors.right)&&this.right-(t.x+t.width)<10&&(0===this.doors.right||this.atDoorY(t))}isAtTopDoor(t){return I(this.doors.top)&&t.y-this.y<-10&&(0===this.doors.top||this.atDoorX(t))}isAtBottomDoor(t){return I(this.doors.bottom)&&this.bottom-(t.y+t.height)<10&&(0===this.doors.bottom||this.atDoorX(t))}atDoorX(t){return this.x+90-13<t.x&&t.x+t.width<this.right-90+13}atDoorY(t){return this.y+90-13<t.y&&t.y+t.height<this.bottom-90+13}update(t,e){for(let e=0;e<this.lasers.length;e++){const i=this.lasers[e];if(null!=i.x){if(i.x+=i.speed,i.x<this.x?i.speed=.5:this.right<i.x&&(i.speed=-.5),t.x+3<i.x&&i.x<t.x+t.width-3)return 1}else if(i.y+=i.speed,i.y<this.y?i.speed=.5:this.bottom<i.y&&(i.speed=-.5),t.y+5<i.y&&i.y<t.y+t.height-5)return 1}return this.switch&&u(t,this.switch)&&w("space")&&300<performance.now()-this.switch.lastToggleTime&&(this.switch.on=!this.switch.on,this.switch.lastToggleTime=performance.now(),e(this.switch.on)),this.isFinish?4:0}render(t){if(t.save(),this.isFinish)return W("empty"),this.renderFinishScreen(t),void t.restore();this.isMissing||(this.renderRoom(t),this.renderWallTexts(t)),this.renderWires(t),this.renderDoors(t);for(let e=0;e<this.ladders.length;e++)this.ladders[e].render(t);this.renderConnectionBox(t),this.renderLasers(t),t.restore()}renderFinishScreen(t){const e=t.createLinearGradient(this.outerX+300,this.outerY,this.outerX,this.outerY+300);e.addColorStop(0,"#303090"),e.addColorStop(.5,"#000"),e.addColorStop(1,"#000"),t.fillStyle=e,t.fillRect(this.outerX,this.outerY,300,300);const i=t.createLinearGradient(this.outerX,this.outerY,this.outerX+300,this.y+this.height+5);i.addColorStop(0,"#333"),i.addColorStop(1,"#aaa"),t.fillStyle=i,t.fillRect(this.outerX,this.y+this.height,300,5),t.fillStyle="#F0F0F0",t.font="bold 36px Sans-serif";const s=(performance.now()-this.roomEnterTime)/3e3,o=Math.min(1,(h=s,1-Math.pow(1-h,3)));var h;t.fillText("YOU GOT OUT!",this.x+0,this.y+o*this.height),t.font="bold 16px Sans-serif",t.fillText("Game finished, well done.",this.x+0,this.y+o*this.height*2)}renderWallTexts(t){if(this.text){t.save(),t.fillStyle="rgb(170,170,150)",t.font="6px cursive";const e=t.measureText(this.text).width,i=t.measureText("M").width;t.translate(this.textX,this.textY),t.rotate(this.textAngle),t.translate(-e/2,-i/2),t.fillText(this.text,0,0),t.restore()}}renderConnectionBox(t){if(this.switch){const e=this.switch;t.fillStyle="gray",t.fillRect(e.x,e.y,20,30),t.fillStyle="black",t.fillRect(e.x+5,e.y+5,10,20),t.fillStyle="brown";const i=e.on?e.y+3:e.y+30-8;t.fillRect(e.x,i,20,5)}else this.hasWires()&&(t.fillStyle="rgb(60,60,60)",t.fillRect(this.x+182,this.y+195,20,20));if(this.hasActions()&&(this.hasWires()||this.switch)){let e=this.x+182,i=this.y+195;this.switch&&(e+=20),t.fillStyle="rgb(60,60,60)",t.fillRect(e,i,30,30);for(let s=0;s<this.actions.length;s++){const o=this.actions[s];this.renderActionSymbol(t,o,e+2,i+2)}}}renderActionSymbol(t,e,i,s){switch(e){case 1:t.fillStyle=this.xMoveDirection<0?"rgb(0,220,0)":"rgb(0,50,0)",t.beginPath(),t.moveTo(i+11,s+5),t.lineTo(i+11,s+20),t.lineTo(i+3,s+12.5),t.fill(),t.fillStyle=this.xMoveDirection>0?"rgb(0,220,0)":"rgb(0,50,0)",t.beginPath(),t.moveTo(i+14,s+5),t.lineTo(i+14,s+20),t.lineTo(i+22,s+12.5),t.fill();break;case 2:case 3:t.strokeStyle=this.lasers.length?"rgb(0,220,0)":"rgb(0,50,0)",t.beginPath(),t.moveTo(i+13,s+5),t.lineTo(i+13,s+20),t.stroke()}}renderWires(t){const e=this.wires;t.strokeStyle="rgb(0,0,150)",t.lineWidth=3,e.left&&(t.beginPath(),t.moveTo(this.x+20,this.y+195+10),t.lineTo(this.x+182,this.y+195+10),t.stroke()),e.right&&(t.beginPath(),t.moveTo(this.x+182,this.y+195+10),t.lineTo(this.right-20,this.y+195+10),t.stroke()),e.top&&(t.beginPath(),t.moveTo(this.x+182+10,this.y+20),t.lineTo(this.x+182+10,this.y+195),t.stroke()),e.bottom&&(t.beginPath(),t.moveTo(this.x+182+10,this.y+195),t.lineTo(this.x+182+10,this.bottom-20),t.stroke())}renderRoom(t){let e="#10000080",i="#40101080";(this.ix%2==0&&this.iy%2!=0||this.ix%2!=0&&this.iy%2==0)&&(e="#00001080",i="#00104080");const s="#101010a0";if(this.isExit){const e=t.createLinearGradient(this.outerX,this.outerY,this.outerX+300,this.outerY);e.addColorStop(0,"#00100080"),e.addColorStop(1,"#00401080"),t.fillStyle=e,t.fillRect(this.outerX,this.outerY,300,300)}if(t.lineWidth=8,t.strokeStyle=s,t.beginPath(),t.moveTo(this.outerX,this.outerY),t.lineTo(this.outerX+F,this.outerY+F),t.stroke(),t.strokeStyle="#202020",t.beginPath(),t.moveTo(this.outerX+F,this.outerY+F),t.lineTo(this.outerX+300-F,this.outerY+F),t.stroke(),t.strokeStyle="#303030",t.beginPath(),t.moveTo(this.outerX+300-F,this.outerY+F),t.lineTo(this.outerX+300,this.outerY),t.stroke(),t.strokeStyle=s,t.fillStyle=s,t.beginPath(),t.moveTo(this.outerX,this.outerY+300),t.lineTo(this.outerX+F,this.outerY+300-F),t.stroke(),t.strokeStyle="#202020",t.beginPath(),t.moveTo(this.outerX+F,this.outerY+300-F),t.lineTo(this.outerX+300-F,this.outerY+300-F),t.stroke(),t.strokeStyle="#303030",t.beginPath(),t.moveTo(this.outerX+300-F,this.outerY+300-F),t.lineTo(this.outerX+300,this.outerY+300),t.stroke(),t.strokeStyle="#202020",t.beginPath(),t.moveTo(this.outerX+F,this.outerY+F),t.lineTo(this.outerX+F,this.outerY+300-F),t.stroke(),t.beginPath(),t.moveTo(this.outerX+300-F,this.outerY+F),t.lineTo(this.outerX+300-F,this.outerY+300-F),t.stroke(),t.lineWidth=4,t.beginPath(),t.moveTo(this.outerX+150,this.outerY+F),t.lineTo(this.outerX+150,this.outerY+300-F),t.stroke(),t.beginPath(),t.moveTo(this.outerX+F,this.outerY+150),t.lineTo(this.outerX+300-F,this.outerY+150),t.fill(),t.stroke(),t.strokeStyle=s,t.beginPath(),t.moveTo(this.outerX+150,this.outerY),t.lineTo(this.outerX+150,this.outerY+F),t.stroke(),t.strokeStyle="#303030",t.beginPath(),t.moveTo(this.outerX+150,this.outerY+300-F),t.lineTo(this.outerX+150,this.outerY+300),t.fill(),t.stroke(),t.strokeStyle=s,t.beginPath(),t.moveTo(this.outerX,this.outerY+150),t.lineTo(this.outerX+F,this.outerY+150),t.stroke(),t.strokeStyle="#303030",t.beginPath(),t.moveTo(this.outerX+300-F,this.outerY+150),t.lineTo(this.outerX+300,this.outerY+150),t.fill(),t.stroke(),t.strokeStyle="#606060",t.lineWidth=5,t.beginPath(),t.lineTo(this.outerX,this.outerY),t.lineTo(this.outerX+300,this.outerY),t.lineTo(this.outerX+300,this.outerY+300),t.lineTo(this.outerX,this.outerY+300),t.closePath(),t.stroke(),!this.isExit){const s=t.createLinearGradient(this.outerX,this.outerY,this.outerX+300,this.outerY+300);s.addColorStop(0,e),s.addColorStop(1,i),t.fillStyle=s,t.fillRect(this.outerX,this.outerY,300,300)}}renderDoors(t){t.fillStyle=this.getDoorColor(this.doors.top),t.beginPath(),t.moveTo(this.x+130-300/260*80/2,this.y-10),t.lineTo(this.x+130+300/260*80/2,this.y-10),t.lineTo(this.x+130+40,this.y+5),t.lineTo(this.x+130-40,this.y+5),t.fill(),t.fillStyle=this.getDoorColor(this.doors.bottom),t.beginPath(),t.moveTo(this.x+130-300/260*80/2,this.bottom+10),t.lineTo(this.x+130+300/260*80/2,this.bottom+10),t.lineTo(this.x+130+40,this.bottom-5),t.lineTo(this.x+130-40,this.bottom-5),t.fill(),t.fillStyle=this.getDoorColor(this.doors.left),t.beginPath(),t.moveTo(this.x-10,this.y+130-300/260*80/2),t.lineTo(this.x-10,this.y+130+300/260*80/2),t.lineTo(this.x+10,this.y+130+40),t.lineTo(this.x+10,this.y+130-40),t.fill(),t.fillStyle=this.getDoorColor(this.doors.right),t.beginPath(),t.moveTo(this.right+10,this.y+130-300/260*80/2),t.lineTo(this.right+10,this.y+130+300/260*80/2),t.lineTo(this.right-10,this.y+130+40),t.lineTo(this.right-10,this.y+130-40),t.fill()}renderLasers(t){for(let e=0;e<this.lasers.length;e++){const i=this.lasers[e];t.strokeStyle="red",t.lineWidth=Math.random()<.1?2:1,t.beginPath(),null!=i.x?(t.moveTo(i.x,this.y),t.lineTo(i.x,this.bottom)):(t.moveTo(this.x,i.y),t.lineTo(this.right,i.y)),t.stroke()}}getDoorColor(t){switch(t){case 3:return"green";case 2:return"red";case 404:{const t=Math.floor(performance.now()/1e3)%2==0;return this.isMissing?t?"rgb(60, 0, 0)":"transparent":t?"red":"gray"}default:return"transparent"}}}class G{constructor(){this.x=0,this.y=0,this.zoom=1,this.shakeXPower=0,this.shakeYPower=0,this.shakeXDecay=0,this.shakeYDecay=0}zoomTo(t){if(this.area=t,!t)return;this.x=t.x+t.width/2,this.y=t.y+t.height/2;const e=s;t.width/t.height>=e.width/e.height?this.zoom=e.width/t.width:this.zoom=e.height/t.height}panTo(t){this.area=t}shake(t=8,e=8,i=.5){this.shakeXPower=Math.abs(t),this.shakeYPower=Math.abs(e),this.shakeXDecay=Math.abs(t)/i,this.shakeYDecay=Math.abs(e)/i}update(){if(!this.area)return;const t=this.area,e=t.x+t.width/2,i=t.y+t.height/2;this.x<e-15?this.x+=15:this.x>e+15?this.x-=15:this.x=e,this.y<i-15?this.y+=15:this.y>i+15?this.y-=15:this.y=i,this._shake()}_shake(){const{shakeXPower:t,shakeYPower:e,shakeXDecay:i,shakeYDecay:s}=this;t>0&&(this.x+=Math.random()*t*2-t,this.shakeXPower-=i*(1/60)),e>0&&(this.y+=Math.random()*e*2-e,this.shakeYPower-=s*(1/60))}}const j=t=>{let e=new Image;const i=btoa(t);return e.src="data:image/svg+xml;base64,"+i,e};class z{constructor(t,e){this.frames=t,this.fps=e||0,this.startTime=this.currentTime=performance.now()}advance(){this.currentTime+=1e3/60}getImage(){let t=0;const e=(this.currentTime-this.startTime)/1e3;return t=Math.floor(e*this.fps)%this.frames.length,this.frames[t]}}var U=i(0),N=i.n(U),q=i(1),J=i.n(q),K=i(2),Q=i.n(K),Z=i(3),$=i.n(Z);const tt=[j(N.a),j(J.a)],et=[j(Q.a),j($.a)];let it=0;class st{constructor(){this.x=0,this.y=0,this.width=10,this.height=30,this.xVel=0,this.yVel=0,this.latestOnPlatformTime=0,this.state=0,this.hstate=1,this.stopClimbing=!1,this.walkingAnimation=new z(tt,10),this.climbingAnimation=new z(et,10)}render(t){t.save();const e=(2===this.state?this.climbingAnimation:this.walkingAnimation).getImage();t.translate(this.x,this.y),t.scale(10/e.width,30/e.height),2!==this.hstate&&0!==this.hstate||(t.translate(e.width/2,0),t.scale(-1,1),t.translate(-e.width/2,0)),t.drawImage(e,0,0),t.restore()}_isOnGround(t){return this.y+this.height>t.bottom-5}_findLadderCollision(t){let e,i;for(let s=0;s<t.length;s++){let o=t[s];u(o,this)&&(e=o,o.y<this.y&&this.y<o.y+o.height&&(i=!0))}return{ladder:e,collidesHigh:i}}do_update(t,e,i){const s=performance.now(),o=this._findPlatform(i);o&&(this.latestOnPlatformTime=s);let h={dx:0,dy:0},r=this._findLadderCollision(e);r.ladder||2!==this.state?h=this._handleControls(s,t,r,o):this.state=1;let{dx:n,dy:a}=h;0!==this.xVel&&(n+=this.xVel,Math.abs(this.xVel)>4?this.xVel*=.97:this.xVel=0),1===this.state&&(this.yVel+=1,a+=this.yVel),this._updateVerticalPosition(t,o,a),this._updateHorizontalPosition(t,n)}isMovingLeft(){return w("left")||w("a")}isMovingRight(){return w("right")||w("d")}isMovingUp(){return w("up")||w("w")}isMovingDown(){return w("down")||w("s")}_handleControls(t,e,i,s){const o=this.hstate;let h=0,r=0;this.isMovingLeft()?(h=-4,2!==o&&(this.hstate=2),this.walkingAnimation.advance()):this.isMovingRight()?(h=4,3!==o&&(this.hstate=3),this.walkingAnimation.advance()):o>1&&(this.hstate=2===o?0:1);const n=this.isMovingUp(),a=this.isMovingDown();return n||(this.stopClimbing=!1,this._isOnGround(e)&&it>0&&(W("jump"),it=0)),n&&this._isOnGround(e)&&it++,n&&!this.stopClimbing?(2===this.state&&0===h&&s&&!i.collidesHigh?(this.state=0,this.stopClimbing=!0):!(s||t-this.latestOnPlatformTime<200||this._isOnGround(e))||0===h&&i.collidesHigh?this.yVel>=0&&i.ladder&&(this.state=2,this.yVel=0,r-=2):(this.yVel=-12,this.state=1,this.latestOnPlatformTime=0),2===this.state&&this.climbingAnimation.advance()):a&&i.ladder&&(this.state=2,this.yVel=0,r+=2,this.climbingAnimation.advance()),2===this.state&&(n||a)&&(this.x=i.ladder.x,h=0),{dx:h,dy:r}}_updateHorizontalPosition(t,e){this.x+this.width+e>t.right&&!t.isAtRightDoor(this)?(this.x=t.right-this.width,this.xVel=0):this.x+e<t.x&&!t.isAtLeftDoor(this)?(this.x=t.x,this.xVel=0):0!==e&&(this.x+=e)}_updateVerticalPosition(t,e,i){if(this.y+this.height+i>t.bottom)this.y=t.bottom-this.height,this.state=0,this.yVel=0;else if(this.fallingToGround)this.state=1,this.y+=i;else if(2===this.state)this.y+=i;else if(i>0&&e){const t=5;this.y=e.y-this.height+t,this.yVel=0,this.state=0}else this.state=1,this.y+=i}_findPlatform(t){for(let e=0;e<t.length;e++){let i=t[e];if(u(this,i)&&this.y+this.height<i.y+i.height)return i}return null}}const ot={9:"12 Sept FIND WAY OUT",0:"WHERE Am I ?",1:"THERES NO WAY OUT",2:"LONG WAY DoWN",3:"LOST 404"},ht=[";    ;    ;    ;    ;    ;    ;    ;    ;    ;    ;    ;",";    ;    ;    ;    ;    ;    ;    #    #|-  #    ;    ;",";    ;    ;    ;    ;    ;    ;    #    #    #    E    F",";    ;    ;    ;    ;    ;    ;    #3   #|   #    ;    ;",";    ;    ;    ;    ;    ;    ;    #    .    ;    ;    ;",";    -    #1   #    .    ;    ;    .    #Hb  ;    ;    ;","#9@  |-b  |-   ;    #2   H*   .    #tr  #^lt #-   ;    ;",";    #t^0 ;    ;    .    ;    .    ;    ;    ;    ;    ;",".    #    ;    ;    .    ;    .    ;    ;    ;    ;    ;",".    ;    ;    ;    .    ;    .    ;    ;    ;    ;    ;","#    #    #    ;    .    ;    .    ;    ;    ;    ;    ;",";    ;    ;    ;    .    ;    .    ;    ;    ;    ;    ;"],rt=(t,e)=>{const i=e.getValue(t.ix+1,t.iy),s=e.getValue(t.ix,t.iy-1),o=e.getValue(t.ix,t.iy+1),h=t.wires.right&&i&&rt(i,e),r=t.wires.top&&s&&at(s,e),n=t.wires.bottom&&o&&lt(o,e);return t.wires.left&&(t.hasActions()?t:h||r||n)},nt=(t,e)=>{const i=e.getValue(t.ix-1,t.iy),s=e.getValue(t.ix,t.iy-1),o=e.getValue(t.ix,t.iy+1),h=t.wires.left&&i&&nt(i,e),r=t.wires.top&&s&&at(s,e),n=t.wires.bottom&&o&&lt(o,e);return t.wires.right&&(t.hasActions()?t:h||r||n)},at=(t,e)=>{const i=e.getValue(t.ix-1,t.iy),s=e.getValue(t.ix+1,t.iy),o=e.getValue(t.ix,t.iy-1),h=t.wires.right&&s&&rt(s,e),r=t.wires.left&&i&&nt(i,e),n=t.wires.top&&o&&at(o,e);return t.wires.bottom&&(t.hasActions()?t:h||r||n)},lt=(t,e)=>{const i=e.getValue(t.ix-1,t.iy),s=e.getValue(t.ix+1,t.iy),o=e.getValue(t.ix,t.iy+1),h=t.wires.right&&s&&rt(s,e),r=t.wires.left&&i&&nt(i,e),n=t.wires.bottom&&o&&lt(o,e);return t.wires.top&&(t.hasActions()?t:h||r||n)},ct=(t,e)=>{if(t.hasActions())return t;const i=e.getValue(t.ix-1,t.iy),s=e.getValue(t.ix+1,t.iy),o=e.getValue(t.ix,t.iy-1),h=e.getValue(t.ix,t.iy+1),r=t.wires.right&&s&&rt(s,e),n=t.wires.left&&i&&nt(i,e),a=t.wires.top&&o&&at(o,e),l=t.wires.bottom&&h&&lt(h,e);return r||n||a||l};class ut{constructor(){let{rooms:t,startRoom:e}=(()=>{const t=new p(ht[0].split(/ +/).length,ht.length);let e;for(let i=0;i<ht.length;i++){const s=ht[i].split(/ +/);for(let o=0;o<s.length;o++){const h=s[o];let r;if(h.includes(";"))r=null;else{const t={wires:{left:!1,right:!1,top:!1,bottom:!1},actions:[]};t.isMissing=h.includes("."),t.isExit=h.includes("E"),t.isFinish=h.includes("F"),t.switch=!!h.includes("^")||!h.includes("*")&&void 0,h.includes("|")&&t.actions.push(2),h.includes("-")&&t.actions.push(3),h.includes("H")&&t.actions.push(1);const s=h.match(/[0-9]/);if(s){const e=s[0];ot[e]&&(t.text=ot[e])}t.wires.left=h.includes("l"),t.wires.right=h.includes("r"),t.wires.top=h.includes("t"),t.wires.bottom=h.includes("b");r=new B(330*o,330*i,o,i,t),h.includes("@")&&(e=r)}t.setValue(o,i,r)}}return{rooms:t,startRoom:e}})();this.rooms=t,this.x=0,this.y=0,this.width=330*this.rooms.xCount,this.height=330*this.rooms.yCount,this.updateDoors(),this.currentRoom=e,this.lastAutoMoveTime=performance.now(),this.player=new st,this.player.x=this.currentRoom.x+30,this.player.y=this.currentRoom.bottom-this.player.height,this.camera=new G,this.camera.zoomTo(this.currentRoom.getOuterBoundingBox()),this.gameOverState=0,this.setInitialActionStates()}setInitialActionStates(){for(let t=0;t<this.rooms.xCount;t++)for(let e=0;e<this.rooms.yCount;e++){const i=this.rooms.getValue(t,e);if(i)if(i.switch){const t=ct(i,this.rooms);t&&t.toggleAction(i.switch.on)}else i.hasActions()&&!i.hasWires()&&i.toggleAction(!0)}}autoMoveRooms(){const t=performance.now();if(t-this.lastAutoMoveTime>500){for(let e=0;e<this.rooms.xCount;e++)for(let i=0;i<this.rooms.yCount;i++){const s=this.rooms.getValue(e,i);if(s&&s.xMoveDirection&&t-this.lastAutoMoveTime>500){const t=this.rooms.getValue(s.ix+s.xMoveDirection,s.iy);t&&t.isMissing&&this.moveRoom(s,s.xMoveDirection,0)}}this.lastAutoMoveTime=t}}moveRoom(t,e,i){if(t.isMissing)return;const s=t.ix,o=t.iy,h=t.ix+e,r=t.iy+i,n=t.outerX,a=t.outerY,l=this.rooms.getValue(h,r);if(l&&l.isMissing){const c=330*h,u=330*r,g=c-n,d=u-a;if(this.rooms.setValue(h,r,t),t.setPosition(c,u,h,r),this.rooms.setValue(s,o,new B(n,a,s,o,{isMissing:!0})),this.updateDoors(),t===this.currentRoom)this.player.x+=g,this.player.y+=d,this.moveCameraTo(t),this.camera.shake(20*e,20*i);else if(l===this.currentRoom)return void(this.gameOverState=2)}}updateDoors(){const t=this.rooms,e=(t,e)=>t.isMissing&&!e?1:t.isMissing&&e.isMissing?0:e?e.isMissing||t.isMissing&&!e.isMissing?404:3:2;for(let i=0;i<t.xCount;i++)for(let s=0;s<t.yCount;s++){const o=t.getValue(i,s);o&&(o.doors.left=e(o,t.getValue(i-1,s)),o.doors.right=e(o,t.getValue(i+1,s)),o.doors.top=e(o,t.getValue(i,s-1)),o.doors.bottom=e(o,t.getValue(i,s+1)))}}toggleSwitch(t){W("switch");const e=ct(this.currentRoom,this.rooms);e&&e.toggleAction(t)}update(){this.autoMoveRooms();const t=this.currentRoom.update(this.player,this.toggleSwitch.bind(this));0!==t&&4!==t&&t!==this.gameOverState&&(this.gameOverState=t),0!==this.gameOverState&&4!==this.gameOverState||(this.player.do_update(this.currentRoom,this.currentRoom.ladders,[]),this.checkRoomChange()),this.camera.update()}checkRoomChange(){this.player.x>this.currentRoom.right&&this.player.isMovingRight()?this.enterRoom(this.player,1,0):this.player.x+this.player.width<this.currentRoom.x&&this.player.isMovingLeft()?this.enterRoom(this.player,-1,0):(this.player.isMovingDown()||this.isEmptyHereAndBelow(this.currentRoom))&&this.currentRoom.isAtBottomDoor(this.player)?this.enterRoom(this.player,0,1):this.currentRoom.isMissing&&this.currentRoom.iy>=this.rooms.yCount-1?this.gameOverState=3:this.player.isMovingUp()&&this.currentRoom.isAtTopDoor(this.player)&&this.enterRoom(this.player,0,-1)}isEmptyHereAndBelow(t){const e=this.rooms.getValue(t.ix,t.iy+1);return t.isMissing&&e&&e.isMissing}enterRoom(t,e,i){const s=this.currentRoom,o=s.ix+e,h=s.iy+i,r=this.rooms.getValue(o,h);r&&(r.isMissing?W("empty"):W("main"),r.lasers.length>0?W("laser"):(t=>{switch(t){case"main":E(R);break;case"end":E(X),E(V);break;case"empty":E(V);break;case"laser":E(D)}})("laser"),this.currentRoom=r,e>0?t.x<r.x&&(t.x=r.x):e<0&&r.right<t.x+t.width&&(t.x=r.right-t.width),i>0?(t.y=r.y,t.x=r.x+r.width/2):i<0&&(t.y=r.bottom-t.height),r.resetTraps(t),this.panCameraTo(r))}moveCameraTo(t){this.camera.area!==this&&this.camera.zoomTo(t.getOuterBoundingBox())}panCameraTo(t){this.camera.area!==this&&this.camera.panTo(t.getOuterBoundingBox())}render(t,e){const i=this.camera;e.save(),e.translate(t.width/2,t.height/2),e.scale(i.zoom,i.zoom),e.translate(-i.x,-i.y);if(i.area===this)for(let t=0;t<this.rooms.xCount;t++)for(let i=0;i<this.rooms.yCount;i++){const s=this.rooms.getValue(t,i);s&&s.render(e)}else this.currentRoom.render(e);0!==this.gameOverState&&4!==this.gameOverState||this.player.render(e),e.restore()}}let gt=!1,dt=!1,mt=!0;const{canvas:ft,context:yt}=function(t){if(s=document.getElementById(t)||t||document.querySelector("canvas"),!s)throw Error("You must provide a canvas element for the game");return o=s.getContext("2d"),o.imageSmoothingEnabled=!1,r("init"),{canvas:s,context:o}}();!function(){let t;for(t=0;t<26;t++)m[t+65]=m["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)m[48+t]=m["Digit"+t]=""+t;window.addEventListener("keydown",f),window.addEventListener("keyup",y),window.addEventListener("blur",x)}();const xt=()=>{ft.width=window.innerWidth-10,ft.height=window.innerHeight-10};let wt;window.addEventListener("resize",xt,!1),xt();const pt=(t,...e)=>{t.fillStyle="white",t.font="32px cursive";for(let i=0;i<e.length;i++){const s=e[i];let o=14*s.length;const h=ft.width/2-o/2;let r=.35*ft.height+50*i;t.fillText(s,h,r)}},vt=t=>{bt.stop(),0===t?(bt=Tt(),W("start")):(bt=c({update:function(){wt.update()},render:function(){switch(wt.render(ft,yt),!dt&&wt.gameOverState&&(dt=!0,4!==wt.gameOverState&&W("end")),wt.gameOverState){case 1:pt(yt,"You were fried!","GAME OVER");break;case 2:pt(yt,"Something heavy crushed you!","GAME OVER");break;case 3:pt(yt,"You fall into the abyss!","GAME OVER")}}}),W("main")),bt.start()},Tt=()=>c({update(){},render(){const t=yt.createLinearGradient(ft.width,0,0,ft.height);t.addColorStop(0,"#303090"),t.addColorStop(.5,"#000"),t.addColorStop(1,"#000"),yt.fillStyle=t,yt.fillRect(0,0,ft.width,ft.height),yt.fillStyle="#10000080",yt.lineWidth=12,yt.fillRect(0,0,ft.height,ft.height),yt.strokeStyle="#ffffff20",yt.beginPath(),yt.lineTo(0,0),yt.lineTo(ft.height,0),yt.lineTo(ft.height,0),yt.lineTo(ft.height,ft.height),yt.lineTo(0,ft.height),yt.lineTo(0,0),yt.moveTo(ft.height/4,0),yt.lineTo(ft.height/4,ft.height),yt.moveTo(0,ft.height/4),yt.lineTo(ft.height,ft.height/4),yt.moveTo(ft.height/2,0),yt.lineTo(ft.height/2,ft.height),yt.moveTo(0,ft.height/2),yt.lineTo(ft.height,ft.height/2),yt.moveTo(ft.height/4+ft.height/2,0),yt.lineTo(ft.height/4+ft.height/2,ft.height),yt.moveTo(0,ft.height/4+ft.height/2),yt.lineTo(ft.height,ft.height/4+ft.height/2),yt.stroke(),St(gt?"Press ENTER to start":"Loading...")}});let bt=Tt();const St=t=>{pt(yt,"THE WAFFLE","","Controls:","Move and jump/climb by ARROWS or W/A/S/D.","Toggle switch by SPACE","","(c) 2020 by Tero J & Sami H","",t)};var kt;kt=()=>{gt&&(mt?(wt=new ut,vt(1),mt=!1):!wt||1!==wt.gameOverState&&2!==wt.gameOverState&&3!==wt.gameOverState&&4!==wt.gameOverState||(wt.gameOverState=0,vt(0),dt=!1,mt=!0))},[].concat(["enter"]).map(t=>g[t]=kt),Promise.all([L(R,S,!0),L(Y,b,!1),L(A,T,!1),L(X,v,!0),L(V,k,!0),L(D,M,!0),L(O,P,!1)]).then(()=>{gt=!0}),vt(0)}]);</script></body></html>