<meta><title>Journey to the East: Silk Road Adventure</title><style>#a{position:absolute;width:100%;height:100%;z-index:-1}#textContainer{position:absolute;bottom:0;left:0;width:100%;background-color:rgba(184,134,11,.8);color:#2f4f4f;text-align:center;box-sizing:border-box;font-size:2em;box-shadow:0 -3px 4px rgba(184,134,11,.8)}</style><body style=margin:0;overflow-x:hidden;display:flex;justify-content:center;align-items:center;touch-action:manipulation;background-color:#ffebcd><div id=textContainer></div><div id=gameContainer style=text-align:center><input id=playerInput placeholder=Name style=text-align:center;display:none;border-radius:20px;height:35px;font-size:larger></div><canvas id=a></canvas><script src=https://cdn.jsdelivr.net/npm/near-api-js@0.45.1/dist/near-api-js.min.js></script><script>!function(){var e,a,t,n,o,s={},i=[...Array(12).keys()].map((()=>new AudioContext)),r=e=>Math.sin(6.28*e+(Math.sin(6.28*e)**2+.75*Math.sin(6.28*e+.25)+.1*Math.sin(6.28*e+.5)));p1=l=>{var c=125,h=.5;e=l[a=0].replace(/[!\|]/g,"").split("\n").map((e=>0<e?(c=(e=e.split("."))[0],h=e[1]/100||h):e.split("").map(((t,o)=>{var l=1;for(t=t.charCodeAt(0);"-"==e[o+l];)l++;a<o&&(a=o+1);var d=t-(90<t?71:65),w=l*h*c/125,u=44100,m=s[t=d+""+w];if(0<=d&&!m){d=65.406*1.06**d/u;var g=u*w|0;for(w=u*(w-.002),u=(m=s[t]=i[0].createBuffer(1,g,u)).getChannelData(0);g--;)u[g]=(g<88?g/88.2:(1-(g-88.2)/w)**((Math.log(1e4*d)/2)**2))*r(g*d)/7;n||i.map((e=>{var a=m,t=(n=1,e.createBufferSource());t.buffer=a,t.connect(e.destination),t.start(),t.stop()}))}return m})))),o=0,clearInterval(t),t=setInterval((t=>{e.map(((e,a)=>{var n;e[t=o%e.length]&&(e=e[t],(n=(a=i[3*a+o%3]).createBufferSource()).buffer=e,n.connect(a.destination),n.start())})),o++,o%=a}),c)}}();const e=window.nearApi;var aa=!1;async function ba(){try{userName=window.walletConnection.account().accountId;var a={account_id:window.walletConnection.getAccountId()},t=window.walletConnection.account(),n=await new e.Contract(t,"mrbrownproject.near",{viewMethods:["nft_tokens_for_owner"]}).nft_tokens_for_owner(a);0<n.length&&(aa=!0,brownNum=n.length)}catch(e){console.error("Error:",e)}}async function ca(){try{await window.walletConnection.requestSignIn("brown.neararcade.near","Check Your NFTs on Mr. Brown")}catch(e){console.log(e)}}brownNum=0,loggedIn=!1,userName="",c=a.getContext`2d`,k=[u=r=d=l=s=0],onkeydown=onkeyup=e=>k[e.which]=self["lld*rlurdu"[e.which%32%17]]=e.type[5],document.getElementById("playerInput").addEventListener("keydown",(e=>{"Enter"===e.key&&2==s&&ea()})),async function(){try{var a=await e.connect({networkId:"mainnet",keyStore:new e.keyStores.BrowserLocalStorageKeyStore(window.localStorage,"Brown Game"),nodeUrl:"https://rpc.mainnet.near.org",walletUrl:"https://wallet.mainnet.near.org",deps:{keyStore:new e.keyStores.BrowserLocalStorageKeyStore}});window.walletConnection=new e.WalletConnection(a,"silk-road-near-arcade"),window.walletConnection.isSignedIn()&&(loggedIn=!0,g[17].label="logout",ba())}catch(e){console.log(e)}}();const fa=document.getElementById("textContainer"),h=document.getElementById("playerInput"),ha="m -10.389267,104.73924 5.8771626,7.44441 L 64.446638,84.756881 196.87876,98.470267 v 17.631493 l -21.1578,4.30993 -10.97071,18.80692 -1.95905,-13.71338 12.53796,-10.18709 -31.73669,5.87717 -7.83622,9.40346 7.83622,3.5263 -11.75434,19.19874 -3.13448,-0.39181 -5.48536,5.48535 2.74268,7.0526 -5.87716,2.35087 -1.17544,-9.40347 -5.48535,-1.95905 -3.91811,3.5263 5.48535,2.74268 -3.5263,2.35086 3.91811,8.22803 -10.97071,14.49701 -9.403461,-2.35086 -3.526301,6.66078 5.877166,5.09355 -6.268976,9.01165 -6.268977,-7.0526 -2.350865,4.70173 3.918109,5.87717 -5.485353,-4.30992 -0.391813,-10.97071 -10.187085,-8.61984 -14.497008,9.40346 -3.13449,11.36252 -14.888818,-25.0759 -27.426771,-7.44441 4.70173,9.40346 7.052601,-3.13449 4.70173,6.26898 -8.619841,7.83622 -17.23968657,-3.5263 -9.01165263,-13.32158 -1.9590544,-0.39181 2.7426761,9.79528 -15.2806295,-1.56724 -0.783621,4.30992 -18.023308,-7.0526 -11.754332,9.01165 -18.80693,-14.49701 4.701734,-11.75433 23.50866,-2.74267 0.783624,5.87716 13.321575,4.30992 0.391811,-4.70173 19.3807227,3.61729 3.3918505,-9.11555 -13.7609202,0.40472 -1.959054,-7.83622 -4.701733,9.40346 -3.91811,-10.18708 -8.619843,-6.26898 -1.371338,1.17543 9.207559,8.22803 -0.587716,0.58772 -2.546772,-1.56724 0.783622,2.54677 -3.330394,3.7222 -3.722205,-1.95905 4.701733,-0.97953 0.783622,-1.56724 -9.795276,-8.42394 -2.938583,2.15496 -4.505827,-0.58772 -5.289449,5.68126 -0.195905,3.5263 -8.032126,3.3304 -5.877166,-3.91811 2.154961,-9.20756 9.795276,0.78362 v -4.89764 l -4.897638,-4.30992 9.59937,-2.54677 4.309921,-6.66079 5.093544,-0.58772 -0.783622,-5.68126 3.330394,-2.15496 0.783622,3.3304 3.134488,-1.17544 -3.134488,-5.68126 -5.093544,3.13449 -2.742677,-1.95905 -0.391811,-6.8567 15.868347,-14.10519 -3.722205,-0.39182 18.415119,-7.2485 21.1577954,8.61984 -0.19590551,1.95906 -3.72220479,2.35086 z;m -21.947693,108.06964 h -5.877166 l -0.587716,2.74267 -5.485355,5.28945 0.587716,2.74268 2.546771,1.76315 -3.526298,2.93858 -0.195906,4.70174 -4.897638,1.17543 -1.567244,1.76315 -3.330395,-1.17544 0.783625,1.95906 3.526298,-0.39181 2.154959,1.17543 5.681261,-1.76315 1.567246,1.17543 1.959054,-2.35086 0.979527,-5.28945 3.330393,1.95906 0.97953,-2.35087 -1.763152,-2.35087 3.722206,-0.97952 3.330392,0.78362 3.13449,-1.56725 2.938581,-0.39181 -0.783621,-2.35086 -1.959055,-0.78363 -0.783621,2.93859 -9.403467,0.39181 -3.330392,-1.56725 v -4.89763 z;m -14.111473,146.07531 -4.309923,6.46488 1.371341,3.5263 3.330393,-0.19591 3.5263,-2.35086 8.2280309,2.35086 2.7426761,-1.76315 -6.464882,-5.48535 -5.289447,1.76315 z;m 14.490731,145.09578 -6.2689768,4.70173 3.9181118,6.46488 -1.175433,4.89764 7.248504,1.56725 -0.391811,-4.70174 -4.309922,-8.03212 3.722205,-3.91811 z;m -61.912418,120.9994 -5.093544,3.72221 1.175433,4.70173 3.722206,3.7222 -2.938585,0.78363 v 6.26897 l 8.423939,-2.54677 1.959055,-3.5263 -3.330395,-0.1959 -3.918109,-6.26898 1.567243,-3.13449 -3.408391,0.58982 z;m -70.541346,130.24098 3.532415,-0.27705 1.10821,1.52379 -1.10821,1.10821 -0.346315,3.11683 -4.779151,1.38527 -0.277053,-1.52379 1.385263,-1.8701 -1.523788,-0.27706 0.138525,-1.93936 2.701261,0.0693 z;m 145.21307,134.25824 -2.35492,12.1903 -2.77053,8.58862 0.13853,5.81809 -11.0821,4.70989 -3.60168,3.1861 1.52379,3.60168 1.93937,-3.7402 12.19029,-3.74021 2.21642,-7.06483 -2.21642,-4.29431 3.74021,0.83116 3.7402,-2.90905 -5.12546,-3.46315 2.632,-1.52379 -1.66232,-3.32463 2.77053,-0.83116 z;m 98.534197,188.3909 -2.546771,0.78362 0.391811,1.95905 2.15496,0.19591 0.979527,-1.95905 z;m 113.91278,180.65263 -2.05701,2.79166 1.17544,2.39984 1.8611,-4.60378 z;m 55.434985,203.47562 -0.783622,3.03654 1.371338,2.74268 2.350866,-2.05701 z;m -42.713677,149.2098 33.891653,21.15779 5.2894494,-14.69291 8.0321255,12.92976 6.4648821,-10.38299 -0.587716,15.08472 27.32882,-5.3874 21.745513,-8.03212 25.957481,2.25291 -2.546772,-14.00724 2.546772,13.90929 22.333229,-2.64473 -18.708977,13.81134 -12.635906,16.16221".split(";");var q="city";const t=[];var ia,v="off";const w=["GoldenRod","DarkGoldenRod","DarkSlateGrey","#E35A31"];var ja=!1;const ka=new Image,la=[];var ma=0,na=new Date("1271-05-01"),z=!1,oa=!1,pa=(ka.src="cities.png",0);const A={members:{},money:2e3,hunt:0,supplies:{Camels:{n:0,q:1,cost:100},CamelFeed:{n:0,q:50,cost:10},Food:{n:0,q:50,cost:25},Clothing:{n:0,q:1,cost:10},WaterSkins:{n:0,e:0,q:20,cost:5},TradeGoods:{n:0,q:10,cost:100},Arrows:{n:0,q:20,cost:10},Tents:{n:0,q:1,cost:20}},settings:{pace:"steady",rations:"good",load:"medium"},dead:0,weather:"Sunny",currLeg:0,totalTraveled:0,score:0},C={x:0,y:0},qa=(A.date=new Date("1271-05-01"),{slow:18,steady:40,fast:70}),ra={poor:1,good:3,filling:5};var D={x:0,y:0},G=(ha[ha.length-1].split(" ").map((e=>{"m"!==e&&(e=e.split(","),D={x:D.x+parseFloat(e[0]),y:D.y+parseFloat(e[1])},t.push({x:D.x,y:D.y}))})),0);const J=[{name:"Venice",country:"Italy",desc:"Venice thrived as a trading hub and cultural center.",start:t[0],end:t[1],percentage:0,miles:1900},{name:"Acre",country:"Israel",desc:"Bustling port city, a focal point of trade and cultural exchange.",start:t[1],end:t[2],percentage:0,miles:950},{name:"Trebizond",country:"Turkey",desc:"Vibrant Black Sea city that played a pivotal role in regional trade and commerce.",start:t[2],end:t[3],percentage:0,miles:830},{name:"Baghdag",country:"Iraq",desc:"Historic city at the heart of Islamic civilization, known for its culture, scholarship, and economic significance.",start:t[3],end:t[4],percentage:0,miles:550},{name:"Terbil",country:"Iran",desc:"Strategic crossroads city known for its multicultural atmosphere and commercial importance.",start:t[4],end:t[5],percentage:0,miles:812},{name:"Ormuz",country:"Iran",desc:"Bustling island city strategically positioned along important maritime trade routes",start:t[5],end:t[6],percentage:0,miles:1400},{name:"Balkh",country:"Afghanistan",desc:"Ancient city that was a vital center of trade and culture along the Silk Road",start:t[6],end:t[7],percentage:0,miles:700},{name:"Kashgar",country:"China",desc:"Thriving oasis city that served as a key junction on the Silk Road trading network.",start:t[7],end:t[8],percentage:0,miles:1954},{name:"Lanzhou",country:"China",desc:"Strategic and culturally diverse city located along the Yellow River, contributing to the Silk Road's intricate tapestry.",start:t[8],end:t[9],percentage:0,miles:1e3},{name:"Karakorem",country:"Mongolia",desc:"The capital of the Mongol Empire, a diverse and cosmopolitan city where he met Kublai Khan.",start:t[9],end:t[10],percentage:0,miles:1e3},{name:"Lanzhou",country:"China",desc:"Strategic and culturally diverse city located along the Yellow River, contributing to the Silk Road's intricate tapestry.",start:t[10],end:t[11],percentage:0,miles:970},{name:"Beijing",country:"China",desc:"Heart of the Yuan Dynasty, a vibrant capital city where Marco Polo would later serve in Kublai Khan's court.",start:t[11],end:t[12],percentage:0,miles:1228},{name:"Chengdu",country:"China",desc:"Bustling city in southwestern China known for its irrigation systems, cultural vibrancy, and regional significance.",start:t[12],end:t[13],percentage:0,miles:1200},{name:"Pagan",country:"China",desc:"Vast landscape of temples and pagodas, showcasing the rich cultural heritage of Myanmar.",start:t[13],end:t[13],percentage:0,miles:0}],sa="a fall from a mountain pass;allergic reaction to silk;opium den thugs;murder by fellow traveler;snake bite;framed for murder;executed for crime".split(";"),ta="Dysentery;Malaria;Typhoid;Cholera;Pneumonia;Tuberculosis;Influenza;Measles;Smallpox;Yellow Fever;Plague;Food Poisoning;Heatstroke;Frostbite;Malnutrition;Dehydration;Infected wound;Respiratory Infection;Parasitic Infection;Venomous Snake Bite;Dengue Fever;Hepatitis;Rabies".split(";"),ua="death water sick rob attack camel heal".split(" "),va=[{d:20,t:"You board a ship for the first leg of your journey."},{d:100,t:"You savor shipboard cuisine as you sail."},{d:900,t:"Find tranquility, enjoying serene ocean vistas"},{d:600,t:"Soothing melodies aboard the ship transport you."},{d:900,t:"Explore a island market for unique treasures."},{d:1500,t:"Join a jubilant onboard celebration."},{d:2e3,t:"Browse a busy market and pick up a unique souvenir."},{d:2500,t:"Gather 'round as a local shares fascinating legends."},{d:3500,t:"Meditate and find peace at a remote monastery."},{d:5e3,t:"Savor a nomad's delicious meal in their yurt."},{d:7e3,t:"Attend a mesmerizing city arts performance."},{d:9e3,t:"Receive a personalized work of art as a gift."},{d:11567,t:"Met Marco Polo, says he's working on a book."},{d:13e3,t:"Feeling homesick you wonder if was all worth it."}];var wa=0;const O=";Follow Marco Polo's route along the silk road!;Input your caravan member's names!;;Control your journey by making wise decisions!;You can only carry 200lbs! Use as few arrows as possible!".split(";");var xa="",R=[],ya=0,za=0;const Aa=e=>{za=1,0==(ya=e)&&p1`240.40c-aY|X-XY|a-c-|V-V-|c-aY|X-VX|YXVT|V-  |a-c-|e--c|fece|a-V-|a-c-|e--c|feca|c-c-|e-f-|h-e |fhfc|e-e-|e-e-|e--c|fece|a-a-|J---|J---|J---|J---|J---|J---|J---|J---|O---|O---|O---|O---|O---|O---|O---|O---|O---|O---|O---|O---|O---|O---|O---|O---|`,1==e&&p1`240.40R-RTV-TRW-VTV-V-T-VWV-TRM-MQR-Q R-RQR-R-Q-R-R-Q`,2==e&&p1`700.60V-Y-c-V-d---c-a-M-------R-------`};class S{constructor(e,a,t,n,o,s,i,r){this.x=e,this.y=a,this.width=t,this.height=n,this.label=o,this.isClicked=!1,this.s=s,this.onClick=i,this.color=r||w[0],this.active=!0}draw(){c.fillStyle=this.active?this.color:"grey",c.shadowColor="rgba(0, 0, 0, 0.3)",c.shadowBlur=6,c.shadowOffsetX=3,c.shadowOffsetY=3,Ba(c,this.x,this.y,this.width,this.height),c.fillStyle=w[2],c.font="3vw Consolas",c.textAlign="center",c.textBaseline="middle",c.fillText(this.label,this.x+this.width/2,this.y+this.height/2),c.shadowColor="transparent",c.shadowBlur=0,c.shadowOffsetX=0,c.shadowOffsetY=0}}const g=[];var Ca=0,Da=5,Ea=!0;function Fa(){var e=c.h/3+95,a=.5*c.w-100,t=(g.push(new S(.4*c.w,.5*c.h,200,60,"Start!",[0],(()=>{aa?(A.members["Mr.Brown"]={health:3,ill:"none",brown:!0},T("Caravan Members: "+Object.keys(A.members).toString())):T(O[s]),s=2,h.style.display="block",Aa(0)})),new S(.4*c.w,.7*c.h,200,60,"Back!",[1,8,9,10],(()=>{s=4,U(!0),T(O[s])})),new S(.4*c.w,.7*c.h,200,60,"Back!",[5],(()=>{var e=A.hunt<200?A.hunt:200;A.supplies.Food.n+=e,V("You used "+pa+" arrows to hunt "+e+" lbs of food."),pa=0,50<A.supplies.Food.n&&(v="off",g[8].active=!0),s=4,T(O[s]),Ga()})),new S(.5*c.w-120,.6*c.h,240,60,"Add Member!",[2],(()=>{ea()})),new S(.5*c.w-300-2,e,200,60,"Status!",[4],(()=>{s=8,T("Check on your supplies and party members!")})),new S(a,e,200,60,"Hunt!",[4],(()=>{if(A.supplies.Arrows.n<1)alert("Out of arrows!");else if(g[8].label="Continue",g[8].color=w[1],"city"!==q){for(an of(q="hunt",A.totalTraveled<1900?Ha:Ia))an.v=2*Math.random(),an.alive=!0,an.x=.2*c.w+Math.random()*c.w*.7,an.y=.1*c.h+Math.random()*c.h*.6,an.s=1+3*Math.random();A.hunt=0,s=5,T(O[s])}else alert("Can't hunt in city!")})),new S(.5*c.w+102,e,200,60,"Big Map!",[4],(()=>{s=1,T(O[s])})),new S(.5*c.w-300-2,e+60+5,200,60,"Logs!",[4],(()=>{U(!(s=9))})),new S(a,e+60+5,200,60,"Continue",[4],(()=>{"win"===q?(s=10,T("Congrats on the win! Refresh to replay!")):"runningOut"!==q&&(g[9].active=!1,g[5].active=!0,"Rest"===g[8].label?V("Having a little rest."):V("On the move again!"),q="Rest"===g[8].label?"rest":"moving",g[8].label="Rest"===g[8].label?"Continue":"Rest",g[8].color="moving"===q?w[0]:w[1])}),w[1]),new S(.5*c.w+102,e+60+5,200,60,"Market!",[4],(()=>{"city"===q?U(!(s=3)):alert("Can only visit market in city!")})),new S(a,.7*c.h,200,60,"Overview!",[6],(()=>{if(s=4,T("Control your journey by making wise decisions!"),U(!0),V("You arrived in "+J[G].name+", "+J[G].country),"Pagan"===J[G].name){q="win",s=10;let e=0,a=A.supplies;for(item in A.supplies)e+=a[item].n/a[item].q*a[item].cost<<0;A.score=(e+A.money)*(5-A.dead)*(aa?brownNum:1),Aa(1),g[8].label="See Score"}})),new S(.4*c.w,.55*c.h,140,42,A.settings.pace,[8],(()=>{Ja(11,["slow","steady","fast"],"pace")})),new S(.55*c.w,.55*c.h,140,42,A.settings.rations,[8],(()=>{Ja(12,["poor","good","filling"],"rations")})),new S(.7*c.w,.55*c.h,140,42,A.settings.load,[8],(()=>{}),w[1]),new S(.9*c.w,.3*c.h,200/3,48,"⇧",[9],(()=>{0<Ca&&Ca--&&5<Da&&Da--})),new S(.9*c.w,.6*c.h,200/3,48,"⇩",[9],(()=>{Da<R.length&&Da++&&Ca<R.length-5&&Ca++})),new S(.93*c.w,.05*c.h,50,48,"🔈",[2,4],(()=>{g[16].label="🔈"===g[16].label?"🔇":"🔈","🔈"===g[16].label?Aa(ya):(za=0,p1``)})),new S(.85*c.w,.05*c.h,140,48,"login",[0],(()=>{g[17].label=loggedIn?"logout":"login",loggedIn?(loggedIn=!1,window.walletConnection.signOut()):ca()})),new S(.93*c.w,.15*c.h,50,48,"⛶",[0,4],(()=>{g[18].label="⛶"===g[18].label?"X":"⛶","X"===g[18].label?(z=!0,document.documentElement.requestFullscreen()):(document.exitFullscreen(),z=!1)}))),e=.22*c.h,A.supplies);for(item in t)g.push(new S(.7*c.w,e,60,30,"+",[3],(()=>{const e=item;return()=>{0<=A.money-t[e].cost&&(A.money-=t[e].cost,t[e].n+=t[e].q)}})()),new S(.78*c.w,e,60,30,"-",[3],(()=>{const e=item;return()=>{t[e].n>=t[e].q&&(A.money+=t[e].cost,t[e].n-=t[e].q)}})())),e+=.06*c.h;e+=.05*c.h,g.push(new S(.7*c.w,e,200,60,"Done!",[3],(()=>{Ea?(s=6,Ea=!1,T(J[G].desc)):s=4,q="city",U(!0)})))}function ea(){var e=h.value;0<e.length&&(A.members[e]={health:3,ill:"none",brown:!1},h.value="",T("Caravan Members: "+Object.keys(A.members).toString()),5==Object.keys(A.members).length)&&(s=3,U(!(h.style.display="none")))}T("Embark on a journey along the Silk Road, making strategic decisions and overcoming challenges to successfully reach your destination in the East!");const Ja=(e,a,t)=>{var n=a.indexOf(g[e].label);g[e].label=n<1?a[1]:n<2?a[2]:a[0],A.settings[t]=g[e].label};function Ka(){switch(a.width=innerWidth,a.height=innerHeight,s){case 0:W("Journey to the East",c.w/2,.34*c.h,6,w[3]),W("Silk Road Adventure",c.w/2,.44*c.h,4,w[3]);break;case 1:var e=z&&ja?{s:2,w:.2*c.w,h:.16*-c.h}:{s:2,w:.2*c.w,h:.08*-c.h};c.fillStyle="lightblue",c.fillRect(0,0,c.w,c.h),La(e.s,e.w,e.h),W("Map",c.w/2,.1*c.h,5.3,w[3]);break;case 2:W("Add "+(e=5-Object.keys(A.members).length)+" Members to Caravan!",c.w/2,.34*c.h,5.3,w[3]);break;case 3:W("Market",c.w/2,.1*c.h,5.3,w[3]);e=.19*c.h;var t=A.supplies;for(item in sum=0,W("Item",.2*c.w,e,4,w[2]),W("$",.35*c.w,e,4,w[2]),W("Num",.45*c.w,e,4,w[2]),W("Value",.55*c.w,e,4,w[2]),e+=.06*c.h,t){W(item,.2*c.w,e,3,w[3]),W(t[item].cost,.35*c.w,e,3,w[3]),W(t[item].n,.45*c.w,e,3,w[2]),W(n=t[item].n/t[item].q*t[item].cost<<0,.55*c.w,e,3,w[2]),e+=.06*c.h,sum+=n}W("Total "+sum+"$",.5*c.w,e+=.05*c.h,3,w[2]),W("You have "+A.money+"$",.5*c.w,e+=.05*c.h,3,w[2]),W(Ma()+" lbs per camel",.5*c.w,e+.05*c.w,3,oa?"red":w[2]);break;case 4:c.fillStyle=w[0],c.fillRect(0,c.h/3-10,c.w,100),c.fillStyle=w[2],Ba(c,5,c.h/3-5,c.w-10,90),W(xa,c.w/2,.45*c.h,2.5,"GoldenRod"),c.fillStyle="lightblue",e=z&&ja?{s:1,w:.45*c.w,h:.2*-c.h}:{s:1,w:.45*c.w,h:.1*-c.h},Ba(c,c.w/3,5,c.w/3,c.h/3+10),La(e.s,e.w,e.h),e=A.supplies.Food.n;t=A.supplies.CamelFeed.n;var n=A.supplies.WaterSkins.n,o=J[G].miles-A.currLeg,r=A.totalTraveled,l=Na(),h=A.date.toDateString(),d=A.weather,u=.15*c.w,m=.8*c.w;W("Date: "+h,u,.1*c.h,2,w[2]),W("Next City: "+o+" miles",u,.15*c.h,2,w[2]),W("Traveled: "+r+" miles",u,.2*c.h,2,w[2]),W("Weather: "+d,u,.25*c.h,2,w[2]),W("Health: "+l,m,.1*c.h,2,w[2]),W("Food: "+e+" lbs",m,.15*c.h,2,w[2]),W("Camel Feed: "+t+" lbs",m,.2*c.h,2,w[2]),W("Water: "+n+" skins",m,.25*c.h,2,w[2]);break;case 5:for(an of(e=A.supplies.Arrows.n,(t=A.totalTraveled<1900)&&(c.fillStyle="lightblue",Ba(c,0,0,c.w,c.h)),W("Hunting",c.w/2,.34*c.h,5.3,w[3]),W("Click/Tap to shoot!",c.w/2,.45*c.h,2.5,w[2]),W("Arrows: "+e,c.w/2,.5*c.h,2.5,w[2]),W("Killed: "+A.hunt+" lbs",c.w/2,.55*c.h,2.5,w[2]),t=t?Ha:Ia))an.v&&an.alive&&(c.textBaseline="middle",W(an.t,an.x,an.y,5.3,w[3]),c.textBaseline="alphabetic",an.y+=an.s,(an.y<10||an.y>.9*c.h)&&(an.s*=-1),Math.sqrt((an.x-(X.x+X.w))**2+(an.y-X.y)**2)<25)&&(A.hunt+=an.w,an.alive=!1);0<e&&Oa();break;case 6:c.drawImage(ka,G<7?80*G:80*(G-7),G<7?0:75,80,75,c.w/2-120,c.h/2-112.5+20,240,225),W(J[G].name,c.w/2,.15*c.h,6,w[3]),W(J[G].country,c.w/2,.25*c.h,4,w[3]);break;case 7:Pa();break;case 8:for(item in t=.2*c.w,e=.4*c.w,H=.1*c.h,U(!(z&&ja)),W("Supplies",t,H,3.5,w[3]),H+=.05*c.h,A.supplies)H+=.05*c.h,W(item+": "+A.supplies[item].n,t,H,2,w[2]);for(mem in W("Caravan Members",e,H=.1*c.h,3.5,w[3],"left"),W("Name",e,H+=.1*c.h,2.5,w[3],"left"),W("Health",e+.15*c.w,H,2.5,w[3],"left"),W("Illness",e+.25*c.w,H,2.5,w[3],"left"),A.members)H+=.05*c.h,t=2<(t=A.members[mem].health)?"good":1<t?"fair":0<t?"poor":"dead",W(mem,e,H,2.5,w[2],"left"),W(t,e+.15*c.w,H,2.5,w[2],"left"),W(A.members[mem].ill,e+.25*c.w,H,2.5,w[2],"left");W("Pace",e-5,(H=.55*c.h)-5,3,w[3],"left"),W("Rations",e+.15*c.w-5,H-5,3,w[3],"left"),W("Load",e+.3*c.w-5,H-5,3,w[3],"left"),loggedIn&&(W(userName,.02*c.w,.7*c.h,2,w[3],"left"),W(brownNum+" Mr.Brown NFTs",.02*c.w,.8*c.h,2,w[3],"left")),W(Ma()+" lbs per camel",.8*c.w,H+.1*c.w,2.5,oa?"red":w[2]);break;case 9:for(e=Ca,(t=Da)>R.length&&(t=R.length),W("Travel Logs",c.w/2,.15*c.h,4,w[3]),H=.3*c.h,i=e;i<t;i++)W(R[i],c.w/2,H,2,w[2]),H+=.1*c.h;g[14].active=0!==e,g[15].active=t!==R.length;break;case 10:c.drawImage(ka,400,75,80,75,c.w/2-200,.15*c.h,400,375),e=Math.round(Math.abs((na-A.date)/864e5)),W("Congratulations you win!",c.w/2,.1*c.h,4,w[3]),W("Traveled 14795 miles in "+e,c.w/2,.6*c.h,3,w[2]),W("Score: "+A.score,c.w/2,.66*c.h,3,w[2]);break;case 11:for(bg of(e=A.supplies.Arrows.n,W("Your camp is under attack!",c.w/2,.34*c.h,5.3,w[3]),W("Arrows: "+e,c.w/2,.45*c.h,3,w[3]),0<e?Oa():(Sa(),v="off",g[1].onClick()),ma<1&&(V("You defended your camp from marauders!"),v="off",g[1].onClick()),Ta))bg.v&&bg.alive&&(c.textBaseline="middle",W(bg.t,bg.x,bg.y,5.3,w[3]),c.textBaseline="alphabetic",bg.y+=bg.s,(bg.y<10||bg.y>.9*c.h)&&(bg.s*=-1),Math.sqrt((bg.x-(X.x+X.w))**2+(bg.y-X.y)**2)<25)&&(bg.alive=!1,ma--)}"moving"!==q&&"rest"!==q||Ua(),Va(),requestAnimationFrame(Ka)}onclick=e=>{if(Wa(e),!Xa(C.x,C.y,s))switch(s){case 5:case 11:X.set&&0<A.supplies.Arrows.n&&(X.x=Y.x,X.y=Z.y-3,X.set=!1,A.supplies.Arrows.n--,pa++)}},onmousemove=e=>{Wa(e)};const Na=()=>{let e=0;for(var a in A.members)0<A.members[a].health&&(e+=A.members[a].health);switch(e=Math.ceil(e/(5-A.dead))){case 0:return s=7,Aa(2),void T("This is the end... refresh to restart!");case 1:return"Poor";case 2:return"Fair";case 3:return"good"}return e};function Ua(){var e;if("elapsed"===v)if(Ga(),"moving"===q?(e=0<A.supplies.Camels.n?qa[A.settings.pace]:5,"Storm"===A.weather&&(V("Storm slows us down to half pace!"),e/=2),A.currLeg+=e,A.totalTraveled+=e,J[G].percentage=A.currLeg/J[G].miles,wa<va.length&&A.totalTraveled>=va[wa].d&&(V(va[wa].t),wa++)):Ya(),A.supplies.Food.n<50)q="runningOut",clearInterval(ia),T("You have too little food you must stop to hunt!"),V("You're running out of food, you must stop to hunt!"),g[8].label="continue",g[8].active=!1;else if(A.supplies.CamelFeed.n<1&&0<A.supplies.Camels.n&&10*Math.random()<1&&(A.supplies.Camels.n--,V("No camel feed! One camel died! Food store increases."),A.supplies.Food.n+=200),e=Za(A.members),A.supplies.WaterSkins.n<1?0<e.health&&(e.ill="thirst",e.health--,V("You have no water, "+e.k+" is dying of thirst!"),e.health<0)&&V("You have no water, "+e.k+" died from thirst!"):A.supplies.Tents.n<1?(0<e.health&&(e.ill="wounds from animals",e.health--,V("You have no tents, "+e.k+" was mauled by wild animals!")),e.health<0&&V("You have no tents, "+e.k+" died after being mauled by animals!")):A.supplies.Clothing.n<1&&(0<e.health&&(e.ill="sunburn",e.health--,V("You have no clothes, "+e.k+" was sunburned!")),e.health<0)&&(e.ill="infected sunburn",V("You have no clothes, "+e.k+" died of an infected sunburn!")),1<=J[G].percentage){for(item in J[G].percentage=1,A.currLeg=0,G++,v="off",q="city",$a(),A.supplies)A.supplies[item].cost=A.supplies[item].cost*(1+Math.random())<<0;A.supplies.TradeGoods.cost+=50,g[5].active=!1,g[9].active=!0,s=6,T(J[G].desc),g[8].label="Continue"}else ab(),v="on";else"off"===v&&(v="on",ia=setInterval((()=>{v="elapsed"}),2e3))}function bb(e){return new Promise((a=>{setTimeout(a,e)}))}async function ab(){for(;0<la.length;)xa=la.shift(),await bb(500)}function Ga(){Ma();var e,a=100*Math.random();if(A.weather=a<60?"Sunny":a<75?"Cloudy":a<98?"Raining":"Storm",(a=new Date(A.date)).setDate(a.getDate()+1),A.date=a,A.supplies.Food.n-=ra[A.settings.rations]*(5-A.dead),A.supplies.CamelFeed.n-=ra[A.settings.rations]*A.supplies.Camels.n,0<A.supplies.WaterSkins.n&&"Raining"!==A.weather&&(A.supplies.WaterSkins.n-=5-A.dead,A.supplies.WaterSkins.e+=5-A.dead,A.supplies.WaterSkins.n<0)&&(A.supplies.WaterSkins.n=0),A.supplies.Food.n<0&&(A.supplies.Food.n=0),A.supplies.CamelFeed.n<0&&(A.supplies.CamelFeed.n=0),.9<Math.random())switch(Math.random()*ua.length<<0){case 0:A.dead<2&&!(a=Za(A.members)).brown&&(A.totalTraveled<1900&&A.dead<1?(a.death="drowned",a.ill="drowned",V("Ship wreck! "+a.k+" was sadly lost."),A.dead++,a.health=0):Math.random()*(Math.random()*("filling"===A.rations?12:"filling"===A.rations?8:5)<4)&&0<a.health&&a.health<3&&(a.health=0,"none"===a.ill||"thirst"===a.ill?(e=sa[Math.floor(Math.random()*sa.length)],a.ill=e):e=a.ill,a.death=e,V(a.k+" died of "+e)));break;case 1:V("Stopped at an oasis to refill water!"),$a();break;case 2:Math.random()*("filling"===A.rations?12:"filling"===A.rations?8:5)<5&&!(a=Za(A.members)).brown&&0<a.health&&(a.health--,a.health<1?V(a.k+" died of "+("none"===a.ill?"fatigue":a.ill)):(e=ta[Math.floor(Math.random()*ta.length)],a.ill=e,V(a.k+" sick from "+e)));break;case 3:Sa();break;case 4:for(bg of(q="defend",g[8].label="Continue",g[8].color=w[1],ma=Ta.length,Ta))bg.v=1+2*Math.random(),bg.alive=!0,bg.x=.2*c.w+Math.random()*c.w*.7,bg.y=.1*c.h+Math.random()*c.h*.6,bg.s=1+3*Math.random();s=11;break;case 5:V("You find a lose camel"),A.supplies.Camels.n++;break;case 6:Ya()}}function V(e){-1!==e.indexOf("died")&&A.dead++,"moving"===q||"rest"===q?la.push(e):xa=e,R.push(A.date.toDateString()+" : "+e)}const Ya=()=>{var e=Za(A.members);if(0<e.health&&e.health<3&&"thirst"!==e.ill&&(e.health++,"none"!==e.ill)&&(V(e.k+" is no longer sick from "+e.ill),e.ill="none"),0<A.supplies.WaterSkins.n)for(m in A.members)0<m.health&&"thirst"===A.members[m].ill&&(A.members[m].ill="none")},Za=e=>{var a=Object.keys(e);return e[a=a[a.length*Math.random()<<0]].k=a,e[a]};function Sa(){var e,a=Za(A.supplies);0<a.n&&(e=a.n/4<<0||1,a.n-=e,V("Your party was robbed! Lost: "+e+" "+a.k))}function $a(){for(m in A.supplies.WaterSkins.n+=A.supplies.WaterSkins.e,A.supplies.WaterSkins.e=0,A.members)0<m.health&&"thirst"===A.members[m].ill&&(A.members[m].ill="none")}var Ia=[{t:"🐪",v:0,w:990},{t:"🐏",v:0,w:99},{t:"🦌",v:0,w:150,s:3},{t:"🐇",v:0,w:11}],Ha=[{t:"🐟",v:0,w:11},{t:"🐢",v:0,w:99},{t:"🦈",v:0,w:250,s:3},{t:"🦑",v:0,w:11}],Ta=[{t:"👩",v:0,w:990},{t:"👨🏼‍🦱",v:0,w:99},{t:"👳🏽‍♂️",v:0,w:150,s:3},{t:"🧔🏿‍♀️",v:0,w:11},{t:"🧔🏽",v:0,w:11}];function Oa(){c.beginPath(),c.arc(Z.x,Z.y,Z.r,Z.start,Z.end),c.strokeStyle="#000",c.lineWidth=3,c.stroke(),c.closePath(),c.beginPath(),c.moveTo(Z.x,Z.y-Z.r),X.set&&c.lineTo(Y.x,Z.y),c.lineTo(Z.x,Z.y+Z.r),c.lineWidth=1,c.stroke(),c.closePath(),X.set?(c.fillRect(Y.x,Z.y-3,10,6),c.fillRect(Y.x,Z.y-1,X.w,2),c.beginPath(),c.moveTo(Y.x+X.w,Z.y-4),c.lineTo(Y.x+X.w+12,Z.y),c.lineTo(Y.x+X.w,Z.y+4),c.fill()):(c.fillRect(X.x,X.y-3,10,6),c.fillRect(X.x,X.y-1,X.w,2),c.beginPath(),c.moveTo(X.x+X.w,X.y-4),c.lineTo(X.x+X.w+12,X.y),c.lineTo(X.x+X.w,X.y+4),c.fill(),X.x+=12,X.x>c.w&&(X.set=!0)),(Z.y>c.h-.3*c.h||Z.y<50)&&(Z.dy*=-1),Z.y+=Z.dy}const X={x:0,y:0,w:100,set:!0},Z={x:0,y:0,dy:3,r:50,start:Math.PI+Math.PI/2,end:Math.PI-Math.PI/2},Y={h:2*Z.r,x:Z.x-25,status:!0},Ma=()=>{let e=A.supplies,a=0;if(e.Camels.n){for(item in e)a+=e[item].n;return a=a/e.Camels.n<<0,A.settings.load=a<150?"light":a<250?"medium":"heavy",g[13].label=A.settings.load,oa=450<a,a}return 0};function La(e,a,n){ha.forEach(((o,s)=>{o=new Path2D(o),c.save(),c.scale(e,e),c.translate(a,n),s===ha.length-1?(c.strokeStyle=w[2],c.stroke(o),J.forEach((t=>{c.strokeStyle="Mongolia"===t.country?w[0]:w[1];var o=t.start.x,s=t.start.y,i=o+(r=t.percentage)*(t.end.x-o),r=s+r*(t.end.y-s);c.lineWidth=3.5,c.beginPath(),c.moveTo(o,s),c.lineTo(i,r),c.stroke(),c.lineWidth=1,Math.sqrt((C.x/e-a-t.start.x)**2+(C.y/e-n-t.start.y)**2)<6&&W(t.name+", "+t.country,t.start.x,t.start.y-40,2.5,w[2])})),t.forEach((({x:t,y:o})=>{c.beginPath(),c.arc(t,o,3,0,2*Math.PI),c.fillStyle="#E35A31",Math.sqrt((C.x/e-a-t)**2+(C.y/e-n-o)**2)<6&&(c.fillStyle=w[2]),c.fill(),c.closePath()}))):(c.fillStyle=1===s||2===s||3===s?"lightblue":"BlanchedAlmond",c.fill(o)),c.restore()}))}function Pa(){clearInterval(ia),q=v="lose";let e=c.h/4;W("All your members are dead, you lose!",c.w/2,e,4,w[2]),Object.values(A.members).forEach((a=>{e+=.1*c.h,W(a.k+" died of "+a.ill+"!",c.w/2,e,3,w[2])}))}function W(e,a,t,n,o,s){c.textAlign=s||"center",c.fillStyle=o,c.font=n/100*Math.min(c.w,c.h)*.12+"em Consolas",c.fillText(e,a,t)}function Xa(e,a,t){return g.forEach((n=>{if(e>=n.x&&e<=n.x+n.width&&a>=n.y&&a<=n.y+n.height&&n.s.includes(t))return n.isClicked=!n.isClicked,n.onClick(),Va(),!0})),!1}function Va(){g.forEach((e=>e.s.includes(s)&&e.draw()))}function U(e){fa.style.display=e?"block":"none"}function T(e){fa.textContent=e}function Ba(e,a,t,n,o){e.beginPath(),e.moveTo(a+10,t),e.arcTo(a+n,t,a+n,t+o,10),e.arcTo(a+n,t+o,a,t+o,10),e.arcTo(a,t+o,a,t,10),e.arcTo(a,t,a+n,t,10),e.closePath(),e.fill()}function Wa(e){var t=a.getBoundingClientRect(),n=a.width/t.width;t=a.height/t.height;C.x=(e.clientX-a.getBoundingClientRect().left)*n,C.y=(e.clientY-a.getBoundingClientRect().top)*t}function cb(){var e=window.innerWidth,t=window.innerHeight;ja=t<400,16/9<e/t?(c.h=t,c.w=t*(16/9)):(c.w=e,c.h=e/(16/9)),a.style.position="absolute",a.style.left=(e-c.w)/2+"px",a.style.top=(t-c.h)/2+"px",fa.style.width="100%",h.style.marginTop=(h.clientHeight-h.clientHeight)/2+"px",X.x=c.w/2+.1*c.w,X.y=c.h/2,Z.x=30,Z.y=c.h/2,Y.x=Z.x-25,g.length=0,Fa(),z&&(g[18].label="X",g[17].label=loggedIn?"logout":"login",g[16].label=za?"🔈":"🔇")}requestAnimationFrame(Ka),cb(),window.addEventListener("resize",cb)</script>