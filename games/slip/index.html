<!doctype html><title>SLIP - js13kGames 2021</title><meta name=viewport content="width=device-width"><style>*{padding:0;margin:0;background:#000}canvas{background:#000;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%)}</style><canvas id=myCanvas width=480 height=480></canvas><script>E=function(t){function e(t){t=t.split(s),this.frequency=e.getFrequency(t[0])||0,this.duration=e.getDuration(t[1])||0}function i(t,e,i){this.ac=t||new AudioContext,this.createFxNodes(),this.tempo=e||120,this.loop=!0,this.smoothing=0,this.staccato=0,this.notes=[],this.push.apply(this,i||[])}var o=440*Math.pow(Math.pow(2,1/12),-9),n=/^[0-9.]+$/,s=/\s+/,a=/(\d+)/,r={};"B#-C|C#-Db|D|D#-Eb|E-Fb|E#-F|F#-Gb|G|G#-Ab|A|A#-Bb|B-Cb".split("|").forEach(function(t,e){t.split("-").forEach(function(t){r[t]=e})}),e.getFrequency=function(t){t=t.split(a);var e=r[t[0]];return t=(t[1]||4)-4,o*Math.pow(Math.pow(2,1/12),e)*Math.pow(2,t)},e.getDuration=function(t){return n.test(t)?parseFloat(t):t.toLowerCase().split("").reduce(function(t,e){return t+("w"===e?4:"h"===e?2:"q"===e?1:"e"===e?.5:"s"===e?.25:0)},0)},i.prototype.createFxNodes=function(){var i=this.gain=this.ac.createGain();return[["bass",100],["mid",1e3],["treble",2500]].forEach(function(t,e){(e=this[t[0]]=this.ac.createBiquadFilter()).type="peaking",e.frequency.value=t[1],i.connect(i=e)}.bind(this)),i.connect(this.ac.destination),this},i.prototype.push=function(){return Array.prototype.forEach.call(arguments,function(t){this.notes.push(t instanceof e?t:new e(t))}.bind(this)),this},i.prototype.createCustomWave=function(t,e){e=e||t,this.waveType="custom",this.customWave=[new Float32Array(t),new Float32Array(e)]},i.prototype.createOscillator=function(){return this.stop(),this.osc=this.ac.createOscillator(),this.customWave?this.osc.setPeriodicWave(this.ac.createPeriodicWave.apply(this.ac,this.customWave)):this.osc.type=this.waveType||"square",this.osc.connect(this.gain),this},i.prototype.scheduleNote=function(t,e){var i=60/this.tempo*this.notes[t].duration,o=i*(1-(this.staccato||0));return this.setFrequency(this.notes[t].frequency,e),this.smoothing&&this.notes[t].frequency&&this.slide(t,e,o),this.setFrequency(0,e+o),e+i},i.prototype.getNextNote=function(t){return this.notes[t<this.notes.length-1?t+1:0]},i.prototype.getSlideStartDelay=function(t){return t-Math.min(t,60/this.tempo*this.smoothing)},i.prototype.slide=function(t,e,i){var o=this.getNextNote(t),n=this.getSlideStartDelay(i);return this.setFrequency(this.notes[t].frequency,e+n),this.rampFrequency(o.frequency,e+i),this},i.prototype.setFrequency=function(t,e){return this.osc.frequency.setValueAtTime(t,e),this},i.prototype.rampFrequency=function(t,e){return this.osc.frequency.linearRampToValueAtTime(t,e),this},i.prototype.play=function(i){return i="number"==typeof i?i:this.ac.currentTime,this.createOscillator(),this.osc.start(i),this.notes.forEach(function(t,e){i=this.scheduleNote(e,i)}.bind(this)),this.osc.stop(i),this.osc.onended=this.loop?this.play.bind(this,i):null,this},i.prototype.stop=function(){return this.osc&&(this.osc.onended=null,this.osc.disconnect(),this.osc=null),this},t.Note=e,t.Sequence=i},"function"==typeof define&&define.amd?define(["exports"],E):E("object"==typeof exports&&"string"!=typeof exports.nodeName?exports:this.TinyMusic={});var a=document.getElementById("myCanvas"),o=a.getContext("2d"),e=null,n=!0,r=0,l=.3,h=0,c=0,p=[],u=[],d=null,g=0,y=0,w=localStorage.getItem("com.harsanalif.slip.bestScore"),x=(null==w&&(w=0),"direction"),v=0,F=0,C=0,S={r:5,g:5,b:5,a:1,isReset:function(){return 5==this.r&&5==this.g&&5==this.b}},E=new AudioContext,M=new TinyMusic.Sequence(E,120,["C3 w","D3 e","E3 e","F3 e","G3 q","E3 e","C3 h","C4 q","E4 e","D4 e","C4 e","G3 h"]);M.gain.gain.value=.1,M.loop=!0;class P{constructor(){}init(){}update(){}draw(){var t;o.font="50px Courier",o.fillStyle="#FFFFFF",o.textAlign="center",o.textBaseline="middle",o.fillText("SLIP",.5*a.width,.5*a.height),o.font="20px Courier",o.fillText((t=navigator.userAgent||navigator.vendor||window.opera,(/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(t)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(t.substr(0,4))?"TAP":"CLICK")+" TO START"),.5*a.width,.9*a.height)}onPointerDown(t){G(new q)}onPointerUp(t){}end(){}}class q{constructor(){}init(){c=h=r=y=g=0,v=-.8*a.height,x="direction",d=new T(5,a.width/2,a.height-100),p=[];for(var t=0;t<50;t++){var e=new T(6+2*Math.random(),Math.random()*a.width,Math.random()*a.height*1.5-.8*a.height);e.isPassed=!1,e.isClose=!1,p.push(e)}for(u=[],t=0;t<10;t++)u.push({pos:{x:d.pos.x,y:d.pos.y},radius:d.radius});M.play()}update(){var t=(D=Date.now())-k;if(k=D,"direction"==x)((r+=l*t)<-90||90<r)&&(r<-90?r=-90:90<r&&(r=90),l*=-1);else if("charge"==x)((h+=l*t)<0||100<h)&&(h<0?h=0:100<h&&(h=100),l*=-1);else if("move"==x){var e=(h-=Math.abs(.1)*t*.5)/c,i=(e=Math.sin(e*Math.PI/2),(r-90)*Math.PI/180),o=2*Math.cos(i)*e,n=2*-Math.sin(i)*e;v+=n,d.pos.x+=o,d.pos.x<d.radius?d.pos.x=d.radius:d.pos.x>a.width-d.radius&&(d.pos.x=a.width-d.radius);for(var s=u.length-1;0<=s;s--)0==s?(u[s].pos.x=d.pos.x,u[s].pos.y=d.pos.y,u[s].radius=d.radius):(u[s].pos.x=u[s-1].pos.x,u[s].pos.y=u[s-1].pos.y+s/10*n,u[s].radius=u[s-1].radius);for(s=0;s<p.length;s++)p[s].pos.y+=n,p[s].pos.y>1.2*a.height?(p[s].radius=6+2*Math.random(),p[s].pos.x=Math.random()*a.width,p[s].pos.y=v,p[s].isPassed=!1,p[s].isClose=!1,v-=12+8*Math.random()):p[s].pos.y>d.pos.y&&0==p[s].isPassed&&(p[s].isPassed=!0,B(),I(d,p[s])&&0==p[s].isClose?(p[s].isClose=!0,g+=5,C=1):(g+=1,F=1),++y%15==0)&&d.radius++;for(s=p.length-1;0<=s;s--)R(d,p[s])&&(x="gameover",M.stop(),O(),S.r=254,S.g=20,S.b=20,w<g)&&(w=g,localStorage.setItem("com.harsanalif.slip.bestScore",w));h<=0&&(h=0,x="direction")}0==S.isReset()&&(5<S.r?S.r-=2:S.r<5&&(S.r=5),5<S.g?S.g-=2:S.g<5&&(S.g=5),5<S.b?S.b-=2:S.b<5&&(S.b=5)),0<F&&(F-=.03*t)<0&&(F=0),0<C&&(C-=.02*C)<0&&(C=0)}draw(){o.font="16px Courier",o.fillStyle="#FFFFFF",o.textAlign="center",o.textBaseline="middle";for(var t=0;t<p.length;t++)p[t].isPassed?this.drawEntityEnemy(p[t],"#0095DD"):this.drawEntityEnemy(p[t],"#DD0000"),p[t].isClose&&(o.globalAlpha=C,o.fillText("CLOSE! +5",p[t].pos.x,p[t].pos.y-20),o.globalAlpha=1);for("direction"==x?(o.save(),o.closePath(),o.translate(d.pos.x,d.pos.y),o.rotate((r-90)*Math.PI/180),o.beginPath(),o.rect(0,-3,100,6),o.fillStyle="#ffffff",o.fill(),o.restore(),n&&(o.font="20px Courier",o.fillStyle="#FFFFFF",o.textAlign="center",o.textBaseline="middle",o.fillText("HOLD DOWN TO START CHARGING",.5*a.width,.1*a.height))):"charge"==x&&(o.save(),o.closePath(),o.translate(d.pos.x,d.pos.y),o.rotate((r-90)*Math.PI/180),o.beginPath(),o.rect(0,-3,100,6),o.fillStyle="#777777",o.fill(),o.beginPath(),o.rect(0,-3,h,6),o.fillStyle="#ffffff",o.fill(),o.restore(),n)&&(o.font="20px Courier",o.fillStyle="#FFFFFF",o.textAlign="center",o.textBaseline="middle",o.fillText("RELEASE TO MOVE",.5*a.width,.1*a.height)),o.save(),o.globalAlpha=F,o.beginPath(),o.rect(0,d.pos.y-2,a.width,4),o.fillStyle="#0095DD",o.fill(),o.restore(),o.save(),o.globalAlpha=C,o.beginPath(),o.rect(0,d.pos.y-4,a.width,8),o.fillStyle="#ffffff",o.fill(),o.restore(),this.drawEntity(d,"#0095DD"),t=u.length-1;0<=t;t--)o.globalAlpha=1-t/u.length,this.drawEntity(u[t],"#0095DD");o.globalAlpha=1,"gameover"==x?(o.beginPath(),o.rect(0,0,a.width,a.height),o.fillStyle="#000000",o.globalAlpha=.75,o.fill(),o.globalAlpha=1,o.font="60px Courier",o.fillStyle="#FF0000",o.fillText("GAME OVER",.5*a.width,.5*a.height),o.font="30px Courier",o.fillStyle="#FFFFFF",o.textAlign="center",o.textBaseline="middle",o.fillText("SCORE: "+g,.5*a.width,.675*a.height),o.font="24px Courier",o.fillStyle="#FFFFFF",o.textAlign="center",o.textBaseline="middle",o.fillText("BEST SCORE: "+w,.5*a.width,.6*a.height)):(o.font="20px Courier",o.fillStyle="#FFFFFF",o.textAlign="center",o.textBaseline="middle",o.fillText("SCORE: "+g,.5*a.width,.95*a.height))}onPointerDown(t){"direction"==x?x="charge":"gameover"==x&&G(new P)}onPointerUp(t){"charge"==x&&(c=h,x="move",N(),n=!1)}end(){S.r=5,S.g=5,S.b=5}drawEntity(t,e){o.beginPath(),o.arc(t.pos.x,t.pos.y,t.radius,0,2*Math.PI),o.fillStyle=e,o.fill(),o.closePath()}drawEntityEnemy(t,e){o.beginPath(),o.moveTo(t.pos.x,t.pos.y-t.radius),o.lineTo(t.pos.x+t.radius,t.pos.y),o.lineTo(t.pos.x,t.pos.y+t.radius),o.lineTo(t.pos.x-t.radius,t.pos.y),o.lineTo(t.pos.x,t.pos.y-t.radius),o.fillStyle=e,o.fill(),o.closePath()}}class T{constructor(t,e,i){this.radius=t,this.pos={x:e,y:i}}}var k=0,D=0;function B(){for(f=function(e){var i;return 1e4<e?null:(i=Math.pow(t(e,1e4),2.1),Math.pow(e,3)&(e<3333.3333333333335?16:99)?i:-i)},t=(t,e)=>(e-t)/e,A=new AudioContext,m=A.createBuffer(1,96e3,48e3),b=m.getChannelData(0),i=96e3;i--;)b[i]=f(i);(s=A.createBufferSource()).buffer=m,s.connect(A.destination),s.start()}function O(){for(f=function(e){if(5e4<e)return null;e=5.3*Math.pow(e,1-Math.sin(e/1e5));var i=Math.sin(e/30+Math.sin(e/1500));return Math.pow(i,9)*t(e,5e4)},t=(t,e)=>(e-t)/e,A=new AudioContext,m=A.createBuffer(1,96e3,48e3),b=m.getChannelData(0),i=96e3;i--;)b[i]=f(i);(s=A.createBufferSource()).buffer=m,s.connect(A.destination),s.start()}function N(){for(f=function(e){return 2e4<(e*=1.5)?null:(128&Math.pow(e,1.055)?1:-1)*Math.pow(t(e,2e4),2)},t=(t,e)=>(e-t)/e,A=new AudioContext,m=A.createBuffer(1,96e3,48e3),b=m.getChannelData(0),i=96e3;i--;)b[i]=f(i);(s=A.createBufferSource()).buffer=m,s.connect(A.destination),s.start()}function R(t,e){var i=t.pos,o=e.pos,n=i.x-o.x,i=i.y-o.y;return Math.sqrt(n*n+i*i)<=t.radius+e.radius-4}function I(t,e){var i=t.pos,o=e.pos,n=i.x-o.x,i=i.y-o.y,o=Math.sqrt(n*n+i*i);return(n=t.radius+e.radius)<o&&o<=n+20}function z(t){e.onPointerDown(t)}function L(t){e.onPointerUp(t)}function G(t){e&&e.end(),(e=t).init()}document.addEventListener("touchstart",z,!1),document.addEventListener("touchend",L,!1),document.addEventListener("mousedown",z,!1),document.addEventListener("mouseup",L,!1),G(new P),function t(){o.clearRect(0,0,a.width,a.height),o.beginPath(),o.rect(0,0,a.width,a.height),o.fillStyle="rgba("+S.r+", "+S.g+", "+S.b+", "+S.a+")",o.fill(),e.update(),e.draw(),o.beginPath(),o.lineWidth="4",o.strokeStyle="rgba(255, 255, 255, 0.5",o.rect(0,0,a.width,a.height),o.stroke(),requestAnimationFrame(t)}()</script>