<!doctype html><meta content="width=device-width" name=viewport><link href=icon.png rel="shortcut icon"><title>Sum 13 - js13kGames 2012</title><style>*{-webkit-tap-highlight-color:transparent;-webkit-text-size-adjust:none;-webkit-touch-callout:none;-webkit-user-drag:none}html{background:#a7cfdf;background:-moz-linear-gradient(top,#a7cfdf 0,#23538a 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#a7cfdf),color-stop(100%,#23538a));background:-webkit-linear-gradient(top,#a7cfdf 0,#23538a 100%);background:-o-linear-gradient(top,#a7cfdf 0,#23538a 100%);background:-ms-linear-gradient(top,#a7cfdf 0,#23538a 100%);background:linear-gradient(to bottom,#a7cfdf 0,#23538a 100%);font-family:'Helvetica Neue',Helvetica,Arial,sans-serif;font-size:100%;margin:0;width:100%;height:100%;min-height:460px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-o-user-select:none;user-select:none}body{margin:7px 7px 0}#board{background:-moz-linear-gradient(top,rgba(255,255,255,.2) 0,rgba(241,241,241,.2) 20%,rgba(225,225,225,.2) 21%,rgba(246,246,246,.2) 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0,rgba(255,255,255,.2)),color-stop(20%,rgba(241,241,241,.2)),color-stop(21%,rgba(225,225,225,.2)),color-stop(100%,rgba(246,246,246,.2)));background:-webkit-linear-gradient(top,rgba(255,255,255,.2) 0,rgba(241,241,241,.2) 20%,rgba(225,225,225,.2) 21%,rgba(246,246,246,.2) 100%);background:-o-linear-gradient(top,rgba(255,255,255,.2) 0,rgba(241,241,241,.2) 20%,rgba(225,225,225,.2) 21%,rgba(246,246,246,.2) 100%);background:-ms-linear-gradient(top,rgba(255,255,255,.2) 0,rgba(241,241,241,.2) 20%,rgba(225,225,225,.2) 21%,rgba(246,246,246,.2) 100%);background:linear-gradient(to bottom,rgba(255,255,255,.2) 0,rgba(241,241,241,.2) 20%,rgba(225,225,225,.2) 21%,rgba(246,246,246,.2) 100%);border:1px solid rgba(0,0,0,.5);position:relative;margin:0 0 0 -153px;left:50%;width:304px;height:400px;-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;-webkit-box-shadow:0 1px 3px rgba(0,0,0,.5);-moz-box-shadow:0 1px 3px rgba(0,0,0,.5);box-shadow:0 1px 3px rgba(0,0,0,.5)}#scoreboard{position:relative;margin:2px 0 -12px -153px;left:50%;width:304px;height:40px}#scoreboard span{color:#e8e8e8;text-shadow:0 -1px 0 rgba(0,0,0,.8);vertical-align:top}#scoreboard p{color:#e8e8e8;font-size:.7em;text-shadow:0 -1px 0 rgba(0,0,0,.8);display:inline-block;float:right;position:relative;top:-42px;right:4px}#scoreboard a{color:#2e3192;font-family:Futura,Verdana,sans-serif;font-size:1.5em;font-weight:700;text-decoration:none;text-shadow:-1px -1px 0 rgba(255,255,255,.5),1px -1px 0 rgba(255,255,255,.5),-1px 1px 0 rgba(255,255,255,.5),1px 1px 0 rgba(255,255,255,.5)}#logo-button{cursor:pointer;display:inline-block;margin:4px 0 0 4px}#logo-button span{color:#1b1464;font-family:'Cooper Std','Cooper Black','Arial Black',sans-serif;font-size:2.2em;font-weight:700;line-height:1.3em;text-shadow:-1px -1px 0 #fff,1px -1px 0 #fff,-1px 1px 0 #fff,1px 1px 0 #fff,0 2px 5px rgba(0,0,0,.5)}#logo-button .block{display:inline-block;position:relative;-webkit-transform:scale(.75);-moz-transform:scale(.75);-ms-transform:scale(.75);-o-transform:scale(.75);transform:scale(.75)}#logo-button .r{top:-4px;left:-8px}#logo-button .g{top:0;left:-22px}#game-over-panel{position:absolute}#game-over-panel h1{color:#1b1464;font-family:'Cooper Std','Cooper Black','Arial Black',sans-serif;font-size:2.4em;position:relative;top:40px;width:300px;text-align:center;text-shadow:-1px -1px 0 #fff,1px -1px 0 #fff,-1px 1px 0 #fff,1px 1px 0 #fff,0 2px 5px rgba(0,0,0,.5)}#start-button{background:#f6f8f9;background:-moz-linear-gradient(top,#f6f8f9 0,#e5ebee 50%,#d7dee3 51%,#f5f7f9 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#f6f8f9),color-stop(50%,#e5ebee),color-stop(51%,#d7dee3),color-stop(100%,#f5f7f9));background:-webkit-linear-gradient(top,#f6f8f9 0,#e5ebee 50%,#d7dee3 51%,#f5f7f9 100%);background:-o-linear-gradient(top,#f6f8f9 0,#e5ebee 50%,#d7dee3 51%,#f5f7f9 100%);background:-ms-linear-gradient(top,#f6f8f9 0,#e5ebee 50%,#d7dee3 51%,#f5f7f9 100%);background:linear-gradient(to bottom,#f6f8f9 0,#e5ebee 50%,#d7dee3 51%,#f5f7f9 100%);border:1px solid rgba(0,0,0,.5);color:#00357a;font-size:1.6em;display:block;position:absolute;padding:8px 10px;top:172px;left:60px;width:160px;height:32px;text-align:center;text-decoration:none;text-shadow:0 -1px 0 rgba(0,0,0,.1),0 1px 0 rgba(255,255,255,.95);-webkit-border-radius:6px;-moz-border-radius:6px;border-radius:6px;-webkit-box-shadow:0 1px 0 rgba(255,255,255,.3),inset 0 1px 0 rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.8);-moz-box-shadow:0 1px 0 rgba(255,255,255,.3),inset 0 1px 0 rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.8);box-shadow:0 1px 0 rgba(255,255,255,.3),inset 0 1px 0 rgba(0,0,0,.1),0 1px 3px rgba(0,0,0,.8);-webkit-animation:color-rotate 3s linear 0s infinite;-moz-animation:color-rotate 3s linear 0s infinite;animation:color-rotate 3s linear 0s infinite}@-webkit-keyframes color-rotate{0%{color:#c0081c}33%{color:#08b030}66%{color:#3008c0}100%{color:#c0081c}}@-moz-keyframes color-rotate{0%{color:#c0081c}33%{color:#08b030}66%{color:#3008c0}100%{color:#c0081c}}@keyframes color-rotate{0%{color:#c0081c}33%{color:#08b030}66%{color:#3008c0}100%{color:#c0081c}}.row{border-bottom:1px solid rgba(255,255,255,.2);height:39px;-webkit-box-shadow:inset 0 -1px 0 rgba(0,0,0,.2);-moz-box-shadow:inset 0 -1px 0 rgba(0,0,0,.2);box-shadow:inset 0 -1px 0 rgba(0,0,0,.2)}.col{border-right:1px solid rgba(255,255,255,.2);float:left;width:37px;height:40px;-webkit-box-shadow:inset -1px 0 0 rgba(0,0,0,.2);-moz-box-shadow:inset -1px 0 0 rgba(0,0,0,.2);box-shadow:inset -1px 0 0 rgba(0,0,0,.2)}.col:last-child,.row:last-child{border:none;-webkit-box-shadow:none;-moz-box-shadow:none;box-shadow:none}.block{border:1px solid rgba(0,0,0,.2);color:#e8e8e8;cursor:pointer;font-size:2.2em;font-weight:700;line-height:1em;text-align:center;text-shadow:0 -1px 0 rgba(0,0,0,.5),0 1px 0 rgba(255,255,255,.3);text-rendering:optimizeLegibility;position:absolute;top:0;left:0;width:34px;height:36px;-webkit-border-radius:4px;-moz-border-radius:4px;border-radius:4px;-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 1px 2px rgba(0,0,0,.9);-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 1px 2px rgba(0,0,0,.9);box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 1px 2px rgba(0,0,0,.9);-webkit-backface-visibility:hidden;-moz-backface-visibility:hidden;-ms-backface-visibility:hidden;-o-backface-visibility:hidden;backface-visibility:hidden;-webkit-transform:translate(0,0);-moz-transform:translate(0,0);-ms-transform:translate(0,0);-o-transform:translate(0,0);transform:translate(0,0);-webkit-transition:-webkit-transform .2s linear,opacity .2s ease;-moz-transition:-moz-transform .2s linear,opacity .2s ease;-ms-transition:-ms-transform .2s linear,opacity .2s ease;-o-transition:-o-transform .2s linear,opacity .2s ease;transition:transform .2s linear,opacity .2s ease}.r{background:#f2283c;background:-moz-linear-gradient(top,#f2283c 0,#f27878 40%,#f00a14 41%,#c0081c 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#f2283c),color-stop(40%,#f27878),color-stop(41%,#f00a14),color-stop(100%,#c0081c));background:-webkit-linear-gradient(top,#f2283c 0,#f27878 40%,#f00a14 41%,#c0081c 100%);background:-o-linear-gradient(top,#f2283c 0,#f27878 40%,#f00a14 41%,#c0081c 100%);background:-ms-linear-gradient(top,#f2283c 0,#f27878 40%,#f00a14 41%,#c0081c 100%);background:linear-gradient(to bottom,#f2283c 0,#f27878 40%,#f00a14 41%,#c0081c 100%)}.r.selected{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #c0081c,inset 0 0 8px 10px rgba(255,255,255,.6);-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #c0081c,inset 0 0 8px 10px rgba(255,255,255,.6);box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #c0081c,inset 0 0 8px 10px rgba(255,255,255,.6);-webkit-animation:pulsate-r .3s ease 0s infinite alternate;-moz-animation:pulsate-r .3s ease 0s infinite alternate;animation:pulsate-r .3s ease 0s infinite alternate}@-webkit-keyframes pulsate-r{0%{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(192,8,28,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #c0081c,inset 0 0 8px 10px rgba(255,255,255,.6)}}@-moz-keyframes pulsate-r{0%{-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(192,8,28,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #c0081c,inset 0 0 8px 10px rgba(255,255,255,.6)}}@keyframes pulsate-r{0%{box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(192,8,28,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #c0081c,inset 0 0 8px 10px rgba(255,255,255,.6)}}.g{background:#14e028;background:-moz-linear-gradient(top,#14e028 0,#78e078 40%,#0ad014 41%,#08b030 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#14e028),color-stop(40%,#78e078),color-stop(41%,#0ad014),color-stop(100%,#08b030));background:-webkit-linear-gradient(top,#14e028 0,#78e078 40%,#0ad014 41%,#08b030 100%);background:-o-linear-gradient(top,#14e028 0,#78e078 40%,#0ad014 41%,#08b030 100%);background:-ms-linear-gradient(top,#14e028 0,#78e078 40%,#0ad014 41%,#08b030 100%);background:linear-gradient(to bottom,#14e028 0,#78e078 40%,#0ad014 41%,#08b030 100%)}.g.selected{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #08b030,inset 0 0 8px 10px rgba(255,255,255,.6);-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #08b030,inset 0 0 8px 10px rgba(255,255,255,.6);box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #08b030,inset 0 0 8px 10px rgba(255,255,255,.6);-webkit-animation:pulsate-g .3s ease 0s infinite alternate;-moz-animation:pulsate-g .3s ease 0s infinite alternate;animation:pulsate-g .3s ease 0s infinite alternate}@-webkit-keyframes pulsate-g{0%{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(8,176,48,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #08b030,inset 0 0 8px 10px rgba(255,255,255,.6)}}@-moz-keyframes pulsate-g{0%{-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(8,176,48,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #08b030,inset 0 0 8px 10px rgba(255,255,255,.6)}}@keyframes pulsate-g{0%{box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(8,176,48,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #08b030,inset 0 0 8px 10px rgba(255,255,255,.6)}}.b{background:#6450f0;background:-moz-linear-gradient(top,#6450f0 0,#8c8cff 40%,#5028f0 41%,#3008c0 100%);background:-webkit-gradient(linear,left top,left bottom,color-stop(0,#6450f0),color-stop(40%,#8c8cff),color-stop(41%,#5028f0),color-stop(100%,#3008c0));background:-webkit-linear-gradient(top,#6450f0 0,#8c8cff 40%,#5028f0 41%,#3008c0 100%);background:-o-linear-gradient(top,#6450f0 0,#8c8cff 40%,#5028f0 41%,#3008c0 100%);background:-ms-linear-gradient(top,#6450f0 0,#8c8cff 40%,#5028f0 41%,#3008c0 100%);background:linear-gradient(to bottom,#6450f0 0,#8c8cff 40%,#5028f0 41%,#3008c0 100%)}.b.selected{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #3008c0,inset 0 0 8px 10px rgba(255,255,255,.6);-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #3008c0,inset 0 0 8px 10px rgba(255,255,255,.6);box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #3008c0,inset 0 0 8px 10px rgba(255,255,255,.6);-webkit-animation:pulsate-b .3s ease 0s infinite alternate;-moz-animation:pulsate-b .3s ease 0s infinite alternate;animation:pulsate-b .3s ease 0s infinite alternate}@-webkit-keyframes pulsate-b{0%{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(48,8,192,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{-webkit-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #3008c0,inset 0 0 8px 10px rgba(255,255,255,.6)}}@-moz-keyframes pulsate-b{0%{-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(48,8,192,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{-moz-box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #3008c0,inset 0 0 8px 10px rgba(255,255,255,.6)}}@keyframes pulsate-b{0%{box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 4px 2px rgba(48,8,192,.8),inset 0 0 4px 6px rgba(255,255,255,.3)}100%{box-shadow:inset 0 1px 0 rgba(255,255,255,.4),inset 0 -1px 0 rgba(255,255,255,.3),0 0 8px 6px #3008c0,inset 0 0 8px 10px rgba(255,255,255,.6)}}</style><div id=board><div id=blocks></div><div id=game-over-panel><h1>Game Over</h1><a href=# id=start-button>Start Game</a></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div><div class=row><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div><div class=col></div></div></div><div id=scoreboard><div id=logo-button title="Sum 13 - Tap To Pause/Learn How To Play"><span>Sum</span><div class="block r">1</div><div class="block g">3</div></div><span>Score: </span><span id=score>0</span><p>Developed By: <a href=http://entropi.co target=_blank>entropi</a></div><audio id=destroy-sound preload=auto src=destroy.mp3><script>var t;function e(t){[].constructor.apply(this,arguments);for(var e=0,o=t.length;e<o;e++)this.push(t[e])}e.prototype=[],(e.constructor=e).prototype.toString=function(){for(var t="[",e=0,o=this.length;e<o;e++)t+=this[e]+(e<o-1?", ":"");return t+"]"},e.prototype.each=function(t){if(t&&"function"==typeof t)for(var e,o=0,n=this.length;o<n;o++)t.apply(e=this[o],[o,e]);return this},e.prototype.append=function(t){return 0!==this.length&&this[0].appendChild(t),this},e.prototype.remove=function(){return this.each(function(t,e){e.parentNode.removeChild(e)})},e.prototype.bind=function(t,e){return this.each(function(o,n){for(var s=t.split(" "),l=0,r=s.length;l<r;l++)n.addEventListener(s[l],e)})},e.prototype.addClass=function(t){return this.each(function(e,o){for(var n=o.className.split(" "),s=0,l=n.length;s<l;s++)if(n[s]===t)return;o.className+=" "+t})},e.prototype.removeClass=function(t){return this.each(function(e,o){for(var n=o.className.split(" "),s=[],l=0,r=n.length;l<r;l++)n[l]!==t&&s.push(n[l]);o.className=s.join(" ")})},e.prototype.html=function(t){return t||0===t||""===t?this.each(function(e,o){o.innerHTML=""+t}):(t="",this.each(function(e,o){t+=o.innerHTML}),t)};var o={init:function(){var e,o,n,s=this,l=this.blocks,r=this.$blocksContainer=t("#blocks");r.bind("ontouchstart"in window?"touchstart":"mousedown",function(t){(t=t.target.block)&&s.selectBlock(t)}).bind("webkitTransitionEnd transitionend MSTransitionEnd oTransitionEnd transitionEnd",function(t){var e=t.target.block;e&&"opacity"===t.propertyName&&e.$element.remove()});for(e=this.rowCount-1;0<=e;e--)for(l.push(n=[]),o=this.colCount-1;0<=o;o--)n.push(null);var i=this.$gameOverPanel=t("#game-over-panel");(this.$startButton=t("#start-button")).bind("click",function(t){i[0].style.display="none",s.gameOver=!1,s.setScore(0),t.preventDefault()}),(this.$logoButton=t("#logo-button")).bind("click",function(t){var e=r[0];e.style.display="none",window.setTimeout(function(){window.alert('How To Play Sum 13:\n- Tap the numbers after they fall to add up sums of "13"\n- The numbers in the sum must all be of the same color\n- You get 50 points for each block that you clear\n- The game is over once the blocks reach the top of the board'),e.style.display="block"},10)}),this.$score=t("#score"),this.destroySound=t("#destroy-sound")[0],window.setInterval(function(){s.step()},this.speed)},$blocksContainer:null,$gameOverPanel:null,$startButton:null,$logoButton:null,$score:null,destroySound:null,rowCount:10,colCount:8,blocks:[],selectedBlocks:[],gameOver:!0,speed:200,score:0,setScore:function(t){this.$score.html(this.score=t)},stepInterval:null,step:function(){if(!this.gameOver){for(var t,e,o,s,l=this,r=!1,i=0,c=this.colCount;i<c;i++)for(t=this.getBlocksInCol(i),o=0,s=this.rowCount;o<s;o++)(e=t[o])&&e.falling&&(e.row>this.getLandingRowForBlock(e)?e.setRow(e.row-1):e.falling=!1,r=!0);r||(e=new n).row===this.getLandingRowForBlock(e)&&(this.gameOver=!0,window.setTimeout(function(){for(var t,e,o,n=l.blocks,s=0,r=l.colCount;s<r;s++)for(t=0,e=l.rowCount;t<e;t++)(o=n[t][s])&&(function(t){window.setTimeout(function(){t.destroy()},100)}(o),n[t][s]=null);window.setTimeout(function(){l.$gameOverPanel[0].style.display="block"},500)},this.speed))}},getLandingRowForBlock:function(t){for(var e=this.getBlocksInCol(t.col),o=0,n=t.row-1;0<=n;n--)e[n]&&e[n]!==t&&o++;return o},getBlocksInCol:function(t){for(var e=this.blocks,o=[],n=0,s=this.rowCount;n<s;n++)o.push(e[n][t]);return o},dropBlocksInCol:function(t){for(var e,o=this.getBlocksInCol(t),n=0,s=this.rowCount;n<s;n++)(e=o[n])&&!e.falling&&(e.falling=!0)},clearSelection:function(){for(var t=this.selectedBlocks,e=t.length-1;0<=e;e--)t[e].toggleSelected();t.length=0},getSelectionSum:function(){for(var t=this.selectedBlocks,e=0,o=t.length-1;0<=o;o--)e+=t[o].value;return e},selectBlock:function(t){if(!t.falling){var e,o,n=this.selectedBlocks;if(t.selected){for(o=n.length-1;0<=o;o--)if(n[o]===t){n.splice(o,1);break}}else 0<n.length&&n[0].color!==t.color&&this.clearSelection(),n.push(t),13<(e=this.getSelectionSum())?this.clearSelection():13===e&&this.destroySelectedBlocks();t.toggleSelected()}},destroySelectedBlocks:function(){for(var t=this.selectedBlocks,e=t.length-1;0<=e;e--)t[e].destroy();this.setScore(this.score+50*t.length),t.length=0},Colors:{0:"r",1:"g",2:"b"}},n=function(){var e=this.value=Math.round(8*Math.random())+1,n=this.color=o.Colors[Math.round(2*Math.random())],s=(this.row=9,this.col=Math.round(7*Math.random())),l=this.element=document.createElement("DIV");this.$element=t(l),l.innerHTML=e,l.className="block "+n,l.block=this,o.$blocksContainer.append(l),(o.blocks[9][s]=this).setRow(9)};n.prototype={constructor:n,$element:null,element:null,width:38,height:40,value:-1,color:"",row:-1,col:-1,setRow:function(t){var e=this.col,n=this.element;o.blocks[this.row][e]=null,(o.blocks[t][e]=this).row=t,e="translate("+e*this.width+"px, "+(o.rowCount-t-1)*this.height+"px)",n.style.webkitTransform=e,n.style.MozTransform=e,n.style.msTransform=e,n.style.OTransform=e,n.style.transform=e},falling:!0,selected:!(t=function(t){return new e("string"==typeof t?document.querySelectorAll(t):t.length?t:[t])}),toggleSelected:function(){this.selected?(this.$element.removeClass("selected"),this.selected=!1):(this.$element.addClass("selected"),this.selected=!0)},destroy:function(){var t=this.element,e=this.row,n=this.col,s="translate("+n*this.width+"px, "+(o.rowCount-e-1)*this.height+"px) scale(3)";t.style.webkitTransform=s,t.style.MozTransform=s,t.style.msTransform=s,t.style.OTransform=s,t.style.transform=s,t.style.opacity=0,o.blocks[e][n]=null,o.dropBlocksInCol(n),o.destroySound.play()}},o.init()</script>