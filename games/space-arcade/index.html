<!doctype html><meta name=viewport content="width=device-width"><title>SPACE ARCADE</title><script>function HH(){this.A=function(r){for(var e=0;24>e;e++)this[String.fromCharCode(97+e)]=r[e]||0;.01>this.c&&(this.c=.01),.18>(r=this.b+this.c+this.e)&&(r=.18/r,this.b*=r,this.c*=r,this.e*=r)}}var UU=new function(){var r,e,t,a,s,i,n,h,c,f,o,u;this.z=new HH,this.reset=function(){var r=this.z;a=100/(r.f*r.f+.001),s=100/(r.g*r.g+.001),i=1-.01*r.h*r.h*r.h,n=1e-6*-r.i*r.i*r.i,r.a||(o=.5-r.n/2,u=5e-5*-r.o),h=1+r.l*r.l*(0<r.l?-.9:10),c=0,f=1==r.m?0:2e4*(1-r.m)*(1-r.m)+32},this.C=function(){this.reset();var a=this.z;return r=1e5*a.b*a.b,e=1e5*a.c*a.c,t=1e5*a.e*a.e+12,3*((r+e+t)/3|0)},this.B=function(b,v){var w=1!=(K=this.z).s||K.v,U=.1*K.v*K.v,k=1+3e-4*K.w,d=.1*K.s*K.s*K.s,g=1+1e-4*K.t,A=1!=K.s,l=K.x*K.x,m=K.g,y=K.q||K.r,z=.2*K.r*K.r*K.r,q=K.q*K.q*(0>K.q?-1020:1020),C=K.p?32+(2e4*(1-K.p)*(1-K.p)|0):0,H=K.d,M=K.j/2,p=.01*K.k*K.k,x=K.a,j=r,B=1/r,S=1/e,D=1/t;.8<(K=5/(1+20*K.u*K.u)*(.01+d))&&(K=.8);for(var E,F,G,I,J,K=1-K,L=!1,N=0,O=0,P=0,Q=0,R=0,T=0,V=0,W=0,X=0,Y=0,Z=Array(1024),$=Array(32),_=Z.length;_--;)Z[_]=0;for(_=$.length;_--;)$[_]=2*Math.random()-1;for(_=0;_<v;_++){if(L)return _;if(C&&++X>=C&&(X=0,this.reset()),f&&++c>=f&&(f=0,a*=h),(a*=i+=n)>s&&(a=s,0<m&&(L=!0)),F=a,0<M&&(Y+=p,F*=1+Math.sin(Y)*M),8>(F|=0)&&(F=8),x||(0>(o+=u)?o=0:.5<o&&(o=.5)),++O>j)switch(O=0,++N){case 1:j=e;break;case 2:j=t}switch(N){case 0:P=O*B;break;case 1:P=1+2*(1-O*S)*H;break;case 2:P=1-O*D;break;case 3:P=0,L=!0}y&&(0>(G=0|(q+=z))?G=-G:1023<G&&(G=1023)),w&&k&&(1e-5>(U*=k)?U=1e-5:.1<U&&(U=.1)),J=0;for(var rr=8;rr--;){if(++V>=F&&(V%=F,3==x))for(E=$.length;E--;)$[E]=2*Math.random()-1;switch(x){case 0:I=V/F<o?.5:-.5;break;case 1:I=1-V/F*2;break;case 2:I=.225*((0>(I=1.27323954*(I=6.28318531*(.5<(I=V/F)?I-1:I))+.405284735*I*I*(0>I?1:-1))?-1:1)*I*I-I)+I;break;case 3:I=$[Math.abs(32*V/F|0)]}w&&(E=T,0>(d*=g)?d=0:.1<d&&(d=.1),A?(R+=(I-T)*d,R*=K):(T=I,R=0),Q+=(T+=R)-E,I=Q*=1-U),y&&(Z[W%1024]=I,I+=Z[(W-G+1024)%1024],W++),J+=I}J*=.125*P*l,b[_]=1<=J?32767:-1>=J?-32768:32767*J|0}return v}};window.jsfxr=function(r){UU.z.A(r);var e=UU.C();r=new Uint8Array(4*((e+1)/2|0)+44),e=2*UU.B(new Uint16Array(r.buffer,44),e);(t=new Uint32Array(r.buffer,0,44))[0]=1179011410,t[1]=e+36,t[2]=1163280727,t[3]=544501094,t[4]=16,t[5]=65537,t[6]=44100,t[7]=88200,t[8]=1048578,t[9]=1635017060,t[10]=e;e+=44;for(var t=0,a="data:audio/wav;base64,";t<e;t+=3){var s=r[t]<<16|r[t+1]<<8|r[t+2];a=a+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[s>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[s>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[s>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&s])}return a}</script><style>body,html{width:100%;height:100%;margin:0;border:0;overflow:hidden;display:block;background:#000}</style><canvas id=c></canvas><canvas id=menu></canvas><script>const e=({height:e=5,...t}={},n)=>{if(t){if(n)return(o,r=0,a=0,i=24,l="#000")=>{console.debug("Rendering string",o),[...o].reduce(((o,c)=>{const f=i/e,u=t[c.charCodeAt()]||"",s=u>0?u:u.codePointAt(),d=(s||0).toString(2),h=Math.ceil(d.length/e),g=o+f,p=((e,t)=>e.match(new RegExp(`.{${t}}`,"g")))(d.padStart(h*e,0),e);return console.debug("Rendering char",c,c.charCodeAt(),u,s,p),p.map(((e,t)=>[...e].map(((e,o)=>{n.fillStyle=+e?l:"transparent",n.fillRect(r+g+t*f,a+o*f,f,f)})))),o+(h+1)*f}),0)};console.error("No context provided")}else console.error("No font provided!")},t=[...Array(33),29,,,,,,12,,,,"ᇄ",3,"ႄ",1,1118480,"縿",31,"庽","嚿","炟","皷","纷","䈟","线","皿",17,,,"⥊",,"䊼",,"㹏","纮","縱","縮","纵","纐","񴚦","粟","䟱","丿",1020241,"簡",33059359,1024159,"縿","纜","񼙯","繍","皷","䏰","簿",25363672,32541759,18157905,"惸",18470705,,,,,"С"];function n(e){let t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1)},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0)},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function o(e){let t=e.data,n=t.length;for(i=0;i<n;i+=4)t[i+3]=t[i+3]<127.5?0:255;return t}const r=e=>Math.random()<e/100;function a(e,t){return e.x<t.x+t.w&&e.x+e.w>t.x&&e.y<t.y+t.h&&e.y+e.h>t.y}function l(e,t,n){let o=2+(r(50)?1:0),a=Math.random()*(2*Math.PI),i=o*Math.cos(a),l=o*Math.sin(a),c=0;return{update:function(){return e+=i,t+=l,c++<20},draw:function(o){o.fillStyle=n,o.fillRect(e,t,1,1)}}}function f(e,t,n,o,a,i){let c=function(e,t,n){let o=[];for(let r=0;r<e*t;r++)o.push(n&1<<r);return{getPixelAt:(t,n)=>(t>=e&&(t=2*e-2-t),o[n*e+t])}}(n,o,a),f=0,s=0,d={x:e,y:t,w:2*(n=2*n-1),h:2*o},h=`hsl(${u(0,360)},${u(42,98)}%,${u(40,90)}%)`,g=r(50)?-n:n,p={x:e+d.w/2,y:t+d.h/2};return{bounds:d,origin:p,update:function(n){return s=r(25)?r(75)?1:2:0,f=r(.5)?g:0,r(.1)&&(g*=-1),(e+=f)<0&&(e=0),e+d.w>1024&&(e-=d.w),d.x=e,d.y=t+=s,p.x=e+d.w/2,p.y=t+d.h/2,!(t>318&&n.getPixelAlpha(p.x,p.y))||(n.explode(p.x,p.y-1.5*d.h,2*d.h),!1)},draw:function(r){r.fillStyle=h;for(let a=0;a<n;a++)for(let n=0;n<o;n++)c.getPixelAt(a,n)&&r.fillRect(e+2*a,t+2*n,2,2)},explode:function(){let a=t/352,i=[];for(let f=0;f<n;f++)for(let n=0;n<o;n++)c.getPixelAt(f,n)&&r(50+50*a)&&i.push(l(e+2*f,t+2*n,h));return i},getSector:()=>i}}function u(e,t){return Math.floor(Math.random()*(t-e+1))+e}const s=1e3/60;function d(e,t,n,o){if(t+1==n)return;let r=Math.floor((t+n)/2);e[r]=Math.round((e[t]+e[n])/2+(2*Math.random()-1)*o),d(e,t,r,o*=.65),d(e,r,n,o)}function h(e,t,n,r,a){let i=["#055dd7","#568d2e","#c43653","#b6213d"],l=0;e.clearRect(0,0,t,n),e.fillStyle=i[l++],e.fillRect(0,r-8,t,n-(r-8));let c=Math.floor(t/128),f=Math.floor((t-128*c)/2),u=new Array(129).fill(r);d(u,0,128,a),e.fillStyle=i[l++],e.beginPath(),e.moveTo(0,r);for(let t=0;t<u.length;t++)e.lineTo(f+c*t,u[t]);e.lineTo(t,r),e.lineTo(t,n),e.lineTo(0,n),e.lineTo(0,r),e.fill(),e.fillStyle=i[l++],e.beginPath(),e.moveTo(0,r);for(let t=0;t<u.length;t++)e.lineTo(f+c*t,n-.75*(n-u[t]));e.lineTo(t,r),e.lineTo(t,n),e.lineTo(0,n),e.lineTo(0,r),e.fill(),e.strokeStyle="#d42449",e.lineWidth=4,e.beginPath(),e.moveTo(0,n-92),e.lineTo(t,n-92),e.stroke(),e.fillStyle=i[l++],e.fillRect(0,n-92,t,92);let s=e.getImageData(0,0,t,n);return{imageData:s,pixels:o(s)}}c.width=1024,c.height=512,c.style["image-rendering"]="pixelated",c.style.display="none";let g=c.getContext("2d");g.imageSmoothingEnabled=!1;let p=.89,x=0,m=0,y={scale:p,angle:m,offX:.5,offY:x,easing:.3},w=.24,R=.95,T=!1,E=0,S=[],P=[],A=[],v=function(e,t){const n=document.createElement("canvas");n.width=1024,n.height=1024,n.style.height=window.innerHeight-30+"px",document.body.appendChild(n);const o=n.getContext("webgl",{alpha:!1});let r,a,i;return{init:function(e,t){let n=o.createShader(o.VERTEX_SHADER),l=o.createShader(o.FRAGMENT_SHADER),c=o.createProgram(),f=o.createBuffer(),u=o.createTexture();o.shaderSource(n,"\nattribute vec2 aVertPos;\nvarying vec2 vTexCoord;\nvoid main() {\n  vTexCoord=(aVertPos+1.0)*0.5;\n  gl_Position=vec4(aVertPos,0,1);\n}"),o.compileShader(n),o.shaderSource(l,"\nprecision mediump float;\nvarying vec2 vTexCoord;\nuniform sampler2D uSampler;\nuniform vec2 uRes;\nuniform vec2 uOff;\nuniform float uScale;\nuniform float uAngle;\n#define PI 3.14159265358979323844\nfloat hash(vec2 co){return fract(sin(dot(co,vec2(12.9898, 78.233)))*43758.5453);}\nfloat hash(float x,float y){return hash(vec2(x, y));}\nfloat draw_circle(vec2 coord,float radius){\n  return step(length(coord),radius);\n}\nvoid main() {\n  vec2 pos=gl_FragCoord.xy/uRes;\n  vec2 p=(pos-uOff)*uScale; \n  float circle=draw_circle(p,1.0);\n  float r=length(p);\n  float a=0.25-atan(p.y,p.x)/(PI*2.0)+uAngle;\n  vec4 color=texture2D(uSampler,vec2(a, r));\n  vec2 co=gl_FragCoord.xy/float(uRes.y);\n  vec3 col=vec3(0.0);\n  vec2 sco=co*500.0;\n  if(hash(floor(sco))<0.005){\n    float s1=hash(floor(sco)*floor(sco));\n    float s2=max(1.-2.*distance(vec2(0.5),fract(sco)),0.0);\n    col+=vec3(s1*s2);\n  }\n  if(color.xyz==vec3(0.0))color.xyz+=col;\n  gl_FragColor=vec4(color.xyz*vec3(circle),1.0);\n}"),o.compileShader(l),o.attachShader(c,n),o.attachShader(c,l),o.linkProgram(c),o.useProgram(c),o.bindBuffer(o.ARRAY_BUFFER,f),o.bufferData(o.ARRAY_BUFFER,new Float32Array([-1,-1,1,-1,-1,1,1,1]),o.STATIC_DRAW);let s=o.getAttribLocation(c,"aVertPos"),d=o.getUniformLocation(c,"uSampler"),h=o.getUniformLocation(c,"uRes");i=o.getUniformLocation(c,"uOff"),r=o.getUniformLocation(c,"uScale"),a=o.getUniformLocation(c,"uAngle"),o.enableVertexAttribArray(s),o.vertexAttribPointer(s,2,o.FLOAT,!1,0,0),o.uniform1i(d,0),o.uniform2f(h,1024,1024),o.uniform2f(i,e.offX,e.offY),o.uniform1f(r,e.scale),o.uniform1f(a,e.angle),o.activeTexture(o.TEXTURE0),o.bindTexture(o.TEXTURE_2D,u),o.pixelStorei(o.UNPACK_FLIP_Y_WEBGL,!0),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_S,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_WRAP_T,o.REPEAT),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MIN_FILTER,o.NEAREST),o.texParameteri(o.TEXTURE_2D,o.TEXTURE_MAG_FILTER,o.NEAREST),o.texImage2D(o.TEXTURE_2D,0,o.RGBA,o.RGBA,o.UNSIGNED_BYTE,t)},draw:function(e){o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,e),o.drawArrays(o.TRIANGLE_STRIP,0,4)},setScale:function(e){o.uniform1f(r,e)},setAngle:function(e){o.uniform1f(a,e)},setOffset:function(e,t){o.uniform2f(i,e,t)}}}(),M=function(e,t){let n,o=0;function r(t,o){let r=4*(o*e+t);return n.pixels[r+3]}function a(t,o){let r=4*(o*e+t);n.pixels[r]=0,n.pixels[r+1]=0,n.pixels[r+2]=0,n.pixels[r+3]=0}return speed=2,{init:function(t){n=h(t,e,512,352,34)},update:()=>{o+=0,o>=e&&(o=0),o<=-e&&(o=0)},draw:t=>{t.putImageData(n.imageData,o,0),o>0?t.putImageData(n.imageData,o-e,0):o<0&&t.putImageData(n.imageData,o+e,0)},getPaddleHeight:e=>{let t=512;for(;0!==r(e,t);)t--;return t},getPixelAlpha:r,explode:function(e,t,n){for(xPos=e-n;xPos<=e+n;xPos++)for(yPos=t-n;yPos<=t+n;yPos++)Math.pow(xPos-e,2)+Math.pow(yPos-t,2)<n*n&&0!==r(xPos,yPos)&&a(xPos,yPos)}}}(1024),b=function(e){let t,n=0,r=512,a=0,i=0,l=1,c=()=>Math.round((n%1024+1024)%1024),f={x:n-4,y:r-4,w:8,h:4};return{hitBox:f,init:function(e){e.clearRect(0,0,16,8),e.fillStyle="#F5F5F5",e.beginPath(),e.moveTo(0,8),e.lineTo(8,0),e.lineTo(16,8),e.fill();let n=e.getImageData(0,0,16,8);o(n),createImageBitmap(n).then((e=>t=e))},update:function(t){a+=i,a*=e,n+=a;let o=c();r=t.getPaddleHeight(o)-l,f.x=o-4,f.y=r-4,l=1},draw:function(e){if(t){let n=c(),o=n-8;o<0&&e.drawImage(t,1024+o,r-8),o=8-(1024-n),o>=0&&e.drawImage(t,o-16,r-8),e.drawImage(t,n-8,r-8)}},getPosRatio:()=>n/1024,getAngleRatio:()=>c()/1024,setVelX:e=>a=e,getVelX:()=>a,setAccX:e=>i=e,getBulletSpawnPos:function(){return l=0,{x:c(),y:r-8}},setFriction:t=>{e=t}}}(R),_=function(e,t){let n=new Array(7).fill(0),o=Math.round(1024/7),a=0,i=0;return{getSpawnPos:function(){r(1)&&(i=Math.floor(7*Math.random()));let e=function(e){let t=[e];for(let n=1;n<=3;n++){let o=(e+n)%7,a=e-n;a<0&&(a=7+a),r(50)?t.push(o,a):t.push(a,o)}return t}(i),t=e.shift();for(;!(n[t]<20);)t=e.shift();return n[t]++,a++,{x:t*o+Math.round(Math.random()*o),sector:t}},decreaseSectorCount:function(e){n[e]--,a--},canSpawn:()=>a<140}}(),D=function(){menu.width=1024,menu.height=30;let n=menu.getContext("2d"),o=e(t,n);function r(e){n.fillStyle="black",n.fillRect(0,0,1024,30),o(e,0,5,20,"white")}return r(""),{writeLine:r}}(),U=function(){let e=!1,t=jsfxr([2,0,.22489224400401017,.09549238635077185,.23635858232669682,.7904206221041251,.22076118216218082,-.334590885536479,0,0,0,0,0,.14268572930257606,.1407204766846248,0,0,0,1,0,0,.023957396765223016,0,.5]),n=new Audio;n.src=t;let o=jsfxr([3,0,.10620194759539255,.7098552264702449,.19705566552118225,.23804260137273073,0,.29205304349669536,0,0,0,0,0,0,0,0,.5381613843694975,-.28664236647301367,1,0,0,0,0,.5]),r=new Audio;return r.src=o,{playHit:()=>{e||r.play()},playPew:()=>{e||n.play()},switchMute:()=>e=!e}}(),X=function(e,t,n){let o=s,r=0,a=!0;return function(){D.writeLine(`SCORE: ${E}`),b.init(g),M.init(g);for(let e=0;e<60;e++)_.canSpawn()&&C();v.init(y,c)}(),function e(){if(!a)return;requestAnimationFrame(e);let n=performance.now(),i=n-r;for(r=n,o+=i,o>33.333333333333336&&(o=33.333333333333336);o>=s;)t(),o-=s;g.clearRect(0,0,1024,512),M.draw(g),b.draw(g),S.forEach((e=>e.draw(g))),P.forEach((e=>e.draw(g))),A.forEach((e=>e.draw(g))),v.draw(c)}(),{stop:()=>a=!1}}(0,(function(){M.update(),b.update(M),S=S.filter((e=>{let t=e.update(M);if(t&&a(e.bounds,b.hitBox)&&(E++,D.writeLine(`SCORE: ${E}00`),t=!1),t){let{bounds:t}=e;t.y+t.h>420&&(D.writeLine(`SCORE: ${E}00 - GAME OVER - PRESS R TO RESTART`),X.stop())}else U.playHit(),_.decreaseSectorCount(e.getSector()),A.push(...e.explode());return t})),P=P.filter((e=>{let t=e.update();for(let t=S.length-1;t>-1;t--){let n=S[t];if(a(n.bounds,e.bounds)){U.playHit(),E++,D.writeLine(`SCORE: ${E}00`),_.decreaseSectorCount(n.getSector()),A.push(...n.explode()),S.splice(t,1);break}}let{origin:n}=e;if(n.y>352){let e=Math.round(n.x);M.getPixelAlpha(e,n.y)&&M.explode(e,n.y,4)}return t})),(S.length<60||r(2))&&_.canSpawn()&&C(),A=A.filter((e=>e.update()));let e=y.scale;Math.abs(p-e)>.001&&(e+=(p-e)*y.easing/2,v.setScale(y.scale=e));let t=y.offY;Math.abs(x-t)>.001&&(t+=(x-t)*y.easing/2,v.setOffset(y.offX,y.offY=t));let n=y.angle;if(Math.abs(m-n)>.001)n+=(m-n)*y.easing/2,v.setAngle(y.angle=n);else{let e=b.getPosRatio()%1,t=y.angle;t<0&&e>.5&&(e-=1),Math.abs(e-t)>.25&&(O(),T||(T=!0))}T&&Math.abs(b.getVelX())<.01&&G()}));function C(){let e=_.getSpawnPos(),t=f(e.x,Math.round(64*Math.random()),3,5,Math.floor(32768*Math.random()),e.sector);S.push(t)}let I=n(37),L=n(39),F=n(16),B=n(32),H=n(77),N=n(82);function O(){m=0,p=1.41,x=.5}function G(){m=b.getPosRatio()%1,m>.5?m-=1:m<-.5&&(m=1+m),p=.89,x=0,T=!1}I.press=()=>b.setAccX(-w),I.release=()=>b.setAccX(0),L.press=()=>b.setAccX(w),L.release=()=>b.setAccX(0),B.press=()=>{U.playPew();let{x:e,y:t}=b.getBulletSpawnPos();P.push(function(e,t,n,o){let r={x:e-1,y:t-1,w:2,h:2},a={x:e,y:t};return{bounds:r,origin:a,update:function(){return a.x=e+=Math.random()-.5,a.y=t+=-4,r.x=e-1,r.y=t-1,t>=0},draw:function(e){e.fillStyle="red",e.fillRect(r.x,r.y,2,2)}}}(e,t))},H.press=()=>{U.switchMute()},N.press=()=>{window.location.reload()},F.press=O,F.release=G</script>