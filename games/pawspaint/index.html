<!doctype html><meta name=viewport content="width=device-width"><title>PawsPaint - js13kGames 2025</title><style>:root{font-size:8em;--black:#0C121F;--dark-blue:#0f1939;--blue:#37507e;--white:#fdfbdf;--std-anim:cubic-bezier(.33, 1, .66, 1)}*{margin:0}body{background:radial-gradient(circle at top left,#e3aa8764,transparent 50%),radial-gradient(circle at top right,#e3aa8764,transparent 50%),radial-gradient(#37457b,var(--dark-blue));display:flex;width:100dvw;height:100dvh;align-items:center;justify-content:center;overflow:hidden}.grid{--rotX:0deg;--rotZ:0deg;display:grid;place-items:center;transition:transform .3s var(--std-anim);transform:perspective(700px) rotateX(calc(var(--rotX) + 50deg)) rotate(var(--rotZ)) translateZ(0);transform-style:preserve-3d}.sprite{--rotX:0;--rotY:0;--rotZ:0;--sprite-z-offset:0rem;--sprite-y-offset:0rem;width:1rem;height:1rem;image-rendering:pixelated;transition:transform .3s ease-in-out;transform-origin:center bottom;transform:translate3d(0,var(--sprite-y-offset),var(--sprite-z-offset)) rotateY(var(--rotY)) rotate(var(--rotZ)) rotateX(var(--rotX))}.sprite[anim=no-animation]{animation:none}.sprite[anim=drop-animation]{animation:apparition 1.5s var(--std-anim)}.sprite[anim=fade-animation]{animation:fade-in .3s ease-out}.sprite[anim=joy-animation]{animation:joy-dance 1s ease-in-out infinite}.entity-cat[anim=sad-animation]{animation:sad .5s ease-out infinite alternate}.nonwalkable{background-color:var(--black)}.walkable{background:url(floor.webp);background-size:cover;image-rendering:pixelated;z-index:-10}.obj{z-index:10;background-image:url(objects.webp);background-size:4rem}.obj-paint{background-position:0 1rem}.obj-yarn{background-position:-3rem 1rem}.obj-soap{background-position:-2rem 1rem}.obj-puddle{background-position:-1rem 1rem}.obj-bucket{background-position:0 2rem}.obj-empty-bucket{background-position:-1rem 2rem}.obj-puddle[anim=spread-animation]{animation:puddle-spread 1s ease-in-out}.entity-cat{background-image:url(cat.webp);position:relative;background-size:3rem;background-position:bottom left 0;background-repeat:no-repeat;image-rendering:pixelated;z-index:20}.entity-cat[anim=joy-animation]{background-position:100% 100%}.entity-cat[anim=sad-animation]{background-position:50% 100%}@keyframes apparition{0%{opacity:0;scale:0;transform:translate3d(0,var(--sprite-y-offset),calc(var(--sprite-z-offset) + 5rem)) rotate(var(--rotZ)) rotateX(var(--rotX))}to{opacity:1;scale:1;transform:translate3d(0,var(--sprite-y-offset),var(--sprite-z-offset)) rotate(var(--rotZ)) rotateX(var(--rotX))}}@keyframes fade-in{0%{opacity:0;scale:0}to{opacity:1;scale:1}}@keyframes joy-dance{0%,to{transform:translate3d(0,var(--sprite-y-offset),var(--sprite-z-offset)) rotate(var(--rotZ)) rotateX(var(--rotX)) skew(-10deg)}50%{transform:translate3d(0,var(--sprite-y-offset),var(--sprite-z-offset)) rotate(var(--rotZ)) rotateX(var(--rotX)) skew(10deg)}}@keyframes sad{0%{transform:translate3d(0,var(--sprite-y-offset),var(--sprite-z-offset)) rotate(var(--rotZ)) rotateX(var(--rotX)) scaleY(1)}to{transform:translate3d(0,var(--sprite-y-offset),var(--sprite-z-offset)) rotate(var(--rotZ)) rotateX(var(--rotX)) scaleY(1.2)}}@keyframes puddle-spread{0%{scale:0;opacity:0}50%{opacity:1}to{scale:1;opacity:0}}h1,h2,h3,p,span{font-size:20%;color:var(--white);font-family:monospace}[hidden]{display:none!important}.ui{position:fixed;top:0;right:0;width:100dvw;height:100dvh;display:flex;flex-direction:column;justify-content:space-between;align-items:center;padding:10px;box-sizing:border-box;transition:height .3s ease-in-out}header{display:flex;gap:.5rem;justify-content:center;align-items:center;transition:transform 1s cubic-bezier(.33,1,.66,1)}.ui[visible=false] header{transform:translateY(-1rem)}header div{height:min-content;display:flex;align-items:center;gap:.2rem;font-size:1.5rem}header button{width:.5rem;height:.5rem;background:url(ui.webp) no-repeat;background-size:1.5rem;image-rendering:pixelated;border:none;border-radius:10%;cursor:pointer;outline:4px var(--blue) outset;transition:all .1s var(--std-anim)}header button:hover{border-radius:20%}header button:active{outline:4px var(--blue) inset}.moves-remaning-div{display:flex;align-items:center;gap:.2rem;font-size:1.5rem}.moves-remaning-div .sprite{width:.5rem;height:.5rem;background-size:2rem;background-position:0 100%}.btn.undo{background-position:0 0}.btn.home{background-position:50% 0}.btn.reset{background-position:100% 0}footer{display:flex;flex-direction:column;align-items:center}.arrow-key-help{width:3rem;height:2rem;display:grid;grid-template-areas:". u ." "l d r";scale:.5}.arrow{--size:1rem;width:var(--size);height:var(--size);background:url(ui.webp) no-repeat;background-size:calc(var(--size) * 3);image-rendering:pixelated;display:block;background-position:0 100%}.arrow:after,.follow-mouse div{content:"";background-position:50% 100%}.arrow:first-child{grid-area:u}.arrow:first-child:after{transform:rotate(0)}.arrow:nth-child(2){grid-area:l}.arrow:nth-child(2):after{transform:rotate(-90deg)}.arrow:nth-child(3){grid-area:d}.arrow:nth-child(3):after{transform:rotate(180deg)}.arrow:nth-child(4){grid-area:r}.arrow:nth-child(4):after{transform:rotate(90deg)}.screen-elements{position:fixed;top:0;left:0;width:100dvw;height:100dvh;pointer-events:none}.follow-mouse{display:flex;gap:.1rem;position:absolute;translate:-50% -50%;padding:.1rem;background-color:var(--black);border:5px solid var(--white);border-radius:10px;opacity:1;animation:infinite alternate wiggle 1s ease-in-out;transition:opacity 1s ease-in-out;cursor:pointer}.follow-mouse div{--size:.2rem;rotate:90deg}@keyframes wiggle{0%{transform:rotate(-5deg)}to{transform:rotate(5deg)}}</style><div id=app><div id=game><div class=level></div><div class=ui visible=false><header><div class=moves-remaning-div><div class="sprite obj-paint obj" alt=""></div><span class=moves-remaning>10</span></div><div><button class="btn undo"></button> <button class="btn home"></button> <button class="btn reset"></button></div></header><footer><h1 class=level-name></h1><span class=level-description></span></footer><div class=screen-elements><canvas class=screen-canvas></canvas><div class=level-complete-objects><div class=lines-elements></div><div class=follow-mouse hidden><span>Next Level</span><div class=arrow></div></div></div></div></div></div></div><script>function e(e){const t=`${e}`.split(".");for(;t.length<3;)t.push("0");let s=[];return t.forEach((e,t)=>{s.push({raw:e||null,type:parseInt(e)||0,data:e.replace(/[^a-zA-Z]/g,"")||null,spriteIndex:t,isEmpty:"0"===e||""===e})}),s}function t(e,t){let s=["0","0","0"];return e.forEach(e=>{s[e.spriteIndex]=e.raw||"0"}),s.join(".")}function s(e,t,s){for(const i of t)i instanceof e&&s(i)}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver(e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)}).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();class i{pos;div;element;dir;g;id=crypto.randomUUID();billboard=!1;cameraPos;moving=!1;canWalkOver=!0;constructor(e){this.pos=e.pos,this.element=e.el,this.dir=1===e.el.data?.length?e.el.data[0]:"U",this.g=e.g,this.cameraPos={x:(this.g.w-1)/-2,y:4},this.div=this.divGenerator(e.animationName),this.setBillboard(),this.rotateTo(function(e){switch(e){case"U":default:return 0;case"R":return 90;case"D":return 180;case"L":return 270}}(this.dir))}divGenerator(e){let t=document.createElement("div");return t.classList.add("sprite"),t.setAttribute("anim",e??"drop-animation"),t.style.gridArea=`${this.pos.y+1} / ${this.pos.x+1}`,t.style.setProperty("--rotZ",Math.atan2(this.pos.x+this.cameraPos.x,this.pos.y+this.cameraPos.y)+"rad"),t}setBillboard(e=!1){this.billboard=e,this.billboard?(this.div.setAttribute("sprite-render","billboard"),this.div.style.setProperty("--rotX","-90deg"),this.div.style.setProperty("--rotZ",Math.atan2(this.pos.x+this.cameraPos.x,this.pos.y+this.cameraPos.y)+"rad"),this.div.style.setProperty("--sprite-y-offset","-0.3rem"),this.div.style.setProperty("--sprite-z-offset","0.0rem"),this.div.style.transformOrigin="center bottom"):(this.div.setAttribute("sprite-render","flat"),this.div.style.setProperty("--rotX","0"),this.div.style.setProperty("--rotZ","0"),this.div.style.setProperty("--sprite-y-offset","0rem"),this.div.style.setProperty("--sprite-z-offset","0rem"),this.div.style.transformOrigin="center center")}setAnimation(e="no-animation"){this.div.setAttribute("anim",e)}rotateTo(e){this.div.style.setProperty("--rotZ",e+"deg")}moveTo(e,t=!1){!t&&(this.moving||null===this.g.getTileAt(e)||e.x<0||e.y<0||e.x>=this.g.w||e.y>=this.g.h)||(this.g.game.moveCount++,this.g.game.uiEl.querySelector(".moves-remaning").textContent=this.g.game.maxMoves?String(this.g.game.maxMoves-this.g.game.moveCount):"∞",this.g.game.maxMoves&&this.g.game.maxMoves-this.g.game.moveCount==0&&this.g.game.changeStatus("levelFailed"),this.moving=!0,this.dir=function(e,t){return Math.abs(e)>Math.abs(t)?e>0?"R":"L":Math.abs(t)>Math.abs(e)?t>0?"D":"U":null}(e.x-this.pos.x,e.y-this.pos.y)||this.dir,this.div.style.transition="none",this.div.style.transform=`translate3d(0, var(--sprite-y-offset), var(--sprite-z-offset)) translate(${this.pos.x-e.x}rem, ${this.pos.y-e.y}rem) rotateZ(var(--rotZ)) rotateX(var(--rotX))`,this.div.offsetWidth,this.div.style.transition="transform 0.3s ease-in-out",this.actionWhenMoving(e,this.dir),this.pos=e,this.div.style.gridArea=`${this.pos.y+1} / ${this.pos.x+1}`,this.div.style.setProperty("--rotZ",this.billboard?Math.atan2(this.pos.x+this.cameraPos.x,this.pos.y+this.cameraPos.y)+"rad":"0"),this.div.style.transform="translate3d(0, var(--sprite-y-offset), var(--sprite-z-offset)) translate(0rem, 0rem) rotateZ(var(--rotZ)) rotateX(var(--rotX))",setTimeout(()=>{this.moving=!1,this.hasChangedPosition(e,this.dir)},300))}actionWhenMoving(e,t){}hasChangedPosition(e,t){}dispose(){this.div?.remove()}}const n="15px",a=new Map([[1,"Marble"]]),r=new Map([[1,"Paint"],[2,"Yarn"],[3,"Soap"],[4,"Bucket"],[5,"Puddle"],[6,"Ladyline"],[7,"EmptyBucket"]]),o=new Map([[1,"Cat"],[2,"Mouse"],[3,"Lady"]]);class l extends i{constructor(e){super(e),setTimeout(()=>this.spawnElement(),e.spawnDelay)}spawnElement(){this.div.classList.add("base");const e=[this.chkBorder(-1,-1)?"0":n,this.chkBorder(1,-1)?"0":n,this.chkBorder(1,1)?"0":n,this.chkBorder(-1,1)?"0":n].join(" ");this.div.style.borderRadius=e,this.g.gEl?.appendChild(this.div)}chkNear(e,t){return null!==(this.g.getTileAt({x:this.pos.x+e,y:this.pos.y+t})?.base??null)}chkBorder(e,t){return this.chkNear(e,0)||this.chkNear(0,t)}removeElement(){this.g.bases=this.g.bases.filter(e=>e.id!==this.id),this.dispose()}}class h extends i{constructor(e){super(e),setTimeout(()=>this.spawnElement(),e.spawnDelay)}spawnElement(){this.div.classList.add("obj"),this.g.gEl?.appendChild(this.div)}removeElement(){this.g.objects=this.g.objects.filter(e=>e.id!==this.id),this.dispose()}}class d extends i{constructor(e){super(e),setTimeout(()=>this.spawnElement(),e.spawnDelay)}spawnElement(){this.div.classList.add("entity"),this.g.gEl?.appendChild(this.div)}removeElement(){this.g.entities=this.g.entities.filter(e=>e.id!==this.id),this.dispose()}}class c extends h{constructor(e){super(e),this.div.classList.add("obj-paint")}}class u extends h{constructor(e){super(e),this.div.classList.add("obj-puddle"),this.animateSpread()}animateSpread(){this.setAnimation("spread-animation"),setTimeout(()=>this.removeElement(),1e3)}}class m extends h{constructor(e){super(e),this.div.classList.add("obj-empty-bucket"),this.canWalkOver=!1}}class p extends h{isUsed;constructor(e){super(e),this.div.classList.add("obj-bucket"),this.setBillboard(!0),this.canWalkOver=!1,this.isUsed=!1}passingBy(t,s){if(!t||!s||this.isUsed)return;this.isUsed=!0,this.g.setTileAt(t,new m({pos:{...t},el:e(`0.7${s}`)[1],g:this.g,spawnDelay:0,animationName:"fade-animation"}));let i={...t};const n=function(e){switch(e){case"U":return{x:0,y:-1};case"R":return{x:1,y:0};case"D":return{x:0,y:1};case"L":return{x:-1,y:0};default:return{x:0,y:0}}}(s);for(;i={x:i.x+n.x,y:i.y+n.y},!(i.x<0||i.y<0||i.x>=this.g.w||i.y>=this.g.h);){const t=this.g.getTileAt(i);if(!t)break;t.obj&&t.obj instanceof c&&t.obj.removeElement(),this.g.setTileAt(i,new u({pos:{...i},el:e("0.5")[1],g:this.g,spawnDelay:0,animationName:"fade-animation"}))}this.removeElement()}}class v extends d{constructor(e){super(e),this.div.classList.add("entity-cat"),this.setBillboard(!0),this.canWalkOver=!1}moveCat(e){let t={x:this.pos.x,y:this.pos.y};t.x+=e.x,t.y+=e.y;const s=this.g.getTileAt(t);if(s.entity instanceof v){let s={x:t.x+e.x,y:t.y+e.y};const i=this.g.getTileAt(s);if(!i||!i.isWalkable)return}else if(!s||!s.isWalkable)return;this.moveTo(t)}actionWhenMoving(t,s){!t||!s||([{x:0,y:-1},{x:1,y:0},{x:0,y:1},{x:-1,y:0}].forEach(e=>{const s={x:t.x+e.x,y:t.y+e.y},i=this.g.getTileAt(s),n=1===e.x?"R":-1===e.x?"L":1===e.y?"D":"U";i.obj&&i.obj instanceof p&&i.obj.passingBy(s,n)}),this.g.getTileAt(t).obj)||this.g.setTileAt(t,new c({pos:t,el:e("0.1"+s)[1],g:this.g,spawnDelay:0,animationName:"fade-animation"}))}hasChangedPosition(e,t){!e||!t||this.g.setTileAt(e,this)}}class g extends l{constructor(e){super(e),this.div.classList.add("walkable","base-marble")}actionWhenMoving(){}hasChanegedPosition(){}}class y extends d{constructor(e){super(e),this.div.classList.add("entity-lady"),this.setBillboard(!0)}actionWhenMoving(){}hasChanegedPosition(){}}class f extends d{constructor(e){super(e),this.div.classList.add("entity-mouse"),this.setBillboard(!0)}actionWhenMoving(){}hasChanegedPosition(){}}class x extends h{constructor(e){super(e),this.div.classList.add("obj-ladyline")}}class b extends h{constructor(e){super(e),this.div.classList.add("obj-soap")}}class w extends h{constructor(e){super(e),this.div.classList.add("obj-yarn"),this.setBillboard(!0)}}function L(e,t){if(!e.el)return null;let s;switch(t){case l:s=a.get(e.el.type)||null;break;case h:s=r.get(e.el.type)||null;break;case d:s=o.get(e.el.type)||null}if(!s)return null;const i={Marble:g,Paint:c,Yarn:w,Soap:b,Bucket:p,EmptyBucket:m,Puddle:u,Ladyline:x,Cat:v,Mouse:f,Lady:y}[s];return i?new i(e):null}class E{game;p=[];bases=[];objects=[];entities=[];prevL=[];gEl;animate=!0;_extractedData=[];get objectsAll(){return[...this.bases,...this.objects,...this.entities]}get w(){return Math.max(...this.p.map(e=>e.length))}get h(){return this.p.length}constructor(e,t,s,i=!0,n=!0){this.game=s,this.gEl=t.appendChild(document.createElement("div")),this.gEl.classList.add("grid"),this.animate=n,this.setPattern(e,i)}getTileAt(e){const t=t=>t.find(t=>t.pos.x===e.x&&t.pos.y===e.y)??null,s=t(this.bases),i=t(this.objects),n=t(this.entities),a=!!(s||i||n),r=[s,i,n].filter(e=>null!==e),o=0===r.length||r.every(e=>e.canWalkOver);return{pos:e,base:s,obj:i,entity:n,tileArray:[s,i,n],isTile:a,isWalkable:a&&o}}setTileAt(e,t){const s=e=>{const s=e.findIndex(e=>e.id===t.id);-1!==s&&e.splice(s,1)};t instanceof l&&(s(this.bases),this.bases.push(t)),t instanceof h&&(s(this.objects),this.objects.push(t)),t instanceof d&&(s(this.entities),this.entities.push(t));const i=e.y*this.w+e.x;i>=0&&i<this._extractedData.length&&(this.p=this.getPattern())}getPattern(){let e=[];for(let s=0;s<this.h;s++){let i=[];for(let e=0;e<this.w;e++){const n=this.getTileAt({x:e,y:s});let a=[];n.base&&a.push(n.base.element),n.obj&&a.push(n.obj.element),n.entity&&a.push(n.entity.element),i.push(t(a))}e.push(i)}return e}setPattern(t,s=this.animate,i=!0){this.p=t,this.p.forEach(e=>{const t=Array(this.w-e.length).fill(0);e.push(...t)}),this._extractedData=[];for(let t=0;t<this.h;t++)for(let s=0;s<this.w;s++)this._extractedData.push(e(this.p[t][s]));i&&this.loadGrid(s)}savePattern(){this.game.currentLevel&&(this.game.currentLevel={...this.game.currentLevel,pattern:this.getPattern(),moveCount:this.game.moveCount},this.prevL.push(this.game.currentLevel))}_goBackToLevel(e){e&&(this.setPattern(e.pattern,!1),this.game.moveCount=e.moveCount,e.maxMoves&&e.maxMoves-e.moveCount>0&&(this.game.status="inLevel"),this.game._setMovesRemaning())}rewindLevel(){0!==this.prevL.length&&this._goBackToLevel(this.prevL.pop())}resetLevel(){0!==this.prevL.length&&(this._goBackToLevel(this.prevL[0]),this.prevL=[])}loadGrid(e){if(null===this.gEl)return;this.bases=[],this.objects=[],this.entities=[],this.gEl.innerHTML="",this.gEl.style.gridTemplate=`repeat(${this.h}, 1rem) / repeat(${this.w}, 1rem)`;let t=0;for(let s=0;s<this.h;s++)for(let i=0;i<this.w;i++){const n=this._extractedData[t];let a={base:null,obj:null,entity:null};const r=e?100*t+(e?500:0):0,o=e?"drop-animation":"no-animations";a.base=L({pos:{x:i,y:s},el:n[0],g:this,spawnDelay:r,animationName:o},l),a.obj=L({pos:{x:i,y:s},el:n[1],g:this,spawnDelay:r,animationName:o},h),a.entity=L({pos:{x:i,y:s},el:n[2],g:this,spawnDelay:r,animationName:o},d),a.base&&this.bases.push(a.base),a.obj&&this.objects.push(a.obj),a.entity&&this.entities.push(a.entity),t++}}keyEvent(e,t){this.savePattern(),"k"===e.key&&console.log(this.p);for(const e of this.entities)if(e instanceof v)switch(t){case"U":e.moveCat({x:0,y:-1});break;case"D":e.moveCat({x:0,y:1});break;case"L":e.moveCat({x:-1,y:0});break;case"R":e.moveCat({x:1,y:0})}this.allTilesPainted()&&this.game.changeStatus("levelComplete")}mouseEvent(e){const t="mousemove"===e.type?e.clientX/e.view.innerWidth-.5:0,s="mousemove"===e.type?e.clientY/e.view.innerHeight-.5:0;this.gEl.style.setProperty("--rotX",20*s+"deg"),this.gEl.style.setProperty("--rotZ",20*t+"deg")}clickEvent(e){"levelComplete"===this.game.status&&this.game.loadNextLevel()}allTilesPainted(){for(let e=0;e<this.h;e++)for(let t=0;t<this.w;t++){const s=this.getTileAt({x:t,y:e});if(s.isTile&&(s.isWalkable||1===s.entity?.element.type)&&!(s.obj instanceof c))return!1}return!0}dispose(){this.gEl?.remove()}}class k{creator="Unknown";name="Untitled";id="unknown";levelsData=[];constructor(e){this.name=e.name,this.id=e.id,this.creator=e.creator,e.levels.forEach((e,t)=>{this.levelsData.push(new T(e,t))})}}class T{index=0;name;description;pattern;maxMoves=null;moveCount=0;levelData=null;constructor(e,t){this.index=t,this.levelData=e,this.name=e.name,this.description=e.description||"",this.pattern=e.pattern,e.maxMoves&&(this.maxMoves=e.maxMoves)}}const M={creator:"nonoreo",name:"Main Levels",id:"main",levels:[{name:"Beginning 1",description:"There once was a cat who needed to walk on every tiles to paint them.",pattern:[["1.1R.1",1,1,1,1]]},{name:"Beginning 2",description:"He was able to walk up, down, left and right.",pattern:[[1,1,1,0,1],[1,0,1,0,1],["1.1R.1",0,1,1,1]]},{name:"Beginning 3",description:"A big cataclysm happened, removing color from the world.",pattern:[[0,1,1,0,1],["1.1R.1",1,1,1,1]]},{name:"Beginning 4",description:"That's why he decided to repaint everything by himself!",pattern:[[1,1,1,0,"1.1R.1"],[1,1,1,1,1],[1,0,1,1,0]]},{name:"Beginning 5",description:"Sometimes, he had a maximum number of moves.",maxMoves:13,pattern:[[0,0,0,0,1],["1.1R.1",1,1,1,1],[0,0,1,1,1],[0,1,1,1,1]]},{name:"Beginning 6",description:"The path is often straightforward.",maxMoves:17,pattern:[[1,1,1,0,1],["1.1R.1",0,1,1,1],[1,1,1,0,1],[0,1,1,1,1]]},{name:"Beginning 7",description:"Buckets will wash already painted tiles.",pattern:[["1.1R.1",1,0,1.4,1],[1,1,0,0,1],[1,1,1,1,1]]},{name:"Beginning 8",maxMoves:11,pattern:[[1,1,1,1,1.1],[1,1,1,1.4,1.1],[1,1,"1.1R.1",0,1.1]]},{name:"Beginning 9",pattern:[["1.1R.1",1,1,1,1.1],[1,1.4,1,1.4,1.1],[1,1.4,0,0,1.1],[1,1.4,0,0,1.1]]},{name:"Beginning 10",maxMoves:21,pattern:[["1.1R.1",1,1.4,1,1.1],[1,1,1,1,1.1],[1.4,1,1,1,1.4],[1,1,1.4,1,1.1],[1.1,1,1,1,1.1]]},{name:"Beginning 11",maxMoves:11,pattern:[[1,1,"1.1R.1",1,1],[1,1.4,1.1,1.4,1],[1,1.1,1.1,1.1,1]]},{name:"TEST",description:"TEST",pattern:[["1.1R.1","1.1R.1",1,1,1.3],[0,1,1.4,0,1,1],[0,1,0,1,1.2]]},{name:"TEST",description:"TEST",pattern:[["1.1R.1",1,1,1,1,1,1],[1,1,1,1,1,1,1],[1,1,"1.4",1,1,1,1],[1,1,1,1,1,1,1]]},{name:"TEST",description:"TEST",pattern:[["1.1R.1",1,1,0,1,1,1],[1,0,1,0,1,0,1],[1,1,1,0,"1.1R.1",1,1]]}]},P=new class{status="init";el;grid=null;levels=[];currentLevel=null;currentLevelIndex=0;currentLevelsID="main";moveCount=0;maxMoves=null;levelEl=document.querySelector(".level");uiEl=document.querySelector(".ui");constructor(e=document.getElementById("game")){if(!e)throw new Error("Game element not found");this.el=e,this.uiEl.querySelector(".follow-mouse").setAttribute("hidden",""),this.initGame()}initGame(){this.grid=new E([],this.levelEl,this,!1,!0),this.loadLevels(M);let e={U:["w","z","ArrowUp"],D:["s","ArrowDown"],L:["a","q","ArrowLeft"],R:["d","ArrowRight"]};window.addEventListener("keydown",t=>{let s=null;Object.entries(e).forEach(([e,i])=>{i.includes(t.key)&&(s=e)}),null!==s&&"inLevel"===this.status&&this.grid.keyEvent(t,s)}),window.addEventListener("mousemove",e=>{this.grid.mouseEvent(e),this._putDivToMouse(e)}),window.addEventListener("mouseout",e=>{this.grid.mouseEvent(e)}),window.addEventListener("click",e=>{this.grid.clickEvent(e)}),this.uiEl.querySelector(".undo").onclick=()=>{this.grid?.rewindLevel()},this.uiEl.querySelector(".home").onclick=()=>{this.changeStatus("levelSelection")},this.uiEl.querySelector(".reset").onclick=()=>{this.grid?.resetLevel()}}loadLevels(e){this.levels.push(new k(e))}loadLevel(e,t){this.moveCount=0;const s=this.levels.find(t=>t.id===e)?.levelsData[t];s?(this.currentLevel={...s,moveCount:0},this.currentLevelIndex=t,this.currentLevelsID=e,this.maxMoves=s.maxMoves??null,this.grid?.setPattern(s.pattern,!0),this.uiEl.querySelector(".level-name").textContent=s.name,this.uiEl.querySelector(".level-description").textContent=s.description,this.uiEl.querySelector(".moves-remaning-div").hidden=!this.maxMoves,this._setMovesRemaning(),this.changeStatus("inLevel")):console.error("Level not found")}loadNextLevel(){this.currentLevelIndex++,this.loadLevel(this.currentLevelsID,this.currentLevelIndex),this.changeStatus("inLevel"),this.grid.prevL=[]}changeStatus(e){switch(this.status=e,this.uiEl.querySelector(".follow-mouse").setAttribute("hidden",""),e){case"init":case"intro":case"levelSelection":break;case"inLevel":this.uiEl.setAttribute("visible","true");break;case"levelComplete":this.uiEl.setAttribute("visible","false"),this.uiEl.querySelector(".follow-mouse").removeAttribute("hidden"),s(v,this.grid.entities,e=>e.setAnimation("joy-animation"));break;case"levelFailed":s(v,this.grid.entities,e=>e.setAnimation("sad-animation"))}}_putDivToMouse(e){const t=this.uiEl.querySelector(".follow-mouse");t.style.left=e.clientX+"px",t.style.top=e.clientY+"px"}_setMovesRemaning(){this.uiEl.querySelector(".moves-remaning").textContent=this.maxMoves?String(this.maxMoves-this.moveCount):"∞"}};setTimeout(()=>{P.loadLevel("main",10)},1e3)</script>