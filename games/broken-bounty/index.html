<!doctype html><title>Broken Bounty</title><style>*,:after,:before{box-sizing:border-box}body,html{width:100%;height:100%;margin:0;border:0;padding:0}.app-canvas,.app-container{position:absolute;width:100%;height:100%;margin:0;border:0;padding:0}body{color:#fff;overflow:hidden}a{color:inherit;text-decoration:inherit;transition-property:opacity;transition-duration:.2s;transition-timing-function:ease}a:hover{opacity:.7;text-decoration:underline}button{border:.5vmin solid #fff;padding:.8vmin;font-size:4vh;font-family:sans-serif;color:inherit;background-color:rgba(0,0,0,.1)}.menu{position:absolute;visibility:hidden}.game-title,.menu-title{width:100vw;margin:5vh 0;border:0;padding:0;text-align:center;font-size:10vh;font-family:sans-serif}.button-nav{width:100vw;display:flex;flex-direction:row;justify-content:center}.button-nav>:nth-child(2){margin:0 0 0 2vmin}.info,.options{font-family:monospace}.options{width:100vw;margin:0;border:0;padding:0;display:flex;flex-direction:column;align-items:center;font-size:5vmin;list-style:none}.options>li,.options>li>div{display:flex;flex-direction:row;justify-content:space-between}.options>li>div{align-items:center}.option-label:after{content:":"}.labeled-bar{margin:0 0 0 4vmin}.info{width:100vw;text-align:center;font-size:3vmin}.author{margin:5vh 0 0}.version{margin:0 0 5vh}p{margin:2vh 0;text-align:center;font-size:3.5vh;font-family:sans-serif}.options-return{font-size:3vh}.level-stats{margin:0 0 0 50%;padding:0;transform:translate(-50%);display:flex;flex-direction:column;align-items:center;font-size:3.5vh;font-family:sans-serif;list-style:none}.level-stat{display:flex;flex-direction:row;justify-content:center}.level-stat>:first-child:after{content:":\00a0"}.money{margin:0 0 1vh}.level-balance{margin:3vh 0;font-size:3.5vh}.end-info,.level-balance{display:flex;flex-direction:row;justify-content:center;font-family:sans-serif}.end-info{width:100vw;margin:0 0 5vh;font-size:5vmin}</style><div class=app-container><div class="menu main-menu js-main-menu"><h1 class=game-title>Broken Bounty</h1><nav class=button-nav><button class="main-start js-main-start">←Start</button> <button class="main-options js-main-options">Options→</button></nav></div><div class="menu prepare-menu js-prepare-menu"><p>Robots have glitched and become aggressive to humans.<p>As a bounty hunter, you must go city by city, eliminating the dangerous robots.<p>Use W, A, S, D to move.<p>Turn with left and right arrow keys.<p>Fire with space bar.<nav class=button-nav><button class="prepare-start js-prepare-start">↓Ready↓</button></nav></div><canvas class="app-canvas js-app-canvas">Your browser does not support canvas.</canvas></div><div class="menu level-menu js-level-menu"><h1 class=menu-title>City cleared</h1><ul class=level-stats><li class=level-stat><div>Robots eliminated</div><div class=js-robots-killed></div><li class="money js-robots-killed-money"><li class=level-stat><div>Shots fired</div><div class=js-shots-fired></div><li class="money js-shots-fired-money"><li class=level-stat><div>Building damage</div><div class=js-building-damage></div><li class="money js-building-damage-money"><li class=level-stat><div>Injuries</div><div class=js-injuries></div><li class="money js-injuries-money"></ul><div class=level-balance><div>Current Balance: </div><div class=js-current-balance></div></div><nav class=button-nav><button class="next-level js-next-level">↓Next level↓</button></nav></div><div class="menu end-menu js-end-menu"><h1 class=menu-title>It's all over!</h1><div class=end-info><div>Final balance: </div><div class=js-final-balance></div></div><nav class=button-nav><button class="end-again js-end-again">←Play again</button> <button class="end-main js-end-main">Main menu→</button></nav></div><div class="menu options-menu js-options-menu"><h1 class=menu-title>Options</h1><ul class=options><li><div class=option-label>   Max turn speed</div><div class=labeled-bar><div>Slower</div><input type=range value=0.019 min=0.001 max=0.200 step=0.001 class="turn-speed js-turn-speed"><div> Faster</div></div><li><div class=option-label>Turn acceleration</div><div class=labeled-bar><div>Slower</div><input type=range value=0.040 min=0.001 max=1.000 step=0.001 class="turn-accel js-turn-accel"><div>Instant</div></div></ul><div class="info author">Author: <a href=https://github.com/Costava target=_blank>Costava</a></div><div class="info version">Version: 1.0.0</div><nav class=button-nav><button class="options-return js-options-return">↓Return↓</button></nav></div><script>!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(){var t=document.querySelector(".js-app-canvas");t.getContext("2d"),t.width=t.offsetWidth,t.height=t.offsetHeight,y.flattener.setAspectRatio(y.canvas.width/y.canvas.height),y.draw()}var o=(s(i(17)),i(9)),r=s(o),a=s(i(23)),h=(s(i(8)),i(4)),l=(s(h),i(15)),u=s(l),d=s(i(16)),c=s(i(18));console.log("Welcome");var p=document.querySelector(".js-app-canvas"),f=p.getContext("2d"),m=new d.default(window);m.start();var y=new u.default({canvas:p,ctx:f,keyboard:m});y.dieCallback=function(){g.end.start()},y.levelEndCallback=function(){g.level.start()};var g={};g.main=new c.default({name:"main",element:document.querySelector(".js-main-menu"),listenerSystems:[new r.default(document.querySelector(".js-main-start"),"click",(function(){y.dualLooper.stopCallback=function(){g.prepare.start()},g.main.stop()})),new r.default(document.querySelector(".js-main-options"),"click",(function(){g.main.stopListenerSystems(),g.main.hide(),g.options.start()})),new r.default(document,"keydown",(function(t){var e=d.default.getKeyID(t);37==e?document.querySelector(".js-main-start").click():39==e&&document.querySelector(".js-main-options").click()}))],startWork:function(){y.prepMainMenu(),y.start()},stopWork:function(){y.stop()}}),g.prepare=new c.default({name:"prepare",element:document.querySelector(".js-prepare-menu"),listenerSystems:[new r.default(document.querySelector(".js-prepare-start"),"click",(function(){y.dualLooper.stopCallback=function(){y.prepLevel(1),y.start()},g.prepare.stop()})),new r.default(document,"keydown",(function(t){40==d.default.getKeyID(t)&&document.querySelector(".js-prepare-start").click()}))],startWork:function(){y.prepPrepareMenu(),y.start()},stopWork:function(){y.stop()}}),g.level=new c.default({name:"level",element:document.querySelector(".js-level-menu"),listenerSystems:[new r.default(document.querySelector(".js-next-level"),"click",(function(){y.prepLevel(y.level+1),g.level.stop()})),new r.default(document,"keydown",(function(t){40==d.default.getKeyID(t)&&document.querySelector(".js-next-level").click()}))],startWork:function(){},stopWork:function(){y.start()}}),g.end=new c.default({name:"end",element:document.querySelector(".js-end-menu"),listenerSystems:[new r.default(document.querySelector(".js-end-again"),"click",(function(){y.prepLevel(1),g.end.stop(),y.start()})),new r.default(document.querySelector(".js-end-main"),"click",(function(){g.end.stop(),g.main.start()})),new r.default(document,"keydown",(function(t){var e=d.default.getKeyID(t);37==e?document.querySelector(".js-end-again").click():39==e&&document.querySelector(".js-end-main").click()}))],startWork:function(){},stopWork:function(){}}),g.options=new c.default({name:"options",element:document.querySelector(".js-options-menu"),listenerSystems:[new r.default(document.querySelector(".js-options-return"),"click",(function(){g.options.stop()})),new r.default(document.querySelector(".js-turn-speed"),"change",(function(){var t=Number(this.value);y.playerTurnSpeed=t,console.log("Turn speed:",y.playerTurnSpeed)})),new r.default(document.querySelector(".js-turn-accel"),"change",(function(){var t=Number(this.value);y.playerTurnRateAccel=t,console.log("Turn acceleration:",y.playerTurnRateAccel)})),new r.default(document,"keydown",(function(t){40==d.default.getKeyID(t)&&document.querySelector(".js-options-return").click()}))],startWork:function(){},stopWork:function(){g.main.show(),g.main.startListenerSystems()}}),g.main.start();var v=new a.default(n,40);new r.default(window,"resize",v.set.bind(v)).start(),n()},function(t,e,i){"use strict";function s(t,e){this.x=t,this.y=e}Object.defineProperty(e,"__esModule",{value:!0}),function(t){t&&t.__esModule}(i(6)),s.zero=function(){return new s(0,0)},s.fromAngle=function(t){return new s(Math.cos(t),Math.sin(t))},s.average=function(t){for(var e=0,i=0,n=t.length,o=0;o<n;++o)e+=t[o].x,i+=t[o].y;return new s(e/n,i/n)},s.prototype.clone=function(){return new s(this.x,this.y)},s.prototype.setMagnitude=function(t){var e=this.magnitude();return this.x*=t/e,this.y*=t/e,this},s.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},s.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},s.prototype.scale=function(t){return this.x*=t,this.y*=t,this},s.prototype.rotate=function(t,e){var i=this.clone().subtract(t),n=i.magnitude(),o=i.angle()+e,r=s.fromAngle(o).setMagnitude(n);return this.x=t.x+r.x,this.y=t.y+r.y,this},s.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},s.prototype.angle=function(){return Math.atan2(this.y,this.x)},s.prototype.angleTo=function(t){return t.clone().subtract(this).angle()},s.prototype.distance=function(t){return this.clone().subtract(t).magnitude()},s.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},s.prototype.lessThan=function(t){return this.x<t.x&&this.y<t.y},s.prototype.lessThanOrEqualTo=function(t){return this.x<=t.x&&this.y<=t.y},s.prototype.greaterThan=function(t){return this.x>t.x&&this.y>t.y},s.prototype.greaterThanOrEqualTo=function(t){return this.x>=t.x&&this.y>=t.y},s.prototype.inside=function(t){var e=this.clone().subtract(t.pos);return e.lessThan(t.dim)&&e.greaterThan(s.zero())},s.prototype.on=function(t){var e=this.clone().subtract(t.pos);return e.lessThanOrEqualTo(t.dim)&&e.greaterThanOrEqualTo(s.zero())},e.default=s},function(t,e,i){"use strict";function s(t,e,i){this.x=t,this.y=e,this.z=i}Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(i(1));s.zero=function(){return new s(0,0,0)},s.average=function(t){for(var e=0,i=0,n=0,o=t.length,r=0;r<o;++r)e+=t[r].x,i+=t[r].y,n+=t[r].z;return new s(e/o,i/o,n/o)},s.prototype.clone=function(){return new s(this.x,this.y,this.z)},s.prototype.clone2=function(){return new n.default(this.x,this.y)},s.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},s.prototype.add2=function(t){return this.x+=t.x,this.y+=t.y,this},s.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},s.prototype.subtract2=function(t){return this.x-=t.x,this.y-=t.y,this},s.prototype.rotateZ=function(t,e){var i=this.clone().subtract2(t),s=i.magnitude2(),n=i.angle2()+e;return this.x=s*Math.cos(n),this.y=s*Math.sin(n),this},s.prototype.distance=function(t){return this.clone().subtract(t).magnitude()},s.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))},s.prototype.magnitude2=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},s.prototype.subtract2=function(t){return this.x-=t.x,this.y-=t.y,this},s.prototype.magnitude2=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},s.prototype.distance2=function(t){return this.clone().subtract2(t).magnitude2()},s.prototype.angle2=function(){return Math.atan2(this.y,this.x)},s.prototype.angleTo2=function(t){return t.clone().subtract2(this).angle2()},e.default=s},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t){this.end=t.end,this.topZ=t.topZ,this.botZ=t.botZ,this.netAdjustments=0,this.generatePoints(),this.generateFaces()}Object.defineProperty(e,"__esModule",{value:!0});var o=s(i(2)),r=s(i(5));n.prototype.generatePoints=function(){this.points=[],this.points.push(new o.default(this.end.pos.x,this.end.pos.y,this.topZ),new o.default(this.end.pos.x+this.end.dim.x,this.end.pos.y,this.topZ),new o.default(this.end.pos.x+this.end.dim.x,this.end.pos.y+this.end.dim.y,this.topZ),new o.default(this.end.pos.x,this.end.pos.y+this.end.dim.y,this.topZ));for(var t=0;t<4;++t){var e=this.points[t];this.points.push(new o.default(e.x,e.y,this.botZ))}},n.prototype.generateFaces=function(){this.faces={top:new r.default([this.points[0],this.points[1],this.points[2],this.points[3]]),bot:new r.default([this.points[4],this.points[5],this.points[6],this.points[7]]),north:new r.default([this.points[2],this.points[3],this.points[7],this.points[6]]),east:new r.default([this.points[1],this.points[2],this.points[6],this.points[5]]),south:new r.default([this.points[0],this.points[1],this.points[5],this.points[4]]),west:new r.default([this.points[3],this.points[0],this.points[4],this.points[7]])}},n.facePointIndexes={top:[0,1,2,3],bot:[4,5,6,7],north:[2,3,7,6],east:[1,2,6,5],south:[0,1,5,4],west:[3,0,4,7]},n.prototype.getFacePoints=function(t){for(var e=[],i=0;i<4;++i){var s=n.facePointIndexes[t][i];e.push(this.points[s])}return e},n.prototype.updateFacePoints=function(){for(var t in this.faces)this.faces[t].points=this.getFacePoints(t),this.faces[t].update()},n.prototype.adjustDimensions=function(t){this.netAdjustments+=t;var e=t/2;this.topZ+=e,this.botZ-=e,this.end.pos.x-=e,this.end.pos.y-=e,this.end.dim.x+=t,this.end.dim.y+=t},n.prototype.update=function(){this.generatePoints(),this.updateFacePoints()},e.default=n},function(t,e){"use strict";function i(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}Object.defineProperty(e,"__esModule",{value:!0}),i.randomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},i.random=function(t){return new i(i.randomInt(0,255),i.randomInt(0,255),i.randomInt(0,255),t||1)},i.prototype.toString=function(t){return t||!0?"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")":"rgb("+this.r+", "+this.g+", "+this.b+")"},i.prototype.invert=function(t){this.r=255-this.r,this.g=255-this.g,this.b=255-this.b,(t||!1)&&(this.a=1-this.a)},i.prototype.inverse=function(t){var e=t||!1;return new i(255-this.r,255-this.g,255-this.b,e?1-this.a:this.a)},i.prototype.clamp=function(){this.r=Math.max(Math.min(this.r,255),0),this.g=Math.max(Math.min(this.g,255),0),this.b=Math.max(Math.min(this.b,255),0),this.a=Math.max(Math.min(this.a,1),0)},i.prototype.scale=function(t,e){(e||!1)&&(this.a*=t),this.r*=t,this.g*=t,this.b*=t},i.prototype.round=function(){this.r=Math.round(this.r),this.g=Math.round(this.g),this.b=Math.round(this.b)},i.prototype.clone=function(){return new i(this.r,this.g,this.b,this.a)},e.default=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t,e){this.points=t,this.color=e||r.default.random(1),this.update()}Object.defineProperty(e,"__esModule",{value:!0});var o=s(i(2)),r=s(i(4));n.prototype.update=function(){this.avgPoint=o.default.average(this.points)},e.default=n},function(t,e,i){"use strict";function s(t,e){this.pos=t,this.dim=e}Object.defineProperty(e,"__esModule",{value:!0}),function(t){t&&t.__esModule}(i(1)),s.prototype.getOpposite=function(){return this.pos.clone().add(this.dim)},s.prototype.doesNotOverlap=function(t){var e=this.getOpposite(),i=t.getOpposite();return t.pos.x>e.x||i.x<this.pos.x||t.pos.y>e.y||i.y<this.pos.y},s.prototype.overlaps=function(t){return!this.doesNotOverlap(t)},e.default=s},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t){o.default.call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var o=s(i(3)),r=s(i(5));s(i(13)),n.prototype=Object.create(o.default.prototype),n.prototype.generateFaces=function(){this.faces={east:new r.default([this.points[1],this.points[2],this.points[6],this.points[5]]),west:new r.default([this.points[3],this.points[0],this.points[4],this.points[7]]),south:new r.default([this.points[0],this.points[1],this.points[5],this.points[4]]),top:new r.default([this.points[0],this.points[1],this.points[2],this.points[3]])}},e.default=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t){this.nearDistance=new o.default(0,t.nearDistanceY||n.default.nearDistanceY),this.farDistance=new o.default(0,t.farDistanceY||n.default.farDistanceY),this.viewDistance=t.viewDistance||n.default.viewDistance;var e=t.aspectRatio||n.default.aspectRatio;this.setAspectRatio(e)}Object.defineProperty(e,"__esModule",{value:!0});var o=s(i(1));s(i(2)),n.default={nearDistanceY:.1,farDistanceY:40,viewDistance:100,fadeStartProp:.9,aspectRatio:16/9},n.prototype.setAspectRatio=function(t){this.aspectRatio=t||n.default.aspectRatio,this.nearDistance.x=this.nearDistance.y*this.aspectRatio,this.farDistance.x=this.farDistance.y*this.aspectRatio,this.distanceDiff=new o.default(this.farDistance.x-this.nearDistance.x,this.farDistance.y-this.nearDistance.y)},n.prototype.get2D=function(t,e,i){var s=i.distance2(t),n=t.angleTo2(i),r=Math.abs(n-e),a=(Math.PI,s*Math.cos(r)),h=s*Math.sin(r),l={};a>=0?(l.x=a/this.viewDistance*this.distanceDiff.x+this.nearDistance.x,l.y=a/this.viewDistance*this.distanceDiff.y+this.nearDistance.y):(l.x=-a/this.viewDistance*this.distanceDiff.x+this.nearDistance.x,l.y=-a/this.viewDistance*this.distanceDiff.y+this.nearDistance.y);var u,d=Math.abs(h/l.x),c=new o.default(Math.cos(e),Math.sin(e)),p=new o.default(Math.cos(n),Math.sin(n)),f=c.x*p.y-c.y*p.x;f>0?(u=.5-.5*d,a<0&&(u-=.5)):f<0?(u=.5+.5*d,a<0&&(u+=.5)):u=.5;var m=t.z-i.z,y=m/l.y*.5+.5;return a<0&&(m>0?y+=.5:y-=.5),new o.default(u,y)},n.allPointsBehind=function(t,e,i){return i.every((function(i){return n.pointBehind(t,e,i)}))},n.pointBehind=function(t,e,i){var s=Math.abs(e-t.angleTo2(i))%(2*Math.PI);return s>Math.PI&&(s=2*Math.PI-s),s>Math.PI/2},n.prototype.getPoints2D=function(t,e,i){for(var s=[],n=i.length,o=0;o<n;++o){var r=this.get2D(t,e,i[o]);null!=r&&s.push(r)}return s},n.prototype.fillShape=function(t,e,i,s){if(i.length>2){e.save(),e.scale(t.width,t.height),e.beginPath(),e.moveTo(i[0].x,i[0].y);for(var n=i.length,o=1;o<n;++o)e.lineTo(i[o].x,i[o].y);e.closePath(),e.fillStyle=s,e.fill(),e.restore()}},e.default=n},function(t,e){"use strict";function i(t,e,i){this.target=t,this.eventType=e,this.work=i,this.active=!1}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.start=function(){this.active||(this.target.addEventListener(this.eventType,this.work),this.active=!0)},i.prototype.stop=function(){this.active&&(this.target.removeEventListener(this.eventType,this.work),this.active=!1)},e.default=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t){o.default.call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var o=s(i(3)),r=s(i(5));n.prototype=Object.create(o.default.prototype),n.prototype.generateFaces=function(){this.faces={top:new r.default([this.points[0],this.points[1],this.points[2],this.points[3]]),north:new r.default([this.points[2],this.points[3],this.points[7],this.points[6]]),east:new r.default([this.points[1],this.points[2],this.points[6],this.points[5]]),south:new r.default([this.points[0],this.points[1],this.points[5],this.points[4]]),west:new r.default([this.points[3],this.points[0],this.points[4],this.points[7]])}},e.default=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=s(i(1)),o=s(i(3));e.default=function(t){this.cuboid=new o.default(t),this.velocity=t.velocity||n.default.zero()}},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i){return Math.max(Math.min(t,i),e)}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=s(i(2)),o=s(i(4));e.default=function(t){this.points=t.points,this.dir=t.dir,this.avgPoint=n.default.average(this.points),this.color=t.color||o.default.random(1)}},function(t,e){"use strict";function i(t){this.regWork=t.regWork,this.finalWork=t.finalWork,this.stopCallback=t.stopCallback||function(){},this.interval=t.interval||i.default.interval,this.maxNumIntervals=t.maxNumIntervals||i.default.maxNumIntervals,this.time=0,this.totalTime=0,this.looping=!1,this.stopped=!0,this.loopCallBound=this.loopCall.bind(this)}Object.defineProperty(e,"__esModule",{value:!0}),i.default={interval:8,maxNumIntervals:4},i.prototype.accumulate=function(t){this.time+=t,this.totalTime+=t},i.prototype.loopCall=function(){this.newTime=(new Date).getTime(),this.dt=this.newTime-this.oldTime,this.accumulate(this.dt);var t,e=Math.floor(this.time/this.interval),i=Math.min(e,this.maxNumIntervals);for(t=0;t<i;++t){if(!this.regWork()){t+=1;break}}t>0&&(this.time-=t*this.interval,this.finalWork()),this.oldTime=this.newTime,this.looping?window.requestAnimationFrame(this.loopCallBound):(this.stopped=!0,this.stopCallback())},i.prototype.start=function(){this.stopped&&(this.oldTime=(new Date).getTime(),this.looping=!0,this.stopped=!1,this.loopCallBound())},i.prototype.stop=function(){this.looping=!1},i.prototype.clearTime=function(){this.time=0},i.prototype.resetTime=function(){this.time=0,this.totalTime=0},e.default=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t){this.canvas=t.canvas,this.ctx=t.ctx,this.keyboard=t.keyboard,this.keyBinds={moveForward:87,moveBackward:83,strafeRight:68,strafeLeft:65,turnRight:39,turnLeft:37,shoot:32},this.newSRNG(),this.flattener=new o.default({aspectRatio:this.canvas.width/this.canvas.height}),this.work=this.mainMenuWork,this.draw=this.mainMenuDraw,this.dualLooper=new r.default({regWork:this.work.bind(this),finalWork:this.draw.bind(this)}),this.shootInterval=350,this.lastShootTime=0-this.shootInterval,this.headLevel=1.8,this.playerMoveSpeed=.4,this.playerTurnSpeed=.019,this.playerTurnRate=0,this.playerTurnRateAccel=.04,this.barrelLength=1,this.barrelEndLength=.15,this.totalBarrelLength=this.barrelLength+this.barrelEndLength,this.barrel=new d.default({end:new l.default(new a.default(-.1,0),new a.default(.2,this.barrelLength)),topZ:1.5,botZ:1.3}),this.barrelEnd=new d.default({end:new l.default(new a.default(-.12,this.barrelLength),new a.default(.24,this.barrelEndLength)),topZ:1.52,botZ:1.28}),this.barrelCameraShootY=.3,this.barrelCameraRestY=.01,this.barrelCameraPos=new h.default(0,this.barrelCameraRestY,this.headLevel),this.barrelCameraDir=Math.PI/2,this.bulletSideLength=.16,this.bulletHalfSideLength=this.bulletSideLength/2,this.bulletTopZ=1.48,this.bulletBotZ=1.32,this.bulletDim=new a.default(this.bulletSideLength,this.bulletSideLength),this.bulletSpeed=2,this.bulletRemoveDistance=200,this.bulletSmokeIncrease=.1,this.maxBulletSmokeAdjustment=3,this.rammerDim=new a.default(2.1,2.1),this.rammerTopZ=1.5,this.rammerBotZ=0,this.rammerOffsetMin=0,this.rammerOffsetMax=.5,this.rammerOffsetIncreasing=!0,this.rammerOffsetSpeed=.02,this.rammerMoveSpeed=.34,this.edgeBuildingDim=new a.default(10,10),this.edgeBuildingBotZ=0,this.edgeBuildingTopZ=20,this.bullets=[],this.bulletSmokes=[],this.rammers=[],this.dyingRammers=[],this.rammerShrinkSpeed=.055,this.nearClippingDistance=2,this.numInjuriesToDie=3,this.dieCallback=function(){console.log("Die")},this.levelEndCallback=function(){console.log("Level end")}}Object.defineProperty(e,"__esModule",{value:!0});var o=s(i(8)),r=s(i(14)),a=s(i(1)),h=s(i(2)),l=s(i(6)),u=(s(i(3)),i(7)),d=s(u),c=s(i(10)),p=s(i(19)),f=s(i(4)),m=s(i(22)),y=s(i(11)),g=s(i(20)),v=s(i(21)),b=s(i(12));n.prototype.newSRNG=function(){var t=Math.floor((new Date).getTime()*Math.random());this.srng=new m.default(t)},n.getSurroundingPoints=function(t,e){for(var i=t.dim.x/(e+1),s=t.dim.y/(e+1),n=[],o=t.pos,r=1;r<e+1;++r)n.push(o.clone().add(new a.default(r*i,0)));for(r=1;r<e+1;++r)n.push(o.clone().add(new a.default(0,r*s)));(o=t.pos.clone()).y+=t.dim.y;for(r=1;r<e+1;++r)n.push(o.clone().add(new a.default(r*i,0)));(o=t.pos.clone()).x+=t.dim.x;for(r=1;r<e+1;++r)n.push(o.clone().add(new a.default(0,r*s)));return n},n.prototype.damagePlayer=function(){this.levelStats.numInjuries+=1,this.overlay.a=.7,this.levelStats.numInjuries>=this.numInjuriesToDie&&this.killPlayer()},n.prototype.killPlayer=function(){this.playerDead||(this.playerDead=!0,this.dualLooper.stopCallback=function(){this.dyingRammers.forEach(function(t){t.cuboid.end.pos.distance(this.player.pos)<2.5&&this.dyingRammers.splice(this.dyingRammers.indexOf(t),1)}.bind(this)),this.scrollTexts=[],document.querySelector(".js-final-balance").innerHTML=n.getMoneyString(this.score),this.draw(),this.dieCallback()}.bind(this),this.stop())},n.prototype.resetHurtOverlay=function(){this.overlay=new f.default(250,20,22,0)},n.prototype.resetLevelEndOverlay=function(){this.overlay=new f.default(50,50,50,0)},n.prototype.prepLevel=function(t){this.level=t,this.levelEnding=!1,1==this.level&&(this.score=0),this.resetHurtOverlay(),this.levelStats={rammersKilled:0,shotsFired:0,buildingHits:0,numInjuries:0},this.playerDead=!1,this.newSRNG(),this.lastShootTime=0-this.shootInterval,this.player=new p.default({pos:new h.default(-19,-19,this.headLevel),dir:Math.PI/4}),this.lastPlayerVelocity=a.default.zero(),this.playerTurnRate=0;var e=this.srng.randomInt(55,255),i=this.srng.randomInt(55,255),s=this.srng.randomInt(55,255),o=new f.default(e,i,s,1),r=o.clone(),u=o.clone();r.scale(.6,!1),r.round(),u.scale(.8,!1),u.round(),this.barrelEnd.faces.top.color=o,this.barrelEnd.faces.south.color=r,this.barrel.faces.top.color=u,this.bullets=[],this.bulletSmokes=[],this.rammers=[],this.dyingRammers=[],this.edgeBuildings=[],this.walls=[],this.scrollTexts=[];var d=3+2*this.level;d>9&&(d=9),this.buildingSpreadMin=37,this.buildingSpreadMax=39,this.borderRect=new l.default(new a.default(-30,-30),new a.default((d-1)*this.buildingSpreadMax+60,(d-1)*this.buildingSpreadMax+60)),this.areaRect=new l.default(this.borderRect.pos.clone().add(this.edgeBuildingDim),this.borderRect.dim.clone().subtract(this.edgeBuildingDim)),this.surroundingPoints=n.getSurroundingPoints(this.borderRect,8),this.surroundingPoints.forEach(function(t){var e=new c.default({end:new l.default(t.clone(),this.edgeBuildingDim.clone()),topZ:this.edgeBuildingTopZ,botZ:this.edgeBuildingBotZ});this.edgeBuildings.push(e)}.bind(this));for(var m=0;m<d;++m)for(var y=0;y<d;++y)this.walls.push(new c.default({end:new l.default(new a.default(m*this.srng.randomInt(this.buildingSpreadMin,this.buildingSpreadMax),y*this.srng.randomInt(this.buildingSpreadMin,this.buildingSpreadMax)),new a.default(this.srng.randomInt(10,12),this.srng.randomInt(10,12))),topZ:this.srng.randomInt(2,20),botZ:0}));var g=4+2*this.level;g>35&&(g=35);for(var v=0;v<g;++v){m=this.srng.randomInt(0*this.buildingSpreadMax,d*this.buildingSpreadMax),y=this.srng.randomInt(0*this.buildingSpreadMax,d*this.buildingSpreadMax);for(var b=new a.default(m,y),w=!0;w;)w=this.walls.some((function(t){return b.on(t.end)})),w&&(b.y+=1);this.addRammer(b)}this.work=this.gameWork,this.draw=this.gameDraw,this.dualLooper.regWork=this.work.bind(this),this.dualLooper.finalWork=this.draw.bind(this),console.log("Generated city",this.level)},n.prototype.notifyRemainingRobots=function(){if(this.scrollTexts.length>0){var t=this.scrollTexts[this.scrollTexts.length-1];t.progress*(t.textMetrics.width+t.canvas.width)/t.textMetrics.width<1.2&&this.scrollTexts.pop()}var e;e=1==this.rammers.length?"":"s",this.scrollTexts.push(new v.default({text:this.rammers.length+" robot"+e+" remaining",canvas:this.canvas,ctx:this.ctx}))},n.prototype.start=function(){this.dualLooper.resetTime(),this.dualLooper.start()},n.prototype.stop=function(){this.dualLooper.stop()},n.prototype.resume=function(){this.dualLooper.start()},n.prototype.pause=function(){this.dualLooper.stop()},n.prototype.prepMainMenu=function(){this.newSRNG(),this.player=new p.default({pos:new h.default(0,-5,this.headLevel),dir:Math.PI/2}),this.mainMenuBuildings=[];for(var t=0;t<7;++t)for(var e=0;e<7;++e)this.mainMenuBuildings.push(new c.default({end:new l.default(new a.default(t*this.srng.randomInt(32,34),e*this.srng.randomInt(32,34)),new a.default(this.srng.randomInt(10,12),this.srng.randomInt(10,12))),topZ:this.srng.randomInt(1,24),botZ:0}));this.mainMenuBuildingPoints=[];for(var i=this.mainMenuBuildings.length,s=0;s<i;++s)for(var n=this.mainMenuBuildings[s].points.length,o=0;o<n;++o)this.mainMenuBuildingPoints.push(this.mainMenuBuildings[s].points[o]);this.mainMenuAvgPoint=h.default.average(this.mainMenuBuildingPoints),this.mainMenuAvgDist=0,this.mainMenuAvgHeight=0;var r=this.mainMenuBuildingPoints.length;for(s=0;s<r;++s){var u=this.mainMenuBuildingPoints[s];this.mainMenuAvgDist+=this.mainMenuAvgPoint.distance2(u),this.mainMenuAvgHeight+=u.z}this.mainMenuAvgDist/=r,this.mainMenuAvgHeight/=r,this.player.pos.z=6*this.mainMenuAvgHeight,this.mainMenuCameraDist=2*this.mainMenuAvgDist,this.mainMenuAngle=0,this.work=this.mainMenuWork,this.draw=this.mainMenuDraw,this.dualLooper.regWork=this.work.bind(this),this.dualLooper.finalWork=this.draw.bind(this)},n.prototype.prepPrepareMenu=function(){this.work=this.prepareMenuWork,this.draw=this.mainMenuDraw,this.dualLooper.regWork=this.work.bind(this),this.dualLooper.finalWork=this.draw.bind(this)},n.prototype.prepareMenuWork=function(){this.mainMenuAngle+=.001,this.mainMenuAngle%=2*Math.PI;var t=Math.sin(2*this.mainMenuAngle)+Math.cos(4*this.mainMenuAngle);t=Math.abs(t),t*=this.mainMenuCameraDist;var e=this.mainMenuAvgPoint.x+Math.cos(this.mainMenuAngle)*t,i=this.mainMenuAvgPoint.y+Math.sin(this.mainMenuAngle)*t;return this.player.pos.x+=.005*(e-this.player.pos.x),this.player.pos.y+=.005*(i-this.player.pos.y),this.player.dir=this.mainMenuAngle+Math.PI,!0},n.prototype.mainMenuWork=function(){this.mainMenuAngle+=.001,this.mainMenuAngle%=2*Math.PI;var t=this.mainMenuAvgPoint.x+Math.cos(this.mainMenuAngle)*this.mainMenuCameraDist,e=this.mainMenuAvgPoint.y+Math.sin(this.mainMenuAngle)*this.mainMenuCameraDist;return this.player.pos.x=t,this.player.pos.y=e,this.player.dir=this.mainMenuAngle+Math.PI,!0},n.prototype.mainMenuDraw=function(){this.ctx.save(),this.ctx.scale(this.canvas.width,this.canvas.height),this.ctx.fillStyle="#7EC0EE",this.ctx.fillRect(0,0,1,.5),this.ctx.fillStyle="#4DBD33",this.ctx.fillRect(0,.5,1,.5),this.ctx.restore(),this.clearFaces();for(var t=this.mainMenuBuildings.length,e=0;e<t;++e)this.addCuboidishFaces(this.mainMenuBuildings[e]);var i=this.faces.length;for(e=0;e<i;++e)this.flattener.fillShape(this.canvas,this.ctx,this.flattener.getPoints2D(this.player.pos,this.player.dir,this.faces[e].points),this.faces[e].color.toString(!0))},n.getSignedMoneyString=function(t){return(t<0?"-":"+")+"€"+String(Math.abs(t))},n.getMoneyString=function(t){return(t<0?"-":"")+"€"+String(Math.abs(t))},n.prototype.endLevel=function(){this.rammerKillMoney=110,this.firedShotMoney=-10,this.damageBuildingMoney=-20,this.injuryMoney=-110,this.dualLooper.stopCallback=function(){document.querySelector(".js-robots-killed").innerHTML=this.levelStats.rammersKilled;var t=this.levelStats.rammersKilled*this.rammerKillMoney;document.querySelector(".js-robots-killed-money").innerHTML=n.getSignedMoneyString(t),this.score+=t,document.querySelector(".js-shots-fired").innerHTML=this.levelStats.shotsFired;var e=this.levelStats.shotsFired*this.firedShotMoney;document.querySelector(".js-shots-fired-money").innerHTML=n.getSignedMoneyString(e),this.score+=e,document.querySelector(".js-building-damage").innerHTML=this.levelStats.buildingHits;var i,s=this.levelStats.buildingHits*this.damageBuildingMoney;i=0==s?"-€0":n.getSignedMoneyString(s),document.querySelector(".js-building-damage-money").innerHTML=i,this.score+=s,document.querySelector(".js-injuries").innerHTML=this.levelStats.numInjuries;var o,r=this.levelStats.numInjuries*this.injuryMoney;o=0==r?"-€0":n.getSignedMoneyString(r),document.querySelector(".js-injuries-money").innerHTML=o,this.score+=r,document.querySelector(".js-current-balance").innerHTML=n.getMoneyString(this.score),this.levelEndCallback()}.bind(this),this.stop()},n.prototype.rammerDeath=function(){this.levelStats.numInjuries>=this.numInjuriesToDie?this.killPlayer():0==this.rammers.length?(this.resetLevelEndOverlay(),this.levelEnding=!0,console.log("City "+this.level+" cleared!")):this.notifyRemainingRobots()},n.prototype.gameWork=function(){this.scrollTexts.forEach(function(t){t.move(),t.doneMoving&&this.scrollTexts.splice(this.scrollTexts.indexOf(t),1)}.bind(this)),this.levelEnding?(this.overlay.a+=.003,this.overlay.a>.6&&this.endLevel()):(this.overlay.a-=.004,this.overlay.a<0&&(this.overlay.a=0));var t=0;this.keyboard.keydown[this.keyBinds.turnRight]&&(t-=1),this.keyboard.keydown[this.keyBinds.turnLeft]&&(t+=1),0!=t?(this.playerTurnRate+=this.playerTurnRateAccel,this.playerTurnRate=(0,b.default)(this.playerTurnRate,0,1),this.player.dir+=t*this.playerTurnRate*this.playerTurnSpeed):(this.playerTurnRate-=this.playerTurnRateAccel,this.playerTurnRate=(0,b.default)(this.playerTurnRate,0,1));var e=a.default.zero();if(this.keyboard.keydown[this.keyBinds.moveForward]&&(e.x+=1),this.keyboard.keydown[this.keyBinds.moveBackward]&&(e.x-=1),this.keyboard.keydown[this.keyBinds.strafeRight]&&(e.y-=1),this.keyboard.keydown[this.keyBinds.strafeLeft]&&(e.y+=1),e.magnitude()>0){var i=e.clone().setMagnitude(this.playerMoveSpeed);i.rotate(a.default.zero(),this.player.dir);var s=i.clone().add(this.player.pos),n=this.walls.some((function(t){return s.on(t.end)}))||!s.on(this.areaRect);n?this.lastPlayerVelocity=a.default.zero():(this.player.pos.x=s.x,this.player.pos.y=s.y,this.lastPlayerVelocity=i)}else this.lastPlayerVelocity=a.default.zero();return this.barrelCameraPos.y+=.038*(this.barrelCameraRestY-this.barrelCameraPos.y),this.bullets.forEach(function(t){if(t.cuboid.end.pos.add(t.velocity),this.player.pos.distance2(t.cuboid.end.pos)>this.bulletRemoveDistance)this.bullets.splice(this.bullets.indexOf(t),1);else{var e,i=this.rammers.some(function(i){return e=i,i.cuboid.end.overlaps(t.cuboid.end)}.bind(this));if(i)this.bulletToSmoke(t),this.killRammer(e),console.log("Number of robots left:",this.rammers.length),this.rammerDeath();else{var s=this.walls.some((function(e){return e.end.overlaps(t.cuboid.end)}));s?(this.levelStats.buildingHits+=1,this.bulletToSmoke(t)):t.cuboid.update()}}}.bind(this)),this.keyboard.keydown[this.keyBinds.shoot]&&this.shoot(),this.bulletSmokes.forEach(function(t){t.cuboid.adjustDimensions(this.bulletSmokeIncrease),t.cuboid.netAdjustments>this.maxBulletSmokeAdjustment?this.bulletSmokes.splice(this.bulletSmokes.indexOf(t),1):t.cuboid.update()}.bind(this)),this.rammers.forEach(function(t){if(this.player.pos.clone2().inside(t.cuboid.end))this.damagePlayer(),this.dieRammer(t),this.rammerDeath();else{var e=this.player.pos.clone2().subtract(t.cuboid.end.dim.clone().scale(.5)).subtract(t.cuboid.end.pos).setMagnitude(t.moveSpeed),i=t.cuboid.end.pos.clone().add(e),s=this.walls.some((function(t){return i.on(t.end)}));s||(t.cuboid.end.pos=i),t.oscillate()}}.bind(this)),this.dyingRammers.forEach(function(t){t.cuboid.adjustDimensions(-this.rammerShrinkSpeed),t.cuboid.topZ<t.cuboid.botZ?this.dyingRammers.splice(this.dyingRammers.indexOf(t),1):t.cuboid.update()}.bind(this)),!0},n.prototype.gameDraw=function(){this.ctx.save(),this.ctx.scale(this.canvas.width,this.canvas.height),this.ctx.fillStyle="#7EC0EE",this.ctx.fillRect(0,0,1,.5),this.ctx.fillStyle="#4DBD33",this.ctx.fillRect(0,.5,1,.5),this.ctx.restore(),this.clearFaces();for(var t=this.walls.length,e=0;e<t;++e)this.addCuboidishFaces(this.walls[e]);var i=this.edgeBuildings.length;for(e=0;e<i;++e)this.addCuboidishFaces(this.edgeBuildings[e]);var s=this.bullets.length;for(e=0;e<s;++e)this.addCuboidishFaces(this.bullets[e].cuboid);var n=this.bulletSmokes.length;for(e=0;e<n;++e)this.addCuboidishFaces(this.bulletSmokes[e].cuboid);var o=this.rammers.length;for(e=0;e<o;++e)this.addCuboidishFaces(this.rammers[e].cuboid);var r=this.dyingRammers.length;for(e=0;e<r;++e)this.addCuboidishFaces(this.dyingRammers[e].cuboid);var a=this.faces.length;for(e=0;e<a;++e)this.drawFace(this.faces[e]);for(var h in this.barrelEnd.faces)this.flattener.fillShape(this.canvas,this.ctx,this.flattener.getPoints2D(this.barrelCameraPos,this.barrelCameraDir,this.barrelEnd.faces[h].points),this.barrelEnd.faces[h].color.toString(!0));for(var h in this.barrel.faces)this.flattener.fillShape(this.canvas,this.ctx,this.flattener.getPoints2D(this.barrelCameraPos,this.barrelCameraDir,this.barrel.faces[h].points),this.barrel.faces[h].color.toString(!0));this.scrollTexts.forEach((function(t){t.draw()})),this.ctx.save(),this.ctx.scale(this.canvas.width,this.canvas.height),this.ctx.fillStyle=this.overlay.toString(),this.ctx.fillRect(0,0,1,1),this.ctx.restore()},n.prototype.drawFace=function(t){this.flattener.fillShape(this.canvas,this.ctx,this.flattener.getPoints2D(this.player.pos,this.player.dir,t.points),t.color.toString(!0))},n.prototype.clearFaces=function(){this.faces=[]},n.prototype.insertFace=function(t){for(var e=!1,i=0;i<this.faces.length;++i)if(t.avgPointPlayerDist>this.faces[i].avgPointPlayerDist){this.faces.splice(i,0,t),e=!0;break}e||this.faces.push(t)},n.prototype.faceNotVisible=function(t){return o.default.allPointsBehind(this.player.pos,this.player.dir,t.points)},n.prototype.addFace=function(t){this.faceNotVisible(t)||(t.avgPointPlayerDist=t.avgPoint.distance(this.player.pos),this.insertFace(t))},n.prototype.addCuboidishFaces=function(t){for(var e in t.faces)this.addFace(t.faces[e])},n.prototype.shoot=function(){if(this.dualLooper.totalTime-this.lastShootTime>this.shootInterval){this.levelStats.shotsFired+=1,this.barrelCameraPos.y=this.barrelCameraShootY;var t=this.player.pos.clone2();t.x-=this.bulletHalfSideLength,t.y-=this.bulletHalfSideLength;var e=a.default.fromAngle(this.player.dir).setMagnitude(this.totalBarrelLength);t.add(e);var i=new y.default({end:new l.default(t,this.bulletDim.clone()),topZ:this.bulletTopZ,botZ:this.bulletBotZ,velocity:a.default.fromAngle(this.player.dir).setMagnitude(this.bulletSpeed).add(this.lastPlayerVelocity)});this.bullets.push(i),this.lastShootTime=this.dualLooper.totalTime}},n.prototype.bulletToSmoke=function(t){this.bullets.splice(this.bullets.indexOf(t),1),this.bulletSmokes.push(t);var e=this.srng.randomInt(220,252),i=this.srng.randomInRange(.3,.65),s=new f.default(e,e,e,i);for(var n in t.cuboid.faces){var o=s.clone();o.scale(this.srng.randomInRange(.85,1)),o.round(),t.cuboid.faces[n].color=o}},n.prototype.addRammer=function(t){var e=this.srng.randomInRange(this.rammerOffsetMin,this.rammerOffsetMax),i=new g.default({end:new l.default(t,this.rammerDim.clone()),topZ:this.rammerTopZ,botZ:this.rammerBotZ,offsetMin:this.rammerOffsetMin,offsetMax:this.rammerOffsetMax,initialOffset:e,offsetIncreasing:this.rammerOffsetIncreasing,offsetSpeed:this.rammerOffsetSpeed,moveSpeed:this.rammerMoveSpeed});this.rammers.push(i)},n.prototype.killRammer=function(t){this.levelStats.rammersKilled+=1,this.dieRammer(t)},n.prototype.dieRammer=function(t){this.rammers.splice(this.rammers.indexOf(t),1),this.dyingRammers.push(t)},e.default=n},function(t,e,i){"use strict";function s(t){this.target=t,this.keydown={},this.listening=!1,this.keydownLS=new n.default(this.target,"keydown",this.handleKeydown.bind(this)),this.keyupLS=new n.default(this.target,"keyup",this.handleKeyup.bind(this))}Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){return t&&t.__esModule?t:{default:t}}(i(9));s.prototype.clear=function(){this.keydown={}},s.getKeyID=function(t){return t.keyCode},s.prototype.handleKeydown=function(t){var e=s.getKeyID(t);this.keydown[e]=!0},s.prototype.handleKeyup=function(t){var e=s.getKeyID(t);this.keydown[e]=!1},s.prototype.start=function(){this.listening||(this.keydownLS.start(),this.keyupLS.start(),this.listening=!0)},s.prototype.stop=function(){this.listening&&(this.keydownLS.stop(),this.keyupLS.stop(),this.listening=!1)},e.default=s},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e,i,s){if(i<=0||s<=0)return{width:0,height:0};if(t<0||e<0||0===t&&0===e)return{width:0,height:0};if(0===t)return{width:0,height:s};if(0===e)return{width:i,height:0};var n,o,r=t/e,a=i/s;if(r===a)n=i,o=s;else if(r<a){n=(h=Math.floor(s/e))*t,o=h*e}else if(r>a){var h;n=(h=Math.floor(i/t))*t,o=h*e}else console.log("Unknown MaxChildSize condition. childAspectWidth:",t,"childAspectHeight:",e,"parentWidth:",i,"parentHeight:",s);return{width:n,height:o}}},function(t,e){"use strict";function i(t){this.name=t.name||"unnamed",this.element=t.element,this.showZ=t.showZ||1e3,this.hideZ=t.hideZ||-1e3,this.startWork=t.startWork||function(){},this.stopWork=t.stopWork||function(){},this.listenerSystems=t.listenerSystems||[],this.listenerSystemsActive=!1,this.on=!1,this.shown=!1,this.element.style["z-index"]=this.hideZ,this.element.style.visibility="hidden"}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.show=function(){this.shown||(this.element.style["z-index"]=this.showZ,this.element.style.visibility="visible",this.shown=!0)},i.prototype.hide=function(){this.shown&&(this.element.style["z-index"]=this.hideZ,this.element.style.visibility="hidden",this.shown=!1)},i.prototype.start=function(){this.show(),this.on||(this.startListenerSystems(),this.startWork(),this.on=!0)},i.prototype.stop=function(){this.hide(),this.on&&(this.stopListenerSystems(),this.stopWork(),this.on=!1)},i.prototype.startListenerSystems=function(){if(!this.listenerSystemsActive){for(var t=this.listenerSystems.length,e=0;e<t;++e)this.listenerSystems[e].start();this.listenerSystemsActive=!0}},i.prototype.stopListenerSystems=function(){if(this.listenerSystemsActive){for(var t=this.listenerSystems.length,e=0;e<t;++e)this.listenerSystems[e].stop();this.listenerSystemsActive=!1}},e.default=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0});var n=(s(i(1)),i(2)),o=s(n),r=(s(i(6)),i(5)),a=(s(r),i(7));s(a),e.default=function(t){this.pos=t.pos||o.default.zero(),this.dir=t.dir||0}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{default:t}}function n(t){this.cuboid=new r.default(t),this.topZ=t.topZ,this.botZ=t.botZ,this.offsetMin=t.offsetMin,this.offsetMax=t.offsetMax,this.offset=t.initialOffset,this.offsetIncreasing=t.offsetIncreasing||!0,this.offsetSpeed=t.offsetSpeed||1,this.moveSpeed=t.moveSpeed||1}Object.defineProperty(e,"__esModule",{value:!0});var o=(s(i(1)),i(3)),r=s(o);n.prototype.oscillate=function(){this.offsetIncreasing?(this.offset+=this.offsetSpeed,this.offset>=this.offsetMax&&(this.offset-=this.offset-this.offsetMax,this.offsetIncreasing=!1),this.cuboid.topZ=this.topZ+this.offset,this.cuboid.botZ=this.botZ+this.offset,this.cuboid.update()):(this.offset-=this.offsetSpeed,this.offset<=this.offsetMin&&(this.offset+=this.offsetMin-this.offset,this.offsetIncreasing=!0),this.cuboid.topZ=this.topZ+this.offset,this.cuboid.botZ=this.botZ+this.offset,this.cuboid.update())},e.default=n},function(t,e){"use strict";function i(t){this.text=t.text,this.canvas=t.canvas,this.ctx=t.ctx,this.fontSize=t.fontSize||16,this.fontFamily=t.fontFamily||"sans-serif",this.ctxFont=this.getCtxFont(),this.textMetrics=this.getTextMetrics(),this.speed=t.speed||.001,this.progress=0,this.doneMoving=!1}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.getCtxFont=function(){return String(this.fontSize)+"px "+this.fontFamily},i.prototype.getTextMetrics=function(){this.ctx.save(),this.ctx.font=this.ctxFont;var t=this.ctx.measureText(this.text);return this.ctx.restore(),t},i.prototype.draw=function(){this.ctx.save(),this.ctx.translate(-this.textMetrics.width,this.fontSize),this.ctx.translate(this.progress*(this.canvas.width+this.textMetrics.width),0),this.ctx.textBaseline="top",this.ctx.font=this.ctxFont,this.ctx.fillStyle="#fff",this.ctx.fillText(this.text,0,0),this.ctx.restore()},i.prototype.move=function(){this.progress<1?this.progress+=this.speed:this.progress>.99&&(this.doneMoving=!0)},e.default=i},function(t,e){"use strict";function i(t){this.seed=t||10}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.random=function(){this.seed+=1;var t=1e5*Math.sin(this.seed);return t-Math.floor(t)},i.prototype.randomInt=function(t,e){return Math.floor(this.random()*(e-t+1))+t},i.prototype.randomInRange=function(t,e){return this.random()*(e-t)+t},e.default=i},function(t,e){"use strict";function i(t,e){this.work=t,this.delay=e,this.waiting=!1,this.timeout}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.set=function(){this.waiting&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){this.waiting=!1,this.work()}.bind(this),this.delay),this.waiting=!0},i.prototype.clear=function(){this.waiting&&(clearTimeout(this.timeout),this.waiting=!1)},e.default=i}])</script>