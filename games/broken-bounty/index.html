<!DOCTYPE html><html><head><meta charset="UTF-8"><title>Broken Bounty</title><style type="text/css">*,:after,:before{box-sizing:border-box}body,html{width:100%;height:100%;margin:0;border:0;padding:0}.app-canvas,.app-container{position:absolute;width:100%;height:100%;margin:0;border:0;padding:0}body{color:#fff;overflow:hidden}a{color:inherit;text-decoration:inherit;transition-property:opacity;transition-duration:.2s;transition-timing-function:ease}a:hover{opacity:.7;text-decoration:underline}button{border:.5vmin solid #fff;padding:.8vmin;font-size:4vh;font-family:sans-serif;color:inherit;background-color:rgba(0,0,0,.1)}.menu{position:absolute;visibility:hidden}.game-title,.menu-title{width:100vw;margin:5vh 0;border:0;padding:0;text-align:center;font-size:10vh;font-family:sans-serif}.button-nav{width:100vw;display:flex;flex-direction:row;justify-content:center}.button-nav>:nth-child(2){margin:0 0 0 2vmin}.info,.options{font-family:monospace}.options{width:100vw;margin:0;border:0;padding:0;display:flex;flex-direction:column;align-items:center;font-size:5vmin;list-style:none}.options>li,.options>li>div{display:flex;flex-direction:row;justify-content:space-between}.options>li>div{align-items:center}.option-label:after{content:":"}.labeled-bar{margin:0 0 0 4vmin}.info{width:100vw;text-align:center;font-size:3vmin}.author{margin:5vh 0 0}.version{margin:0 0 5vh}p{margin:2vh 0;text-align:center;font-size:3.5vh;font-family:sans-serif}.options-return{font-size:3vh}.level-stats{margin:0 0 0 50%;padding:0;transform:translate(-50%);display:flex;flex-direction:column;align-items:center;font-size:3.5vh;font-family:sans-serif;list-style:none}.level-stat{display:flex;flex-direction:row;justify-content:center}.level-stat>:nth-child(1):after{content:":\00a0"}.money{margin:0 0 1vh}.level-balance{margin:3vh 0;font-size:3.5vh}.end-info,.level-balance{display:flex;flex-direction:row;justify-content:center;font-family:sans-serif}.end-info{width:100vw;margin:0 0 5vh;font-size:5vmin}</style></head><body><div class="app-container"><div class="menu main-menu js-main-menu"><h1 class="game-title">Broken Bounty</h1><nav class="button-nav"><button class="main-start js-main-start">←Start</button> <button class="main-options js-main-options">Options→</button></nav></div><div class="menu prepare-menu js-prepare-menu"><p>Robots have glitched and become aggressive to humans.</p><p>As a bounty hunter, you must go city by city, eliminating the dangerous robots.</p><p>Use W, A, S, D to move.</p><p>Turn with left and right arrow keys.</p><p>Fire with space bar.</p><nav class="button-nav"><button class="prepare-start js-prepare-start">↓Ready↓</button></nav></div><canvas class="app-canvas js-app-canvas">Your browser does not support canvas.</canvas></div><div class="menu level-menu js-level-menu"><h1 class="menu-title">City cleared</h1><ul class="level-stats"><li class="level-stat"><div>Robots eliminated</div><div class="js-robots-killed"></div></li><li class="money js-robots-killed-money"></li><li class="level-stat"><div>Shots fired</div><div class="js-shots-fired"></div></li><li class="money js-shots-fired-money"></li><li class="level-stat"><div>Building damage</div><div class="js-building-damage"></div></li><li class="money js-building-damage-money"></li><li class="level-stat"><div>Injuries</div><div class="js-injuries"></div></li><li class="money js-injuries-money"></li></ul><div class="level-balance"><div>Current Balance:&nbsp;</div><div class="js-current-balance"></div></div><nav class="button-nav"><button class="next-level js-next-level">↓Next level↓</button></nav></div><div class="menu end-menu js-end-menu"><h1 class="menu-title">It's all over!</h1><div class="end-info"><div>Final balance:&nbsp;</div><div class="js-final-balance"></div></div><nav class="button-nav"><button class="end-again js-end-again">←Play again</button> <button class="end-main js-end-main">Main menu→</button></nav></div><div class="menu options-menu js-options-menu"><h1 class="menu-title">Options</h1><ul class="options"><li><div class="option-label">&nbsp;&nbsp;&nbsp;Max turn speed</div><div class="labeled-bar"><div>Slower</div><input type="range" value="0.019" min="0.001" max="0.200" step="0.001" class="turn-speed js-turn-speed"><div>&nbsp;Faster</div></div></li><li><div class="option-label">Turn acceleration</div><div class="labeled-bar"><div>Slower</div><input type="range" value="0.040" min="0.001" max="1.000" step="0.001" class="turn-accel js-turn-accel"><div>Instant</div></div></li></ul><div class="info author">Author: <a href="https://github.com/Costava" target="_blank">Costava</a></div><div class="info version">Version: 1.0.0</div><nav class="button-nav"><button class="options-return js-options-return">↓Return↓</button></nav></div><script type="text/javascript">!function(t){function e(s){if(i[s])return i[s].exports;var n=i[s]={exports:{},id:s,loaded:!1};return t[s].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var i={};return e.m=t,e.c=i,e.p="",e(0)}([function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(){var t=document.querySelector(".js-app-canvas");t.getContext("2d");t.width=t.offsetWidth,t.height=t.offsetHeight,M.flattener.setAspectRatio(M.canvas.width/M.canvas.height),M.draw()}var o=i(17),r=(s(o),i(9)),a=s(r),h=i(23),l=s(h),u=i(8),d=(s(u),i(4)),c=(s(d),i(15)),p=s(c),f=i(16),m=s(f),y=i(18),g=s(y);console.log("Welcome");var v=document.querySelector(".js-app-canvas"),b=v.getContext("2d"),w=new m["default"](window);w.start();var M=new p["default"]({canvas:v,ctx:b,keyboard:w});M.dieCallback=function(){x.end.start()},M.levelEndCallback=function(){x.level.start()};var x={};x.main=new g["default"]({name:"main",element:document.querySelector(".js-main-menu"),listenerSystems:[new a["default"](document.querySelector(".js-main-start"),"click",function(){M.dualLooper.stopCallback=function(){x.prepare.start()},x.main.stop()}),new a["default"](document.querySelector(".js-main-options"),"click",function(){x.main.stopListenerSystems(),x.main.hide(),x.options.start()}),new a["default"](document,"keydown",function(t){var e=m["default"].getKeyID(t);37==e?document.querySelector(".js-main-start").click():39==e&&document.querySelector(".js-main-options").click()})],startWork:function(){M.prepMainMenu(),M.start()},stopWork:function(){M.stop()}}),x.prepare=new g["default"]({name:"prepare",element:document.querySelector(".js-prepare-menu"),listenerSystems:[new a["default"](document.querySelector(".js-prepare-start"),"click",function(){M.dualLooper.stopCallback=function(){M.prepLevel(1),M.start()},x.prepare.stop()}),new a["default"](document,"keydown",function(t){var e=m["default"].getKeyID(t);40==e&&document.querySelector(".js-prepare-start").click()})],startWork:function(){M.prepPrepareMenu(),M.start()},stopWork:function(){M.stop()}}),x.level=new g["default"]({name:"level",element:document.querySelector(".js-level-menu"),listenerSystems:[new a["default"](document.querySelector(".js-next-level"),"click",function(){M.prepLevel(M.level+1),x.level.stop()}),new a["default"](document,"keydown",function(t){var e=m["default"].getKeyID(t);40==e&&document.querySelector(".js-next-level").click()})],startWork:function(){},stopWork:function(){M.start()}}),x.end=new g["default"]({name:"end",element:document.querySelector(".js-end-menu"),listenerSystems:[new a["default"](document.querySelector(".js-end-again"),"click",function(){M.prepLevel(1),x.end.stop(),M.start()}),new a["default"](document.querySelector(".js-end-main"),"click",function(){x.end.stop(),x.main.start()}),new a["default"](document,"keydown",function(t){var e=m["default"].getKeyID(t);37==e?document.querySelector(".js-end-again").click():39==e&&document.querySelector(".js-end-main").click()})],startWork:function(){},stopWork:function(){}}),x.options=new g["default"]({name:"options",element:document.querySelector(".js-options-menu"),listenerSystems:[new a["default"](document.querySelector(".js-options-return"),"click",function(){x.options.stop()}),new a["default"](document.querySelector(".js-turn-speed"),"change",function(){var t=Number(this.value);M.playerTurnSpeed=t,console.log("Turn speed:",M.playerTurnSpeed)}),new a["default"](document.querySelector(".js-turn-accel"),"change",function(){var t=Number(this.value);M.playerTurnRateAccel=t,console.log("Turn acceleration:",M.playerTurnRateAccel)}),new a["default"](document,"keydown",function(t){var e=m["default"].getKeyID(t);40==e&&document.querySelector(".js-options-return").click()})],startWork:function(){},stopWork:function(){x.main.show(),x.main.startListenerSystems()}}),x.main.start();var S=new l["default"](n,40),k=new a["default"](window,"resize",S.set.bind(S));k.start(),n()},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){this.x=t,this.y=e}Object.defineProperty(e,"__esModule",{value:!0});var o=i(6);s(o);n.zero=function(){return new n(0,0)},n.fromAngle=function(t){return new n(Math.cos(t),Math.sin(t))},n.average=function(t){for(var e=0,i=0,s=t.length,o=0;o<s;++o)e+=t[o].x,i+=t[o].y;return new n(e/s,i/s)},n.prototype.clone=function(){return new n(this.x,this.y)},n.prototype.setMagnitude=function(t){var e=this.magnitude();return this.x*=t/e,this.y*=t/e,this},n.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},n.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.scale=function(t){return this.x*=t,this.y*=t,this},n.prototype.rotate=function(t,e){var i=this.clone().subtract(t),s=i.magnitude(),o=i.angle(),r=o+e,a=n.fromAngle(r).setMagnitude(s);return this.x=t.x+a.x,this.y=t.y+a.y,this},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.angle=function(){return Math.atan2(this.y,this.x)},n.prototype.angleTo=function(t){return t.clone().subtract(this).angle()},n.prototype.distance=function(t){return this.clone().subtract(t).magnitude()},n.prototype.equals=function(t){return this.x==t.x&&this.y==t.y},n.prototype.lessThan=function(t){return this.x<t.x&&this.y<t.y},n.prototype.lessThanOrEqualTo=function(t){return this.x<=t.x&&this.y<=t.y},n.prototype.greaterThan=function(t){return this.x>t.x&&this.y>t.y},n.prototype.greaterThanOrEqualTo=function(t){return this.x>=t.x&&this.y>=t.y},n.prototype.inside=function(t){var e=this.clone().subtract(t.pos);return e.lessThan(t.dim)&&e.greaterThan(n.zero())},n.prototype.on=function(t){var e=this.clone().subtract(t.pos);return e.lessThanOrEqualTo(t.dim)&&e.greaterThanOrEqualTo(n.zero())},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,e,i){this.x=t,this.y=e,this.z=i}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),r=s(o);n.zero=function(){return new n(0,0,0)},n.average=function(t){for(var e=0,i=0,s=0,o=t.length,r=0;r<o;++r)e+=t[r].x,i+=t[r].y,s+=t[r].z;return new n(e/o,i/o,s/o)},n.prototype.clone=function(){return new n(this.x,this.y,this.z)},n.prototype.clone2=function(){return new r["default"](this.x,this.y)},n.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},n.prototype.add2=function(t){return this.x+=t.x,this.y+=t.y,this},n.prototype.subtract=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},n.prototype.subtract2=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.rotateZ=function(t,e){var i=this.clone().subtract2(t),s=i.magnitude2(),n=i.angle2()+e;return this.x=s*Math.cos(n),this.y=s*Math.sin(n),this},n.prototype.distance=function(t){return this.clone().subtract(t).magnitude()},n.prototype.magnitude=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2)+Math.pow(this.z,2))},n.prototype.magnitude2=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.subtract2=function(t){return this.x-=t.x,this.y-=t.y,this},n.prototype.magnitude2=function(){return Math.sqrt(Math.pow(this.x,2)+Math.pow(this.y,2))},n.prototype.distance2=function(t){return this.clone().subtract2(t).magnitude2()},n.prototype.angle2=function(){return Math.atan2(this.y,this.x)},n.prototype.angleTo2=function(t){return t.clone().subtract2(this).angle2()},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.end=t.end,this.topZ=t.topZ,this.botZ=t.botZ,this.netAdjustments=0,this.generatePoints(),this.generateFaces()}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),r=s(o),a=i(5),h=s(a);n.prototype.generatePoints=function(){this.points=[],this.points.push(new r["default"](this.end.pos.x,this.end.pos.y,this.topZ),new r["default"](this.end.pos.x+this.end.dim.x,this.end.pos.y,this.topZ),new r["default"](this.end.pos.x+this.end.dim.x,this.end.pos.y+this.end.dim.y,this.topZ),new r["default"](this.end.pos.x,this.end.pos.y+this.end.dim.y,this.topZ));for(var t=0;t<4;++t){var e=this.points[t];this.points.push(new r["default"](e.x,e.y,this.botZ))}},n.prototype.generateFaces=function(){this.faces={top:new h["default"]([this.points[0],this.points[1],this.points[2],this.points[3]]),bot:new h["default"]([this.points[4],this.points[5],this.points[6],this.points[7]]),north:new h["default"]([this.points[2],this.points[3],this.points[7],this.points[6]]),east:new h["default"]([this.points[1],this.points[2],this.points[6],this.points[5]]),south:new h["default"]([this.points[0],this.points[1],this.points[5],this.points[4]]),west:new h["default"]([this.points[3],this.points[0],this.points[4],this.points[7]])}},n.facePointIndexes={top:[0,1,2,3],bot:[4,5,6,7],north:[2,3,7,6],east:[1,2,6,5],south:[0,1,5,4],west:[3,0,4,7]},n.prototype.getFacePoints=function(t){for(var e=[],i=0;i<4;++i){var s=n.facePointIndexes[t][i];e.push(this.points[s])}return e},n.prototype.updateFacePoints=function(){for(var t in this.faces)this.faces[t].points=this.getFacePoints(t),this.faces[t].update()},n.prototype.adjustDimensions=function(t){this.netAdjustments+=t;var e=t/2;this.topZ+=e,this.botZ-=e,this.end.pos.x-=e,this.end.pos.y-=e,this.end.dim.x+=t,this.end.dim.y+=t},n.prototype.update=function(){this.generatePoints(),this.updateFacePoints()},e["default"]=n},function(t,e){"use strict";function i(t,e,i,s){this.r=t,this.g=e,this.b=i,this.a=s}Object.defineProperty(e,"__esModule",{value:!0}),i.randomInt=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},i.random=function(t){return new i(i.randomInt(0,255),i.randomInt(0,255),i.randomInt(0,255),t||1)},i.prototype.toString=function(t){var e=t||!0;return e?"rgba("+this.r+", "+this.g+", "+this.b+", "+this.a+")":"rgb("+this.r+", "+this.g+", "+this.b+")"},i.prototype.invert=function(t){this.r=255-this.r,this.g=255-this.g,this.b=255-this.b;var e=t||!1;e&&(this.a=1-this.a)},i.prototype.inverse=function(t){var e=t||!1;return e?new i(255-this.r,255-this.g,255-this.b,1-this.a):new i(255-this.r,255-this.g,255-this.b,this.a)},i.prototype.clamp=function(){this.r=Math.max(Math.min(this.r,255),0),this.g=Math.max(Math.min(this.g,255),0),this.b=Math.max(Math.min(this.b,255),0),this.a=Math.max(Math.min(this.a,1),0)},i.prototype.scale=function(t,e){var i=e||!1;i&&(this.a*=t),this.r*=t,this.g*=t,this.b*=t},i.prototype.round=function(){this.r=Math.round(this.r),this.g=Math.round(this.g),this.b=Math.round(this.b)},i.prototype.clone=function(){return new i(this.r,this.g,this.b,this.a)},e["default"]=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){this.points=t,this.color=e||h["default"].random(1),this.update()}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),r=s(o),a=i(4),h=s(a);n.prototype.update=function(){this.avgPoint=r["default"].average(this.points)},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t,e){this.pos=t,this.dim=e}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1);s(o);n.prototype.getOpposite=function(){return this.pos.clone().add(this.dim)},n.prototype.doesNotOverlap=function(t){var e=this.getOpposite(),i=t.getOpposite();return t.pos.x>e.x||i.x<this.pos.x||t.pos.y>e.y||i.y<this.pos.y},n.prototype.overlaps=function(t){return!this.doesNotOverlap(t)},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){r["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),r=s(o),a=i(5),h=s(a),l=i(13);s(l);n.prototype=Object.create(r["default"].prototype),n.prototype.generateFaces=function(){this.faces={east:new h["default"]([this.points[1],this.points[2],this.points[6],this.points[5]]),west:new h["default"]([this.points[3],this.points[0],this.points[4],this.points[7]]),south:new h["default"]([this.points[0],this.points[1],this.points[5],this.points[4]]),top:new h["default"]([this.points[0],this.points[1],this.points[2],this.points[3]])}},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.nearDistance=new r["default"](0,t.nearDistanceY||n["default"].nearDistanceY),this.farDistance=new r["default"](0,t.farDistanceY||n["default"].farDistanceY),this.viewDistance=t.viewDistance||n["default"].viewDistance;var e=t.aspectRatio||n["default"].aspectRatio;this.setAspectRatio(e)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),r=s(o),a=i(2);s(a);n["default"]={nearDistanceY:.1,farDistanceY:40,viewDistance:100,fadeStartProp:.9,aspectRatio:16/9},n.prototype.setAspectRatio=function(t){this.aspectRatio=t||n["default"].aspectRatio,this.nearDistance.x=this.nearDistance.y*this.aspectRatio,this.farDistance.x=this.farDistance.y*this.aspectRatio,this.distanceDiff=new r["default"](this.farDistance.x-this.nearDistance.x,this.farDistance.y-this.nearDistance.y)},n.prototype.get2D=function(t,e,i){var s=i.distance2(t),n=t.angleTo2(i),o=Math.abs(n-e),a=(o%(2*Math.PI),s*Math.cos(o)),h=s*Math.sin(o),l={};a>=0?(l.x=a/this.viewDistance*this.distanceDiff.x+this.nearDistance.x,l.y=a/this.viewDistance*this.distanceDiff.y+this.nearDistance.y):(l.x=-a/this.viewDistance*this.distanceDiff.x+this.nearDistance.x,l.y=-a/this.viewDistance*this.distanceDiff.y+this.nearDistance.y);var u,d=Math.abs(h/l.x),c=new r["default"](Math.cos(e),Math.sin(e)),p=new r["default"](Math.cos(n),Math.sin(n)),f=c.x*p.y-c.y*p.x;f>0?(u=.5-.5*d,a<0&&(u-=.5)):f<0?(u=.5+.5*d,a<0&&(u+=.5)):u=.5;var m=t.z-i.z,y=.5*(m/l.y)+.5;return a<0&&(m>0?y+=.5:y-=.5),new r["default"](u,y)},n.allPointsBehind=function(t,e,i){return i.every(function(i){return n.pointBehind(t,e,i)})},n.pointBehind=function(t,e,i){var s=Math.abs(e-t.angleTo2(i))%(2*Math.PI);return s>Math.PI&&(s=2*Math.PI-s),s>Math.PI/2},n.prototype.getPoints2D=function(t,e,i){for(var s=[],n=i.length,o=0;o<n;++o){var r=this.get2D(t,e,i[o]);void 0!=r&&s.push(r)}return s},n.prototype.fillShape=function(t,e,i,s){if(i.length>2){e.save(),e.scale(t.width,t.height),e.beginPath(),e.moveTo(i[0].x,i[0].y);for(var n=i.length,o=1;o<n;++o)e.lineTo(i[o].x,i[o].y);e.closePath(),e.fillStyle=s,e.fill(),e.restore()}},e["default"]=n},function(t,e){"use strict";function i(t,e,i){this.target=t,this.eventType=e,this.work=i,this.active=!1}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.start=function(){this.active||(this.target.addEventListener(this.eventType,this.work),this.active=!0)},i.prototype.stop=function(){this.active&&(this.target.removeEventListener(this.eventType,this.work),this.active=!1)},e["default"]=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){r["default"].call(this,t)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(3),r=s(o),a=i(5),h=s(a);n.prototype=Object.create(r["default"].prototype),n.prototype.generateFaces=function(){this.faces={top:new h["default"]([this.points[0],this.points[1],this.points[2],this.points[3]]),north:new h["default"]([this.points[2],this.points[3],this.points[7],this.points[6]]),east:new h["default"]([this.points[1],this.points[2],this.points[6],this.points[5]]),south:new h["default"]([this.points[0],this.points[1],this.points[5],this.points[4]]),west:new h["default"]([this.points[3],this.points[0],this.points[4],this.points[7]])}},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.cuboid=new h["default"](t),this.velocity=t.velocity||r["default"].zero()}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),r=s(o),a=i(3),h=s(a);e["default"]=n},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t,e,i){return Math.max(Math.min(t,i),e)}},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.points=t.points,this.dir=t.dir,this.avgPoint=r["default"].average(this.points),this.color=t.color||h["default"].random(1)}Object.defineProperty(e,"__esModule",{value:!0});var o=i(2),r=s(o),a=i(4),h=s(a);e["default"]=n},function(t,e){"use strict";function i(t){this.regWork=t.regWork,this.finalWork=t.finalWork,this.stopCallback=t.stopCallback||function(){},this.interval=t.interval||i["default"].interval,this.maxNumIntervals=t.maxNumIntervals||i["default"].maxNumIntervals,this.time=0,this.totalTime=0,this.looping=!1,this.stopped=!0,this.loopCallBound=this.loopCall.bind(this)}Object.defineProperty(e,"__esModule",{value:!0}),i["default"]={interval:8,maxNumIntervals:4},i.prototype.accumulate=function(t){this.time+=t,this.totalTime+=t},i.prototype.loopCall=function(){this.newTime=(new Date).getTime(),this.dt=this.newTime-this.oldTime,this.accumulate(this.dt);var t,e=Math.floor(this.time/this.interval),i=Math.min(e,this.maxNumIntervals);for(t=0;t<i;++t){var s=this.regWork();if(!s){t+=1;break}}t>0&&(this.time-=t*this.interval,this.finalWork()),this.oldTime=this.newTime,this.looping?window.requestAnimationFrame(this.loopCallBound):(this.stopped=!0,this.stopCallback())},i.prototype.start=function(){this.stopped&&(this.oldTime=(new Date).getTime(),this.looping=!0,this.stopped=!1,this.loopCallBound())},i.prototype.stop=function(){this.looping=!1},i.prototype.clearTime=function(){this.time=0},i.prototype.resetTime=function(){this.time=0,this.totalTime=0},e["default"]=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.canvas=t.canvas,this.ctx=t.ctx,this.keyboard=t.keyboard,this.keyBinds={moveForward:87,moveBackward:83,strafeRight:68,strafeLeft:65,turnRight:39,turnLeft:37,shoot:32},this.newSRNG(),this.flattener=new r["default"]({aspectRatio:this.canvas.width/this.canvas.height}),this.work=this.mainMenuWork,this.draw=this.mainMenuDraw,this.dualLooper=new h["default"]({regWork:this.work.bind(this),finalWork:this.draw.bind(this)}),this.shootInterval=350,this.lastShootTime=0-this.shootInterval,this.headLevel=1.8,this.playerMoveSpeed=.4,this.playerTurnSpeed=.019,this.playerTurnRate=0,this.playerTurnRateAccel=.04,this.barrelLength=1,this.barrelEndLength=.15,this.totalBarrelLength=this.barrelLength+this.barrelEndLength,this.barrel=new g["default"]({end:new f["default"](new u["default"]((-.1),0),new u["default"](.2,this.barrelLength)),topZ:1.5,botZ:1.3}),this.barrelEnd=new g["default"]({end:new f["default"](new u["default"]((-.12),this.barrelLength),new u["default"](.24,this.barrelEndLength)),topZ:1.52,botZ:1.28}),this.barrelCameraShootY=.3,this.barrelCameraRestY=.01,this.barrelCameraPos=new c["default"](0,this.barrelCameraRestY,this.headLevel),this.barrelCameraDir=Math.PI/2,this.bulletSideLength=.16,this.bulletHalfSideLength=this.bulletSideLength/2,this.bulletTopZ=1.48,this.bulletBotZ=1.32,this.bulletDim=new u["default"](this.bulletSideLength,this.bulletSideLength),this.bulletSpeed=2,this.bulletRemoveDistance=200,this.bulletSmokeIncrease=.1,this.maxBulletSmokeAdjustment=3,this.rammerDim=new u["default"](2.1,2.1),this.rammerTopZ=1.5,this.rammerBotZ=0,this.rammerOffsetMin=0,this.rammerOffsetMax=.5,this.rammerOffsetIncreasing=!0,this.rammerOffsetSpeed=.02,this.rammerMoveSpeed=.34,this.edgeBuildingDim=new u["default"](10,10),this.edgeBuildingBotZ=0,this.edgeBuildingTopZ=20,this.bullets=[],this.bulletSmokes=[],this.rammers=[],this.dyingRammers=[],this.rammerShrinkSpeed=.055,this.nearClippingDistance=2,this.numInjuriesToDie=3,this.dieCallback=function(){console.log("Die")},this.levelEndCallback=function(){console.log("Level end")}}Object.defineProperty(e,"__esModule",{value:!0});var o=i(8),r=s(o),a=i(14),h=s(a),l=i(1),u=s(l),d=i(2),c=s(d),p=i(6),f=s(p),m=i(3),y=(s(m),i(7)),g=s(y),v=i(10),b=s(v),w=i(19),M=s(w),x=i(4),S=s(x),k=i(22),T=s(k),D=i(11),P=s(D),j=i(20),_=s(j),I=i(21),L=s(I),R=i(12),Z=s(R);n.prototype.newSRNG=function(){var t=Math.floor((new Date).getTime()*Math.random());this.srng=new T["default"](t)},n.getSurroundingPoints=function(t,e){for(var i=t.dim.x/(e+1),s=t.dim.y/(e+1),n=[],o=t.pos,r=1;r<e+1;++r)n.push(o.clone().add(new u["default"](r*i,0)));for(var r=1;r<e+1;++r)n.push(o.clone().add(new u["default"](0,r*s)));o=t.pos.clone(),o.y+=t.dim.y;for(var r=1;r<e+1;++r)n.push(o.clone().add(new u["default"](r*i,0)));o=t.pos.clone(),o.x+=t.dim.x;for(var r=1;r<e+1;++r)n.push(o.clone().add(new u["default"](0,r*s)));return n},n.prototype.damagePlayer=function(){this.levelStats.numInjuries+=1,this.overlay.a=.7,this.levelStats.numInjuries>=this.numInjuriesToDie&&this.killPlayer()},n.prototype.killPlayer=function(){this.playerDead||(this.playerDead=!0,this.dualLooper.stopCallback=function(){this.dyingRammers.forEach(function(t){var e=t.cuboid.end.pos.distance(this.player.pos);e<2.5&&this.dyingRammers.splice(this.dyingRammers.indexOf(t),1)}.bind(this)),this.scrollTexts=[],document.querySelector(".js-final-balance").innerHTML=n.getMoneyString(this.score),this.draw(),this.dieCallback()}.bind(this),this.stop())},n.prototype.resetHurtOverlay=function(){this.overlay=new S["default"](250,20,22,0)},n.prototype.resetLevelEndOverlay=function(){this.overlay=new S["default"](50,50,50,0)},n.prototype.prepLevel=function(t){this.level=t,this.levelEnding=!1,1==this.level&&(this.score=0),this.resetHurtOverlay(),this.levelStats={rammersKilled:0,shotsFired:0,buildingHits:0,numInjuries:0},this.playerDead=!1,this.newSRNG(),this.lastShootTime=0-this.shootInterval,this.player=new M["default"]({pos:new c["default"]((-19),(-19),this.headLevel),dir:Math.PI/4}),this.lastPlayerVelocity=u["default"].zero(),this.playerTurnRate=0;var e=this.srng.randomInt(55,255),i=this.srng.randomInt(55,255),s=this.srng.randomInt(55,255),o=1,r=new S["default"](e,i,s,o),a=r.clone(),h=r.clone();a.scale(.6,!1),a.round(),h.scale(.8,!1),h.round(),this.barrelEnd.faces.top.color=r,this.barrelEnd.faces.south.color=a,this.barrel.faces.top.color=h,this.bullets=[],this.bulletSmokes=[],this.rammers=[],this.dyingRammers=[],this.edgeBuildings=[],this.walls=[],this.scrollTexts=[];var l=3+2*this.level;l>9&&(l=9),this.buildingSpreadMin=37,this.buildingSpreadMax=39,this.borderRect=new f["default"](new u["default"]((-30),(-30)),new u["default"]((l-1)*this.buildingSpreadMax+60,(l-1)*this.buildingSpreadMax+60)),this.areaRect=new f["default"](this.borderRect.pos.clone().add(this.edgeBuildingDim),this.borderRect.dim.clone().subtract(this.edgeBuildingDim)),this.surroundingPoints=n.getSurroundingPoints(this.borderRect,8),this.surroundingPoints.forEach(function(t){var e=new b["default"]({end:new f["default"](t.clone(),this.edgeBuildingDim.clone()),topZ:this.edgeBuildingTopZ,botZ:this.edgeBuildingBotZ});this.edgeBuildings.push(e)}.bind(this));for(var d=0;d<l;++d)for(var p=0;p<l;++p)this.walls.push(new b["default"]({end:new f["default"](new u["default"](d*this.srng.randomInt(this.buildingSpreadMin,this.buildingSpreadMax),p*this.srng.randomInt(this.buildingSpreadMin,this.buildingSpreadMax)),new u["default"](this.srng.randomInt(10,12),this.srng.randomInt(10,12))),topZ:this.srng.randomInt(2,20),botZ:0}));var m=4+2*this.level;m>35&&(m=35);for(var y=0;y<m;++y){for(var d=this.srng.randomInt(0*this.buildingSpreadMax,l*this.buildingSpreadMax),p=this.srng.randomInt(0*this.buildingSpreadMax,l*this.buildingSpreadMax),g=new u["default"](d,p),v=!0;v;)v=this.walls.some(function(t){return g.on(t.end)}),v&&(g.y+=1);this.addRammer(g)}this.work=this.gameWork,this.draw=this.gameDraw,this.dualLooper.regWork=this.work.bind(this),this.dualLooper.finalWork=this.draw.bind(this),console.log("Generated city",this.level)},n.prototype.notifyRemainingRobots=function(){if(this.scrollTexts.length>0){var t=this.scrollTexts[this.scrollTexts.length-1],e=t.progress*(t.textMetrics.width+t.canvas.width),i=e/t.textMetrics.width;i<1.2&&this.scrollTexts.pop()}var s;s=1==this.rammers.length?"":"s",this.scrollTexts.push(new L["default"]({text:this.rammers.length+" robot"+s+" remaining",canvas:this.canvas,ctx:this.ctx}))},n.prototype.start=function(){this.dualLooper.resetTime(),this.dualLooper.start()},n.prototype.stop=function(){this.dualLooper.stop()},n.prototype.resume=function(){this.dualLooper.start()},n.prototype.pause=function(){this.dualLooper.stop()},n.prototype.prepMainMenu=function(){this.newSRNG(),this.player=new M["default"]({pos:new c["default"](0,(-5),this.headLevel),dir:Math.PI/2}),this.mainMenuBuildings=[];for(var t=0;t<7;++t)for(var e=0;e<7;++e)this.mainMenuBuildings.push(new b["default"]({end:new f["default"](new u["default"](t*this.srng.randomInt(32,34),e*this.srng.randomInt(32,34)),new u["default"](this.srng.randomInt(10,12),this.srng.randomInt(10,12))),topZ:this.srng.randomInt(1,24),botZ:0}));this.mainMenuBuildingPoints=[];for(var i=this.mainMenuBuildings.length,s=0;s<i;++s)for(var n=this.mainMenuBuildings[s].points.length,o=0;o<n;++o)this.mainMenuBuildingPoints.push(this.mainMenuBuildings[s].points[o]);this.mainMenuAvgPoint=c["default"].average(this.mainMenuBuildingPoints),this.mainMenuAvgDist=0,this.mainMenuAvgHeight=0;for(var r=this.mainMenuBuildingPoints.length,s=0;s<r;++s){var a=this.mainMenuBuildingPoints[s];this.mainMenuAvgDist+=this.mainMenuAvgPoint.distance2(a),this.mainMenuAvgHeight+=a.z}this.mainMenuAvgDist/=r,this.mainMenuAvgHeight/=r,this.player.pos.z=6*this.mainMenuAvgHeight,this.mainMenuCameraDist=2*this.mainMenuAvgDist,this.mainMenuAngle=0,this.work=this.mainMenuWork,this.draw=this.mainMenuDraw,this.dualLooper.regWork=this.work.bind(this),this.dualLooper.finalWork=this.draw.bind(this)},n.prototype.prepPrepareMenu=function(){this.work=this.prepareMenuWork,this.draw=this.mainMenuDraw,this.dualLooper.regWork=this.work.bind(this),this.dualLooper.finalWork=this.draw.bind(this)},n.prototype.prepareMenuWork=function(){this.mainMenuAngle+=.001,this.mainMenuAngle%=2*Math.PI;var t=Math.sin(2*this.mainMenuAngle)+Math.cos(4*this.mainMenuAngle);t=Math.abs(t),t*=this.mainMenuCameraDist;var e=this.mainMenuAvgPoint.x+Math.cos(this.mainMenuAngle)*t,i=this.mainMenuAvgPoint.y+Math.sin(this.mainMenuAngle)*t,s=.005;return this.player.pos.x+=(e-this.player.pos.x)*s,this.player.pos.y+=(i-this.player.pos.y)*s,this.player.dir=this.mainMenuAngle+Math.PI,!0},n.prototype.mainMenuWork=function(){this.mainMenuAngle+=.001,this.mainMenuAngle%=2*Math.PI;var t=this.mainMenuAvgPoint.x+Math.cos(this.mainMenuAngle)*this.mainMenuCameraDist,e=this.mainMenuAvgPoint.y+Math.sin(this.mainMenuAngle)*this.mainMenuCameraDist;return this.player.pos.x=t,this.player.pos.y=e,this.player.dir=this.mainMenuAngle+Math.PI,!0},n.prototype.mainMenuDraw=function(){this.ctx.save(),this.ctx.scale(this.canvas.width,this.canvas.height),this.ctx.fillStyle="#7EC0EE",this.ctx.fillRect(0,0,1,.5),this.ctx.fillStyle="#4DBD33",this.ctx.fillRect(0,.5,1,.5),this.ctx.restore(),this.clearFaces();for(var t=this.mainMenuBuildings.length,e=0;e<t;++e)this.addCuboidishFaces(this.mainMenuBuildings[e]);for(var i=this.faces.length,e=0;e<i;++e)this.flattener.fillShape(this.canvas,this.ctx,this.flattener.getPoints2D(this.player.pos,this.player.dir,this.faces[e].points),this.faces[e].color.toString(!0))},n.getSignedMoneyString=function(t){var e;return e=t<0?"-":"+",e+"€"+String(Math.abs(t))},n.getMoneyString=function(t){var e;return e=t<0?"-":"",e+"€"+String(Math.abs(t))},n.prototype.endLevel=function(){this.rammerKillMoney=110,this.firedShotMoney=-10,this.damageBuildingMoney=-20,this.injuryMoney=-110,this.dualLooper.stopCallback=function(){document.querySelector(".js-robots-killed").innerHTML=this.levelStats.rammersKilled;var t=this.levelStats.rammersKilled*this.rammerKillMoney;document.querySelector(".js-robots-killed-money").innerHTML=n.getSignedMoneyString(t),this.score+=t,document.querySelector(".js-shots-fired").innerHTML=this.levelStats.shotsFired;var e=this.levelStats.shotsFired*this.firedShotMoney;document.querySelector(".js-shots-fired-money").innerHTML=n.getSignedMoneyString(e),this.score+=e,document.querySelector(".js-building-damage").innerHTML=this.levelStats.buildingHits;var i,s=this.levelStats.buildingHits*this.damageBuildingMoney;i=0==s?"-€0":n.getSignedMoneyString(s),document.querySelector(".js-building-damage-money").innerHTML=i,this.score+=s,document.querySelector(".js-injuries").innerHTML=this.levelStats.numInjuries;var o,r=this.levelStats.numInjuries*this.injuryMoney;o=0==r?"-€0":n.getSignedMoneyString(r),document.querySelector(".js-injuries-money").innerHTML=o,this.score+=r,document.querySelector(".js-current-balance").innerHTML=n.getMoneyString(this.score),this.levelEndCallback()}.bind(this),this.stop()},n.prototype.rammerDeath=function(){this.levelStats.numInjuries>=this.numInjuriesToDie?this.killPlayer():0==this.rammers.length?(this.resetLevelEndOverlay(),this.levelEnding=!0,console.log("City "+this.level+" cleared!")):this.notifyRemainingRobots()},n.prototype.gameWork=function(){this.scrollTexts.forEach(function(t){t.move(),t.doneMoving&&this.scrollTexts.splice(this.scrollTexts.indexOf(t),1)}.bind(this)),this.levelEnding?(this.overlay.a+=.003,this.overlay.a>.6&&this.endLevel()):(this.overlay.a-=.004,this.overlay.a<0&&(this.overlay.a=0));var t=0;this.keyboard.keydown[this.keyBinds.turnRight]&&(t-=1),this.keyboard.keydown[this.keyBinds.turnLeft]&&(t+=1),0!=t?(this.playerTurnRate+=this.playerTurnRateAccel,this.playerTurnRate=(0,Z["default"])(this.playerTurnRate,0,1),this.player.dir+=t*this.playerTurnRate*this.playerTurnSpeed):(this.playerTurnRate-=this.playerTurnRateAccel,this.playerTurnRate=(0,Z["default"])(this.playerTurnRate,0,1));var e=u["default"].zero();if(this.keyboard.keydown[this.keyBinds.moveForward]&&(e.x+=1),this.keyboard.keydown[this.keyBinds.moveBackward]&&(e.x-=1),this.keyboard.keydown[this.keyBinds.strafeRight]&&(e.y-=1),this.keyboard.keydown[this.keyBinds.strafeLeft]&&(e.y+=1),e.magnitude()>0){var i=e.clone().setMagnitude(this.playerMoveSpeed);i.rotate(u["default"].zero(),this.player.dir);var s=i.clone().add(this.player.pos),n=this.walls.some(function(t){return s.on(t.end)})||!s.on(this.areaRect);n?this.lastPlayerVelocity=u["default"].zero():(this.player.pos.x=s.x,this.player.pos.y=s.y,this.lastPlayerVelocity=i)}else this.lastPlayerVelocity=u["default"].zero();return this.barrelCameraPos.y+=.038*(this.barrelCameraRestY-this.barrelCameraPos.y),this.bullets.forEach(function(t){t.cuboid.end.pos.add(t.velocity);var e=this.player.pos.distance2(t.cuboid.end.pos),i=e>this.bulletRemoveDistance;if(i)this.bullets.splice(this.bullets.indexOf(t),1);else{var s,n=this.rammers.some(function(e){return s=e,e.cuboid.end.overlaps(t.cuboid.end)}.bind(this));if(n)this.bulletToSmoke(t),this.killRammer(s),console.log("Number of robots left:",this.rammers.length),this.rammerDeath();else{var o=this.walls.some(function(e){return e.end.overlaps(t.cuboid.end)});o?(this.levelStats.buildingHits+=1,this.bulletToSmoke(t)):t.cuboid.update()}}}.bind(this)),this.keyboard.keydown[this.keyBinds.shoot]&&this.shoot(),this.bulletSmokes.forEach(function(t){t.cuboid.adjustDimensions(this.bulletSmokeIncrease),t.cuboid.netAdjustments>this.maxBulletSmokeAdjustment?this.bulletSmokes.splice(this.bulletSmokes.indexOf(t),1):t.cuboid.update()}.bind(this)),this.rammers.forEach(function(t){var e=this.player.pos.clone2().inside(t.cuboid.end);if(e)this.damagePlayer(),this.dieRammer(t),this.rammerDeath();else{var i=this.player.pos.clone2().subtract(t.cuboid.end.dim.clone().scale(.5)).subtract(t.cuboid.end.pos).setMagnitude(t.moveSpeed),s=t.cuboid.end.pos.clone().add(i),n=this.walls.some(function(t){return s.on(t.end)});n||(t.cuboid.end.pos=s),t.oscillate()}}.bind(this)),this.dyingRammers.forEach(function(t){t.cuboid.adjustDimensions(-this.rammerShrinkSpeed),t.cuboid.topZ<t.cuboid.botZ?this.dyingRammers.splice(this.dyingRammers.indexOf(t),1):t.cuboid.update()}.bind(this)),!0},n.prototype.gameDraw=function(){this.ctx.save(),this.ctx.scale(this.canvas.width,this.canvas.height),this.ctx.fillStyle="#7EC0EE",this.ctx.fillRect(0,0,1,.5),this.ctx.fillStyle="#4DBD33",this.ctx.fillRect(0,.5,1,.5),this.ctx.restore(),this.clearFaces();for(var t=this.walls.length,e=0;e<t;++e)this.addCuboidishFaces(this.walls[e]);for(var i=this.edgeBuildings.length,e=0;e<i;++e)this.addCuboidishFaces(this.edgeBuildings[e]);for(var s=this.bullets.length,e=0;e<s;++e)this.addCuboidishFaces(this.bullets[e].cuboid);
for(var n=this.bulletSmokes.length,e=0;e<n;++e)this.addCuboidishFaces(this.bulletSmokes[e].cuboid);for(var o=this.rammers.length,e=0;e<o;++e)this.addCuboidishFaces(this.rammers[e].cuboid);for(var r=this.dyingRammers.length,e=0;e<r;++e)this.addCuboidishFaces(this.dyingRammers[e].cuboid);for(var a=this.faces.length,e=0;e<a;++e)this.drawFace(this.faces[e]);for(var h in this.barrelEnd.faces)this.flattener.fillShape(this.canvas,this.ctx,this.flattener.getPoints2D(this.barrelCameraPos,this.barrelCameraDir,this.barrelEnd.faces[h].points),this.barrelEnd.faces[h].color.toString(!0));for(var h in this.barrel.faces)this.flattener.fillShape(this.canvas,this.ctx,this.flattener.getPoints2D(this.barrelCameraPos,this.barrelCameraDir,this.barrel.faces[h].points),this.barrel.faces[h].color.toString(!0));this.scrollTexts.forEach(function(t){t.draw()}),this.ctx.save(),this.ctx.scale(this.canvas.width,this.canvas.height),this.ctx.fillStyle=this.overlay.toString(),this.ctx.fillRect(0,0,1,1),this.ctx.restore()},n.prototype.drawFace=function(t){this.flattener.fillShape(this.canvas,this.ctx,this.flattener.getPoints2D(this.player.pos,this.player.dir,t.points),t.color.toString(!0))},n.prototype.clearFaces=function(){this.faces=[]},n.prototype.insertFace=function(t){for(var e=!1,i=0;i<this.faces.length;++i)if(t.avgPointPlayerDist>this.faces[i].avgPointPlayerDist){this.faces.splice(i,0,t),e=!0;break}e||this.faces.push(t)},n.prototype.faceNotVisible=function(t){return r["default"].allPointsBehind(this.player.pos,this.player.dir,t.points)},n.prototype.addFace=function(t){var e=this.faceNotVisible(t);e||(t.avgPointPlayerDist=t.avgPoint.distance(this.player.pos),this.insertFace(t))},n.prototype.addCuboidishFaces=function(t){for(var e in t.faces)this.addFace(t.faces[e])},n.prototype.shoot=function(){if(this.dualLooper.totalTime-this.lastShootTime>this.shootInterval){this.levelStats.shotsFired+=1,this.barrelCameraPos.y=this.barrelCameraShootY;var t=this.player.pos.clone2();t.x-=this.bulletHalfSideLength,t.y-=this.bulletHalfSideLength;var e=u["default"].fromAngle(this.player.dir).setMagnitude(this.totalBarrelLength);t.add(e);var i=new P["default"]({end:new f["default"](t,this.bulletDim.clone()),topZ:this.bulletTopZ,botZ:this.bulletBotZ,velocity:u["default"].fromAngle(this.player.dir).setMagnitude(this.bulletSpeed).add(this.lastPlayerVelocity)});this.bullets.push(i),this.lastShootTime=this.dualLooper.totalTime}},n.prototype.bulletToSmoke=function(t){this.bullets.splice(this.bullets.indexOf(t),1),this.bulletSmokes.push(t);var e=this.srng.randomInt(220,252),i=this.srng.randomInRange(.3,.65),s=new S["default"](e,e,e,i);for(var n in t.cuboid.faces){var o=s.clone();o.scale(this.srng.randomInRange(.85,1)),o.round(),t.cuboid.faces[n].color=o}},n.prototype.addRammer=function(t){var e=this.srng.randomInRange(this.rammerOffsetMin,this.rammerOffsetMax),i=new _["default"]({end:new f["default"](t,this.rammerDim.clone()),topZ:this.rammerTopZ,botZ:this.rammerBotZ,offsetMin:this.rammerOffsetMin,offsetMax:this.rammerOffsetMax,initialOffset:e,offsetIncreasing:this.rammerOffsetIncreasing,offsetSpeed:this.rammerOffsetSpeed,moveSpeed:this.rammerMoveSpeed});this.rammers.push(i)},n.prototype.killRammer=function(t){this.levelStats.rammersKilled+=1,this.dieRammer(t)},n.prototype.dieRammer=function(t){this.rammers.splice(this.rammers.indexOf(t),1),this.dyingRammers.push(t)},e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.target=t,this.keydown={},this.listening=!1,this.keydownLS=new r["default"](this.target,"keydown",this.handleKeydown.bind(this)),this.keyupLS=new r["default"](this.target,"keyup",this.handleKeyup.bind(this))}Object.defineProperty(e,"__esModule",{value:!0});var o=i(9),r=s(o);n.prototype.clear=function(){this.keydown={}},n.getKeyID=function(t){return t.keyCode},n.prototype.handleKeydown=function(t){var e=n.getKeyID(t);this.keydown[e]=!0},n.prototype.handleKeyup=function(t){var e=n.getKeyID(t);this.keydown[e]=!1},n.prototype.start=function(){this.listening||(this.keydownLS.start(),this.keyupLS.start(),this.listening=!0)},n.prototype.stop=function(){this.listening&&(this.keydownLS.stop(),this.keyupLS.stop(),this.listening=!1)},e["default"]=n},function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e["default"]=function(t,e,i,s){if(i<=0||s<=0)return{width:0,height:0};if(t<0||e<0||0===t&&0===e)return{width:0,height:0};if(0===t)return{width:0,height:s};if(0===e)return{width:i,height:0};var n,o,r=t/e,a=i/s;if(r===a)n=i,o=s;else if(r<a){var h=Math.floor(s/e);n=h*t,o=h*e}else if(r>a){var h=Math.floor(i/t);n=h*t,o=h*e}else console.log("Unknown MaxChildSize condition. childAspectWidth:",t,"childAspectHeight:",e,"parentWidth:",i,"parentHeight:",s);return{width:n,height:o}}},function(t,e){"use strict";function i(t){this.name=t.name||"unnamed",this.element=t.element,this.showZ=t.showZ||1e3,this.hideZ=t.hideZ||-1e3,this.startWork=t.startWork||function(){},this.stopWork=t.stopWork||function(){},this.listenerSystems=t.listenerSystems||[],this.listenerSystemsActive=!1,this.on=!1,this.shown=!1,this.element.style["z-index"]=this.hideZ,this.element.style.visibility="hidden"}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.show=function(){this.shown||(this.element.style["z-index"]=this.showZ,this.element.style.visibility="visible",this.shown=!0)},i.prototype.hide=function(){this.shown&&(this.element.style["z-index"]=this.hideZ,this.element.style.visibility="hidden",this.shown=!1)},i.prototype.start=function(){this.show(),this.on||(this.startListenerSystems(),this.startWork(),this.on=!0)},i.prototype.stop=function(){this.hide(),this.on&&(this.stopListenerSystems(),this.stopWork(),this.on=!1)},i.prototype.startListenerSystems=function(){if(!this.listenerSystemsActive){for(var t=this.listenerSystems.length,e=0;e<t;++e)this.listenerSystems[e].start();this.listenerSystemsActive=!0}},i.prototype.stopListenerSystems=function(){if(this.listenerSystemsActive){for(var t=this.listenerSystems.length,e=0;e<t;++e)this.listenerSystems[e].stop();this.listenerSystemsActive=!1}},e["default"]=i},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.pos=t.pos||a["default"].zero(),this.dir=t.dir||0}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),r=(s(o),i(2)),a=s(r),h=i(6),l=(s(h),i(5)),u=(s(l),i(7));s(u);e["default"]=n},function(t,e,i){"use strict";function s(t){return t&&t.__esModule?t:{"default":t}}function n(t){this.cuboid=new a["default"](t),this.topZ=t.topZ,this.botZ=t.botZ,this.offsetMin=t.offsetMin,this.offsetMax=t.offsetMax,this.offset=t.initialOffset,this.offsetIncreasing=t.offsetIncreasing||!0,this.offsetSpeed=t.offsetSpeed||1,this.moveSpeed=t.moveSpeed||1}Object.defineProperty(e,"__esModule",{value:!0});var o=i(1),r=(s(o),i(3)),a=s(r);n.prototype.oscillate=function(){this.offsetIncreasing?(this.offset+=this.offsetSpeed,this.offset>=this.offsetMax&&(this.offset-=this.offset-this.offsetMax,this.offsetIncreasing=!1),this.cuboid.topZ=this.topZ+this.offset,this.cuboid.botZ=this.botZ+this.offset,this.cuboid.update()):(this.offset-=this.offsetSpeed,this.offset<=this.offsetMin&&(this.offset+=this.offsetMin-this.offset,this.offsetIncreasing=!0),this.cuboid.topZ=this.topZ+this.offset,this.cuboid.botZ=this.botZ+this.offset,this.cuboid.update())},e["default"]=n},function(t,e){"use strict";function i(t){this.text=t.text,this.canvas=t.canvas,this.ctx=t.ctx,this.fontSize=t.fontSize||16,this.fontFamily=t.fontFamily||"sans-serif",this.ctxFont=this.getCtxFont(),this.textMetrics=this.getTextMetrics(),this.speed=t.speed||.001,this.progress=0,this.doneMoving=!1}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.getCtxFont=function(){return String(this.fontSize)+"px "+this.fontFamily},i.prototype.getTextMetrics=function(){this.ctx.save(),this.ctx.font=this.ctxFont;var t=this.ctx.measureText(this.text);return this.ctx.restore(),t},i.prototype.draw=function(){this.ctx.save(),this.ctx.translate(-this.textMetrics.width,this.fontSize),this.ctx.translate(this.progress*(this.canvas.width+this.textMetrics.width),0),this.ctx.textBaseline="top",this.ctx.font=this.ctxFont,this.ctx.fillStyle="#fff",this.ctx.fillText(this.text,0,0),this.ctx.restore()},i.prototype.move=function(){this.progress<1?this.progress+=this.speed:this.progress>.99&&(this.doneMoving=!0)},e["default"]=i},function(t,e){"use strict";function i(t){this.seed=t||10}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.random=function(){this.seed+=1;var t=1e5*Math.sin(this.seed);return t-Math.floor(t)},i.prototype.randomInt=function(t,e){return Math.floor(this.random()*(e-t+1))+t},i.prototype.randomInRange=function(t,e){return this.random()*(e-t)+t},e["default"]=i},function(t,e){"use strict";function i(t,e){this.work=t,this.delay=e,this.waiting=!1,this.timeout}Object.defineProperty(e,"__esModule",{value:!0}),i.prototype.set=function(){this.waiting&&clearTimeout(this.timeout),this.timeout=setTimeout(function(){this.waiting=!1,this.work()}.bind(this),this.delay),this.waiting=!0},i.prototype.clear=function(){this.waiting&&(clearTimeout(this.timeout),this.waiting=!1)},e["default"]=i}]);</script></body></html>