<!doctype html><meta content="maximum-scale=1,width=device-width" name=viewport><title>Zompocalypse</title><div id=frame><canvas height=72 id=canvas width=256></canvas></div><script>window.Colors={red:"#C64444",white:"#EFF4F0",green1:"#96BB87",green2:"#79936C",green3:"#293833"},window.Controls={W:87,D:68,A:65,S:83,UP:38,DOWN:40,LEFT:37,RIGHT:39,SPACE:32},window.Loop=function(t){return function i(s){t(Math.min((Date.now()-s)/1e3,1)),window.requestAnimationFrame(i.bind(null,Date.now()))}(Date.now())},window.Keyboard={isDown:function(t){return null==this.data[t]&&(this.data[t]=-1),this.data[t]>=0},isJustDown:function(t){return null==this.data[t]&&(this.data[t]=-1),0==this.data[t]&&(this.data[t]+=1,!0)},data:{}},document.addEventListener("keydown",(function(t){-1==Keyboard.data[t.keyCode]&&(Keyboard.data[t.keyCode]=0)})),document.addEventListener("keyup",(function(t){Keyboard.data[t.keyCode]=-1})),window.Canvas=document.getElementById("canvas").getContext("2d");var Hero=function(){this.x=16,this.y=48,this.vx=0,this.vy=0,this.width=4,this.height=6,this.direction=1,this.health=8,this.maxhealth=8,this.jumping=0,this.damaged=0,this.struggling=-1,game.hero=this};Hero.prototype.update=function(t){if(this.struggling>-1){var i=!1;for(var s in game.zombies){if("attacking"==(h=game.zombies[s]).state){i=!0;break}}0==i&&(this.struggling=-1)}if(this.struggling>-1){if((Keyboard.isJustDown(Controls.S)||Keyboard.isJustDown(Controls.DOWN)||Keyboard.isJustDown(Controls.SPACE))&&(this.struggling+=1),(Keyboard.isJustDown(Controls.W)||Keyboard.isJustDown(Controls.UP))&&(this.struggling+=1),(Keyboard.isJustDown(Controls.A)||Keyboard.isJustDown(Controls.LEFT))&&(this.struggling+=1),(Keyboard.isJustDown(Controls.D)||Keyboard.isJustDown(Controls.RIGHT))&&(this.struggling+=1),this.struggling>=20)for(var s in this.struggling=-1,game.zombies){var h;"attacking"==(h=game.zombies[s]).state&&h.explode({x:this.x,y:this.y})}}else(Keyboard.isJustDown(Controls.S)||Keyboard.isJustDown(Controls.DOWN)||Keyboard.isJustDown(Controls.SPACE))&&new Bomb({x:this.x,y:this.y}),(Keyboard.isJustDown(Controls.W)||Keyboard.isJustDown(Controls.UP))&&(0==this.jumping?(this.vy=-3,this.jumping=1):1==this.jumping&&(this.vx=3*this.direction,this.jumping=2)),(Keyboard.isDown(Controls.A)||Keyboard.isDown(Controls.LEFT))&&2!=this.jumping&&(this.direction=-1,this.vx=-1),(Keyboard.isDown(Controls.D)||Keyboard.isDown(Controls.RIGHT))&&2!=this.jumping&&(this.direction=1,this.vx=1);this.vy+=8*t,this.y+this.vy>game.level.floor&&(this.y=game.level.floor,this.vy=0,this.jumping=0),this.x+this.vx<0?(this.vx=0,this.x=0):this.x+this.vx>game.level.width&&(this.x=game.level.width,this.vx=0),this.x+=this.vx,this.y+=this.vy;var e=5e-4;if(0!=this.jumping)e=.5;this.vx<0?(this.vx*=Math.pow(e,t),this.vx>-.001&&(this.vx=0)):this.vx>0&&(this.vx*=Math.pow(e,t),this.vx<.001&&(this.vx=0)),this.damaged-=t,this.damaged<0&&(this.damaged=0)},Hero.prototype.hurt=function(){this.damaged<=0&&(this.health-=1,this.damaged=.1,this.health<=0&&(window.location=window.location))},Hero.prototype.render=function(){this.damaged<=0?Canvas.fillStyle=Colors.white:Canvas.fillStyle=Colors.red;var t=2!=this.jumping?this.width:this.height,i=2!=this.jumping?this.height:this.width,s=Math.round(this.x-t/2),h=Math.round(this.y-i);Canvas.fillRect(s,h,t,i)};var Bomb=function(t){this.x=t.x,this.y=t.y,this.vy=0,this.width=4,this.height=2,this.tick=0,this.primed=!1,this.id=window.gid++,game.bombs[this.id]=this};Bomb.prototype.update=function(t){for(var i in this.tick+=t,this.tick>1.6&&(this.tick-=1.6,this.primed=!0),this.y+this.vy>game.level.floor&&(this.y=game.level.floor,this.vy=0),this.vy+=8*t,this.y+=this.vy,this.primed&&this.isColliding(game.hero)&&this.explode(),game.zombies){var s=game.zombies[i];this.isColliding(s)&&this.explode()}},Bomb.prototype.explode=function(){delete game.bombs[this.id],new Explosion({x:this.x,y:this.y,bomb:this});for(var t=-1;1>=t;t++)new Explosion({x:this.x+(Math.round(1.5*Math.random()*8*t)+4*t),y:this.y-(Math.round(8*Math.random())+(0==t?8:0)),bomb:this})},Bomb.prototype.isColliding=function(t){var i=Math.abs(t.x-this.x),s=Math.abs(t.y-this.y),h=t.width/2+this.width/2,e=t.height/2+this.height/2;return h>i&&e>s},Bomb.prototype.render=function(){this.tick<1.5?Canvas.fillStyle=Colors.white:Canvas.fillStyle=Colors.red;var t=Math.round(this.x-this.width/2),i=Math.round(this.y-this.height);Canvas.fillRect(t,i,this.width,this.height)};var Explosion=function(t){for(var i in this.x=t.x,this.y=t.y,this.bx=t.bomb.x,this.by=t.bomb.y,this.diameter=32,this.tick=2,this.id=window.gid++,game.explosions[this.id]=this,this.isColliding(game.hero)&&game.hero.hurt(),game.zombies){var s=game.zombies[i];this.isColliding(s)&&s.explode({x:this.bx,y:this.by})}};Explosion.prototype.update=function(t){this.tick-=t,this.tick<=0&&delete game.explosions[this.id]},Explosion.prototype.isColliding=function(t){var i=Math.abs(t.x-this.x),s=Math.abs(t.y-this.y-t.height/2),h=this.diameter/2;return h>i&&h>s},Explosion.prototype.render=function(){Canvas.fillStyle=Colors.white,Canvas.beginPath();var t=this.diameter*(this.tick/2);Canvas.arc(this.x,this.y,t/2,0,2*Math.PI),Canvas.fill()};var Zombie=function(t){this.x=t.x,this.y=t.y||-2,this.vx=0,this.vy=0,this.width=6,this.height=8,this.direction=t.direction||1,this.id=window.gid++,game.zombies[this.id]=this,this.tick=0,this.y<game.level.floor&&(this.state="falling")};Zombie.prototype.update=function(t){if("falling"==this.state)this.y+=8*t,this.y>game.level.floor&&(this.y=game.level.floor,this.state="moving");else if("moving"==this.state)this.x+=22*this.direction*t,this.x<0?(this.x=0,this.direction=1):this.x>game.level.width&&(this.x=game.level.width,this.direction=-1),this.isColliding(game.hero)&&(this.state="attacking",game.hero.struggling=0,game.hero.vx=0,game.hero.vy=1);else if("attacking"==this.state)this.tick+=t,this.tick>1.5&&(this.tick-=1.5,game.hero.hurt());else if("dying"==this.state){if(this.vy+=5*t,this.y+this.vy>game.level.floor){this.y=game.level.floor,delete game.zombies[this.id];for(var i=0;15>i;i++)new Particle({x:this.x+Math.round(3*Math.random()-1.5),y:this.y,vx:1*Math.random()-.5,vy:-1*Math.random()*2.5,type:i%2});return}if(this.x+this.vx<0){this.x=0,delete game.zombies[this.id];for(i=0;15>i;i++)new Particle({x:this.x,y:this.y+Math.round(3*Math.random()-1.5),vx:1*Math.random(),vy:-1*Math.random()*2.5,type:i%2});return}if(this.x+this.vx>game.level.width){this.x=game.level.width,delete game.zombies[this.id];for(i=0;15>i;i++)new Particle({x:this.x,y:this.y+Math.round(3*Math.random()-1.5),vx:-1*Math.random(),vy:-1*Math.random()*2.5,type:i%2});return}this.x+=this.vx,this.y+=this.vy}},Zombie.prototype.explode=function(t){this.state="dying",this.x<t.x?(this.direction=-1,this.vx=-1):(this.direction=1,this.vx=1),this.vy=-3},Zombie.prototype.isColliding=function(t){var i=Math.abs(t.x-this.x),s=Math.abs(t.y-this.y),h=t.width/2+this.width/2,e=t.height/2+this.height/2;return h>i&&e>s},Zombie.prototype.render=function(){Canvas.fillStyle=Colors.green1;var t="dying"!=this.state?this.height:this.width,i="dying"!=this.state?this.width:this.height;"attacking"==this.state&&(t-=1);var s=Math.round(this.x-i/2),h=Math.round(this.y-t);Canvas.fillRect(s,h,i,t)};var Particle=function(t){this.x=t.x,this.y=t.y,this.vx=t.vx,this.vy=t.vy,this.type=t.type,this.id=window.gid++,game.particles[this.id]=this};Particle.prototype.update=function(t){this.vy+=8*t,this.y+this.vy>game.level.floor&&(this.y=game.level.floor,this.vx=0,this.vy=0),this.x+this.vx<0&&(this.x=0,this.vx=0),this.x+this.vx>game.level.width&&(this.x=game.level.width,this.vx=0),this.x+=this.vx,this.y+=this.vy},Particle.prototype.render=function(){0==this.type?Canvas.fillStyle=Colors.red:Canvas.fillStyle=Colors.green1;var t=Math.round(this.x),i=Math.round(this.y);Canvas.fillRect(t,i-1,1,1)};var Level=function(){this.width=256,this.height=72,this.floor=this.height-9,game.level=this,this.tiles=[];for(var t=0;t<this.width/8;){var i=Math.floor(5*Math.random());0==i?(this.tiles.push({x:8*t,y:this.floor+1,width:7,height:7}),t++):1==i?(this.tiles.push({x:8*t,y:this.floor+1,width:7,height:3}),this.tiles.push({x:8*t,y:this.floor+1+4,width:7,height:3}),t++):2==i?(this.tiles.push({x:8*t,y:this.floor+1,width:3,height:7}),this.tiles.push({x:8*t+4,y:this.floor+1,width:3,height:7}),t++):3==i?(this.tiles.push({x:8*t,y:this.floor+1,width:3,height:3}),this.tiles.push({x:8*t+4,y:this.floor+1,width:3,height:3}),this.tiles.push({x:8*t,y:this.floor+1+4,width:3,height:3}),this.tiles.push({x:8*t+4,y:this.floor+1+4,width:3,height:3}),t++):4==i&&(this.tiles.push({x:8*t,y:this.floor+1,width:3,height:7}),this.tiles.push({x:8*t,y:this.floor+1+4,width:7,height:3}),this.tiles.push({x:8*(t+.5),y:this.floor+1,width:7,height:3}),this.tiles.push({x:8*(t+1),y:this.floor+1+4,width:7,height:3}),this.tiles.push({x:8*(t+2),y:this.floor+1,width:3,height:7}),this.tiles.push({x:8*(t+1.5),y:this.floor+1,width:7,height:3}),t+=2.5)}};Level.prototype.render=function(){for(var t in Canvas.fillStyle=Colors.green1,Canvas.fillRect(0,this.floor,this.width,9),this.tiles){var i=this.tiles[t];Canvas.fillStyle=Colors.green2,Canvas.fillRect(i.x,i.y,i.width,i.height)}},window.gid=0;var Game=function(){this.hero=null,this.level=null,this.zombies={},this.bombs={},this.explosions={},this.particles={}};Game.prototype.update=function(t){if(this.tick=this.tick+t||t,this.tick>8){this.tick-=8;for(var i=0;16>i;i++)new Zombie({y:-2-16*Math.random(),x:Math.random()*game.level.width,direction:Math.random()<.5?1:-1})}if(Keyboard.isDown(81))throw-1;for(var s in this.hero.update(t),this.zombies)this.zombies[s].update(t);for(var s in this.bombs)this.bombs[s].update(t);for(var s in this.explosions)this.explosions[s].update(t);for(var s in this.particles)this.particles[s].update(t)},Game.prototype.render=function(){for(var t in this.hero.render(),this.zombies)this.zombies[t].render();for(var t in this.particles)this.particles[t].render();for(var t in this.bombs)this.bombs[t].render();for(var t in this.explosions)this.explosions[t].render();this.level.render();var i=Math.round(game.hero.x-64)/8;i=Math.max(Math.min(i,game.level.width/8-16),0),document.getElementById("canvas").style.left=-i+"em"},window.game=new Game,new Level({}),new Hero({});for(var i=0;11>i;i++)new Zombie({y:-2-16*Math.random(),x:Math.random()*game.level.width,direction:Math.random()<.5?1:-1});new Zombie({x:112,y:game.level.floor-1,direction:-1}),Loop((function(t){game.update(t),Canvas.clearRect(0,0,game.level.width,72),game.render(t)}))</script><style>*{margin:0;padding:0;cursor:default;user-select:none;box-sizing:border-box}html{color:#eee;background-color:#111}#frame{top:0;left:0;right:0;bottom:0;margin:auto;position:fixed;overflow:hidden;background-color:teal}@media(min-aspect-ratio:16/9){#frame{height:100vh;width:177.778vh;font-size:11.111vh}}@media(max-aspect-ratio:16/9){#frame{width:100vw;height:56.25vw;font-size:6.25vw}}canvas{height:100%;position:absolute;background-color:#293833;image-rendering:pixelated}</style>