<!doctype html><title>Hit the space!</title><style>body{background:#323639;overflow:hidden;color:#fff;margin:0;padding:0;font-family:Verdana,sans-serif}#scene{position:relative;width:0;height:0}#scene *{position:absolute;user-select:none;pointer-events:none}#overlay{opacity:0;transition:opacity .25s}#overlay.visible{transition:opacity .25s .5s;opacity:1}.planet{transition:filter .5s ease}.pulse{animation:pulse 1.5s ease-out infinite}.arrow{transition:opacity .2s linear}@keyframes pulse{0%{transform:translate(-50%,-50%) scale(.8);opacity:.7}100%{transform:translate(-50%,-50%) scale(1.3);opacity:0}}#play-text,#start-text{font-size:11vmin;pointer-events:initial;cursor:pointer;background:#222;border-radius:1vmin;text-align:center;transition:background-color .15s linear}#play-text:hover,#start-text:hover{background:#333}#controls{font-size:2vmin}</style><div id=ui style=position:absolute;width:100%;height:100%;z-index:10;user-select:none;pointer-events:none><div id=boost-container style="width:10vh;height:5vh;transition:width .5s ease;position:absolute;top:1vh;left:1vh;background-color:#000;border:.5vh solid #555;border-radius:1vh"><div id=boost-bar style=width:100%;height:100%;background:linear-gradient(#0cf,#08a);border-radius:.5vh></div></div><div id=overlay class=visible style=position:absolute;top:0;left:0;width:100%;height:100%;background:#000;display:flex;justify-content:center;align-items:center><div id=controls><p style=font-size:4vmin>You are on a mission to colonize planets in the nearby system.<br>Search for habitable planets, but watch out for the dangers of outer space!<p style=font-size:5vmin>How to play<p>Hold space to accelerate<p>Reach checkpoints (pulsing green planets) to advance<p>Avoid hitting planets and going near black holes<p>Pay attention to your fuel:<ul><li>You can see the remaining fuel in the top left corner (blue bar)<li>If you run out of fuel, you cannot accelerate any further<li>The fuel will be restored when you reach a checkpoint<li>Different amount of fuel is available for each checkpoint</ul><p>Press Enter or R to self-destruct, and restart at the latest checkpoint<div id=start-text style="margin:5vmin 0" onclick='StartGame(),document.getElementById("controls").style.display="none"'>Start</div></div><div id=game-completed style=display:none;font-size:8vmin;text-align:center>Mission complete!</div></div><svg xmlns=http://www.w3.org/2000/svg onclick=ToggleMute() style=cursor:pointer;pointer-events:initial;position:absolute;top:3vmin;right:3vmin;width:5vmin;height:5vmin viewBox="0 0 24 24" stroke-width=1.5 stroke=#fff fill=none stroke-linecap=round stroke-linejoin=round><g id=not-muted><path d="M15 8a5 5 0 0 1 0 8"/><path d="M17.7 5a9 9 0 0 1 0 14"/></g><g id=muted style=display:none><path d="M16 10l4 4m0 -4l-4 4"/></g><path fill=#fff d="M6 15h-2a1 1 0 0 1 -1 -1v-4a1 1 0 0 1 1 -1h2l3.5 -4.5a0.8 .8 0 0 1 1.5 .5v14a0.8 .8 0 0 1 -1.5 .5l-3.5 -4.5"/></svg></div><div style=display:none><svg id=ship style="transform:translate(-50%,-50%) rotate(90deg);filter:drop-shadow(0vh 0vh .4vh #0cf)" xmlns=http://www.w3.org/2000/svg xmlns:xlink=http://www.w3.org/1999/xlink viewBox="0 0 180 285"><defs><linearGradient gradientUnits=userSpaceOnUse id=A x1=560 y1=422.5 x2=740 y2=422.5><stop offset=0 stop-color=#222 /><stop offset=.3 stop-color=#333 /><stop offset=.4 stop-color=#333 /><stop offset=.5 stop-color=#666 /><stop offset=.6 stop-color=#333 /><stop offset=.7 stop-color=#333 /><stop offset=1 stop-color=#222 /></linearGradient><linearGradient gradientUnits=userSpaceOnUse id=B x1=610 y1=407.5 x2=690 y2=407.5><stop offset=0 stop-color=#ccc /><stop offset=.5 stop-color=#fff /><stop offset=1 stop-color=#ccc /></linearGradient><radialGradient gradientUnits=userSpaceOnUse gradientTransform="translate(162.6 105.6) scale(1.19 .82)" id=C cx=409.65 cy=434.55 r=82.01><stop offset=0 stop-color=#2de /><stop offset=.1 stop-color=#2ac /><stop offset=.3 stop-color=#245 /><stop offset=.35 stop-color=#222 /><stop offset=.6 stop-color=#666 /><stop offset=.9 stop-color=#222 /></radialGradient><radialGradient gradientUnits=userSpaceOnUse gradientTransform="translate(162.6 105.6) scale(1.19 .82)" id=D cx=409.3 cy=225.59 r=45.73><stop offset=0 stop-color=#3de /><stop offset=.2 stop-color=#bff /><stop offset=.45 stop-color=#0be /><stop offset=.5 stop-color=#4ce /><stop offset=.52 stop-color=#222 /><stop offset=.6 stop-color=#444 /><stop offset=.7 stop-color=#666 /><stop offset=1 stop-color=#222 /></radialGradient><radialGradient gradientUnits=userSpaceOnUse gradientTransform="translate(162.6 105.6) scale(1.19 .82)" id=E cx=397.15 cy=288.14 r=4.14><stop offset=0 stop-color=#bff /><stop offset=1 stop-color=#0be /></radialGradient><radialGradient id=F cx=422.46 href=#E /><radialGradient id=G cx=377.66 cy=455.34 r=6.92 href=#E /><radialGradient id=H cx=440.94 cy=455.34 r=6.92 href=#E /></defs><g transform="translate(-559.73 -279.75)"><path d="M725 465c-14.86 0-40-25.88-40-30 0-14-5.19-47-15-60-3.76-5-19.83-16.81-10-20 2.91-.94 15 0 15-15 0-31-15-60-25-60s-25 30-25 60c0 15 12.09 14.06 15 15 9.83 3.19-6.24 15-10 20-9.81 13-15 46-15 60 0 4.12-25.21 31.48-40 30-10-1-15 75-15 75s10 0 25-40c14-25 25 0 25 0v65s6-26.65 25-25c6 .52 10 15 10 15h10s4-14.48 10-15c19-1.65 25 25 25 25v-65s10-25 25 0c15 40 25 40 25 40s-6-75-15-75z" fill=url(#A) /><path d="M665 370c5 5 5 10 5 15 0 4.28 5 30 5 30s-1.7 5-10 5h-30c-8.3 0-10-5-10-5s5-25.72 5-30c0-5 0-10 5-15-40 25-20 65-20 65s.78 7.53 15 10c1-4.9 39-4.9 40 0 14.22-2.47 15-10 15-10s20-40-20-65z" fill=url(#B) /><path d="M695 455c-20.74 0-25-10-25-10v30s-1.59 4.41-20 5c-18.41-.59-20-5-20-5v-30s-4.26 10-25 10c-.59 7-2.14 16.55 0 20 2.72 4.38 20 10 20 10s-2.43 22.92-1.64 30.69L625 530s15.58-4.4 25-5c9.42.6 25 5 25 5s2.59-11.38 2.89-14.31C678.67 507.92 675 485 675 485s17.28-5.62 20-10c2.14-3.45.59-13 0-20z" fill=url(#C) /><path d="M650 285c-5 0-15 15-20 35-2.43 9.7 0 20 0 20l5 5h30l5-5s2.43-10.3 0-20c-5-20-15-35-20-35z" fill=url(#D) /><path d="M630.74 340.68c-1.94.07 0 5 5 5h5c2.31.08-4.91-3.4-5-5s-2.86-.08-5 0z" fill=url(#E) /><path d="M670.46 340.68c-2.14-.08-4.92-1.49-5 0s-7.32 5.08-5 5h5c5 0 6.94-4.93 5-5z" fill=url(#F) /><path d="M605 475c-2.39 1.59 2.66 8.37 5 10s7.69 1.65 10 0-2.84-3.13-5-5c-1.91-1.65-7.8-6.47-10-5z" fill=url(#G) /><path d="M695 475c-2.2-1.47-8.09 3.35-10 5-2.16 1.87-7.4 3.28-5 5s7.66 1.63 10 0 7.39-8.41 5-10z" fill=url(#H) /></g></svg></div><script>"use strict";function g(e,t,n){return e+(t-e)*n}function aa(e,t){var n=ba;return Math.atan2(g(Math.sin(n),Math.sin(e),t),g(Math.cos(n),Math.cos(e),t))}function l(e,t,n){return e<t?t:e>n?n:e}function ca(){var e=l((Math.hypot(r,t)-10)/15,0,1);return e*e*(3-2*e)}function da(e){return()=>{let t=e+=1831565813;return t=Math.imul(t^t>>>15,1|t),t^=t+Math.imul(t^t>>>7,61|t),((t^t>>>14)>>>0)/2**32}}let u,v,y,fa,ha,z,ea=.5,w=ea,x=!1;function ja(e){var t=u;let n=t.createBuffer(1,0|t.sampleRate,t.sampleRate),i=n.getChannelData(0);for(let n=0;n<i.length;++n)i[n]=e(n/t.sampleRate);return n}function ka(){u=new AudioContext,v=u.createGain(),v.gain.value=w,y=u.createBiquadFilter(),y.type="highshelf",y.frequency.value=200,y.gain.value=0,y.connect(v),v.connect(u.destination);let e=da(0);fa=ja((()=>2*e()-1)),ha=u.createPeriodicWave(new Float32Array([0,0,1,.1,-.4,0,1,0,-.9,.1,.4,-.1,0,.2,-.1,.1,0,0,.1,.1,0,0,0,0,0,.1,.2,-.2,-.3,.1,.1,-.2,0,0,.1,0,-.1,-.4,.2,.4,.1,.3,.3,0,0,-.2,.1,-.1,-.1,-.3,.1,-.1,0,0,.1,.1,0,.1,.1,-.2,0,-.1,-.1,0,0,-.1,-.2,0,.1,0,-.1,.1,-.1,0,0,-.1,-.1,0,-.1,-.1,-.1]),new Float32Array([0,0,1,-.1,.2,0,-.3,.1,-.5,-.8,0,0,-.4,0,-.3,-.1,0,0,0,0,.1,.1,0,-.1,0,.1,-.4,.1,-.1,-.2,0,0,-.1,0,.1,-.2,0,-.2,0,-.2,0,.4,0,-.4,.3,.1,0,-.1,.2,-.1,.2,-.1,-.2,-.2,.2,0,-.2,.1,-.2,-.2,0,0,0,0,.1,-.1,-.1,0,.1,0,0,.1,0,0,0,0,0,0,0,0,0])),la();let t=A();z=u.createGain();let n=u.createBiquadFilter();z.gain.value=0,n.type="bandpass",n.frequency.value=250,n.Q.value=5,t.connect(n),n.connect(z),z.connect(y),t.start()}function A(){var e=fa;let t=u.createBufferSource();return t.buffer=e,t.loop=!0,t}function B(e,t,n,i,a,o,r){let l=u.createOscillator(),s=u.createGain(),c=u.createBiquadFilter();l.frequency.value=e,s.gain.value=0;let d=n;s.gain.linearRampToValueAtTime(0,d),d+=.01,s.gain.linearRampToValueAtTime(t,d),d+=i,s.gain.linearRampToValueAtTime(t,d),d+=a,s.gain.linearRampToValueAtTime(0,d),c.type="bandpass",c.Q.value=o,c.frequency.value=e,l.connect(s),s.connect(c),c.connect(y),"string"==typeof r?l.type=r:l.setPeriodicWave(r),l.start(n),l.stop(d)}function C(e,t,n,i,a,o,r=.01,l=.1,s=0){let c=u.createGain(),d=u.createBiquadFilter();c.gain.value=0;let m=t;c.gain.linearRampToValueAtTime(0,m),m+=r,c.gain.linearRampToValueAtTime(e,m),m+=s,c.gain.linearRampToValueAtTime(e,m),m+=l,c.gain.linearRampToValueAtTime(0,m),d.type=i?"bandpass":"allpass",d.frequency.value=a,d.Q.value=o,n.connect(c),c.connect(d),d.connect(y),n.start(t),n.stop(m)}function ma(e){C(.2,e,A(),!0,1e4,2)}function na(e){C(.2,e,A(),!0,1e4,1,.02,.06)}window.ToggleMute=function(){x=!x;let e=w;w=x?0:ea,v&&(v.gain.linearRampToValueAtTime(e,u.currentTime),v.gain.linearRampToValueAtTime(w,u.currentTime+.01)),document.getElementById("muted").style.display=x?"":"none",document.getElementById("not-muted").style.display=x?"none":""};let sa,oa=0;function la(){function e(e,t,n,i){B(t=2**(Math.log2(440)+t-4+(n-9)/12),.1,e,i,.05,.02,ha),B(t,.1/1.5,e+.25,i,.05,.5,ha),B(t,.05,e+.5,i,.05,1,ha)}let t,n=u.currentTime+.1,i=!0,a=!1,o=!1,r=ma,l=da(0),s=()=>{let s=(u.currentTime+9)/8;for(;oa<s;){let s=n+8*oa;if(0==oa%2&&(t=da(10*l()|0)),++oa,i)for(var c=0;16>c;++c){var d=s+.5*c;let e=u.createOscillator();e.frequency.value=250,e.frequency.linearRampToValueAtTime(250,d+.01+0),e.frequency.linearRampToValueAtTime(50,d+.03+0),C(.3,d+0,e,!1,0,0,.01,.1,.05)}if(a)for(d=0;8>d;++d)C(.1,s+d+.5,A(),!0,1800,1,.01,.05,.07);if(o)for(d=0;16>d;++d)r(s+.5*(d+.5));for(!i||.1>l()?i=!i:!a||.1>l()?a=!a:!o||.1>l()?o=!o:.2>l()&&(r=r===ma?na:ma),d=(d=[[0,2,4,7,9],[2,4,7,9,12],[4,7,9,12,14]])[t()*d.length|0],c=0;16>c;++c).5>t()?e(s+.5*c,2,d[t()*d.length|0]-10,.25*(.5>t()?1:.5)):(e(s+.5*c,2,d[t()*d.length|0]-10,.125),e(s+.25*(2*c+1),2,d[t()*d.length|0]-10,.125))}};s(),setInterval(s,1379)}function pa(e,t,n){e.o.width=t,e.o.height=n,e.g.viewport(0,0,t,n),e.g.uniform4f(e.i.uScreenSize,t,n,1/t,1/n),e.g.uniform2f(e.i.uAspect,t/n,n/t)}function qa(e){e.g.uniform1f(e.i.uTime,.001*performance.now()),e.g.drawArrays(e.g.TRIANGLE_STRIP,0,e.D.length/2)}class ra{constructor(e,...t){function n(e){e=e.split("\n");const t=4|Math.log10(e.length+1);console.error("\n"+e.map(((e,n)=>(n+1).toString().padEnd(t," ")+e)).join("\n"))}t.push("uTime","uScreenSize","uAspect");var i=`#version 300 es\nprecision highp float;\nuniform float uTime;\nuniform vec4 uScreenSize;\nuniform vec2 uAspect;\nin vec4 vPixelCoord;\nout vec4 fragColor;\n${e}\nvoid main()\n{\n    vec4 color;\n    mainImage(color, vPixelCoord.xy);\n    fragColor = color;\n}`,a=(e=this.g=(this.o=document.createElement("canvas")).getContext("webgl2")).createShader(e.VERTEX_SHADER),o=e.createShader(e.FRAGMENT_SHADER);if(a&&o){e.shaderSource(a,"#version 300 es\nin vec2 aVertexPosition;\n\nuniform vec4 uScreenSize;\n\nuniform float uTime;\n\nout vec4 vPixelCoord;\n\nvoid main()\n{\n    vec2 normalizedPosition = (aVertexPosition + vec2(1.0)) * 0.5;\n    vec2 screenPosition = normalizedPosition * uScreenSize.xy;\n    vPixelCoord = vec4(normalizedPosition, screenPosition);\n    gl_Position = vec4(aVertexPosition, 0.0, 1.0);\n}\n        "),e.shaderSource(o,i),e.compileShader(a),e.compileShader(o);var r=e.getShaderInfoLog(a);if(r&&0!==r.length)console.error("Error compiling vertex shader"),console.error(r),n("#version 300 es\nin vec2 aVertexPosition;\n\nuniform vec4 uScreenSize;\n\nuniform float uTime;\n\nout vec4 vPixelCoord;\n\nvoid main()\n{\n    vec2 normalizedPosition = (aVertexPosition + vec2(1.0)) * 0.5;\n    vec2 screenPosition = normalizedPosition * uScreenSize.xy;\n    vPixelCoord = vec4(normalizedPosition, screenPosition);\n    gl_Position = vec4(aVertexPosition, 0.0, 1.0);\n}\n        ");else if((r=e.getShaderInfoLog(o))&&0!==r.length)console.error("Error compiling fragment shader"),console.error(r),n(i);else if(i=e.createProgram())if(e.attachShader(i,a),e.attachShader(i,o),e.linkProgram(i),(a=e.getProgramInfoLog(i))&&0!==a.length)console.error("Error linking program"),console.error(a);else if(e.useProgram(i),a=e.createBuffer()){this.D=new Float32Array([-1,-1,1,-1,-1,1,1,1]),o=e.getAttribLocation(i,"aVertexPosition"),e.bindBuffer(e.ARRAY_BUFFER,a),e.enableVertexAttribArray(o),e.vertexAttribPointer(o,2,e.FLOAT,!1,0,0),e.bufferData(e.ARRAY_BUFFER,this.D,e.STATIC_DRAW),this.i={};for(const n of t)this.i[n]=e.getUniformLocation(i,n)}else console.error("Cannot create buffers");else console.error("Cannot create WebGL program")}else console.error("Cannot create shader object")}}const D=new ra(`\nuniform vec2 offset;\nuniform float globalZoom;\n#define iterations 15\n#define formuparam 0.56\n#define volsteps 15\n#define stepsize 0.25\n#define zoom   5.000\n#define tile   0.850\n#define speed  0.010\n#define brightness 0.0008\n#define darkmatter 0.000\n#define distfading 0.5\n#define saturation 1.0\n#define maxNumBlackHoles 6\nuniform int numBlackHoles;\nuniform vec4 blackHoleData[maxNumBlackHoles];\nfloat noise(in float x)\n{\n    float i = floor(x);\n    float f = fract(x);\n    float s = sign(fract(x*0.5)-0.5);\n    float k = fract(i*.1731);\n    return s*f*(f-1.0)*((16.0*k-4.0)*f*(f-1.0)-1.0);\n}\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    float backgroundDistance = ${Number.isInteger(4)?4..toFixed(1):4..toString()};\n    float backgroundDistanceMultiplier = ${Number.isInteger(2)?2..toFixed(1):2..toString()};\n    vec2 uv = fragCoord - 0.5;\n    uv /= backgroundDistance * globalZoom;\n    uv.x *= uAspect.x;\n    vec2 offsetLocal = offset / backgroundDistance / backgroundDistanceMultiplier;\n    vec3 from = vec3(offsetLocal, -11.11);\n    const float blackHoleEdgeSharpness = 200.0;\n    const float blackHolePower = 2.0;\n    const vec3 blackHoleColor = vec3(0.0);\n    float light = 1.0;\n    vec2 originalUv = uv;\n    float blackHoleOutlineGlow = 0.0;\n    vec3 blackHoleOutlineGlowColor = vec3(1.0, 0.3, 0.0);\n    for (int i = 0; i < numBlackHoles; ++i)\n    {\n        vec4 data = blackHoleData[i] / backgroundDistance;\n        vec2 pos = data.xy / backgroundDistanceMultiplier - offsetLocal;\n        pos *= backgroundDistanceMultiplier;\n        float radius = data.z;\n        float effectRadius = data.w;\n        float currentDist = distance(pos, originalUv);\n        vec2 warp = normalize(pos - originalUv) * pow(currentDist, -blackHolePower) * effectRadius;\n        uv += warp;\n        light *= clamp((currentDist - radius) * blackHoleEdgeSharpness, 0.0, 1.0);\n        blackHoleOutlineGlow += 2.0 / (abs(currentDist - radius) * 1000.0);\n    }\n    vec3 rgb;\n    {\n        vec3 dir = vec3(uv * zoom, 1.0);\n        float a1 = 1.0;\n        float a2 = 2.5;\n        mat2 rot1=mat2(cos(a1),sin(a1),-sin(a1),cos(a1));\n        mat2 rot2=mat2(cos(a2),sin(a2),-sin(a2),cos(a2));\n        dir.xz*=rot1;\n        dir.xy*=rot2;\n        from.xz*=rot1;\n        from.xy*=rot2;\n        float s = 0.5;\n        float fade = 0.9;\n        vec3 v = vec3(-1.0);\n        for (int r = 0; r < volsteps; ++r)\n        {\n            vec3 p = from + s * dir * 0.5;\n            p = abs(vec3(tile) - mod(p, vec3(tile * 2.0)));\n            float a = 0.0;\n            vec3 sp = p;\n            for (int i = 0; i < iterations; ++i)\n            {\n                p = abs(p) / dot(p, p) - formuparam;\n                float D = length(p);\n                float fade2 = 5.0 / (float(i) * 2.0 + 20.0);\n                a += mix(min(15.0, D), D, fade2);\n            }\n            fade *= clamp(5.0 / float(r + 1), 0.0, 1.0);\n            a = pow(a, 3.2 + noise(uTime * 0.01) * 0.1);\n            v += fade;\n            v -= 0.2;\n            v += vec3(s * s * s * s, s * s, s) * a * brightness * fade;\n            fade *= distfading - noise(uTime * 0.01) * 0.1;\n            s += stepsize;\n        }\n        rgb = pow(v * 0.01 * sqrt(s), vec3(1.5)) * 1.5;\n        rgb.r *= 0.4 + noise(uTime * 0.02 + 1.23) * 0.3;\n        rgb = clamp(rgb, vec3(0.0), vec3(1.0)) * 0.8;\n    }\n    rgb += blackHoleOutlineGlowColor * clamp(blackHoleOutlineGlow, 0.0, 1.0) * 0.6;\n    rgb = mix(blackHoleColor, rgb, light);\n    fragColor = vec4(rgb, 1.0);\n}`,"offset","globalZoom","numBlackHoles","blackHoleData");function ta(){pa(D,window.innerWidth,window.innerHeight)}function ua(){window.requestAnimationFrame(ua),D.g.uniform2f(D.i.offset,F.position.x,F.position.y),D.g.uniform1f(D.i.globalZoom,G),qa(D)}document.body.appendChild(D.o),D.o.style.position="absolute",D.o.style.zIndex="-3",ta(),window.addEventListener("resize",ta),window.requestAnimationFrame(ua);let H=[9e9,9e9,0,0,9e9,9e9,0,0,9e9,9e9,0,0,9e9,9e9,0,0,9e9,9e9,0,0,9e9,9e9,0,0];sa=(e,t,n,i,a)=>{H[e*=4]=t,H[e+1]=n,H[e+2]=i,H[e+3]=a,D.g.uniform4fv(D.i.blackHoleData,H)},D.g.uniform4fv(D.i.blackHoleData,H);let G=1;class va{constructor(e){this.g=e,this.position={x:0,y:0,z:0}}u(){this.g.element.style.transform=`scale(${G}) translate3d(${-this.position.x*window.innerHeight}px, ${this.position.y*window.innerHeight}px, ${-this.position.z*window.innerHeight}px)`}}function wa(){var e=I;e.element.style.left=.5*window.innerWidth+"px",e.element.style.top=.5*window.innerHeight+"px",e.i.u(),e.g.forEach((e=>e.u()))}class xa{constructor(){this.i=new va(this),this.g=new Set,this.element=document.createElement("div"),document.body.appendChild(this.element),this.element.id="scene"}add(e){this.g.add(e),this.element.appendChild(e.element)}remove(e){this.g.delete(e),this.element.removeChild(e.element)}}class ya{constructor(e=!0){this.element=document.createElement("div"),this.B=[],this.position={x:0,y:0,z:0},this.g={x:0,y:0,z:0},this.o=1,e&&this.u()}u(){this.element.style.transform=`translate3d(${this.position.x*window.innerHeight}px, ${-this.position.y*window.innerHeight}px, ${this.position.z*window.innerHeight}px) rotateX(${this.g.x}deg) rotateY(${this.g.y}deg) rotateZ(${-this.g.z}deg) scale(${this.o})`,this.B.forEach((e=>e()))}}class za extends ya{constructor(){super(),this.s=.025,this.i=document.createElement("div"),this.i.style.borderRadius="50%",this.i.style.background="radial-gradient(#0ff, #000)",this.i.style.transform="translate(-50%, -50%)";let e=document.getElementById("ship");this.B.push((()=>{this.i.style.width=.05*window.innerHeight+"px",this.i.style.height=.05*window.innerHeight+"px",e.style.width=.05*1.5*window.innerHeight+"px",e.style.height=.05*1.5*window.innerHeight+"px"})),this.element.appendChild(e),this.element.style.zIndex="1",this.u()}}class Aa extends ya{constructor(){super(),this.element.className="arrow";let e=document.createElement("div"),t=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttributeNS(null,"viewBox","0 0 8 8"),t.setAttributeNS(null,"stroke-width","0.5"),t.setAttributeNS(null,"stroke","#0cf"),t.setAttributeNS(null,"fill","#bff"),t.setAttributeNS(null,"stroke-linecap","round"),t.setAttributeNS(null,"stroke-linejoin","round");let n=document.createElementNS("http://www.w3.org/2000/svg","path");n.setAttributeNS(null,"d","M2 2L6 4L2 6L3 4Z"),t.appendChild(n),e.appendChild(t),t.style.transform="translate(-50%, -50%)",this.B.push((()=>{t.setAttributeNS(null,"width",.1*window.innerHeight+"px"),t.setAttributeNS(null,"height",.1*window.innerHeight+"px")})),this.element.appendChild(e),this.element.style.zIndex="2",this.element.style.opacity=0,this.u()}}class Ba extends ya{constructor(e,t,n){super(),this.element.appendChild(e),e.style.transform="translate(-50%, -50%)",this.I=!0,this.A=0,this.G=this.F=1,this.v=n,this.i=t(this),this.B.push((()=>{e.style.width=window.innerHeight*this.F+"px",e.style.height=window.innerHeight*this.G+"px"})),this.i(0)}}function Ca(e,t=1,n=null){for(let i=0;i<t;++i){let t=new Ba(e.D.cloneNode(!0),e.K,n);e.o.add(t),e.i.add(t)}}function Da(){var e=Ea,t=J;for(let n of e.i)n.A+=t,n.i(t),n.I||(e.i.delete(n),e.o.remove(n));for(e.g+=0*t;1<=e.g;)--e.g,Ca(e)}class Fa{constructor(e){var t=Ga;this.o=I,this.D=t,this.g=0,this.i=new Set,this.K=e}}const K=new ra("\n\nuniform vec3 colorData[4];\nuniform int numColors;\n\nuniform float planetRadius;\nuniform float seed;\nuniform float noiseScale;\n\n\nvec3 hash3(vec3 p)\n{\n    p = vec3(\n        dot(p,vec3(127.1, 311.7, 74.7)),\n        dot(p,vec3(269.5, 183.3, 246.1)),\n        dot(p,vec3(113.5, 271.9, 124.6))\n    );\n\n    return 2.0 * fract(sin(p) * 43758.5453123) - 1.0;\n}\n\nfloat simplex_noise(vec3 p)\n{\n    const float K1 = 1.0 / 3.0;\n    const float K2 = 1.0 / 6.0;\n\n    vec3 i = floor(p + (p.x + p.y + p.z) * K1);\n    vec3 d0 = p - (i - (i.x + i.y + i.z) * K2);\n\n    vec3 e = step(vec3(0.0), d0 - d0.yzx);\n    vec3 i1 = e * (1.0 - e.zxy);\n    vec3 i2 = 1.0 - e.zxy * (1.0 - e);\n\n    vec3 d1 = d0 - (i1 - 1.0 * K2);\n    vec3 d2 = d0 - (i2 - 2.0 * K2);\n    vec3 d3 = d0 - (1.0 - 3.0 * K2);\n\n    vec4 h = max(0.6 - vec4(dot(d0, d0), dot(d1, d1), dot(d2, d2), dot(d3, d3)), 0.0);\n    vec4 n = h * h * h * h * vec4(dot(d0, hash3(i)), dot(d1, hash3(i + i1)), dot(d2, hash3(i + i2)), dot(d3, hash3(i + 1.0)));\n\n    return dot(vec4(31.316), n);\n}\n\n\nvec3 hsv2rgb(vec3 c)\n{\n    vec4 K = vec4(1.0, 2.0 / 3.0, 1.0 / 3.0, 3.0);\n    vec3 p = abs(fract(c.xxx + K.xyz) * 6.0 - K.www);\n    return c.z * mix(K.xxx, clamp(p - K.xxx, 0.0, 1.0), c.y);\n}\n\nvoid mainImage(out vec4 fragColor, in vec2 fragCoord)\n{\n    const vec2 planetPosition = vec2(0.0, 0.0);\n\n    float glowRadius = -0.001;\n    vec2 uv = (fragCoord - 0.5) * (planetRadius - glowRadius * 4.0) * 2.0;\n\n    float currentPlanetDistance = distance(planetPosition, uv);\n    vec3 originalPlanetColor = hsv2rgb(colorData[0]);\n\n    vec2 planetDir = (uv - planetPosition) / planetRadius;\n    float len = clamp(length(planetDir), 0.0, 1.0);\n    float z = sqrt(1.0 - len * len);\n    vec3 normal = vec3(planetDir, z);\n\n    vec3 planetNoise = vec3(0.0);\n\n    float mul = 1.0;\n    float scale = planetRadius * 50.0 * noiseScale;\n    float mulmul = 2.5;\n\n    for (int i = 0; i < numColors; ++i)\n    {\n        planetNoise += smoothstep(-1.2, 1.6, simplex_noise(vec3(seed) + normal * mul * scale)) / mul * hsv2rgb(colorData[i]);\n        mul *= mulmul;\n    }\n\n    vec3 planetColor = planetNoise;\n    float side = smoothstep(0.0, 1.0, (currentPlanetDistance - planetRadius) * 1000.0);\n    planetColor *= mix(0.2, 1.0, pow(dot(normal, vec3(0.0, 0.0, 1.0)), 2.0));\n\n    float glowIntensity = smoothstep(1.0, 0.0, (currentPlanetDistance - planetRadius - glowRadius) * 200.0);\n    vec3 rgb = glowIntensity * originalPlanetColor * 0.4;\n    rgb = mix(planetColor, rgb, smoothstep(0.0, 1.0, (currentPlanetDistance - planetRadius) * 1000.0));\n    fragColor = vec4(rgb, glowIntensity);\n}","numColors","colorData","planetRadius","seed","noiseScale"),Ha=[];function Ia(){let e;window.requestAnimationFrame(Ia),null==(e=Ha.shift())||e.call()}Ia();class Ja extends ya{constructor(e,t,n,i,a,o,r){super(!1),this.element.style.zIndex="-1",this.element.classList.add("planet"),this.s=e,this.J=o,this.C=!1,this.level=r,this.L=t,this.H=!0;const l=new Image;if(this.M=()=>{this.H&&(this.H=!1,Ha.push((()=>{const t=window.innerHeight*e*2;pa(K,t,t),K.g.uniform1i(K.i.numColors,i.length),K.g.uniform3fv(K.i.colorData,i.flat()),K.g.uniform1f(K.i.planetRadius,e/2),K.g.uniform1f(K.i.seed,n),K.g.uniform1f(K.i.noiseScale,a),qa(K),l.src=K.o.toDataURL()})))},o){let t=document.createElement("div");t.classList.add("pulse"),this.element.appendChild(t),t.style.borderRadius="50%",t.style.background="#0f0",this.B.push((()=>{t.style.width=2*e*window.innerHeight+"px",t.style.height=2*e*window.innerHeight+"px"}))}this.element.appendChild(l),l.style.transform="translate(-50%, -50%)",window.addEventListener("resize",(()=>this.H=!0))}u(){super.u(),this.M()}}let L=[{l:1,h:[0,0,.1],m:[[1,0,.4]],j:[]},{l:2.5,h:[2,0,.1],m:[[1,0,.3],[3,0,.4]],j:[]},{l:3,h:[4,0,.1],m:[[.75,0,.15],[.75,.5,.1]],j:[]},{l:4,h:[1.5,.5,.15],m:[],j:[[1.5,0,.2,7e-4]]},{l:4,h:[2.5,0,.1],m:[[1.5,0,.4],[1.5,.6,.15],[1.5,-.6,.15]],j:[]},{l:3,h:[3,0,.1],m:[[1,.1,.15],[2,0,.1],[3,0,.15],[4,-.1,.15],[5,0,.1]],j:[]},{l:5,h:[6,0,.1],m:[[1,0,.15],[2,.1,.1],[3.5,0,.5,100],[5,-.1,.15],[6,0,.1]],j:[]},{l:2,h:[7,0,.1],m:[[.8,0,.2],[0,1,.3],[1,1,.3]],j:[]},{l:2,h:[1,1.5,.1],m:[[.3,.2,.05,10],[.5,.52,.05,10],[.35,.48,.03,10],[.55,.3,.05,10],[.4,.1,.08,10],[.6,.6,.05,10],[.5,.94,.06,10],[.6,.86,.05,10],[.8,.7,.04,10],[.7,.5,.05,10],[.5,-.2,.2,40],[.2,.94,.15,30],[0,.7,.08,20],[-.2,.5,.15,30]],j:[]},{l:1.5,h:[1,.9,.1],m:[[1,0,.2],[1.5,.2,.15],[2,.22,.18],[2.5,.25,.1,40],[.5,.5,.1,40],[1,.7,.18],[1.5,.9,.2],[2,.98,.22]],j:[]},{l:4.5,h:[3,.6,.1],m:[[2.5,1.5,.2]],j:[[1.5,0,.2,7e-4]]},{l:4,h:[3,1.5,.1],m:[],j:[]},{l:3,h:[1,-3,.1],m:[[1,0,.2],[2,-.15,.2],[3,.15,.2]],j:[]},{l:5,h:[4,0,.1],m:[[1,0,.2],[3,0,.15]],j:[[2,0,.1,1e-4]]},{l:3,h:[4,0,.1],m:[[.5,0,.15],[1,.5,.15],[1,-.5,.15],[1.5,0,.15],[2,.5,.15],[2,-.5,.15],[2.5,0,.15]],j:[]},{l:3,h:[3,0,.1],m:[],j:[]},{l:3,h:[2,0,.1],m:[[.6,.3,.08,20],[2.1,1.2,.08,20],[2.7,-.6,.08,20],[2.9,-.2,.08,20],[2.2,.1,.08,20],[2.5,-.5,.08,20],[.2,1.2,.08,20],[1.1,-.1,.08,20],[2.4,0,.08,20],[1,-.3,.08,20],[2.3,.9,.08,20],[0,1.1,.08,20],[1.1,-.8,.08,20],[1.6,1.6,.08,20],[2.3,-.7,.08,20],[2.7,.6,.08,20],[2.2,.4,.08,20],[2.7,.3,.08,20],[.3,-.1,.08,20],[1.3,1.3,.08,20]],j:[]},{l:3,h:[3.5,.5,.1],m:[],j:[]},{l:9,h:[3,.5,.1],m:[[1,-.5,.15],[1,-.25,.05,20],[1,0,.15],[1,.25,.05,20],[1,.5,.15]],j:[[1,-.9,.15,3e-4],[1,.9,.15,3e-4]]},{l:9,h:[2,0,.3],m:[],j:[]}],M=!1,Ka=!1,La=!1;window.addEventListener("keydown",(e=>{M||(M=" "===e.key),Ka=M&&!e.repeat,La||(La=("Enter"===e.key||"r"===e.key.toLowerCase())&&!e.repeat)})),window.addEventListener("keyup",(e=>{M&&(M=" "!==e.key)}));let I=new xa,F=I.i,Ga=document.createElement("div");Ga.style.borderRadius="50%",Ga.style.background="radial-gradient(#ff6, #f52 30%, #0006 50%, #0000 80%)";let Ea=new Fa((e=>{e.element.style.filter=`brightness(${Math.random()+.5})`;let t,n,i,a=.5*Math.random()+.5,o=null!=(t=e.v.angle)?t:Math.random()*Math.PI*2;e.F=null!=(n=e.v.F)?n:.03,e.G=null!=(i=e.v.G)?i:.03;let r,l=null!=(r=e.v.speed)?r:.1*Math.random()+.2;return e.position.x=e.v.x,e.position.y=e.v.y,t=>{let n=l*(1-(1-(1-e.A/a)**2)),i=Math.sin(o)*n;e.position.x+=t*Math.cos(o)*n,e.position.y+=t*i,e.element.style.opacity=Math.sin((1-e.A/a)*Math.PI/2)/2,e.I=1>e.A/a}}));const Ma=[[.25,1,1.5]];D.g.uniform1i(D.i.numBlackHoles,6);let Na,Oa,N=[],O=[],P=(null!=(Oa=+window.localStorage.getItem("kimbatt-js13k-2021"))?Oa:0)%(L.length-1);for(let e=1;e<L.length;++e){L[e].h[0]+=L[e-1].h[0],L[e].h[1]+=L[e-1].h[1];for(let t of L[e].m)t[0]+=L[e].h[0],t[1]+=L[e].h[1];for(let t of L[e].j)t[0]+=L[e].h[0],t[1]+=L[e].h[1]}function Pa(e){function t(t,a){let o,r=new Ja(t[2],null!=(o=t[3])?o:80,100*n(),a?Ma:[i(),i(),i(),i()],.6*n()+.6,a,e);return(r.C=a&&e<=P)&&(r.element.style.filter="hue-rotate(88deg)"),r.position.x=t[0],r.position.y=t[1],I.add(r),r}if(Qa(e-3),!(e>=L.length||0>e)){var n=da(e),i=()=>[.2*n(),n(),.5*n()+.5],a=0;N=[...N,Na=t(L[e].h,!0),...L[e].m.map((e=>t(e,!1)))],O=[...L[e].j.map((function(t){let n=e%3*2+a++,i=t[0],o=t[1];return sa(n,i,o,t[2],t[3]),[i,o,t[2],e,n]})),...O]}}function Qa(e){0>e||(N=N.filter((t=>{let n=t.level===e;return n&&I.remove(t),!n})),O=O.filter((t=>{let n=t[3]===e;return n&&sa(t[4],9e9,9e9,0,0),!n})))}Pa(P),Pa(P-1),Pa(P+1);let Q=new Aa;I.add(Q),Q.position.x=0,Q.position.y=0;let R=N[0],Ra=0,Sa=0,Ta=0,ba=0,S=new za;I.add(S);let T=2,r=0,t=0,U=Math.atan2(t,r),V=F.position.x,Ua=F.position.y,W=L[P].l,X=W,Y=!1,Va=document.getElementById("overlay"),Wa=document.getElementById("boost-bar").style,Xa=document.getElementById("boost-container").style;function Ya(e){X=Math.max(X-e,0),Wa.width=X/W*100+"%"}function Za(){S.element.style.opacity=1,S.position.x=R.position.x-R.s-.05,S.position.y=R.position.y,S.o=1,F.position.x=V=S.position.x,F.position.y=Ua=S.position.y,t=r=0,U=Math.atan2(t,r),S.g.z=180*U/Math.PI,G=1,Va.classList.remove("visible"),Ra=1,T=2,Z=0,X=W,Ya(0)}Xa.width=10*W+"vh";let $a=!1;window.StartGame=function(){$a||($a=!0,ka(),Za(),ab=!1)};let bb=[];function cb(e,t){bb.push([e,t,!1])}function db(e,t){bb.push([e,t,!0])}let eb=0,fb=0;const J=1/60;function gb(e){var t=(e/=1e3)-eb;for(eb=e,t=Math.min(t,.1),fb+=t,window.requestAnimationFrame(gb),e=Y;fb>-J/2;){for(fb-=J,hb(),t=0;t<bb.length;++t){var n=bb[t];n[2]&&n[0](),0>=(n[1]-=J)&&(bb.splice(t,1),--t,n[0]())}La=Ka=!1}1===T&&(Y=!1),e!==Y&&(z.gain.linearRampToValueAtTime(Y?0:1,u.currentTime),z.gain.linearRampToValueAtTime(Y?1:0,u.currentTime+.1)),e=.45/G,t=window.innerWidth/window.innerHeight*e,n=Na.position.x-F.position.x;const i=Na.position.y-F.position.y,a=l(i,-e,e);Q.position.x=F.position.x+l(n,-t,t),Q.position.y=F.position.y+a,Q.g.z=180*Math.atan2(i,n)/Math.PI,Q.element.style.opacity=+(Math.abs(n)>1.5*t||Math.abs(i)>1.5*e),wa()}function ib(e){return e>Math.PI?e-=2*Math.PI:e<-Math.PI&&(e+=2*Math.PI),e}function jb(){Ca(Ea,50,{x:S.position.x,y:S.position.y}),B(50,.5,u.currentTime,.1,.5,.5,"square"),B(70,.5,u.currentTime,.1,.3,.3,"sawtooth"),C(.3,u.currentTime,A(),!0,1e3,2,.02,.6,0),T=1,Va.classList.add("visible"),S.element.style.opacity=0,y.gain.linearRampToValueAtTime(0,u.currentTime),y.gain.linearRampToValueAtTime(-20,u.currentTime+.5),cb((()=>{Za(),y.gain.linearRampToValueAtTime(-20,u.currentTime),y.gain.linearRampToValueAtTime(0,u.currentTime+.5)}),1)}let ab=!0,Z=0;function hb(){if(Da(),!ab&&1!==T){var e=.02*J,n=l(Math.abs(V-S.position.x),0,5)/5,i=l(Math.abs(Ua-S.position.y),0,5)/5;if(V=g(V,S.position.x,g(n**1.5,n,Z)),n=Ua=g(Ua,S.position.y,g(i**1.5,i,Z)),i=2*S.position.y-Ua,F.position.x=g(V,2*S.position.x-V,Z*Z*(3-2*Z)),F.position.y=g(n,i,Z*Z*(3-2*Z)),G=g(G,1/(1+.5*ca()),.5*J),0===T){if(La)return void jb();for(var a of N){var o=(n=a.position.x-S.position.x)*n+(i=a.position.y-S.position.y)*i;let s=a.L/o;if(Math.sqrt(o)<a.s+S.s+(a.J&&!a.C?.05:0))return a.J&&!a.C?(T=2,r=t=0,Pa(1+ ++P),window.localStorage.setItem("kimbatt-js13k-2021",P),B(555,.5,u.currentTime,.1,.2,10,"sawtooth"),B(66,.5,u.currentTime,.1,.2,10,"sawtooth"),Y=!1,X=W=L[P].l,Xa.width=10*W+"vh",Ya(0),R=a,a.C=!0,a.element.style.filter="hue-rotate(88deg)",Ra=0,Sa=S.position.x,Ta=S.position.y,ba=U,db((()=>{Z=l(Z-J/2,0,1)}),2),void(P===L.length-1&&(ab=!0,cb((()=>{document.getElementById("start-text").style.display="none",document.getElementById("game-completed").style.display="",Va.classList.add("visible")}),.5),v.gain.linearRampToValueAtTime(ea,u.currentTime),v.gain.linearRampToValueAtTime(0,u.currentTime+4),w=ea=0))):void jb();r+=n*s*e,t+=i*s*e}for(const l of O){if(i=(a=l[0]-S.position.x)*a+(n=l[1]-S.position.y)*n,o=2e3*l[2]/i,Math.sqrt(i)<l[2]+S.s){T=1,Va.classList.add("visible");let e=0,t=S.position.x,n=S.position.y;return db((()=>{e+=J/.3,S.element.style.opacity=S.o=Math.max(0,1-e),S.position.x=g(t,l[0],e),S.position.y=g(n,l[1],e)}),.3),y.gain.linearRampToValueAtTime(0,u.currentTime),y.gain.linearRampToValueAtTime(-20,u.currentTime+.5),void cb((()=>{Za(),y.gain.linearRampToValueAtTime(-20,u.currentTime),y.gain.linearRampToValueAtTime(0,u.currentTime+.5)}),1)}r+=a*o*e,t+=n*o*e}(Y=M&&0<X)&&(a=Math.cos(U),n=Math.sin(U),i=g(500,15,l(Math.hypot(r,t)/10,0,1)),r+=a*J*i,t+=n*J*i,i=.01*Math.random()+.025,Ca(Ea,1,{angle:U+(Math.random()-.5),x:S.position.x-.02*a,y:S.position.y-.02*n,speed:5*J,F:i,G:i}),Ya(J)),r*=1-5*e,t*=1-5*e,a=Math.hypot(r,t),n=Math.min(25,a),r*=n/a,t*=n/a,S.position.x+=r*e,S.position.y+=t*e,a=l(a=ib(Math.atan2(t,r)-U),-(e*=80),e),U=ib(U+a)}else 2===T&&(e=Math.atan2(S.position.y-R.position.y,S.position.x-R.position.x)+.15*J/R.s,n=Math.cos(e),a=Math.sin(e),Ra=Math.min(Ra+J/.5,1),e+=Math.PI/2,n=R.position.x+(R.s+.05)*n,a=R.position.y+(R.s+.05)*a,U=aa(e,i=1-(1-Ra)**2),S.position.x=g(Sa,n,i),S.position.y=g(Ta,a,i),Ka&&(T=0,r=15*Math.cos(e),t=15*Math.sin(e),db((()=>{Z=l(Z+J/3,0,1)}),3)));S.g.z=180*U/Math.PI}}window.requestAnimationFrame(gb),window.addEventListener("resize",(()=>wa()))</script>