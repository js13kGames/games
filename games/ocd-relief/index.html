<!doctype html><meta content="width=device-width" name=viewport><style>body{margin:0;padding:0;font-family:Tahoma}.hidden{display:none!important}.game{width:100vw;height:100vh;display:flex;align-items:center;justify-content:center}.desktop{width:960px;height:720px}.work-area{height:calc(720px - 32px);background:#018281;z-index:0}.task-bar{height:32px;background:#bfbfc1;color:#000;display:flex}.filler{flex:1}.btn{flex:0;flex-shrink:0;text-align:center;padding-top:5px;padding-bottom:5px;cursor:pointer;background:silver;border:2px solid #acacac;border-color:#fff grey grey #fff}.btn:hover{border-color:#000}.start-btn{min-width:80px;font-weight:700}.objective-btn{min-width:100px;font-size:14px}.time-remaining-btn{font-size:14px;min-width:200px}.icon{position:absolute;display:flex;flex-direction:column;align-items:center;width:48px;height:48px;padding:8px}.icon:hover{background:rgba(100,148,237,.527)}.icon.moving{background:rgba(210,105,30,.233)}.icon-graphic{width:32px;height:32px;background:#b39292;cursor:pointer;flex-grow:0;flex-shrink:0;display:flex;align-items:center;justify-content:center}.icon-label{margin-top:6px;text-align:center;color:#fff;font-size:12px;cursor:default}.start-menu{position:absolute;width:200px;z-index:101}.objectives-area{position:absolute;height:400px;width:300px;background:#f5f5f5;border:2px solid #acacac;border-color:#fff grey grey #fff;z-index:102}.objective-header{display:flex;background:silver;padding:6px;align-items:center}.objective-header-title{flex:1;font-size:14px}.objective-header-icon{padding:0 8px}.objective-label{margin:8px}.welcome-area{position:absolute;width:600px;height:400px;z-index:100;margin:auto;background:#f5f5f5;border:2px solid #acacac;border-color:#fff grey grey #fff}.welcome-header{display:flex;background:silver;padding:6px;align-items:center}.welcome-header-title{flex:1;font-size:14px}.welcome-header-icon{padding:0 8px}.version{font-size:12px;color:#5e5e5e;position:absolute;right:8px;bottom:8px}.welcome-title{font-size:28px;width:100%;margin:20px 0;text-align:center}.welcome-heading{margin:20px 20px}.verdict-area{position:absolute;width:300px;height:160px;z-index:200;margin:auto;background:#f5f5f5;border:2px solid #acacac;border-color:#fff grey grey #fff;font-size:28px;display:flex;justify-content:center;align-items:center}.verdict-area.victory{color:green}.verdict-area.defeat{color:red}</style><title>OCD Relief - js13kGames 2021</title><div class=main></div><script>window.scope={},scope.playDefeatMusic=()=>{with(new AudioContext)with(G=createGain())for(i in D=[,,,,,,,,2,2,3,2,2,3,2,2,3,2,2])with(createOscillator())D[i]&&(connect(G),G.connect(destination),start(.12*i),frequency.setValueAtTime(550*1.06**(13-D[i]),.12*i),type="triangle",gain.setValueAtTime(1,.12*i),gain.setTargetAtTime(1e-4,.12*i+.1,.005),stop(.12*i+.11))},scope.playMainMusic=()=>{with(new AudioContext)with(G=createGain())for(i in D=[16,,18,18,18,13,13,13,,,18,18,18,,13,13,13,,18,18,18,13,13,13,,18,18,18,13,13,13,,18,18,18,,13,13,13,,18,18,18,13,13,13,,15,15,,18,18,18,13,13,13,16,16])with(createOscillator())D[i]&&(connect(G),G.connect(destination),start(.18*i),frequency.setValueAtTime(440*1.06**(13-D[i]),.18*i),type="triangle",gain.setValueAtTime(1,.18*i),gain.setTargetAtTime(1e-4,.18*i+.16,.005),stop(.18*i+.17))},scope.playVictoryMusic=()=>{with(new AudioContext)with(G=createGain())for(i in D=[17,17,17,17,17,16,17,15,15,15,15,14,11,12,10,11,,6,7,8,9,8,6,5,3,4,4,4,5,3,2,1,1,2,1,1])with(createOscillator())D[i]&&(connect(G),G.connect(destination),start(.08*i),frequency.setValueAtTime(440*1.06**(13-D[i]),.08*i),type="triangle",gain.setValueAtTime(1,.08*i),gain.setTargetAtTime(1e-4,.08*i+.06,.005),stop(.08*i+.07))},scope.levelList=[],scope.levelList.push({time:30,input:["Documents","Music","Documents/Story.docx","Never before.mp3","Lady in red.mp3","Recording 1.wav","Thriller.docx","Transactions Q4.pdf","~Thriller.tmp"],objectives:[{text:"Put all music in the Music folder",testFn:e=>3===e.find((e=>"Music"===e.name)).files.filter((e=>["wav","mp3"].indexOf(e.extension)>-1)).length},{text:"Put all docs in the Documents folder",testFn:e=>3===e.find((e=>"Documents"===e.name)).files.filter((e=>["docx","doc","pdf"].indexOf(e.extension)>-1)).length},{text:"Remove all Temporary files",testFn:e=>1===e.find((e=>"Recycle Bin"===e.name)).files.filter((e=>["tmp"].indexOf(e.extension)>-1)).length}]}),scope.levelList.push({time:40,input:["Bank & Tax","Music","My Writings","Books","Imagine - John Lennon.mp3","Lady in red.mp3","Transactions Q4.pdf","Recording 1.wav","My Thriller.docx","My Article for medium.docx","Transactions Q2.pdf","Transactions Q1.pdf","~My Thriller.tmp","~Pagefile.tmp","Tax returns.pdf","Tax rebate appl.pdf","Sherlock Holmes by Arthu.pdf"],objectives:[{text:"Put all music in the Music folder",testFn:e=>3===e.find((e=>"Music"===e.name)).files.filter((e=>["wav","mp3"].indexOf(e.extension)>-1)).length},{text:'Put all tax and bank related documents in the "Bank & Tax" folder',testFn:e=>5===e.find((e=>"Bank & Tax"===e.name)).files.filter((e=>["Transactions Q4.pdf","Transactions Q2.pdf","Transactions Q1.pdf","Tax returns.pdf","Tax rebate appl.pdf"].indexOf(`${e.name}.${e.extension}`)>-1)).length},{text:'Put only my literary works in the "My Writings" folder',testFn:e=>2===e.find((e=>"My Writings"===e.name)).files.filter((e=>["My Thriller.docx","My Article for medium.docx"].indexOf(`${e.name}.${e.extension}`)>-1)).length},{text:'Put the book I\'m reading in the "Books" folder',testFn:e=>1===e.find((e=>"Books"===e.name)).files.filter((e=>["Sherlock Holmes by Arthu.pdf"].indexOf(`${e.name}.${e.extension}`)>-1)).length},{text:"Remove all Temporary files",testFn:e=>2===e.find((e=>"Recycle Bin"===e.name)).files.filter((e=>["tmp"].indexOf(e.extension)>-1)).length}]}),scope.levelList.push({time:25,input:["Bank & Tax","Music","My Writings","Books","Smells Like Teen Spirit.mp3","Billie Jean.mp3","Like A Rolling Stone.mp3","My Thriller.docx","My Article for medium.docx","Transactions Q2.pdf","Transactions Q1.pdf","~My Thriller.tmp","~Pagefile.tmp","Tax returns.pdf","Tax rebate appl.pdf","Sherlock Holmes by Arthu.pdf"],objectives:[{text:"Put all music in the Music folder",testFn:e=>3===e.find((e=>"Music"===e.name)).files.filter((e=>["wav","mp3"].indexOf(e.extension)>-1)).length},{text:'Put all tax and bank related documents in the "Bank & Tax" folder',testFn:e=>4===e.find((e=>"Bank & Tax"===e.name)).files.filter((e=>["Transactions Q4.pdf","Transactions Q2.pdf","Transactions Q1.pdf","Tax returns.pdf","Tax rebate appl.pdf"].indexOf(`${e.name}.${e.extension}`)>-1)).length},{text:'Put only my literary works in the "My Writings" folder',testFn:e=>2===e.find((e=>"My Writings"===e.name)).files.filter((e=>["My Thriller.docx","My Article for medium.docx"].indexOf(`${e.name}.${e.extension}`)>-1)).length},{text:'Put the book I\'m reading in the "Books" folder',testFn:e=>1===e.find((e=>"Books"===e.name)).files.filter((e=>["Sherlock Holmes by Arthu.pdf"].indexOf(`${e.name}.${e.extension}`)>-1)).length},{text:"Remove all Temporary files",testFn:e=>2===e.find((e=>"Recycle Bin"===e.name)).files.filter((e=>["tmp"].indexOf(e.extension)>-1)).length}]});let VARS={desX:0,desY:0,idSeed:0,files:[],movingElement:null,timeLeft:0,level:null,timeout:null,status:"undecided"},CONSTS={maxInARow:12,iconDim:80};const setupVariables=e=>{VARS.level=e;let t=document.querySelector(".work-area").getBoundingClientRect();VARS.desX=t.left,VARS.desY=t.top,VARS.idSeed=1,VARS.files=[],VARS.movingElement=null,VARS.timeLeft=e.time,VARS.lastTime=null,VARS.status="undecided"},initiateGameBoard=()=>{document.querySelector(".main").innerHTML="",document.querySelector(".main").innerHTML='\n  <div class="game">\n    <div class="desktop">\n      <div class="work-area"></div>\n      <div class="task-bar">\n        <div class="btn start-btn" onclick="toggleStartMenu()">‚≠ê Start</div>\n        <div class="filler"></div>\n        <div class="btn objective-btn" onclick="toggleObjectivesMenu()">üèÜ Objectives</div>\n        <div class="btn time-remaining-btn">‚è∞ Remaining <span class="time-left">*</span> second(s)</div>\n      </div>\n      <div class="start-menu hidden">\n        <div class="btn menu-buttton"  onclick="startGameClicked(0)">Start Level 1 (Easy)</div>\n        <div class="btn menu-buttton"  onclick="startGameClicked(1)">Start Level 2 (Moderate)</div>\n        <div class="btn menu-buttton"  onclick="startGameClicked(2)">Start Level 3 (Hard)</div>\n        <div class="btn menu-buttton" onclick="sourceClicked()">Source & Credits</div>\n      </div>\n      <div class="objectives-area hidden">\n        <div class="objective-header">\n          <div class="objective-header-title">üèÜ Objectives</div>\n          <div class="btn objective-header-icon" onclick="hideObjectivesMenu()">x</div>\n        </div>\n        <div class="objectives"></div>\n      </div>\n      <div class="verdict-area hidden">\n        <div class="verdict"></div>\n      </div>\n      <div class="welcome-area hidden">\n        <div class="welcome-header">\n          <div class="welcome-header-title">Welcome to OCD Relief !</div>\n          <div class="btn welcome-header-icon" onclick="closeWelcomeMenu()">x</div>\n        </div>\n        <div class="details">\n          <div class="welcome-title">OCD Relief</div>\n          <div class="welcome-heading">\n            Bring moments of relief to folks with OCD (Obsessive-compulsive disorder)\n            through a fun game of organizing messy desktop spaces.\n          </div>\n          <div class="welcome-heading">\n            Your time will start as soon as you close this window.\n            Before that check out the objectives and organize your\n            desktop space accordingly, before the time runs out.\n          </div>\n          <div class="welcome-heading">The 90\'s aesthetics is just a bonus.</div>\n\n          <div class="welcome-heading" style="margin-top: 30px">\n          Game dev: <a href="https://github.com/ishafayet" target="_blank">Sayem Shafayet</a><br>\n          Music by: <a href="https://www.linkedin.com/in/myshaazfar"  target="_blank">Mysha Azfar</a><br>\n          </div>\n\n          <div class="version">Version 0.0.1-POC</div>\n        </div>\n      </div>\n    </div>\n  </div>\n  '},addIcon=e=>{let t="?",i=`${e.name}.${e.extension}`;"dir"===e.type?(t="üìÅ",i=e.name):"recycle"===e.type?(t="üóëÔ∏è",i=e.name):["mp3","wav"].indexOf(e.extension)>-1?t="üéµ":["doc","docx","txt","pdf"].indexOf(e.extension)>-1&&(t="üìÑ");let n=VARS.desY+0,s=VARS.desX+0;document.querySelector(".work-area").innerHTML+=`\n    <div class="icon" style="top: ${n}px; left: ${s}px; z-index: 1;" data-id="${e.id}">\n      <div class="icon-graphic">${t}</div>\n      <div class="icon-label">${i}</div>\n    </div>\n  `},autoSort=e=>{let t=document.querySelectorAll(".icon");"id"===e&&Array.from(t).sort(((e,t)=>(idA=parseInt(e.getAttribute("data-id")),idB=parseInt(t.getAttribute("data-id")),idB-idA)));let i=0;for(let e=0;e<t.length;e++){let n=t[e];n.style.top=VARS.desY+i*CONSTS.iconDim+"px",n.style.left=VARS.desX+e%CONSTS.maxInARow*CONSTS.iconDim+"px",(e+1)%CONSTS.maxInARow==0&&(i+=1)}},prepareFiles=()=>{VARS.files.push({id:VARS.idSeed++,type:"recycle",extension:null,name:"Recycle Bin",originalName:"Recycle Bin",files:[]}),VARS.level.input.forEach((e=>{let t=VARS.idSeed++,i=e.split("/"),n=i.pop(),[s,l]=n.split("."),a=VARS;if(0!==i.length&&(a=VARS.files.find((e=>e.name===i[0])),!a))throw new Error(`Invalid parent ${e}`);l?a.files.push({id:t,type:"file",extension:l,name:s,originalName:s,files:null}):a.files.push({id:t,type:"dir",extension:null,name:s,originalName:s,files:[]})}))},prepareObjectives=()=>{VARS.objectives=VARS.level.objectives,VARS.objectives.forEach((e=>{e.status=!1}))},renderDesktop=()=>{VARS.files.forEach((e=>{addIcon(e)}))},findFileByEl=e=>{let t=parseInt(e.getAttribute("data-id"));return VARS.files.find((e=>e.id===t))},setupListeners=()=>{const e=()=>{VARS.movingElement.style.zIndex=1,VARS.movingElement.classList.remove("moving"),VARS.movingElement=null};document.querySelectorAll(".icon").forEach((t=>{t.addEventListener("dblclick",(e=>{if(0!==e.button)return;t.wasDoubleClick=!0;let i=findFileByEl(t);"file"!==i.type||alert(`No program is installed that can handle "${i.extension}" files. However, you can still move the file around, rename and delete.`)})),t.addEventListener("mousedown",(e=>{0===e.button&&2!==e.detail&&(VARS.movingElement||setTimeout((()=>{t.wasDoubleClick?t.wasDoubleClick=!1:(VARS.movingElement=t,VARS.movingElement.style.zIndex=2,VARS.movingElement.classList.add("moving"))}),200))})),t.addEventListener("mouseup",(i=>{if(0===i.button&&VARS.movingElement){i.preventDefault(),i.stopImmediatePropagation(),i.stopPropagation(),console.log("from el",t);let n=VARS.movingElement,s=t;if(e(),n===s)return;let l=parseInt(s.getAttribute("data-id")),a=parseInt(n.getAttribute("data-id")),o=VARS.files.find((e=>e.id===l)),d=VARS.files.find((e=>e.id===a));if("file"!==d.type||"dir"!==o.type&&"recycle"!==o.type)return void alert("Only files can be moved into folders");VARS.files.splice(VARS.files.indexOf(d),1),o.files.push(d),calculateObjectives(),n.parentNode.removeChild(n)}}))})),document.querySelector(".work-area").addEventListener("mousemove",(e=>{e.preventDefault(),0===e.button&&VARS.movingElement&&(VARS.movingElement.style.left=String(e.clientX+CONSTS.iconDim/4)+"px",VARS.movingElement.style.top=String(e.clientY+CONSTS.iconDim/4)+"px")})),document.querySelector(".work-area").addEventListener("mouseup",(t=>{0===t.button&&VARS.movingElement&&e()}))},updateClock=()=>{if(!(VARS.timeLeft<=0)){if(VARS.lastTime){let e=VARS.lastTime;VARS.lastTime=Date.now();let t=VARS.lastTime-e;VARS.timeLeft=(1e3*VARS.timeLeft-t)/1e3,document.querySelector(".time-left").innerHTML=Math.ceil(VARS.timeLeft)}else VARS.lastTime=Date.now();return VARS.timeLeft<=0&&(calculateObjectives(),"victory"!==VARS.status&&(VARS.status="defeat")),"victory"===VARS.status?(scope.playVictoryMusic(),void showVerdict()):"defeat"===VARS.status?(scope.playDefeatMusic(),void showVerdict()):void(VARS.timeout=setTimeout((()=>{updateClock()}),900))}},beginClock=()=>{scope.playMainMusic(),updateClock()},hideStartMenu=()=>{document.querySelector(".start-menu").classList.add("hidden")},showStartMenu=()=>{let e=document.querySelector(".start-menu");e.classList.remove("hidden"),e.style.top=String(VARS.desY+556)+"px",e.style.left=String(VARS.desX+4)+"px"},toggleStartMenu=()=>{document.querySelector(".start-menu").classList.contains("hidden")?showStartMenu():hideStartMenu()},hideObjectivesMenu=()=>{document.querySelector(".objectives-area").classList.add("hidden")},calculateObjectives=()=>{let e=document.querySelector(".objectives");e.innerHTML="";var t=0;VARS.objectives.forEach((i=>{i.status=i.testFn(VARS.files),i.status&&(t+=1),e.innerHTML+=`\n    <div class="objective-label">\n      ${i.status?"‚úîÔ∏è":"‚òê"} ${i.text}\n    </div>\n    `})),t===VARS.objectives.length&&(VARS.status="victory")},showObjectivesMenu=()=>{calculateObjectives();let e=document.querySelector(".objectives-area");e.classList.remove("hidden"),e.style.top=String(VARS.desY+280)+"px",e.style.left=String(VARS.desX+720-68)+"px"},toggleObjectivesMenu=()=>{let e=document.querySelector(".objectives-area");e.classList.contains("hidden")?showObjectivesMenu(e):hideObjectivesMenu(e)},closeWelcomeMenu=()=>{document.querySelector(".welcome-area").classList.add("hidden"),beginClock()},showWelcomeMenu=()=>{let e=document.querySelector(".welcome-area");e.classList.remove("hidden"),e.style.top=String(VARS.desY+140)+"px",e.style.left=String(VARS.desX+200)+"px"},toggleWelcomeMenu=()=>{let e=document.querySelector(".welcome-area");console.log(e),e.classList.contains("hidden")?showWelcomeMenu():closeWelcomeMenu()},sourceClicked=()=>{window.open("https://github.com/iShafayet/ocd-relief-js13k"),hideStartMenu()},startGameClicked=e=>{scope.startGame(e)},closeVerdict=()=>{document.querySelector(".verdict-area").classList.add("hidden"),beginClock()},showVerdict=()=>{let e=document.querySelector(".verdict-area");e.classList.remove("hidden"),"victory"===VARS.status?(e.classList.add("victory"),e.innerHTML="‚úåÔ∏è Victory!"):"defeat"===VARS.status&&(e.classList.add("defeat"),e.innerHTML="üòû Defeated..."),e.style.top=String(VARS.desY+250)+"px",e.style.left=String(VARS.desX+310)+"px"};scope.startGame=e=>{localStorage.setItem("ocd-relief-js13k--last-level",String(e)),VARS.timeout&&clearTimeout(VARS.timeout);let t=scope.levelList[e];initiateGameBoard(),setupVariables(t),prepareFiles(),prepareObjectives(),renderDesktop(),autoSort("id"),setupListeners(),console.debug(t),showWelcomeMenu()},document.addEventListener("DOMContentLoaded",(()=>{lastLevel=localStorage.getItem("ocd-relief-js13k--last-level"),lastLevel||(lastLevel="0"),lastLevel=parseInt(lastLevel),scope.startGame(lastLevel)}));let timeout=null;window.onresize=()=>{null==timeout&&(timeout=setTimeout((()=>{window.location.reload()}),500))}</script>