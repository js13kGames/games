<!doctype html><meta name=viewport content="width=device-width"><title>oh, flip! - js13kGames 2019</title><style>body,html{width:100%;height:100%;margin:0;border:0;overflow:hidden;display:block;background-color:#000}</style><center><div id=game><canvas id=canvas width=800 height=600 style=width:800px;height:600px></canvas></div></center><script>var t,e=document.getElementById("canvas"),a=e.getContext("2d",{alpha:!1}),i=e.width,o=e.height,n=-1,h=-1,l=0,r=0,s=0,f=0,d=1e3,c=0,p=!1,u=0,g=3,m=.5,w=!1,x=0,M=!1,F=0,b=0,I=0,v=!1,y=0,L=0,P=!1,T=0,D=0,S=0,E=.7,R=0,A=0,H=!1,k=0,C=0,q=!0,B=!1,W=[],K=[],Y=parseInt(localStorage.getItem("ohflip.goalIdx"))||0;K.push({text:"Do a flip",b:Q,a:1}),K.push({text:"Land 2 flips in a row",b:U,a:2}),K.push({text:"Land perfectly",b:function(){return v&&0<I},a:1}),K.push({text:"Reach a height of 20 ft",b:Z,a:20}),K.push({text:"Do a double flip",b:Q,a:2}),K.push({text:"Land 3 flips in a row",b:U,a:3}),K.push({text:"Land on your head",b:function(){return P},a:1}),K.push({text:"Do a triple flip",b:Q,a:3}),K.push({text:"Land perfectly 2 times in a row",b:V,a:2}),K.push({text:"Reach a height of 50 ft",b:Z,a:5}),K.push({text:"Land 4 flips in a row",b:U,a:4}),K.push({text:"Do a quad flip",b:Q,a:4}),K.push({text:"Land 5 flips in a row",b:U,a:5}),K.push({text:"Land perfectly 3 times in a row",b:V,a:3}),K.push({text:"Reach a height of 100 ft",b:Z,a:10}),K.push({text:"Do a x5 flip",b:Q,a:5}),K.push({text:"Land 10 flips in a row",b:U,a:10}),K.push({text:"Reach a height of 250 ft",b:Z,a:250}),K.push({text:"Land perfectly 5 times in a row",b:V,a:5}),K.push({text:"Do a x10 flip",b:Q,a:7}),K.push({text:"Reach a height of 500 ft",b:Z,a:500});var G=0;function X(t){k=t.pageX-e.offsetLeft,C=t.pageY-e.offsetTop}function j(){r=l=0,s=d=1e3,c=f=0,p=!1,S=D=u=0,E=.7,R=0,w=!1,G=I=b=F=0,v=!1,L=y=0,P=!1,T=0}function z(t,e,i,o,n){a.save(),a.strokeStyle="#000",a.lineWidth=n,a.beginPath(),a.moveTo(t,e),a.lineTo(i,o),a.stroke(),a.restore()}function J(t,e,i){t*=.5,e*=.5,a.save(),a.fillStyle=i,a.beginPath(),a.moveTo(-t,-e),a.lineTo(t,-e),a.lineTo(t,e),a.lineTo(-t,e),a.lineTo(-t,-e),a.fill(),a.restore()}function N(t,e,i,o,n,h,l){a.save(),a.translate(e,i),a.rotate(o),a.font="bold "+n+"px Arial",a.fillStyle=l,a.textAlign=h.toLowerCase(),a.fillText(t,0,0),a.restore()}function O(t,e,a,i,o){W.push({x:t,y:e,text:a,color:i,time:0,c:o||!1})}function Q(t){return I>=t.a}function U(t){return y>=t.a}function V(t){return L>=t.a}function Z(t){return Math.floor(T/40)>=t.a}document.addEventListener("mousedown",function(t){H=!0,X(t)},!1),document.addEventListener("mouseup",function(t){H=!1,X(t)},!1),document.addEventListener("touchstart",function(t){H=!0,X(t),t.preventDefault()},!1),document.addEventListener("touchend",function(t){H=!1,X(t),t.preventDefault()},!1),document.addEventListener("touchcancel",function(t){H=!1,X(t),t.preventDefault()},!1),document.addEventListener("keydown",function(t){t.altKey&&"KeyR"===t.code&&(localStorage.setItem("ohflip.maxHeightFt",0),localStorage.setItem("ohflip.maxTotalFlips",0),localStorage.setItem("ohflip.goalIdx",0),Y=0)}),j(),window.requestAnimationFrame(function X(Q){var U=Math.min((Q-(t||Q))/1e3,.2);t=Q,Q=e.width/e.height;var V=window.innerWidth,Z=window.innerWidth/Q;Z>window.innerHeight&&(V=(Z=window.innerHeight)*Q),V===n&&Z===h||(e.style.width=V+"px",e.style.height=Z+"px",n=V,h=Z),window.scrollTo(0,0),function(t){H?(B||(q&&(B=!0),q=!1),Y===K.length&&k>.5*e.width&&75>C&&(localStorage.setItem("ohflip.goalIdx",0),Y=0,j(),B=q=!0)):B=!1,W.forEach(function(e,a,i){e.time+=t,.5<=e.time&&i.splice(a,1)}),0<G&&0>=(G-=t)&&(Y++,localStorage.setItem("ohflip.goalIdx",Y))}(U),Q=H&&!B,w?(Q=x/1,l=400*Math.cos(Q*Math.PI*.5)*(M?-1:1)*d*.001,r=200*Math.sin(Q*Math.PI)*d*.001,f+=800*U*(M?-1:1),0>=(x-=U)&&j()):(Q&&100<r?(p=!1,c+=.1*(720-c)):(p&&(f*=.8,.01>Math.abs(f)&&(p=!1)),c*=.7),Q=f,u+=(f+=c*U)-Q,Q=b,(b=Math.floor((u+90)/360))>Q&&O(.5*e.width+100,e.height-200,"x"+b,"#D37CFF"),180<=f?f-=360:-180>f&&(f+=360),r+=(s+=-1400*U)*U,T=Math.max(r,T),0>=r&&(D=16,S=0,30<Math.abs(f)?(w=!0,x=1,M=.5>Math.random(),O(.5*e.width+100,e.height-100,"miss","#F42"),145<Math.abs(f)&&(P=!0)):(Q=270<=u,v=6.5>Math.abs(f),d=Q?d+(v?180:120)*(1+b/5*.5):Math.max(d-120,1e3),Q&&v&&!q&&(A=.025),Q?(I=b,F+=b,y++,v&&L++,v?O(.5*e.width+100,e.height-100,"perfect!","#FF0"):O(.5*e.width+100,e.height-100,"good","#0F4")):L=y=0),Y<K.length&&K[Y].b(K[Y])&&(O(e.width-100,120,"complete!","#FF0",!0),G=1,L=y=0),r=0,s=d,p=!0,b=I=u=0,P=!1,T=0),m-=U,0>=(g-=U)&&(g=1+3*Math.random(),m=.1+.1*Math.random())),Q=280/Math.max(r,280)*1.5,R=Q<E?3:R-U,.5>(Q=Math.min(E,Q))&&(Q=Math.pow(Q,.97)),E+=.2*(Q-E),0>=R&&(E+=.001*(.7-E)),A*=.8,D*=.9,S+=4e3*U,a.save(),a.setTransform(1,0,0,1,0,0),a.fillStyle="#AADDFF",a.fillRect(0,0,e.width,e.height),a.restore(),a.save(),a.scale(E+A,E+A),i=e.width/(E+A),o=e.height/(E+A),a.translate(.5*(i-e.width),o-e.height),a.save(),a.translate(.5*e.width,e.height-120),J(i,240,"#00D846"),z(-196,-20,-196,80,12),z(196,-20,196,80,12),a.translate(0,Math.sin(S*Math.PI/180)*D),z(-200,0,200,0,12),a.restore(),a.save(),a.translate(.5*e.width+l,e.height-170-r),a.rotate(f*Math.PI/180),a.translate(0,-40),J(80,96,"#FF9600"),a.save(),0<m||w?(a.translate(-4,4),J(40,40,"#000"),a.translate(4,4),J(34,34,"#FF9600"),a.translate(-12,0)):(a.translate(-4,4),J(40,40,"#FFF"),a.translate(-8,4-7*Math.max(Math.min(s/1e3,1),0)),J(16,24,"#000")),a.restore(),a.translate(-4,4),!H||B?(a.translate(8,40),z(0,0,0,60,8)):(a.translate(8,40),z(0,0,-30,20,8),z(-30,20,0,40,8)),a.restore(),function(){if(a.save(),a.setTransform(1,0,0,1,0,0),q)N("oh, flip!",.5*e.width,160,-5*Math.PI/180,170,"center","#000"),N("oh, flip!",.5*e.width-10,155,-5*Math.PI/180,170,"center","#FF9600"),N("a game about backflips",.5*e.width,240,-5*Math.PI/180,50,"center","#000"),N("a game about backflips",.5*e.width-4,235,-5*Math.PI/180,50,"center","#FFF"),N("land flips to gain height - complete goals to feel good",.5*e.width,e.height-20,0,25,"center","#000"),N("land flips to gain height - complete goals to feel good",.5*e.width-3,e.height-23,0,25,"center","#FFF");else{var t=Math.floor(r/40),i=localStorage.getItem("ohflip.maxHeightFt");(null===i||t>i)&&(localStorage.setItem("ohflip.maxHeightFt",t),i=t),N("Height: "+t+" ft (Best: "+i+" ft)",12,27,0,20,"left","#000"),(null===(t=localStorage.getItem("ohflip.maxTotalFlips"))||F>t)&&(localStorage.setItem("ohflip.maxTotalFlips",F),t=F),N("Flips: "+F+" (Best: "+t+")",12,50,0,20,"left","#000"),t="#000",0<G&&(t=.075>G%.15?"#000":"#00FF00"),Y<K.length?(N("Goal #"+(Y+1)+":",e.width-12,27,0,20,"right",t),N(K[Y].text,e.width-12,50,0,20,"right",t)):(t=400>Date.now()%800?"#000":"#FF9600",N("Congratulations! You've completed all goals!",e.width-12,27,0,20,"right",t),N("Press here to reset and play again!",e.width-12,50,0,20,"right",t))}W.forEach(function(t){var e=Math.min(t.time/.1,1),a=Math.min(t.time/.4,1),i=25*Math.sin(a*Math.PI*.5);a=50*Math.sin(a*Math.PI*.5);var o=t.c?20:30,n=t.c?10:25;N(t.text,t.x+i,t.y-a,-5*Math.PI/180,o+Math.sin(e*Math.PI*.75)*n,"center","#000"),N(t.text,t.x+i-3,t.y-a-3,-5*Math.PI/180,o+Math.sin(e*Math.PI*.75)*n,"center",t.color)}),a.restore()}(),a.restore(),window.requestAnimationFrame(X)})</script>