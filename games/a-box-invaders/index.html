<!doctype html><title>A-box INVADERS</title><style>.screen,body{background-color:#000}.screen{position:relative;width:100%;height:100%;z-index:99999;text-align:center;padding-top:15%;color:#fff;font-family:monospace}.end-screen{display:none}.title{font-weight:700;font-size:110px;text-shadow:1px 1px #ef2d5e,2px 2px #ef2d5e,3px 3px #ef2d5e}.end,.start{font-weight:700;margin-top:45px;font-size:35px}.instructions{margin-top:45px;font-size:20px}.blink{animation:blink 2.5s linear infinite}@keyframes blink{0%,100%{opacity:0}50%{opacity:1}}.end a{color:#ef2d5e;text-decoration:none}.end a::hover{text-decoration:underline}</style><script src=/2017/webxr/aframe.js></script><script>AFRAME.registerComponent("spawner",{schema:{on:{default:"click"},mixin:{default:""}},update:function(){var e=this.el,t=this.spawn.bind(this);this.on!==this.data.on&&(e.removeEventListener(this.on,t),e.addEventListener(this.data.on,t),this.on=this.data.on)},spawn:function(){var e=this.el,t=e.object3D.matrixWorld,i=new THREE.Vector3;i.setFromMatrixPosition(t);var n=document.createElement("a-entity");n.setAttribute("position",i),n.setAttribute("mixin",this.data.mixin),e.sceneEl.appendChild(n)}}),AFRAME.registerComponent("laser-behavior",{schema:{speed:{default:.2}},init:function(){this.el.sceneEl.addBehavior(this)},tick:function(){this.el.object3D.translateY(this.data.speed)}}),AFRAME.registerComponent("collider",{schema:{},init:function(){this.el.sceneEl.addBehavior(this)},tick:function(){for(var e=this.el.sceneEl,t=this.el.getObject3D("mesh"),i=this.el.object3D,n=this.el.object3D.position.clone(),o=0;o<t.geometry.vertices.length;o++){var a=t.geometry.vertices[o].clone().applyMatrix4(i.matrix).sub(i.position);new THREE.Raycaster(n,a.clone().normalize()).intersectObjects(e.object3D.children,!0).forEach(s)}function s(e){if(e.object!==i&&e.distance<a.length()){if(!e.object.el)return;e.object.el.emit("hit")}}}}),AFRAME.registerComponent("explode",{schema:{on:{default:""}},update:function(e){var t=this.el,i=this.handler=this.explode.bind(this);e&&t.removeEventListener(e.on,i),t.addEventListener(this.data.on,i)},explode:function(){function e(){t.remove(o),i.remove(t)}var t=this.el.getObject3D("mesh"),i=this.el.sceneEl.object3D,n=8e3,o=function(e,t){var i=new THREE.Group;(t=t.clone()).side=THREE.DoubleSide;for(var n=0;n<e.faces.length;n++){var o=e.faces[n],a=e.vertices[o.a].clone(),s=e.vertices[o.b].clone(),r=e.vertices[o.c].clone(),c=new THREE.Geometry;c.vertices.push(a,s,r),c.faces.push(new THREE.Face3(0,1,2));var l=new THREE.Mesh(c,t);l.position.sub(c.center()),i.add(l)}return i.children.sort((function(e,t){return e.position.z-t.position.z})),i.rotation.set(0,0,0),i}(t.geometry,t.material);t.material.visible=!1;for(var a=0;a<o.children.length;a++){var s=o.children[a];s.geometry.computeFaceNormals();var r=s.geometry.faces[0].normal.clone(),c=s.position.clone().add(r.multiplyScalar(300));new TWEEN.Tween(s.position).to(c,n).onComplete(e).start(),s.material.opacity=0,new TWEEN.Tween(s.material).to({opacity:1},n).start();var l=2*Math.PI,h={x:l,y:l,z:l};new TWEEN.Tween(s.rotation).to(h,n).start()}t.add(o),this.el.removeEventListener(this.data.on,this.handler)}})</script><div class="screen title-screen"><div class=title>A-box INVADERS</div><div class="blink start">Click to Start</div><div class=instructions>AD keys to move and click to shoot<br><small>Proudly based on <a href=//github.com/dmarcos/a-invaders>A-Invaders</a></small></div></div><div class="screen end-screen"><div class=end>Congratulations you saved the world!</div><div class=end>Made with <a href=//www.aframevr.io>A-FRAME</a></div></div><a-scene><a-assets><a-mixin id=cube geometry="primitive: box; buffer: false; height: 2; width: 2; depth: 2;" material="color: #167341; roughness: 1.0; metalness: 0.2;"></a-mixin><a-mixin id=laser geometry="primitive: box; buffer: false; height: 2; width: 0.1; depth: 0.1" material="color: yellow;" collider laser-behavior></a-mixin><a-mixin id=enemy explode="on: hit"></a-mixin></a-assets><a-entity position="0 0 20"><a-entity camera="fov: 45"></a-entity></a-entity><a-text height=10 id=score position="-10 7 0" value="Score: 0" width=10></a-text><a-entity position="-17.5 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="-17.5 5 -10" repeat=indefinite to="-19 5 -10"></a-animation></a-entity><a-entity position="-14 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="-14 5 -10" repeat=indefinite to="-15.5 5 -10"></a-animation></a-entity><a-entity position="-10.5 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="-10.5 5 -10" repeat=indefinite to="-12 5 -10"></a-animation></a-entity><a-entity position="-7 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="-7 5 -10" repeat=indefinite to="-8.5 5 -10"></a-animation></a-entity><a-entity position="-3.5 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="-3.5 5 -10" repeat=indefinite to="-5 5 -10"></a-animation></a-entity><a-entity position="0 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="0 5 -10" repeat=indefinite to="-1.5 5 -10"></a-animation></a-entity><a-entity position="3.5 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="3.5 5 -10" repeat=indefinite to="2 5 -10"></a-animation></a-entity><a-entity position="7 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="7 5 -10" repeat=indefinite to="5.5 5 -10"></a-animation></a-entity><a-entity position="10.5 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="10.5 5 -10" repeat=indefinite to="9 5 -10"></a-animation></a-entity><a-entity position="14 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="14 5 -10" repeat=indefinite to="12.5 5 -10"></a-animation></a-entity><a-entity position="17.5 5 -10" mixin="cube enemy" material="color: red"><a-animation attribute=position direction=alternate dur=1500 from="17.5 5 -10" repeat=indefinite to="16 5 -10"></a-animation></a-entity><a-entity position="0 -10 -10" mixin=cube cursor spawner="mixin: laser; on: mousedown" wasd-controls="acceleration: 400; wsEnabled: false"></a-entity></a-scene><script>var titleEl=document.querySelector(".title-screen"),endEl=document.querySelector(".end-screen"),enemies=document.querySelectorAll('[mixin="cube enemy"]'),deadEnemies=[],scoreEl=document.getElementById("score"),score=0,increaseCounter=function(e){var n=e.currentTarget;-1==deadEnemies.indexOf(n)&&(deadEnemies.push(n),score+=1,scoreEl.setAttribute("value","Score: "+score),enemies.length===deadEnemies.length&&(endEl.style.display="block"))};titleEl.addEventListener("click",(function(){titleEl.style.display="none"})),(enemies=Array.prototype.slice.call(enemies)).forEach((function(e){e.addEventListener("hit",increaseCounter)}))</script>