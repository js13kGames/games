<!doctype html><title>Glitchy Control</title><meta name=description content="Eat the blops to stay alive. Don't Starve!"><meta name=viewport content="width=device-width"><style>*{margin:0;padding:0;font-family:sans-serif}body,html{width:100%;height:100%;overflow:hidden}canvas{display:block}#start{text-align:center}#start>h1{color:#5f9ea0;font-size:32pt;margin-top:100px;margin-top:20vh}#instructions{position:absolute;top:40vh;left:0;right:0;bottom:100px;height:30px;font-size:16pt}#dev-note{position:absolute;bottom:10px;left:0;right:0;font-size:16pt}#dev-note>a{text-decoration:none;color:#5f9ea0}#start_button{width:200px;padding:10px;font-size:20pt;border-radius:10px;background-color:#5f9ea0;color:#fff;margin:auto;cursor:pointer;position:absolute;left:0;top:0;right:0;bottom:0;height:30px}#game_over{position:absolute;top:60vh;font-size:16pt;left:0;right:0}#content{font-size:20pt}</style><div id=main><header id=start><h1>Glitchy Control</h1><div id=game_over></div><p id=instructions>Eat the blops to stay alive. Don't Starve!<div id=start_button onclick=Awake()>Play</div><p id=dev-note>Developed by <a target=_blank href=https://twitter.com/StefanBlamberg>@StefanBlamberg</a> for <a target=_blank href=https://twitter.com/hashtag/js13k>js13kGames 2016</a></header><div id=content style=display:none><div style=position:fixed>Score : <span id=score_info style=color:green>0</span></div><canvas id=game width=900 height=1200></canvas></div></div><script>var w,h,m,in_m,timeout,c=document.getElementById("game"),ctx=c.getContext("2d"),player={name:"Stefan",score:0,highscore:localStorage.getItem("bb_js13_hs")||0,pos:[0,0],c:"#FFFFFF",s:"#000000",mouse:[0,0],speed:3,inverted:[0,0],power:30,init_power:30},game={food:[],nbr:3,lifetime:5,difficulty:1},lost=!1,init_p=clone(player),init_g=clone(game);function Awake(){lost&&location.reload(),document.getElementById("start").style.display="none",document.getElementById("content").style.display="block",c.width=document.body.clientWidth,c.height=document.body.clientHeight,canvasW=c.width,canvasH=c.height,c.style.width=window.innerWidth+"px",c.style.height=window.innerHeight+"px",w=c.width,h=c.height,m=in_m=h<w?h/10:w/10;var e=randomColor();player.c=e[0],player.s=e[1],player.pos=[w/2,h/2],player.mouse=[w/2,h/2];for(var o=0;o<game.nbr;o++)game.food.push(SpawnFood());Update()}function SpawnFood(){var e={x:Math.floor(Math.random()*(w-5)+5),y:Math.floor(Math.random()*(h-5)+5),r:10,lifetime:game.lifetime};return e.x>player.pos[0]-m/2&&e.x<player.pos[0]+m/2&&(e.x+=m),e.y>player.pos[1]-m/2&&e.y<player.pos[1]+m/2&&(e.y+=m),e.col=randomColor()[0],e}function Update(){ctx.clearRect(0,0,c.width,c.height);var e=player.mouse[0]-player.pos[0],o=player.mouse[1]-player.pos[1];if(m=in_m*player.power/player.init_power,!(Math.abs(e)<=5&&Math.abs(o)<=5)){var t=Math.abs(e)>Math.abs(o)?1:Math.abs(e)/Math.abs(o),a=Math.abs(o)>Math.abs(e)?1:Math.abs(o)/Math.abs(e),r=Math.sign(e)*(1-2*player.inverted[0]),l=Math.sign(o)*(1-2*player.inverted[1]);player.pos[0]+=player.speed*t*r,player.pos[0]<m/2&&(player.pos[0]=m/2),player.pos[0]>w-m/2&&(player.pos[0]=w-m/2),player.pos[1]+=player.speed*a*l,player.pos[1]<m/2&&(player.pos[1]=m/2),player.pos[1]>h-m/2&&(player.pos[1]=h-m/2)}if(ctx.beginPath(),ctx.fillStyle=player.c,ctx.strokeStyle=player.s,ctx.arc(player.pos[0],player.pos[1],m/2,0,2*Math.PI),ctx.lineWidth=m/7,ctx.stroke(),ctx.fill(),ctx.closePath(),player.power-=.017*game.difficulty,player.power<=0)gameover();else{for(var n=0;n<game.food.length;n++){var i=player.pos[0]-game.food[n].x,s=player.pos[1]-game.food[n].y;Math.sqrt(i*i+s*s)<m/2+game.food[n].r&&(player.score++,game.food[n]=SpawnFood(),player.inverted=[Math.round(Math.random()),Math.round(Math.random())],player.power+=1,document.getElementById("score_info").innerHTML=player.score),ctx.beginPath(),ctx.fillStyle=game.food[n].col,ctx.strokeStyle=game.food[n].col,ctx.arc(game.food[n].x,game.food[n].y,game.food[n].r,0,2*Math.PI),ctx.lineWidth=2,ctx.closePath(),ctx.stroke(),ctx.beginPath(),ctx.arc(game.food[n].x,game.food[n].y,game.food[n].r-1,0,game.food[n].lifetime/(game.lifetime/2)*Math.PI),ctx.lineTo(game.food[n].x,game.food[n].y),ctx.fill(),ctx.closePath(),game.food[n].lifetime-=.017,game.food[n].lifetime<=0&&(game.food[n]=SpawnFood())}timeout=setTimeout(Update,17)}}function randomColor(){var e=16777215*Math.random()<<0;return["#"+e.toString(16),"#"+((8289918&e)>>1|8421504&e).toString(16)]}function gameover(){var e="<span style='font-size: 1.2em;'>Game Over. Your score: "+player.score+"</span>";player.score>player.highscore?(player.highscore=player.score,e+="<br>New Highscore",localStorage.setItem("bb_js13_hs",player.highscore)):e+="<br>Highscore: "+player.highscore,document.getElementById("game_over").innerHTML=e,document.getElementById("start").style.display="block",document.getElementById("content").style.display="none",player=init_p,game=init_g,lost=!0}function getMousePosition(e,o){var t=e.getBoundingClientRect();return{x:o.clientX-t.left,y:o.clientY-t.top}}function clone(e){if(null==e||"object"!=typeof e)return e;var o=e.constructor();for(var t in e)e.hasOwnProperty(t)&&(o[t]=e[t]);return o}c.addEventListener("mousemove",(function(e){var o=getMousePosition(c,e);player.mouse=[o.x,o.y]}),!1)</script>