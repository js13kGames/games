<!doctype html><title>Block Hammer</title><style>body{background:url("bg.gif")}canvas{padding-left:0;padding-right:0;margin-left:auto;margin-right:auto;display:block;border:1px solid #000}#ins{text-align:center;color:Red}</style><br><canvas height=850 id=canvas width=425><script>function ang2Rad(t){return t*(Math.PI/180)}const Part=function(t,e,i){this.x=t,this.y=e,this.xS=7*Math.random()-5,this.yS=10*Math.random()-10,this.lifeTime=0,this.update=function(){this.lifeTime++,this.x+=this.xS,this.y+=this.yS,this.yS+=1},this.draw=function(){ctx.fillStyle="orange",ctx.fillRect(this.x,this.y,2,2)}},Boom=function(t,e,i){this.x=t,this.y=e,this.parts=[];for(var s=0;s<i;s++)this.parts.push(new Part(this.x,this.y,30));this.draw=function(){for(var t=0;t<this.parts.length;t++)this.parts[t].update(),this.parts[t].draw()}},Player=function(t,e){this.x=t,this.y=e,this.g=c.width/2-15,this.a=0,this.s=6,this.clockWise=!0,this.update=function(){Math.abs(this.s)>0&&(this.s+=this.s>0?-.01:.01),keys.left&&!keys.right&&(this.clockWise=!1),keys.right&&!keys.left&&(this.clockWise=!0),pause||(this.a+=this.clockWise?this.s%360:-this.s%360)},this.draw=function(){ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(ang2Rad(this.a)),ctx.fillStyle="rgb(0,0,255)",ctx.translate(-this.x,-this.y),ctx.fillRect(this.x-10,this.y-this.g-5,20,10),ctx.fillRect(this.x-10,this.y+this.g-5,20,10),ctx.restore()}},Block=function(t){this.maxSpeed=t,this.s=Math.random()*t+2,this.h=20*Math.random()+10,this.w=10*Math.random()+5,this.x=Math.random()*(c.width-this.w),this.y=-2*this.h*level-100*this.s,this.update=function(){pause||(this.y+=this.s),this.y-this.h>c.height&&(this.score(-1),hitsInARow=0,scoreMultiplyer=1,playNote(!1,1))},this.score=function(t){t>0&&(boom=new Boom(this.x,this.y,30)),score+=t,this.x=Math.random()*(c.width-this.w),this.s=Math.random()*this.maxSpeed+1,this.h=20*Math.random()+10,this.w=10*Math.random()+5,this.y=0-this.h},this.draw=function(){ctx.fillStyle="Red",ctx.fillRect(this.x,this.y,this.w,this.h)},this.checkCollision=function(){for(var t=ctx.getImageData(this.x,this.y,this.w,this.h),e=!1,i=0;i<t.data.length;i+=4)0==t.data[i]&&0==t.data[i+1]&&255==t.data[i+2]&&(e=!0);return e}};function kDown(t){p.s=6,"ArrowLeft"==t.code&&(keys.left=!0),"ArrowRight"==t.code&&(keys.right=!0),pause=!1}function kUp(t){"ArrowLeft"==t.code&&(keys.left=!1),"ArrowRight"==t.code&&(keys.right=!1)}function canvasClicked(t){0==gameState?(null==audioCtx&&(audioCtx=new AudioContext,osc=audioCtx.createOscillator(),osc.type="sawtooth",gain=audioCtx.createGain(),osc.connect(gain),gain.connect(audioCtx.destination),osc.start(0),gain.gain.value=0),level=2,startGame(),gameState++):1==gameState&&(p.s=6,p.clockWise=!p.clockWise)}function playNote(t,e){index=Math.floor(Math.random()*notes.length),gain.gain.value=.4,osc.frequency.value=t?notes[index]:badNotes[index],gain.gain.setTargetAtTime(1e-5,audioCtx.currentTime,e)}function startGame(){hitsInARow=0,scoreMultiplyer=1,score=0,b=[];var t=1.05*level;t>6&&(t=6);for(var e=0;e<level;e++)b.push(new Block(t))}function makeMenu(){ctx.fillStyle="black",ctx.fillRect(0,0,c.width,c.height),ctx.fillStyle="White",ctx.fillText("Directions!",115,80),ctx.fillText("Level:"+(level-1),c.width-150,35),ctx.font="15px Courier New",ctx.fillText("Left and Right arrows or mouse / tap to",20,100),ctx.fillText("change the direction of the hammers! Your",20,115),ctx.fillText("goal is to hit the blocks to gain points.",20,130),ctx.fillText("If a block passes the bottom of the screen",20,145),ctx.fillText("your score will go BACKwards. If your score",20,160),ctx.fillText("reaches -2 you will start BACK at level 1.",20,175),ctx.fillText("Try to get to the highest level!",20,190),ctx.font="30px Courier New",ctx.fillText("Click to Start",90,c.height-50)}function update(){switch(gameState){case 0:makeMenu();break;case 1:score<=-2&&(gameState=0),score>3*level&&(level++,startGame()),ctx.fillStyle="Black",ctx.fillRect(0,0,c.width,c.height),ctx.fillStyle="White",ctx.fillText("Score:"+score,10,35),ctx.fillText(scoreMultiplyer+"X",10,70),ctx.fillText("Level:"+(level-1),c.width-150,35),p.update(),p.draw(),boom.draw();for(var t=0;t<b.length;t++)b[t].checkCollision()&&(hitsInARow++,hitsInARow>scoreMultiplyer&&scoreMultiplyer++,b[t].score(1*scoreMultiplyer),playNote(!0,.25)),b[t].update(),b[t].draw()}}window.onload=function(){audioCtx=null,level=2,gameState=0,pause=!1,c=document.getElementById("canvas"),ctx=c.getContext("2d"),ctx.font="30px Courier New",p=new Player(c.width/2,c.height-c.width/2),keys={left:!1,right:!1},document.addEventListener("keydown",kDown),document.addEventListener("keyup",kUp),c.addEventListener("mousedown",canvasClicked),setInterval(update,1e3/30),badNotes=[220,246.9,138.6,146.8,164.8,185,207.7],notes=[440,493.9,277.2,293.7,329.6,370,415.3],boom=new Boom(c.width/2,c.height/2,5)}</script>