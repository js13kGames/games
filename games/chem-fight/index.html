<!doctype html><title>Chem Fight - js13kGames 2012</title><style>body{font:12px 'Lucida Sans Unicode','Lucida Grande',sans-serif;color:#fe0;background-color:#000}#knownCompoundList ul{list-style:none;margin-left:0;padding-left:1em;text-indent:-1em}#knownCompoundList ul li:before{content:"\00BB \0020"}</style><script>function SetupCF(){window.name="chemfight-home",SetupChemFight()}</script><body onload=SetupCF()><table><tr><td colspan=2><p style=text-align:center>Welcome to Chem Fight HTML 5 Chemistry Battle Game<br>Purchase Atoms for attack and defense by spending "Atom Bucks"<br>Battles are decided based on if a known compound will be formed between the attacker and the defenders.<br>After each round, players are given a number of Atom Bucks for surviving the round.<br><tr><td><div id=gameElementsContainer style=position:relative;width:960px;height:640px><div id=canvasContainer style=position:relative></div><div id=canvasMouseHitDetector style=position:absolute;top:10px;left:10px;width:940px;height:620px;z-index:1000;background-color:#000;opacity:0></div></div><td><div id=chemFightInfo><span>Known Compounds:</span><div id=knownCompoundList style=height:620px;overflow:auto></div></div><tr><td colspan=2><p>Tips:<ul><li>Elements with higher atomic numbers are generally better for attacking, elements with lower atomic number are generally better for defense.<li>When choosing defenders, you will not know the exact element the opponent is attacking with but you will know the number of valence electrons.<li>Typically, compounds will form when the combined valence electrons of the atoms fill the outer electron shells (i.e. 2 or 8 total electrons).</ul><p style=color:#fff;text-align:center>Chem Fight was created by <a href=//mattpalmerlee.com>Matt Palmerlee</a> of <a href=//masteredsoftware.com>Mastered Software</a> for the <a href=//js13kgames.com>js13KGames</a> competition.</table><script>!function(){var h=!1,a=/xyz/.test(function(){})?/\b_super\b/:/.*/;this.Class=function(){},Class.extend=function(i){function t(){!h&&this.init&&this.init.apply(this,arguments)}var e,n=this.prototype,s=(h=!0,new this);for(e in h=!1,i)s[e]="function"==typeof i[e]&&"function"==typeof n[e]&&a.test(i[e])?function(e,s){return function(){var i=this._super,t=(this._super=n[e],s.apply(this,arguments));return this._super=i,t}}(e,i[e]):i[e];return t.prototype=s,(t.constructor=t).extend=arguments.callee,t}}(),(Stratiscape=function(i){this.layers=[],this.layersByName={},this.container=document.getElementById(i.containerId);var t=this.container.innerHTML;if(document.createElement("canvas").getContext){for(var e in this.canvasSupported=!0,i.layers.sort(this.layerSortFunction),i.layers){var s=i.layers[e],n=(0<=s.zIndex?Stratiscape.Global.layerNextZIndex<=s.zIndex&&(Stratiscape.Global.layerNextZIndex=s.zIndex+1):s.zIndex=Stratiscape.Global.layerNextZIndex++,"lyr_"+s.name+s.zIndex);t+='<canvas id="'+n+'" width="'+s.width+'" height="'+s.height+'" style="position:absolute;left:'+s.x+"px;top:"+s.y+"px;z-index:"+s.zIndex+";"+(s.backgroundColor?"background-color:"+s.backgroundColor+";":"")+'"></canvas>'}for(e in this.container.innerHTML=t,i.layers)n="lyr_"+(s=i.layers[e]).name+s.zIndex,s.mouseHitId&&(t=document.getElementById(s.mouseHitId),s.clickCallback&&(t.layerConfig=s,Stratiscape.Global.onEvent(t,"click",function(i){var t=Stratiscape.Global.getCursorPosition(i);(i.srcElement||i.target).layerConfig.clickCallback(t)})),s.dblclickCallback)&&(t.layerConfig=s,Stratiscape.Global.onEvent(t,"dblclick",function(i){var t=Stratiscape.Global.getCursorPosition(i);(i.srcElement||i.target).layerConfig.dblclickCallback(t)})),s=new Stratiscape.Layer(n,s.name,s.x,s.y,s.width,s.height,s.zIndex),this.layers.push(s),this.layersByName[s.name]=s}else this.canvasSupported=!1,i.canvasNotSupportedCallback&&i.canvasNotSupportedCallback()}).Global={layerNextZIndex:1},Stratiscape.Global.getCursorPosition=function(i){var t={x:null,y:null};for(null!=i.pageX&&null!=i.pageY?(t.x=i.pageX,t.y=i.pageY):(t.x=i.clientX+document.body.scrollLeft+document.documentElement.scrollLeft,t.y=i.clientY+document.body.scrollTop+document.documentElement.scrollTop),i=i.srcElement||i.target;t.x-=i.offsetLeft||0,t.y-=i.offsetTop||0,i=i.offsetParent;);return t},Stratiscape.Global.onEvent=function(i,t,e){i.addEventListener?i.addEventListener(t,e,!1):i.attachEvent&&i.attachEvent("on"+t,e)},Stratiscape.prototype.getLayer=function(i){return this.layersByName[i]||null},Stratiscape.prototype.draw=function(){for(var i in this.layers)this.layers[i].needsDisplay&&this.layers[i].draw()},Stratiscape.prototype.layerSortFunction=function(i,t){return i.zIndex>t.zIndex?1:i.zIndex<t.zIndex?-1:0},Stratiscape.Layer=function(i,t,e,s,n,h,a){this.name=t,this.x=e,this.y=s,this.width=n,this.height=h,this.zIndex=a,this.children=[],this.needsDisplay=!1,this.canvas=document.getElementById(i),this.ctx=this.canvas.getContext("2d")},Stratiscape.Layer.prototype.draw=function(){for(var i in this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.children)"function"==typeof this.children[i].draw&&this.children[i].draw(this.ctx);this.needsDisplay=!1},Stratiscape.Layer.prototype.isInBounds=function(i,t){return this.x<=i&&this.y<=t&&this.x+this.width>=i&&this.y+this.height>=t},Stratiscape.Layer.prototype.addChild=function(i){(i.layer=this).children.push(i),this.needsDisplay=!0},Stratiscape.Layer.prototype.removeChild=function(i){var t=this.children.indexOf(i);-1!=t&&(i.layer=null,this.children.splice(t,1),this.needsDisplay=!0)},Stratiscape.DrawnObject=Class.extend({init:function(){this.y=this.x=0,this.layer=null},draw:function(){},isInBounds:function(){return!1}});var x=null,C=x;function e(i,t){return"number"==typeof t&&(t<i?1:i<t?-1:0)}function S(i,t){return t!==x&&void 0!==t||(t=i,i=0),i<0?t+=Math.abs(i):t-=i,Math.floor(Math.random()*t)+i}function m(i,t){return e(t.i.length,i.i.length)}function y(i,t){return e(t.X,i.X)}function o(i){var t,e=0;for(t in i)e+=i[t].b;return e}function b(i,t){return t in i?i[t]:0}function R(i,t){var e,s=[];for(e in C.a){var n,h=C.a[e];for(n in h.z){var a=h.z[n];if(a.i==i.i){s.push(h);break}}}for(e=s.length-1;0<=e;e--)for(n in(h=s[e]).z){if((a=h.z[n]).i==i.i){if(1==a.count)continue;if(b(t,a.b)>=a.count-1)continue}else if(b(t,a.b)>=a.count)continue;s.splice(e,1);break}return s}function n(i,t,e,s){this.u=i,this.j=t,this.ga=e,this.Y=s}function g(){for(var i in this.m=this.a=this.c=x,this.m={},this.m[0]=new u("Non-Metals","#0F0"),this.m[1]=new u("Noble gases","#09F"),this.m[2]=new u("Alkali Metals","#F90"),this.m[3]=new u("Alkaline earth metals","#FE0"),this.m[4]=new u("Metalloids","#9C9"),this.m[5]=new u("Halogens","#0F9"),this.m[6]=new u("Post-transition metals","#CCC"),this.c=[],this.c.push(new c("H","Hydrogen",1,1)),this.c.push(new c("He","Helium",2,2)),this.c.push(new c("Li","Lithium",3,1)),this.c.push(new c("Be","Beryllium",4,2)),this.c.push(new c("B","Boron",5,3)),this.c.push(new c("C","Carbon",6,4)),this.c.push(new c("N","Nitrogen",7,5)),this.c.push(new c("O","Oxygen",8,6)),this.c.push(new c("F","Fluorine",9,7)),this.c.push(new c("Ne","Neon",10,8)),this.c.push(new c("Na","Sodium",11,1)),this.c.push(new c("Mg","Magnesium",12,2)),this.c.push(new c("Al","Aluminum",13,3)),this.c.push(new c("Si","Silicon",14,4)),this.c.push(new c("P","Phosphorus",15,5)),this.c.push(new c("S","Sulfur",16,6)),this.c.push(new c("Cl","Chlorine",17,7)),this.c.push(new c("Ar","Argon",18,8)),this.c.push(new c("K","Potassium",19,1)),this.c.push(new c("Ca","Calcium",20,2)),this.a=[],this.a.push(new d("AlBO","aluminium boron oxide")),this.a.push(new d("AlBO2","aluminium borate")),this.a.push(new d("AlCl","aluminium monochloride")),this.a.push(new d("AlClF","aluminium chloride fluoride")),this.a.push(new d("AlClF2","aluminium chloride fluoride")),this.a.push(new d("AlClO","aluminium chloride oxide")),this.a.push(new d("AlCl2F","aluminium chloride fluoride")),this.a.push(new d("AlF","aluminium monofluoride")),this.a.push(new d("AlFO","aluminium monofluoride monoxide")),this.a.push(new d("AlF2","aluminium difluoride")),this.a.push(new d("AlF2O","aluminium difluoride oxide")),this.a.push(new d("AlF3","aluminium trifluoride")),this.a.push(new d("AlF4Li","lithium tetrafluoroaluminate")),this.a.push(new d("AlLiO2","lithium aluminate")),this.a.push(new d("AlN","aluminium nitride")),this.a.push(new d("AlNaO2","sodium aluminate")),this.a.push(new d("AlO","aluminium monoxide")),this.a.push(new d("AlOSi","aluminium silicon monoxide")),this.a.push(new d("AlO2","Aluminium(IV) oxide")),this.a.push(new d("AlP","aluminium monophosphide")),this.a.push(new d("AlPO4","aluminium phosphate")),this.a.push(new d("Al2O","dialuminium monoxide")),this.a.push(new d("Al2O2","dialuminium dioxide")),this.a.push(new d("Al2O3","aluminium oxide")),this.a.push(new d("Al2S","dialuminium monosulfide")),this.a.push(new d("ArClF","argon chloride fluoride")),this.a.push(new d("ArClH","argon chloride hydride")),this.a.push(new d("ArFH","argon fluoride hydride")),this.a.push(new d("BCl3","boron trichloride")),this.a.push(new d("BF3","boron trifluoride")),this.a.push(new d("BN","boron nitride")),this.a.push(new d("BP","boron(III) phosphide")),this.a.push(new d("BPO4","boron(III) orthophosphate")),this.a.push(new d("B2F4","boron trifluoride")),this.a.push(new d("B2H6","diborane")),this.a.push(new d("BH3","borane")),this.a.push(new d("B2O3","boron(III) oxide")),this.a.push(new d("B2S3","boron sulfide")),this.a.push(new d("B3N3H6","borazine")),this.a.push(new d("B4C","boron carbide")),this.a.push(new d("BeB2","beryllium boride")),this.a.push(new d("BeCl2","beryllium chloride")),this.a.push(new d("BeF2","beryllium fluoride")),this.a.push(new d("BeO","beryllium oxide")),this.a.push(new d("BeS","beryllium sulfide")),this.a.push(new d("BeSO4","beryllium sulfate")),this.a.push(new d("Be2C","beryllium carbide")),this.a.push(new d("Be3N2","beryllium nitride")),this.a.push(new d("CCl2F2","dichlorodifluoromethane")),this.a.push(new d("CHCl3","chloroform")),this.a.push(new d("CH2Cl2","dichloromethane")),this.a.push(new d("CH2O","formaldehyde")),this.a.push(new d("CH3Cl","chloromethane")),this.a.push(new d("CH4","methane")),this.a.push(new d("CO","carbon monoxide")),this.a.push(new d("COCl2","phosgene")),this.a.push(new d("CO2","carbon dioxide")),this.a.push(new d("CO3","carbon trioxide")),this.a.push(new d("CS2","carbon disulfide")),this.a.push(new d("C2F4","tetrafluoroethylene")),this.a.push(new d("C2H2","acetylene")),this.a.push(new d("C2H3Cl","vinyl chloride")),this.a.push(new d("C2H4","ethylene")),this.a.push(new d("C2H4Cl2","ethylene dichloride")),this.a.push(new d("C2H4O2","acetic acid")),this.a.push(new d("C2H5NO2","glycine")),this.a.push(new d("C2H6","ethane")),this.a.push(new d("C2H6OS","dimethyl sulfoxide")),this.a.push(new d("C3H6","cyclopropane")),this.a.push(new d("C3H7NO2","alanine")),this.a.push(new d("C3H7NO3","serine")),this.a.push(new d("C3H8","propane")),this.a.push(new d("C3H8O","propanol")),this.a.push(new d("C4H8","cyclobutane")),this.a.push(new d("C4H8O","tetrahydrofuran")),this.a.push(new d("C4H10","butane")),this.a.push(new d("C4H10O","diethyl ether")),this.a.push(new d("C5H5N","pyridine")),this.a.push(new d("C5H10","cyclopentane")),this.a.push(new d("C5H12","pentane")),this.a.push(new d("C6H4O2","orthobenzoquinone")),this.a.push(new d("C6H5F","fluorobenzene")),this.a.push(new d("C6H6","benzene")),this.a.push(new d("C6H6O2","catechol")),this.a.push(new d("C6H12","cyclohexane")),this.a.push(new d("C6H14","hexane")),this.a.push(new d("C7H8","toluene")),this.a.push(new d("C7H16","heptane")),this.a.push(new d("C8H8","cubane")),this.a.push(new d("CaB6","calcium boride")),this.a.push(new d("CaCO3","calcium carbonate")),this.a.push(new d("CaC2","calcium carbide")),this.a.push(new d("CaCl2","calcium chloride")),this.a.push(new d("CaF2","calcium fluoride")),this.a.push(new d("CaH2","calcium hydride")),this.a.push(new d("CaO","calcium oxide")),this.a.push(new d("CaO2","calcium peroxide")),this.a.push(new d("CaS","calcium sulfide")),this.a.push(new d("CaSiO3","calcium metasilicate")),this.a.push(new d("ClF","chlorine fluoride")),this.a.push(new d("ClF3","chlorine trifluoride")),this.a.push(new d("ClO2","chlorine dioxide")),this.a.push(new d("ClO3F","chlorine trioxide fluoride")),this.a.push(new d("Cl2","chlorine")),this.a.push(new d("Cl2O3","chlorine trioxide")),this.a.push(new d("FLi","lithium fluoride")),this.a.push(new d("FLiO","lithium hypofluorite")),this.a.push(new d("FLi2","dilithium monofluoride")),this.a.push(new d("FMg","magnesium monofluoride")),this.a.push(new d("FN","fluoroimidogen")),this.a.push(new d("FNO","nitrosyl fluoride")),this.a.push(new d("FNO2","nitryl fluoride")),this.a.push(new d("FNO3","fluorine nitrate")),this.a.push(new d("FNS","thiazyl fluoride")),this.a.push(new d("FNa","sodium fluoride")),this.a.push(new d("FNa2","disodium monofluoride")),this.a.push(new d("FO","oxygen monofluoride")),this.a.push(new d("FO2","dioxygen monofluoride")),this.a.push(new d("FO3S","fluorosulfate radical")),this.a.push(new d("FP","phosphorus monofluoride")),this.a.push(new d("FPS","phosphenothious fluoride")),this.a.push(new d("FPS2","phosphenodithioic fluoride")),this.a.push(new d("FS","monosulfur monofluoride")),this.a.push(new d("F2","fluorine")),this.a.push(new d("F2K2","dipotassium difluoride")),this.a.push(new d("F2Li2","lithium fluoride")),this.a.push(new d("F2Mg","magnesium fluoride")),this.a.push(new d("F2N","difluoroamino radical")),this.a.push(new d("F2N2O","nitrosodifluoroamine")),this.a.push(new d("F2Na2","disodium difluoride")),this.a.push(new d("F2O","difluorine monoxide")),this.a.push(new d("F2OS","thionyl fluoride")),this.a.push(new d("F2OSi","difluorooxosilane")),this.a.push(new d("F2O2","perfluoroperoxide")),this.a.push(new d("F2O2S","sulfuryl fluoride")),this.a.push(new d("F2P","phosphorus difluoride")),this.a.push(new d("F2S","sulfur difluoride")),this.a.push(new d("F2S2","difluorodisulfane")),this.a.push(new d("F2S2","thiothionyl fluoride")),this.a.push(new d("F2S2","thiothionyl fluoride")),this.a.push(new d("F2Si","difluorosilylene")),this.a.push(new d("F3Li3","trilithium trifluoride")),this.a.push(new d("F3N","nitrogen trifluoride")),this.a.push(new d("F3NO","nitrogen trifluoride oxide")),this.a.push(new d("F3NS","thiazyl trifluoride")),this.a.push(new d("F3OP","phosphoryl fluoride")),this.a.push(new d("F3P","phosphorus trifluoride")),this.a.push(new d("F3PS","thiophosphoryl fluoride")),this.a.push(new d("F3S","sulfur trifluoride")),this.a.push(new d("F3Si","trifluorosilyl radical")),this.a.push(new d("F4Mg2","dimagnesium tetrafluoride")),this.a.push(new d("F4Mg2","magnesium fluoride")),this.a.push(new d("F4N2","tetrafluorohydrazine")),this.a.push(new d("F4OS","sulfur tetrafluoride oxide")),this.a.push(new d("F4S","sulfur tetrafluoride")),this.a.push(new d("F4Si","silicon tetrafluoride")),this.a.push(new d("F5P","phosphorus pentafluoride")),this.a.push(new d("H2B2","diborene")),this.a.push(new d("HCN","hydrocyanic acid")),this.a.push(new d("HCl","hydrochloric acid")),this.a.push(new d("HClO","hypochlorous acid")),this.a.push(new d("HClO2","chlorous acid")),this.a.push(new d("HClO3","chloric acid")),this.a.push(new d("HClO4","perchloric acid")),this.a.push(new d("HF","hydrofluoric acid")),this.a.push(new d("HNO2","nitrous acid")),this.a.push(new d("HNO3","nitric acid")),this.a.push(new d("HN3","hydrazoic acid")),this.a.push(new d("HOCl","hypochlorous acid")),this.a.push(new d("HOF","hypofluorous acid")),this.a.push(new d("H2","hydrogen")),this.a.push(new d("H2CO","formaldehyde")),this.a.push(new d("H2CO3","carbonic acid")),this.a.push(new d("H2CSO","sulfine")),this.a.push(new d("H2C2O4","oxalic acid")),this.a.push(new d("H2O","water")),this.a.push(new d("H2O2","hydrogen peroxide")),this.a.push(new d("H2S","hydrogen sulfide")),this.a.push(new d("H2SO3","sulfurous acid")),this.a.push(new d("H2SO4","sulfuric acid")),this.a.push(new d("H2SiO3","silicic acid")),this.a.push(new d("H3PO4","phosphoric acid")),this.a.push(new d("KH","potassium hydride")),this.a.push(new d("KCN","potassium cyanide")),this.a.push(new d("KC2H5O","potassium ethoxide")),this.a.push(new d("KCl","potassium chloride")),this.a.push(new d("KClO3","potassium chlorate")),this.a.push(new d("KF","potassium fluoride")),this.a.push(new d("KHCO3","potassium bicarbonate")),this.a.push(new d("KHSO3","potassium hydrogen sulfite")),this.a.push(new d("KNa","potassium sodide")),this.a.push(new d("KNO3","potassium nitrate")),this.a.push(new d("KO","monopotassium monoxide")),this.a.push(new d("KOCl","potassium hypochlorite")),this.a.push(new d("KOH","potassium hydroxide")),this.a.push(new d("KO2","potassium superoxide")),this.a.push(new d("KO3","potassium ozonide")),this.a.push(new d("K2Na2","dipotassium disodium")),this.a.push(new d("K2O","potassium oxide")),this.a.push(new d("K2O2","potassium peroxide")),this.a.push(new d("K2S","potassium sulfide")),this.a.push(new d("LiCN","lithium cyanide")),this.a.push(new d("LiC2H5O","lithium ethoxide")),this.a.push(new d("LiHSO4","lithium hydrogen sulfate")),this.a.push(new d("LiNa","sodium lithium")),this.a.push(new d("LiNO3","lithium nitrate")),this.a.push(new d("Li2SO4","lithium sulfate")),this.a.push(new d("Li2SiO3","lithium metasilicate")),this.a.push(new d("LiCl","lithium chloride")),this.a.push(new d("LiH","lithium hydride")),this.a.push(new d("MgCO3","magnesium carbonate")),this.a.push(new d("MgC2O4","magnesium oxalate")),this.a.push(new d("MgCl2","magnesium chloride")),this.a.push(new d("MgF2","magnesium fluoride")),this.a.push(new d("MgO","magnesium oxide")),this.a.push(new d("MgS","magnesium sulfide")),this.a.push(new d("MgSO4","magnesium sulfate")),this.a.push(new d("MgSiO3","magnesium metasilicate")),this.a.push(new d("NH3","ammonia")),this.a.push(new d("NH4Cl","ammonium chloride")),this.a.push(new d("NH4ClO4","Ammonium perchlorate")),this.a.push(new d("NO","nitric oxide")),this.a.push(new d("NO2","nitrogen dioxide")),this.a.push(new d("NO2Cl","nytril chloride")),this.a.push(new d("N2","nitrogen")),this.a.push(new d("N2H4","hydrazine")),this.a.push(new d("N2O","nitrous oxide")),this.a.push(new d("N2O3","dinitrogen trioxide")),this.a.push(new d("N2O4","dinitrogen tetroxide")),this.a.push(new d("N2O5","dinitrogen pentaoxide")),this.a.push(new d("N4H4","trans-tetrazene")),this.a.push(new d("NaCN","sodium cyanide")),this.a.push(new d("NaCl","sodium chloride")),this.a.push(new d("NaH","sodium hydride")),this.a.push(new d("NaHCO3","sodium bicarbonate")),this.a.push(new d("NaNO3","sodium nitrate")),this.a.push(new d("NaOH","sodium hydroxide")),this.a.push(new d("Na2CO3","sodium carbonate")),this.a.push(new d("Na2O2","sodium peroxide")),this.a.push(new d("Na2O","sodium oxide")),this.a.push(new d("Na2S","sodium monosulfide")),this.a.push(new d("O2","dioxygen")),this.a.push(new d("OF2","oxygen difluoride")),this.a.push(new d("O2F2","dioxygen difluoride")),this.a.push(new d("O3","ozone")),this.a.push(new d("SF4","sulfur tetrafluoride")),this.a.push(new d("SOF2","thionyl difluoride")),this.a.push(new d("SO2","sulfur dioxide")),this.a.push(new d("SO2F2","sulfuryl difluoride")),this.a.push(new d("SO3","sulfur trioxide")),this.a.push(new d("SiC","silicon carbide")),this.a.push(new d("SiH4","silane")),this.a.push(new d("SiO2","silicon(IV) dioxide")),this.c)switch((e=this.c[i]).j=e.G,3<=e.G?e.j+=10:2==e.b&&(e.j=18),e.la=e.b<3?1:e.b<11?2:e.b<19?3:4,e.b){case 1:case 6:case 7:case 8:case 15:case 16:e.r=this.m[0];break;case 2:case 10:case 18:e.r=this.m[1];break;case 3:case 11:case 19:e.r=this.m[2];break;case 4:case 12:case 20:e.r=this.m[3];break;case 5:case 14:e.r=this.m[4];break;case 9:case 17:e.r=this.m[5];break;case 13:e.r=this.m[6]}for(var t in(i=this.c.slice(0)).sort(m),this.a){var e,s=i,n=((e=this.a[t]).z=[],0),h=e.r,a=void 0;for(a in s){var o=s[a],l=RegExp("("+s[a].i+")([0-9]*)"),r=l.exec(h,"");r&&0<r.length&&(h=h.replace(l,""),l=""==r[2]?1:parseInt(r[2]),n+=o.b*l,e.z.push(new U(o.i,o.b,l)))}e.X=n}this.A=0,this.v=1,this.d=new f("You",3*Math.PI/4),this.g=new f("Enemy",5*Math.PI/4)}function u(i,t){this.b=i,this.color=t}function c(i,t,e,s){this.i=i,this.f=t,this.b=e,this.G=s,this.r=this.la=this.j=x}function d(i,t){this.r=i,this.b=t,this.z=this.X=x}function U(i,t,e){this.i=i,this.b=t,this.count=e}n.prototype.toString=function(){return"rgba("+this.u+", "+this.j+", "+this.ga+", "+this.Y+")"},g.prototype.P=function(){this.g.q+=this.A,this.d.P(this.v),this.g.P(this.v),this.d.C-=this.g.C,this.d.C+=1e3*this.v,this.g.C=0},d.prototype.toString=function(){return this.r+" ("+this.b+")"};var v,i=x,s=x,t=x,h=x,O=x,F=x,k=x,H=x,l=x,r=x,p=x,N=[],q={};function Y(){C=new g,L=I,v.children=[];var i,t="";for(i in C.a)t+="<li>"+C.a[i].toString()+"</li>";document.getElementById("knownCompoundList").innerHTML="<ul>"+t+"</ul>",h=new _,v.addChild(h),O=new Q(v),(H=new Z(s)).sa(),F=new V(540,v,C.d),k=new V(62,v,C.g),j()}function J(){$("#startGameOptionsContainer").Ga(),$("#canvasContainer").Ha('<p style="color:white">Chem Fight requires an HTML 5 compatible browser.</p>')}function W(i){if(!h.K(i.x,i.y))switch(L){case I:O.K(i.x,i.y),F.K(i.x,i.y);break;case B:case P:F.K(i.x,i.y)}}function X(i,t,e,s,n){if(n){if(n.va(i,t))return e=n.f,L==I?(mi(C.d,e),v.needsDisplay=!0):L==P?gi(C.d,e)&&H.add(e,!0,!0):L==B&&C.d.e==x&&(yi(C.d,e),C.d.e=e,H.add(e,!0,!0)),F.refresh(),n;if(n.ua(i,t))return e=n.f,L==I?(bi(C.d,e),v.needsDisplay=!0):L==P?(i=C.d,e.b in i.l&&0<i.l[e.b]&&--i.l[e.b],w(C.d,e),H.remove(e.b)):L==B&&C.d.e!==x&&(w(C.d,e),H.remove(e.b),C.d.e=x),F.refresh(),n}for(var h in s)if((h=s[h]).isInBounds(i,t))return n&&e.removeChild(n),n=new a(h.x-20,h.y-20,h.f,!1),e.addChild(n),n.Ca(!0),n;return x}function T(i,t,e,s,n){i=new si(i,t,e,"#FFF",20,s,n),N.push(i),v.addChild(i)}function Z(i){this.layer=i,this.k=[],this.add=function(i,t,e){var s=0,n=940,h=0,a=620;e&&(s=370,n=571,h=230,a=391),i=new ti(S(s,n),S(h,a),i,t),this.k.push(i),this.layer.addChild(i),i.Ba()},this.remove=function(i){for(var t=this.k.length-1;0<=t;t--){var e=this.k[t];if(e.f.b==i){e.Z(),this.layer.removeChild(e),this.k.splice(t,1);break}}},this.clear=function(){for(var i in this.k)this.k[i].Z(),this.layer.removeChild(this.k[i]);this.k=[]},this.sa=function(){for(var i=C.c.length-1;0<=i;i--)this.add(C.c[i],!0,!1)},this.na=function(){for(var i in this.k)this.k[i].za()},this.ta=function(i){for(var t in this.k)if(i==(t=this.k[t]).f.b)return t;return x},this.ja=function(){for(var i in this.k)this.k[i].da=!0,this.k[i].M=10},this.ca=function(i,t){for(var e=this.k.length-1;0<=e;e--){var s=this.k[e];if(i==s.f.b){s.da=!1,s.ka=!0,s.M=10,s.p=10,s.D=t?t.fa:Math.PI,this.k.splice(e,1);break}}},this.xa=function(i,t){var e=this.ta(i.b);if(e!=x){for(var s=t.fa==5*Math.PI/4,n=0;n<2*e.f.b;n++)this.layer.addChild(new ei(e.x,e.y,e.backgroundColor.toString(),s));this.remove(i.b)}}}function V(n,i,h){this.x=20,this.y=n,this.layer=i,this.ya=h,this.o=x,this.t=[],this.refresh=function(){var i,t,e=fi(h);for(i in this.t)this.layer.removeChild(this.t[i]);for(t in this.t=[],e){var s=e[t];(i=new a(20+40*t,n,s,!0)).ia=K(this.ya,s.b),this.t.push(i),this.layer.addChild(i)}this.o&&(this.layer.removeChild(this.o),0==K(C.d,this.o.f.b)?this.o=x:this.layer.addChild(this.o))},this.T=function(){this.o&&(this.layer.removeChild(this.o),this.o=x)},this.K=function(i,t){return(t=(i=X(i,t,this.layer,this.t,this.o))!=x)?this.o=i:this.T(),t}}function Q(t){this.x=160,this.y=250,this.layer=t,this.o=x,this.t=[],this.T=function(){this.o&&(this.layer.removeChild(this.o),this.o=x)},this.K=function(i,t){return(t=(i=X(i,t,this.layer,this.t,this.o))!=x)?this.o=i:this.T(),t},this.ma=function(){for(var i in C.c)i=C.c[i],i=new a(160+40*(i.j-1),250+40*(i.la-1),i,!1),this.t.push(i),t.addChild(i)},this.clear=function(){for(var i in this.T(),this.t)this.layer.removeChild(this.t[i]);this.t=[]}}window.SetupChemFight=function(){(i=new Stratiscape({containerId:"canvasContainer",canvasNotSupportedCallback:J,layers:[{name:"canvasCFBackground",x:0,y:0,width:960,height:640,zIndex:1,backgroundColor:"black;"},{name:"canvasCFForegroundHUD",x:10,y:10,width:940,height:620,zIndex:2,clickCallback:W,dblclickCallback:q.Ea,mouseHitId:"canvasMouseHitDetector"}]})).canvasSupported&&(s=i.getLayer("canvasCFBackground"),t=s.ctx,i.getLayer("canvasCFForeground"),v=i.getLayer("canvasCFForegroundHUD"),t.globalAlpha=1,s.addChild(new ii),setInterval(function(){i.draw()},1e3/60),Y(),T(450,310,"Welcome to Chem Fight",1e4,0),T(450,330,"Start by choosing atoms to purchase",15e3,5e3),T(470,390,"Purchase atoms by clicking on an element",2e4,1e4),T(470,410,"then click the plus (+) button to add one atom",2e4,1e4),T(470,430,"Return purchased atoms by clicking on an element",25e3,15e3),T(470,450,"then click the minus (-) button to remove the atom",25e3,15e3))};var _=Stratiscape.DrawnObject.extend({init:function(){this.R=200,this.L=50,this.S=940-this.R-1,this.pa=620-this.L-2,this.Da=2,this.w=!1,this.F=x,this.ba=this.R,this.aa=this.L,this.U=this.S,this.V=this.pa-this.L-25},draw:function(i){L==z||L==G||L==E?(i.globalAlpha=.4,i.fillStyle="rgba(51, 102, 153, 25)",i.fillRect(320,160,300,100),i.globalAlpha=1,i.strokeStyle="#008000",i.strokeRect(320,160,300,100),i.textAlign="center",i.textBaseline="middle",i.font="bolder 20px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillStyle="#FE0",i.fillText("Your Score:",470,210),i.fillText(C.d.C+"",470,250)):(this.ha(i,this.pa,C.d),this.ha(i,this.Da,C.g)),i.font="bolder 14px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillStyle="#FFF",i.textAlign="left",i.textBaseline="top",i.fillText("Enemy Elements",0,0),i.textBaseline="bottom",i.fillText("Your Elements",0,620),i.textAlign="center",i.textBaseline="middle",i.fillText("Round: "+C.v+", Turn: "+C.A,470,14);var t,e=this.R/2+25,s=125;switch(L){case I:i.fillText("Choose Elements to Purchase",e,s),i.fillStyle="#FE0",i.font="12px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillText("Your current Atom Bucks are on the bottom",e,s+=14),i.fillText("1 Atom Buck = 1 Proton (Atomic Number)",e,s+=14),i.fillText("(i.e. Helium costs 2 Atom Bucks each)",e,s+=14),i.fillText("After spending all your Atom Bucks,",e,s+=14),i.fillText("click the Done button.",e,s+=14),s+=14,i.fillStyle="#00F",i.fillText("Noble gases are great for attacking,",e,s),i.fillText("but cannot be used for defense.",e,s+=14),i.fillText("Noble gases cost energy to purchase.",e,s+=14);break;case B:i.fillText("Choose an Attacking Element",e,s),i.fillStyle="#FE0",i.font="12px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillText("If your element does not form a compound",e,s+=14),i.fillText("with the opponents defending elements,",e,s+=14),i.fillText("it is considered a successful attack",e,s+=14),i.fillText("and the enemy loses life.",e,s+=14),s+=14,i.fillStyle="#00F",i.fillText("Noble gases cannot be defended against.",e,s);break;case P:i.fillText("Choose Elements to Defend with",e,s),i.fillStyle="#FE0",i.font="12px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillText("If your chosen elements form a compound",e,s+=14),i.fillText("with the opponents attacking element,",e,s+=14),i.fillText("it is considered a successful defense.",e,s+=14),i.fillText("Unused defensive elements deduct energy,",e,s+=14),i.fillText("insufficient energy results in loss of life.",e,s+=14),s+=14,i.fillStyle="#00F",i.fillText("Noble gases cannot be used for defense.",e,s);break;case M:case D:i.fillText("The Battle Ensues",e,s),i.fillStyle="#FE0",i.font="12px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",s+=14;var n="",h="",a="";C.d.e===x?(h="You are defending with:",a=ci(C.d),n="Opponent is attacking with "+C.g.e.i):(n="You are attacking with "+C.d.e.i,h="Opponent is defending with:",a=ci(C.g)),i.fillText(n,e,s),i.fillText(h,e,s+=14),i.fillText(a,e,s+=14);break;case E:i.fillText("You defeated your Opponent!",e,s);break;case G:i.fillText("You defeated all Opponents!",e,s);break;case z:i.fillText("Your Opponent defeated You!",e,s)}for(t in this.w=!1,L==I&&(0==C.d.q||1<C.A)?(this.w=!0,this.F="Done Purchasing Elements"):L==P?(this.w=!0,this.F="Done Choosing Defenders"):L==B&&C.d.e!==x?(this.w=!0,this.F="Done Choosing Attacker"):L==D?(this.w=!0,this.F="Continue"):L==E?(this.w=!0,this.F="Next Round"):L==z?(this.w=!0,this.F="Try Again"):L==G&&(this.w=!0,this.F="Play Again"),this.w&&(i.font="bolder 12px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillStyle="#FE0",i.fillText(this.F,this.U+this.ba/2,this.V+this.aa/2),i.strokeStyle="#008000",i.strokeRect(this.U,this.V,this.ba,this.aa)),e=250,i.font="12px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.textAlign="left",i.textBaseline="top",C.m)s=C.m[t],i.fillStyle=s.color,i.fillRect(0,e,18,18),i.fillText(s.b,25,e),e+=25;i.font="16px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.textAlign="center",i.textBaseline="middle",i.fillStyle="#FE0",L==P?C.g.e!=x&&i.fillText("Opponent's Attacking Element has: "+C.g.e.G+(1==C.g.e.G?" valence electron.":" valence electrons."),470,155):L==M?i.fillText("Checking for valid compounds for defense against: "+(C.d.e===x?C.g:C.d).e.f,470,155):L==D&&(i.fillText(l,470,155),t=20,i.fillStyle="#FFF",p!==x&&(i.fillText(p,470,155+t),t+=20),r!==x)&&i.fillText(r,470,155+t)},Fa:function(){},ha:function(i,t,e){i.globalAlpha=.4,i.fillStyle="rgba(51, 102, 153, 25)",i.fillRect(this.S,t,this.R,this.L),i.globalAlpha=1,i.strokeStyle="#008000",i.strokeRect(this.S,t,this.R,this.L),i.textAlign="left",i.textBaseline="top",i.font="bolder 12px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillStyle="#FE0",i.fillText(e.qa,this.S+2,t),i.font="bolder 25px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillStyle="#800000",i.beginPath();var s=16,n=t+25,h=this.S,a=(i.arc(h+16,n,8,0,2*Math.PI,!0),i.arc(h+32,n,8,0,2*Math.PI,!0),i.closePath(),i.fill(),i.beginPath(),i.moveTo(h+8,n+=2),i.lineTo(h+40,n),i.lineTo(h+24,n+22.4),i.closePath(),i.fill(),i.fillText(e.B+"",h+=40,t+14),n-=10,h+=40,(s/=2)/3);for(i.fillStyle="#00F",i.strokeStyle="#00F",i.beginPath(),i.moveTo(h,n),s=[h+8,n+8,h,n+8,h+8,n+16,h,n+16,h+8,n+24,h+16/3,n+a+16,h+16/3+8,n+a+16,h+16/3,n+a+8,h+16/3+8,n+a+8],n=0;n<s.length;n+=2)i.lineTo(s[n],s[n+1]);i.closePath(),i.stroke(),i.fill(),i.fillText(e.s+"",h+=16,t+14),h+=40,i.fillStyle="#FE0",i.fillText("$"+e.q,h,t+14)},K:function(i,t){return!!(this.w&&this.U<i&&i<this.U+this.ba&&this.V<t&&t<this.V+this.aa)&&(ai(),!0)}}),ii=Stratiscape.DrawnObject.extend({draw:function(i){i.lineWidth=1,i.strokeStyle="#FE0",i.strokeRect(2,2,956,636),i.strokeStyle="#F90",i.strokeRect(0,0,960,640)}}),a=Stratiscape.DrawnObject.extend({init:function(i,t,e,s){this.i=40,this.x=i,this.y=t,this.f=e,this.backgroundColor=e.r.color,this.$=!1,this.n=16,this.I=i+45,this.J=t+5,this.N=i+25,this.O=t+5,this.Aa=s,this.ia=0},draw:function(i){var t=this.$?2*this.i:this.i;if(i.lineWidth=2,i.strokeStyle="#000",i.fillStyle=this.backgroundColor,i.fillRect(this.x,this.y,t,t),i.strokeRect(this.x,this.y,t,t),i.textAlign="center",i.textBaseline="middle",i.font=t/4+"px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillStyle="#000",i.fillText(this.f.b,this.x+t/8+1,this.y+t/8),i.font="bolder "+t/2+"px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillText(this.f.i,this.x+t/2,this.y+t/2),this.$){i.font=t/6+"px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillText(this.f.f,this.x+t/2,this.y+t-t/8);var e,s=!1,n=!1,h=(L==I?(wi(C.d,this.f)&&(s=!0),0!=K(C.d,this.f.b)&&(n=!0)):L==P?(0!=K(C.d,this.f.b)&&18!=this.f.j&&(s=!0),h=C.d,0!=(h=(a=this.f.b)in h.l?h.l[a]:0)&&(n=!0)):L==B&&(C.d.e===x?s=!0:C.d.e.b==this.f.b&&(n=!0)),i.strokeStyle="#000",i.beginPath(),s&&(i.fillStyle="#008000",i.fillRect(this.I,this.J,this.n,this.n),i.moveTo(this.I+2,this.J+this.n/2),i.lineTo(this.I+this.n-2,this.J+this.n/2),i.moveTo(this.I+this.n/2,this.J+2),i.lineTo(this.I+this.n/2,this.J+this.n-2)),n&&(i.fillStyle="#800000",i.fillRect(this.N,this.O,this.n,this.n),i.moveTo(this.N+2,this.O+this.n/2),i.lineTo(this.N+this.n-2,this.O+this.n/2)),i.stroke(),i.closePath(),s=[2,8,8,2],i.font="10px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillStyle="#000",n=0),a=!(i.textBaseline="top");for(e in s){n+=s[e];var o=s[e];if(this.f.b<=n&&(o=this.f.b-h+"",a=!0),i.fillText(o,this.x+t-8,this.y+10*e),h=n,a)break}}this.Aa&&(i.fillStyle="#00F",i.beginPath(),i.arc(this.x+t/2,this.y-30,15,0,2*Math.PI,!0),i.closePath(),i.fill(),i.fillStyle="#FE0",i.font="16px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillText(this.ia+"",this.x+t/2,this.y-30))},isInBounds:function(i,t){return this.x<i&&i<this.x+this.i&&this.y<t&&t<this.y+this.i},va:function(i,t){return this.I<i&&i<this.I+this.n&&this.J<t&&t<this.J+this.n},ua:function(i,t){return this.N<i&&i<this.N+this.n&&this.O<t&&t<this.O+this.n},Ca:function(i){this.$=i,this.layer.needsDisplay=!0}}),ti=Stratiscape.DrawnObject.extend({init:function(i,t,e,s){this.x=i,this.y=t,i="#"==(i=(this.f=e).r.color).charAt(0)?i.substr(1):i,t=x,3==i.length?t=new n((t=parseInt(i.substring(0,1),16))+16*t,(e=parseInt(i.substring(1,2),16))+16*e,(i=parseInt(i.substring(2,3),16))+16*i,255):6==i.length&&(t=new n(parseInt(i.substring(0,2),16),parseInt(i.substring(2,4),16),parseInt(i.substring(4,6),16),255)),this.backgroundColor=t,this.W=s,this.u=10+2*this.f.b,s||(this.u=20),this.p=1,this.D=S(0,360)*Math.PI/180,this.M=4,this.ka=this.da=this.ea=!1},draw:function(i){var t=new n(this.backgroundColor.u,this.backgroundColor.j,this.backgroundColor.ga,this.backgroundColor.Y),e=(i.fillStyle=t.toString(),i.strokeStyle="#FFF",this.W||(t=new n(255,255,255,255),i.fillStyle=t.toString()),3*this.u),s=i.createRadialGradient(this.x,this.y,1,this.x,this.y,e);s.addColorStop(0,t.toString()),t.Y=0,s.addColorStop(1,t.toString()),i.fillStyle=s,i.fillRect(this.x-e,this.y-e,2*e,2*e),i.beginPath(),i.arc(this.x,this.y,this.u,0,2*Math.PI,!0),i.closePath(),i.fill(),this.W&&(i.textAlign="center",i.textBaseline="middle",i.font="20px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",i.fillStyle="#000",i.fillText(this.f.i,this.x,this.y))},za:function(){this.W||(this.u=10+2*this.f.b,this.W=!0,this.layer.needsDisplay=!0)},Ba:function(){this.ea=!0,this.update()},Z:function(){this.ea=!1},wa:function(){return this.x-this.u<0||this.y-this.u<0||940<this.x+this.u||620<this.y+this.u},update:function(){var i,t=this.wa();if(this.ka){if(this.p=this.M,t)return this.Z(),void this.layer.removeChild(this)}else this.da||t?this.D=Math.atan2(310-this.y,470-this.x):this.D+=S(-10,12)*Math.PI/180;this.p+=S(-1,2),this.p<0&&(this.p=0),this.p>this.M&&(this.p=this.M),0!=this.p&&(this.x+=this.p*Math.cos(this.D),this.y+=this.p*Math.sin(this.D)),this.ea&&(i=this,setTimeout(function(){i.update()},100),this.layer.needsDisplay=!0)}}),ei=Stratiscape.DrawnObject.extend({init:function(i,t,e,s){this.x=i,this.y=t,this.color=e,this.p=S(30,51),this.D=(s?S(180,360):S(1,180))*Math.PI/180;var n=this;setTimeout(function(){n.update()},10)},draw:function(i){i.fillStyle=this.color,i.beginPath(),i.arc(this.x,this.y,5,0,2*Math.PI,!0),i.closePath(),i.fill()},update:function(){var i;this.p-=S(0,2),0<this.p&&(this.x+=this.p*Math.cos(this.D),this.y+=this.p*Math.sin(this.D)),0<this.p?(i=this,setTimeout(function(){i.update()},50),this.layer&&(this.layer.needsDisplay=!0)):this.layer.removeChild(this)}}),si=Stratiscape.DrawnObject.extend({init:function(i,t,e,s,n,h,a){this.x=i,this.y=t,this.text=e,this.color=s,this.font=n+"px 'Lucida Sans Unicode', 'Lucida Grande', sans-serif",this.oa=h,this.Q=a,this.H=1,0<this.Q&&(this.H=0);var o=this;setTimeout(function(){o.remove()},h),this.update()},draw:function(i){i.globalAlpha=this.H,i.textAlign="center",i.textBaseline="middle",i.fillStyle=this.color,i.font=this.font,i.fillText(this.text,this.x,this.y),i.globalAlpha=1},update:function(){this.oa-=200,this.oa<=2e3&&.09<this.H?this.H-=.1:200<=this.Q&&(this.Q-=200,this.Q<=2e3&&this.H<.91&&(this.H+=.1),this.Q<=0)&&(this.H=1),this.layer&&(this.layer.needsDisplay=!0);var i=this;setTimeout(function(){i.layer&&i.update()},200)},remove:function(){this.layer&&this.layer.removeChild(this)}}),L=x,A=x,I=1,B=2,P=3,M=4,D=5,E=6,z=7,G=8;function ni(){var i,t=C.d.e===x?C.g:C.d,e=C.d.e===x?C.d:C.g,s=0==(n=R(t.e,e.l)).length?x:(n.sort(y),n[0]),n=di(e);if(s!==(r=p=x)){var h,a=s.X;for(h in e.q+=a,e.C+=10*a,e.s+=2*a,l="Defense Successful, Defender Earned "+a+" buck"+(1<a?"s":"")+" and "+2*a+" energy.",p="Compound: "+s.toString()+" formed.",s.z)for(participant=s.z[h],a=0;a<participant.count;a++)if(0==a&&participant.b==t.e.b)H.ca(t.e.b);else for(var o=n.length-1;0<=o;o--)if(n[o].b==participant.b){H.ca(participant.b),n.splice(o,1);break}}else li(t,e),l="Attack Successful "+t.e.b+" damage dealt";for(i in h=t=0,n)element=n[i],w(e,element),e.s-=element.b,t+=element.b,H.ca(element.b,e);e.s<0&&(t-=h=-1*e.s,e.B-=h,e.s=0),0==t&&0==h||(r=h+" Life lost and "+t+" Energy lost from unbonded defending elements."),L=D,v.needsDisplay=!0,hi()}function hi(){C.d.B<=0?(L=z,T(470,310,"You lost all your Life",1e4,0),T(470,330,"Game Over!",1e4,3e3)):C.g.B<=0&&(C.v<3?(C.P(),L=E,T(470,310,"Opponent Defeated!",1e4,0),T(470,330,"Round Complete",1e4,3e3)):(C.P(),L=G,T(470,310,"You defeated all Opponents",1e4,0),T(470,330,"and won the Chem Fight!",1e4,0),T(470,350,"Congratulations!",1e4,3e3),T(470,370,"You are a chemical master!",1e4,3e3)))}function ai(){for(var i in N)N[i].remove();switch(N=[],L){case I:for(O.clear(),i=C.g;0<i.q;){var t=x;if(1<C.v){for(var e=[],s=0;s<C.c.length;s++){var n=C.c[s];i.q>=n.b&&0==K(i,n)&&e.push(n)}0<e.length&&(t=e[s=S(0,e.length)].b-1)}t=t||S(0,t=i.q+1<C.c.length?i.q+1:C.c.length),mi(i,n=C.c[t])}H.clear(),L=P,A=B,j();break;case P:L=M,F.refresh(),H.na(),v.needsDisplay=!0,H.ja(),setTimeout(function(){ni()},2e3);break;case B:if(18==C.d.e.j)ri(C.d,C.g);else{L=M;var h,a=C.g,o=C.d.e.G,l=1==o?2:8,r=0,u=pi(a),c=!1;for(oe in u)r+=u[oe].G,1==u[oe].j&&(c=!0);if(2!=l||c||(l=8),l-=o,r=[],3<=C.v){for(w in l=[],u=fi(C.d))(c=u[w]).G==o&&l.push(c);for(var d in l)for(h in c=R(u=l[d],a.h)){var p,f=c[h],w=[];for(p in f.z)for(var m=f.z[p],y=0;y<m.count;y++)0==y&&m.i==u.i||w.push(C.c[m.b-1]);0<w.length&&r.push(w)}}else{for(f in d=[],h=[],u)18!=(c=u[f]).j&&((p=[]).push(c),h.push(p),d.push(c));r=function i(t,e,s,n,h){var a,o=[];for(a in s){var l,r=s[a],u=void(l=0);for(u in r)l+=r[u].G;if(l==e)o.push(r);else if(e<l)continue;for(l=n+1;l<h.length;l++){(u=r.slice(0)).push(h[l]);var c,d=[];for(c in d.push(u),u=i(t,e,d,l,h))o.push(u[c])}}return o}(a,l,h,0,d)}if(0<r.length)for(oe in r.sort(a.ra),d=r[0],d=1==C.v?r[S(0,r.length)]:d)gi(a,d[oe]);k.refresh();var b,g=di(C.g);for(b in g)H.add(g[b],!0,!0);v.needsDisplay=!0,H.ja(),setTimeout(function(){ni()},2e3)}break;case D:ui(C.d),ui(C.g),k.refresh(),F.refresh(),(L=A)==B?(A=I,T(470,310,"Choose Attacker",6e3,1e3),oi(C.d)):(A=B,j()),v.needsDisplay=!0;break;case E:(i=C).A=0,i.v++,L=I,O.ma(),C.A++,k.refresh(),F.refresh();break;case z:case G:Y()}}function oi(i){0==function(i){var t,e=0;for(t in i.h)e+=i.h[t];return e}(i)&&(T(470,310,"No Elements owned by Attacker",3e3,0),T(470,340,"Skipping to next Stage",3e3,0),setTimeout(function(){(L==B?(L=I,j):(L=D,ai))()},3e3))}function li(i,t){H.xa(i.e,t),t.B-=i.e.b,i.C+=10*i.e.b}function ri(i,t){L=D,H.na(),li(i,t),p=x,l="A noble gas attacked, unable to defend.",r=i.e.b+" damage dealt",v.needsDisplay=!0,hi()}function j(){if(L==P){var i;k.refresh(),oi(C.g),(i=C.g).e=x;for(var t=C.c.length-1;0<=t;t--){var e=C.c[t];if(18==e.j&&e.b in i.h&&0<i.h[e.b]){i.e=e;break}}if(!i.e&&1<C.v){for(var s=[],t=C.c.length-1;0<=t;t--)1<(e=C.c[t]).j&&e.j<17&&s.push(e);if(0<s.length){for(t=e=0;t<s.length;t++)e+=Math.pow(2,t);for(t=0;t<s.length;t++)if(S(0,e+1)<=Math.pow(2,s.length-t-1)){i.e=s[t];break}}}i.e||(t=pi(i),i.e=0==t.length?x:t[S(0,t.length)]),i.e&&yi(i,i.e),(i=i.e)&&(H.add(i,!1,!0),18==i.j?ri(C.g,C.d):T(470,310,"Choose Defenders",6e3,1e3))}else L==I&&(C.d.q+=2*C.A,C.g.q+=2*C.A,O.ma(),C.A++,1<C.A)&&T(470,310,"Purchase more Elements",6e3,1e3)}function f(i,t){this.B=30,this.s=10,this.q=30,this.C=0,this.qa=i,this.fa=t,this.h={},this.e=x,this.l={}}function ui(i){i.e=x,i.l={}}function K(i,t){return t in i.h?i.h[t]:0}function ci(i){var t,e="";for(t in C.c){var s,n=C.c[t];n.b in i.l&&0<i.l[n.b]&&(0!=e.length&&(e+=", "),e+=(1<(s=i.l[n.b])?s+"":"")+n.i)}return""==e?"<none>":e}function di(i){var t,e=[];for(t in i.l)for(var s=i.l[t],n=C.c[t-1],h=0;h<s;h++)e.push(n);return e}function pi(i){var t,e=[];for(t in C.c){var s=C.c[t];if(s.b in i.h&&0<i.h[s.b])for(var n=i.h[s.b];0<n;)e.push(s),n--}return e}function fi(i){var t,e=[];for(t in C.c){var s=C.c[t];(s.b in i.h&&0<i.h[s.b]||s.b in i.l&&0<i.l[s.b]||i.e!==x&&i.e.b==s.b)&&e.push(s)}return e}function wi(i,t){return!(i.q<t.b||18==t.j&&i.s<t.b/2)}function mi(i,t){wi(i,t)&&(w(i,t),i.q-=t.b,18==t.j)&&(i.s-=t.b/2)}function w(i,t){t.b in i.h||(i.h[t.b]=0),i.h[t.b]+=1}function yi(i,t){t.b in i.h&&0<i.h[t.b]&&--i.h[t.b]}function bi(i,t){t.b in i.h&&0<i.h[t.b]&&(--i.h[t.b],i.q+=t.b,18==t.j)&&(i.s+=t.b/2)}function gi(i,t){return 0!=K(i,t.b)&&18!=t.j&&(t.b in i.l||(i.l[t.b]=0),i.l[t.b]+=1,--i.h[t.b],1)}f.prototype.P=function(i){var t,e=pi(this);for(t in e)bi(this,e[t]);this.C+=10*(this.q+this.B),this.C+=5*this.s,this.B=30+15*i,this.s=this.B/3,this.q=this.B,ui(this),this.h={}},f.prototype.ra=function(i,t){return e(o(i),o(t))}</script>