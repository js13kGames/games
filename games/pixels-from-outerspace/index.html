<title>Pixels from Outerspace - js13kGames 2012</title><style>h1{text-shadow:0 0 10px #ff0;color:#ff0}canvas{margin-right:auto;margin-left:auto;background-color:#222}body{background-color:#333}</style><canvas id=screen width=400 height=600></canvas><script>function Game(){this.canvas=document.getElementById("screen"),this.ctx=this.canvas.getContext("2d"),this.stageIndex=0,this.spawnBallTimeout=50,this.spawnBallTimeoutStep=0,this.stageCompleteTimeout=75,this.stageCompleteTimeoutStep=0,this.finishTimeout=100,this.finishTimeoutStep=0,this.playerReady=!1,this.stageComplete=!1,this.gameComplete=!1,this.gameOver=!1,this.finish=!1,this.enemyiesReady=!1,this.locked=!0,this.dialogs=new Array,this.currentDialog="",this.dialogIndex=0,this.player,this.enemys=new Array,this.particles=new Array,this.renderer,this.camera,this.ball,this.glow={max:20,min:5,value:5,fac:1},this.state,this.score=0,this.perks=new Array,this.screen={x:this.canvas.width,y:this.canvas.height},this.stages=new Array,this.stars=new Array,this.lines=new Image,this.lines.src="crt.png",this.controller,this.loadStages()}function getColor(t,e,s,a){return{r:t,g:e,b:s,a:a}}function Mob(){this.x,this.y}function Player(t,e,s){this.startY=e,this.x=t,this.y=s,this.w=25,this.h=10,this.spread=4,this.lifes=3,this.alive=!0,this.base=5,this.r=2*Math.PI/1,this.life=100,this.perks=new Array;var a=new DoubleShoot;this.guns=a.guns,this.tiles=[{x:0*this.base,y:0*this.base,w:5*this.base,h:1*this.base,color:getColor(255,255,255,1)},{x:0*this.base,y:-1*this.base,w:1*this.base,h:1*this.base,color:getColor(255,255,255,1)},{x:4*this.base,y:-1*this.base,w:1*this.base,h:1*this.base,color:getColor(255,255,255,1)},{x:2*this.base,y:-3*this.base,w:1*this.base,h:2*this.base,color:getColor(255,255,255,1)},{x:2*this.base,y:1*this.base,w:1*this.base,h:1*this.base,color:getColor(255,255,255,1)},{x:2*this.base,y:-1*this.base,w:1*this.base,h:1*this.base,color:getColor(200,200,255,1)},{x:2*this.base,y:2*this.base,w:1*this.base,h:.5*this.base,color:getColor(255,0,0,1)}],this.v={x:0,y:0}}function Controller(){this.keys=new Array,this.leftDown=!1,this.rightDown=!1}function loadListeners(){document.onkeydown=function(t){game.controller.keyDown(game.controller.getKeyCode(t))},document.onkeyup=function(t){game.controller.keyUp(game.controller.getKeyCode(t))},document.body.onmousedown=function(t){var e=0;1==(e="Netscape"==navigator.appName?t.which:event.button)&&(game.controller.leftDown=!0),2==e&&(game.controller.rightDown=!0)},document.body.onmouseup=function(t){var e=0;1==(e="Netscape"==navigator.appName?t.which:event.button)&&(game.controller.leftDown=!1),2==e&&(game.controller.rightDown=!1)}}function Enemy(){this.startY=500}function Scout(t,e,s){this.startY=s,this.x=t,this.y=e,this.vx=5,this.vy=0,this.w=20,this.h=5,this.spread=4,this.canShoot=!1,this.life=100,this.r=2*Math.PI/4,this.base=5,this.reload=100*Math.random()+10,this.guns=[new LaserGun(0*this.base,0*this.base,2*Math.PI/4,2)],this.tiles=[{x:0*this.base,y:0*this.base,w:5*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:0*this.base,y:1*this.base,w:1*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:4*this.base,y:1*this.base,w:1*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:2*this.base,y:1*this.base,w:1*this.base,h:2*this.base,color:getColor(100,100,255,1)},{x:2*this.base,y:1*-this.base,w:1*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:2*this.base,y:1*this.base,w:1*this.base,h:1*this.base,color:getColor(255,100,100,1)}]}function Destructor(t,e,s){this.startY=s,this.x=t,this.y=e,this.vx=1,this.vy=0,this.w=40,this.h=10,this.spread=4,this.canShoot=!1,this.life=800,this.r=2*Math.PI/4,this.base=5,this.reload=20*Math.random()+10,this.dmg=20,this.guns=[new BomberGun(0*this.base,0*this.base,2*Math.PI/4,2)],this.tiles=[{x:0,y:0,w:6*this.base,h:2*this.base,color:getColor(100,100,255,1)},{x:0,y:2*this.base,w:this.base,h:2*this.base,color:getColor(100,100,255,1)},{x:2*this.base,y:2*this.base,w:2*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:5*this.base,y:2*this.base,w:this.base,h:2*this.base,color:getColor(100,100,255,1)},{x:this.base,y:-this.base,w:this.base,h:this.base,color:getColor(100,100,255,1)},{x:4*this.base,y:-this.base,w:this.base,h:this.base,color:getColor(100,100,255,1)},{x:2*this.base+this.base/2,y:2*this.base,w:this.base,h:this.base,color:getColor(255,100,100,1)}]}function Drone(t,e,s){this.startY=s,this.x=t,this.y=e,this.vx=8,this.vy=0,this.w=40,this.h=10,this.spread=4,this.canShoot=!1,this.life=80,this.r=2*Math.PI/4,this.base=5,this.reload=100*Math.random()+10,this.dmg=5,this.guns=[new GetlingGun(0*this.base,0*this.base,2*Math.PI/4,2)],this.tiles=[{x:0*this.base,y:0*this.base,w:5*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:1*this.base,y:1*this.base,w:1*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:3*this.base,y:1*this.base,w:1*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:1*this.base,y:1*-this.base,w:3*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:2*this.base+this.base/2,y:0*this.base,w:this.base,h:this.base,color:getColor(255,100,100,1)}]}function Mothership(t,e,s){this.startY=s,this.x=t,this.y=e,this.vx=.6,this.vy=0,this.w=40,this.h=10,this.spread=4,this.canShoot=!1,this.life=1e3,this.r=2*Math.PI/4,this.base=5,this.reload=20*Math.random()+10,this.dmg=20,this.guns=[new LaserGun(1*this.base,7*this.base,2*Math.PI/4,2),new LaserGun(8*this.base,7*this.base,2*Math.PI/4,2),new GetlingGun(2*this.base,4*this.base,2*Math.PI/4,2),new GetlingGun(6*this.base,4*this.base,2*Math.PI/4,2)],this.tiles=[{x:1*this.base,y:-.5*this.base,w:3*this.base,h:.5*this.base,color:getColor(255,50,50,1)},{x:5*this.base,y:-.5*this.base,w:3*this.base,h:.5*this.base,color:getColor(255,50,50,1)},{x:1*this.base,y:0*this.base,w:3*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:5*this.base,y:0*this.base,w:3*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:-1*this.base,y:1*this.base,w:11*this.base,h:2*this.base,color:getColor(100,100,255,1)},{x:0*this.base,y:3*this.base,w:1*this.base,h:4*this.base,color:getColor(100,100,255,1)},{x:8*this.base,y:3*this.base,w:1*this.base,h:4*this.base,color:getColor(100,100,255,1)},{x:2*this.base,y:3*this.base,w:5*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:2*this.base,y:4*this.base,w:1*this.base,h:2*this.base,color:getColor(100,100,255,1)},{x:6*this.base,y:4*this.base,w:1*this.base,h:2*this.base,color:getColor(100,100,255,1)},{x:4*this.base,y:4*this.base,w:1*this.base,h:1*this.base,color:getColor(100,100,255,1)},{x:4*this.base,y:4*this.base,w:1*this.base,h:1*this.base,color:getColor(255,200,200,1)}]}function GunBase(){this.x,this.y,this.w,this.h,this.r,this.reloadSpeed,this.reloadStep,this.bullets=new Array,this.canShoot=!0,this.spread=2,this.damage,this.color,this.PLAYER_TYP=1,this.ENEMY_TYP=2,this.typ,this.name}function LaserGun(t,e,s,a){this.x=t,this.y=e,this.w=2,this.h=8,this.r=s,this.reloadSpeed=15*Math.random()+15,this.reloadStep=0,this.bullets=new Array,this.canShoot=!0,this.spread=2,this.damage=3,this.color=getColor(255,100,100,1),this.PLAYER_TYP=1,this.ENEMY_TYP=2,this.typ=a||this.ENEMY_TYP,this.name="LaserGun"}function BomberGun(t,e,s,a){this.x=t,this.y=e,this.w=8,this.h=8,this.r=s,this.reloadSpeed=15*Math.random()+20,this.reloadStep=0,this.bullets=new Array,this.canShoot=!0,this.spread=2,this.damage=25,this.color=getColor(255,100,100,1),this.PLAYER_TYP=1,this.ENEMY_TYP=2,this.typ=a||this.ENEMY_TYP,this.name="BomberGun"}function GetlingGun(t,e,s,a){this.x=t,this.y=e,this.w=4,this.h=6,this.r=s,this.reloadSpeed=5*Math.random()+15,this.reloadStep=0,this.bullets=new Array,this.canShoot=!0,this.spread=2,this.damage=1,this.color=getColor(255,100,100,1),this.PLAYER_TYP=1,this.ENEMY_TYP=2,this.typ=a||this.ENEMY_TYP,this.name="GetlingGun"}function PlayerGun(t,e,s){this.x=t,this.y=e,this.w=4,this.h=6,this.r=s,this.reloadSpeed=8,this.reloadStep=0,this.bullets=new Array,this.canShoot=!0,this.spread=2,this.damage=8,this.color=getColor(100,100,255,1),this.PLAYER_TYP=1,this.ENEMY_TYP=2,this.typ=this.PLAYER_TYP,this.name="PlayerGun"}function TrippleShoot(){this.guns=[new PlayerGun(0*base,0*base,2*Math.PI/4*2.8),new PlayerGun(2*base,0*base,2*Math.PI/4*3),new PlayerGun(4*base,0*base,2*Math.PI/4*3.2)]}function DoubleShoot(){this.guns=[new PlayerGun(0*base,0*base,2*Math.PI/4*3),new PlayerGun(4*base,0*base,2*Math.PI/4*3)]}function Ball(t,e){this.spawn={x:t,y:e},this.v={x:0,y:0,max:1,dir:0},this.bounds={x:10,y:10},this.direction=1,this.x=t,this.y=e,this.glow={max:20,min:5,value:5,fac:1}}function StringSplitter(t,e){for(var s=new Array,a=t;a;){if(a.length<e){s.push(a);break}s.push(a.substr(0,e)),a=a.substr(e)}return s}function finish(){clearInterval(game.renderer),start()}function nextLevel(){game.stageIndex<game.stages.length-1?(clearInterval(game.renderer),game.stageIndex++,game.load()):game.state="gamecomplete"}var game,base=5;Game.prototype.loadStages=function(){this.stages.push({scouts:3,drones:0,destructors:0,mothers:0,dialogs:["A/W/S/D move         Enter to skip message","Enemies incomming!","Warning! Don't let   the ball behind you","One more thing       capt'n teerex rainbow","Good luck"]}),this.stages.push({scouts:0,drones:3,destructors:0,mothers:0,dialogs:["Drones incomming...","GO!"]}),this.stages.push({scouts:0,drones:0,destructors:2,mothers:0,dialogs:["Destructorships ahead","Fireeeeeee!"]}),this.stages.push({scouts:3,drones:4,destructors:1,mothers:0,dialogs:["Great. Now you are   ready for the        invasion"]}),this.stages.push({scouts:3,drones:2,destructors:2,mothers:0,dialogs:["Enemies incomming"]}),this.stages.push({scouts:3,drones:2,destructors:0,mothers:0,dialogs:[]}),this.stages.push({scouts:0,drones:0,destructors:0,mothers:1,dialogs:["Mothership ahead"]}),this.stages.push({scouts:2,drones:2,destructors:1,mothers:0,dialogs:[]}),this.stages.push({scouts:2,drones:2,destructors:2,mothers:0,dialogs:[]}),this.stages.push({scouts:2,drones:8,destructors:0,mothers:0,dialogs:[]}),this.stages.push({scouts:2,drones:4,destructors:0,mothers:1,dialogs:[]}),this.stages.push({scouts:4,drones:2,destructors:1,mothers:1,dialogs:[]}),this.stages.push({scouts:2,drones:6,destructors:1,mothers:1,dialogs:["Beware!"]}),this.load(),loadListeners(),this.controller=new Controller},Game.prototype.load=function(){var e=this.stages[this.stageIndex];this.enemys=new Array,this.stars=new Array,this.particles=new Array,this.dialogs=new Array,this.perks=new Array,this.dialogIndex=0,this.locked=!0,this.playerReady=!1,this.gameOver=!1,this.enemyiesReady=!1,this.finish=!1,this.gameComplete=!1,this.stageComplete=!1,this.finishTimeoutStep=0,this.stageCompleteTimeoutStep=0;for(var t=this.spawnBallTimeoutStep=0;t<e.dialogs.length;t++)this.dialogs.push(e.dialogs[t]);for(this.currentDialog=this.dialogs[this.dialogIndex],t=0;t<e.drones;t++)this.enemys.push(new Drone(150*Math.random()+20*t,-30,100*Math.random()+50));for(t=0;t<e.scouts;t++)this.enemys.push(new Scout(150*Math.random()+20*t,-30,100*Math.random()+50));for(t=0;t<e.destructors;t++)this.enemys.push(new Destructor(150*Math.random()+20*t,-30,100*Math.random()+50));for(t=0;t<e.mothers;t++)this.enemys.push(new Mothership(150*Math.random()+20*t,-30,100*Math.random()+50));for(t=0;t<20;t++)this.stars.push({x:Math.random()*this.screen.x,y:Math.random()*this.screen.y,v:5*Math.random()});this.ball=new Ball(this.screen.x/2,this.screen.y/2),this.ball.v.x=-5*Math.random(),this.ball.v.y=-5*Math.random()-5,this.player=new Player(this.screen.x/2,this.screen.y-50,this.screen.y+50),this.state="dialog",this.renderer=setInterval("game.render()",1e3/23)},Game.prototype.render=function(){var e,t,s,o=this;if("complete"==o.state&&(o.finishTimeoutStep++,o.finishTimeout<=o.finishTimeoutStep)&&nextLevel(),o.areEnemysAlive()||(o.stageCompleteTimeoutStep++,o.stageCompleteTimeoutStep>o.stageCompleteTimeout&&(o.state="complete")),0<o.player.life||(o.state="gameover"),"dialog"==o.state&&o.controller.keys[13]&&(o.dialogIndex<o.dialogs.length-1?(o.dialogIndex++,o.currentDialog=o.dialogs[o.dialogIndex],o.controller.keys[13]=!1):o.state="intro"),"running"==o.state){for(var a in o.enemys)(e=o.enemys[a]).update(),o.collides(e.x,e.y,e.w,e.h,o.ball.x-o.ball.bounds.x/2,o.ball.y-o.ball.bounds.y/2,o.ball.bounds.x,o.ball.bounds.y)&&(e.life=-1),e.life<0&&(o.enemys.splice(a,1),o.createExplosion(e.x,e.y),o.createParticles(e.x,e.y,getColor(255,200,100,1),10,10));o.ball.onUpdate(),o.player.update()}if("intro"==o.state&&(o.player.y>o.player.startY?o.player.y-=5:o.state="running"),"intro"==o.state||"running"==o.state)for(var a in o.enemys)(e=o.enemys[a]).y<e.startY&&(e.y+=1);for(t in o.particles){var r=o.particles[t];r.x+=r.vx,r.y+=r.vy,r.life--,r.color.a-=.01,(!o.isInScreen(r.x,r.y)||r.color.a<0)&&o.particles.splice(t,1),r.life<0&&o.particles.splice(t,1)}for(s in o.stars){var i=o.stars[s];o.isInScreen(i.x+5,i.y+5)||(i.x=Math.random()*o.screen.x,i.y=Math.random()*o.screen.y),i.y+=i.v}(o.glow.value<o.glow.min||o.glow.value>o.glow.max)&&(o.glow.fac*=-1),o.glow.value+=o.glow.fac,o.draw()},Game.prototype.draw=function(){var e,t=this;for(e in t.ctx.clearRect(0,0,t.screen.x,t.screen.y),game.ctx.font="bold 18pt Courier",t.stars){var s=t.stars[e];game.ctx.translate(s.x,s.y),game.ctx.shadowBlur=10,game.ctx.fillStyle="rgba(255,255,255,1)",game.ctx.shadowColor="rgba(255,255,255,1)",game.ctx.fillRect(0,0,4,2),game.ctx.fillRect(1,-1,2,4),game.ctx.translate(-s.x,-s.y),game.ctx.restore()}for(r in t.particles){var o=t.particles[r];game.ctx.save(),game.ctx.translate(o.x+o.w/2,o.y+o.h/2),game.ctx.shadowBlur=10,o.color?(game.ctx.fillStyle="rgba("+o.color.r+","+o.color.g+","+o.color.b+","+o.color.a+")",game.ctx.shadowColor="rgba("+o.color.r+","+o.color.g+","+o.color.b+","+o.color.a+")"):(game.ctx.fillStyle="rgba(200,200,200,1)",game.ctx.shadowColor="#00f"),game.ctx.fillRect(-o.w/2,-o.h/2,o.w,o.h),game.ctx.translate(-(o.x+o.w/2),-(o.y+o.h/2)),game.ctx.restore()}if("gameover"==t.state&&(game.ctx.fillStyle="#ff0000",game.ctx.fillText("Game Over",t.screen.x/2-80,t.screen.y/2),game.ctx.fillText("Your score "+t.score,t.screen.x/2-80,t.screen.y/2+40)),"running"==t.state||"intro"==t.state){for(var a in t.enemys)t.enemys[a].draw();t.ball.onDraw(),t.player.draw(),game.ctx.fillStyle="rgba(200,200,200,1)",game.ctx.shadowColor="#ccc",game.ctx.fillRect(10,10,game.ball.bounds.x,game.ball.bounds.y),game.ctx.font="bold 14pt Courier",game.ctx.fillStyle="#333",game.ctx.fillText("x "+game.score,15+game.ball.bounds.x,10+game.ball.bounds.y),game.ctx.font="bold 14pt Courier",game.ctx.fillStyle="#333",game.ctx.fillText(game.stageIndex+1+"/"+game.stages.length+" Stages",game.screen.x-130,30)}if("gamecomplete"==t.state&&(game.ctx.fillStyle="#ffff00",game.ctx.fillText("Game complete",t.screen.x/2-120,t.screen.y/2),game.ctx.shadowBlur=t.glow.value,game.ctx.font="bold 14pt Courier",game.ctx.fillText("Pixels from outerspace",t.screen.x/2-120,t.screen.y/2+20),game.ctx.fillText("Your score "+t.score,t.screen.x/2-120,t.screen.y/2+40)),"complete"==t.state&&(t.createParticles(Math.random()*t.screen.x,Math.random()*t.screen.y,{r:Math.round(255*Math.random()),g:Math.round(255*Math.random()),b:Math.round(255*Math.random()),a:1},10,10),game.ctx.fillStyle="#ffff00",game.ctx.shadowBlur=t.glow.value,game.ctx.fillText("Stage complete",t.screen.x/2-120,t.screen.y/2)),"dialog"==t.state){game.ctx.fillStyle="rgba(200,200,200,0.7)",game.ctx.shadowColor="#ccc",game.ctx.shadowBlur=t.glow.value,game.ctx.fillRect(10,t.screen.y-100,t.screen.x-20,t.screen.y-(t.screen.y-90)),game.ctx.font="bold 10pt Courier",game.ctx.fillStyle="#333",game.ctx.shadowBlur=0;var r,i=StringSplitter(t.currentDialog,21);for(r in i)game.ctx.fillText(">> "+i[r],15,t.screen.y-85+12*r)}game.ctx.shadowColor="#000",game.ctx.shadowBlur=5,game.ctx.drawImage(game.lines,0,0,game.lines.width,game.lines.height,0,0,game.screen.x,game.screen.y)},Game.prototype.areEnemysAlive=function(){return 0<this.enemys.length},Game.prototype.isInScreen=function(e,t){return 0<e&&e<this.screen.x&&0<t&&t<this.screen.y},Game.prototype.collides=function(e,t,s,o,a,r,i,l){return a<e+s&&e<a+i&&r<t+o&&t<r+l},Game.prototype.createParticles=function(e,t,s,o,a,r){var l=10|r;for(i=0;i<360/(360/a);i++)this.particles.push({x:e,y:t,vx:Math.cos(i)*(Math.random()*l*2-l),vy:Math.sin(i)*(Math.random()*l*2-l),w:5,h:5,color:s,life:o})},Game.prototype.createExplosion=function(e,t){for(i=0;i<30;i++)this.particles.push({x:e,y:t,vx:10*Math.cos(i),vy:10*Math.sin(i),w:5,h:5,color:{r:200,g:200,b:200,a:1},life:100})},Mob.prototype.update=function(){},Mob.prototype.draw=function(){},Player.prototype.draw=function(){for(var e in game.ctx.save(),game.ctx.translate(this.x,this.y),game.ctx.shadowBlur=10,this.tiles)e=this.tiles[e],game.ctx.fillStyle="rgba("+e.color.r+","+e.color.g+","+e.color.b+","+e.color.a+")",game.ctx.shadowColor="rgba("+e.color.r+","+e.color.g+","+e.color.b+","+e.color.a+")",game.ctx.fillRect(e.x,e.y,e.w,e.h);for(var t in game.ctx.translate(-this.x,-this.y),game.ctx.restore(),this.guns)this.guns[t].draw();game.ctx.shadowColor="rgba(255,180,0,1)",game.ctx.shadowBlur=10,game.ctx.fillStyle="rgba(255,255,0,1)",game.ctx.fillRect(game.screen.x-70,game.screen.y-25,50,5),game.ctx.fillStyle="rgba(255,0,0,1)",game.ctx.fillRect(game.screen.x-70,game.screen.y-25,this.life/100*50,5),game.ctx.font="8pt Courier",game.ctx.fillText("life "+this.life+"%",game.screen.x-150,game.screen.y-20)},Player.prototype.update=function(){if(this.life<=0&&!this.alive&&(game.createExplosion(this.x+this.w/2,this.y),this.alive=!1),game.controller.keys[87]?this.v.y=-5:this.v.y=0,game.controller.keys[83]&&(this.v.y=5),game.controller.keys[65]?this.v.x=-5:game.controller.keys[68]?this.v.x=5:this.v.x=0,game.player.shoot(),game.controller.keys[32])for(var e in this.guns)"Rocketlauncher"==(t=this.guns[e]).name&&t.shoot();for(var e in this.guns){var t=this.guns[e];this.guns[e].update()}game.isInScreen(this.x+this.w+this.v.x,this.y+this.h)&&game.isInScreen(this.x+this.v.x,this.y+this.h)&&game.isInScreen(this.x,this.y+this.h+this.v.y)&&game.isInScreen(this.x,this.y+this.v.y)?(this.x+=this.v.x,this.y+=this.v.y):game.stageComplete&&(game.finish=!0)},Player.prototype.shoot=function(){for(var e in this.guns)(e=this.guns[e]).shoot(this.x+e.x+(Math.random()*this.spread-this.spread/2),this.y+e.y-this.h)},Controller.prototype.keyDown=function(e){this.keys[e]=!0},Controller.prototype.keyUp=function(e){this.keys[e]=!1},Controller.prototype.getKeyCode=function(e){return(e=e||window.event).keyCode},Enemy.prototype.update=function(){for(var e in this.guns)this.guns[e].update();game.isInScreen(this.x+this.w,this.y)&&game.isInScreen(this.x+this.w,this.y)||(this.vx=-1*this.vx),this.shoot(),this.x+=this.vx,this.y+=this.vy},Enemy.prototype.draw=function(){for(var e in game.ctx.save(),game.ctx.translate(this.x,this.y),game.ctx.shadowBlur=10,this.tiles)e=this.tiles[e],game.ctx.fillStyle="rgba("+e.color.r+","+e.color.g+","+e.color.b+","+e.color.a+")",game.ctx.shadowColor="rgba("+e.color.r+","+e.color.g+","+e.color.b+","+e.color.a+")",game.ctx.fillRect(e.x,e.y,e.w,e.h);for(var t in game.ctx.translate(-this.x,-this.y),game.ctx.restore(),this.guns)this.guns[t].draw()},Enemy.prototype.shoot=function(){for(var e in this.guns)(e=this.guns[e]).shoot(this.x+e.x+(Math.random()*this.spread-this.spread/2),this.y+e.y-e.h/2+this.h)},Scout.prototype=new Enemy,Scout.prototype.constructor=Enemy,Destructor.prototype=new Enemy,Destructor.prototype.constructor=Enemy,Drone.prototype=new Enemy,Drone.prototype.constructor=Enemy,Mothership.prototype=new Enemy,Mothership.prototype.constructor=Enemy,GunBase.prototype.draw=function(){for(var e in this.bullets)e=this.bullets[e],game.ctx.save(),game.ctx.translate(e.x,e.y),game.ctx.shadowBlur=20,game.ctx.fillStyle="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")",game.ctx.shadowColor="rgba("+this.color.r+","+this.color.g+","+this.color.b+","+this.color.a+")",game.ctx.fillRect(0,0,this.w,this.h),game.ctx.translate(-e.x,-e.y),game.ctx.restore()},GunBase.prototype.update=function(){for(var e in this.reloadStep>=this.reloadSpeed&&!this.canShoot?(this.canShoot=!0,this.reloadStep=0):this.canShoot||this.reloadStep++,this.bullets){var t=this.bullets[e];if(t.active){for(var s in t.x+=Math.cos(t.r)*t.v,t.y+=Math.sin(t.r)*t.v,game.enemys)s=game.enemys[s],game.collides(t.x,t.y,this.w,this.h,s.x,s.y,s.w,s.h)&&(game.createParticles(t.x,t.y,getColor(255,50,0,1),20,10),game.createParticles(t.x,t.y,getColor(255,250,0,1),5,5),s.life-=this.damage,t.active=!1),game.collides(t.x,t.y,this.w,this.h,game.player.x,game.player.y,game.player.w,game.player.h)&&(game.createParticles(t.x,t.y,getColor(255,50,0,1),20,10),game.createParticles(t.x,t.y,getColor(255,250,0,1),5,5),game.player.life-=this.damage,t.active=!1);game.isInScreen(t.x,t.y)||(t.active=!1)}else this.bullets.splice(e,1)}},GunBase.prototype.shoot=function(e,t){this.canShoot&&(this.bullets.push({x:e,y:t,v:10,r:this.r,vx:0,vy:-5,active:!0}),this.canShoot=!1)},LaserGun.prototype=new GunBase,BomberGun.prototype=new GunBase,GetlingGun.prototype=new GunBase,PlayerGun.prototype=new GunBase,Ball.prototype.onUpdate=function(){this.x+=this.v.x,this.y+=this.v.y,this.y+this.v.y<=0&&(this.v.y*=-1,this.v.dir=1,game.score++),(this.x-this.bounds.x/2<=0||this.x+this.bounds.x/2>=game.screen.x)&&(this.v.x*=-1),(this.glow.value<this.glow.min||this.glow.value>this.glow.max)&&(this.glow.fac*=-1),this.glow.value+=this.glow.fac,game.isInScreen(this.x,this.y+this.v.y,this.bounds.x,this.bounds.y)||(game.score=0,this.create()),game.collides(this.x-this.bounds.x/2,this.y+this.v.y-this.bounds.y/2,this.bounds.x,this.bounds.y,game.player.x,game.player.y,game.player.w,game.player.h)&&(this.v.y*=-1,this.v.dir=-1)},Ball.prototype.onDraw=function(){game.ctx.translate(this.x-this.bounds.x/2,this.y-this.bounds.y/2),game.ctx.fillStyle="rgba(200,200,200,1)",game.ctx.shadowColor="rgba(200,200,200,1)",game.ctx.shadowBlur=this.glow.value,game.ctx.fillRect(0,0,this.bounds.x,this.bounds.y),game.ctx.translate(-(this.x-this.bounds.x/2),-(this.y-this.bounds.y/2))},Ball.prototype.create=function(){this.x=this.spawn.x,this.y=this.spawn.y},game=new Game</script>