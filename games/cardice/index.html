<meta><title>Cardice</title><style>.ls{position:relative;display:flex;flex-direction:column;align-items:center;justify-content:space-around;width:100%;min-height:100vh;padding:20px;z-index:3}.ls:not(.-active){display:none}.ls:not(.-overBar){z-index:1;padding-top:90px}.ls.-overlay{background:rgba(0,0,0,.7)}button{position:relative;display:inline-flex;align-items:center;justify-content:center;padding:10px 40px;max-width:350px;min-height:50px;background:#f92;border:0;color:#741;font-size:18px;cursor:pointer}button[disabled]{cursor:not-allowed;background:#666}[draggable=true]{cursor:grab}.c-linkList{display:flex;flex-direction:column}.c-linkList>*{margin-bottom:10px}.d{position:relative;display:grid;grid-template-columns:1fr;grid-template-rows:1fr;width:70px;height:70px;list-style-type:none;transform-style:preserve-3d;transition:transform 1.5s ease-out;margin:0 20px}.d.or{transition:transform 1.25s ease-out}.df{display:grid;grid-column:1;grid-row:1;grid-template-areas:"a b c" "d e f" "g h i";grid-template-columns:repeat(3,1fr);grid-template-rows:repeat(3,1fr);height:100%;padding:8.75px;width:100%;background:#fff;border:1px solid #633}.dd{display:block;position:relative;width:14px;height:14px;align-self:center;justify-self:center;background-color:#633}.dd:before{content:"";width:14px;height:0;position:absolute;top:0;left:0;border-bottom:4.08879px solid #633;border-left:4.08879px solid #fff;border-right:4.08879px solid #fff}.dd:after{content:"";width:14px;height:0;position:absolute;bottom:0;left:0;border-top:4.08879px solid #633;border-left:4.08879px solid #fff;border-right:4.08879px solid #fff}.d__effect{position:absolute;top:calc(100% + 10px);left:0;width:100%}[data-roll="1"]{transform:rotateX(360deg) rotateY(720deg) rotateZ(360deg)}[data-roll="2"]{transform:rotateX(450deg) rotateY(720deg) rotateZ(360deg)}[data-roll="3"]{transform:rotateX(360deg) rotateY(630deg) rotateZ(360deg)}[data-roll="4"]{transform:rotateX(360deg) rotateY(810deg) rotateZ(360deg)}[data-roll="5"]{transform:rotateX(270deg) rotateY(720deg) rotateZ(360deg)}[data-roll="6"]{transform:rotateX(360deg) rotateY(900deg) rotateZ(360deg)}.or[data-roll="1"]{transform:rotateX(-360deg) rotateY(-720deg) rotateZ(-360deg)}.or[data-roll="2"]{transform:rotateX(-270deg) rotateY(-720deg) rotateZ(-360deg)}.or[data-roll="3"]{transform:rotateX(-360deg) rotateY(-810deg) rotateZ(-360deg)}.or[data-roll="4"]{transform:rotateX(-360deg) rotateY(-630deg) rotateZ(-360deg)}.or[data-roll="5"]{transform:rotateX(-450deg) rotateY(-720deg) rotateZ(-360deg)}.or[data-roll="6"]{transform:rotateX(-360deg) rotateY(-900deg) rotateZ(-360deg)}[data-side="1"]{transform:rotate3d(0,0,0,90deg) translateZ(35px)}[data-side="2"]{transform:rotate3d(-1,0,0,90deg) translateZ(35px)}[data-side="3"]{transform:rotate3d(0,1,0,90deg) translateZ(35px)}[data-side="4"]{transform:rotate3d(0,-1,0,90deg) translateZ(35px)}[data-side="5"]{transform:rotate3d(1,0,0,90deg) translateZ(35px)}[data-side="6"]{transform:rotate3d(1,0,0,180deg) translateZ(35px)}.dd:last-child{grid-area:i}[data-side="4"] .dd:nth-child(2),[data-side="5"] .dd:nth-child(2),[data-side="6"] .dd:nth-child(2){grid-area:c}[data-side="6"] .dd:nth-child(3){grid-area:d}[data-side="1"] .dd,[data-side="3"] .dd:nth-child(2),[data-side="5"] .dd:nth-child(3){grid-area:e}[data-side="6"] .dd:nth-child(4){grid-area:f}[data-side="4"] .dd:nth-child(3),[data-side="5"] .dd:nth-child(4),[data-side="6"] .dd:nth-child(5){grid-area:g}#pa{position:absolute;bottom:10px;left:10px}#oa{position:absolute;top:80px;right:10px}#oa p,#pa p{position:absolute;opacity:.5;font-size:40px;white-space:nowrap;transform:scale(.7);transition:all .5s ease-out}#oa p.-loaded,#pa p.-loaded{opacity:1;transform:scale(1)}#pa p{bottom:100%;left:0}#oa p{top:100%;right:0}.c{position:relative;transition:all .5s}.c.-active{transform:scale(1.2);z-index:2}.c.-highlight .cd{background:rgba(255,255,255,.2)}.c.p{transform:scale(1) translateY(-200px);opacity:0;pointer-events:none}.c.-buyable{cursor:pointer}.c:not(.-buyable) .c__price{color:#999}.c b{white-space:nowrap;font-size:16px}.c i{display:inline-block;vertical-align:middle;width:18px;height:18px;border:1px dashed #fff;margin-right:2px;background:rgba(0,0,0,.2)}.co{width:180px;height:250px;border:2px solid #bbb;backface-visibility:hidden;perspective-origin:50% 50%;transform-style:preserve-3d;transform-origin:center}.co:before{content:'';display:block;position:absolute;top:10px;left:10px;right:10px;bottom:10px;background:rgba(255,255,255,.3);border:1px solid #111}.co.r2{border-color:#6ee}.co.r3{border-color:#fc5}.co.-w{background:#f33}.co.-m{background:#f72}.co.-t{background:#38f}.co.-a{background:#a28}.co.-p{background:#e4b321}.co.-h{background:#66c01c}.co.-n{background:#aaa}.co.-mw{background:linear-gradient(to bottom,#f72 0,#f33 100%)}.co.-tw{background:linear-gradient(to bottom,#38f 0,#f33 100%)}.co.-aw{background:linear-gradient(to bottom,#a28 0,#f33 100%)}.co.-pw{background:linear-gradient(to bottom,#e4b321 0,#f33 100%)}.co.-hw{background:linear-gradient(to bottom,#66c01c 0,#f33 100%)}.co.-mt{background:linear-gradient(to bottom,#f72 0,#38f 100%)}.co.-am{background:linear-gradient(to bottom,#f72 0,#a28 100%)}.co.-mp{background:linear-gradient(to bottom,#f72 0,#e4b321 100%)}.co.-hm{background:linear-gradient(to bottom,#66c01c 0,#f72 100%)}.co.-at{background:linear-gradient(to bottom,#a28 0,#38f 100%)}.co.-ap{background:linear-gradient(to bottom,#a28 0,#e4b321 100%)}.co.-pt{background:linear-gradient(to bottom,#e4b321 0,#38f 100%)}.co.-ht{background:linear-gradient(to bottom,#66c01c 0,#38f 100%)}.co.-ah{background:linear-gradient(to bottom,#a28 0,#66c01c 100%)}.co.-hp{background:linear-gradient(to bottom,#66c01c 0,#e4b321 100%)}.ce{position:absolute;top:155px;transform:translateY(-50%);left:20px;right:20px;font-size:14px;line-height:1.5}.ce br{display:block;margin-bottom:10px;content:''}.c__back{position:relative;display:flex;align-items:center;justify-content:center;width:100%;height:100%;border:1px solid #111;background-color:#4de;color:#2bc;overflow:hidden;font:bold 120px sans-serif}.c__back:before{content:'4';position:absolute;top:-55px;left:-20px}.c__back:after{content:'4';position:absolute;bottom:-35px;right:-10px}.cdl{position:absolute;top:40px;left:0;right:0;display:flex;justify-content:center}.cd{display:flex;justify-content:center;align-items:center;width:60px;height:60px;border:2px dashed #fff;margin:0 5px;font-size:14px;line-height:1.2;background:rgba(0,0,0,.2)}.cList{display:grid;width:80%;margin:50px 0;grid-template-columns:repeat(auto-fill,minmax(180px,1fr));grid-gap:20px}.cList .c{transition:transform .3s ease;perspective:1000px}.cList .c:hover{transform:scale(1.3);z-index:2}#md{position:absolute;bottom:20px;right:20px;width:126px;height:175px}#md .c{position:absolute;top:0;left:0;width:126px;height:175px}#mh{display:flex;justify-content:center;position:absolute;top:calc(50% - 145px);left:calc(50% - 470px);width:940px;height:250px}#mh .c:not(:last-child){margin-right:10px}*{margin:0;padding:0;color:#fff;font:small-caps 20px sans-serif}*,:after,:before{box-sizing:inherit}body{box-sizing:border-box;text-align:center}body.-loading *{cursor:wait!important}#ach{display:flex;justify-content:center}#ach>div{position:relative;width:16.66667%;max-width:200px;transition:transform .3s ease;perspective:1000px;cursor:pointer}#ach>div:hover{transform:scale(1.2);z-index:2}#ach>div:hover::before{transform:scale(.8)}#ach>div.-choice0::before,#ach>div.-choice1::before{content:'';position:absolute;z-index:-1;top:30px;left:10px;right:10px;bottom:0;background:rgba(119,238,119,.5);transition:transform .3s ease}#ach canvas{width:100%}#oa p,#pa p,#scc p,.ce,.d__effect{text-shadow:0 0 2px #000,0 0 1px #000,0 0 1px #000,0 0 1px #000}#etb{position:absolute;bottom:50px;right:250px}#dl{position:absolute;top:calc(50% + 175px);left:calc(50% - 400px);width:800px;display:flex;align-items:center;justify-content:center;flex-wrap:wrap;perspective:600px}#dl>div{position:relative;transition:transform .4s ease-in-out}#rewardCardList{width:580px}#game-canvas{position:fixed;top:0;left:0;width:100%;height:100%;background:#cee}#sg{overflow:hidden}.c-life{position:absolute}.c-life[data-p="1"]{bottom:90px;left:220px;text-align:left}.c-life[data-p="2"]{top:140px;right:220px;text-align:right}.c-life[data-p="2"] .c-life__bar{transform:scaleX(-1)}.c-life p{position:absolute;top:0;left:0;bottom:0;width:0;background:#77e;transition:width .5s ease}.c-life p:nth-child(2){background:#e77;transition-duration:.3s;transition-delay:1.3s}.c-life p:nth-child(3){background:#7e7;transition-duration:1s;transition-delay:.5s}.c-life b{color:#f93}.c-life__bar{position:relative;width:300px;height:25px;background:#ccc}#sm{padding:0;background:#0bb}#mw{position:relative}#mw p{position:absolute;padding:5px;font-size:20px;min-width:41px;text-align:center;transition:1s ease;border-radius:50%;border:2px solid transparent}#mw p:last-child{font-size:60px}#mw p.-active{cursor:pointer;animation:2s ease infinite a;transform:scale(1.6)}#mw p.-active:hover{background:rgba(0,0,0,.3)}#mw p.-selected{border:2px solid #000;border-color:#000;transform:scale(1.8)}@keyframes a{50%{transform:scale(2.2)}}#screen-rules ul{list-style:none;padding-left:50px;text-align:left}#screen-rules>ul>li{margin-bottom:15px}.a-title{position:relative;margin-bottom:50px;padding:10px 60px;background:#f92;box-shadow:0 16px 0 -8px;color:#741;font:bold small-caps 40px serif}.a-title:after,.a-title:before{content:'';width:90px;height:100%;position:absolute;top:50%;background:#f92;box-shadow:inherit;z-index:-1}.a-title:before{left:-55px}.a-title:after{right:-55px}#c-userBar{position:fixed;top:0;left:0;right:0;height:70px;display:flex;justify-content:space-between;align-items:center;background:#333;z-index:2}#c-userBar ul{display:flex}#c-userBar li{display:block;padding:20px}#js-end-score-list{max-width:500px;width:100%;list-style:none;text-align:left}#js-end-score-list li{display:flex;justify-content:space-between;margin-bottom:20px}</style><canvas id=game-canvas></canvas><div id=c-userBar style=display:none><ul><li id=playerClass><li id=playerLife><li id=playerGold><li id=playerFloor></ul><p><button class=jsl data-sc=screen-my-deck>My deck</button> <button class=jsl data-sc=screen-menu>Menu</button></div><div id=screen-main-menu class="ls -overBar -active"><p class=a-title>Cardice<p>Princess Page is missing.<br>Find your way to defeat the evil monster 😈 and bring her back!<div class=c-linkList><button class=jsl data-sc=scc>New game</button> <button class=jsl data-sc=screen-rules>Rules</button></div><div id=acl class=cList style=display:none></div></div><div id=screen-menu class="ls -overlay -overBar"><p class=a-title>Menu<div class=c-linkList><button class=jsl data-sc=back>Back</button> <button class=jsl data-sc=screen-end>Exit to main menu</button></div></div><div id=scc class="ls -overBar"><h1 class=a-title>Create you hero</h1><p>Pick up 2 classes<div id=ach data-t0=w data-t1=w></div><p>You are:<div id=ma></div><button class=jsl data-sc=sm>Start game</button></div><div id=sm class=ls><div id=mw><canvas id=map></canvas></div></div><div id=screen-rules class="ls -overlay -overBar"><p class=a-title>Game rules<ul><li>Pick a hero<li>Drag and drop dice on cards to play them<li>Several types of encounters:<ul><li>💀: Basic enemy<li>👿: Elite enemy<li>😈: Final boss<li>💰: Treasure<li>🤑: Card dealer<li>💖: Healing spot<li>❓: Random event</ul><li>Several special effects:<ul><li>😵 Stun: 50% chance for the dice not to work<li>🤢 Poison: Damage every round<li>❄ Freeze: Highest dice value recuced to 1<li>🔥 Fire: 5 damage when the dice is played<li>🛡 Shield: Prevent next damage for one turn</ul></ul><button class=jsl data-sc=screen-main-menu>Back</button></div><div id=sg class=ls><div class=c-life data-p=1><div class=c-life__bar><p><p><p></div><b>100/100</b></div><div class=c-life data-p=2><div class=c-life__bar><p><p><p></div><b>100/100</b></div><div id=mh></div><div id=md></div><div id=pa></div><div id=oa></div><div id=dl></div><button id=etb type=button>End turn</button></div><div id=screen-my-deck class="ls -overlay"><p class=a-title>My deck<p id=my-deck-remove-mention>To remove a card, click on it (💰: 100)<div id=mcl class=cList></div><button class=jsl data-sc=back>Back</button></div><div id=screen-reward class="ls -overlay"><p class=a-title>Some rewards!<p id=gold-reward></p><button class=jsl data-sc=screen-card-add>Add a card to your deck</button></div><div id=screen-heal class="ls -overlay"><p class=a-title>You are healed!<p>You are healed of 30% of your missing life 💖.</p><button class=jsl data-sc=sm>Back to map</button></div><div id=screen-card-add class="ls -overlay"><p class=a-title>Pick up a card<div id=rewardCardList class=cList></div><button class=jsl data-sc=sm>Skip</button></div><div id=screen-seller class="ls -overlay"><p class=a-title>Seller<p>Click a card to buy it<div id=sellerCardList class=cList></div><div class=c-linkList><button class=jsl data-sc=screen-my-deck id=remove-card-link>Remove a card (💰: 100)</button> <button class=jsl data-sc=sm>Back to map</button></div></div><div id=screen-end class="ls -overlay"><div id=js-victory-content><p class=a-title>Victory<p>You have found Page! Congratulations!</div><div id=js-defeat-content><p class=a-title>Defeat<p>Thank you for playing!</div><ul id=js-end-score-list></ul><p id=js-end-score></p><button class=jsl data-sc=screen-main-menu>Back to menu</button></div><script>!function(){var e=e=>document.getElementById(e),t=e=>document.querySelector(e),a=e=>document.querySelectorAll(e),r=e=>document.createElement(e),d=()=>Math.random(),n=Math.PI,l=2*n;function i(e){return e[~~(d()*e.length)]}function s(e,t){return~~(d()*(t-e+1))+e}let c=0;function o(e,t){1==++c&&document.body.classList.add("-loading"),setTimeout((()=>{t(),0==--c&&document.body.classList.remove("-loading")}),e)}var f={w:"#f33",m:"#f72",t:"#38f",a:"#a28",p:"#fc3",h:"#7d2"};const h={w:"Warrior",m:"Fire mage",t:"Ice mage",a:"Assassin",p:"Protector",h:"Healer",mw:"Battlemage",tw:"Rogue",aw:"Slayer",pw:"Paladin",hw:"Templar",mt:"Warlock",am:"Dreamkiller",mp:"Guardian",hm:"Runemaster",at:"Ninja",pt:"Brigand",ht:"Trickster",ap:"Ranger",ah:"Avenger",hp:"Sage"},u={m:"💀",e:"👿",b:"😈",t:"💰",r:"❓",s:"🤑",h:"💖"};var m=e("acl"),g=e("mcl"),p=e("sellerCardList"),b=e("ach"),$=e("ma"),v=e("map"),y=e("pa"),w=e("oa"),k=e("c-userBar"),L=e("md"),x=e("mh"),T=e("etb"),A=e("mw"),S=e("rewardCardList"),X=(e("sg"),e("remove-card-link"));let z=e("dl"),M=[];const C=12,E=130;let j=[],q=0,D=!1,B={set:function(a,r,d){a[r]=d;let n=`💖 ${a.l}/${a.m}`;a.sh&&(n+=` 🛡 ${a.sh}`),a.p&&(n+=` 🤢 ${a.p}`),a.freeze&&(n+=` ❄ ${a.freeze}`),a.burn&&(n+=` 🔥 ${a.burn}`),a.stun&&(n+=` 😵 ${a.stun}`),t(`.c-life[data-p="${a.id}"] b`).innerText=n,1==a.id&&(e("playerClass").innerText=G(H.c),e("playerLife").innerText=`💖 ${H.l}/${H.m}`,e("playerGold").innerText=`💰 ${H.g}`,e("playerFloor").innerText=`👣 ${H.f+1}`)}},H=new Proxy({id:1,m:100,l:100,sh:0,p:0,freeze:0,burn:0,stun:0,g:150,f:0,s:""},B),O=new Proxy({id:2,m:15,l:15,sh:0,p:0,freeze:0,burn:0,stun:0},B),I=null,P=[{c:"w",r:1,d:"",e:"damage|X"},{c:"w",r:1,d:"odd",e:"damage|3,stun|1"},{c:"w",r:1,d:"-4",e:"damage|X*2,reflect|X"},{c:"w",r:1,d:"+4",e:"damage|X,6:stun|1"},{c:"w",r:2,d:"-4",e:"damage|X*2"},{c:"w",r:2,d:"+4",e:"damage|X,6:stun|1"},{c:"w",r:2,d:"6",e:"damage|X+2"},{c:"w",r:3,d:"6|6",e:"damage|X,stun|5"},{c:"w",r:3,d:"+4",e:"damage|X*3,reflect|X"},{c:"m",r:1,d:"",e:"damage|X"},{c:"m",r:1,d:"odd",e:"damage|X,burn|1"},{c:"m",r:1,d:"even",e:"damage|X,burn|1"},{c:"m",r:1,d:"5",e:"damage|3,burn|1"},{c:"m",r:2,d:"",e:"damage|X,5:burn|1"},{c:"m",r:2,d:"+4",e:"damage|X*2,burn|1"},{c:"m",r:2,d:"5",e:"damage|8"},{c:"m",r:3,d:"5|5",e:"burn|5"},{c:"m",r:3,d:"+4",e:"damage|X*2,burn|1"},{c:"t",r:1,d:"",e:"damage|X"},{c:"t",r:1,d:"odd",e:"damage|X,freeze|1"},{c:"t",r:1,d:"even",e:"damage|X,freeze|1"},{c:"t",r:1,d:"1",e:"damage|3,freeze|1"},{c:"t",r:2,d:"",e:"damage|X,1:freeze|1"},{c:"t",r:2,d:"-3",e:"damage|X*2,freeze|1"},{c:"t",r:2,d:"1",e:"damage|6"},{c:"t",r:3,d:"1|1",e:"freeze|5"},{c:"t",r:3,d:"+4",e:"damage|X*2,freeze|1"},{c:"a",r:1,d:"-3",e:"damge|3,poison|1"},{c:"a",r:1,d:"+4",e:"poison|2"},{c:"a",r:1,d:"-2",e:"damage|X,reroll|X"},{c:"a",r:1,d:"+3",e:"damage|3,reroll|<"},{c:"a",r:2,d:"-3",e:"poison|2,reroll|<"},{c:"a",r:2,d:"",e:"damage|X,2:poison|2"},{c:"a",r:2,d:"-3",e:"poison|X"},{c:"a",r:3,d:"even",e:"damage|p"},{c:"a",r:3,d:"2|2",e:"poison|8"},{c:"p",r:1,d:"",e:"damage|X"},{c:"p",r:1,d:"",e:"shield|X"},{c:"p",r:1,d:"-4",e:"damage|X,shield|2"},{c:"p",r:1,d:"-4",e:"damage|4,shield|X"},{c:"p",r:2,d:"",e:"shield|X"},{c:"p",r:2,d:"4",e:"damage|s"},{c:"p",r:3,d:"even",e:"damage|s*2"},{c:"p",r:3,d:"4|4",e:"shield|12,damage|4"},{c:"h",r:1,d:"",e:"damage|X"},{c:"h",r:1,d:"",e:"heal|3"},{c:"h",r:1,d:"-4",e:"damage|X,heal|2"},{c:"h",r:1,d:"-4",e:"damage|3"},{c:"h",r:2,d:"|",e:"shield|X"},{c:"h",r:3,d:"3|3",e:"heal|12,damage|3"},{c:"n",r:1,d:"-5",e:"reroll|X+1"},{c:"n",r:1,d:"+2",e:"reroll|X-1"},{c:"n",r:2,d:"+2",e:"split|X"},{c:"n",r:3,d:"",e:"duplicate|X"},{c:"mw",r:1,d:"",e:"odd:damage|3,even:burn|1"},{c:"mw",r:2,d:"",e:"damage|3,burn|1"},{c:"mw",r:3,d:"5|6",e:"damage|10,burn|5"},{c:"tw",r:1,d:"",e:"odd:damage|3,even:freeze|1"},{c:"tw",r:2,d:"",e:"damage|3,freeze|1"},{c:"tw",r:3,d:"1|6",e:"damage|10,freeze|5"},{c:"aw",r:1,d:"",e:"odd:damage|3,even:poison|2"},{c:"aw",r:2,d:"",e:"damage|3,poison|2"},{c:"aw",r:3,d:"6|2",e:"damage|10,poison|5"},{c:"pw",r:1,d:"",e:"odd:damage|3,even:shield|4"},{c:"pw",r:2,d:"",e:"damage|3,shield|4"},{c:"pw",r:3,d:"6|4",e:"damage|10,shield|8"},{c:"hw",r:1,d:"",e:"odd:damage|X,even:heal|3"},{c:"hw",r:2,d:"",e:"damage|X,heal|3"},{c:"hw",r:3,d:"6|3",e:"damage|10,heal|6"},{c:"mt",r:1,d:"",e:"odd:burn|1,even:freeze|1"},{c:"mt",r:2,d:"",e:"burn|1,freeze|1"},{c:"mt",r:3,d:"5|1",e:"burn|5,freeze|5"},{c:"am",r:1,d:"",e:"odd:burn|1,even:poison|2"},{c:"am",r:2,d:"",e:"burn|1,poison|2"},{c:"am",r:3,d:"2|5",e:"burn|5,poison|5"},{c:"mp",r:1,d:"",e:"odd:burn|1,even:shield|4"},{c:"mp",r:2,d:"",e:"burn|1,shield|4"},{c:"mp",r:3,d:"5|4",e:"burn|5,shield|8"},{c:"hm",r:1,d:"",e:"odd:burn|1,even:heal|3"},{c:"hm",r:2,d:"",e:"burn|1,heal|3"},{c:"hm",r:3,d:"5|3",e:"burn|5,heal|6"},{c:"at",r:1,d:"",e:"odd:poison|2,even:freeze|1"},{c:"at",r:2,d:"",e:"poison|2,freeze|1"},{c:"at",r:3,d:"1|2",e:"poison|5,freeze|5"},{c:"pt",r:1,d:"",e:"odd:shield|4,even:freeze|1"},{c:"pt",r:2,d:"",e:"shield|4,freeze|1"},{c:"pt",r:2,d:"1|4",e:"shield|8,freeze|5"},{c:"ht",r:1,d:"",e:"odd:heal|3,even:freeze|1"},{c:"ht",r:2,d:"",e:"heal|3,freeze|1"},{c:"ht",r:2,d:"1|3",e:"heal|6,freeze|5"},{c:"ap",r:1,d:"",e:"odd:shield|4,even:poison|2"},{c:"ap",r:2,d:"",e:"shield|4,poison|2"},{c:"ap",r:2,d:"2|4",e:"shield|8,poison|5"},{c:"ah",r:1,d:"",e:"odd:heal|3,even:poison|2"},{c:"ah",r:2,d:"",e:"heal|3,poison|2"},{c:"ah",r:2,d:"3|2",e:"heal|6,poison|5"},{c:"hp",r:1,d:"",e:"odd:heal|3,even:shield|4"},{c:"hp",r:2,d:"",e:"heal|3,shield|4"},{c:"hp",r:2,d:"3|4",e:"heal|6,shield|8"}],F={},R={};for(card of P)R[card.c]=R[card.c]?++R[card.c]:1,F[`${card.c}${R[card.c]}`]=card;var N=0;function W(e,t){let a=_(e,t);$.innerHTML="",$.append(a),H.c=e+t}function _(e,t,a=!0){let d=r("div"),i=r("canvas"),s=i.getContext("2d");return i.width=200,i.height=200,function(e,t,a,r){const d=e.width;var n=t.createLinearGradient(.2*d,.2*d,.6*d,d);n.addColorStop(0,a),n.addColorStop(1,r),Y(t,n,.5*d,.6*d,.4*d,0,l),Y(t,"#c98",.45*d,.5*d,.25*d,0,l),Y(t,"#235",d/1.7,d/2.2,d/35,0,l),Y(t,"#235",d/2.2,d/2.2,d/35,0,l)}(i,s,f[e],f[t]),function(e,t,a){const r=e.width;switch(a){case"w":Y(t,"#aaa",.45*r,.5*r,.26*r,1.05*n,1.9*n),J(t,"#aaa",.33*r,.3*r,.2*r,.2*r,.28*r,.4*r),J(t,"#aaa",.56*r,.3*r,.7*r,.2*r,.62*r,.4*r);break;case"m":J(t,"#a31",.2*r,.3*r,.75*r,.38*r,.5*r,.1*r),J(t,"#a31",.28*r,.3*r,.7*r,.38*r,.52*r,0*r);break;case"t":Y(t,"#128",.45*r,.5*r,.25*r,1.9*-n,1.1*-n),J(t,"#128",.55*r,.5*r,.7*r,.58*r,.2*r,.58*r);break;case"a":Y(t,"#333",.45*r,.5*r,.25*r,2*n,n);break;case"p":Y(t,"#aaa",.45*r,.5*r,.3*r,1.05*n,1.95*n),Y(t,"#aaa",.45*r,.5*r,.27*r,2*n,n);break;case"h":J(t,"#242",.2*r,.3*r,.75*r,.38*r,.5*r,.1*r),J(t,"#242",.28*r,.3*r,.7*r,.38*r,.52*r,0*r)}}(i,s,e),function(e,t,a){const r=e.width;switch(a){case"w":J(t,"#999",.75*r,.47*r,.9*r,.4*r,.86*r,.6*r),J(t,"#421",.6*r,r,.8*r,.4*r,.68*r,r);break;case"m":J(t,"#421",.6*r,r,.8*r,.4*r,.68*r,r),Y(t,"#a22",.8*r,.42*r,.1*r,0,l);break;case"t":J(t,"#421",.6*r,r,.8*r,.4*r,.68*r,r),Y(t,"#22a",.8*r,.42*r,.1*r,0,l);break;case"a":J(t,"#999",.6*r,r,.72*r,.6*r,.68*r,r);break;case"p":Y(t,"#444",.67*r,.75*r,.14*r,0,l),J(t,"#444",.7*r,.95*r,.42*r,.65*r,.88*r,.6*r);break;case"h":J(t,"#421",.6*r,r,.8*r,.4*r,.68*r,r),Y(t,"#481",.8*r,.42*r,.1*r,0,l)}}(i,s,t),V(d),d.append(i),a&&d.insertAdjacentHTML("beforeend",`<p>${G(e+t)}</p>`),d}function G(e){return h[U(e)]}function Y(e,t,a,r,d,n,l,i){e.fillStyle=t,e.beginPath(),e.arc(a,r,d,n,l,i),e.fill()}function J(e,t,a,r,d,n,l,i){e.fillStyle=t,e.beginPath(),e.moveTo(a,r),e.lineTo(d,n),e.lineTo(l,i),e.fill()}function K(e,t,a){t.innerHTML="";for(const r of Object.values(e)){let e=Q(r);V(e),t.append(e),a&&(e.style.cursor="pointer",e.onclick=()=>{a(r)})}}function Q(e,t=-1){let a=F[e],d=`<div class="co -${U(e)} r${a.r}"><div class="cdl">`;a.d.split("|").forEach(((e,a)=>{d+=function(e,t=-1,a){let r=t>=0?`data-hand="${t}"`:"",d=e.match(/([-+*]?)([0-9])/),n=e;if(d){let e="";switch(d[1]){case"-":e="max<br/>";break;case"+":e="min<br/>"}n=e+d[2]}return`<p class="cd" ${r} data-die="${a}">${n}</p>`}(e,t,a)})),d+=`</div><p class="ce">${function(e){let t="";return e.split(",").forEach(((e,a)=>{t+=a>0?"<br>":"";let r=e.split("|"),d=r[0].split(":"),n=r[1].replace("X","<i></i>");n=n.replace("*","x");let l=d.length>1?d[0]:"",i=d[d.length-1];switch(t+=l?`On ${l}: `:"",i){case"damage":t+=`Do 💢<b>${n}</b> damage`;break;case"reflect":t+=`Lose 💖<b>${n}</b> life`;break;case"poison":t+=`Do 🤢<b>${n}</b> poison`;break;case"stun":t+=`Stun 😵 <b>${n}</b> dice`;break;case"reroll":t+=`Roll a <b>${"<"==n?"lower":n}</b> die`;break;case"burn":t+=`Burn 🔥 <b>${n}</b> dice`;break;case"heal":t+=`Heal ➕<b>${n}</b> life points`;break;case"split":t+="Split die in two";break;case"duplicate":t+=`Duplicate die <b>${n}</b>`;break;case"shield":t+=`Add 🛡 <b>${n}</b> shield`;break;case"freeze":t+=`Freeze ❄ <b>${n}</b> dice`}})),t}(a.e)}</p>`;let n=r("div");return n.classList.add("c"),t>=0&&(n.dataset.hand=t),n.innerHTML=d,n}function U(e){let t=e.replace(/\d+/,"");return t.length<2||t[0]==t[1]?t[0]:t.split("").sort().join("")}function V(e){e.onmousemove=t=>{let a=t.currentTarget.getBoundingClientRect(),r=Math.max(0,t.pageX-~~a.left),d=Math.max(0,t.pageY-window.scrollY-~~a.top),n=~~a.width,l=~~a.height,i=n/2-r,s=l/2-d,c=Math.sqrt(Math.pow(i,2)+Math.pow(s,2)),o=c/Math.sqrt(Math.pow(n/2,2)+Math.pow(l/2,2));e.firstChild.style.transform=`rotate3d(${s/c}, ${-i/c}, 0, ${20*o}deg)`,e.firstChild.style.filter=`brightness(${1.2-d/l/2})`},e.onmouseleave=()=>{e.firstChild.style.transform="",e.firstChild.style.filter=""}}function Z(e){1==e.id?e.d=[`${e.c[0]}1`,`${e.c[0]}1`,`${e.c[1]}1`,`${e.c[1]}1`,`${e.c[0]}2`,`${e.c[1]}2`,`${e.c[0]}3`,`${e.c[1]}3`,`${U(e.c)}1`]:e.d=[`${e.c[0]}1`,`${e.c[0]}1`,`${e.c[1]}1`,`${e.c[1]}1`,`${e.c[0]}2`,`${e.c[0]}2`,`${e.c[1]}2`,`${e.c[1]}2`,`${U(e.c)}1`]}function ee(e,t,a){t.classList.add("p"),function(e,t,a){let r=1==e.id?O:H,d=e.hand[t.dataset.hand];F[d].e.split(",").forEach(((t,d)=>{let n=t.split("|"),l=n[0].split(":"),i=l.length>1?l[0]:"",c=l[l.length-1],o=function(e,t,a,r){let d=0,n=1;for(let l=0;l<e.length;++l){let i=e[l];"X"==i&&(d+=t),"s"==i&&(d+=a.s),"p"==i&&(d+=r.p),"-"==i&&(n=-1),"*"==i&&(d*=e[++l]),"<"==i&&(d+=s(1,t-1)),isNaN(i)||(d+=n*+i)}return d}(n[1],+a,e,r);if(le(i,a))switch(c){case"damage":ge(r,-o);break;case"reflect":ge(e,-o);break;case"shield":e.sh+=o;break;case"poison":r.p+=o;break;case"stun":++r.stun;break;case"heal":ge(e,o);break;case"freeze":++r.freeze;break;case"burn":++r.burn;break;case"reroll":te(o);break;case"split":let t=s(1,o-1),a=o-t;te(t),te(a);break;case"duplicate":te(o),te(o)}}))}(e,t,a),o(500,(()=>Xe(e,t.dataset.hand)))}function te(e){let t=r("div"),n=r("ol");n.classList.add("d"),d()>.5&&n.classList.add("or");let l="",i="";for(let e=1;e<7;++e)l+=`<li class="df" data-side="${e}">${i+='<span class="dd"></span>'}</li>`;n.innerHTML=l,n.id="die-"+ ++q;let o=e||s(1,6);n.setAttribute("data-roll",o),n.onmouseover=e=>{c>0||de(H,e.currentTarget.getAttribute("data-roll"),(e=>{e.classList.add("-highlight")}))},n.ondragstart=e=>{c>0||(I=e.target.parentNode.id,de(H,e.currentTarget.getAttribute("data-roll"),(e=>{e.classList.add("-highlight")})))},n.onmouseleave=e=>{de(H,e.currentTarget.getAttribute("data-roll"),(e=>{e.classList.remove("-highlight")}))},n.ondragend=e=>{[...a(".c.-highlight")].forEach((e=>{e.classList.remove("-highlight")}))},t.append(n),z.append(t),M.push(o),e&&ae(n,e)}function ae(e,t){t||(e.classList.toggle("or"),t=s(1,6)),e.setAttribute("data-roll",t);let a=e.querySelector("[draggable]");a&&a.removeAttribute("draggable"),e.querySelector(`[data-side="${t}"]`).setAttribute("draggable","true")}function re(e,t){let a=e.nextSibling;a||((a=r("p")).classList.add("d__effect"),e.after(a)),a.innerText+=t}function de(e,t,a){e.hand.forEach(((e,r)=>{if(ne(e,t)){let e=x.querySelector(`[data-hand="${r}"]`);a(e)}}))}function ne(t,a,r=null){if(!t)return!1;let n=F[t].d.split("|"),l=!1,i=!1,s=null;return n.length>1?(l=le(n[0],a))?l=[...z.querySelectorAll(".d")].some(((e,t)=>{let d=e.getAttribute("data-roll");return i||d!=a?(le(n[1],d)&&(s||(s=e)),le(n[1],d)):(e.id!=r&&(s=e),i=!0,!1)})):(l=le(n[1],a))&&(l=[...z.querySelectorAll(".d")].some((e=>{let t=e.getAttribute("data-roll");return i||t!=a?(le(n[0],t)&&(s||(s=e)),le(n[0],t)):(e.id!=r&&(s=e),i=!0,!1)}))):l="double"==n[0]?[...z.querySelectorAll(".d")].some((e=>{let t=e.getAttribute("data-roll");return i||t!=a?(t!=a||s||(s=e),t==a):(e.id!=r&&(s=e),i=!0,!1)})):le(n[0],a),r&&(s&&s.parentNode.remove(),e(r).dataset.stun&&(l=d()>.5),e(r).parentNode.remove()),l}function le(e,t){var a=e.match(/([-+*]?)([0-9])/);if(a)switch(e=a[2],a[1]){case"-":return t<=e;case"+":return t>=e;default:return e==t}return""===e||("odd"===e?t%2:"even"===e?t%2==0:void 0)}var ie=e("game-canvas");let se=[],ce=[],oe=[],fe=Date.now(),he=50;function ue(e){if(requestAnimationFrame(ue),"map"==H.s)return;let t=Date.now(),a=t-fe;a>he&&(fe=t-a%he,function(){let e=ie.getContext("2d");e.clearRect(0,0,ie.width,ie.height),e.fillStyle="#ffa",e.beginPath(),e.arc(ie.width-400,200,180,0,2*n),e.fill(),me(e,"#0bb",se,ie.height-200,ie.height-205,ie.height-195,.1),me(e,"#cff",oe,260,240,280),me(e,"#ffa",ce,200,190,210),e.fillStyle="#cff",e.fill(new Path2D("M661.71 320.09h367.18v-5.44l-7.62-32.24-29.53-26.23-272.72 3.07-57.31 55.4z")),e.fillStyle="#ffa",e.fill(new Path2D("M661.71 314.65l101.49-3.32 76.33 3.32 68.8-2.63 70.83-1.39 49.73 4.02-7.62-37.67-29.53-26.23-272.72 3.06-41.75 27.15z")),e.fillStyle="#7e7",e.fill(new Path2D("M679.77 264.17l20.67 5.64 70.05 5.87 97.65-6.79 92.7 3.4 36.81-6.24 12.15-15.3 9.37-35.97-31.59-28.91-37.61-18.06-110.84-15.06-84.92 6.8-49.53 22.66-33.26 33.99z"))}())}function me(e,t,a,r=0,d,n,l=.2){e.beginPath(),e.fillStyle=t,e.moveTo(0,ie.height),e.lineTo(0,ie.height-r),a.forEach((t=>{t.y+=t.direction*l,(t.y<=d||t.y>=n)&&(t.y=Math.max(d,Math.min(t.y,n)),t.direction*=-1),e.lineTo(t.x,ie.height-t.y)})),e.lineTo(ie.width,ie.height-r),e.lineTo(ie.width,ie.height),e.fill()}function ge(e,t,r=null){if(t<0&&e.sh){if(e.sh>=-t)return void(e.sh+=t);t+=e.sh,e.sh=0}let d=Math.max(0,Math.min(e.m,e.l+~~t));pe(e,r||(t>0?"➕ heal":"💢 damage")),e.l=d,[...a(`.c-life[data-p="${e.id}"] p`)].forEach((t=>{t.style.width=~~(e.l/e.m*100)+"%"})),d<=0&&o(1500,(()=>{H.l<=0?Le("screen-end"):Le("screen-reward")}))}function pe(e,t){var a=r("p");a.innerText=t,1===e.id?y.append(a):w.append(a),a.offsetWidth,a.classList.add("-loaded"),setTimeout((()=>{a.remove()}),600)}let be=[],$e=[],ve=[];function ye(){let e=E;v.width=900,v.height=e*(C+3),j.push([{e:"m"},{e:"m"},{e:"m"}]);let t=0;for(;++t<C;)j.push(we(t%4?"mmmmmmmeeet":"mhhssss"));j.push([{e:"h"},{e:"h"},{e:"h"}]),j.push([{e:"b"}]),function(){for(let t in j){let a=j[t=+t],r=j[t+1];if(r){let t=0;for(let n in a){var e=a[n=+n];if(e.l=[],n>=a.length-1)for(;t<r.length;)e.l.push(t++);else e.l.push(t),r.length>t+1&&(++t,d()>.65&&e.l.push(t))}}}}(),function(){let e=E;for(let[t,a]of Object.entries(j)){t=+t;for(let[r,n]of Object.entries(a)){let l=~~(150*(3.2+(r=+r)+.6*d()-a.length/2));3==a.length&&(0==r&&(l-=70),2==r&&(l+=70));let i=~~(v.height-e*(t+1.1-.4*d())),s=t==j.length-1?60:25;n.x=l,n.y=i;let c="sg";"h"==n.e&&(c="screen-heal"),"s"==n.e&&(c="screen-seller"),"t"==n.e&&(c="screen-reward");let o=t>0&&t<j.length-2&&d()<.18?u.r:u[n.e];A.insertAdjacentHTML("beforeend",`<p style="left:${l-s}px;top:${i-s}px" data-floor="${t}" data-x="${r}" class="jsl" data-sc="${c}">${o}</p>`),0===r&&be.push({x:l,y:i}),r===a.length-1&&$e.push({x:l,y:i})}}}(),requestAnimationFrame(ke)}function we(e){var t=s(3,4),a=[];let r=0;for(;r++<t;)a.push({e:i(Array.from(e))});return a}function ke(e){if(requestAnimationFrame(ke),"map"!=H.s)return;let t=Date.now(),a=t-fe;a>he&&(fe=t-a%he,function(){let e=v.getContext("2d");e.fillStyle="#7e7",e.fillRect(0,0,v.width,v.height);for(let[t,a]of Object.entries(j)){let r=j[1+(t=+t)];if(r)for(let[t,d]of Object.entries(a)){t=+t;for(let t in d.l){let a=r[d.l[t]];e.beginPath(),e.lineWidth=5,e.strokeStyle="#ffa",e.setLineDash([10,5]),e.moveTo(d.x+10*t-10,d.y-25),e.lineTo(a.x-12,a.y+10),e.stroke()}}}["#ffa","#cff","#7cc","#0bb"].forEach(((t,a)=>{for(let r=-1;r<=1;r+=2){let n=[...be],l=0;if(r>0&&(n=[...$e],l=v.width),e.beginPath(),e.fillStyle=t,ve[a]||(ve[a]=[]),!ve[a][0]){let e=0==a?0:1==a?5:2==a?3:1;ve[a][0]={direction:d()>.5?-1:1,offset:0==a?80:1==a?120:2==a?140:180,speed:0==a?0:1==a?.1:2==a?.08:.05},ve[a][0].min=ve[a][0].offset-e,ve[a][0].max=ve[a][0].offset+e,ve[a][0].offset+=s(-e,e)}ve[a][0].offset+=ve[a][0].direction*ve[a][0].speed,(ve[a][0].offset<=ve[a][0].min||ve[a][0].offset>=ve[a][0].max)&&(ve[a][0].offset=Math.max(ve[a][0].min,Math.min(ve[a][0].offset,ve[a][0].max)),ve[a][0].direction*=-1),e.moveTo(n[0].x+r*(ve[a][0].offset-25),2500);let i=0;for(let t in n){if(t=+t,!ve[a][t+1]){let e=0==a?0:1==a?5:2==a?3:1;ve[a][t+1]={direction:d()>.5?-1:1,offset:(0==a?80:1==a?120:2==a?130:160)+s(-e,e),speed:.05},ve[a][t+1].min=ve[a][t+1].offset-e,ve[a][t+1].max=ve[a][t+1].offset+e,ve[a][t+1].offset+=s(-e,e)}ve[a][t+1].offset+=ve[a][t+1].direction*ve[a][t+1].speed,(ve[a][t+1].offset<=ve[a][t+1].min||ve[a][t+1].offset>=ve[a][t+1].max)&&(ve[a][t+1].offset=Math.max(ve[a][t+1].min,Math.min(ve[a][t+1].offset,ve[a][t+1].max)),ve[a][t+1].direction*=-1);let l=ve[a][t+1].offset;t==j.length-1&&(l+=200);let c=n[t].x+r*l,o=n[t].y;e.lineTo(c,o),i=c}e.lineTo(i-15*r,0),e.lineTo(l,0),e.lineTo(l,v.height),e.fill()}}))}())}function Le(d){if(document.querySelector(".ls.-active").classList.remove("-active"),e(d).classList.add("-active"),k.style.display=e(d).classList.contains("-overBar")?"none":"","scc"==d&&(W("w","m"),H.p=0,H.l=H.m,H.sh=0,H.stun=0,H.burn=0,H.freeze=0,H.f=0,H.g=150,H.s=""),"sm"==d){if(H.s="map",H.d||Z(H),D||(ye(),D=!0),0==H.f)[...a(`[data-floor="${H.f}"]`)].forEach((e=>{e.classList.add("-active")}));else{if(H.f>=C+2)return void Le("screen-end");$lastFloor=t(`[data-floor="${H.f-1}"].-selected`);for(let e of j[H.f-1][$lastFloor.getAttribute("data-x")].l)t(`[data-floor="${H.f}"][data-x="${e}"]`).classList.add("-active")}setTimeout((()=>{window.scrollTo({top:document.body.scrollHeight-window.innerHeight-(H.f-1)*E,behavior:"smooth"})}),500)}if("sg"==d&&"game"!=H.s&&(H.s="game",++H.f,H.t=0,1==H.f&&ge(H,H.m),H.deck=[...H.d],H.hand=[],H.discard=[],x.innerHTML="",Ce(H),Me(H),Te(1),y.firstChild&&y.firstChild.remove(),y.append(_(H.c[0],H.c[1],!1)),function(){var e=Object.keys(f);O.c=e[s(0,e.length-1)]+e[s(0,e.length-1)],Z(O),O.deck=[...O.d],O.hand=[],O.discard=[],w.firstChild&&w.firstChild.remove(),w.append(_(O.c[0],O.c[1],!1));let t=j[H.f-1][H.fx].e,a="b"==t?3:"e"==t?1.5:1;O.m=~~(14*Math.log2(H.f+1)*a),ge(O,O.m)}()),"screen-my-deck"==d&&(e("my-deck-remove-mention").style.display="none",K(H.d,g),"seller"==H.s&&H.g>100&&(e("my-deck-remove-mention").style.display="",[...g.querySelectorAll(".c")].forEach(((e,t)=>{e.onclick=()=>{H.g>=100&&(H.g-=100,H.d.splice(t,1),e.remove()),Le("screen-seller")}})))),"screen-seller"==d&&("seller"!=H.s&&(++H.f,H.s="seller"),H.g<100?X.setAttribute("disabled","disabled"):X.removeAttribute("disabled"),function(){let e=[];for(cardId in F)"n"==U(cardId)&&e.push(cardId),U(cardId)==U(H.c)&&e.push(cardId);K(e,p),[...p.querySelectorAll(".c")].forEach(((t,a)=>{let d=r("p"),n=1==F[e[a]].r?60:2==F[e[a]].r?150:250;d.classList.add("c__price"),d.innerText=`💰: ${n}`,H.g>=n&&(t.classList.add("-buyable"),t.onclick=()=>{H.g>=n&&(H.g-=n,H.d.push(e[a]),e.splice(a,1),t.remove(),[...p.querySelectorAll(".c")].forEach(((t,a)=>{let r=1==F[e[a]].r?60:2==F[e[a]].r?150:250;H.g<r&&t.classList.remove("-buyable")})),H.g<100&&X.setAttribute("disabled","disabled"))}),t.append(d)}))}()),"screen-heal"==d&&(++H.f,ge(H,.3*H.m)),"screen-card-add"==d&&function(){let e=[],t=[],a=[];for(cardId in F)U(cardId)==H.c[0]&&e.push(cardId),U(cardId)==H.c[1]&&t.push(cardId),[H.c[0],H.c[1],U(H.c)].indexOf(U(cardId))>=0&&a.push(cardId);let r=i(e),d=i(t=t.filter((e=>e!=r)));a=a.filter((e=>[r,d].indexOf(e)<0)),K([r,d,i(a)],S,(e=>{H.d.push(e),Le("sm")}))}(),"screen-reward"==d&&("map"==H.s&&++H.f,H.g+=O.m,e("gold-reward").innerText=`💰: ${O.m}`),"screen-end"==d){let t=0,r="",d=5*H.f;r+=`<li>Floors (${H.f}): <b>${d}</b></li>`,t+=d;let n=0,l=0,i=0;[...a("#sm .jsl.-selected")].forEach((e=>{let t=+e.dataset.floor,a=+e.dataset.x,r=j[t][a];"m"==r.e&&++n,"e"==r.e&&++l,"b"==r.e&&++i}));let c=20*n;r+=`<li>Monsters killed (${n}): <b>${c}</b></li>`,t+=c;let o=100*l;r+=`<li>Elite monsters killed (${l}): <b>${o}</b></li>`,t+=o;let f=500*i;r+=`<li>Boss killed (${i}): <b>${f}</b></li>`,t+=f,e(s(0,1)?"js-victory-content":"js-defeat-content").style.display="none",e("js-end-score-list").innerHTML="",e("js-end-score-list").insertAdjacentHTML("beforeend",r),e("js-end-score").innerText=`Score: ${t}`}}function xe(){let t={};if([...z.querySelectorAll(".d")].forEach((e=>{e.dataset.burn&&O.l<=5||(t[e.id]=[],de(O,e.getAttribute("data-roll"),(a=>{t[e.id].push(a)})))})),!Object.keys(t).length)return void o(1e3,(()=>Se(O)));let a=Object.keys(t)[0],r=Object.values(t)[0];for(const[e,d]of Object.entries(t))d.length<r.length&&(r=d,a=e);if(r.length){let t=i(r);o(1e3,(()=>{let r=e(a),d=r.dataset.roll;ne(O.hand[t.dataset.hand],d)&&(function(e,t){let a=e.getBoundingClientRect(),r=t.getBoundingClientRect(),d=`translate(${-a.x+r.x+r.width/2}px, ${-a.y+r.y+.4*r.height}px)`;e.style.transform=d}(r,t),o(400,(()=>{r.dataset.burn&&ge(O,-5),r.parentNode.remove(),ee(O,t,d)}))),o(500,xe)}))}else Se(O)}function Te(e){if(2==e)return Ae(O),O.l>0&&o(800,(()=>xe())),void(T.innerText="Opponent turn");T.innerText="End turn",++H.t,Ae(H)}function Ae(e){q=0,e.sh=0,e.p&&ge(e,-e.p--,"🤢 poison"),z.innerHTML="";for(let e=0;e<Math.min(5,H.t);++e)te();if(e.freeze){for(let t=0;t<e.freeze;++t){let e=null;[...z.querySelectorAll(".d:not([data-freeze]")].forEach((t=>{(!e||t.dataset.roll<e.dataset.roll)&&(e=t)})),e&&(o(0,(()=>{ae(e,1)})),e.dataset.freeze=1,$effect=re(e,"❄"))}e.freeze=0}if(e.burn){for(let t=0;t<e.burn&&($notBurnedDieList=z.querySelectorAll(".d:not([data-burn]"),$notBurnedDieList);++t)$dieToBurn=$notBurnedDieList.item(s(0,$notBurnedDieList.length-1)),$dieToBurn&&($dieToBurn.dataset.burn=1,$effect=re($dieToBurn,"🔥"));e.burn=0}if(e.stun){for(let t=0;t<e.stun&&($notStunedDieList=z.querySelectorAll(".d:not([data-stun]"),$notStunedDieList);++t)$dieToStun=$notStunedDieList.item(s(0,$notStunedDieList.length-1)),$dieToStun&&($dieToStun.dataset.stun=1,$effect=re($dieToStun,"😵"));e.stun=0}document.body.offsetWidth,[...a(".d")].forEach((e=>{ae(e)})),o(300,(()=>function(e){for(var t=0;t<5;++t)ze(e,t)}(e)))}function Se(e){!function(e){for(var t=0;t<e.hand.length;++t)setTimeout((()=>{Xe(e,0)}),100*t)}(e),o(500,(()=>Te(e.id%2+1)))}function Xe(e,t){e.discard.push(e.hand[t]),e.hand.splice(t,1),x.removeChild(x.children.item(t)),[...x.querySelectorAll(".c")].forEach(((e,t)=>{e.dataset.hand=t}))}function ze(t,a){o(100*a,(()=>{t.deck.length||(t.deck=t.discard,t.discard=[],Ce(t),Me(t)),t.deck.length&&function(t){let a=t.deck[0];t.hand.push(a),t.deck.shift();let r=Q(a,x.childElementCount);1==t.id&&(r.ondragenter=t=>{var r=t.target;let d=e(I).dataset.roll,n=r.closest(".c"),l=n.dataset.dragCounter||0;n.dataset.dragCounter=++l,r.classList.contains("cd")||(r=n.querySelector(".cd")),ne(a,d)&&n.classList.add("-active")},r.ondragleave=e=>{let t=r.dataset.dragCounter||0;r.dataset.dragCounter=--t,r.dataset.dragCounter<=0&&r.classList.remove("-active")},r.ondrop=d=>{var n=d.target;let l=e(I),i=l.dataset.roll;n.classList.contains("cd")||(n=n.closest(".c").querySelector(".cd"));let s=l.dataset.burn;ne(a,i)&&(ne(a,i,I)?(s&&ge(t,-5,"🔥 burn"),ee(t,r,i)):(pe(t,"😵 stun"),r.classList.remove("-active")))},r.ondragover=e=>{e.preventDefault()},L.removeChild(L.lastElementChild)),x.append(r)}(t)}))}function Me(e){L.innerHTML="",e.deck.forEach(((e,t)=>{let a=r("div");a.classList.add("c"),a.innerHTML='<p class="c__back">0</p>',L.append(a),a.style.transition=`all ${t/20}s linear`,a.offsetWidth,a.style.transform=`translate(${2*t}px, ${2*t}px)`}))}function Ce(e){for(let t=e.deck.length-1;t>0;t--){const a=s(0,t);[e.deck[t],e.deck[a]]=[e.deck[a],e.deck[t]]}}!function(){ie.width=document.body.offsetWidth,ie.height=document.body.offsetHeight;for(let e=0;e<=ie.width;e+=s(ie.width/7,ie.width/9)){let t=s(195,205);ce.push({x:e,y:t,direction:d()>.5?-1:1}),oe.push({x:e,y:t+s(40,60),direction:d()>.5?-1:1})}for(let e=0;e<=ie.width;e+=s(ie.width/7,ie.width/9))se.push({x:e,y:ie.height-s(195,205),direction:d()>.5?1:-1});requestAnimationFrame(ue)}(),function(){for(const e of Object.keys(F)){let t=Q(e);V(t),m.append(t)}}(),function(){for(const[e,t]of Object.entries(f)){let t=_(e,e);t.setAttribute("data-type",e),"w"==e&&t.classList.add("-choice0"),"m"==e&&t.classList.add("-choice1"),t.onclick=()=>{if(!t.classList.contains("-choice0")&&!t.classList.contains("-choice1")){var e=t.getAttribute("data-type");b.setAttribute("data-t"+ ++N%2,e),W(b.dataset.t0,b.dataset.t1),[...b.childNodes].forEach((e=>{e.classList.remove("-choice"+N%2)})),t.classList.add("-choice"+N%2)}},b.append(t)}}(),document.body.onclick=e=>{if(e.target.classList.contains("jsl")){let t=e.target.getAttribute("data-sc");if("back"==t&&(t=`screen-${H.s}`),e.target.hasAttribute("data-floor")){let t=e.target.getAttribute("data-floor");if(H.fx=e.target.getAttribute("data-x"),!e.target.classList.contains("-active"))return;[...a(`[data-floor="${t}"]`)].forEach((e=>{e.classList.remove("-active")})),e.target.classList.add("-selected")}Le(t)}},T.onclick=()=>{c>0||Se(H)}}()</script>