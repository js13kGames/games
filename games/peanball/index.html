<!doctype html><title></title><style>body,canvas,html{margin:0;padding:0;background-color:#000}canvas{display:block}</style><script>function J(){this.B=function(t){for(var e=0;24>e;e++)this[String.fromCharCode(97+e)]=t[e]||0;.01>this.c&&(this.c=.01),.18>(t=this.b+this.c+this.e)&&(t=.18/t,this.b*=t,this.c*=t,this.e*=t)}}var aa,W=new function(){var t,e,a,r,n,i,o,l,c,f,s,x;this.A=new J,this.reset=function(){var t=this.A;r=100/(t.f*t.f+.001),n=100/(t.g*t.g+.001),i=1-t.h*t.h*t.h*.01,o=-t.i*t.i*t.i*1e-6,t.a||(s=.5-t.n/2,x=5e-5*-t.o),l=1+t.l*t.l*(0<t.l?-.9:10),c=0,f=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.D=function(){this.reset();var r=this.A;return t=r.b*r.b*1e5,e=r.c*r.c*1e5,a=r.e*r.e*1e5+12,3*((t+e+a)/3|0)},this.C=function(u,v){var h=1!=(Y=this.A).s||Y.v,y=Y.v*Y.v*.1,d=1+3e-4*Y.w,p=Y.s*Y.s*Y.s*.1,g=1+1e-4*Y.t,m=1!=Y.s,b=Y.x*Y.x,T=Y.g,w=Y.q||Y.r,k=Y.r*Y.r*Y.r*.2,C=Y.q*Y.q*(0>Y.q?-1020:1020),A=Y.p?32+((1-Y.p)*(1-Y.p)*2e4|0):0,P=Y.d,S=Y.j/2,q=Y.k*Y.k*.01,E=Y.a,I=t,O=1/t,R=1/e,G=1/a;.8<(Y=5/(1+Y.u*Y.u*20)*(.01+p))&&(Y=.8);for(var M,W,B,D,U,Y=1-Y,F=!1,X=0,L=0,H=0,J=0,N=0,_=0,j=0,z=0,K=0,Q=0,V=Array(1024),Z=Array(32),$=V.length;$--;)V[$]=0;for($=Z.length;$--;)Z[$]=2*Math.random()-1;for($=0;$<v;$++){if(F)return $;if(A&&++K>=A&&(K=0,this.reset()),f&&++c>=f&&(f=0,r*=l),(r*=i+=o)>n&&(r=n,0<T&&(F=!0)),W=r,0<S&&(Q+=q,W*=1+Math.sin(Q)*S),8>(W|=0)&&(W=8),E||(0>(s+=x)?s=0:.5<s&&(s=.5)),++L>I)switch(L=0,++X){case 1:I=e;break;case 2:I=a}switch(X){case 0:H=L*O;break;case 1:H=1+2*(1-L*R)*P;break;case 2:H=1-L*G;break;case 3:H=0,F=!0}w&&(0>(B=0|(C+=k))?B=-B:1023<B&&(B=1023)),h&&d&&(1e-5>(y*=d)?y=1e-5:.1<y&&(y=.1)),U=0;for(var tt=8;tt--;){if(++j>=W&&(j%=W,3==E))for(M=Z.length;M--;)Z[M]=2*Math.random()-1;switch(E){case 0:D=j/W<s?.5:-.5;break;case 1:D=1-j/W*2;break;case 2:D=.225*((0>(D=1.27323954*(D=6.28318531*(.5<(D=j/W)?D-1:D))+.405284735*D*D*(0>D?1:-1))?-1:1)*D*D-D)+D;break;case 3:D=Z[Math.abs(32*j/W|0)]}h&&(M=_,0>(p*=g)?p=0:.1<p&&(p=.1),m?(N+=(D-_)*p,N*=Y):(_=D,N=0),J+=(_+=N)-M,D=J*=1-y),w&&(V[z%1024]=D,D+=V[(z-B+1024)%1024],z++),U+=D}U=.125*U*H*b,u[$]=1<=U?32767:-1>=U?-32768:32767*U|0}return v}};window.jsfxr=function(t){W.A.B(t);var e=W.D();t=new Uint8Array(4*((e+1)/2|0)+44);e=2*W.C(new Uint16Array(t.buffer,44),e);(a=new Uint32Array(t.buffer,0,44))[0]=1179011410,a[1]=e+36,a[2]=1163280727,a[3]=544501094,a[4]=16,a[5]=65537,a[6]=44100,a[7]=88200,a[8]=1048578,a[9]=1635017060,a[10]=e;e+=44;for(var a=0,r="data:audio/wav;base64,";a<e;a+=3){var n=t[a]<<16|t[a+1]<<8|t[a+2];r=r+("ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&n])}return r},function(){function t(){this.sounds={}}t.prototype.add=function(t,e,a){this.sounds[t]=[],a.forEach((function(a,r){this.sounds[t].push({tick:0,count:e,pool:[]});for(var n=0;n<e;n++){var i=new Audio;i.src=jsfxr(a),this.sounds[t][r].pool.push(i)}}),this)},t.prototype.play=function(t){var e=this.sounds[t],a=e.length>1?e[Math.floor(Math.random()*e.length)]:e[0];a.pool[a.tick].play(),a.tick<a.count-1?a.tick++:a.tick=0},(aa=new t).add("start",1,[[0,.2,.13,.01,,.3328,,,,,,,,.0994,,,,,1,,,.1,,.5]]),aa.add("right",5,[[3,1,.3197,.7823,.2124,.1117,,.091,,,,,,,,.3901,.1061,-.0873,1,,,,,.5]]),aa.add("pad",1,[[0,,.0945,,.1582,.4416,,-.535,,,,,,.3856,,,,,1,,,.0896,,.5]]),aa.add("boost",1,[[0,,.2833,,.1918,.4914,,.2408,,,,,,.0182,,,,,1,,,,,.5]]),aa.add("ring",5,[[0,,.0177,.565,.2893,.4147,,,,,,.4159,.6958,,,,,,1,,,,,.5]]),aa.add("bumper",1,[[0,,.2389,,.2437,.5057,,.164,,,,,,.1032,,,,,1,,,,,.5]]),aa.add("hurt",1,[[0,,.2056,,.2341,.2899,,.3315,,,,,,.1817,,.6354,,,1,,,,,.5]]),aa.add("eat",1,[[0,,.3402,,.2772,.4978,,.1736,,.2589,.3885,,,.1153,,,,,1,,,,,.5]]),aa.add("die",1,[[3,,.296,.6924,.1761,.2478,,.0895,,,,-.6933,.8848,,,,,,1,,,,,.5]])}(),window.onload=function(){"use strict";function t(){Ae=0,ne=0,re=Date.now(),we=0,be=!1,ae=de,se=0,Qt=[],Vt=[],function(){function t(t,e,a,r){S(ot,It,Et,2),ot.beginPath(),ot.moveTo(t(-4),e(-4)),ot.lineTo(t(j+z),e(-4)),ot.lineTo(t(j+z),e(j)),ot.arcTo(t(j+z),e(j+z),t(j),e(j+z),z),ot.lineTo(t(-4),e(j+z)),ot.closePath(),ot.fill(),ot.stroke(),f(s(t(j),e(j),z,Dt)),f(x(t(0),e(j+z),t(j),e(j+z),Dt)),f(x(t(j+z),e(0),t(j+z),e(j),Dt));var n=t==d?"⇐":"⇒";ot.font="64px Georgia, serif",ot.textAlign="center",ot.textBaseline="middle",S(ot,Gt[a][1]),ot.fillText(n,t(j+z+130)-2,e(50)-3),S(ot,Gt[r][1]),n=e==d?"⇑":"⇓",ot.fillText(n,t(50)-2,e(j+z+130)-3),ot.font="16px Georgia, serif",ot.textAlign="center",ot.textBaseline="middle",S(ot,Gt[a][1]),ot.fillText(zt[a],t(j+z+30),e(12)),S(ot,Gt[r][1]),ot.fillText(zt[r],t(16),e(j+z+12))}q(Ct,0,0,et,et,Pt),q(Ct,0,0,et-1,et-1,St),q(Ct,0,0,et-2,et-2,At),q(ot,0,0,$,$,kt),ot.globalAlpha=.1,q(ot,0,$-j-2,$,j,Gt[Ht][1]),q(ot,$-j-2,0,j,$,Gt[Jt][1]),q(ot,0,0,$,j,Gt[Nt][1]),q(ot,0,0,j,$,Gt[_t][1]),ot.globalAlpha=1,ot.globalCompositeOperation="source-over",S(ot,At,qt,2),O(ot,0,0,$,$),O(ot,$,0,0,$),I(ot,tt,tt,8,J,J),t(d,d,2,3),t(d,p,0,3),t(p,d,2,1),t(p,p,0,1)}(),function(){var t=nt,e=t/2;bt.save(),bt.translate(4,4),S(bt,"#aef","#5af",2),bt.beginPath(),bt.moveTo(e,0),bt.quadraticCurveTo(t,-3,t,e),bt.quadraticCurveTo(t,t+1,e,t-2),bt.quadraticCurveTo(2,t,0,e),bt.quadraticCurveTo(-3,-1,e,0),bt.fill(),bt.stroke(),S(bt,N,"#fff",2),O(bt,8,4,4,20),O(bt,16,2,8,26),O(bt,36,14,18,36),O(bt,38,18,26,36),S(bt,N,"#58f",2),O(bt,e-4,10,e-4,18),O(bt,e+4,10,e+4,18),bt.translate(t+8,0),S(bt,"#fa0","#f00",2),bt.beginPath(),bt.moveTo(e,-4),bt.lineTo(e+6,14),bt.lineTo(t-4,8),bt.quadraticCurveTo(t,t+3,e,t-2),bt.quadraticCurveTo(2,t,4,8),bt.lineTo(e-6,14),bt.lineTo(e,-4),bt.fill(),bt.stroke(),O(bt,e-3,26,e-8,20),O(bt,e+3,26,e+8,20),bt.translate(t+8,0),S(bt,"#fd7","#d72",2),bt.beginPath(),bt.moveTo(e,0),bt.quadraticCurveTo(t,10,t-8,t-8),bt.quadraticCurveTo(t,t+1,e+2,t-6),bt.quadraticCurveTo(14,t-12,2,t-4),bt.quadraticCurveTo(-2,t-10,4,e),bt.quadraticCurveTo(0,0,e,0),bt.fill(),bt.stroke(),S(bt,"#d72"),I(bt,10,7,1,J),I(bt,24,9,1,J),I(bt,7,20,1,J),I(bt,20,14,1,J),I(bt,8,30,1,J),I(bt,28,32,1,J),S(bt,"#000","#d72",1);for(var a=0;a<2;a++){var r;0===a?(bt.globalCompositeOperation="destination-out",r=J):(bt.globalCompositeOperation="source-over",r=N),bt.scale(1,1.5),I(bt,13,14,4,r,J),bt.scale(1,2/3),bt.scale(1,1.5),I(bt,26,14,4,r,J),bt.scale(1,2/3)}bt.translate(t+8,0),bt.lineCap="round",S(bt,0,"#fff",2),I(bt,e,e,e-4,N,J),S(bt,0,0,1),bt.beginPath(),bt.arc(e,e,e-8,3.2,4.4),bt.stroke(),I(bt,e-4,e+4,4,N,J),I(bt,e+4,e+4,4,N,J),bt.restore()}(),function(){if(!Tt.width){Tt.width=2*(ve+4)*he,Tt.height=2*(ve+4);for(var t=0;t<he;t++){var e=170+t/he*68>>0;e=e.toString(16),S(wt,null,"#"+e+e+"00",3);var a=(2*t+1)*(4+ve),r=4+ve;wt.beginPath(),wt.arc(a,r,ve,0,2*X),wt.stroke()}}}(),function(){($t=f(s(tt,$-50,ue,Bt))).v={x:0,y:0},$t.cpt=0,$t.elt=jt,$t.sa=-X/2,v(x(0,210,140,100,Yt)),ee=[];var t,e,a,r=4;for(e=0;e<r;e++){var n=xe-4,i=2*n+(K-2*n)*e/r,o=2*H()*X;t=s(0,0,n,Ut),ee.push(f(t));var u=(.2+.2*H())*(H()>.5?-1:1);t.da=u/i,t.a=o,t.d=i}for(e=1;e<r;e++)for(a=0;a<e;a++)(t=y(ee[e])).a+=2*X*(a+1)/(e+1),ee.push(f(t));v(x(140,100,290,30,Ft));var h=(te=Qt.slice(-8))[0],d=m(h.x-h.x2,h.y-h.y2),p=2*-F.acos((h.x2-h.x)/d);for(e=0;e<te.length;e++)(h=te[e]).l=d,h.ux=h.x2-h.x,h.uy=h.y2-h.y,h.amax=p,1!=h.elt&&2!=h.elt||(h.amax*=-1);(Zt=[]).n=0,Zt.cpt=0;var g,b,T=6,w=11,k=F.random()*X;for(e=1;e<=T;e++)for(a=1;a<=w;a++)b=2*X*(a/w)+.1*e+k,(g=c(Mt,Lt)).r=ve,g.cpt=H()*ye>>0,g.cptDir=H()>.5?1:-1,Zt[Zt.n]=g,Zt.n++,g.x=tt+F.cos(b)*e*Z/T,g.y=tt+F.sin(b)*e*Z/T;for(e=0;e<4;e++){var C=c(Mt,Xt);Vt.push(C),C.elt=e,C.r=xe,C.sy=0===e||1==e?j:$-j,C.sx=0===e||3==e?j:$-j,C.hx=tt+.5*_*(1==e?1:3==e?-1:0),C.hy=tt+.5*_*(0===e?1:2==e?-1:0),l(C)}}()}function e(t,e){if(t.kind!=Xt||(Kt[$t.elt]!=t.elt||t.dead||(t.dead=!0,se=Be,ne++,aa.play("eat")),!t.dead)){t.collide=!0,e.x=$t.x-t.x,e.y=$t.y-t.y;var a=m(e.x,e.y);if(t.kind==Ut&&$t.elt!=jt&&((se+=50)>Be&&(se=Be),aa.play("bumper")),t.kind==Xt&&t.elt!=$t.elt){if(ce=pe,$t.elt=jt,Zt.n<Zt.length){Zt.n++;var r=Zt[Zt.n-1];r.m=t,r.dx=e.x*(xe-ve)/a,r.dy=e.y*(xe-ve)/a,ie=pe,oe=-1}aa.play("hurt")}e.l=t.r+$t.r-a,e.x=e.x/a,e.y=e.y/a}}function a(t,e){var a;t.collide=!0,k(De,t.x,t.y,t.x2,t.y2),(C(De,$t.x,$t.y)!==C(De,$t.prevX,$t.prevY))<=0?a=$t.r-e.l:(a=$t.r+e.l,e.x*=-1,e.y*=-1),e.x/=e.l,e.y/=e.l,e.l=a}function r(t,e){var a,r,n=w($t,t,e),i=1==t.elt||3==t.elt;if(n||(k(De,t.x,t.y,t.prevX2,t.prevY2),a=C(De,$t.prevX,$t.prevY,i),k(De,t.x,t.y,t.x2,t.y2),r=C(De,$t.x,$t.y,i)),n||a!==r){var o=$t.x-t.x,l=$t.y-t.y,c=o*t._ux+l*t._uy;if((n||c>0)&&(n||o*o+l*l<t.l*t.l)){t.collide=!0;var f=(m(o,l),c/t.l);e.x=t.x+f*t._ux/t.l,e.y=t.y+f*t._uy/t.l,e.x=$t.x-e.x,e.y=$t.y-e.y,e.l=m(e.x,e.y),e.x/=e.l,e.y/=e.l;var s=t._uy/t.l,x=-t._ux/t.l;(!t.mirror||0!==t.elt&&3!=t.elt)&&(t.mirror||1!=t.elt&&2!=t.elt)||(s*=-1,x*=-1),s*e.x+x*e.y<0&&(e.x*=-1,e.y*=-1),e.l=e.l+$t.r,$t.x+=e.x*e.l,$t.y+=e.y*e.l,$t.collide=!0;var u=f/t.l,v=Ee+(u=.1+.9*(.3*u+.7*u*u))*Ie>>0,h=Oe+Re*u,y=e.x*h,d=e.y*h;We&&fe==Ft?(We=v,Ge=.2*y+Ge,Me=.2*d+Me):(aa.play("pad"),We=v,Ge=y,Me=d),fe=Ft,se=Be,Ge*=.8+.4*H(),Me*=.8+.4*H(),$t.elt=t.elt}}}function n(t,e){We=0,$t.collide=!0,t.colCpt=20,$t.x+=e.x*e.l,$t.y+=e.y*e.l;var a=m($t.v.x,$t.v.y),r=$t.v.x/a,n=$t.v.y/a,i=-e.y,o=e.x;i*r+o*n<0&&(i=-i,o=-o);var l=r*e.x+n*e.y;l<0&&(l=-l);var c=F.sin(F.acos(l));c<0&&(c=-c);var f=.2;(t.kind==Ut||t.kind==Xt)&&(f=1.1),e.x*=l*f*a,e.y*=l*f*a,i*=c*a,o*=c*a,$t.v.x=e.x+i,$t.v.y=e.y+o}function i(){(function(){var t,e,a;for(e=ee.length,t=0;t<e;t++)(a=ee[t]).a+=a.da,a.x=tt+F.cos(a.a)*a.d,a.y=tt+F.sin(a.a)*a.d})(),function(){var t,e,a,r,n;for(e=Vt.length,t=0;t<e;t++)if((a=Vt[t]).elt!=$t.elt&&$t.elt!=jt&&m($t.x-a.x,$t.y-a.y)<200&&(a.elt==Kt[$t.elt]?(a.tx=a.hx,a.ty=a.hy):(a.tx=$t.x,a.ty=$t.y)),(r=a.tx-a.x)*r+(n=a.ty-a.y)*n<25){var i=H()*X*2;a.tx=tt+F.cos(i)*Z,a.ty=tt+F.sin(i)*Z}else{var o=m(r,n);a.x+=r*qe/o,a.y+=n*qe/o}}(),function(){if(be){var t,e,a=0,r=0,n=Se,i=Pe;t=tt-$t.x,e=tt-$t.y;var o=Q/2,l=m(t,e);l<o&&(t/=l,e/=l,n*=.2+.8*l/o,i*=.5+.5*l/o);var c=$t.x-tt,f=$t.y-tt;f>c?f>-c?r=n:a=-n:f>-c?a=n:r=-n,$t.v.x+=a,$t.v.y+=r,We>0&&(We--,$t.v.x+=Ge,$t.v.y+=Me),$t.v.x*$t.v.x+$t.v.y*$t.v.y>i*i&&b($t.v,i),$t.x+=$t.v.x,$t.y+=$t.v.y,$t.x=F.round($t.x),$t.y=F.round($t.y)}}(),function(){var t,i,o,l;if(be){for($t.collide=!1,i=(l=Qt.length)+Vt.length,t=0;t<i;t++)if((o=t<l?Qt[t]:Vt[t-l])!=$t){o.collide=!1;var c=Ue;o.shape==Mt?T($t,o)&&(e(o,c),o.collide&&n(o,c)):o.shape==Wt&&(o.kind==Ft&&o.movingUp?r(o,c):w($t,o,c)&&(a(o,c),o.collide&&n(o,c)))}$t.prevX=$t.x,$t.prevY=$t.y}}(),function(){for(var t,e=(ue+ve)*(ue+ve),a=2*e,r=(ue-xe)*(ue-xe),n=Vt.length,i=0;i<Zt.n;i++){var o=(t=Zt[i]).x-$t.x,l=t.y-$t.y,c=o*o+l*l;if(c<e)aa.play("ring"),t.m=null,Zt[i]=Zt[Zt.n-1],Zt[Zt.n-1]=t,i--,Zt.n--,ie=pe,oe=1,0===Zt.n&&(ge=!0);else if(c<a&&(t.x=t.x-.3*o,t.y=t.y-.3*l),t.m)t.m.dead?t.m=null:(t.x=t.m.x+t.dx,t.y=t.m.y+t.dy);else for(var f=0;f<n;f++){var s=Vt[f];(c=(o=t.x-s.x)*o+(l=t.y-s.y)*l)<r&&(t.m=s,t.dx=o,t.dy=l)}}}()}function o(){var t=be;R(ct),R(dt),t?(E(ct,vt,0,0),ht.clearRect(0,0,Q,V),ht.save(),ht.globalAlpha=.9,E(ht,lt,-ft+xt,-st+ut),ht.restore(),R(ct),S(ht,Gt[$t.elt][1]),We>0?I(ht,$t.prevX-ft,$t.prevY-st,6,J):I(ht,$t.x-ft,$t.y-st,2,J)):R(ht),function(){for(var t,e,a=ft-ve,r=ft+Q+ve,n=st-ve,i=st+Q+ve,o=Tt.width/he,l=o/2,c=0,f=Zt.n;c<f;c++){var s=Zt[c];if(s.cpt+=s.cptDir,s.cpt>=ye?(s.cpt=ye,s.cptDir=-1):s.cpt<=0&&(s.cpt=0,s.cptDir=1),t=s.x,e=s.y,t>a&&t<r&&e>n&&e<i){var x=s.cpt/ye*(he-1)>>0;dt.drawImage(Tt,x*o,0,o,o,t-l-ft,e-l-st,o,o)}}}(),function(){for(var t=nt+2*rt,e=0,a=Vt.length;e<a;e++){var r=Vt[e],n=1;r.dead?(r.cpt-=10,r.cpt<=0?l(r):n=r.cpt/50):r.cpt<50&&(r.cpt++,n=r.cpt/50),r.colCpt>0&&r.colCpt--;var i=Kt[$t.elt]==r.elt,o=$t.elt==r.elt;S(dt,o?It:i?Gt[r.elt][0]:Rt,o?r.colCpt>0?Ot:Et:Rt,2),dt.globalAlpha=n*(o?.5:i?.2:.4),I(dt,r.x-ft,r.y-st,r.r,J),r.elt==_t&&(dt.globalAlpha=1,dt.globalCompositeOperation="destination-out",I(dt,r.x-ft,r.y-st,17,J),dt.globalCompositeOperation="source-over"),dt.globalAlpha=n,i||I(dt,r.x-ft,r.y-st,r.r,N,J),dt.globalAlpha=n*(o?.4:i?.7:1);var c=0,f=0;i&&(c=3*(F.random()-.5),f=3*(F.random()-.5)),o&&(dt.globalAlpha=.4*n),dt.drawImage(mt,r.elt*t,0,t,t,r.x-t/2-ft+c,r.y-t/2-st+f,t,t)}dt.globalAlpha=1}(),function(){for(var t=0,e=Qt.length;t<e;t++){var a,r=Qt[t],n=r.x-ft,i=r.y-st;r!=$t&&(r.shape==Mt&&r.kind==Ut?(r.colCpt>0?(r.colCpt--,a=Ot):a=Et,S(dt,"#000",a,2),I(dt,n,i,r.r,J,J)):r.shape==Wt&&r.kind!=Dt&&(a=Et,r.kind==Ft&&(a=Gt[r.elt][1]),S(dt,0,a,2),O(dt,r.x-ft,r.y-st,r.x2-ft,r.y2-st)))}}(),function(){if(!Ae){var t;be?(t=F.atan2($t.v.y,$t.v.x),ke=0):(t=$t.sa,ke+=.05),$t.cpt=++$t.cpt%20;var e=$t.cpt;e>10&&(e=20-e),be||(e=2+we/Te*8,t+=F.cos(ke)*X/3,Ce=t),e*=.3*X/10;var a=0,r=0;if(we>0&&!be){var n=4*g(we/Te,0,1);a=n*H(),r=n*H()}$t.elt!=jt&&se>0&&(dt.save(),dt.translate($t.x-ft+a,$t.y-st+r),dt.rotate(t),S(dt,"#fff","#000",1),dt.beginPath(),dt.arc(-10,0,20,0,2.2),dt.lineTo(0,0),dt.arc(-10,0,20,-0,-2.2,!0),dt.lineTo(0,0),dt.closePath(),dt.fill(),dt.stroke(),dt.globalCompositeOperation="destination-out",I(dt,0,0,ue,"#fff"),dt.restore()),ce>0?S(dt,Gt[$t.elt][0],Rt,3):S(dt,Gt[$t.elt][0],Gt[$t.elt][1],2),0===e?I(dt,$t.x-ft+a,$t.y-st+r,ue,J,J):G(dt,$t.x-ft+a,$t.y-st+r,$t.r,t,e,J,J)}}(),E(ct,it,-ft,-st),t&&E(ct,vt,0,0),E(ct,yt,0,0)}function l(t){t.tx=t.hx,t.ty=t.hy,t.x=t.sx,t.y=t.sy,t.cpt=0,t.dead=!1,t.da=0,t.a=0,t.d=1}function c(t,e,a,r){return{x:a||0,y:r||0,shape:t,kind:e}}function f(t){return Qt.push(t),t}function s(t,e,a,r){var n=c(Mt,r,t,e);return n.r=a,n}function x(t,e,a,r,n){var i=c(Wt,n,t,e);return i.x2=a,i.y2=r,i}function u(t){for(var e=0;e<4;e++){var a=y(t);h(a,"x","y",e),a.shape==Wt&&h(a,"x2","y2",e),f(a),a.elt=e}}function v(t){u(t),t.x=_-t.x,t.shape==Wt&&(t.x2=_-t.x2),t.mirror=!0,u(t)}function h(t,e,a,r){var n=t[e],i=t[a];if(0===r||2==r)n+=j+z,0===r&&(i=$-i);else{var o=i;i=j+z+n,n=o,1==r&&(n=$-n)}t[e]=n,t[a]=i}function y(t){return JSON.parse(JSON.stringify(t))}function d(t){return t}function p(t){return $-t}function g(t,e,a){return t<e?e:t>a?a:t}function m(t,e){return L(t*t+e*e)}function b(t,e){e=(e||1)/m(t.x,t.y),t.x*=e,t.y*=e}function T(t,e){var a=t.x-e.x,r=t.y-e.y,n=t.r+e.r;return a*a+r*r<n*n}function w(t,e,a){var r=t.x,n=t.y,i=t.r,o=e.x,l=e.y,c=e.x2,f=e.y2,s=c-o,x=f-l,u=F.sqrt(s*s+x*x),v=(c-o)/u,h=(f-l)/u,y=v*(r-o)+h*(n-l),d=y*v+o,p=y*h+l;if((c>o&&d>=o&&d<=c||c<o&&d>=c&&d<=o||o==c&&d==o)&&(f>l&&p>=l&&p<=f||f<l&&p>=f&&p<=l||l==f&&p==l)){var g=p-n,m=d-r,b=L(m*m+g*g);if(b<=i)return a.ex=d,a.ey=p,a.x=-m,a.y=-g,a.l=b,!0}return!1}function k(t,e,a,r,n){e==r?(t.vert=!0,t.x=e):(t.vert=!1,t.m=(a-n)/(e-r),t.p=a-t.m*e)}function C(t,e,a,r){return t.vert?e<t.x:r?e>(a-t.p)/t.m:a>t.m*e+t.p}function A(t,e){var a=U.createElement("canvas");return a.width=t,a.height=e,a}function P(t){return t.getContext("2d")}function S(t,e,a,r){e&&(t.fillStyle=e),a&&(t.strokeStyle=a),r&&(t.lineWidth=r)}function q(t,e,a,r,n,i){i&&(i.width&&(i=t.createPattern(i,"repeat")),S(t,i)),t.fillRect(e,a,r,n)}function E(t,e,a,r){t.drawImage(e,a,r)}function I(t,e,a,r,n,i){t.beginPath(),t.arc(e,a,r,0,2*X,!1),n&&t.fill(),i&&t.stroke()}function O(t,e,a,r,n){t.beginPath(),t.moveTo(e,a),t.lineTo(r,n),t.stroke()}function R(t){t.clearRect(0,0,Q,V)}function G(t,e,a,r,n,i,o,l){t.beginPath(),t.arc(e,a,r,n+i,n-i),t.quadraticCurveTo(e-.5*r*F.cos(n),a-.5*r*F.sin(n),e+r*F.cos(n+i),a+r*F.sin(n+i)),t.closePath(),o&&t.fill(),l&&t.stroke()}function M(t,e){e||(e=window.e);var a=e.keyCode;e.charCode&&!a&&(a=e.charCode),Ye[Xe[a]]=t}function W(t,e){var a,r;"which"in e?(a=3==e.which,r=2==e.which):"button"in e&&(a=2==e.button,r=1==e.button),a?Fe.right=t:r?Fe.middle=t:Fe.left=t,U.onmousemove(e)}function B(){me=!me}var D=window,U=D.document,Y=U.body,F=D.Math,X=F.PI,L=F.sqrt,H=F.random,J=!0,N=!1,_=680,j=220,z=200,K=z+_/2;K=m(K,K)-z>>0;var Q,V,Z=(_/2+m(_/2,_/2))/2,$=_+2*j+2*z,tt=$/2,et=20,at=50,rt=4,nt=40,it=A($,$),ot=P(it),lt=A(),ct=P(lt);lt.style.cursor="crosshair";var ft,st,xt,ut,vt=A(),ht=P(vt),yt=A(),dt=P(yt),pt=A(),gt=P(pt),mt=A(4*(nt+2*rt),nt+2*rt),bt=P(mt),Tt=A(),wt=P(Tt),kt=A(et,et),Ct=P(kt);window.onresize=function(){Q=g(D.innerWidth,_/2,$),V=g(D.innerHeight-at,_/2,$),F.min(Q,V),pt.width=yt.width=vt.width=lt.width=Q-=Q%2,yt.height=vt.height=lt.height=V-=V%2,pt.height=at},Y.onresize(),Y.appendChild(pt),Y.appendChild(lt);var At="#111",Pt="#222",St="#333",qt="#444",Et="#08e",It="#000",Ot="#8f8",Rt="#f02",Gt=[["#aef","#5af"],["#fa0","#f53"],["#a64","#864","#fd7"],["rgba(255,255,255,0.5","#fff","#fff"],["#12d373","#333"]],Mt="c",Wt="l",Bt="b",Dt="bg",Ut="bp",Yt="o",Ft="p",Xt="m",Lt="ring",Ht=0,Jt=1,Nt=2,_t=3,jt=4,zt=["Water","Fire","Earth","Air"],Kt={};Kt[Ht]=Jt,Kt[Jt]=Ht,Kt[Nt]=_t,Kt[_t]=Nt;var Qt,Vt,Zt,$t,te,ee,ae,re,ne,ie,oe,le,ce,fe,se,xe=38,ue=16,ve=8,he=10,ye=30,de=5,pe=50,ge=!1,me=!0,be=!1,Te=100,we=0,ke=0,Ce=0,Ae=0,Pe=10,Se=.2,qe=1,Ee=1,Ie=12,Oe=.2*Pe,Re=.8*Pe,Ge=0,Me=0,We=0,Be=150,De={},Ue={},Ye={},Fe={};t(),function e(){window.stb&&stb(),ge?Ye.space&&(ge=!1,t(),Ye.space=!1):me?function(){Le++;var t=600,e=600;R(ct),R(gt),ct.save(),q(ct,0,0,$,$,kt),ct.translate(Q/2-t/2,0),q(ct,0,0,t,e,"rgba(0,0,0,0.5)");var a="#b7f1d5";ct.font="96px impact",ct.textAlign="center",ct.textBaseline="top",S(ct,a,"#0a7e45",2),ct.fillText("Peanball",t/2,5),ct.strokeText("Peanball",t/2,5);var r=F.abs(.5*F.cos(.05*Le));S(ct,Gt[jt][0]),G(ct,20,e-20,40,0,r,J,J);for(var n=Tt.height,i=0;i<16;i++)ct.drawImage(Tt,4*n,0,n,n,68+(10+n)*i,e-30,n,n);ct.font="24px impact",ct.textAlign="right",S(ct,"#fff"),ct.fillText("A game by @Saturnyn",t-128,105),ct.font="24px impact",ct.textAlign="right",S(ct,a),ct.fillText("Goal:",130,170),ct.fillText("Controls:",130,210),ct.fillText("Elements:",130,300),ct.font="22px Georgia, serif",ct.textAlign="left",S(ct,"#fff"),ct.fillText("Catch all the rings as fast as possible",140,174),ct.font="16px Georgia, serif",ct.fillText("• Hold and release SPACE or RIGHT CLICK to launch the ball",140,215),ct.fillText("• Use WASD or ARROW keys to control flippers",140,240),ct.fillText("• Use LEFT CLICK to give a boost (while wings are displayed)",140,265),ct.fillText("• Flippers give the ball an elemental power (water/fire/earth/air)",140,305),ct.fillText("• Those powers allows you to beat elemental monsters",140,330),ct.fillText("    ‣ Fire to beat Ice , Water to beat Fire",140,355),ct.fillText("    ‣ Air to beat Sand , Earth to beat Cristal",140,380),ct.fillText("• Avoid touching other elements",140,405),ct.textAlign="right",S(ct,a),ct.fillText("Mega thanks to Mod, Cédric and @Floriaen for their support !",t,e),ct.font="32px impact",ct.textAlign="center",S(ct,a),ct.fillText("Press SPACE to start the game",t/2,e-130),ct.font="16px  Georgia, serif",S(ct,"#aaa"),ct.fillText("( play in full screen if you can )",t/2,e-90),ct.restore()}():(function(){if(!be&&!Ae)if(Fe.right||Ye.space)we<Te&&we++;else if(we>0){var t=.1+.9*we/Te,e=Oe+Re*t;Ge=e*F.cos(Ce),Me=e*F.sin(Ce),We=Ee+Ie*t,be=!0,fe="start",aa.play("boost")}for(var a=0;a<te.length;a++){var r,n=te[a],i=!n.mirror;r=1==n.elt?i?Ye.up||Ye.right:Ye.down||Ye.left:i?Ye.up||Ye.left:Ye.down||Ye.right;var o=n.ux,l=n.uy;if(n.cpt=n.cpt||0,n.max=!1,r?n.cpt<9?n.cpt++:n.max=!0:n.cpt>0&&n.cpt--,n.prevX2=n.x2,n.prevY2=n.y2,n.movingUp=r&&!n.max,n.moving=0!==n.cpt,n.cpt>0){var c=n.amax*(n.cpt/9);n.mirror&&(c*=-1);var f=F.cos(c),s=F.sin(c);o=n.ux*f-n.uy*s,l=n.ux*s+n.uy*f}n._ux=o,n._uy=l,n.x2=n.x+o,n.y2=n.y+l}Fe.left&&$t.elt!=jt&&0===We&&se>0&&(Ue.x=Fe.x-$t.x,Ue.y=Fe.y-$t.y,b(Ue,Oe+.5*Re),$t.v.x=Ue.x,$t.v.y=Ue.y,We=10,Ge=$t.v.x,Me=$t.v.y,fe="click",se-=10,Fe.left=!1,aa.play("boost")),se>0&&se--}(),i(),function(){var t=!1;$t.x+ue<0?(t=!0,$t.x=50,$t.y=tt,$t.sa=0):$t.x-ue>$?(t=!0,$t.x=$-50,$t.y=tt,$t.sa=-X):$t.y+ue<0?(t=!0,$t.y=50,$t.x=tt,$t.sa=X/2):$t.y-ue>$&&(t=!0,$t.y=$-50,$t.x=tt,$t.sa=-X/2),t&&(be=!1,we=0,$t.elt=jt,$t.v.x=0,$t.v.y=0,le=pe,Ae=Te,0==--ae&&(ge=!0),aa.play("die")),Ae>0&&Ae--}(),function(){xt=ft,ut=st;var t=$t.x,e=$t.y,a=t-tt,r=e-tt,n=a,i=r;n<0&&(n*=-1),i<0&&(i*=-1);var o=_/2+z;if(n<o&&i<o){var l=n-o,c=i-o,f=l*l+c*c;if(f<o*o){var s=L(f);t=(l=l*o/s)+o,e=(c=c*o/s)+o,a<0&&(t=-t),r<0&&(e=-e),t=tt+t,e=tt+e}}else n<i?t=tt:e=tt;t=g(t,$t.x-.3*Q,$t.x+.3*Q),e=g(e,$t.y-.3*V,$t.y+.3*V),t=g(t-Q/2,0,$-Q),e=g(e-V/2,0,$-V),be?(ft+=.1*(t-ft),st+=.1*(e-st)):(ft=t,st=e)}(),o(),function(){R(gt);var t,e=9,a=14;for(t=0;t<ae;t++)S(gt,Gt[jt][0],"red"),G(gt,50+at/2+t*(e+a),at/2,e,0,.5,!0);if(ce>0&&ce--,be&&!ge){var r=102,n=(Q-r)/2,i=(at-20)/2;S(gt,St),q(gt,n,i,r,20),ce&&(S(gt,"#f00"),gt.globalAlpha=ce/Te,q(gt,n-2,i-2,r+4,24),gt.globalAlpha=1),se>0&&$t.elt!=jt&&(gt.font="12px Georgia, serif",gt.textAlign="center",gt.textBaseline="bottom",S(gt,"#aaa"),gt.fillText("Left click to boost !",n+r/2,i),S(gt,"#fff"),q(gt,n=(Q-(r=se/Be*(r-2)>>0))/2+1,i,r,20),S(gt,0,St,2),gt.save(),gt.translate(Q/2,i+10),gt.rotate(-X/2),gt.beginPath(),gt.arc(-10,0,18,-0,-1.4,!0),gt.lineTo(0,0),gt.closePath(),gt.stroke(),gt.beginPath(),gt.arc(-10,0,18,0,1.4),gt.lineTo(0,0),gt.closePath(),gt.stroke(),gt.restore())}S(gt,0,"#cc0",3),I(gt,Q-20,at/2,8,!1,!0);var o,l=(Date.now()-re)/1e3>>0,c=l%60;c<10&&(c="0"+c),l=(l/60>>0)+":"+c,S(gt,"#fff"),gt.font="18px Georgia, serif",gt.textAlign="left",gt.textBaseline="middle",gt.fillText(l,10,at/2),be&&!ge||(gt.textAlign="center",o=ge?"Game over":Ae?"Out...":we<50?"Hold right mouse button or space key":"Release to launch !",gt.fillText(o,Q/2,at/2));var f=Zt.length-Zt.n,s=f+" / "+Zt.length;if(ie>0&&(ie--,oe>0?(S(gt,"#0f0"),s="↑ "+s):(S(gt,"#f00"),s="↓ "+s)),gt.textAlign="right",gt.fillText(s,Q-38,at/2),le>0&&le--,ge){var x=ae>0,u=[],v=0,h=0;if(u[v++]=x?{t:"YOU WIN :)",s:32,c:"#0f4"}:{t:"YOU LOSE :(",s:32,c:"#f04"},u[v++]={s:24},x?(h+=1e4,u[v++]={t1:"Finished game:",t2:1e4,s:18,c:"#ccc"},h+=1e3*ae,u[v++]={t1:"Extra balls:",t2:ae+" x 1000",s:18,c:"#ccc"}):(h+=100*f,u[v++]={t1:"Rings:",t2:f+" x 100",s:18,c:"#ccc"}),h+=200*ne,u[v++]={t1:"Eaten monsters:",t2:ne+" x 200",s:18,c:"#ccc"},(l=20*(300-(l=(Date.now()-re)/1e3>>0))*f/Zt.length>>0)<0&&(l=0),h+=l,u[v++]={t1:"Time bonus:",t2:l,s:18,c:"#ccc"},u[v++]={t1:"Score:",t2:h,s:24,c:"#fff"},localStorage){var y=parseInt(localStorage.getItem("pacBallScoreMax"));(!y||y<h)&&localStorage.setItem("pacBallScoreMax",h),y&&(y<h?(u[v++]={s:24},u[v++]={t:"New Record !",s:24,c:"#fff"}):u[v++]={t1:"( Record:",t2:y+" )",s:18,c:"#ccc"})}for(u[v++]={s:48},u[v++]={t:"Press SPACE to restart",s:24,c:"#fff"},u[v++]={s:48},e=2*(a=10),t=0;t<v;t++)e+=u[t].s+4;u.c="#fff";var d=_/2-10,p=e;for(ct.save(),ct.translate((Q-d)/2>>0,(V-p)/2>>0),S(ct,"#000","#fff"),ct.fillRect(0,0,d,p),ct.strokeRect(0,0,d,p),ct.textBaseline="top",t=0;t<v;t++)o=u[t],ct.font=o.s+"px Georgia, serif",ct.fillStyle=o.c,o.t?(ct.textAlign="center",ct.fillText(o.t,d/2,a)):o.t1&&(ct.textAlign="right",ct.fillText(o.t1,d/2-4,a),ct.textAlign="left",ct.fillText(o.t2,d/2+4,a)),ct.translate(0,o.s+a);ct.restore()}}()),window.ste&&ste(),requestAnimationFrame(e)}();var Xe={37:"left",65:"left",81:"left",38:"up",90:"up",87:"up",83:"down",40:"down",39:"right",68:"right",32:"space",27:"esc",13:"Enter"};U.onkeyup=function(t){M(!1,t),27==t.keyCode&&B(),32==t.keyCode&&me&&B()},U.onkeydown=function(t){M(!0,t)},U.onmousedown=function(t){W(!0,t)},U.onmouseup=function(t){W(!1,t)},U.onmousemove=function(t){Fe.x=t.clientX+ft,Fe.y=t.clientY+st-at},U.oncontextmenu=function(t){return!1};var Le=0}</script>