<!doctype html><title>The Reapers: Tournament of Destiny</title><style>*{margin:0;padding:0}body,html{width:100%;height:100%;overflow:hidden;background-color:#000;touch-action:none}canvas{position:absolute;top:0;left:0;right:0;bottom:0;margin:auto;display:block;image-rendering:pixelated;background-color:#000;width:480px;height:456px;border:2px solid #fff}</style><script type=module>var le=Object.defineProperty,de=(t,i,e)=>i in t?le(t,i,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[i]=e,c=(t,i,e)=>(de(t,"symbol"!=typeof i?i+"":i,e),e);!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))i(t);new MutationObserver((t=>{for(const e of t)if("childList"===e.type)for(const t of e.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&i(t)})).observe(document,{childList:!0,subtree:!0})}function i(t){if(t.ep)return;t.ep=!0;const i=function(t){const i={};return t.integrity&&(i.integrity=t.integrity),t.referrerpolicy&&(i.referrerPolicy=t.referrerpolicy),"use-credentials"===t.crossorigin?i.credentials="include":"anonymous"===t.crossorigin?i.credentials="omit":i.credentials="same-origin",i}(t);fetch(t.href,i)}}();let st=()=>{},ue="position:absolute;width:1px;height:1px;overflow:hidden;clip:rect(0,0,0,0);";function qt(t,i){let e=i.parentNode;if(t.setAttribute("data-kontra",""),e){let n=e.querySelector("[data-kontra]:last-of-type")||i;e.insertBefore(t,n.nextSibling)}else document.body.appendChild(t)}function Xt(t,i){let e=t.indexOf(i);if(-1!=e)return t.splice(e,1),!0}let fe={};function Rt(t,...i){(fe[t]||[]).map((t=>t(...i)))}let tt,lt,Ht={get:(t,i)=>"_proxy"==i||st};function A(){return lt}function me(t,{contextless:i=!1}={}){return tt=document.getElementById(t)||t||document.querySelector("canvas"),i&&(tt=tt||new Proxy({},Ht)),lt=tt.getContext("2d")||new Proxy({},Ht),lt.imageSmoothingEnabled=!1,Rt("init"),{canvas:tt,context:lt}}class Et{constructor({spriteSheet:t,frames:i,frameRate:e,loop:n=!0}){this.spriteSheet=t,this.frames=i,this.frameRate=e,this.loop=n;let{width:h,height:r,margin:s=0}=t.frame;this.width=h,this.height=r,this.margin=s,this._f=0,this._a=0}clone(){return new Et(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:i,width:e=this.width,height:n=this.height,context:h=A()}){let r=this.frames[this._f]/this.spriteSheet._f|0,s=this.frames[this._f]%this.spriteSheet._f|0;h.drawImage(this.spriteSheet.image,s*this.width+(2*s+1)*this.margin,r*this.height+(2*r+1)*this.margin,this.width,this.height,t,i,e,n)}}function pe(){return new Et(...arguments)}let Gt=/^\//,xe=/\/$/,ye=new WeakMap,ge="";function Dt(t,i){return new URL(t,i).href}function we(t,i){return[t.replace(xe,""),t?i.replace(Gt,""):i].filter((t=>t)).join("/")}function Ae(t){return t.split(".").pop()}function be(t){let i=t.replace("."+Ae(t),"");return 2==i.split("/").length?i.replace(Gt,""):i}let D={},Se={};function ve(){window.__k||(window.__k={dm:ye,u:Dt,d:Se,i:D})}function Pt(t){return ve(),new Promise(((i,e)=>{let n,h,r;if(n=we(ge,t),D[n])return i(D[n]);h=new Image,h.onload=function(){r=Dt(n,window.location.href),D[be(t)]=D[n]=D[r]=this,Rt("assetLoaded",this,t),i(this)},h.onerror=function(){e(n)},h.src=n}))}function Y(t,i){return[t,i]=[t,i].map((t=>ke(t))),t.x<i.x+i.width&&t.x+t.width>i.x&&t.y<i.y+i.height&&t.y+t.height>i.y}function ke(t){let{x:i=0,y:e=0,width:n,height:h}=t.world||t;return t.mapwidth&&(n=t.mapwidth,h=t.mapheight),t.anchor&&(i-=n*t.anchor.x,e-=h*t.anchor.y),{x:i,y:e,width:n,height:h}}class ut{constructor(t=0,i=0,e={}){this.x=t,this.y=i}add(t){return new ut(this.x+t.x,this.y+t.y,this)}scale(t){return new ut(this.x*t,this.y*t)}length(){return Math.hypot(this.x,this.y)}}function Kt(){return new ut(...arguments)}class Fe{constructor(t){return this.init(t)}init(t={}){this.position=Kt(),this.velocity=Kt(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let i=this.velocity;t&&(i=i.scale(t)),this.position=this.position.add(i),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}isAlive(){return this.ttl>0}_pc(){}}class Lt extends Fe{init({width:t=0,height:i=0,context:e=A(),render:n=this.draw,update:h=this.advance,children:r=[],anchor:s={x:0,y:0},opacity:o=1,...a}={}){this._c=[],super.init({width:t,height:i,context:e,anchor:s,opacity:o,...a}),this._di=!0,this._uw(),this.addChild(r),this._rf=n,this._uf=h}update(t){this._uf(t),this.children.map((i=>i.update&&i.update(t)))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y);let i=-this.width*this.anchor.x,e=-this.height*this.anchor.y;(i||e)&&t.translate(i,e),this.context.globalAlpha=this.opacity,this._rf(),(i||e)&&t.translate(-i,-e),this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:i=0,_wo:e=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=e*this.opacity,this._wx+=t,this._wy+=i}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...t){t.flat().map((t=>{this.children.push(t),t.parent=this,t._pc=t._pc||st,t._pc()}))}removeChild(...t){t.flat().map((t=>{Xt(this.children,t)&&(t.parent=null,t._pc())}))}get opacity(){return this._opa}set opacity(t){this._opa=t,this._pc()}}function u(){return new Lt(...arguments)}class Te extends Lt{init({image:t,width:i=(t?t.width:void 0),height:e=(t?t.height:void 0),...n}={}){super.init({image:t,width:i,height:e,...n})}get animations(){return this._a}set animations(t){let i,e;for(i in this._a={},t)this._a[i]=t[i].clone(),e=e||this._a[i];this.currentAnimation=e,this.width=this.width||e.width,this.height=this.height||e.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){super.advance(t),this.currentAnimation&&this.currentAnimation.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function ft(){return new Te(...arguments)}let Re=/(\d+)(\w+)/;function Ee(t){let i=t.match(Re),e=+i[1];return{size:e,unit:i[2],computed:e}}class Le extends Lt{init({text:t="",textAlign:i="",lineHeight:e=1,font:n=A().font,...h}={}){t=""+t,super.init({text:t,textAlign:i,lineHeight:e,font:n,...h}),this._p()}get width(){return this._w}set width(t){this._d=!0,this._w=t,this._fw=t}get text(){return this._t}set text(t){this._d=!0,this._t=""+t}get font(){return this._f}set font(t){this._d=!0,this._f=t,this._fs=Ee(t).computed}get lineHeight(){return this._lh}set lineHeight(t){this._d=!0,this._lh=t}render(){this._d&&this._p(),super.render()}_p(){this._s=[],this._d=!1;let t=this.context;t.font=this.font,this._s.length||(this._s.push(this.text),this._w=this._fw||t.measureText(this.text).width),this.height=this._fs+(this._s.length-1)*this._fs*this.lineHeight,this._uw()}draw(){let t=this.textAlign,i=this.context;this._s.map(((e,n)=>{i.textBaseline="top",i.textAlign=t,i.fillStyle=this.color,i.font=this.font,i.fillText(e,0,this._fs*this.lineHeight*n)}))}}function Yt(){return new Le(...arguments)}function Ce(t){let i=t.canvas;t.clearRect(0,0,i.width,i.height)}function _e({fps:t=60,clearCanvas:i=!0,update:e=st,render:n,context:h=A(),blur:r=!1}={}){let s,o,a,c,d,l=0,u=1e3/t,m=1/t,p=i?Ce:st,f=!0;function x(){if(o=requestAnimationFrame(x),f&&(a=performance.now(),c=a-s,s=a,!(c>1e3))){for(Rt("tick"),l+=c;l>=u;)d.update(m),l-=u;p(h),d.render()}}return r||(window.addEventListener("focus",(()=>{f=!0})),window.addEventListener("blur",(()=>{f=!1}))),d={update:e,render:n,isStopped:!0,start(){s=performance.now(),this.isStopped=!1,requestAnimationFrame(x)},stop(){this.isStopped=!0,cancelAnimationFrame(o)}},d}let Ct={},_t={},yt={},it={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"};function Bt(t=st,i){t._pd&&i.preventDefault(),t(i)}function Me(t){let i=it[t.code],e=Ct[i];yt[i]=!0,Bt(e,t)}function Ve(t){let i=it[t.code],e=_t[i];yt[i]=!1,Bt(e,t)}function Ie(){yt={}}function We(){let t;for(t=0;t<26;t++)it["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)it["Digit"+t]=it["Numpad"+t]=""+t;window.addEventListener("keydown",Me),window.addEventListener("keyup",Ve),window.addEventListener("blur",Ie)}function H(t,i,{handler:e="keydown",preventDefault:n=!0}={}){let h="keydown"==e?Ct:_t;i._pd=n,[].concat(t).map((t=>h[t]=i))}function qe(t,{handler:i="keydown"}={}){let e="keydown"==i?Ct:_t;[].concat(t).map((t=>delete e[t]))}function ct(t){return!!yt[t]}function kt(t){let i=[];return t._dn?i.push(t._dn):t.children&&t.children.map((t=>{i=i.concat(kt(t))})),i}class He{constructor({id:t,name:i=t,objects:e=[],context:n=A(),cullObjects:h=!0,cullFunction:r=Y,sortFunction:s,...o}){this._o=[];let a=n.canvas,c=this._dn=document.createElement("section");c.tabIndex=-1,c.style=ue,c.id=t,c.setAttribute("aria-label",i),qt(c,a),Object.assign(this,{id:t,name:i,context:n,cullObjects:h,cullFunction:r,sortFunction:s,...o});let{width:d,height:l}=a,m=d/2,p=l/2;this.camera=u({x:m,y:p,width:d,height:l,context:n,centerX:m,centerY:p,anchor:{x:.5,y:.5},render:this._rf.bind(this)}),this.add(e)}set objects(t){this.remove(this._o),this.add(t)}get objects(){return this._o}add(...t){t.flat().map((t=>{this._o.push(t),kt(t).map((t=>{this._dn.appendChild(t)}))}))}remove(...t){t.flat().map((t=>{Xt(this._o,t),kt(t).map((t=>{qt(t,this.context)}))}))}show(){this.hidden=this._dn.hidden=!1;let t=this._o.find((t=>t.focus));t?t.focus():this._dn.focus(),this.onShow()}hide(){this.hidden=this._dn.hidden=!0,this.onHide()}destroy(){this._dn.remove(),this._o.map((t=>t.destroy&&t.destroy()))}lookAt(t){let{x:i,y:e}=t.world||t;this.camera.x=i,this.camera.y=e}update(t){this.hidden||this._o.map((i=>i.update&&i.update(t)))}_rf(){let{_o:t,context:i,_sx:e,_sy:n,camera:h,sortFunction:r,cullObjects:s,cullFunction:o}=this;i.translate(e,n);let a=t;s&&(a=a.filter((t=>o(h,t)))),r&&a.sort(r),a.map((t=>t.render&&t.render()))}render(){if(!this.hidden){let{context:t,camera:i}=this,{x:e,y:n,centerX:h,centerY:r}=i;t.save(),this._sx=h-e,this._sy=r-n,t.translate(this._sx,this._sy),i.render(),t.restore()}}onShow(){}onHide(){}}function Mt(){return new He(...arguments)}function Pe(t){if(+t==t)return t;let i=[],e=t.split(".."),n=+e[0],h=+e[1],r=n;if(n<h)for(;r<=h;r++)i.push(r);else for(;r>=h;r--)i.push(r);return i}class Ke{constructor({image:t,frameWidth:i,frameHeight:e,frameMargin:n,animations:h}={}){this.animations={},this.image=t,this.frame={width:i,height:e,margin:n},this._f=t.width/i|0,this.createAnimations(h)}createAnimations(t){let i,e;for(e in t){let{frames:n,frameRate:h,loop:r}=t[e];i=[],[].concat(n).map((t=>{i=i.concat(Pe(t))})),this.animations[e]=pe({spriteSheet:this,frames:i,frameRate:h,loop:r})}}}function Qt(){return new Ke(...arguments)}var S=(t=>(t[t.Fight=0]="Fight",t[t.Rematch=1]="Rematch",t[t.Title=2]="Title",t))(S||{});const Ne={showTrainingData:!1,fightersCanAct:!1,readyTimer:0,roundWinTimer:0,koLabelFlashTimer:0,winScreenOpacity:0,matchWon:!1,whoWon:null,currentScene:S.Title},r=Ne,Oe=(...t)=>Ue(ze(...t)),Ue=(...t)=>{let i=wt.createBufferSource(),e=wt.createBuffer(t.length,t[0].length,k);return t.map(((t,i)=>e.getChannelData(i).set(t))),i.buffer=e,i.connect(wt.destination),i.start(),i},ze=(t=1,i=.05,e=220,n=0,h=0,r=.1,s=0,o=1,a=0,c=0,d=0,l=0,u=0,m=0,p=0,f=0,x=0,w=1,g=0,y=0)=>{let A,b,v=2*Math.PI,S=a*=500*v/k**2,F=(0<p?1:-1)*v/4,T=e*=(1+2*i*Math.random()-i)*v/k,L=[],R=0,E=0,_=0,C=1,V=0,M=0,W=0;for(c*=500*v/k**3,p*=v/k,d*=v/k,l*=k,u=k*u|0,b=(n=99+k*n)+(g*=k)+(h*=k)+(r*=k)+(x*=k)|0;_<b;L[_++]=W)++M%(100*f|0)||(W=s?1<s?2<s?3<s?Math.sin((R%v)**3):Math.max(Math.min(Math.tan(R),1),-1):1-(2*R/v%2+2)%2:1-4*Math.abs(Math.round(R/v)-R/v):Math.sin(R),W=(u?1-y+y*Math.sin(2*Math.PI*_/u):1)*(0<W?1:-1)*Math.abs(W)**o*t*Xe*(_<n?_/n:_<n+g?1-(_-n)/g*(1-w):_<n+g+h?w:_<b-x?(b-_-x)/r*w:0),W=x?W/2+(x>_?0:(_<b-x?1:(b-_)/x)*L[_-x|0]/2):W),A=(e+=a+=c)*Math.sin(E*p-F),R+=A-A*m*(1-1e9*(Math.sin(_)+1)%2),E+=A-A*m*(1-1e9*(Math.sin(_)**2+1)%2),C&&++C>l&&(e+=d,T+=d,C=0),!u||++V%u||(e=T,a=S,C=C||1);return L},Xe=.3,k=44100,wt=new(window.AudioContext||webkitAudioContext);function Q(t){Oe(...t)}const Ge=[2.23,,247,,.05,.07,4,1.66,,.2,50,,.1,.3,1,.3,.17,.57,.09,.46],De=[,,1725,,.07,.17,,.24,,,-208,.1,,,,.1,,.95,.04],Ye=[1.02,,262,.01,.24,.6,4,.37,,,,,,1.2,-72,.8,,.44,.2,.01],Jt=[2.01,0,64.41,.01,.12,.4,1,1.91,,,-100,,.01,,1,.1,.09,.43,.07],Be=[1.02,,413,.08,.23,.47,2,.01,-5.2,-.6,50,,.07,.1,27,.2,,.46,.2,.39],Qe=({height:t=5,...i}={},e)=>{if(i&&e)return(n,h=0,r=0,s=24,o="#000")=>{[...n].reduce(((n,a)=>{const c=s/t,d=i[a.charCodeAt()]||"",l=(p=d,(p>0?d:d.codePointAt())||0).toString(2),u=Math.ceil(l.length/t),m=n+c;var p;return((t,i)=>t.match(new RegExp(`.{${i}}`,"g")))(l.padStart(u*t,0),t).map(((t,i)=>[...t].map(((t,n)=>{e.fillStyle=+t?o:"transparent",e.fillRect(h+m+i*c,r+n*c,c,c)})))),n+(u+1)*c}),0)}};var Je=Qe;const Ze=[...Array(33),29,,,,,,12,,,,"ᇄ",3,"ႄ",1,1118480,"縿",31,"庽","嚿","炟","皷","纷","䈟","线","皿",17,,,"⥊",,"䊼",,"㹏","纮","縱","縮","纵","纐","񴚦","粟","䟱","丿",1020241,"簡",33059359,1024159,"縿","纜","񼙯","繍","皷","䏰","簿",25363672,32541759,18157905,"惸",18470705,,,,,"С"];var je=Ze;const At=24,mt=40,K=1,pt=100,$e=20,ti=60,ei=120,Zt=30,jt=106,ii=100,ni=130,$t=ii-mt,si=2,ri=1,ai=1.5,Nt=3,bt=1,te={idle:{frames:[0,1],frameRate:1},jabStartup:{frames:2},jabActive:{frames:3},jabRecovery:{frames:2},guard:{frames:4},hit:{frames:5},ko:{frames:6}},St={damage:34,startup:15,active:12,recovery:12,width:18,height:10,y:10,advantage:-10},hi=()=>{H("t",(()=>{r.showTrainingData=!r.showTrainingData}))},Ot=()=>!!r.showTrainingData;var I=(t=>(t[t.Left=0]="Left",t[t.Right=1]="Right",t))(I||{});class ee{constructor(t){c(this,"doingAttack",null),c(this,"attackAlreadyHit",!1),c(this,"attackingFrames",0),c(this,"startupFrames",0),c(this,"activeFrames",0),c(this,"recoveryFrames",0),c(this,"parryFrames",0),c(this,"isParrying",!1),c(this,"stun",0),c(this,"recoil",0),c(this,"health",pt),c(this,"roundsWon",0),c(this,"roundEndBounces",0),c(this,"movingLeft",!1),c(this,"movingRight",!1),c(this,"canMove",!0),c(this,"position"),c(this,"hitboxColor","yellow"),c(this,"sprite"),c(this,"hurtbox"),c(this,"hitbox"),c(this,"shadow"),this.position=t,this.sprite=ft({x:0===this.position?-12:-24}),this.hurtbox=u({}),this.shadow=ft({x:0,y:0,render:()=>{const t=A();t.scale(1,.2),t.beginPath(),t.fillStyle="#202020",t.arc(12,320,10,0,2*Math.PI),t.fill()}}),this.hitbox=u({width:24,height:mt,x:0===t?Zt:jt,y:$t,children:[this.sprite,this.shadow],properties:{type:"fighterHitbox"},render:()=>{if(Ot()){const t=A();t.strokeStyle=this.hitboxColor,t.lineWidth=2,t.strokeRect(0,0,24,mt)}}})}addSpriteSheet(t){const i=Qt({image:t,frameWidth:60,frameHeight:37,animations:te});this.sprite.animations=i.animations}handleMovement(){0===this.position&&(this.canMove?(this.movingRight=["d"].some(ct),this.movingLeft=["s"].some(ct)):(this.movingRight=!1,this.movingLeft=!1),this.movingLeft?this.move(0):this.movingRight?this.move(1):this.canMove&&this.stop()),1===this.position&&(this.canMove?(this.movingRight=["j"].some(ct),this.movingLeft=["h"].some(ct)):(this.movingLeft=!1,this.movingRight=!1),this.movingLeft?this.move(0):this.movingRight?this.move(1):this.canMove&&this.stop())}handleParry(){r.fightersCanAct&&null===this.doingAttack&&0===this.stun&&0===this.recoil&&0===this.parryFrames&&(0===this.position&&H("c",(()=>{this.stop(),this.parry()})),1===this.position&&H("n",(()=>{this.stop(),this.parry()}))),this.parryFrames>0&&this.parryFrames--,this.isParrying&&0===this.parryFrames&&(this.isParrying=!1,this.canMove=!0,this.hitboxColor="yellow",this.sprite.playAnimation("idle"))}handleAttack(){r.fightersCanAct&&null===this.doingAttack&&0===this.stun&&0===this.recoil&&0===this.parryFrames&&(0===this.position&&H("x",(()=>{this.stop(),this.attack(St)})),1===this.position&&H("b",(()=>{this.stop(),this.attack(St)}))),this.attackingFrames>0&&(this.attackingFrames--,this.startupFrames>0&&this.startupFrames--,this.doingAttack&&0===this.startupFrames&&this.activeFrames>0&&this.activeFrames===this.doingAttack.active&&(this.hurtbox=u({width:this.doingAttack.width,height:this.doingAttack.height,y:this.doingAttack.y,ttl:this.doingAttack.active,x:0===this.position?this.hitbox.width:-this.doingAttack.width,render:function(){if(Ot()){const t=A();t.strokeStyle="red",t.lineWidth=2,t.strokeRect(0,0,this.width,this.height)}}}),this.doingAttack===St&&this.sprite.playAnimation("jabActive"),this.hitbox.addChild(this.hurtbox),this.activeFrames--),this.doingAttack&&this.activeFrames>0&&this.activeFrames<this.doingAttack.active&&this.activeFrames--,this.recoveryFrames>0&&0===this.activeFrames&&(this.hitboxColor="lightgrey",this.sprite.playAnimation("jabRecovery"),this.recoveryFrames--)),0===this.attackingFrames&&!this.isParrying&&!this.canMove&&1==r.fightersCanAct&&(this.canMove=!0,this.hitboxColor="yellow",this.attackAlreadyHit=!1,this.sprite.playAnimation("idle")),0===this.hurtbox.ttl&&(this.hitbox.removeChild(this.hurtbox),this.hurtbox=u({}),this.doingAttack=null)}handleStun(){this.recoil>0&&(this.sprite.playAnimation("hit"),this.recoil--,0==this.position?(this.hitbox.x-=1,this.hitbox.x<0&&(this.hitbox.x=0)):(this.hitbox.x+=1,this.hitbox.x+this.hitbox.width>f.width&&(this.hitbox.x=f.width-this.hitbox.width))),this.stun>0&&(this.hitboxColor="red",this.canMove=!1,this.stop(),this.stun--,0===this.stun&&this.health>0&&(this.canMove=!0,this.hitboxColor="yellow",this.sprite.playAnimation("idle"))),this.stun>0&&this.isParrying&&(this.hitboxColor="purple")}move(t){this.canMove&&(this.hitbox.dx=0===t?-K:K,this.hitbox.x<=0&&0===t&&(this.hitbox.dx=0),this.hitbox.x>=f.width-24&&1===t&&(this.hitbox.dx=0))}stop(){this.hitbox.dx=0}parry(){0===this.parryFrames&&this.canMove&&(this.stun=60,this.parryFrames=20,this.canMove=!1,this.isParrying=!0,this.sprite.playAnimation("guard"))}attack(t){if(0===this.attackingFrames&&this.canMove){Q(Ge);const i=t.startup+t.active+t.recovery;this.doingAttack=t,this.startupFrames=t.startup,this.activeFrames=t.active,this.recoveryFrames=t.recovery,this.attackingFrames=i,this.hitboxColor="blue",this.canMove=!1,this.sprite.playAnimation("jabStartup")}}update(){this.handleMovement(),this.handleAttack(),this.handleStun(),this.handleParry(),this.hitbox.update()}render(){this.hitbox.render()}}const{canvas:f}=me("game");We();const p=Je(je,A()),o=new ee(I.Left),l=new ee(I.Right),oi=u({x:0,y:0,width:160,height:132,render:function(){const t=A(),i=t.createLinearGradient(0,0,0,132);i.addColorStop(0,"dimgray"),i.addColorStop(1,"darkgray"),t.fillStyle=i,t.fillRect(this.x,this.y,this.width,this.height)}}),V=Mt({id:"fightScene"}),J=Mt({id:"rematchScene"}),q=Mt({id:"titleScene",onShow:function(){this.objects.forEach((t=>{t.opacity=0}))}}),ci="data:image/webp;base64,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",li="data:image/webp;base64,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";async function Ft(){return{player1Image:await Pt(ci),player2Image:await Pt(li)}}const vt=1;let L=0,W=0,z=!0,B=null,rt=0;const F=ft({width:60,height:37}),T=ft({width:60,height:37});let at="",ht="";const di=u({x:24,y:130,render:function(){p("REMATCH",0,0,5,"black")}}),ui=u({x:84,y:130,render:function(){p("EXIT TO MENU",0,0,5,"black")}}),C=Yt({x:12,y:128,text:"🔥",color:"black",font:"8px monospace"}),fi=u({x:24,y:20,render:function(){p(`${r.whoWon} WINS!`,1,1,10,"grey"),p(`${r.whoWon} WINS!`,0,0,10,"black")}}),mi=u({x:3,y:40,render:function(){p(at,7,0,5,"black"),p(ht,7,8,5,"black")}});function Ut(){12===C.x?C.x=72:C.x=12}function pi(t){12===C.x&&0===L?(z=!1,L+=t,B=S.Fight):72===C.x&&0===L&&(z=!1,L+=t,B=S.Title)}function xi(t){L>0&&L<1&&(0===W&&(W++,"🔥"===C.text?C.text="":C.text="🔥"),W>0&&W<8&&W++,8===W&&(W=0),L+=t),B===S.Fight&&L>=1&&(L=0,W=0,z=!0,C.text="🔥",xt(!0),r.currentScene=S.Fight,V.show(),rt=0,at="",ht="",B=null,ot.removeChild(F,T)),B===S.Title&&L>=1&&(L=0,W=0,z=!0,C.text="🔥",xt(!0),r.currentScene=S.Title,q.show(),rt=0,at="",ht="",B=null,ot.removeChild(F,T))}function zt(t){return Qt({image:t,frameWidth:60,frameHeight:37,animations:te})}async function yi(t){"PLAYER 1"===t?(at="NOMIQUIEL CARRIES ON GIVING THEIR",ht="BREATH TO THE LIVING WORLDS..."):(at="OMIQUIEL BEGINS THEIR DEADLY FEAST",ht="OF THE LIVING REALMS..."),F.x="PLAYER 1"===t?-60:f.width,F.y=70,await Ft().then((i=>{const e=zt("PLAYER 1"===t?i.player1Image:i.player2Image);F.animations=e.animations})),T.x="PLAYER 1"===t?0:f.width,T.y=70,await Ft().then((i=>{const e=zt("PLAYER 1"===t?i.player2Image:i.player1Image);T.animations=e.animations})),T.playAnimation("ko"),T.dx="PLAYER 1"===t?200:-200,ot.addChild(F,T),C.x=12,rt++}function gi(t){"PLAYER 1"===t?(T.x>=f.width-T.width&&(T.dx=0,F.dx=40),F.x>=10&&(F.dx=0)):(T.x<=0&&(T.dx=0,F.dx=-40),F.x<=f.width-F.width-10&&(F.dx=0)),rt++}const ot=u({x:0,y:0,width:f.width,height:f.height,children:[fi,mi,di,ui,C],render:async function(){const t=A();t.fillStyle="white",t.fillRect(0,0,f.width,f.height),rt<=1&&await yi(r.whoWon)},update:t=>{H("d",(()=>{z&&Ut()})),H("s",(()=>{z&&Ut()})),H("x",(()=>{z&&void 0!==t&&(Q(Jt),pi(t))})),L>0&&void 0!==t&&xi(t),gi(r.whoWon)}});function xt(t=!1){[o,l].forEach((i=>{i.doingAttack=null,i.attackAlreadyHit=!1,i.attackingFrames=0,i.startupFrames=0,i.activeFrames=0,i.recoveryFrames=0,i.stun=0,i.recoil=0,i.health=pt,i.movingLeft=!1,i.movingRight=!1,i.canMove=!0,i.hitboxColor="yellow",i.roundEndBounces=0,i.position===I.Left?i.hitbox.x=Zt:i.hitbox.x=jt,i.hitbox.y=$t,i.shadow.y=0,i.sprite.playAnimation("idle"),i.hitbox.removeChild(i.hurtbox),i.hurtbox=u({}),t&&(i.roundsWon=0)})),r.readyTimer=0,t&&(J.destroy(),J.remove([ot]),r.matchWon=!1,r.winScreenOpacity=0,r.koLabelFlashTimer=0)}let U=0,et="",G=0;async function wi(){const t=u({x:18,y:84,render:function(){p("TOURNAMENT OF",0,0,10,"white"),p("DESTINY",11,13,20,"grey"),p("DESTINY",10,12,20,"white")}}),i=u({x:14,y:33,render:function(){p("THE REAPERS",0,0,15,"darkred"),p("THE REAPERS",1,1,15,"red")}}),e=u({x:50,y:132,render:function(){p(et,0,0,5,"orangered")}});q.add([t,i,e]),q.update=function(){q.objects.forEach((t=>{t.opacity<1&&(t.opacity+=.01),t.update()})),U<=60?(et="",U++):U>=61&&U<=120?(et="PRESS X TO START",U++):U=0,G<=120&&G>=1&&(G++,et=""),121===G&&(q.destroy(),r.currentScene=S.Fight,xt(!0),V.show(),U=0,et="",G=0),H("x",(()=>{qe("x"),Q(Jt),G++}))},q.render=function(){this.objects.forEach((t=>{t.render()}))}}class ie{constructor(t){function i(t){return(pt-t)/pt*64}c(this,"owner"),c(this,"healthBar"),c(this,"currentHealthBar"),this.owner=t,this.currentHealthBar=u({x:this.owner.position===I.Left?0:64,y:0,width:0,height:4,render:function(){const t=A();t.fillStyle="red",t.fillRect(0,0,this.width,this.height)},update:()=>{this.owner.position===I.Left?this.currentHealthBar.width=i(this.owner.health):this.currentHealthBar.width=-i(this.owner.health)}}),this.healthBar=u({x:this.owner.position===I.Left?8:90,y:18,width:64,height:4,children:[this.currentHealthBar],render:function(){const t=A();t.fillStyle="yellow",t.fillRect(0,0,this.width,this.height)}})}}class ne{constructor(t){c(this,"owner"),c(this,"roundCounter"),this.owner=t,this.roundCounter=Yt({x:t.position===I.Left?8:142,y:24,text:this.drawRoundCircles(),font:"4px monospace",update:()=>{this.updateRoundCounter()}})}drawRoundCircles(){return 0===this.owner.roundsWon?"⚪️ ⚪️":1===this.owner.roundsWon?"🟢 ⚪️":"🟢 🟢"}updateRoundCounter(){this.roundCounter.text=this.drawRoundCircles()}}const Ai=new ie(o),bi=new ie(l),Si=new ne(o),vi=new ne(l);let dt="white";const ki=u({x:0,y:0,render:function(){p("NOMIQUIEL",7,12,5,"white")}}),Fi=u({x:0,y:0,render:function(){p("OMIQUIEL",119,12,5,"white")}}),Ti=u({x:0,y:0,render:function(){p("KO",71,15,10,dt)}});function Ri(){dt="white"===dt?"red":"white"}const Ei=u({x:0,y:0,width:f.width,height:32,children:[Ai.healthBar,bi.healthBar,Si.roundCounter,vi.roundCounter,ki,Fi,Ti],render:function(){const t=A();t.fillStyle="black",t.fillRect(0,0,f.width,32)}});let Tt="";const se=u({x:0,y:71,render:function(){p(Tt,1,1,10,"black"),p(Tt,0,0,10,"orangered")}});function nt(t){Tt=t;const i=8*t.length,e=Math.round(f.width/2-i/2);se.x=e}const Li=u({x:0,y:0,width:f.width,height:f.height,render:function(){const t=A();t.fillStyle=`rgba(255, 255, 255, ${r.winScreenOpacity})`,t.fillRect(0,0,f.width,f.height)}});function re(t){const i=0===t.roundEndBounces?1.6:0;t.hitbox.y<ni-mt?(t.hitbox.dy=2,t.hitbox.x+=t.position===I.Left?-1:1,t.shadow.y-=i):t.roundEndBounces<3?(t.hitbox.dy-=10,t.roundEndBounces++):t.hitbox.dy=0}function Ci(t){t.hitbox.dx+=t.position===I.Left?-5:5}function _i(t){t.roundsWon!==si?(nt(t===o?"PLAYER 1 WINS!":"PLAYER 2 WINS!"),re(t===o?l:o)):(Ci(t===o?l:o),r.matchWon=!0)}function Mi(){V.hide(),r.currentScene=S.Rematch,J.add([ot]),J.show()}function Vi(t){t&&(o.health>0&&l.health>0?(!1===r.fightersCanAct&&r.readyTimer>ai&&(nt(""),r.fightersCanAct=!0,r.roundWinTimer=0),!1===r.fightersCanAct&&r.readyTimer>ri&&nt("FIGHT!"),!1===r.fightersCanAct&&0===r.readyTimer&&nt("GET READY"),r.readyTimer+=t):(0===r.roundWinTimer&&(o.canMove=!1,l.canMove=!1,r.fightersCanAct=!1,r.roundWinTimer+=t,_i(o.health>0?o:l)),r.roundWinTimer>0&&r.roundWinTimer<Nt&&!1===r.matchWon&&(re(o.health>0?l:o),0===r.koLabelFlashTimer?(r.koLabelFlashTimer++,Ri()):r.koLabelFlashTimer<8?r.koLabelFlashTimer++:r.koLabelFlashTimer=0,r.roundWinTimer+=t),r.roundWinTimer>=Nt&&!1===r.matchWon&&(r.roundWinTimer=0,xt()),r.roundWinTimer>0&&r.roundWinTimer<bt&&!0===r.matchWon&&(r.winScreenOpacity=1/bt*r.roundWinTimer,r.roundWinTimer+=t),r.roundWinTimer>=bt&&!0===r.matchWon&&(r.whoWon=o.health>0?"PLAYER 1":"PLAYER 2",Mi())))}function Ii(){if(Y(o.hitbox,l.hitbox)&&(0!=o.hitbox.dx&&0===l.hitbox.dx?(l.hitbox.x+l.hitbox.width<f.width&&(l.hitbox.x+=K),l.hitbox.x+l.hitbox.width===f.width&&(o.hitbox.x-=K)):0!=l.hitbox.dx&&0===o.hitbox.dx?(o.hitbox.x>0&&(o.hitbox.x-=K),0===o.hitbox.x&&(l.hitbox.x+=K)):o.hitbox.dx>0&&l.hitbox.dx<0&&(o.hitbox.x+=-K,l.hitbox.x+=K)),Y(o.hurtbox,l.hitbox)||Y(l.hurtbox,o.hitbox)){const t=Y(o.hurtbox,l.hitbox)?l:o,i=Y(o.hurtbox,l.hitbox)?o:l;i.doingAttack&&(i.attackAlreadyHit||t.isParrying?!i.attackAlreadyHit&&t.isParrying&&(Q(De),t.sprite.playAnimation("idle"),t.hitboxColor="yellow",t.canMove=!0,t.parryFrames=0,t.isParrying=!1,i.recoil=10,i.stun=ei,i.startupFrames=0,i.activeFrames=0,i.recoveryFrames=0,i.doingAttack=null,i.attackAlreadyHit=!1,i.sprite.playAnimation("hit")):(t.hitboxColor="red",i.doingAttack.damage>=t.health?(t.sprite.playAnimation("ko"),Q(Ye),i.attackAlreadyHit=!0,r.fightersCanAct=!1,t.health=0,i.roundsWon+=1):(t.sprite.playAnimation("hit"),Q(Be),t.recoil=10,t.health-=i.doingAttack.damage,t.canMove=!1,t.stun=i.attackingFrames+i.doingAttack.advantage,i.attackAlreadyHit=!0)))}}function Wi(){V.add([oi,o,l,Ei,se,Li]),V.update=function(t){H("t",(()=>{r.showTrainingData=!r.showTrainingData})),Ii(),!1===r.fightersCanAct&&Vi(t),V.objects.forEach((t=>{t.update()}))},V.render=function(){V.objects.forEach((t=>{t.render()}))}}window.addEventListener("DOMContentLoaded",(async()=>{const{player1Image:t,player2Image:i}=await Ft();o.addSpriteSheet(t),l.addSpriteSheet(i),await wi(),Wi(),q.show(),_e({update:function(t){r.currentScene===S.Fight?V.update(t):r.currentScene===S.Rematch?J.update(t):q.update(t)},render:function(){r.currentScene===S.Fight?V.render():r.currentScene===S.Rematch?J.render():q.render()}}).start()}))</script><canvas height=152 id=game width=160></canvas>