<!doctype html><title>Popnoid</title><script>var level,sc,sb,bonusL=[],font=[],monsters=[],imgsNames=["t","e","pad","f"],imgs=[],score=0,auto=!0,menu=1,maps=[103,107,115,117,131,135,137,141,147,151,163,169,187,203,205,220,231,245,23,250,253,256,261,265,267,272,277,287,27,317,32,64,7,89,108,113,124,127,130,12,157,159,15,189,193,201,209,211,215,217,241,242,246,251,259,260,262,282,297,1,29,315,316,39,41,46,49,54,57,63,65,5,87,9,109,10,120,123,128,138,139,143,148,13,150,156,14,167,172,173,176,177,183,17,191,192,197,18,199,208,19,216,20,223,225,21,237,22,243,249,263,268,270,285,288,292,313,30,31,35,42,44,45,47,52,53,60,61,69,71,73,75,81,86,91,93,99,105,111,114,11,129,145,160,162,165,174,175,178,16,202,229,233,236,240,248,255,24,25,284,299,301,304,308,33,37,50,51,66,77,78,84,85,95,97,100,101,144,149,210,230,254,274,275,296,28,43,55,56,68],dares=["5UX805VX804U2X804VX90302X9030X202X602T2X203X5J3X205X4U50X2F2X4U402X2J2X4U40X4JX4U302X405X30Xa0","4X604X3X803X2X304H302X2X30HUVH302XX40HVUH40XXT304H30TX2Xa02X4X604X6X206XeXeXeXe0e0e02X705XFX70X4009X4080X203T6X20X203X6","U0UXa0U0UX30G03G20U0UX30G0G40U0UX0G0G03G20U0UX0G0G30G20U0UX20G203G20U0UXa0U0UXa0U0UX0G03G0G0GU0UX2G30G0G0GU0UX0G202G02G0U0UX0G30G0G0GU0UX6G0G0GU0UXa020cX20cX40X306X3X0X0X06X3X0X0X06X3X0X0X06X3X0X0X06X3X0X0X06X02X30X06X60X06X","e0602U60504V50406U4020X8VX202RX8UX2R2RX8VX2RRcXRe0e0e0e0602X60602X60e0e0e0e0Xc0X2Xa02X","e005X205X050X2UX5050X2VX50504X50","U02XU202XU40302X302X40X302X302X302X302X302X20U2X302X302X0U02X302X30X0302X302X40X302X30X402X302X70U2X302X60U02X302X50302X30X50X302X802X302X7002X30X70202Xa0302X9040X90","504G50402G202G40302G402G30202G602G2002G302X302G02G304X302GG40X2UX40G30X60X30202X602X2002XV60V2X002XV60V2X0202X602X20302X402X30402X2W2X40504X50602X60","2H0U202U20U02H30U202U20U3030U202U20U3003U202U203U003U202U203U030U202U20U3030U202U20U302H0UT4UTU02HeXe0e09VX0X2V9VXFX2V9V3X2V","5X405XX502U50XX502U50X40X40X40406X40602X60X502X50XX502X50X2X4U2X4U2X2X4V2X4V2XeW","40X90T20TXFU704U8X205X9040X9040X207X4VX904WX90408X2040X9040X9040X207X40X9040X904U8X20","0Uc03Ub00Uc0bX30UVc0VUc0bX30VWc0WVc0bX30WVc0VWc0bX30VUc0UVc0bX30","e0e0e0e030X6JX30308X30"];bonusL[1]={chance:3,letter:"d",name:"double ball"},bonusL[2]={chance:6,letter:">",name:"increase pad size"},bonusL[3]={chance:6,letter:"<",name:"decrease pad size"},bonusL[4]={chance:6,letter:"+",name:"increase balls speed"},bonusL[5]={chance:6,letter:"-",name:"decrease balls speed"},bonusL[6]={chance:6,letter:"i",time:5,name:"invisible"},bonusL[9]={chance:15,letter:"t",time:5,name:"tesla"},bonusL[13]={chance:13,letter:"c",time:5,name:"crazy balls"},bonusL[14]={chance:23,letter:"JS",time:2,name:"JS glitch"},bonusL[15]={chance:8,letter:"l",time:10,name:"laser"},bonusL[16]={chance:8,letter:"g",time:20,name:"glue"},font[0]="111101101101111",font[1]="010110010010111",font[2]="111001111100111",font[3]="111001111001111",font[4]="101101111001001",font[5]="111100111001111",font[6]="111100111101111",font[7]="111001010010010",font[8]="111101111101111",font[9]="111101111001111",font.L="100100100100111",font.E="111100111100111",font.V="101101101101010",font.I="111010010010111",font.F="111100111100100",font["-"]="000000111000000",font[":"]="000010000010000",font.D="110101101101110",font.A="111101111101101",font.R="111101111110101",monsters[1]="11:0010000010000010001000001111111000110111011011111111111101111111011010000010100011011000",monsters[2]="8:0001100000111100011111101101101111111111001001000100001000100100",monsters[3]="12:000011110000011111111110111111111111111001100111111111111111000110011000001001100100000100001000",monsters[4]="14:000001111000000001111111100000111111111100011100111100100110000110000101100001100001111000011000011111001111001111111111111111111111111111111111111111111111111111111111111111111111111101110011101110001100110001",monsters[5]="32:0000000011111111111111111000000000000001000000000000000001000000000000100000000000000000001000000000001000000000000000000010000000000010000000000000000000100000000000100000000000110000001011000000001000000000010010000011001011110010000000000100010000100010100110100000000001000011110000101100111000000000010000000000001001100110000000001000000000000001001100100000000010000100000010010001111000000000100011000101100100000110000000001000000000000001000000100000000010000100100100010000001000000000010001111111001000000111000000000010000000000100000010001111111111111111111110000000100110100100000100101001000000001111001110000000111001100000",monsters[6]="20:0011000000000000110001100000000000000110011000000000000001101100000000000000001111000000000000000011110000011111100000111100001101101100001111000110011001100011111001001001001001111111110100001011111111111101000010111111111001001001001001111100011001100110001111000011011011000011110000011111100000111100000000000000001111000000000000000011011000000000000001100110000000000000011000110000000000001100",BRICK0=function(){BRICK.apply(this,arguments)},BRICKU=function(){BRICK.apply(this,arguments),this.value=100,this.onCollid=function(){return 0}},BRICKV=function(){BRICK.apply(this,arguments),this.value=200,this.onCollid=function(){return 0}},BRICKW=function(){BRICK.apply(this,arguments),this.value=400,this.onCollid=function(){return 0}},BRICKH=function(){BRICK.apply(this,arguments),this.onCollid=function(){return"U"}},BRICKI=function(){BRICK.apply(this,arguments),this.onCollid=function(){return"H"}},BRICKJ=function(){BRICK.apply(this,arguments),this.onCollid=function(){return"I"}},BRICKF=function(){BRICK.apply(this,arguments),this.onCollid=function(e){if(e){var t=[];for(y=0;y<24;y++)for(x=0;x<14;x++)"T"==level[y][x].type&&t.push({x:x,y:y});var s=Math.floor(Math.random()*t.length);return e.x=34*t[s].x+17,e.y=20*t[s].y-10,e.angle=e.angle+(60*Math.random()-30),"F"}}},BRICKG=function(){BRICK.apply(this,arguments)},BRICKM=function(){BRICK.apply(this,arguments),this.expSize=2,this.expColor=[255,62,32],this.value=400,this.explode=!1,this.onCollid=function(){for(this.explode=!0,y=this.y-2;y<=this.y+2;y++)for(x=this.x-2;x<=this.x+2;x++)if((y!=this.y||x!=this.x)&&level[y]&&level[y][x]){var e=level[y][x];0!=e.type&&("M"==e.type&&e.explode||e.onTouch(null))}return 0}},BRICKN=function(){BRICK.apply(this,arguments),this.value=100,this.expColor=[234,213,34],this.onCollid=function(){return G.addBall(34*this.x+17,20*this.y+10,360*Math.random()),0}},BRICKR=function(){BRICK.apply(this,arguments),this.expColor=[228,106,218],this.value=400,this.onCollid=function(){return setTimeout(this.reborn.bind(this),1e4),0},this.reborn=function(){this.expColor=[228,106,218],this.type="R",this.value=50,G.updateBricks()}},BRICKT=function(){BRICK.apply(this,arguments)},BRICKX=function(){BRICK.apply(this,arguments)},BRICK=function(e,t,s){this.x=e,this.y=t,this.type=s,this.value=0,this.expColor=[203,174,169],this.expSize=1,this.onTouch=function(e){if(0!=this.type&&this.onCollid){var t=this.onCollid(e);if(0==t){if(G.addText(34*this.x,20*this.y,this.value),G.updateScore(this.value),G.addExp(34*this.x,20*this.y,this.expColor,this.expSize),G.nbBrick-=-1!=["G","R","N","M"].indexOf(this.type)?0:1,0==G.nbBrick&&(G.explodeAll(),setTimeout("G.endLevel(true)",3e3)),this.type="0",10*Math.random()<3&&G.bonus.length<=3){var s=Math.round(100*Math.random()),i=0,a=!1;for(var l in bonusL)if(s<=(i+=bonusL[l].chance)){a=l;break}G.addBonus(34*this.x,20*this.y,parseInt(a))}G.updateBricks()}else if(t){var n=new window["BRICK"+t](this.x,this.y,t);for(var o in n)this[o]=n[o];G.updateBricks()}}}},G={balls:[],sprites:[],players:[],monsters:[],bonus:[],effects:[],glitchMode:!1,mode:"menu",text:"",life:1,ptTime:1e4,updateBricks:function(){for(ctx2.clearRect(0,0,476,500),dS(444,6,19),dS(328,333,10),dS(146,181,17),dS(153,204,15),dS(303,368,12),dS(312,353,14),dS(112,447,15),dS(170,242,11),dS(169,280,13),dS(184,60,12),dS(61,140,16),dS(28,238,18),dS(291,330,11),dS(143,183,10),dS(350,222,11),dS(253,162,13),dS(200,451,11),dS(55,128,17),dS(361,288,11),dS(178,144,15),y=0;y<24;y++)for(x=0;x<14;x++)if(l=level[y][x],"0"!=l.type)switch(l.type){case"R":case"M":drawBrick(34*x,20*y,1,1,1,l.type);break;default:drawBrick(34*x,20*y,l.r,l.g,l.b,l.type)}},updateScore:function(e){var t=score+=e;t=t.toString(),t=("career"==G.mode?"LEVEL":"DARE")+" "+G.level+" - "+("0000000"+t).substring(t.length),sp.fillStyle="#FFF",sp.fillRect(522,206,370,45),sp.fillStyle="#F00",drawDigits(707-10*t.length,216,t,sp)},checkPt:function(){if(!(Math.random()<.5)){var e=[];0==level[6][0].type&&0==level[7][0].type&&e.push(1),0==level[14][0].type&&0==level[15][0].type&&e.push(2),0==level[6][13].type&&0==level[7][13].type&&e.push(5),0==level[14][13].type&&0==level[15][13].type&&e.push(6),e.length&&(pt=e[Math.floor(Math.random()*e.length)],document.getElementById("pt"+pt).classList.add("opened"),setTimeout("G.addMonsterInPt("+pt+")",1500))}},addMonsterInPt:function(e){var t,s;switch(document.getElementById("pt"+e).classList.remove("opened"),e){case 1:t=0,s=130;break;case 2:t=0,s=285;break;case 5:t=500,s=130;break;case 6:t=500,s=285}G.addMonster(t,s,Math.floor(Math.random()*(monsters.length-1))+1)},initStart:function(){this.players=[],this.addPlayer(175),this.addBall(238,478,0),this.balls[0].speed=0,this.wait=!0,this.updateScore(0),this.updateBricks()},addBall:function(e,t,s){this.balls.push(new BALL(e,t,s))},addText:function(e,t,s){this.sprites.push(new TEXT(e,t,s))},drawText:function(e,t,s){new TEXT2(e,t,s)},addPlayer:function(e){this.players.push(new PLAYER(e))},addExp:function(e,t,s,i,a){this.sprites.push(new EXPLOSION(e,t,s,i,a))},addLaser:function(){var e=this.players[0];e.gun&&(this.sprites.push(new LASER(e.x+24,478,0)),this.sprites.push(new LASER(e.x+e.size-22,478,0)))},addMonster:function(e,t,s){this.monsters.push(new MONSTER(e,t,s))},addBonus:function(e,t,s){this.bonus.push(new BONUS(e,t,s))},setEffects:function(e){var t=this.players[0];switch(e){case 9:t.rope=!0;break;case 6:t.invisible=!0;break;case 13:t.crazy=!0;break;case 14:this.glitchMode=!0;break;case 15:t.gun=!0;break;case 16:t.glue=!0}this.effects[e]=60*bonusL[e].time,document.querySelector("#bonus"+e+">span").style.height="100%"},cancelEffects:function(e){var t=this.players[0];switch(e){case 9:t.rope=!1;break;case 6:t.invisible=!1;break;case 13:t.crazy=!1;break;case 14:this.glitchMode=!1;break;case 15:t.gun=!1;break;case 16:t.glue=!1,t.dropGlueBalls()}document.querySelector("#bonus"+e+">span").style.height="0%",delete this.effects[e]},updateEffects:function(){for(var e in this.effects)this.effects[e]--,this.effects[e]<=0&&this.cancelEffects(parseInt(e)),document.querySelector("#bonus"+e+">span").style.height=100/(60*bonusL[e].time)*this.effects[e]+"%"},cancelAllEffects:function(){this.cancelEffects(9),this.cancelEffects(6),this.cancelEffects(13),this.cancelEffects(14),this.cancelEffects(15),this.cancelEffects(16)},explodeAll:function(){for(y=0;y<24;y++)for(x=0;x<14;x++)"0"!=level[y][x].type&&(this.addExp(34*x,20*y,[127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random()),127+Math.floor(127*Math.random())],2),level[y][x].type=0);for(var e=0;e<this.balls.length;e++)this.addExp(this.balls[e].x,this.balls[e].y,[255,255,255],2);for(e=0;e<this.monsters.length;e++)this.addExp(this.monsters[e].x,this.monsters[e].y,[255,255,255],2);this.balls=[],this.monsters=[]},endLevel:function(e){auto=!1,this.cancelAllEffects(),displayEndLevel(e)},updateLives:function(){sp.fillStyle="#FFF",sp.fillRect(740,263,152,118),sp.fillStyle="#F00",drawDigits(776,286,"LIFE",sp);var e=this.life.toString();drawDigits(816-10*e.length,333,e,sp)}},BONUS=function(e,t,s){this.x=e,this.y=t,this.type=s,this.time=bonusL[this.type].time?bonusL[this.type].time:0,this.update=function(){var s,i,a,l,n,o;if(this.y+=2,this.y>500)return!1;if(this.y>460&&(i=G.players[0],this.x>i.x-32&&this.x<i.x+i.size)){switch(this.type){case 1:for(a=[],s=0;s<G.balls.length;s++)l=G.balls[s],a.push({x:l.x,y:l.y,angle:l.angle+15});for(s=0;s<a.length;s++)G.addBall(a[s].x,a[s].y,a[s].angle+15);break;case 2:n=i.size,i.size=Math.min(1.2*i.size,250),i.x-=(i.size-n)/2;break;case 3:n=i.size,i.size=Math.max(i.size/1.2,80),i.x-=(i.size-n)/2;break;case 4:for(s=0;s<G.balls.length;s++)G.balls[s].speed=Math.min(1.2*G.balls[s].speed,12);break;case 5:for(s=0;s<G.balls.length;s++)G.balls[s].speed=Math.max(G.balls[s].speed/1.2,2)}return G.text=bonusL[this.type].name,G.textX=500,G.textFrame=0,bonusL[this.type].time&&G.setEffects(this.type),!1}return e=this.x,t=this.y,ctx.beginPath(),ctx.moveTo(e+6,t),ctx.lineTo(e+24,t),ctx.arcTo(e+30,t,e+30,t+6,6),ctx.lineTo(e+30,t+14),ctx.arcTo(e+30,t+20,e+24,t+20,6),ctx.lineTo(e+6,t+20),ctx.arcTo(e,t+20,e,t+14,6),ctx.lineTo(e,t+6),ctx.arcTo(e,t,e+6,t,6),ctx.closePath(),(o=ctx.createLinearGradient(e,t,e,t+20)).addColorStop(0,"#466BA9"),o.addColorStop(.25,"#6FB5FF"),o.addColorStop(.5,"#6FB5FF"),o.addColorStop(.75,"#6FB5FF"),o.addColorStop(1,"#4772B8"),ctx.fillStyle=o,ctx.fill(),ctx.strokeStyle="rgba(37,60,99,0.5)",ctx.stroke(),ctx.fillStyle="#FFF",ctx.fillRect(e+4,t+4,22,12),G.drawText(e+8,t+3,bonusL[this.type].letter),!0}},MONSTER=function(e,t,s){this.x=e,this.y=t,this.type=s,this.speed=1,this.angle=90;var i=monsters[s].split(":");this.width=i[0],this.pixels=i[1],this.height=this.pixels.length/this.width,this.factor=5==s||6==s?1:2,this.explode=function(){G.updateScore(1e3),G.addText(this.x,this.y,1e3),G.addExp(this.x,this.y,[255,255,255],2);for(var e=0;e<G.monsters.length;e++)if(G.monsters[e]==this)return void G.monsters.splice(e,1)},this.update=function(){var e=this.x,t=this.y;this.x+=Math.sin(this.angle/180*3.14)*this.speed,this.y+=Math.cos(this.angle/180*3.14)*this.speed,this.angle+=10*Math.random()-5;var s=!1;if(this.y>500)return!1;for(var i=this.x;i<=this.x+this.width*this.factor;i+=this.width*this.factor)for(var a=this.y;a<=this.y+this.height*this.factor;a+=this.height*this.factor){var l={x:Math.floor(i/34),y:Math.floor(a/20)};l.x>=0&&l.x<14&&l.y>=0&&"0"!=level[l.y][l.x].type&&(s=!0)}s&&(this.x=e,this.y=t,this.angle=360*Math.random()),this.y<0&&(this.angle-=180,this.y=0),this.x<0&&(this.angle=360-this.angle,this.x=0),this.x>476-this.width*this.factor&&(this.angle=360-this.angle,this.x=476-this.width*this.factor),ctx.fillStyle="#FFFFFF";var n=0;for(a=0;a<this.pixels.length/this.width;a++)for(i=0;i<this.width;i++)"1"==this.pixels[n]&&ctx.fillRect(this.x+i*this.factor,this.y+a*this.factor,this.factor,this.factor),n++;return!0}},EXPLOSION=function(e,t,s,i,a){this.x=e,this.y=t,this.color=s,this.size=i,this.opacity=1,this.pixels=[],this.gravity=a||0;for(e=0;e<34;e+=3)for(t=0;t<24;t+=3){var l={};l.x=this.x+e,l.y=this.y+t,l.tx=(e-17)*(Math.random()-.5),l.ty=(t-10)*(Math.random()-.5),this.pixels.push(l)}this.update=function(){if(this.opacity-=.01,this.opacity<=0)return!1;ctx.fillStyle="rgba("+this.color[0]+","+this.color[1]+","+this.color[2]+","+this.opacity+")";for(var e=0;e<this.pixels.length;e++){var t=this.pixels[e];t.ty+=this.gravity,t.x+=t.tx,t.y+=t.ty,ctx.fillRect(t.x,t.y,2*this.size,2*this.size)}return!0}},PLAYER=function(e){this.x=e,this.size=125,this.invisible=!1,this.crazy=!1,this.rope=!1,this.gun=!1,this.glue=!1,this.visible=!0,this.blocked=!0,this.explode=function(){for(var e=G.players[0],t=e.x;t<e.x+e.size;t+=10)G.addExp(t,470,[255,255/e.size*(t-e.x),50],2,.05);this.visible=!1,G.cancelAllEffects(),G.life--,G.updateLives(),0==G.life?setTimeout("G.endLevel(false)",3e3):setTimeout("G.initStart()",2e3)},this.update=function(){return!!this.visible&&(ctx.drawImage(imgs.pad,0,0,34,18,this.x,480,34,18),ctx.drawImage(imgs.pad,34,0,1,18,this.x+34,480,this.size-67,18),ctx.drawImage(imgs.pad,35,0,33,18,this.x+this.size-33,480,33,18),this.gun&&(ctx.drawImage(imgs.t,0,0,10,27,this.x+20,464,10,27),ctx.drawImage(imgs.t,0,0,10,27,this.x+this.size-27,464,10,27)),void(this.glue&&ctx.drawImage(imgs.t,11,0,81,9,this.x+34,483,this.size-67,9)))},this.dropGlueBalls=function(){for(var e=0;e<G.balls.length;e++){var t=G.balls[e];t.glue&&(t.glue=!1,t.speed=t.oldSpeed)}}},LASER=function(e,t,s){this.x=e,this.y=t,this.angle=s,this.update=function(){var e,t,s,i=Math.floor(this.x/34),a=Math.floor(this.y/20);if(i>=0&&i<14&&a>=0&&"0"!=(e=level[a][i]).type)return e.onTouch(null),!1;for(t=0;t<G.monsters.length;t++)if(s=G.monsters[t],this.x>s.x&&this.x<s.x+2*s.width&&this.y>s.y&&this.y<s.y+2*s.height)return s.explode(),!1;return this.x+=20*Math.sin(this.angle/180*Math.PI),this.y-=20,ctx.fillStyle="#F00",ctx.fillRect(this.x,this.y,2,20),!0}},TEXT=function(e,t,s){this.x=e,this.y=t,this.text=s.toString(),this.frame=0,this.opacity=1,this.update=function(){var s;if(this.frame++,this.y-=.5,this.frame>30&&(this.opacity-=.05),this.opacity<0)return!1;ctx.fillStyle="rgba(80,80,255,"+this.opacity+")";var i=this.x+5;for(s=0;s<this.text.length;s++){var a=this.text[s],l=0;for(t=0;t<5;t++)for(e=0;e<3;e++)"1"==font[a][l++]&&ctx.fillRect(i+2*e,this.y+5+2*t,2,2);i+=8}return!0}},TEXT2=function(e,t,s,i,a){var l,n,o,r;this.x=e,this.y=t,this.text=s.toString(),this.frame=0,this.opacity=1,i?l=!0:(i=ctx,l=!1);var h="abcdefghijklmnopqrstuvwxyz0123<>!.+-JS";i.fillStyle="rgba(0,0,255,"+this.opacity+")";var c=e,d=t;for(n=0;n<this.text.length;n++){var p=this.text[n];if("@"!=p)if("#"!=p)if("J"==p&&(c-=7),l){i.mozImageSmoothingEnabled=!1,i.webkitImageSmoothingEnabled=!1,i.imageSmoothingEnabled=!1,i.drawImage(imgs.f,14*h.indexOf(p),0,14,14,c,d,14*a,14*a);var f=i.getImageData(c,d,14*a,14*a);for(o=f.data,line=0,r=0;r<o.length;r+=4)r%(56*a)==0&&line++,255==o[r]||(line<a?(o[r]=154,o[r+1]=134,o[r+2]=249):line>13*a||r%(56*a)>=52*a?(o[r]=81,o[r+1]=59,o[r+2]=191):r%(56*a)<=4*a?(o[r]=154,o[r+1]=134,o[r+2]=249):(o[r]="@"==this.text[0]?205:114,o[r+1]="@"==this.text[0]?155:84,o[r+2]=(this.text[0],252)));i.putImageData(f,c,d,0,0,14*a,14*a),c+=16*a}else i.drawImage(imgs.f,14*h.indexOf(p),0,14,14,c,d,14,14),c+="J"==p?14:16;else c=e,d+=18*a}},BALL=function(e,t,s){this.x=e,this.y=t,this.speed=5,this.angle=s,this.glue=!1,this.size=5,this.update=function(){this.angle+=.01,this.speed&&(this.speed+=5e-4);var e,t,s,i,a,l,n=G.players[0];n.crazy&&(this.angle+=20*Math.random()-10);for(var o=Math.ceil(this.speed),r=0;r<o;r++){this.x+=Math.sin(this.angle/180*Math.PI)*(this.speed/o),this.y-=Math.cos(this.angle/180*Math.PI)*(this.speed/o);var h=!1,c=!1,d=!1;if(this.y>500-this.size)return!1;(this.x>476-this.size||this.x<this.size)&&(h=!0,this.x=Math.max(this.x,this.size),this.x=Math.min(this.x,476-this.size)),this.y<this.size&&(c=!0,this.y=Math.max(this.y,this.size));var p=[],f=1,x=0,y=[];for(e=this.x-5;e<=this.x+5;e+=5)for(t=this.y-5;t<=this.y+5;t+=5){var u={x:Math.floor(e/34),y:Math.floor(t/20)};if(u.x>=0&&u.x<14&&u.y>=0&&u.y<30&&"0"!=level[u.y][u.x].type){var m=!1;for(s=0;s<y.length;s++)y[s]==u.y+"/"+u/e&&(m=!0);m||(y.push(u.y+"/"+u/e),p.push(u)),x+=f}f*=2}for(this.y>480&&this.x+5>n.x&&this.x-5<n.x+n.size&&(this.angle=360-(50*n.x+25*n.size-50*this.x)/n.size*1.9,x=0,n.glue&&(this.y=480,this.glue=!0,this.oldSpeed=this.speed,this.speed=0)),i=0;i<G.monsters.length;i++)l=G.monsters[i],this.x>l.x&&this.x<l.x+2*l.width&&this.y>l.y&&this.y<l.y+2*l.height&&(this.angle=360*Math.random(),this.speed.vitesse+=this.speed/10,l.explode());if(x&&((2&x||128&x)&&(h=!0),(8&x||32&x)&&(c=!0),h||c||(a=10*Math.random(),1&x?this.angle=135+a:64&x?this.angle=225+a:4&x?this.angle=45+a:256&x?this.angle=315+a:h=c=!0,(1&x||64&x||4&x||256&x)&&(d=!0))),h||c||d)for(s=0;s<p.length;s++)u=p[s],level[u.y][u.x].onTouch(this);n.rope&&this.y>450&&(c=!0),h&&c?this.angle-=180:h?this.angle=360-this.angle:c&&(this.angle=180-this.angle),this.angle<0&&(this.angle=360+this.angle),this.angle=this.angle%360}return this.draw(),!0},this.draw=function(){ctx.beginPath(),ctx.arc(this.x,this.y,this.size,0,2*Math.PI,!1),ctx.fillStyle="rgba(255,255,255,"+(G.players[0].invisible?"0.05":"1")+")",ctx.fill()}},dS=function(e,t,s,i){i||(i=ctx2);var a=i.createRadialGradient(e,t,0,e,t,s);a.addColorStop(0,"rgba(255,255,255,0.7)"),a.addColorStop(.1,"rgba(255,255,255,0.7)"),a.addColorStop(.11,"rgba(127,127,127,0.3)"),a.addColorStop(1,"rgba(127,127,127,0)"),i.fillStyle=a,i.fillRect(e-s,t-s,2*s,2*s)},drawDigits=function(e,t,s,i){for(var a=0;a<s.length;a++){var l=0;for(y=0;y<5;y++)for(x=0;x<3;x++)" "!=s[a]&&"1"==font[s[a]][l++]&&i.fillRect(e+5*x,t+5*y,4,4);e+=20}},gameLoop=function(){if(auto){window.requestAnimationFrame(gameLoop);var e,t=ctx.createLinearGradient(0,0,476,500);for(t.addColorStop(0,"rgba(15, 0, 63,0.3)"),t.addColorStop(1,"rgba(53, 1, 84,0.3)"),ctx.fillStyle=t,ctx.fillRect(0,0,476,500),ctx.drawImage(ctx2.canvas,0,0),e=0;e<G.balls.length;e++)G.balls[e].update()||(G.balls.splice(e--,1),0==G.balls.length&&G.players[0].explode());for(e=0;e<G.sprites.length;e++)G.sprites[e].update()||G.sprites.splice(e--,1);for(e=0;e<G.players.length;e++)G.players[e].update();for(e=0;e<G.monsters.length;e++)G.monsters[e].update()||G.monsters.splice(e--,1);for(e=0;e<G.bonus.length;e++)G.bonus[e].update()||G.bonus.splice(e--,1);if(G.players[0].rope){for(ctx.shadowBlur=10,ctx.shadowColor="rgba(172,19,222,1)",ctx.beginPath(),ctx.lineWidth=2,ctx.moveTo(0,450),e=0;e<500;e+=10)ctx.lineTo(e,450+10*Math.random());ctx.strokeStyle="#FFF",ctx.stroke()}G.text&&(G.textFrame++,G.textFrame>60?G.text=!1:G.textFrame<10||G.textFrame>50?G.textX-=(4*G.text.length+131)/5:G.textX=238-8*G.text.length,ctx.shadowBlur=20,ctx.shadowColor="rgba(255,255,255,1)",ctx.fillStyle="rgba(255,255,255,0.5)",ctx.fillRect(0,50,476,50),new TEXT2(G.textX,68,G.text,null,2)),ctx.shadowBlur=0,G.glitchMode&&(glitch(0,0,476,100,-10,0),glitch(0,100,476,100,10,100),glitch(0,200,476,100,-22,200),glitch(0,300,476,100,7,300),glitch(0,400,476,100,-80,400)),G.updateEffects(),G.wait&&(ctx.fillStyle="#E4BD3B",ctx.fillRect(50,370,376,70),new TEXT2(110,398,"click on the ball"))}},glitch=function(e,t,s,i,a,l){for(var n=ctx.getImageData(e,t,s,i),o=n.data,r=Math.random()>.5?7:2,h=0;h<o.length;h+=1+r)o[h]=o[h+1];ctx.putImageData(n,a,l)},drawBrick=function(e,t,s,i,a,l){s&&(ctx2.fillStyle="rgb("+s+","+i+","+a+")",ctx2.fillRect(e+2,t+2,30,16),ctx2.beginPath(),ctx2.lineWidth=1,ctx2.moveTo(e,t),ctx2.lineTo(e,t+20),ctx2.lineTo(e+34,t+20),ctx2.moveTo(e+1,t+1),ctx2.lineTo(e+1,t+19),ctx2.lineTo(e+33,t+19),ctx2.strokeStyle="#765954",ctx2.stroke(),ctx2.beginPath(),ctx2.moveTo(e+1,t),ctx2.lineTo(e+34,t),ctx2.lineTo(e+34,t+20),ctx2.moveTo(e+2,t+1),ctx2.lineTo(e+33,t+1),ctx2.lineTo(e+33,t+19),ctx2.strokeStyle="#e5d7d4",ctx2.stroke()),"X"!=l&&"G"!=l||ctx2.drawImage(imgs.e,e+2,t+2),"R"!=l&&"M"!=l||ctx2.drawImage(imgs.t,"M"==l?44:14,11,30,16,e+2,t+2,30,16),["H","I","J"].indexOf(l)>-1?(s*=1.2,i*=1.2,a*=1.2,ctx2.fillStyle="rgb("+Math.round(s)+","+Math.round(i)+","+Math.round(a)+")",ctx2.shadowBlur=10,ctx2.shadowColor="#000","J"==l&&(ctx2.fillRect(e+4,t+4,7,12),ctx2.fillRect(e+13,t+4,7,12),ctx2.fillRect(e+22,t+4,7,12)),"I"==l&&(ctx2.fillRect(e+4,t+4,11,12),ctx2.fillRect(e+18,t+4,11,12)),"H"==l&&ctx2.fillRect(e+6,t+4,24,12)):"T"==l||"F"==l?(ctx2.beginPath(),ctx2.arc(e+17,t+10,8,0,2*Math.PI,!1),ctx2.fillStyle="#000",ctx2.fill(),ctx2.lineWidth=3,ctx2.strokeStyle="#FFF",ctx2.stroke()):"N"==l&&(ctx2.shadowOffsetX=2,ctx2.shadowOffsetY=2,ctx2.shadowBlur=3,ctx2.shadowColor="#000",ctx2.beginPath(),ctx2.arc(e+17,t+10,4,0,2*Math.PI,!1),ctx2.lineWidth=1,ctx2.strokeStyle="#00F",ctx2.stroke(),ctx2.fillStyle="#FFF",ctx2.fill(),ctx2.shadowOffsetX=0,ctx2.shadowOffsetY=0),ctx2.shadowBlur=0},init=function(){generateLevel(),auto=!0,G.sprites=[],G.players=[],G.effects=[],G.bonus=[],G.monsters=[],ctx=document.getElementById("c").getContext("2d"),canvas=document.createElement("CANVAS"),canvas.width=476,canvas.height=500,ctx2=canvas.getContext("2d"),G.intervalPt&&clearInterval(G.intervalPt),G.intervalPt=setInterval("G.checkPt()",G.ptTime),G.level++,G.updateLives(),G.initStart(),gameLoop()},initLevel=function(e){for(G.nbBrick=0,level=[],y=0;y<30;y++)for(level[y]=[],e[y]||(e[y]="00000000000000"),x=0;x<14;x++)level[y][x]=new window["BRICK"+e[y][x]](x,y,e[y][x]);for(y=0;y<24;y++)for(x=0;x<14;x++){var t=level[y][x];switch(t.type){case"U":case"V":case"W":case"H":case"I":case"J":G.nbBrick++;var s=[];s[1]=!(!level[y-1]||!level[y-1][x-1])&&level[y-1][x-1],s[2]=!(!level[y-1]||!level[y-1][x])&&level[y-1][x],s[3]=!(!level[y-1]||!level[y-1][x+1])&&level[y-1][x+1],s[4]=level[y][x-1];for(var i=0,a=0,l=0,n=0,o=1;o<5;o++)s[o]&&s[o].r&&s[o].type==t.type&&(i++,a+=s[o].r,l+=s[o].g,n+=s[o].b);if(i>=1)"U"==t.type||"V"==t.type?f=i>1?8:32:f=i>1?4:8,t.r=Math.floor(a/i+(Math.random()*f-f/2)),t.g=Math.floor(l/i+(Math.random()*f-f/2)),t.b=Math.floor(n/i+(Math.random()*f-f/2)),t.r>255&&(t.r=255-t.r%255),t.g>255&&(t.g=255-t.g%255),t.b>255&&(t.b=255-t.b%255);else switch(t.type){case"V":t.r=136,t.g=204,t.b=136;break;case"W":t.r=87,t.g=168,t.b=221;break;case"H":case"I":case"J":case"U":t.r=221,t.g=168,t.b=87}break;case"T":t.r=27,t.g=54,t.b=81;break;case"X":t.r=255,t.g=255,t.b=255;break;case"G":t.r=236,t.g=234,t.b=35;break;case"N":t.r=231,t.g=34,t.b=169}}G.balls=[]},generateLevel=function(){function e(e){switch(e){case 0:case"U":case"V":case"W":case"X":return 3;case"M":case"F":case"N":return 0;default:return 1}}if(G.ptTime=1e4,"career"!=G.mode)return 11==G.level&&(G.ptTime=1e3),inflateLevel(dares[G.level]);seed=maps[G.level];var t=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,"U","U","U","U","U","U","V","V","V","V","V","W","W","W","W","H","H","H","I","I","J","G","X","X","X","R","M","N","F"];fakeRand=function(){return seed%=1e4,ret=seed/1e4,seed*=1215154987,ret},rand=function(e,t){return e+Math.round(fakeRand()*(t-e))},gettype=function(e,t){return!(!s[e]||!s[e][t])&&s[e][t].type};var s=[];for(i=0;i<21;i++)for(s[i]=[],x=0;x<14;x++)s[i][x]={type:0};for(areas=[],i=0;i<rand(8,21);i++){for(area="",x=0;x<14;x++)!1!==gettype(i,x-1)&&!1!==gettype(i-1,x)?0==rand(0,1)?0==rand(0,e(gettype(i,x-1)))?(type=t[rand(0,t.length-1)],s[i][x].type=type):s[i][x].type=gettype(i,x-1):0==rand(0,e(gettype(i-1,x)))?(type=t[rand(0,t.length-1)],s[i][x].type=type):s[i][x].type=gettype(i-1,x):!1!==gettype(i,x-1)?0==rand(0,e(gettype(i,x-1)))?(type=t[rand(0,t.length-1)],s[i][x].type=type):s[i][x].type=gettype(i,x-1):!1!==gettype(i-1,x)?0==rand(0,e(gettype(i-1,x)))?(type=t[rand(0,t.length-1)],s[i][x].type=type):s[i][x].type=gettype(i-1,x):(type=t[rand(0,t.length-1)],s[i][x].type=type),x>6&&(s[i][x].type=gettype(i,13-x)),area+=s[i][x].type;areas.push(area)}for(var i=0;i<areas.length;i++)if(-1!=areas[i].indexOf("F")){var a=rand(1,6),l=rand(1,areas.length-1);areas[l]=areas[l].substr(0,a)+"T"+areas[l].substr(a+1),areas[l-1]=areas[l-1].substr(0,a)+"0"+areas[l-1].substr(a+1),areas[l]=areas[l].substr(0,13-a)+"T"+areas[l].substr(14-a),areas[l-1]=areas[l-1].substr(0,13-a)+"0"+areas[l-1].substr(14-a);break}initLevel(areas)},inflateLevel=function(e){for(var t=[],s="",i=1,a=0;a<e.length;a++)new RegExp(/^[1-9a-e]$/).test(e[a])?i=parseInt(e[a],16):(s+=e[a].repeat(i),i=1,14==s.length&&(t.push(s),s=""));initLevel(t)},displayHome=function(){sp.clearRect(0,0,898,500),new TEXT2(10,40,"popnoid",sp,8),new TEXT2(245,250,(1==menu?"@":"")+" career mode",sp,2),new TEXT2(180,310,(2==menu?"@":"")+" challenges mode",sp,2),new TEXT2(245,370,(3==menu?"@":"")+" how to play",sp,2)},displayHowTo=function(){sp.clearRect(0,0,898,500),new TEXT2(10,40,"popnoid",sp,8),new TEXT2(270,200,"how to play",sp,2),new TEXT2(20,270,"use mouse to move the pad#you can direct the balls depending on the position of #your pad##there is a lot of bonus you can catch#few of them will help you when others do not...##the career mode request you to finish all the 123 levels#the challenge mode request you to win all the 12 dares#i made for you.",sp,1),new TEXT2(270,480,"click to return to menu",sp,1)},displayEndLevel=function(e){sp.clearRect(0,0,898,500),document.body.classList.remove("inGame"),G.players=[],new TEXT2(10,40,"popnoid",sp,8),e?(G.mode="career"==G.mode?"levelCompleted":"challengeCompleted",new TEXT2(220,280,"level completed",sp,2),new TEXT2(270,480,"click to play next level",sp,1)):(G.mode="gameOver",new TEXT2(310,280,"game over",sp,2),new TEXT2(270,480,"click to return to menu",sp,1))},displayInGame=function(){document.body.classList.add("inGame"),sp.clearRect(0,0,898,500),sp.fillStyle="#FFF",sp.fillRect(522,263,206,118),new TEXT2(540,80,"popnoid",sp,3),new TEXT2(541,355,"g",sp,1),new TEXT2(572,355,"l",sp,1),new TEXT2(603,355,"i",sp,1),new TEXT2(633,355,"t",sp,1),new TEXT2(666,355,"c",sp,1),new TEXT2(695,355,"JS",sp,1),init()},initBoard=function(){for(var e=0;e<imgsNames.length;e++)imgs[imgsNames[e]]=new Image,imgs[imgsNames[e]].onload=function(){displayHome()},imgs[imgsNames[e]].src=imgsNames[e]+".png";sb=document.getElementById("bg").getContext("2d"),sp=document.getElementById("speech").getContext("2d");var t=sb.createLinearGradient(0,0,476,500);t.addColorStop(0,"rgba(15, 0, 63,1)"),t.addColorStop(1,"rgba(53, 1, 84,1)"),sb.fillStyle=t,sb.fillRect(0,0,1920,1080);for(e=0;e<100;e++)dS(1920*Math.random(),1080*Math.random(),10+10*Math.random(),sb);var s=0;for(x=0;x<2;x++)for(var i=12;i<500;i+=160){s++;var a=document.createElement("DIV");a.className="pt",a.id="pt"+s,0==x&&(a.style.transform="scaleX(-1)"),492==i&&(a.className+=" bottom"),0==x?a.style.left="0":a.style.right="0",a.style.top=i+"px",document.getElementById("game").appendChild(a)}void 0!==document.hidden||(void 0!==document.mozHidden||document.webkitHidden),document.addEventListener("visibilitychange",(function(){document.hidden?clearInterval(G.intervalPt):G.intervalPt=setInterval("G.checkPt()",G.ptTime)}),!1),document.addEventListener("mousemove",(function(e){var t=e.movementX||e.mozMovementX||e.webkitMovementX||0;if(G.players.length){var s=G.players[0];if(!s.blocked&&(s.x=e.clientX-(window.innerWidth-898)/2-s.size/2-17,s.glue))for(var i=0;i<G.balls.length;i++)G.balls[i].glue&&(G.balls[i].x+=t)}else"menu"==G.mode&&(e.clientY>239&&e.clientY<287&&(menu=1,displayHome()),e.clientY>298&&e.clientY<347&&(menu=2,displayHome()),e.clientY>359&&e.clientY<407&&(menu=3,displayHome()))}),!1),document.onmousedown=function(e){if(G.wait){var t=document.getElementById("c").getBoundingClientRect(),s=e.clientX-t.left,i=e.clientY-t.top;s>227&&s<248&&i>466&&i<483&&(G.players[0].blocked=!1,G.balls[0].speed=5,G.wait=!1)}else if("gameOver"==G.mode)G.mode="menu",displayHome();else if("levelCompleted"==G.mode)G.mode="career",displayInGame();else if("challengeCompleted"==G.mode)G.mode="chalenge",displayInGame();else if("menu"==G.mode)switch(menu){case 1:G.mode="career",G.life=10,G.level=0,displayInGame();break;case 2:G.mode="challenge",G.life=30,G.level=0,displayInGame();break;case 3:G.mode="howTo",displayHowTo()}else"howTo"==G.mode?(G.mode="menu",displayHome()):G.players.length&&(G.addLaser(),G.players[0].dropGlueBalls())},displayHome()}</script><style>#all,#board,#speech{width:898px;margin:0 auto}#speech,body.inGame #board{display:block}#board,#speech,.pt{z-index:100}#bonus,.pt,body.inGame #speech{position:absolute}body{margin:0}#board,#game,#speech{position:relative}#game{height:500px;width:476px;padding:12px}#board{display:none}#bg{width:1920px;height:1080px;background-color:#2e0150;position:fixed}.pt::after,.pt::before{background-image:url("p.png");content:"";height:20px;left:-2px;position:absolute;width:12px}.pt::after{background-position:-12px 0;bottom:0}.pt{background:url("p.png") -24px 0 repeat-y;height:160px;transition:height 2s linear 0s;width:8px}.pt.opened{height:116px}.pt.bottom::after{content:none}.pt.bottom{height:20px}#bonus{color:#fff;left:516px;padding:10px;top:257px;height:98px;border:6px solid #ccd;border-color:#ccd #668 #668 #bbc;box-shadow:0 0 1px #000 inset}#bonus>div{float:left;margin:0 5px;vertical-align:baseline;background-color:#fff;border:2px solid #333;display:inline-block;height:73px;position:relative;width:17px}#bonus>div>*{background-image:-webkit-linear-gradient(bottom,#85ff85 0,#fd3131 50px);background-image:-moz-linear-gradient(center bottom ,#85ff85 0,#fd3131 50px);border-radius:3px 3px 0 0;bottom:0;display:block;height:0%;position:absolute;width:100%}#score{left:516px;top:200px}#life{height:98px;left:734px;top:257px;width:132px}#life,#score{position:absolute;border:6px solid #ccd;border-color:#ccd #668 #668 #bbc;box-shadow:0 0 1px #000 inset;padding:10px}</style><body onload=initBoard()><canvas height=1080 id=bg width=1920></canvas><div id=all><canvas height=500 id=speech width=898></canvas><div id=board><div id=game><canvas height=500 id=c width=476></canvas><canvas height=500 id=b width=476></canvas></div><canvas height=25 id=score width=350></canvas><div id=bonus><div id=bonus16><span></span></div><div id=bonus15><span></span></div><div id=bonus6><span></span></div><div id=bonus9><span></span></div><div id=bonus13><span></span></div><div id=bonus14><span></span></div></div><div id=life></div></div></div>