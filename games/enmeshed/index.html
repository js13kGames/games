<doctype html><title>Enmeshed</title><style>*{-webkit-user-select:none;box-sizing:border-box;font-family:monospace;user-select:none}body{background-image:-webkit-radial-gradient(top,circle cover,#094781 0,#07345e 80%);margin:20px;min-width:1200px;padding:20px}.display{background-color:#222;border:10px solid #222;border-radius:12px 12px 4px 4px;border-top-width:20px;box-shadow:0 0 0 1px #777;height:660px;left:50%;position:absolute;transform:translateX(-50%);width:1000px}.display:before{border:6px solid #333;border-radius:10px;content:"";left:494px;position:absolute;top:-11px}.display:after{border:4px solid #2c2c2c;border-radius:10px;content:"";left:496px;position:absolute;top:-9px}#screen{height:600px;top:10px}#screen,#terminal{background-color:#181818;color:#fff;font-size:11px;left:10px;padding:8px;position:absolute;width:960px}#terminal{height:595px;line-height:15px;overflow:hidden;top:2px}#cursor:before{animation:a 1s step-end infinite;color:#fff;content:"\0275A";display:inline-block}@keyframes a{0%,to{color:#fff}50%{color:#181818}}#info{background-color:rgba(24,24,24,.8);font-size:11px;position:absolute;right:8px;text-align:right;top:34px;width:150px}.decrypt{animation:b 2s forwards}@keyframes b{0%{color:#0073b1}to{color:#fff}}#email{padding-left:10px;white-space:normal;width:320px}.h{display:none!important}.fa{animation:c .5s forwards}@keyframes c{to{opacity:0;pointer-events:none}}#crash{animation:d .5s linear;color:#fff;height:580px;left:10px;letter-spacing:3px;line-height:22px;opacity:.5;overflow:hidden;padding:8px;position:absolute;top:14px;white-space:pre-wrap;width:960px;word-break:break-all}@keyframes d{0%{height:0}to{height:95%}}#o{animation:e .3s;height:606px;left:10px;padding:8px;top:-2px;width:960px}#o,#ob{position:absolute}#ob{border:8px solid rgba(255,0,0,.5);border-radius:16px;color:#fff;display:inline-block;font-size:60px;font-weight:700;left:50%;letter-spacing:32px;padding:20px 20px 20px 40px;top:50%;transform:translate(-50%,-50%)}#ob:before{background-color:rgba(255,0,0,.3);content:"";height:125px;left:20px;position:absolute;top:20px;width:550px;z-index:-1}.failed{border-color:#f47e1b!important}.failed:hover{color:#f47e1b!important}.failed:before{background-color:rgba(244,126,27,.3)!important}#continue{background-color:#181818;border:4px solid rgba(255,0,0,.5);border-radius:5px;color:#fff;cursor:pointer;font-size:16px;left:640px;line-height:20px;padding:8px;position:absolute;top:410px}#continue:hover{color:red}@keyframes e{0%{opacity:0}to{opacity:1}}#console{font-size:12px;height:60px;overflow:hidden;top:530px;width:944px}#console,#retry{color:#fff;position:absolute}#retry{align-items:center;cursor:pointer;display:flex;font-size:20px;right:10px;top:540px}#retry-text{font-size:12px;padding-right:8px}#quit{align-items:center;color:#fff;cursor:pointer;display:flex;font-size:20px;position:absolute;right:10px;top:570px}#quit-text{font-size:12px;padding-right:8px}.brand{color:#333;font-family:sans-serif;font-size:14px;left:50%;letter-spacing:1px;position:absolute;top:614px;transform:translateX(-50%)}.base{background:#999;background-image:-webkit-linear-gradient(left,#555,#777 50%,#555);border-bottom:3px solid #555;border-radius:0 0 20px 20px;box-shadow:1px 1px 10px 0 #333;height:26px;top:694px;width:1160px}.base,.base:before{left:50%;position:absolute;transform:translateX(-50%)}.base:before{background:#999;border-radius:0 0 10px 10px;content:"";display:block;height:14px;width:180px}.title{background-image:-webkit-linear-gradient(left,#094781,#181818 40%);letter-spacing:3px}.banner,.title{border-radius:5px;padding:4px 0 4px 8px}.banner{background-image:-webkit-linear-gradient(left,#094781,#181818 60%);font-weight:700}#mesh{height:510px;left:34px;position:absolute;top:30px;width:926px}#mesh circle,#mesh line{cursor:pointer}.mesh-id{left:370px;position:absolute;text-align:center;top:12px;width:230px}.spinner{animation:f .8s ease infinite;display:inline-block}@keyframes f{to{transform:rotate(1turn)}}.b{animation:g 2s ease-in-out infinite alternate}@keyframes g{to{opacity:.6}}.health{top:12px}#coins,.health{position:absolute;right:12px}#coins{top:30px}#data{right:175px;top:11px}#data,#to{position:absolute}#to{font-size:28px;height:400px;left:0;line-height:42px;text-align:center;top:34px;width:32px}[data-tool]{border-left:2px solid transparent;cursor:pointer}[data-tool]>div{font-size:10px;line-height:10px;padding-bottom:10px}[data-tool=info]{font-size:20px;font-weight:700;padding-left:6px;padding-top:10px}[data-tool=info].s,[data-tool=info]:hover{border-left:2px solid #fff}[data-tool=crash].s,[data-tool=crash]:hover{border-left:2px solid #d34e53}[data-tool=cut].s,[data-tool=cut]:hover{border-left:2px solid #f89100}[data-tool=slow].s,[data-tool=slow]:hover{border-left:2px solid #fcc700}[data-tool=corrupt]{font-size:20px}[data-tool=corrupt].s,[data-tool=corrupt]:hover{border-left:2px solid #535c8e}[data-tool=reroute].s,[data-tool=reroute]:hover{border-left:2px solid #9e379f}[data-tool=intercept]{font-size:26px}[data-tool=intercept].s,[data-tool=intercept]:hover{border-left:2px solid #1375f7}[data-tool=mine]{font-size:26px}[data-tool=mine].s,[data-tool=mine]:hover{border-left:2px solid #080}.n{fill:#5691dc}.n:hover{stroke:#5691dc;stroke-width:7px}.ne{fill:transparent;pointer-events:none;stroke:transparent;stroke-width:2px}.n:hover+.ne{animation:none;stroke-dasharray:none;stroke-width:4px}.nea{animation:h 3s linear infinite reverse;stroke-dasharray:5 2}.nec{stroke:#535c8e}.ner{stroke:#9e379f}.nei{stroke:#1375f7}.neh{stroke:#080}.nef{stroke:#fff}.np{fill:#8bbf50}.np:hover{stroke:#8bbf50!important}.no{fill:#d34e53!important}.no:hover{stroke:#d34e53!important}.ei{stroke:transparent;stroke-width:4px}.ei:hover{stroke:hsla(0,0%,60%,.3)}.ee{stroke:hsla(0,0%,100%,.2)}.ef,.er{stroke:transparent}.es{stroke:#fcc700!important}.ec{stroke:#d34e53!important}.ees{stroke:rgba(252,199,0,.3)}.eoe{stroke:#d34e53}.epe{stroke:transparent!important}.epf{animation:h 3s linear infinite;stroke:#8bbf50;stroke-dasharray:5}.epr{animation:h 3s linear infinite reverse;stroke:#3b6d3d;stroke-dasharray:5}@keyframes h{to{stroke-dashoffset:100}}</style><script>function e(e){for(e=e||Date.now(),this.N=624,this.M=397,this.MA=2567483615,this.UM=2147483648,this.LM=2147483647,this.I=Math.pow(2,32),this.mt=new Array(this.N),this.mti=this.N+1,this.mt[0]=e>>>0,this.mti=1;this.mti<this.N;this.mti++){let e=this.mt[this.mti-1]^this.mt[this.mti-1]>>>30;this.mt[this.mti]=(1812433253*((4294901760&e)>>>16)<<16)+1812433253*(65535&e)+this.mti,this.mt[this.mti]>>>=0}}function n(e,t){let n="";for(let s=0;s<e.length;s++){let i=e.charCodeAt(s);(i+=t?-13:13)>126?i=i-127+32:i<32&&(i=i-32+127),n+=String.fromCharCode(i)}return n}e.prototype.random=function(){let e,t=new Array(0,this.MA);if(this.mti>=this.N){let n;for(n=0;n<this.N-this.M;n++)e=this.mt[n]&this.UM|this.mt[n+1]&this.LM,this.mt[n]=this.mt[n+this.M]^e>>>1^t[1&e];for(;n<this.N-1;n++)e=this.mt[n]&this.UM|this.mt[n+1]&this.LM,this.mt[n]=this.mt[n+(this.M-this.N)]^e>>>1^t[1&e];e=this.mt[this.N-1]&this.UM|this.mt[0]&this.LM,this.mt[this.N-1]=this.mt[this.M-1]^e>>>1^t[1&e],this.mti=0}return e=this.mt[this.mti++],e^=e>>>11,e^=e<<7&2636928640,e^=e<<15&4022730752,e^=e>>>18,(.5+(e>>>=0))/this.I};let t=new e,s=(e,n)=>Math.floor(t.random()*(n-e+1))+e;Map.prototype.value=function(e){let t=this.get(e);return void 0===t?1/0:t};let i=e=>Object.keys(e||{}).length,o=e=>document.getElementById(e),r=(e,t)=>e.classList.add(t),c=(e,t)=>e.classList.remove(t),a=e=>r(e,"h"),l=e=>c(e,"h"),u=e=>e.scrollTop=e.scrollHeight+e.clientHeight,h={};function d(){let e=null;for(;null===e||h[e];)e=s(1,254)+"."+s(0,254)+"."+s(0,254)+"."+s(1,254);return h[e]=!0,e}function f(e,t){let n=0;function s(e,t){setTimeout(e,t||0)}function i(e){!1===e?t&&s(t):(n++,s(r,e=void 0===e||e<0?100:parseInt(e)))}function r(){s((function(){e(i,n)}))}r()}let p='<div class="banner">Gilgamesh OS version 4.15.0-33-generic (build 13,312)</div>\nCommand line: BOOT_IMAGE=/gilgamesh-4.15.0-33-generic root=/dev/sda2:ro\nKERNEL supported cpus:\n  MaasNeotek m47_64\nm47/fpu: Supporting XSAVE feature 0x001: m87 floating point registers\nm47/fpu: Supporting XSAVE feature 0x002: SSE registers\nm47/fpu: Enabled xstate features 0x7, context size 832 bytes\ne820: BIOS-provided physical RAM map\ne820: update [mem 0x00000000-0x00000fff] usable => reserved\ntotal RAM covered: 16288M\nOn node 0 totalpages: 4164976\n  DMA zone: 64 pages used for memmap\n  DMA zone: 3997 pages, LIFO batch:0\n  Normal zone: 54720 pages used for memmap\n  Normal zone: 3502080 pages, LIFO batch:31\nReserved but unavailable: 98 pages\nACPI: PM-Timer IO Port: 0x1808\nACPI: Local APIC address 0xfee00\nsmpboot: Allowing 4 CPUs\nKernel/User page tables isolation enabled\nHierarchical RCU implementation\n  RCU restricting CPUs from nr_cpu=8192 to nr_cpu_ids=4\n  Tasks RCU enabled\nRCU: Adjusting geometry for nr_cpu_ids=4\nNR_IRQS 52454, nr_irqs 728, preallocated irqs 16\nconsole: color smart device [tty0] enabled\nACPI: Core revision 20180813\nSecurity Framework initialized\nmce: CPU supports 7 MCE banks\nsmp: Bringing up secondary CPUs\nm47: Booting SMP configuration:\n  node 0, CPUs: 1 2 3\nsmp: Brought up 1 node, 4 CPUs\nPCI host bridge to bus 0000:00\npci_bus 0000:00: root bus resource [io  0x0000-0x0cf7]\npci_bus 0000:00: root bus resource [mem 0xfe000000-0xfe113fff]\npci_bus 0000:00: root bus resource [bus 00-3e]\nusbcore: registered new interface drivers: usbfs, hub, usb, mesh\nNET: Registered protocol family 1\nNET: Registered protocol family 2\nTCP established hash table entries: 1310722 (1048576 bytes)\nTCP bind hash table entries: 65536 (1048576 bytes)\nTCP: Hash tables configured (established 131072 bind 65536)\nNET: Registered protocol family 47\nMeshtooth: Core ver 0.47\nMeshtooth: NET device and connection manager initialized\nEXT5-fs (sda2): mounting ext4 file system using the ext5 subsystem\nEXT5-fs (sda2): mounted filesystem with journal.\nBridge firewalling registered\nInitializing XFRM meshlink socket\nMeshfilter messages via MESHLINK v0.47\nrandom: initializing Mersenne Twister\nMeshConnect initializing interface mesh0\n&K\n?2000Entering interactive mode...!!\n&L\nGilgamesh 47.04.3 LTS terminus tty0\n\nterminus login: &Tmark\nPassword: &T&R15*\n?800!!\nWelcome to Gilgamesh 47.04.3 LTS (Gilgamesh OS 4.15.0-33 m47_64)\n\n System information as of &DT\n\n System load:  0.0                Processes:              135\n Usage of /:   2.1% of 256GB      Users logged in:        1\n Memory usage: 1%                 IP address for en0:     &IP\n Swap usage:   0%                 IP address for mesh0:   &IP\n\n\nLast login: &DP\n\nYou have new mail.\n',m='&P&T./enmeshed\n\n<div style="color:#005b96;line-height:8px;letter-spacing:-1px">  ███████╗███╗   ██╗███╗   ███╗███████╗███████╗██╗  ██╗███████╗██████╗<br>  ██╔════╝████╗  ██║████╗ ████║██╔════╝██╔════╝██║  ██║██╔════╝██╔══██╗<br>  █████╗  ██╔██╗ ██║██╔████╔██║█████╗  ███████╗███████║█████╗  ██║  ██║<br>  ██╔══╝  ██║╚██╗██║██║╚██╔╝██║██╔══╝  ╚════██║██╔══██║██╔══╝  ██║  ██║<br>  ███████╗██║ ╚████║██║ ╚═╝ ██║███████╗███████║██║  ██║███████╗██████╔╝<br>  ╚══════╝╚═╝  ╚═══╝╚═╝     ╚═╝╚══════╝╚══════╝╚═╝  ╚═╝╚══════╝╚═════╝<br><br>&R73&#x2500;\n&$\n 1) Story\n\n 2) Challenge\n&O\n&I',g="\n?1000&Prm -rf /\n&KKernel Panic\nKernel Panic\nKernel Panic\nOFFLINE\n?5000Rebooting...",w=`\n&P&Tmail --unread\n&m one unread message:\n&V&#x250C;&R72&#x2500;\n  &BDate:&b &DE\n  &BFrom:&b Unverified Sender &lt;unverified@gilgamesh.network&gt;\n  &BTo:&b Mark Barr &lt;mark@enmeshed.net&gt;\n  &BSubject:&b Hackers Hate This Mesh Network, Find Out Why!\n  &BAttachments:&b <span id="attachment">mesh.pdf.exe</span>\n  <div id="email">${n("Mark,\n  I can't believe you were forced out of the company that YOU founded\nbecause you tried stop Gilgamesh technology from being deployed as a\ntool for surveillance and censorship.\n\n  The first phase of meshes are being rolled out today. Hypothetically\nspeaking, it would be a disasterous if somehow all those meshes went\noffline... A failure of that scale would likely doom the company and\nthe technology. Anywho, I've attached some unrelated data that can\njust delete...\nGood luck,\n  -Deborah".replace(/\n/g,"&"))}</div>\n&V&#x2514;&R72&#x2500;\n?3000&m Encryption detected - decrypting... <span id="decryptor" class="spinner">|</span>\n&Y&C&m Press &BENTER&b to download attachment and delete message.\n&y&N&m saved to ~/Downloads/enmeshed.zip\n&P&Tunzip ~/Downloads/enmeshed.zip\n inflating: enmeshed.txt\n extracting: gilgamesh-plugin-MemCorrupt.bin\n extracting: gilgamesh-plugin-DoS.RST.bin\n extracting: gilgamesh-plugin-MiTM.Proxy.bin\n&P&Tcat enmeshed.txt\n&F\n&G0\n`;function y(e,t,n,s){let o=this;o.B="e",o.id=t,o.nm=e.es.length.toString(16).padStart(4,0),o.on=!0,o.sp=e.R(1,e.sps.length-1),o.ns=[n,s],o.st={x:n.pos.x,y:n.pos.y},o.en={x:s.pos.x,y:s.pos.y},o.ts=Math.ceil(e.di(n,s)),o.els={em:e.svg.L(o.st.x,o.st.y,o.en.x,o.en.y,"ee"),fo:e.svg.L(o.st.x,o.st.y,o.en.x,o.en.y,"ef"),r:e.svg.L(o.st.x,o.st.y,o.en.x,o.en.y,"er"),i:e.svg.L(o.st.x,o.st.y,o.en.x,o.en.y,"ei")},o.els.i.onclick=function(){if(!o.et){if("cut"===e.et.T&&e.t.cut.dc())o.on=!1,r(o.els.em,"eoe"),r(o.els.fo,"ec"),r(o.els.r,"ec");else{if("slow"!==e.et.T||!e.t.slow.dc())return;o.sp=0,r(o.els.em,"ees"),r(o.els.fo,"es"),r(o.els.r,"es")}o.et=e.t[e.et.T]}},o.els.i.onmouseover=function(){let t=Math.max(n.a.length,s.a.length),i="Connection #"+o.nm+e.do(o)+"\n\n"+e.do(n)+"  &#x21B1; "+n.a.padStart(t," ")+" \n"+e.do(s)+"  "+s.a.padEnd(t," ")+" &#x21B2; \n\n"+"Bandwidth:".padEnd(t+3," ")+"\n";0===o.sp?i+='<span style="color:#D9AF3C">'+e.sps[o.sp].nm+"  </span>":i+=e.sps[o.sp].nm+"  ",o.et&&(i+='\n\n<span style="color:red">Anomaly detected: </span>\n'+o.et.nm+"/"+o.et.cve),e.els.info.innerHTML=i},o.els.i.onmouseout=function(){e.els.info.innerHTML=""},e.es.push(o),e.cs[t]=o,n.cs[s.id]={so:n,n:s,e:o},s.cs[n.id]={so:s,n:n,e:o},n.fs[t]={nm:"me"+i(n.fs),rx:0,tx:0,dr:0},s.fs[t]={nm:"me"+i(s.fs),rx:0,tx:0,dr:0};let a=new Set;return o.p={},o.p.scan=function(){if(a.size){let e=!1,t=!1;a.forEach((function(s){s.hp&&s.hp.n===n?e=!0:t=!0})),r(o.els.em,"epe"),e?r(o.els.fo,"epf"):c(o.els.fo,"epf"),t?r(o.els.r,"epr"):c(o.els.r,"epr")}else c(o.els.em,"epe"),c(o.els.fo,"epf"),c(o.els.r,"epr")},o.p.add=function(e){a.add(e),o.p.scan()},o.p.delete=function(e){a.delete(e),o.p.scan()},o}function M(e){let t=this;for(t.B="n",t.on=!0;void 0===t.id||void 0!==e.ps[t.id];)t.x=e.R(0,e.w-1),t.y=e.R(0,e.h-1),t.id=e.id(t.x,t.y);e.ps[t.id]=t,t.pos={x:t.x*e.sc+e.sc/2+e.R(-e.pe,e.pe),y:t.y*e.sc+e.sc/2+e.R(-e.pe,e.pe)},t.a=d(),e.aa[t.a]=t,t.cs={},t.fs={},t.sa=function(n){let s=[];for(let i=t.y-n;i<=t.y+n;i++)for(let r=t.x-n;r<=t.x+n;r++){let n=e.coords(r,i);n&&n.id!==t.id&&s.push(n)}return s},t.connect=function(){for(let n=e.ra;i(t.cs)<e.m;n++)t.sa(n).forEach((function(n){let s=[t.id,n.id].sort().join("-");e.cs[s]||new y(e,s,t,n)}))},t.createElement=function(){let n=e.sc/4;t.el=e.svg.I(t.pos.x,t.pos.y,n),t.O=e.svg.I(t.pos.x,t.pos.y,n+2,"ne"),t.el.onclick=function(){if(!t.et){if("crash"===e.et.T&&e.t.crash.dc())t.on=!1,r(t.el,"no");else if("corrupt"===e.et.T&&e.t.corrupt.dc())r(t.O,"nec");else if("reroute"===e.et.T&&e.t.reroute.dc())r(t.O,"ner");else if("intercept"===e.et.T&&e.t.intercept.dc())r(t.O,"nei");else{if("mine"!==e.et.T||!e.t.mine.dc())return;r(t.O,"neh")}t.et=e.t[e.et.T]}},t.el.onmouseover=function(){let n="Node "+t.a+e.do(t)+"\n\n"+"Interfaces:".padEnd(25," ")+"\n";for(let e in t.fs){let s=t.fs[e];n+=s.nm.padEnd(4," ")+": &#x2944; "+(s.rx+"").padStart(3," ")+" &#x2942; "+(s.tx+"").padStart(3," ")+" &#x21E3; "+(s.dr+"").padStart(2," ")+"\n"}n+="\nRX &#x2944;, TX &#x2942;, DROPPED &#x21E3;",t.et&&(t.et.fw?n+='\n\n<span style="color:#FC0">Firewalled</span>':n+='\n\n<span style="color:red">'+"Malware detected:".padEnd(25," ")+"</span>\n"+t.et.nm+"/"+t.et.cve),e.els.info.innerHTML=n},t.el.onmouseout=function(){e.els.info.innerHTML=""}};let n=new Set;return t.p={},t.p.add=function(s){n.add(s),r(t.el,"np"),r(t.O,"nea"),t.et&&("corrupt"===t.et.T?s.corrupt=!0:"mine"===t.et.T?(e.N++,s.ts++):"intercept"===t.et.T&&s.Y&&(e.data=!0))},t.p.delete=function(e){n.delete(e),n.size||(c(t.el,"np"),c(t.O,"nea"))},t}function b(e,t,n){let s=this;for(s.origin=s.so=t,s.d=n;void 0===s.d||s.d===s.so;)s.d=e.ns[e.R(0,e.ns.length-1)];return t.fd&&(s.Y=!0),s.mh=1/0,s.mk=1/0,s.size=e.R(1,e.sps.length-1),s.corrupt=!1,s.path=[],s.ts=0,s.cu=t,t.p.add(s),s.pf=function(t,n){let i=new Set,r=new Set([t]),o=new Map,a=new Map;a.set(t,0);let l=new Map;for(l.set(t,e.di(t.pos,n.pos));r.size;){let c;if(r.forEach((function(e,t){c?e<l.value(c)&&(c=t):c=t})),c===n){let i=[n],r=[],a=0;for(;o.has(c);){let t=c;c=o.get(c),i.push(c);let n=c.cs[t.id].e;r.push(n),a+=Math.ceil(n.ts*(e.sps[s.size].value/e.sps[n.sp].value))}s.mh===1/0&&(s.mh=Math.ceil(i.length*e.mh),s.mk=Math.ceil(a*e.mt)),e.ips[n.a+t.a]={path:i,es:r},i=i.slice().reverse(),e.ips[t.a+n.a]={path:i,es:r},s.ip=i;for(let e in i[0].cs){let t=i[0].cs[e];if(t.n===i[1])return t}return!1}r.delete(c),i.add(c);for(let t in c.cs){let s=c.cs[t],u=s.n;if(!u.on||!s.e.on||i.has(u))continue;let h=a.value(c)+e.di(c.pos,u.pos);if(r.has(u)){if(h>=a.value(u))continue}else r.add(u);o.set(u,c),a.set(u,h),l.set(u,h+e.di(u.pos,n.pos))}}return!1},s.route=function(){if("e"===s.cu.B&&s.hp)if(s.U){if(s.ts>s.mk)return s.dr=!0,s.cu.p.delete(s),void s.hp.so.fs[s.hp.e.id].dr++;s.U--,s.ts++}else s.hp.n.fs[s.hp.e.id].rx++,s.hp.e.p.delete(s),s.cu=s.hp.n,s.hp.n.p.add(s),s.cf=s.hp,s.hp=null;else{if(s.path.length>s.mh)return s.dr=!0,s.cu.p.delete(s),void(s.cf&&s.cu.fs[s.cf.e.id].dr++);if(s.cu!==s.d){if(s.cu.et&&"reroute"===s.cu.et.T){let t=[];for(let e in s.cu.cs){let n=s.cu.cs[e];n.n.on&&n.e.on&&t.push(n)}t.length&&(s.hp=t[e.R(0,t.length)])}else if(s.ip){let e=s.ip.indexOf(s.cu);if(-1!==e&&e<s.ip.length&&s.ip[e+1]){let t=s.ip[e+1],n=s.cu.cs[t.id];n.n.on&&n.e.on?s.hp=n:s.ip=null}else s.ip=null}s.hp||(s.hp=s.pf(s.cu,s.d)),s.hp?(s.cu.p.delete(s),s.cu.fs[s.hp.e.id].tx++,s.U=Math.ceil(s.hp.e.ts*(e.sps[s.size].value/e.sps[s.hp.e.sp].value)),s.cu=s.hp.e,s.hp.e.p.add(s),s.path.push(s.hp.n.a)):(s.dr=!0,s.cu.p.delete(s),s.cf&&s.cu.fs[s.cf.e.id].dr++)}else{s.corrupt&&(s.dr=!0,s.cu.p.delete(s),s.cf&&s.cu.fs[s.cf.e.id].dr++),s.d=s.so,s.so=s.cu,s.path=[],s.ts=0;let t=s.so.a+s.d.a;e.ips[t]&&(s.ip=e.ips[t].path)}}},s}function x({mi:t,width:n,height:s,factor:d,sc:f,ra:p,m:m,interval:g,cm:w,mh:y,mt:x,threshold:v,se:E,oj:T,E:C,data:L,N:I},k){let S=this;S.w=n||20,S.h=s||S.w,S.factor=d||.25,S.sc=f||Math.max(10,Math.ceil(Math.min(700/S.w,450/S.h))),S.ra=p||3,S.m=m||3,S.interval=g||500,S.cm=w||2,S.mh=y||1.2,S.mt=x||2,S.threshold=v||50,S.id=function(e,t){return e.toString().padStart(S.scope,"0")+"."+t.toString().padStart(S.scope,"0")},S.coords=function(e,t){let n=S.id(e,t);return S.ps[n]},S.di=function(e,t){return Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))},S.clear=function(e){for(;e.firstChild;)e.removeChild(e.firstChild)},S.do=function(e){return'<span style="color:'+(e.on?e.et?e.et.color:"#5691DC":"#D34E53")+'"> &#x'+(e.on?"25C9":"25CE")+";</span>"},S.els={N:o("coins"),cont:o("continue"),crash:o("crash"),data:o("data"),health:o("health"),info:o("info"),mi:o("mesh-id"),o:o("o"),quit:o("quit"),q:o("quit-text"),retry:o("retry"),rt:o("retry-text"),S:o("spinner"),to:o("to")},S.C={el:o("console"),buffer:"",log:function(e){this.buffer+=e,this.el.innerHTML=this.buffer,u(this.el)},clear:function(){return this.el.innerHTML=this.buffer="",this},display:function(e){this.el.innerHTML=e},reset:function(){this.el.innerHTML=this.buffer}},S.sps=[{nm:"512Mbps",value:.5},{nm:"1024Mbps",value:1},{nm:"2048Mbps",value:2},{nm:"4096Mbps",value:3},{nm:"8192Mbps",value:4}],S.t={info:{nm:"Information",color:"white",de:"View information about nodes and connections.\nScroll to <u>Zoom</u> and use the Arrow Keys to <u>Pan</u>.",E:-1},crash:{nm:"Crash",color:"#D34E53",de:"Crash a <u>node</u> with a malformed packet leading to memory corruption.",cve:"MemCorrupt",E:0},cut:{nm:"Cut",color:"#F89100",de:"Bring the <u>connection</u> between nodes offline by flooding it with spoofed reset packets.",cve:"DoS.RST",E:0},slow:{nm:"Slow",color:"#FCC700",de:"Trigger a rate limiter causing all traffice through a <u>connection</u> to be slowed due to reduce bandwidth.",cve:"Rate.Limit",E:0},corrupt:{nm:"Corrupt",color:"#535C8E",de:"Exploit a buffer overlow in packet inspection in a <u>node</u>, corrupting all packets passing throught it.",cve:"Buf.Overflow",E:0},reroute:{nm:"Reroute",color:"#9E379F",de:"Rewrite the route table of a <u>node</u> so that packets are randomly routed to different nodes.",cve:"Conf.Rewrite",E:0},intercept:{nm:"Intercept",color:"#1375F7",de:"Using a man-in-the-middle attack, intercept all data passing through a <u>node</u>.",cve:"MiTM.Proxy",E:0},mine:{nm:"Mine",color:"#080",de:"Inject code into a <u>node</u> to mine MeshCoins as it processes packets.",cve:"Code.Inject",E:0}};let P=-1;function H(e){c(e.el,"np"),r(e.el,"no");for(let t in e.cs){let n=e.cs[t].e;c(n.els.em,"epe"),r(n.els.em,"eoe"),c(n.els.fo,"epf"),c(n.els.r,"epr")}}return"number"==typeof L?(P=L,L=!0):!0!==L&&(L=!1),S.init=function(){if(S.cd=!1,S.N=0,S.clear(S.els.N),S.data=!1,S.clear(S.els.data),c(S.els.data,"decrypt"),h={},S.P=new e(E),S.R=(e,t)=>Math.floor(S.P.random()*(t-e+1))+e,S.aa={},S.ps={},S.ns=[],S.cs={},S.es=[],S.ips={},S.svg=function(){let e,t=o("mesh"),n=1,s=(926-S.w*S.sc)/2+4,i=(510-S.h*S.sc)/2+4;S.clear(t),t.add=function(e,n){let s=function(e,t){let n=document.createElementNS("http://www.w3.org/2000/svg",e);for(let e in t)n.setAttribute(e.toLowerCase(),t[e]);return n}(e,n);return t.appendChild(s),s},t.I=function(e,n,r,o){return t.add("circle",{cx:e+s,cy:n+i,r:r,class:o||"n"})},t.L=function(e,n,r,o,a){return t.add("line",{x1:e+s,y1:n+i,x2:r+s,y2:o+i,class:a||"e"})};let r=n=>{e=n,t.setAttribute("viewBox",e.join(" "))};return r([0,0,926,510]),t.onwheel=function(t){n+=.001*t.deltaY,n=Math.min(Math.max(n,1),5);let s=Math.round(926/n),i=Math.round(510/n),o=e[0]-t.offsetX/926*(s-e[2]),a=e[1]-t.offsetY/510*(i-e[3]);r([o,a,s,i])},window.onkeydown=function(t){let n=t.keyCode;if(37===n)e[0]+=10;else if(38===n)e[1]+=10;else if(39===n)e[0]-=10;else if(40===n)e[1]-=10;else{if("0"!==t.key||!t.ctrlKey)return;e=[0,0,926,510]}r(e)},t}(),c(S.els.to,"fa"),c(S.C.el,"fa"),l(S.els.S),S.clear(S.els.info),S.els.mi.innerHTML=t,S.els.health.innerHTML="100%",S.C.clear().log('<div class="spinner">&#x21C6;</div> Connecting...'),C)for(let e in C)S.t[e].E=C[e];S.et=S.t.info,document.querySelectorAll("[data-tool]").forEach((function(e){let t=e.dataset.tool,n=S.t[t];if(n.T=t,n.el=e,n.use=o(t+"-use"),c(n.el,"s"),n.dc=function(){return n.E===1/0||n.E>0&&(n.E--,n.use.innerHTML=n.E,!0)},n.E<0||n.E===1/0)n.E=1/0,n.use.innerHTML="";else{if(0===n.E)return void a(n.el);n.use.innerHTML=n.E}l(n.el),e.onclick=function(){for(let e in S.t)e===t?(S.et=S.t[t],r(S.t[e].el,"s")):c(S.t[e].el,"s")},e.onmouseover=function(){let e=S.t[t],n='<span style="text-decoration:underline;color:'+e.color+'">'+e.nm+"</span>\n"+e.de;S.C.display(n)},e.onmouseout=function(){S.C.reset()}})),r(S.t.info.el,"s"),S.U=Math.floor(S.w*S.h*S.factor),S.scope=Math.ceil(S.U%10),S.pe=Math.ceil(S.sc/5);for(let e=0;e<S.U;e++)S.ns.push(new M(S));S.ns.forEach((function(e){e.connect()}));for(let e=0;e<S.U;e++)S.ns[e].createElement();if(!1!==L){if(-1===P){let e=S.m;for(;!S.fw;){for(let t=0;t<S.U;t++)if(i(S.ns[t].cs)<=e){S.fw=S.ns[t];break}e++}}else S.fw=S.ns[P];S.fw.et={fw:!0},S.fw.fd=!0,r(S.fw.O,"nef")}S.ps=[];for(let e=0;e<S.cm;e++)for(let e=0;e<S.U;e++)S.ps.push(new b(S,S.ns[e]));S.crashed=!1,S.router&&clearInterval(S.router),S.router=setInterval((function(){if(S.crashed)return;for(let e=0;e<S.ps.length;e++)S.ps[e].route();S.ps=S.ps.filter((function(e){return!e.dr}));let e=Math.round(S.ps.length/(S.U*S.cm)*100);if(S.els.health.innerHTML=e+"%",S.N&&(S.els.N.innerHTML="$ "+(S.N/1e3).toFixed(3)+" meshcoins"),S.data&&(S.els.data.innerHTML="&#x291E; Data Intercepted!",r(S.els.data,"decrypt")),e<S.threshold&&!S.crashed)return S.crash();if(!S.cd){S.cd=!0,S.C.clear().log("&#x21B9; Connected!"),S.C.log("\nObjective: "+(T.length>80?T.replace(/^(.*), (.*?)$/,"$1,\n           $2"):T)),l(S.els.retry),l(S.els.quit);let e="Quit",t="Restart",n="You sure?",s=0;S.els.quit.onmouseover=function(){S.els.q.innerHTML=s?n:e},S.els.quit.onmouseout=function(){s=0,S.els.q.innerHTML=""},S.els.quit.onclick=function(){if(s)return S.quit=!0,S.router&&clearInterval(S.router),k(S);s=1,S.els.q.innerHTML=n};let i=0;S.els.retry.onmouseover=function(){S.els.rt.innerHTML=s?n:t},S.els.retry.onmouseout=function(){i=0,S.els.rt.innerHTML=""},S.els.retry.onclick=function(){i?(S.els.retry.onmouseout(),S.crashed=!0,S.router&&clearInterval(S.router),S.init()):(i=1,S.els.rt.innerHTML=n)}}}),S.interval)},S.crash=function(){if(S.A)return;S.A=!0;let e=o("ob");L&&!S.data||I&&S.N<I?(r(e,"failed"),r(S.els.cont,"failed"),S.els.cont.innerHTML="Retry &#x21BB",e.innerHTML="FAILED!",S.failed=!0):(c(e,"failed"),c(S.els.cont,"failed"),S.els.cont.innerHTML="Disconnect &#x21CE",e.innerHTML="OFFLINE");let t="01012345678901X[]\\/?{}ABCDEFSSSSGGHHIJKL".split(""),n={S:[1,14," "],G:[1,3,"&#xFFFD;"],H:[1,3,"&#x23F4;"],I:"&#x2400;",J:"&#x240D;",K:"&#x2421;",L:"&#x2327;"},s=0;function i(e){if(e=n[e]||e,Array.isArray(e)){let t=S.R(e[0],e[1]);return s+=t,e[2].repeat(t)}return s++,e}let u="";for(s=0;s<2150;)u+=i(t[S.R(0,t.length-1)]);let h=0,d=Math.floor(S.ns.length/3),f=2*d,p=S.ns.length,m=setInterval((function(){if(0===h){a(S.els.retry),a(S.els.quit),clearInterval(S.router);for(let e=0;e<d;e++)H(S.ns[e])}else if(1===h)for(let e=d;e<f;e++)H(S.ns[e]);else if(2===h)for(let e=f;e<p;e++)H(S.ns[e]);else 3===h?(S.els.crash.innerHTML=u,l(S.els.crash),r(S.els.to,"fa"),r(S.C.el,"fa")):4===h&&(clearInterval(m),l(S.els.o),a(S.els.S),r(S.svg,"b"),S.els.health.innerHTML="OFFLINE",S.crashed=!0,k?(l(S.els.cont),S.els.cont.onclick=function(){return a(S.els.crash),a(S.els.o),c(S.svg,"b"),k(S)}):a(S.els.cont));h++}),S.interval)},S.init(),S}function v(){let e=[{mi:"[::1]/practice/0",width:5,se:12,m:2,oj:"Practice using crashes to take the mesh offline.",E:{crash:4}},{mi:"[::1]/practice/1",width:5,se:11,m:1,oj:"Practice using cuts to take the mesh offline.",E:{cut:5}},{mi:"[::1]/practice/2",width:5,se:26,m:2,oj:"Practice using crashes and cuts to take the mesh offline.",E:{crash:2,cut:2}},{mi:"[::1]/practice/3",width:5,se:36,m:2,data:3,oj:"Practice intercepting data from the firewalled node using an adjacent node, before taking the mesh offline.",E:{crash:2,cut:2,intercept:1}},{mi:"fe42::92ff::4704",width:10,se:22,m:2,oj:"Try your skills against a Gilgamesh test mesh.",E:{crash:5,cut:5}},{mi:"a72e::ee13::bc05",width:15,se:12,minumum:2,oj:"Cause some trouble, offline one of the beta meshes.",E:{crash:5,cut:5}},{mi:"b5d1::11e8::9606",width:15,se:22,oj:"Create a distraction, offline a small demo meshes.",E:{crash:5,cut:5}},{mi:"2be9::462b::9407",width:20,se:30,data:4,oj:"With the Gilgamesh security team distracted, intercept the stashed data then offline the mesh.",E:{crash:5,cut:5,intercept:1},lines:["enmeshed-v2.zip saved to ~/Downloads","&P&Tunzip ~/Downloads/enmeshed-v2.zip"," extracting: gilgamesh-plugin-Rate.Limit.bin"," extracting: gilgamesh-plugin-Buf.Overflow.bin"," extracting: gilgamesh-plugin-Conf.Rewrite.bin"," extracting: gilgamesh-plugin-Mine.bin"]},{mi:"[::1]/practice/8",width:5,se:63,m:1,mt:1,oj:"Practice using slows to offline a mesh.",E:{slow:5}},{mi:"[::1]/practice/9",width:10,se:62,oj:"Practice using corrupts to offline a mesh.",E:{corrupt:2}},{mi:"[::1]/practice/a",width:10,se:72,oj:"Practice using reroutes to offline a mesh.",E:{reroute:5}},{mi:"backup.gilgamesh.network",width:25,se:2,oj:"It begins. Offline the backup mesh.",E:{crash:5,cut:5,slow:5,corrupt:5,reroute:5}},{mi:"compute.gilgamesh.network",width:25,se:6,oj:"Exploit the compute mesh to mine 1.000 MeshCoin before offlining it.",mine:1e3,E:{crash:5,cut:5,slow:5,corrupt:5,reroute:5,mine:5}},{mi:"daemon.gilgamesh.network",width:30,se:2,oj:"Offline the services mesh.",E:{crash:5,cut:5,slow:5,corrupt:5,reroute:5}},{mi:"edge.gilgamesh.network",width:40,se:2,oj:"Offline the periphery mesh.",E:{crash:5,cut:5,slow:5,corrupt:5,reroute:5}},{mi:"final.gilgamesh.network",width:55,height:35,se:1,oj:"Offline the final mesh, then consider yourself a winner!",E:{crash:5,cut:5,slow:5,corrupt:5,reroute:5}}],t=window.localStorage,i=parseInt(t.getItem("stage")||0),h=parseInt(t.getItem("coins")||0),y=e=>'<span style="color:#'+e+'">',M=y("7fDB6A"),b=y("4B86B4"),v=y("4f9ED8"),E=y("AAA"),T='<u id="cursor"></u>',C='<span id="input"></span>',L=M+"mark@terminus</span>:"+v+"~</span>$ ",I='<span style="font-weight:700">'+b+"enmeshed</span>#</span> ",k=o("terminal"),S=o("screen");function P(e,t){e=e||"",e+=t?"":"\n",k.innerHTML+=e,u(k)}function H(e){let t=o(e);return!t||t.parentNode.removeChild(t)}function N(){H("input"),H("cursor")}let R,A=[],B=!0,D=Date.now();function O(){A.unshift(...m.split("\n"))}function j(e,t){let n=e.toLowerCase();if("1"===e||"story"===n){let e=w.split("\n");A.unshift(...e)}else if("2"===e||"challenge"===n)!function(){let e=s(234,35746);(R={mi:"[::1]/challenge/"+e.toString(16),width:s(10,60),height:s(10,35),se:e,E:{crash:s(4,10),cut:s(4,10),slow:s(4,10),corrupt:s(4,10),reroute:s(4,10),intercept:s(0,1),mine:s(0,1)}}).data=!!R.E.intercept,R.N=R.E.mine?s(25,250):0;let t=["Offline the mesh"];R.data&&t.unshift("Intercept data from the firewalled Node"),R.N&&t.unshift("Mine $ "+(R.N/1e3).toFixed(3)+" meshcoins"),R.oj=t.join(", ")+"."}(),A.unshift("&H");else{if("3"!==e&&"continue"!==n||!i)return!1;A.unshift("&G"+i)}return t(),!0}f((function(u){if(A.length){let p,m=A.shift(),g=25+s(0,35),w=!1,v=!1,H=!1,F=!1,U="";h&&(U=("$ "+(h/1e3).toFixed(3)+" meshcoins").padStart(60," ")),N(),m=m.replace(/&DT/,new Date).replace(/&DP/,new Date(Date.now()-101823e3)).replace(/&DE/,new Date(Date.now()-612e4).toUTCString()).replace(/&IP/,d).replace(/&\$/,U).replace(/&R(\d+)(.*?)$/,(function(e,t,n){return n.repeat(parseInt(t))})).replace(/^\?(\d+)/,(function(e,t){return g=parseInt(t),""})).replace(/&I/,(function(){return w=!0,""})).replace(/!!/,T).replace(/&P/,L).replace(/&G(\d+)/,(function(t,n){return n=parseInt(n),P(),P(L,!0),v="gilgamesh mesh://"+e[n].mi,A.unshift("&CMesh Visualizer Initialized, press &BENTER&b to connect.","&g"+n),""})).replace(/&g(\d+)/,(function(n,s){return F=!0,function(n,s){let r=e[n];a(k),l(S);let o=new x(r,(function(){l(k),a(S),o.quit?O():o.failed?n<e.length&&A.unshift("&G"+n):(h+=o.N,n++,t.setItem("stage",n),t.setItem("coins",h),i=n,n<e.length&&A.unshift("&G"+n),r.Ls&&A.unshift(...r.Ls)),s()}))}(s,u),""})).replace(/&H(.*)/,(function(e,t){return P(L,!0),v="gilgamesh --challenge"+(t||""),A.unshift("&h"),""})).replace(/&h/,(function(){return F=!0,function(e){a(k),l(S);let n=new x(R,(function(){l(k),a(S),n.quit||n.failed||(h+=n.N,t.setItem("coins",h)),n.failed?A.unshift("&H --retry"):O(),e()}))}(u),""})).replace(/&T(.*)$/,(function(e,t){return v=t,""})).replace(/&K/,(function(){return B=!B,""})).replace(/&L/,(function(){return k.innerHTML="",""})).replace(/&O/,(function(){return i&&i<e.length&&A.unshift(" 3) Continue",""),""})).replace(/&Y/,(function(){let e=o("decryptor"),t=o("email"),s=o("attachment");return c(e,"spinner"),e.innerHTML="done.",t.innerHTML=n(t.textContent,!0).replace(/&/g,"<br>").replace(/\s/g,"&nbsp;"),r(t,"decrypt"),s.innerHTML="enmeshed.zip (13 KB)",r(s,"decrypt"),""})).replace(/&y/,(function(){return c(o("email"),"decrypt"),c(o("attachment"),"decrypt"),""})).replace(/&F/,(function(){let t=e.map((function(e){return"  mesh://"+e.mi+" - "+e.oj})),n=t.shift();return A.unshift(...t),n})).replace(/&N/,(function(){return P(),""})).replace(/&m/,y("d896ff")+"[mail]</span>").replace(/&B(.*?)&b/,'<span style="font-weight:700;color:#4B86B4">$1</span>').replace(/^&V(.*)$/,E+"$1</span>").replace(/^&C(.*)$/,(function(e,t){return H=!0,t||"Press &BENTER&b to continue..."})),B&&"<"!==m[0]&&(m=m.replace(/^([^ :]+):/,b+"$1</span>:"),m=M+"[ "+((Date.now()-D)/1e3+s(0,1e3)/1e5).toFixed(6).padStart(10," ")+"] </span>"+m),P(m,w||v||H),v?(P(T,!0),v=v.split(""),f((function(e,t){if(0===t)return e(500);if(N(),v.length){let t=v.shift(),n=Math.max(t.charCodeAt(0)-20,35);P(t+T,!0),e(n)}else e(!1)}),(function(){P(),u(25)}))):w?(p="",P(I+C+T,!0),window.onkeydown=function(e){13===e.keyCode?(N(),P(p),j(p,u)?window.onkeydown=null:(p.length&&(P(p+": command not found"),p=""),P(I+C+T,!0))):8===e.keyCode||127===e.keyCode?p.length&&(p=p.substring(0,p.length-1),o("input").innerHTML=p):e.ctrlKey||e.altKey||1===e.key.length&&(p+=e.key,o("input").innerHTML=p)}):H?(P(T,!0),window.onkeydown=function(e){13===e.keyCode&&(window.onkeydown=null,u())}):F||u(g)}else k.innerHTML="",A=(p+m+g).split("\n"),u()}),(function(){P()}))}window.addEventListener("load",(function(){window.enmeshed=new v}),!1)</script><div class=display><div id=screen class=h><div class=title>GILGAMESH NETWORK VISUALIZER</div><div class=mesh-id><div id=spinner class=spinner>᚛</div>mesh://<span id=mesh-id></span></div><div class=health>Network Health: <span id=health>100%</span></div><div id=to><div data-tool=info>ⓘ<div id=info-use></div></div><div data-tool=crash>⍉<div id=crash-use></div></div><div data-tool=cut>⟛<div id=cut-use></div></div><div data-tool=slow>⇝<div id=slow-use></div></div><div data-tool=corrupt>⨂<div id=corrupt-use></div></div><div data-tool=reroute>↬<div id=reroute-use></div></div><div data-tool=intercept>⤞<div id=intercept-use></div></div><div data-tool=mine>⋇<div id=mine-use></div></div></div><svg id=mesh></svg><div id=coins></div><div id=data></div><pre id=info></pre><pre id=console></pre><div id=retry><span id=retry-text></span>↻</div><div id=quit><span id=quit-text></span>⇏</div></div><pre id=terminal></pre><pre id=crash class=h></pre><div id=o class=h><div id=ob>OFFLINE</div><div id=continue></div></div><div class=brand>MarkBook Pro</div></div><div class=base></div></html>