<!doctype html><meta content="width=device-width" name=viewport><style>body,html{width:100%;height:100%;margin:0;padding:0;font-family:Helvetica Neue,Helvetica,Arial,sans-serif;background-color:#050f18}body{display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr auto 1fr;grid-template-areas:". . ." ". main ." ". . ."}canvas{background:#fbe58c;outline:1px solid #000;margin:0 auto;grid-area:main;background-color:#fff}.text-overlay{grid-area:main;align-self:center;justify-self:center;z-index:1;width:auto;max-width:80%;height:auto;padding:30px;background-color:#fbd649;color:#323251}.text-overlay.hidden{display:none}.text-overlay h2{font-size:34px;margin-top:0}.text-overlay p{line-height:1.4em}.text-overlay .right{text-align:right}.text-overlay .center{text-align:center}.text-overlay button{background-color:#e57388;border:0 none;width:44px;height:22px;padding:0;line-height:22px}.text-overlay :last-child{margin-bottom:0}</style><body><script>"use strict";!function(){function t(t){return t*n.size.wc}function i(t){return t*n.size.$a}function h(t,i,h){return t=Math.random()*(i-t+1)+t,h&&(t=Math.floor(t)),t}function s(t){t||(t=class{});return class extends t{set(t){return Object.assign(this,t)}}}function e(t){t||(t=class{});return class extends t{constructor(){super(),this.M={}}N(t,i){t in this.M||(this.M[t]=[]),this.M[t].push(i)}W(t,i){t in this.M&&(i?0>(i=this.M[t].indexOf(i))||this.M[t].splice(i,1):this.M[t].splice(0,this.M[t].length))}uc(){for(let t in this.M)this.M[t].splice(0,this.M[t].length)}la(t,i){t in this.M&&this.M[t].map((t=>t(i)))}}}function a(t){t||(t=class{});return class extends t{constructor(){super(),this.Vb=!0}}}const n={size:{wc:3,$a:90},speed:{Rc:21,max:300,acceleration:1650},A:{ia:{0:"#fbe58c",1:"#876701"},Za:{0:"rgba(0,0,0,0)",1:"#060f19",2:"#183c66",3:"#04b7e9"},F:{0:"rgba(0,0,0,0)",1:"#000",2:"rgba(0,0,0,0)"},Z:{0:"rgba(0,0,0,0)",1:"#000",2:"#00b1e3"},aa:{0:"rgba(0,0,0,0)",1:"#000",2:"#0c923d"},ba:{0:"rgba(0,0,0,0)",1:"#000",2:"#bc2a01"},L:{0:"#876701",1:"#fbd649",2:"#fff"},oa:{0:"rgba(0,0,0,0)",1:"rgba(229,115,136,255)",2:"rgba(0,177,227,255)",3:"rgba(0,134,201,255)"},zb:{0:"rgba(0,0,0,0)",1:"rgba(0,134,201,255)",2:"rgba(0,177,227,255)",3:"rgba(2,136,209,255)",4:"rgba(249,168,37,255)",5:"rgba(251,192,45,255)",6:"rgba(48,63,159,255)",7:"rgba(255,255,255,255)",8:"rgba(255,202,40,255)",9:"rgba(3,169,244,255)",a:"rgba(2,119,189,255)",b:"rgba(63,81,181,255)",c:"rgba(255,183,77,255)",d:"rgba(255,204,128,255)",e:"rgba(245,127,23,255)",f:"rgba(77,208,225,255)",g:"rgba(128,222,234,255)",h:"rgba(0,172,193,255)"}}};class r extends(s()){constructor(){super(),this.color="#999",this.opacity=1}}class o{constructor(){this.height=this.width=1,this.Rb=!0,this.Ca=null,this.node=this.Mb(),this.G=this.node.getContext("2d")}Ra(t,i,h=!0){return this.node.width=this.node.style.width=this.width=t,this.node.height=this.node.style.height=this.height=i,h&&this.fc(),this}fc(){var t=window.devicePixelRatio||1,i=this.G.Vc||this.G.Sc||this.G.Tc||this.G.Uc||this.G.Pc||1;if(t!==i){t/=i,i=this.node.width;var h=this.node.height;this.node.width=i*t,this.node.height=h*t,this.node.style.width=i+"px",this.node.style.height=h+"px",this.G.scale(t,t)}}Qb(){document.body.appendChild(this.node)}Qa(t){this.Ca=t}C(){this.Rb&&this.clear(),this.G.save(),this.Ca.C(this.G),this.G.restore()}clear(){return this.G.clearRect(0,0,this.G.canvas.width,this.G.canvas.height),this}ic(){return this.G.getImageData(0,0,this.width,this.height).data}Mb(){let t=document.createElement("canvas");return t.width=this.width,t.height=this.height,t}}class c{static cache(t){const i=new c(t);i.ec();const h=i.padding;return t.C=function(t){t.drawImage(i.canvas.node,this.x-h.left,this.y-h.top)},t}constructor(t){this.H=t,this.Eb={x:0,y:0},this.canvas=new o,this.padding={top:0,bottom:0,left:0,right:0},this.Ba=Math.round(Math.min(50,1+Math.max(this.H.width,this.H.height)/10)),this.ga={top:!1,bottom:!1,left:!1,right:!1}}ec(){this.Cc();let t=0;this.xb({top:this.Ba,bottom:this.Ba,left:this.Ba,right:this.Ba});do{const{vc:t,Kc:i}=this.dc();if(this.Jc(i),this.Pb())break;this.xb(t)}while(20>=++t);this.Bc()}dc(){const t=this.hc(),i={},h={};return Object.keys(t).forEach((s=>{this.ga[s]||(0<t[s]?(i[s]=t[s],this.ga[s]=!0):h[s]=this.Ba)})),{vc:h,Kc:i}}Pb(){return Object.values(this.ga).every((t=>t))}hc(){const t=this.gc(),i={top:0,bottom:0,left:0,right:0},h=this.canvas.height,s=this.canvas.width;if(!this.ga.top)t:for(var e=0;e<h;e++){for(var a=0;a<s;a++)if(t[a+e*s])break t;i.top++}if(!this.ga.bottom)t:for(e=h-1;0<=e;e--){for(a=0;a<s;a++)if(t[a+e*s])break t;i.bottom++}if(!this.ga.left)t:for(e=0;e<s;e++){for(a=0;a<h;a++)if(t[e+a*s])break t;i.left++}if(!this.ga.right)t:for(e=s-1;0<=e;e--){for(a=0;a<h;a++)if(t[e+a*s])break t;i.right++}return i}gc(){const t=this.canvas.ic(),i=[];for(let h=3;h<t.length;h+=4)i.push(0!==t[h]);return i}xb(t){"number"==typeof t&&(t={top:t,bottom:t,left:t,right:t}),t=Object.assign({top:0,bottom:0,left:0,right:0},t),this.padding.top+=t.top,this.padding.bottom+=t.bottom,this.padding.left+=t.left,this.padding.right+=t.right,this.Db()}Jc(t){"number"==typeof t&&(t={top:t,bottom:t,left:t,right:t}),t=Object.assign({top:0,bottom:0,left:0,right:0},t),this.padding.top=Math.max(0,this.padding.top-t.top),this.padding.bottom=Math.max(0,this.padding.bottom-t.bottom),this.padding.left=Math.max(0,this.padding.left-t.left),this.padding.right=Math.max(0,this.padding.right-t.right),this.Db()}Db(){this.H.set({x:this.padding.left,y:this.padding.top}),this.canvas.clear().Ra(this.H.width+this.padding.left+this.padding.right,this.H.height+this.padding.top+this.padding.bottom,!1),this.H.C(this.canvas.G)}Cc(){this.Eb={x:this.H.x,y:this.H.y}}Bc(){this.H.set(this.Eb)}}class l{constructor(t,i){this.ja=t,this.target=i}pb(){this.target.y=this.ja.y+this.ja.height-this.target.height}Ub(){this.target.y=Math.round(this.ja.y+this.ja.height/2-this.target.height/2)}Tb(){this.target.x=Math.round(this.ja.x+this.ja.width/2-this.target.width/2)}U(){return this.Ub(),this.Tb(),this.target}}class d extends(s()){constructor(){super(),this.y=this.x=0,this.height=this.width=1,this.style=new r,this.parent=null}C(){}ma(){return{left:this.x,right:this.x+this.width,top:this.y,bottom:this.y+this.height}}oc(t){const i=this.ma();return t=t.ma(),i.left<t.right&&i.right>t.left&&i.top<t.bottom&&i.bottom>t.top}D(t){return t.J(this),this}da(t){return this.style.set(t),this}cache(){return c.cache(this),this}zc(t){let i=this.parent,h={x:this.x,y:this.y};for(;null!==i&&t!==i;)h.x+=i.x,h.y+=i.y,i=i.parent;return h}qb(t){let i=this.U;return t=t.U,Math.sqrt(Math.pow(i.x-t.x,2)+Math.pow(i.y-t.y,2))}fa(t){return new l(t,this)}get U(){return{x:this.x+this.width/2,y:this.y+this.height/2}}}const g={a:9938118,b:7642407,c:6587686,d:7644455,e:7375911,f:1084455,g:14988334,h:9747753,i:1082401,j:2265223,k:5409957,l:7373857,m:18405233,n:9745769,o:6595878,p:1088807,q:12789030,r:9739559,s:7608366,t:2164807,u:6595881,v:2270505,w:10835633,x:5408933,y:2164901,z:15763599,0:2266274,1:2164834,2:7380099,3:7478407,4:4332705,5:3284007,6:7511079,7:2164871,8:7511207,9:7478439,"!":1049633,"?":2099331,".":1048576,"+":72768,"-":7168,"/":1083524,"*":5189,"%":26808627,$:7674030,":":32800,"#":11512810,"(":2130978,")":1116225," ":0,"<":4260932,">":1118273,"[":3179555,"]":3213379,"@":31123020,"'":1};class b extends d{constructor(){super(),this.fontSize=Math.round(t(.66)),this.text="a",this.style.color="#000"}Da(t){return this.fontSize=Math.max(1,t),this.width=this.sb(),this.height=5*this.fontSize,this}T(t){return this.text=t,this.width=this.sb(),this.height=5*this.fontSize,this}C(t){t.fillStyle=this.style.color,t.globalAlpha=this.style.opacity;const i=this.fontSize,h=this.fontSize;let s=Math.ceil(this.x);for(let a=0;a<this.text.length;a++){const n=g[this.text.charAt(a).toLowerCase()];if(null!=n){for(var e=0;5>e;e++)for(let a=0;5>a;a++)n&1<<5*e+a&&t.fillRect(s+a*i,this.y+e*h,i,h);for(s+=6*i,e=17318416;(~n&e)==e&&1082401<e;)s-=i,e>>>=1}}return this}sb(){const t=this.fontSize;let i=0;for(let h=0;h<this.text.length;h++){const s=g[this.text.charAt(h).toLowerCase()];if(null==s)continue;i+=6*t;let e=17318416;for(;(~s&e)==e&&1082401<e;)i-=t,e>>>=1}return i-this.fontSize}}const p={};class u{constructor(t){this.Ma=t,this.Na=987654321-t,this.fb=4294967295,this.next()}next(){return this.Na=36969*(65535&this.Na)+(this.Na>>16)&this.fb,this.Ma=18e3*(65535&this.Ma)+(this.Ma>>16)&this.fb,((this.Na<<16)+this.Ma&this.fb)/4294967296+.5}Cb(t){return t=this.next()*(t-0+1),Math.floor(t)}static set(t,i){p.hasOwnProperty(t)&&delete p[t],p[t]=new u(i)}static get(t){return p[t]}}class y{constructor(){this.ka=0,this.play=!1,this.cb=this.timestamp(),this.Jb=()=>{}}start(t){return this.play=!0,this.Jb=t,this.cb=this.timestamp(),this.Bb()}stop(){this.play=!1}lb(t){this.Jb(t),this.play&&this.Bb()}timestamp(){return window.performance.now()}Bb(){return window.requestAnimationFrame((()=>{if(this.play){var t=this.timestamp(),i=t-this.cb;this.ka=i=999<i?1/60:i/1e3,this.cb=t,this.lb(i)}}))}}class w extends d{constructor(){super(),this.children=[]}J(t){if(Array.isArray(t))t.forEach((t=>this.J(t)));else if(!this.children.includes(t))return t.parent=this,this.children.push(t),this}removeChild(t){return!!this.children.includes(t)&&(this.children.splice(this.children.indexOf(t),1),!0)}C(t){this.Xa(t)}Xa(t){t.save(),t.translate(this.x,this.y),this.children.forEach((i=>{t.save(),i.C(t),t.restore()})),t.restore()}get nc(){return{x:0,y:0,width:this.width,height:this.height}}}class f extends d{C(t){return t.fillStyle=this.style.color,t.globalAlpha=this.style.opacity,t.fillRect(this.x,this.y,this.width,this.height),this}}class x extends(s()){constructor(){super(),this.height=this.width=0,this.map=[]}jc(){return{width:this.ha(this.width),height:this.ha(this.height)}}B(){let{width:t,height:i}=this.jc(),h=(new d).set({width:t,height:i});return h.C=t=>{this.map.forEach(((i,s)=>{t.fillStyle=i,t.fillRect(h.x+this.ha(Math.floor(s%this.width)),h.y+this.ha(Math.floor(s/this.width)),this.ha(1),this.ha(1))}))},h}Mc(){const t=this.B(),i=new o;return i.Ra(t.width,t.height,!1),t.C(i.G),i}Nc(t){const i=this.Mc(),h=new d;h.set({width:i.width,height:i.height}),t.width&&h.set({width:t.width}),t.height&&h.set({height:t.height});const s=(new o).Ra(h.width,h.height,!1);return t=s.G.createPattern(i.node,"repeat"),s.G.fillStyle=t,s.G.fillRect(0,0,h.width,h.height),h.C=function(t){t.drawImage(s.node,this.x,this.y)},h}ha(t){return t}static load(t,i,h=0){const s=[];t=t.trim(),0===h&&(h=0<(h=t.indexOf("\n"))?h:t.length);for(let h of t)"\n"!==h&&s.push(i[h]);return(new this).set({map:s,width:h,height:Math.ceil(s.length/h)})}}class m extends x{ha(i){return t(i)}}const v=new class{constructor(){this.right=this.left=this.ua=this.Fa=!1,this.na=[],this.ob={Fa:[38,90,87],ua:[40,83],left:[37,65,81],right:[39,68]},this.Ua()}N(t,i){this.na.unshift({keys:t,sa:i})}W(t,i=null){this.na=this.na.filter((h=>!!(h.keys.sort().toString()!=t.sort().toString()||i&&h.sa!==i)))}Fb(t,i){for(let h in this.ob)if(this.ob[h].includes(t)){this[h]=i;break}i&&this.Oc(t)}Oc(t){if(this.na.length){var i=[];this.na=this.na.filter((h=>!h.keys.includes(t)||(i.push(h.sa),!1))),i.forEach((t=>t.call()))}}Ua(){window.addEventListener("keydown",(t=>this.Fb(t.keyCode,!0))),window.addEventListener("keyup",(t=>this.Fb(t.keyCode,!1))),window.addEventListener("blur",(()=>this.Fa=this.ua=this.left=this.right=!1))}};v.Kb=32,x={0:"\n000000000\n000000000\n000000000\n000222000\n000212000\n000222000\n000000000\n000000000\n000000000",t:"\n022222220\n021111120\n022212220\n021111120\n022212220\n000212000\n000212000\n000212000\n000222000",l:"\n002220000\n002120000\n222122000\n211112200\n222121220\n002122122\n002122212\n002120212\n002220222",i:"\n000002220\n000222120\n000211120\n022222120\n021221220\n021212220\n021122120\n021222120\n022202220",y:"\n000022220\n000221120\n002212120\n002122120\n002221120\n002212120\n022122120\n021222120\n022202220",a:"\n000222000\n002212200\n222111222\n211212112\n221212122\n022212220\n002121200\n002212200\n000222000",p:"\n022222200\n021111220\n022122120\n021111220\n022122200\n002120000\n002120000\n002120000\n002220000",n:"\n000002220\n000222120\n000211120\n022222120\n021222220\n021122220\n021212120\n021221120\n022222220"};const A={normal:{0:m.load(x[0],n.A.F).B().cache(),t:m.load(x.t,n.A.F).B().cache(),l:m.load(x.l,n.A.F).B().cache(),i:m.load(x.i,n.A.F).B().cache(),y:m.load(x.y,n.A.F).B().cache(),a:m.load(x.a,n.A.F).B().cache(),p:m.load(x.p,n.A.F).B().cache(),n:m.load(x.n,n.A.F).B().cache()},glowing:{0:m.load(x[0],n.A.Z).B().cache(),t:m.load(x.t,n.A.Z).B().cache(),l:m.load(x.l,n.A.Z).B().cache(),i:m.load(x.i,n.A.Z).B().cache(),y:m.load(x.y,n.A.Z).B().cache(),a:m.load(x.a,n.A.Z).B().cache(),p:m.load(x.p,n.A.Z).B().cache(),n:m.load(x.n,n.A.Z).B().cache()},correct:{0:m.load(x[0],n.A.aa).B().cache(),t:m.load(x.t,n.A.aa).B().cache(),l:m.load(x.l,n.A.aa).B().cache(),i:m.load(x.i,n.A.aa).B().cache(),y:m.load(x.y,n.A.aa).B().cache(),a:m.load(x.a,n.A.aa).B().cache(),p:m.load(x.p,n.A.aa).B().cache(),n:m.load(x.n,n.A.aa).B().cache()},incorrect:{0:m.load(x[0],n.A.ba).B().cache(),t:m.load(x.t,n.A.ba).B().cache(),l:m.load(x.l,n.A.ba).B().cache(),i:m.load(x.i,n.A.ba).B().cache(),y:m.load(x.y,n.A.ba).B().cache(),a:m.load(x.a,n.A.ba).B().cache(),p:m.load(x.p,n.A.ba).B().cache(),n:m.load(x.n,n.A.ba).B().cache()}};class M extends d{constructor(){super(),this.R="0",this.format="normal",this.width=A[this.format][this.R].width,this.height=A[this.format][this.R].height}C(t){const i=A[this.format][this.R];i.x=this.x,i.y=this.y,t.globalAlpha=this.style.opacity,i.C(t)}}class C extends(e()){}const B={V:new C,za:!1,ra:"",X:"",va:!1,Ja:!1,tb:!1};let k=[];class D extends(e(w)){constructor(){super(),this.padding={wa:t(5),vertical:t(3)},this.margin={wa:t(7),vertical:t(15)},this.background=(new f).set({x:-1*this.padding.wa,y:-1*this.padding.vertical}).da({color:"#fff"}),this.J(this.background),this.text=new b,this.J(this.text),this.Ha=(new b).Da(t(.56)).T("[space] to continue").da({color:"#999"}),this.J(this.Ha),this.F=!1,this.wb=[v.Kb],this.nb=!1}Dc(t){return this.Sb=t,this}T(t){return this.text.T(t),this}Gb(t){return t?(this.F=[],t.forEach((t=>{const i=new M;i.R=t,this.F.push(i),this.J(i)})),this):(this.F&&(this.F.forEach((t=>this.removeChild(t))),this.F=!1),this)}Ob(){var i=Math.max(this.text.width,this.Ha.width),h=this.text.height+this.padding.vertical+this.Ha.height+(this.F?this.F[0].height+this.padding.vertical:0);if(this.set({x:Math.round(B.canvas.width-this.margin.wa-this.padding.wa-i),y:Math.round(B.canvas.height-this.margin.vertical-this.padding.vertical-h)}),this.background.set({width:i+2*this.padding.wa,height:h+2*this.padding.vertical}),i=this.text.height+this.padding.vertical,this.F){for(h=0;h<this.F.length;h++)this.F[h].set({y:i}),this.F[h].x+=t(1)*h+this.F[h].width*h;i+=this.F[0].height+this.padding.vertical}this.Ha.set({y:i})}show(){this.Ob(),B.level.P.J(this),this.Lb();let t=Math.round(B.canvas.height-this.margin.vertical-this.background.height);return k.forEach((i=>{i.y=Math.round(t-i.background.height),t-=i.background.height+this.padding.vertical})),k.unshift(this),this}ab(){B.level.P.removeChild(this),k.splice(k.indexOf(this),1),this.la("hide.instant",this),setTimeout((()=>{this.la("hide",this)}),250)}Lb(){let t=()=>{v.W(this.wb,t),clearTimeout(this.nb),this.ab()};v.N(this.wb,t),this.Sb&&(this.nb=setTimeout(t,5e3))}static display(t,i=!1){return(new D).T(t).Dc(i).show()}static Va(){k.forEach((t=>t.ab()))}}class S{constructor(i,s){this.x=i,this.y=s,this.size=t(1),this.speed=h(120,240)}update(t){this.y+=t*this.speed}}class T extends d{constructor(){super(),this.level=this.height=this.width=0,this.Sa=!1,this.vb=10,this.sc=2e3,this.Aa=this.vb,this.Oa=[],this.Lc=360}xa(){let t=this.Aa;for(;t--;)this.mb();return this}jb(t){this.level=t,t=this.vb,this.Aa=t+this.level*(this.sc-t)}ub(){this.Sa=1}C(t){if(!1!==this.Sa){var i=this.level+.005;i>=this.Sa&&(this.Sa=!1,setTimeout((()=>B.V.la("storm.target.reached")),250)),this.jb(i)}for(;this.Oa.length<this.Aa;)this.mb();for(t.fillStyle="#fad170",t.globalAlpha=this.level,t.globalCompositeOperation="color",t.fillRect(0,0,this.width,this.height),t.globalCompositeOperation="source-over",t.fillRect(0,0,this.width,this.height),t.fillStyle="#876701",t.globalAlpha=1,t.globalCompositeOperation="source-over",i=this.Oa.length;i--;){const s=this.Oa[i];s.y>=this.height?(s.y=-s.size+s.y%this.height,s.x=h(0,this.width,!0)):s.y<-2*s.size&&(s.y=this.height+s.y%this.height),s.x<-1*s.size?s.x+=this.width+s.size:s.x>this.width&&(s.x-=this.width+s.size),t.fillRect(s.x,s.y,s.size,s.size),s.update(B.loop.ka),s.x+=B.level.view.I.x+B.loop.ka*this.Lc,s.y+=B.level.view.I.y}}mb(){this.Oa.push(new S(h(0,this.width,!0),h(0,this.height,!0)))}}class R extends d{constructor(){super(),this.height=this.width=0,this.direction="in",this.sa=()=>{},this.speed=1.5}setDirection(t){return this.direction=t,this.style.opacity="out"==this.direction?0:1,this}done(){setTimeout((()=>this.sa(this)),1)}remove(){return this.parent.removeChild(this),this}C(t){"out"==this.direction?1>this.style.opacity&&(this.style.opacity=Math.min(1,this.style.opacity+B.loop.ka*this.speed),1<=this.style.opacity&&this.done()):0<this.style.opacity&&(this.style.opacity=Math.max(0,this.style.opacity-B.loop.ka*this.speed),0>=this.style.opacity&&this.done()),t.fillStyle=n.A.ia[0],t.globalAlpha=this.style.opacity,t.fillRect(0,0,B.canvas.width,B.canvas.height)}then(t){return this.sa=t,this}Hb(){return this.speed=.5,this}static gb(){return(new R).setDirection("out")}static bb(){return(new R).setDirection("in")}}class F extends w{constructor(){super(),this.target=null,this.K={left:0,right:1,top:0,bottom:1},this.I={x:0,y:0}}J(t){super.J(t)}C(t){return this.tc(),super.C(t)}tc(){const t=this.target.zc(this),i=this.children[0];this.I.x=this.I.y=0,this.target.width<this.K.right-this.K.left?t.x<this.K.left?(this.I.x=this.K.left-t.x,i.x+=this.I.x):t.x+this.target.width>this.K.right&&(this.I.x=-1*(t.x+this.target.width-this.K.right),i.x+=this.I.x):(this.I.x=this.K.left-t.x,i.x+=this.I.x),this.target.height<this.K.bottom-this.K.top?t.y<this.K.top?(this.I.y=this.K.top-t.y,i.y+=this.I.y):t.y+this.target.height>this.K.bottom&&(this.I.y=-1*(t.y+this.target.height-this.K.bottom),i.y+=this.I.y):(this.I.y=this.K.top-t.y,i.y+=this.I.y)}}const z=1/Math.sqrt(2),O={front:m.load("\n000000000000200000002200000000\n000000000000222222222200000000\n000000000000222ccccc2200000000\n00000000000022ccdddcc200000000\n0000000000002c5555555200000000\n000000000000ee5fg55g5e00000000\n00000000000eee4fh44h5e00000000\n0000000000022c4444444200000000\n00000000000221ccdddc1220000000\n000000000022221cccc11220000000\n000000000022221111111220000000\n000000000022222222222222000000\n000000000222222222222222000000\n000000000222222222222222000000\n000000022222222222222222000000\n000000022222222222222222200000\n000005522222222222222222250000\n000000555522222222222222555000\n000000055555222222222225550000\n000000022255555555555555200000\n000000222222222222222222200000\n000000222222222222222222200000\n000002222222222222222222200000\n000002222222222222222222200000\n000002222222222222222222220000\n000022222222222222222222220000\n000022222222222212212222210000\n000222212221222112112221211000\n000222112211122112111221211000\n000222112211121112555555555000\n005555112211125555225221122000\n005222555555551111255521552000\n005221152111155155555555555000\n005255555555225112551255112500\n055225112511155512151251112500\n052251515551151512555555555550\n052255515151255555555555555555\n055555555555555555222222222225\n055555555552222222222222555550\n555555555555500000120000000000\n000000000021200000110000000000\n000000000011100000210000000000\n000000000011000000100000000000\n000000000001000000000000000000\n",n.A.zb).B().cache()};class G extends d{constructor(){super(),this.width=O.front.width,this.height=O.front.height,this.La=this.eb=0,this.direction={x:"left",y:"down"}}setDirection(t){return t.x&&(this.direction.x=t.x),t.y&&(this.direction.y=t.y),this}C(t){this.eb=(this.eb+B.loop.ka/2)%2,this.La=Math.round(.1*Math.abs(this.eb-1)*this.height);let i=this.x,h=this.y-this.La;"left"==this.direction.x&&(t.scale(-1,1),i=-1*this.x-this.width);let s=O.front;s.x=i,s.y=h,s.C(t)}}class I extends(function(t){return t||(t=class{}),class extends t{constructor(){super(),this.direction={x:"",y:""},this.speed=0}move(t){t=this.speed*t*(this.direction.x&&this.direction.y?z:1),"left"==this.direction.x?this.x-=t:"right"==this.direction.x&&(this.x+=t),"up"==this.direction.y?this.y-=t:"down"==this.direction.y&&(this.y+=t)}Wb(t){const i={x:0,y:0};return t=t.ma(),"left"===this.direction.x?i.x=t.right-this.x:"right"===this.direction.x&&(i.x=-1*(this.x+this.width-t.left)),"up"===this.direction.y?i.y=t.bottom-this.y:"down"===this.direction.y&&(i.y=-1*(this.y+this.height-t.top)),0!==i.x&&0!==i.y&&(Math.abs(i.x)>Math.abs(i.y)?i.x=0:i.y=0),i}}}(w)){constructor(){super(),this.element=new G,this.J(this.element),this.width=this.element.width,this.height=t(3),this.element.fa(this.nc).pb(),this.element.y-=t(1)}C(i){this.element.setDirection(this.direction),i.fillStyle="rgba(0, 0, 0, 0.05)";const h=9<this.element.La?3:this.element.La/3,s=t(1);i.fillRect(this.x+s+3*h,this.y-2*s+h,this.width-2*s-6*h,this.height+4*s-2*h),i.fillRect(this.x+3*h,this.y-s+h,this.width-6*h,this.height+2*s-2*h),i.fillRect(this.x-s+3*h,this.y+h,this.width+2*s-6*h,this.height-2*h),super.C(i)}move(t){B.za||(v.left||v.right||v.Fa||v.ua?(this.speed+=n.speed.acceleration*t,this.speed=Math.min(this.speed,n.speed.max)):(this.speed*=Math.pow(.6,60*t),this.speed=.1>this.speed?0:this.speed),v.left?this.direction.x="left":v.right?this.direction.x="right":(v.Fa||v.ua)&&(this.direction.x=""),v.Fa?this.direction.y="up":v.ua?this.direction.y="down":(v.left||v.right)&&(this.direction.y=""),super.move(t))}}class L extends w{C(t){this.Xa(t)}Xa(t){t.save(),t.translate(this.x,this.y),this.children.sort(((t,i)=>t.y-i.y)).forEach((i=>{t.save(),i.C(t),t.restore()})),t.restore()}}const E=m.load("\n00000000000000000000000000\n00100000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000001000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000001000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000010000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000\n00000000000000000000000000",n.A.ia);class H extends d{C(t){E.Nc({height:this.height,width:this.width}).set({x:this.x,y:this.y}).C(t)}}const J={1:m.load("\n0000100\n0101200\n0210210\n2202122\n0303023\n0032032\n0002220\n0003300\n",n.A.oa).B().cache(),2:m.load("\n00300\n00230\n03220\n02220\n02220\n03223\n02322\n32232\n22222\n",n.A.oa).B().cache(),3:m.load("\n0001000000\n0002000000\n0002010000\n0002020001\n1000200012\n0200300020\n0300300030\n",n.A.oa).B().cache(),4:m.load("\n000030000\n003030003\n302020002\n200020302\n200020202\n003020200\n002000000\n",n.A.oa).B().cache(),5:m.load("\n000010000\n000120000\n100002010\n020202021\n020030020\n002300300\n000023000\n",n.A.oa).B().cache(),6:m.load("\n021\n120\n020\n021\n130\n030\n",n.A.oa).B().cache()};class K extends d{constructor(){super(),this.kind="1",this.width=J[this.kind].width,this.height=J[this.kind].height}C(t){const i=J[this.kind];i.x=this.x,i.y=this.y,t.globalAlpha=this.style.opacity,i.C(t)}Ec(t){return this.kind=t,this}}var N=m.load("\n0111111111111111110\n1122222222222222222\n1233333333333333332\n1233333333333333332\n1233333333333333332\n1233333333333333322\n0222222222222222220\n",{0:"rgba(0,0,0,0)",1:"rgba(182,178,179,255)",2:"rgba(210,208,209,255)",3:"rgba(255,255,255,255)"}).B().cache();class P extends f{constructor(){super(),this.width=N.width,this.height=N.height}C(t){N.x=this.x,N.y=this.y,N.C(t)}}class j extends(a(f)){constructor(){super(),this.width=i(1),this.height=i(1)}C(t){t.fillStyle=n.A.ia[1],t.globalAlpha=1,t.fillRect(this.x,this.y,this.width,this.height)}ma(){return{left:this.x-t(2),right:this.x+this.width+t(2),top:this.y-t(2),bottom:this.y+this.height+t(2)}}}var q=m.load("\n0000000111110000000\n0000011122222200000\n0000112333333330000\n0001123333333333000\n0011233333333333300\n0112333333333333330\n0123333333333333330\n1133333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233333333333333333\n1233434333333333333\n1235333433333333333\n1233453333343334333\n1233355004330354333\n6230350000500053303\n",{0:"rgba(0,0,0,0)",1:"rgba(182,178,179,255)",2:"rgba(210,208,209,255)",3:"rgba(255,255,255,255)",4:"rgba(0,177,227,255)",5:"rgba(0,134,201,255)",6:"rgba(255,213,79,255)"}).B().cache();class U extends w{constructor(){super(),this.width=q.width,this.height=q.height,this.S=new M,this.S.y=t(5),this.S.R="a",this.S.format="normal",this.S.fa(this).U(),this.J(this.S)}C(t){q.x=this.x,q.y=this.y,q.C(t),super.C(t)}}class V extends(a(w)){constructor(){super(),this.element=(new U).D(this),this.width=this.element.width,this.height=t(5),this.element.fa(this).pb(),this.status=this.Ia=!1}Fc(t){return this.element.S.R=t,this}Nb(){this.Ia||(this.Ia=!0,this.element.S.format="glowing",B.V.la("fusebox.activated",{R:this.element.S.R,Za:this}))}Ib(t){this.status=t,this.element.S.format=t}$b(){this.Ia&&(this.state=this.Ia=!1,this.element.S.format="normal")}}const W=m.load("\n000000000000000000000001100000000000000000000000\n000000000000000000000012210000000000000000000000\n000000000000000000000012210000000000000000000000\n000000000000000000000012210000000000000000000000\n000000000000000000000322223000000000000000000000\n000000000000000000000322223000000000000000000000\n000000000000000000000322223000000000000000000000\n000000000000000000003222222300000000000000000000\n000000000000000000003222222300000000000000000000\n000000000000000000003232232300000000000000000000\n000000000000000000032232232230000000000000000000\n000000000000000000032232232230000000000000000000\n000000000000000000322232232223000000000000000000\n000000000000000000322322223223000000000000000000\n000000000000000003222322223222300000000000000000\n000000000000000003222322223222300000000000000000\n000000000000000032222322223222230000000000000000\n000000000000000322223222222322223000000000000000\n000000000000000322223222222322223000000000000000\n000000000000003222223222222322222300000000000000\n000000000000004222232222222232222400000000000000\n000000000000045522232222222232225540000000000000\n000000000000035552232222222232255530000000000000\n000000000000322555422222222224555223000000000000\n000000000003222225455555555554522222300000000000\n000000000003222222355555555553222222300000000000\n000000000032222223222223322222322222230000000000\n000000000032222223222223322222322222230000000000\n000000000322222223222236632222322222223000000000\n000000000422222232222236632222232222224000000000\n000000004522222233222366663222332222225400000000\n000000032252222232322366663223232222252230000000\n000000035225222322233666666332223222522530000000\n000000322525522322223666666322223225525223000000\n000000355252252322236666666632223252252553000000\n000004525225224555446666666644555422522525400000\n000045552222521225466666666664522125222255540000\n700045555255248555466666666664555842552555540007\n070313555595212522a66bbbbbb66a225212595555313070\n07331135555223555236bbbbbbbb63255532255553113370\n000031135555325253bbbbbbbbbbbb352523555531130000\n000003113555455554bbbbbbbbbbbb455554555311300000\n000000111355455554bbb000000bbb455554553111000000\n00000003113455554bb0000000000bb45555431130000000\n000000003114555540000000000000045555411300000000\n000000000713555400000000000000004555317000000000\n000000000073333000000000000000000333370000000000\n000000000070000000000000000000000000070000000000\n",n.A.zb).B().cache();class X extends(a(w)){constructor(){super(),this.set({width:W.width,height:Math.round(W.height/2)}),W.y=-1*W.height,this.J(W)}ma(){return{left:this.x,right:this.x+this.width,top:this.y-this.height,bottom:this.y+t(1)}}get U(){return{x:this.x+this.width/2,y:this.y}}}let Y=!1;class Z{constructor(){this.width=i(30),this.height=i(30),this.H=(new L).set({width:i(this.width),height:i(this.height)}),Y||(Y=this.Xb()),Y.D(this.H),this.H.J(this.Zb()),this.H.J(this.Yb())}xc(t){const h=this.ca.ma();t.x=h.right+i(1),t.y=h.bottom+i(1),this.H.J(t)}Xb(){var t=i(7),h=i(2),s=i(2);for(t=(new w).set({x:-1*s,y:-1*t,width:this.width+2*s,height:this.height+t+h}),(new H).set({x:0,y:0,width:t.width,height:t.height}).D(t),h=Math.floor(Math.floor(this.width/n.size.$a)*Math.floor(this.height/n.size.$a)/2);h--;)s=1+h%6,(new K).Ec(s).set({x:B.Pa.Cb(t.width),y:B.Pa.Cb(t.height)}).D(t);return t.cache(),t}Zb(){const i=t(1);return[[0,0,this.width,i],[0,this.height-i,this.width,i],[0,0,i,this.height],[this.width-i,0,i,this.height]].map((t=>(new j).set({pc:!0,x:t[0],y:t[1],width:t[2],height:t[3]})))}Yb(){return this.ca=new X,this.ca.set({x:(this.width-this.ca.width)/2,y:this.height/2-this.ca.height}),B.ca=this.ca}yc(h){this.Y=[],this.Ga=[];for(let t in h){const s=h[t];this.Y.push((new V).Fc(t).set({x:i(s.x),y:i(s.y)}).D(this.H))}this.Y.forEach((i=>{this.Ga.push((new P).set({x:i.x,y:i.y+i.height+t(1)}).D(this.H))})),B.Y=this.Y,B.Ga=this.Ga}}class Q extends w{constructor(){super(),this.width=t(100),this.height=t(5),this.padding=t(1),this.ya=this.Ka=!1,this.Ta=this.Ea=0}C(i){if(this.Ka){var h=this.yb();i.fillStyle=n.A.L[0],i.fillRect(this.x,this.y,this.width,this.height),i.fillStyle=n.A.L[1],i.fillRect(this.x+this.padding,this.y+this.padding,this.width-2*this.padding,this.height-2*this.padding),i.fillStyle=n.A.L[2],i.fillRect(this.x+this.padding,this.y+this.padding,Math.floor((this.width-2*this.padding)*Math.round(100*h)/100/t(1))*t(1),this.height-2*this.padding),super.C(i)}}start(){return this.ya=this.Ka=!0,this}pause(){return this.ya=!1,this}stop(){return this.ya=this.Ka=!1,this.Ea=0,this}lb(t){this.ya&&(this.Ea+=t,this.Ea>=this.Ta&&(this.pause(),B.V.la("timer.timeout")))}yb(){return 0===this.Ta?0:this.Ea/this.Ta}Gc(t){this.Ta=t}}const $={1:{X:"til",timeout:60,ea:0,qa:.3,kb:m={t:{x:9,y:28},l:{x:26,y:24},i:{x:16,y:29},y:{x:4,y:2},a:{x:25,y:6},p:{x:2,y:20},n:{x:11,y:8}}},2:{X:"napy",timeout:60,ea:.3,qa:.6,kb:m},3:{X:"linyt",timeout:60,ea:.6,qa:.9,kb:m}};class _ extends(e(s())){constructor(t){super(),this.level=t,this.ta=new Z,this.O=new I,B.L=this.L=new Q,B.pa=this.pa=new T,this.ib=new w,this.view=new F,this.Ya=new w,this.P=new w,this.ea=0,this.qa=1,this.Wa=!1}qc(){const t=$[this.level];this.ea=t.ea,this.qa=t.qa,this.pa.jb(this.ea),this.L.Gc(t.timeout),this.ta.yc(t.kb),B.za=!0,B.va=!1,B.ra="",B.Ja=!1,B.X=t.X}start(){this.Ac(),this.qc(),this.Wa=B.loop,B.canvas.Qa(this.ib),this.Wa.start((t=>this.rc(t))),R.bb().D(this.P).then((t=>t.remove())),this.Ua();const t={1:["the signal is down. We need it back asap.","Be quick. a storm is coming your way."],2:["The storm is interfering with our signal!","the storm is getting worse. so be quick."],3:["The signal is failing.","Be careful."]}[this.level];return D.display(t[0]).N("hide",(i=>{i.W("hide"),i.T("activate these "+B.X.length+" stones in the right order:").Gb(B.X.split("")).show().N("hide",(i=>{i.W("hide"),i.T(t[1]).Gb(!1).show().N("hide.instant",(t=>{t.W("hide"),B.za=!1,this.L.start(),"1"==this.level&&D.display("(Move with arrow keys or wasd)",!0)}))}))})),this}stop(){this.stopped=!0,this.Wa.stop(),this.la("stop")}Ua(){B.V.N("fusebox.deactivateAll",(()=>{this.ta.Y.forEach((t=>t.Qc()))})),B.V.N("fusebox.activated",(t=>{const i=B.X[B.ra.length];if(void 0!==i){B.Ja=!0;var h=D.display("Activating...");setTimeout((()=>{h.ab(),setTimeout((()=>{B.Ja=!1,t.R!=i?(D.display("This does not seem right.",!0),t.Za.Ib("incorrect")):(B.ra+=t.R,t.Za.Ib("correct"),B.ra.length===B.X.length?(B.va=!0,D.display("signal is back online. head back to safety.",!0)):D.display("Stone activated.",!0))}),1)}),2e3)}})),B.V.N("timer.timeout",(()=>{B.za=!0,B.L.Ka=!1,B.V.N("storm.target.reached",(()=>{B.V.W("storm.target.reached"),D.Va(),D.display("The sand came so quickly ...").N("hide",(t=>{t.W("hide"),R.gb().D(this.P).then((()=>{this.stop(),setTimeout((()=>B.rb.hb(this.level)),10)}))}))})),B.pa.ub()}))}rc(t){this.stopped||(this.L.ya&&(this.L.lb(t),this.pa.jb(this.ea+this.L.yb()*(this.qa-this.ea))),this.O.move(t),this.cc(),this.ac(),this.bc(),B.canvas.C())}Ac(){this.view.set({width:B.canvas.width,height:B.canvas.height,target:this.O}).D(this.ib),this.Ya.set({x:Math.round(B.canvas.width/2-this.Ya.width/2),y:Math.round(B.canvas.height/2-this.Ya.height/2),width:B.canvas.width,height:B.canvas.height}).J(this.ta.H).D(this.view),this.P.set({x:0,y:0,width:B.canvas.width,height:B.canvas.height}).D(this.ib),this.pa.set({width:B.canvas.width,height:B.canvas.height}).xa().D(this.P),this.L.set({x:Math.round(B.canvas.width-this.L.width-t(7)),y:B.canvas.height-this.L.height-t(7)}).D(this.P),Object.assign(this.view.K,{left:Math.round(.2*this.view.width),right:Math.round(.8*this.view.width),top:Math.round(.5*this.view.height),bottom:Math.round(.8*this.view.height)}),this.ta.xc(this.O)}cc(){this.ta.H.children.forEach((t=>{t.Vb&&this.O.oc(t)&&(t.pc&&!B.tb&&(B.tb=!0,D.display("Do not go too far.",!0)),t=this.O.Wb(t),this.O.x+=t.x,this.O.y+=t.y)}))}ac(){if(!B.va&&!B.Ja){var i=t(25);B.Ga.forEach(((t,h)=>{this.O.qb(t)<i?B.Y[h].Nb():"incorrect"===B.Y[h].status&&B.Y[h].$b()}))}}bc(){B.va&&this.O.qb(B.ca)<t(25)&&(B.va=!1,B.za=!0,B.L.stop(),B.pa.ub(),D.Va(),D.display("Good job! await further instructions.").N("hide",(t=>{t.W("hide"),R.gb().D(this.P).then((()=>{this.stop(),setTimeout((()=>B.rb.hb(this.level+1)),10)}))})))}}(new class{constructor(){this.Ab={},this.level=this.Ca=this.canvas=null,B.rb=this}xa(){return this.mc(),this.kc(),this.lc(),this}start(){this.Hc().then((()=>this.hb(1)))}Hc(){const i=new w,h=(new f).set({width:this.canvas.width,height:this.canvas.height}).da({color:"#fff"}).D(i);B.level={P:i,view:{I:{x:0,y:0}}},(new T).set({width:this.canvas.width,height:this.canvas.height,Aa:100}).xa().D(i);const s=(new b).Da(t(6)).T("SAND").da({color:n.A.ia[0]}).D(i).fa(h).U();return(new b).Da(t(1)).T("a js13kGames entry by @hellosiyan").da({color:n.A.ia[0]}).D(i).fa(h).U().set({y:s.y+s.height+t(10)}),this.canvas.Qa(i),this.loop.start((()=>{this.canvas.C()})),new Promise((t=>{D.display("Press [space] to start").N("hide",(h=>{h.W("hide"),i.J(R.gb().then((()=>{this.loop.stop(),setTimeout((()=>t()),10)})))})),R.bb().Hb().D(i).then((t=>t.remove()))}))}Ic(){const i=new w,h=(new f).set({width:this.canvas.width,height:this.canvas.height}).da({color:"#fff"}).D(i);B.level={P:i,view:{I:{x:0,y:0}}},(new T).set({width:this.canvas.width,height:this.canvas.height,Aa:100}).xa().D(i);const s=(new b).Da(t(6)).T("SAND").da({color:n.A.ia[0]}).D(i).fa(h).U();s.y=Math.round(s.y+t(20)),[[1,"a js13kGames entry by @hellosiyan",s.height+t(10)],[1,"signal is back",t(-50)],[2,"The storm has passed",t(-40)],[1,"Thanks for playing",t(-11)]].forEach((e=>{(new b).Da(t(e[0])).T(e[1]).da({color:n.A.ia[0]}).D(i).fa(h).U().set({y:s.y+e[2]})})),this.canvas.Qa(i),R.bb().Hb().D(i).then((t=>t.remove())),this.loop.start((()=>{this.canvas.C()}))}hb(t){this.level&&this.level.stop(),D.Va(),B.V.uc(),4<=t?this.Ic():setTimeout((()=>{this.level=new _(t),B.level=this.level,setTimeout((()=>this.level.start()),10)}),10)}kc(){this.canvas=new o,this.canvas.Ra(800,600),this.Ca=(new w).set({width:this.canvas.width,height:this.canvas.height}),this.canvas.Qa(this.Ca),this.canvas.Qb(),B.canvas=this.canvas}lc(){this.loop=new y,B.loop=this.loop}mc(){this.Ab.Pa=new u(822505),B.Pa=this.Ab.Pa}}).xa().start()}()</script>