<!doctype html><title>Hell Inc. - js13kGames 2022</title><meta content="width=device-width" name=viewport><meta content=$ilp.uphold.com/WaPUQRJ97L4L name=monetization><style>*{margin:0;padding:0;color:#fff}body,html{height:100%;width:100%}[b],[m]{height:100%;display:flex;align-items:center;justify-content:center;background:#211}[c]{display:grid}[c]>*{grid-row:1;grid-column:1}[m]{flex-direction:column}button{background:#600;border:1px solid #fff;width:120px;height:50px;margin:20px}button:hover{background:#933}[n]{display:none}</style><div b><div c><div id=menu m><h1>Hell Inc.</h1><div><button id=tt>Tutorial</button><button id=pp>Play</button></div></div><canvas id=cg n></canvas><canvas id=cui n></canvas><canvas id=ct n></canvas></div></div><script>W={mdl:{},reset:e=>{W.canvas=e,W.objs=0,W.current={},W.next={},W.textures={},W.gl=e.getContext("webgl2"),W.gl.blendFunc(770,771),W.gl.activeTexture(33984),W.program=W.gl.createProgram(),W.gl.enable(2884),W.gl.shaderSource(t=W.gl.createShader(35633),"#version 300 es\nprecision highp float;in vec4 pos,col,uv,normal;uniform mat4 pv,eye,m,im;uniform vec4 bb;out vec4 v_pos,v_col,v_uv,v_normal;void main(){gl_Position=pv*(v_pos=bb.z>0.?m[3]+eye*(pos*bb):m*pos);v_col=col;v_uv=uv;v_normal=transpose(inverse(m))*normal;}"),W.gl.compileShader(t),W.gl.attachShader(W.program,t),W.gl.shaderSource(t=W.gl.createShader(35632),"#version 300 es\nprecision highp float;in vec4 v_pos,v_col,v_uv,v_normal;uniform vec3 light;uniform vec4 o;uniform sampler2D sampler;out vec4 c;void main(){c=mix(texture(sampler,v_uv.xy),v_col,o[3]);if(o[1]>0.){c=vec4(c.rgb*(dot(light,-normalize(o[0]>0.?vec3(v_normal.xyz):cross(dFdx(v_pos.xyz),dFdy(v_pos.xyz))))+o[2]),c.a);}\nif(c.a<0.1){discard;}}"),W.gl.compileShader(t),W.gl.attachShader(W.program,t),W.gl.linkProgram(W.program),W.gl.useProgram(W.program),W.gl.clearColor(1,1,1,1),W.clearColor=t=>W.gl.clearColor(...W.col(t)),W.clearColor("fff"),W.gl.enable(2929),W.light({y:-1}),W.camera({fov:30}),W.draw()},ss:(t,e,i,s,l=0,n,r,h,a,o,c,m,u)=>{t.n=t.n||"o"+W.objs++,t.size&&(t.w=t.h=t.d=t.size),t.t&&t.t.width&&!W.textures[t.t.id]&&(i=W.gl.createTexture(),W.gl.pixelStorei(37441,!0),W.gl.bindTexture(3553,i),W.gl.pixelStorei(37440,1),W.gl.texParameteri(3553,10240,9728),W.gl.texParameteri(3553,10241,9728),W.gl.texImage2D(3553,0,6408,6408,5121,t.t),W.gl.generateMipmap(3553),W.textures[t.t.id]=i),t.fov&&(W.projection=new DOMMatrix([1/Math.tan(t.fov*Math.PI/180)/(W.canvas.width/W.canvas.height),0,0,0,0,1/Math.tan(t.fov*Math.PI/180),0,0,0,0,-1001/999,-1,0,0,-2e3/999,0])),t={type:e,...W.current[t.n]=W.next[t.n]||{w:1,h:1,d:1,x:0,y:0,z:0,rx:0,ry:0,rz:0,b:"888",mode:4,mix:0},...t,f:0},W.mdl[t.type]?.vertices&&!W.mdl?.[t.type].verticesBuffer&&(W.gl.bindBuffer(34962,W.mdl[t.type].verticesBuffer=W.gl.createBuffer()),W.gl.bufferData(34962,new Float32Array(W.mdl[t.type].vertices),35044),W.mdl[t.type].normals)&&(W.gl.bindBuffer(34962,W.mdl[t.type].normalsBuffer=W.gl.createBuffer()),W.gl.bufferData(34962,new Float32Array(W.mdl[t.type].normals.flat()),35044)),W.mdl[t.type]?.uv&&!W.mdl[t.type].uvBuffer&&(W.gl.bindBuffer(34962,W.mdl[t.type].uvBuffer=W.gl.createBuffer()),W.gl.bufferData(34962,new Float32Array(W.mdl[t.type].uv),35044)),W.mdl[t.type]?.indices&&!W.mdl[t.type].indicesBuffer&&(W.gl.bindBuffer(34963,W.mdl[t.type].indicesBuffer=W.gl.createBuffer()),W.gl.bufferData(34963,new Uint16Array(W.mdl[t.type].indices),35044)),t.t?t.mix||(t.mix=0):t.mix=1,W.next[t.n]=t},draw:(t,e,i,s,l=[])=>{for(s in e=t-W.lastFrame,W.lastFrame=t,requestAnimationFrame(W.draw),W.gl.clear(16640),i=W.animation("camera"),W.v=i,W.gl.uniformMatrix4fv(W.gl.getUniformLocation(W.program,"eye"),!1,i.toFloat32Array()),i.invertSelf(),i.preMultiplySelf(W.projection),W.gl.uniformMatrix4fv(W.gl.getUniformLocation(W.program,"pv"),!1,i.toFloat32Array()),W.gl.uniform3f(W.gl.getUniformLocation(W.program,"light"),W.lerp("light","x"),W.lerp("light","y"),W.lerp("light","z")),W.next)W.next[s].t||1!=W.col(W.next[s].b)[3]?l.push(W.next[s]):W.rr(W.next[s],e);for(s in l.sort((t,e)=>W.dist(e)-W.dist(t)).sort(t=>"map"===t.g?-1:1),W.gl.enable(3042),l)W.rr(l[s],e);W.gl.disable(3042)},rr:(t,e,i)=>{t.t&&(W.gl.bindTexture(3553,W.textures[t.t.id]),W.gl.uniform1i(W.gl.getUniformLocation(W.program,"sampler"),0)),t.f<t.a&&(t.f+=e),t.a<t.f&&(t.f=t.a),W.next[t.n].m=W.animation(t.n),W.next[t.g]&&W.next[t.n].m.preMultiplySelf(W.next[t.g].M||W.next[t.g].m),W.gl.uniformMatrix4fv(W.gl.getUniformLocation(W.program,"m"),!1,(W.next[t.n].M||W.next[t.n].m).toFloat32Array()),W.gl.uniformMatrix4fv(W.gl.getUniformLocation(W.program,"im"),!1,new DOMMatrix(W.next[t.n].M||W.next[t.n].m).invertSelf().toFloat32Array()),["camera","light","group"].includes(t.type)||(W.gl.bindBuffer(34962,W.mdl[t.type].verticesBuffer),W.gl.vertexAttribPointer(i=W.gl.getAttribLocation(W.program,"pos"),3,5126,!1,0,0),W.gl.enableVertexAttribArray(i),W.mdl[t.type].uvBuffer&&(W.gl.bindBuffer(34962,W.mdl[t.type].uvBuffer),W.gl.vertexAttribPointer(i=W.gl.getAttribLocation(W.program,"uv"),2,5126,!1,0,0),W.gl.enableVertexAttribArray(i)),(t.s||W.mdl[t.type].customNormals)&&W.mdl[t.type].normalsBuffer&&(W.gl.bindBuffer(34962,W.mdl[t.type].normalsBuffer),W.gl.vertexAttribPointer(i=W.gl.getAttribLocation(W.program,"normal"),3,5126,!1,0,0),W.gl.enableVertexAttribArray(i)),W.gl.uniform4f(W.gl.getUniformLocation(W.program,"o"),t.s,(3<t.mode||3<W.gl[t.mode])&&!t.ns?1:0,W.ambientLight||.2,t.mix),W.gl.uniform4f(W.gl.getUniformLocation(W.program,"bb"),t.w,t.h,0,0),W.mdl[t.type].indicesBuffer&&W.gl.bindBuffer(34963,W.mdl[t.type].indicesBuffer),W.gl.vertexAttrib4fv(W.gl.getAttribLocation(W.program,"col"),W.col(t.b)),W.mdl[t.type].indicesBuffer?W.gl.drawElements(+t.mode||W.gl[t.mode],W.mdl[t.type].indices.length,5123,0):W.gl.drawArrays(+t.mode||W.gl[t.mode],0,W.mdl[t.type].vertices.length/3))},lerp:(t,e)=>W.next[t]?.a?W.current[t][e]+(W.next[t][e]-W.current[t][e])*(W.next[t].f/W.next[t].a):W.next[t][e],animation:(t,e=new DOMMatrix)=>W.next[t]?e.translateSelf(W.lerp(t,"x"),W.lerp(t,"y"),W.lerp(t,"z")).rotateSelf(W.lerp(t,"rx"),W.lerp(t,"ry"),W.lerp(t,"rz")).scaleSelf(W.lerp(t,"w"),W.lerp(t,"h"),W.lerp(t,"d")):e,dist:(t,e=W.next.camera)=>t?.m&&e?.m?(e.m.m41-t.m.m41)**2+(e.m.m42-t.m.m42)**2+(e.m.m43-t.m.m43)**2:0,ambient:t=>W.ambientLight=t,col:t=>[...t.replace("#","").match(t.length<5?/./g:/../g).map(e=>("0x"+e)/(t.length<5?15:255)),1],add:(t,e)=>{(W.mdl[t]=e).normals&&(W.mdl[t].customNormals=1),W[t]=e=>W.ss(e,t)},group:t=>W.ss(t,"group"),move:(t,e)=>setTimeout(()=>{W.next[t.n]&&W.ss(t)},e||1),delete:(t,e)=>setTimeout(()=>{delete W.next[t]},e||1),camera:(t,e)=>setTimeout(()=>{W.ss(t,t.n="camera")},e||1),light:(t,e)=>e?setTimeout(()=>{W.ss(t,t.n="light")},e):W.ss(t,t.n="light")};var t={538:t=>{t.exports={},t.exports.pick=(...e)=>e.length?e[t.exports.int(0,e.length-1)]:null,t.exports.int=(t,e)=>Math.floor(Math.random()*(e+1-t)+t)}},e={};function i(s){var l=e[s];return void 0===l&&(l=e[s]={exports:{}},t[s](l,l.exports,i)),l.exports}(()=>{function t(t){this.content=[],this.scoreFunction=t}function e(t){for(var e=t,i=[];e.parent;)i.unshift(e),e=e.parent;return i}t.prototype={push:function(t){this.content.push(t),this.sd(this.content.length-1)},pop:function(){var t=this.content[0],e=this.content.pop();return 0<this.content.length&&(this.content[0]=e,this.bu(0)),t},remove:function(t){var e=this.content.indexOf(t),i=this.content.pop();e!==this.content.length-1&&(this.content[e]=i,this.scoreFunction(i)<this.scoreFunction(t)?this.sd(e):this.bu(e))},sd:function(t){for(var e=this.content[t];0<t;){var i=(t+1>>1)-1,s=this.content[i];if(!(this.scoreFunction(e)<this.scoreFunction(s)))break;this.content[i]=e,this.content[t]=s,t=i}},bu:function(t){for(var e=this.content.length,i=this.content[t],s=this.scoreFunction(i);;){var l,n=t+1<<1,r=n-1,h=null;if(r<e&&(l=this.content[r],(l=this.scoreFunction(l))<s)&&(h=r),null===(h=n<e&&(r=this.content[n],this.scoreFunction(r)<(null===h?s:l))?n:h))break;this.content[t]=this.content[h],this.content[h]=i,t=h}}};const s=(t,e)=>Math.abs(e.x-t.x)+Math.abs(e.y-t.y);var l={s:function(i,l,n){i.clean(i.dirtyNodes),this.dirtyNodes=[];var r=new t(function(t){return t.f}),h=l;for(l.h=s(l,n),i.dirtyNodes.push(l),r.push(l);0<r.content.length;){var a=r.pop();if(a===n)return e(a);a.closed=!0;for(var o=i.neighbors(a),c=0,m=o.length;c<m;++c){var u,d,f=o[c];!f.closed&&0!==f.w&&(u=a.g+f.w,!(d=f.visited)||u<f.g)&&(f.visited=!0,f.parent=a,f.h=f.h||s(f,n),f.g=u,f.f=f.g+f.h,i.dirtyNodes.push(f),(f.h<h.h||f.h===h.h&&f.g<h.g)&&(h=f),d?r.sd(r.content.indexOf(f)):r.push(f))}}return e(h)}};function n(t){this.n=[],this.g=[];for(var e=0;e<t.length;e++){this.g[e]=[];for(var i=0;i<t[e].length;i++){var s=new r(i,e,t[e][i]);this.g[e][i]=s,this.n.push(s)}}this.dirtyNodes=[],this.clean(this.n)}function r(t,e,i){this.x=t,this.y=e,this.w=i}n.prototype.clean=function(t){for(var e=0;e<t.length;e++)t[e].f=0,t[e].g=0,t[e].h=0,t[e].visited=!1,t[e].closed=!1,t[e].parent=null},n.prototype.neighbors=function(t){var e=[];return this.g[t.y-1]&&this.g[t.y-1][t.y]&&e.push(this.g[t.y-1][t.x]),this.g[t.y+1]&&this.g[t.y+1][t.x]&&e.push(this.g[t.y+1][t.x]),this.g[t.y]&&this.g[t.y][t.x-1]&&e.push(this.g[t.y][t.x-1]),this.g[t.y]&&this.g[t.y][t.x+1]&&e.push(this.g[t.y][t.x+1]),e};let h=null;const a=window.AudioContext||window.webkitAudioContext,o="undefined"!=typeof InstallTrigger;let c=0;const m={c:16.35,"c#":17.32,"d#":19.45,e:20.6,"f#":23.12,"g#":25.96,"a#":29.14,b:30.87},u=()=>c;class d{constructor(t,e,i){this.f=t,this.t=e,this.d=i}play(t,e){if(!c){var i=this.f,s=this.d,l=this.t;h=h||new a;const n=l||.1,r=!o&&s||1e3*n,c=i||440,m=h.createGain(),u=h.createOscillator();u.connect(m),m.connect(h.destination),m.gain.value=t||.3,o?m.gain.setValueCurveAtTime([m.gain.value,m.gain.value/2,m.gain.value/4,m.gain.value/8,1e-5,0],h.currentTime,n):m.gain.exponentialRampToValueAtTime(1e-5,h.currentTime+n),u.type=e||"sine",u.frequency.value=c,u.start(),r&&setTimeout(()=>{u.stop()},r)}}static new=(t,e,i,s)=>new d(m[t]*Math.pow(2,e),i,s)}class f{constructor(t,e,i,s,l){this.type=e,this.tempo=i||1,this.volume=s,this.noteIndex=0,this.loop=null!=l,this.waitBeforeLoop=l||0,this.notes=[...t,...new Array(this.waitBeforeLoop).fill(null)],this.lastTime=0}playNextNote(t,e){t-this.lastTime>=e*this.tempo&&(this.notes[this.noteIndex]&&this.notes[this.noteIndex].play(this.volume,this.type),this.noteIndex++,this.loop&&this.noteIndex>=this.notes.length&&(this.noteIndex=0),this.lastTime=t)}}var p=i(538);let{pick:w,int:g}=i(538);const y=class t{constructor(t,e,i,s,l,n){this.id=t||null,this.hr=i||g(0,380),t=e||w(..."aefgikqrtxz")+w("'","")+w(..."aeiou")+Math.random().toString(36).substring(2,4).replace(/[0-9]*/g,"")+w(..."aiou"),this.n=t[0].toUpperCase()+t.slice(1),this.mb=s||.01*g(85,150),this.e=n||.01*g(50,150),this.mc=l||Math.max(1,Math.round((5*this.mb+50*Math.log(this.mb)+(5*this.e+50*Math.log(this.e)))/2)+g(-2,2)),this.m=null}clone(e){return new t(e,this.n,this.f,this.mb,this.mc,this.e)}};function x(t,e,i){return t*(1-i)+i*e}let W=0;const b=(t,e,i,s=150)=>{var l=new ImageData(t,e);if(Array.isArray(s))l.data.set(i.map(t=>s[t]).flat());else{const n=function(t,e,i=.1){var s=[...new Array(2)].map((i,s)=>{for(var l=t,n=e,r=[...new Array(l*n)].map(t=>Math.random()),h=new Array(l*n),a=Math.pow(2,s),o=1/a,c=0,m=0;m<n;++m)for(var u=Math.floor(m/a)*a,d=(u+a)%n,f=(m-u)*o,p=0;p<l;++p){var w=Math.floor(p/a)*a,g=x(r[u*l+w],r[d*n+w],f),y=x(r[u*l+(y=(w+a)%l)],r[d*n+y],f);h[c]=x(g,y,(p-w)*o),c+=1}return h}),l=new Array(t*e),n=0;for(let t=1;0<=t;--t){n+=i*=.2;for(var r=0;r<l.length;++r)l[r]=l[r]||0,l[r]+=s[t][r]*i}for(let t=0;t<l.length;++t)l[t]/=n;return l}(t,e);l.data.set(n.map(t=>{const e=[(0,p.int)(10*t,50*t),(0,p.int)(10*t,50*t),(0,p.int)(10*t,50*t),255];return i.forEach(i=>e[i]=Math.max(60,Math.floor(t*s))),e}).flat())}const n=document.createElement("canvas");return n.width=t,n.height=e,ct.getContext("2d").imageSmoothingEnabled=!1,n.getContext("2d").putImageData(l,0,0),(t=new Image).id="genimg"+W,W++,t.src=n.toDataURL(),n.remove(),t},v=b(16,16,[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,2,2,0,0,0,0,0,0,0,2,2,0,0,0,0,3,3,0,0,0,0,0,0,0,0,3,2,0,0,0,0,4,4,4,0,0,0,0,0,0,4,4,3,0,0,0,0,0,4,5,0,0,0,0,0,5,4,4,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,5,6,6,5,5,6,6,5,0,0,0,0,0,0,0,0,5,7,6,5,5,7,6,5,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,0,0,0,0,0,0,0,0,0,0,5,5,5,3,5,5,5,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,0,0,0,0,0,5,5,5,5,5,5,5,5,5,5,5,5,0,0,0],[[0,0,0,255],[159,78,76,255],[104,51,47,255],[82,54,50,255],[38,38,35,255],[24,25,24,255],[141,26,24,255],[255,0,0,255]]),T=class t{constructor(t,e,i,s,l,n,r,h,a,o,c){this.id=c||null,this.n=t,this.c=e,this.nd=i,this.do=null,this._mt=s,this.rl=l,this.t=r,this.w=h||0,this.d=a||0,this.h=o||0,this.co=n,this.s=null}ups(){var t;if((!this.nd||this.do)&&this.s&&"Misery Extractor"===this.n)return t=this.s.m,this.s.d=!0,this.s=null,{extracted:t};(!this.nd||this.do)&&this._mt&&this.s&&this.s.su(this._mt*(this.do?this.do.mb:1),this.do?this.do.e:1)}clone(e){return new t(this.n,this.c,this.nd,this._mt,this.rl,this.co,this.t,this.w,this.d,this.h,e)}},M=new class{constructor(){this.m=10,this.c=20,this.sa=0,this.sd=0,this.se=0,this.ds=0,this.dl=[new y(null,null,null,.85),new y,new y,new y],this.ml=[new T("Path",1,!1,0,1,b(4,4,[0,1,2]),"plane",1,1),new T("Misery Extractor",5,!0,0,1,b(4,4,[1,2]),"cube",3,3,5),new T("Despair Room",10,!1,1,1,b(8,8,[0,2]),"cube",5,5,8),new T("Iron Maiden",25,!0,2,2,b(4,4,[0,1]),"cube",1,1,2),new T("Cauldron",50,!0,3,3,b(4,4,[1]),"cube",3,3,1),new T("Blender",100,!0,4,4,b(4,4,[2]),"cube",1,1,5),new T("Javascript Terminal",150,!1,5,5,b(2,2,[]),"cube",1,1,2)],this.clv=[],this.mlv=[]}pl(){this.clv=this.clv.map(t=>(this.c-=4,t-4)).filter(t=>0<t),this.mlv=this.mlv.map(t=>(this.m-=8,t-8)).filter(t=>0<t)}get l(){return Math.floor(Math.sqrt(this.se+15)/2.1)}get md(){return Math.floor(10+this.l/20*40)}nd(){this.dl=[new y,new y,new y,new y]}},k=["Abandoned their pet","Blocked anti-climate-change law","Looks innocent","Micromanaged their reports","Sent soldiers to their deaths","Sins were too horrific to describe","Sold snake-oil","Used a newline before {","Was a dictator","Was a murderer","Was a thief","Was too greedy"],S=b(100,100,[0]),z=b(50,16,[0]),A=b(14,14,[0,1,2]),E=b(8,16,[0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,1,1,1,1,0,0,0,0,1,1,2,1,0,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,1,1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[[0,0,0,0],[118,215,215,255],[14,65,65,255]]),R=new class{constructor(){this.is=[],this.wi=[],this.si=null,this.sd=null,this.x=0,this.y=0,this.ma=!1,this.s=1100,this.wpu=[],this.cwp=[0,0,0,0],this.c=0,this.dm=!1,this.$=!1,this.$btn={},this.mbtn={},this.ebtn={},this.lbtn={},this.rbtn={},this.dmbtn={},this.clbtn={},this.mlbtn={}}r=t=>t*this.s/1100;cmi(t,e,i){return t[0]<=e&&e<=t[0]+t[2]&&t[1]<=i&&i<=t[1]+t[3]}dh(t,e,i){this.x=t,this.y=e,this.ma=e<i-this.r(250),this.is.forEach(i=>{var s=i.item.ih;i.item.ih=this.cmi(i.pos,t,e),i.item.ih&&i.onHover(t,e),s&&!i.item.ih&&i.onMouseOut()})}dc(){return this.is.forEach(t=>this.cmi(t.pos,this.x,this.y)?t.onClick(this.x,this.y):null),0<this.wi.map(t=>this.cmi(t.pos,this.x,this.y)?t.onClick(this.x,this.y):null).filter(t=>t&&!t.pp).length}drc(){this.si=null,this.sd=null,this.dm=null}dwpu(t){this.wpu.forEach(e=>{e.hasPoppedUp||setTimeout(()=>{d.new("c#",4,.1).play(.5),setTimeout(()=>{d.new("f#",4,.1).play(.5)},50)},0),e.hasPoppedUp=!0,e(t,this.r,this)})}mkbtn(t,e,i,s,l,n=[0,0],r="#311",h="#744",a=!1,o=0){"string"==typeof r?(t.fillStyle=r,t.fillRect(...s)):(t.filter=`hue-rotate(${o}deg)`,t.drawImage(r,...s),t.filter="none"),a&&(t.fillStyle="#3338",t.fillRect(...s)),t.strokeStyle=h,t.strokeRect(...s),t.fillStyle="#fee",i&&i.split("\n").forEach((e,i)=>t.fillText(e,s[0]+this.r(2)+n[0],s[1]+this.r(18)+n[1]+this.r(25*i))),this.is.map(t=>t.item).includes(e)||this.is.push({item:e,pos:[...s],onHover:()=>{e.ih=!0,e.ps||d.new("c#",2,.05).play(),e.ps=!0},onClick:()=>{l(),d.new("f#",4,.05).play(.5)},onMouseOut:()=>{e.ps=!1}}),e.ih&&!a&&(t.fillStyle="#faa2",t.fillRect(...s))}di(t){const e=t.canvas.width;t.imageSmoothingEnabled=!1,t.fillStyle="#211",t.strokeStyle="#977",t.fillRect(0,e-this.r(250),e,this.r(250)),t.strokeRect(0,e-this.r(250),e,this.r(250)),t.font=this.r(16)+"px luminari, fantasy",this.mkbtn(t,this.mbtn,u()?"üîá":"üîä",[e-this.r(35),this.r(10),this.r(25),this.r(25)],()=>c=!c),this.mkbtn(t,this.ebtn,"üîô",[this.r(10),this.r(10),this.r(25),this.r(25)],()=>location.reload()),t.font=this.r(50)+"px luminari, fantasy",this.mkbtn(t,this.lbtn,"‚Ü©",[this.r(10),e-this.r(310),this.r(50),this.r(50)],()=>{window.cc=(window.cc+1)%4,window.cams[window.cc]()},[this.r(2),this.r(25)]),this.mkbtn(t,this.rbtn,"‚Ü™",[e-this.r(60),e-this.r(310),this.r(50),this.r(50)],()=>{window.cc=window.cc-1<0?3:window.cc-1,window.cams[window.cc]()},[this.r(2),this.r(25)]),t.fillStyle="#fee",t.font=this.r(16)+"px luminari, fantasy",t.fillText("Balance",this.r(10),e-this.r(80)),t.moveTo(this.r(10),e-this.r(76)),t.lineTo(this.r(105),e-this.r(76)),t.stroke(),t.fillText("ü™ô",this.r(10),e-this.r(56)),t.fillText(M.c,this.r(10),e-this.r(38)),t.fillText("üåÄ",this.r(60),e-this.r(56)),t.fillText(M.m,this.r(60),e-this.r(38)),t.font=this.r(10)+"px luminari, fantasy",this.mkbtn(t,this.clbtn,"+50",[this.r(32),e-this.r(70),this.r(25),this.r(16)],()=>{M.clv.length<4&&(M.clv.push(80),M.c+=50)},[0,-8],"#311","#744"),this.mkbtn(t,this.mlbtn,"+100",[this.r(82),e-this.r(70),this.r(25),this.r(16)],()=>{this.$&&M.mlv.length<4&&(M.mlv.push(150),M.m+=100)},[0,-8],this.$?"#311":"#211",this.$?"#744":"#544",!this.$),t.font=this.r(16)+"px luminari, fantasy",t.fillText("Souls",this.r(135),e-this.r(80)),t.moveTo(this.r(135),e-this.r(76)),t.lineTo(this.r(418),e-this.r(76)),t.stroke(),t.fillText("Accepted",this.r(135),e-this.r(56)),t.fillText(M.sa,this.r(135),e-this.r(38)),t.fillText("Declined",this.r(208),e-this.r(56)),t.fillText(M.sd,this.r(208),e-this.r(38)),t.fillText("Extracted",this.r(279),e-this.r(56)),t.fillText(M.se,this.r(279),e-this.r(38)),t.fillText("Destroyed",this.r(350),e-this.r(56)),t.fillText(M.ds+" / "+M.md,this.r(350),e-this.r(38)),t.fillText("Cycle",this.r(10),e-this.r(10)),t.fillRect(this.r(55),e-this.r(20),this.c/100,this.r(10)),t.strokeRect(this.r(55),e-this.r(20),100,this.r(10)),t.fillText("Level",this.r(453),e-this.r(80)),t.font=this.r(40)+"px luminari, fantasy",t.moveTo(this.r(453),e-this.r(76)),t.lineTo(this.r(488),e-this.r(76)),t.stroke(),t.fillText(M.l,this.r(453),e-this.r(39)),M.ml.forEach((i,s)=>{t.font=this.r(16)+"px luminari, fantasy";let l=[i.n];t.measureText(i.n).width>this.r(76)&&(l=i.n.split(" ")),this.mkbtn(t,i,l.join("\n"),[this.r(15+115*s),e-this.r(235),this.r(100),this.r(100)],()=>{i.rl<=M.l&&(this.si=i)},[10,10],"#311","#744",i.rl>M.l)}),this.mkbtn(t,this.dmbtn,"Sell",[this.r(615),e-this.r(70),this.r(50),this.r(50)],()=>{R.dm=!0},[10,10],"#311",this.dm?"#ff0":"#744"),M.dl.forEach((i,s)=>{this.mkbtn(t,i,0,[e-this.r(235)+this.r(s%2*120),e-this.r(235)+this.r(120*Math.floor(s/2)),this.r(100),this.r(100)],()=>{this.sd=i},[0,0],v,this.sd===i?"#ff0":"#744",i.mc>M.m,i.hr)}),this.mkbtn(t,this.$btn,"‚Üª",[e-this.r(142.5),e-this.r(140.5),this.r(35),this.r(35)],()=>{this.$&&5<=M.c&&(this.is=this.is.filter(t=>!M.dl.includes(t.item)),d.new("f#",4,.05).play(.5),M.c=M.c-5,M.nd())},[this.r(8),this.r(5)],this.$?"#311":"#211",this.$?"#744":"#544",!this.$),M.ml.forEach((i,s)=>{i.ih&&(i.rl<=M.l&&(t.fillStyle="#faa2",t.fillRect(this.r(15+115*s),e-this.r(235),this.r(100),this.r(100))),t.fillStyle=i.rl>M.l?"#211":"#311",t.strokeStyle=i.rl>M.l?"#544":"#744",t.fillRect(this.x,this.y-this.r(100),this.r(200),this.r(100)),t.strokeRect(this.x,this.y-this.r(100),this.r(200),this.r(100)),t.fillStyle=i.rl>M.l?"#877":"#fdd",t.font=this.r(16)+"px luminari, fantasy",t.fillText(i.n,this.x+this.r(10),this.y-this.r(78)),t.font=this.r(14)+"px luminari, fantasy",t.fillText("Level: "+i.rl,this.x+this.r(190)-t.measureText("Level: "+i.rl).width,this.y-this.r(78)),t.fillStyle=i.c>M.c?"#f00":i.rl>M.l?"#877":"#fdd",t.fillText(`-${i.c} ü™ô`,this.x+this.r(10),this.y-this.r(50)),t.fillStyle=i.rl>M.l?"#877":"#fdd",i.mt&&t.fillText("üåÄ: +"+i.mt,this.x+this.r(10),this.y-this.r(32)),i.nd)&&(t.font=this.r(10)+"px luminari, fantasy",t.fillText("Requires operator",this.x+this.r(10),this.y-this.r(12)))}),M.dl.forEach(e=>{e.ih&&(t.fillStyle=e.mc>M.m?"#211":"#311",t.strokeStyle=e.mc>M.m?"#544":"#744",t.fillRect(this.x-this.r(200),this.y-this.r(100),this.r(200),this.r(100)),t.strokeRect(this.x-this.r(200),this.y-this.r(100),this.r(200),this.r(100)),t.fillStyle=e.mc>M.m?"#877":"#fdd",t.font=this.r(16)+"px luminari, fantasy",t.fillText(e.n,this.x-this.r(190),this.y-this.r(75)),t.font=this.r(14)+"px luminari, fantasy",t.fillText(Math.floor(100*e.mb)+"% üåÄ",this.x-this.r(190),this.y-this.r(50)),t.fillText(new Array(Math.round(3.33*e.e)).fill().map(t=>"‚≠ê").join(""),this.x-this.r(190),this.y-this.r(30)),t.fillText(`-${e.mc}üåÄ/cycle`,this.x-this.r(190),this.y-this.r(10)))}),this.$btn.ih&&(this.$&&(t.fillStyle="#faa2",t.fillRect(e-this.r(142.5),e-this.r(140.5),this.r(35),this.r(35))),t.fillStyle=this.$?"#311":"#211",t.strokeStyle=this.$?"#744":"#544",t.fillRect(this.x-this.r(200),this.y-this.r(100),this.r(200),this.r(100)),t.strokeRect(this.x-this.r(200),this.y-this.r(100),this.r(200),this.r(100)),t.fillStyle=this.$?"#fdd":"#877",t.font=this.r(16)+"px luminari, fantasy",t.fillText("Refresh Demons",this.x-this.r(190),this.y-this.r(75)),t.font=this.r(14)+"px luminari, fantasy",this.$||(t.fillStyle="#f22",t.fillText("Monetization disabled",this.x-this.r(190),this.y-this.r(50))),t.fillStyle=M.c<5?"#f22":this.$?"#fdd":"#877",t.fillText("-5ü™ô",this.x-this.r(190),this.y-this.r(10)))}dr(t){this.di(t),this.dwpu(t)}},D=R,_=new f([d.new("c",1,.5),null,d.new("c",1,1),null,null,null,null,null,null,null,null,d.new("c",1,.5),d.new("c",1,1)],"sine",.5,.5,35),B=[new f([null,null,null,null,null,null,d.new("a#",4,5),null,null,null,d.new("d#",4,5),null,null,null,d.new("g#",4,5),null,null,null,d.new("a#",4,5),null,null,null,d.new("d#",4,5)],"sine",2,.02,11),new f([null,null,null,null,null,null,d.new("a#",3,4),d.new("g#",3,4),d.new("d#",3,4),d.new("f#",3,4),d.new("a#",3,4),d.new("g#",3,4),d.new("d#",3,4),d.new("f#",3,4),d.new("c#",2,4),null,d.new("d#",2,4),null,d.new("a#",3,4),null,null,d.new("a#",3,4),d.new("g#",3,4),d.new("a#",3,4),d.new("f#",3,4),d.new("a#",3,4),d.new("g#",3,4),d.new("a#",3,4),d.new("d#",3,4),d.new("a#",3,4),d.new("g#",3,4),d.new("a#",3,4),d.new("f#",3,4),d.new("a#",3,4),d.new("g#",3,4),d.new("a#",3,4),d.new("d#",3,4),null,d.new("f#",3,4),null,d.new("d#",3,4),null,d.new("c#",3,4),null,d.new("d#",3,4)],"sine",2,.05,33),new f([null,null,null,null,null,null,null,null,null,null,null,null,d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("c#",1,3),d.new("c#",2,3),null,d.new("d#",2,3),d.new("d#",3,3),null,d.new("a#",2,3),d.new("a#",3,3),null,d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("c#",1,3),d.new("c#",2,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("d#",2,3),d.new("d#",3,3),d.new("c#",2,3),d.new("c#",3,3),d.new("c#",1,3)],"sine",1,.05,6)],L=new f([null,null,d.new("c#",6,4),d.new("f#",6,4),d.new("g#",6,4),d.new("d#",6,4),d.new("a#",6,4),d.new("g#",6,4),d.new("d#",6,4),d.new("f#",6,4),d.new("a#",6,4),d.new("g#",6,4),d.new("d#",6,4),d.new("f#",6,4),d.new("c#",7,4),null,d.new("d#",7,4),null,d.new("a#",6,4),null,null,d.new("a#",6,4),d.new("g#",6,4),d.new("a#",6,4),d.new("f#",6,4),d.new("a#",6,4),d.new("g#",6,4),d.new("a#",6,4),d.new("d#",6,4),d.new("a#",6,4),d.new("g#",6,4),d.new("a#",6,4),d.new("f#",6,4),d.new("a#",6,4),d.new("g#",6,4),d.new("a#",6,4),d.new("d#",6,4),null,d.new("f#",6,4),null,d.new("d#",6,4),null,d.new("c#",6,4),null,d.new("d#",6,4)],"sine",2,.01,33),C=new class{constructor(t,e){this.bpm=e,this.tracks=t}get msPerBeat(){return 6e4/this.bpm}play(t){this.tracks.forEach(e=>{e.playNextNote(t,this.msPerBeat)})}}([L,_,...B],240),P=(document.monetization&&document.monetization.addEventListener("monetizationstart",()=>{D.$=!0}),window.W),$=Math.min(window.innerWidth,window.innerHeight);let F=45;P.add("cube",{vertices:[.5,.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,-.5,.5,.5,.5,-.5,.5,.5,.5,.5,-.5,.5,.5,.5,-.5,.5,-.5,.5,.5,-.5,-.5,.5,.5,-.5,-.5,.5,-.5,-.5,.5,.5,.5,.5,-.5,-.5,.5,.5,.5,.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,.5,-.5,-.5,-.5,.5,-.5,.5,-.5,-.5,-.5,.5,-.5,-.5],uv:[1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0,1,1,0,1,0,0,1,1,0,0,1,0]}),P.add("plane",{vertices:[.5,.5,0,-.5,.5,0,-.5,-.5,0,.5,.5,0,-.5,-.5,0,.5,-.5,0],uv:[1,1,0,1,0,0,1,1,0,0,1,0]}),P.add("sh",{vertices:[.25,.5,0,-.5,-.5,0,.5,-.5,0,.25,.5,0,-.5,.5,0,-.5,-.5,0,0,1,0,-.5,.5,0,.25,.5,0],uv:[1,1,0,0,1,0,1,1,0,1,0,0,0,1.5,0,1,1,1]}),[...document.querySelectorAll("button")].forEach(t=>t.addEventListener("mouseenter",()=>{d.new("c#",2,.05).play()})),[...document.querySelectorAll("button")].forEach(t=>t.addEventListener("click",()=>{d.new("f#",4,.05).play(.5)})),cg.width=$,cg.height=$,D.s=$,P.reset(cg),P.light({x:.2,y:-1,z:-.6}),P.ambient(.1),P.clearColor("#000"),ct.width=$,ct.height=$;const I=ct.getContext("2d"),K=(menu.style=`width:${$}px;height:${$}px`,new class{constructor(t,e){this.s=t,this.m=[],this.um=[],this.mi=1,this.dl=[],this.dli=1,this.sl=[],this.is=[],this.sli=1,this.w=e,this.mcc=[],this.map=[...new Array(t)].map((e,i)=>[...new Array(t)].map((t,e)=>i<7&&new Array(7).fill().map((t,e)=>this.s/2-3+e).includes(e)?{o:!0}:{o:null})),this.graph=new n(this.map.map(t=>t.map(t=>t.o?"Path"===t.o.n?1:25:999)))}rs(t){this.sl.forEach(e=>this.w.move({n:"s-"+e.id,ry:t}))}pd(){this.um.forEach(t=>M.m-=t.m.do?t.m.do.mc:0)}fss(t){var e=[[this.s/2+1,2],[this.s/2-1,2],[this.s/2,1]].filter(([t,e])=>!this.is.find(i=>i.x===t&&i.z===e));return null===t?(0,p.pick)(...e):e[t]}ss(t,e){var i;this.is.length<3&&([e,i]=this.fss(t?e:null),e=new class{constructor(t,e,i){this.id=t,this._s=(0,p.int)(0,10),this.sd=this._s?k[0]:(0,p.pick)(...k),this.c=(0,p.int)(0,5),this.m=0,this.cod=(0,p.int)(0,35),this.h=(0,p.int)(0,10-this._s),this.x=e,this.z=i,this.s=this.h<2||(0,p.pick)(0,1)?this._s:Math.round(.05*(this._s*this.h+(0,p.int)(0,10)*(10-this.h))),this.a=!1,this.g=null,this.lg=0,this.p=[],this._d=!1,this.im=!1,this.om=0,this.mlc=0,this.rm=!(0,p.int)(0,20)&&this._s?(0,p.int)(3,6):0}get d(){return this._d}set d(t){t!==this._d&&(setTimeout(()=>{d.new("b",3,.5).play(.5),setTimeout(()=>{d.new("b",2,.3).play(.5)},200)},0),this._d=t)}get md(){return 1+10*this._s*.5}u(t){t||(this.mlc=this.om!==this.m?0:this.mlc+1,this.d=30<this.mlc,M.ds+=this.d?1:0)}su(t,e){this.d||(this.om=this.m,this.m=Math.min(this.md,this.m+Math.floor(t+.2*(10-this._s))),this.d=(0,p.int)(0,1500*e)<this.cod,M.ds+=this.d?1:0)}fg(t){5e3<=(new Date).getTime()-this.lg&&(!this.g&&this.m<10&&(this.g=(0,p.pick)(...t.filter(t=>(!t.m.nd||t.m.do)&&"plane"!==t.m.t&&"Misery Extractor"!==t.m.n&&!t.m.s&&(!this.rm||this.rm&&t.m.n===M.ml[this.rm].n)))),this.m>=10*this._s*.5&&(this.g&&"Misery Extractor"!==this.g.m.n&&(this.g.m.s=null),this.g=(0,p.pick)(...t.filter(t=>(!t.m.nd||t.m.do)&&"Misery Extractor"===t.m.n&&!t.m.s))),this.lg=(new Date).getTime())}get desc(){return["They "+(this.h<3?"seem dishonest":this.h<5?"seem a bit dishonest":this.h<7?"seem honest enough":"seem honest"),this.cod<7?"and strong willed":this.cod<15?"and sturdy":this.cod<25?"and sensitive":"and very weak"].join("\n")}}(this.sli,e,i),t&&(e._s=9,e.h=4,e.c=2,e.cod=0),this.sl.push(e),this.is.push(e),this.sli++,this.w.plane({n:"s-"+e.id,x:e.x,y:1,z:e.z,h:2,w:1,ry:-45,t:E}))}uma(){this.um.forEach(t=>{(t=t.m.ups())&&t.extracted&&(M.m=t.extracted,M.se++)}),this.sl=this.sl.filter(t=>!t.d),this.is=this.is.filter(t=>!t.d),this.um.forEach(t=>{t.m&&t.m.s&&t.m.s.d&&(t.m.s=null)})}ups(){this.sl.forEach(t=>{t.a&&!t.d&&(t.fg(this.um),t.g&&t.g.m.s&&t.g.m.s!==t&&(t.g=null,t.im=!1,t.p=l.s(this.graph,this.graph.g[t.z][t.x],this.graph.g[((0,p.int)(1,this.s-2),(0,p.int)(1,this.s-2))])),t.g&&!t.im&&0===t.p.length&&(t.p=l.s(this.graph,this.graph.g[t.z][t.x],this.graph.g[t.g.z][t.g.x])),!t.im)&&0<t.p.length&&(this.w.move({n:"s-"+t.id,x:t.p[0].x,z:t.p[0].y,a:999===t.p[0].w?500:100}),t.im=!0,setTimeout(()=>{t.p&&0<t.p.length&&(t.x=t.p[0].x,t.z=t.p[0].y,t.p=t.p.slice(1),t.im=!1,0===t.p.length)&&t.g&&(t.g.m.s=t)},999===t.p[0].w?500:100)),t.d&&(t.g&&t.g.m&&t.g.m.s===t&&(t.g.m.s=null,t.g=null),setTimeout(()=>{this.w.delete("s-"+t.id)},500))})}anim(t){this.sl.forEach((e,i)=>{e.d||this.w.move({n:"s-"+e.id,y:1+t,a:250},i%5*100)})}iao(t,e,i,s){if(t-Math.floor(i/2)==0||t+Math.floor(i/2)===this.s-1||e-Math.floor(s/2)==0||e+Math.floor(s/2)===this.s-1)return!0;for(let l=e-Math.floor(s/2);l<=e+Math.floor(s/2);l++)for(let e=t-Math.floor(i/2);e<=t+Math.floor(i/2);e++)if(!this.map[l]||!this.map[l][e]||this.map[l][e].o)return!0;return!1}ata(t,e,i,s,l){for(let n=e-Math.floor(s/2);n<=e+Math.floor(s/2);n++)for(let e=t-Math.floor(i/2);e<=t+Math.floor(i/2);e++)this.map[n][e].o=l;"plane"!==l.t&&this.w.sh({n:"sh-b"+t+e,x:t-(Math.sqrt(Math.pow(i,2)+Math.pow(s,2))/6+l.h/16),y:.1,z:e-(Math.sqrt(Math.pow(i,2)+Math.pow(s,2))/6+l.h/16),w:Math.sqrt(Math.pow(i,2)+Math.pow(s,2)),h:l.h/8+Math.sqrt(Math.pow(i,2)+Math.pow(s,2))/2,b:"#00000099",ry:45,rx:-90}),M.c-=l.c,this.graph=new n(this.map.map(t=>t.map(t=>t.o?"Path"===t.o.n?1:25:999)))}dc(t,e,i,s,l,n,r,h,a,o,c,m){if(this.w.delete("pl"),n){if(r&&(i||t&&"plane"===t.t)){for(let r=Math.min(l,a);r<=Math.max(l,a);r++)for(let l=Math.min(s,h);l<=Math.max(s,h);l++)this.dc(t,e,i,l,r,n,!1,0,0,0,0,!0);return d.new("b",4,.1).play(.5),setTimeout(()=>{d.new("e",3,.1).play(.5),setTimeout(()=>{d.new("c#",2,.1).play(.5)},70)},70),{rs:!0}}if(i)return this.map[l][s].o&&this.rmm(this.map[l][s].o.id),{rs:!0};if(t&&!this.iao(s,l,t.w,t.d)&&t.c<=M.c){m||(d.new("b",4,.1).play(.5),setTimeout(()=>{d.new("e",3,.1).play(.5),setTimeout(()=>{d.new("c#",2,.1).play(.5)},70)},70));const e=t.clone(this.mi);return this.m.push({m:e,x:s,z:l}),"Path"!==e.n&&this.um.push({m:e,x:s,z:l}),this.ata(s,l,t.w,t.d,e),this.mi++,r={n:"b-"+e.id,x:s,y:t.h/2,d:t.d,w:t.w,h:t.h,z:l},"#"===t.co[0]?r.b=t.co:r.t=t.co,"cube"===t.t&&this.w.cube(r),"plane"===t.t&&(r.g="map",r.y=0,r.h=.1,r.b="#000",r.mix=(0,p.int)(10,15)/40,r.ry=(0,p.pick)(0,90,180,270),this.w.cube(r)),{rs:!0}}if(e&&this.map[l][s].o&&!0!==this.map[l][s].o&&"plane"!==this.map[l][s].o.t&&e.mc<=M.m&&!this.map[l][s].o.do)return this.map[l][s].o.do=e.clone(this.dli),this.dli++,M.dl=M.dl.map(t=>t===e?new y:t),{rs:!0};if(!t&&!e){const t=this.map[l][s].o;if(!0!==t&&t&&"Path"!==t.n)return{r:t=>[o,c-t(110),t(200),t(100)],popup:(e,i,s)=>{e.fillStyle="#311d",e.strokeStyle="#744",e.fillRect(o,c-i(110),i(200),i(100)),e.strokeRect(o,c-i(110),i(200),i(100)),e.fillStyle=t.nd&&!t.do?"#f00":"#0f0",e.font=i(16)+"px luminari, fantasy",e.fillText("‚¨§",o+i(10),c-i(85)),e.fillStyle="#fff",e.font=i(14)+"px luminari, fantasy",e.fillText(t.n,o+i(30),c-i(85)),t.do?(e.filter=`hue-rotate(${t.do.hr}deg)`,e.drawImage(v,o+i(10),c-i(75),i(55),i(55)),e.filter="none"):(e.fillStyle="#000",e.fillRect(o+i(10),c-i(75),i(55),i(55))),e.strokeRect(o+i(10),c-i(75),i(55),i(55)),t.s&&!t.s.d&&(e.drawImage(E,o+i(75),c-i(75),i(35),i(55)),e.fillStyle="#fff",e.fillText("üåÄ",o+i(110),c-i(70)),e.fillStyle="#fff6",e.fillRect(o+i(113),c-i(65),i(12),i(45)),e.fillStyle="#25f",e.fillRect(o+i(113),c-i(65-(45-45*t.s.m/t.s.md)),i(12),i(45*t.s.m/t.s.md)),e.strokeRect(o+i(113),c-i(65),i(12),i(45))),e.fillStyle=s.cmi([o+i(170),c-i(40),i(20),i(20)],s.x,s.y)?"#2f2":"#171",e.fillRect(o+i(170),c-i(40),i(20),i(20)),e.fillStyle="#fff",e.fillText("$",o+i(175),c-i(25)),e.strokeRect(o+i(170),c-i(40),i(20),i(20)),e={t:"m-sell-btn",bt:"b-"+t.id,pos:[o+i(170),c-i(40),i(20),i(20)],onClick:(e,i)=>(d.new("f#",3,.1).play(.5),setTimeout(()=>{d.new("c#",3,.1).play(.2)},50),setTimeout(()=>{this.rmm(t.id)},25),{pp:!0})},0===s.wi.filter(t=>"m-sell-btn"===t.t).length?s.wi.push(e):0<s.wi.filter(e=>"m-sell-btn"===e.t&&e.bt!=="b-"+t.id).length&&(s.wi=s.wi.filter(t=>"m-sell-btn"!==t.t))}};const e=this.sl.find(t=>t.x===s&&t.z===l);return e?{r:t=>[o,c-t(110),t(200),t(100)],popup:(t,i,s)=>{if(t.fillStyle="#311d",t.strokeStyle="#744",t.fillRect(o,c-i(110),i(200),i(100)),t.strokeRect(o,c-i(110),i(200),i(100)),t.fillStyle="#fff",t.font=i(10)+"px luminari, fantasy",t.fillText("Sin",o+i(10),c-i(90)),t.fillStyle="#fff6",t.fillRect(o+i(10),c-i(80),i(12),i(60)),t.fillStyle="#f00",t.fillRect(o+i(10),c-i(80-(60-60*e.s/e.md)),i(12),i(60*e.s/e.md)),t.strokeRect(o+i(10),c-i(80),i(12),i(60)),t.font=i(14)+"px luminari, fantasy",t.fillStyle="#fff",e.desc.split("\n").forEach((e,s)=>t.fillText(e,o+i(35),c-i(90-15*s))),e.rm&&t.fillText("Needs: "+M.ml[e.rm].n,o+i(35),c-i(50)),t.fillText(e.c+"ü™ô",o+i(35),c-i(23)),t.fillStyle=s.cmi([o+i(140),c-i(40),i(20),i(20)],s.x,s.y)?"#f22":"#711",t.fillRect(o+i(140),c-i(40),i(20),i(20)),t.fillStyle="#fff",t.fillText("‚úñ",o+i(145),c-i(25)),t.strokeRect(o+i(140),c-i(40),i(20),i(20)),t.fillStyle=s.cmi([o+i(170),c-i(40),i(20),i(20)],s.x,s.y)?"#2f2":"#171",t.fillRect(o+i(170),c-i(40),i(20),i(20)),t.fillStyle="#fff",t.fillText("‚úî",o+i(175),c-i(25)),t.strokeRect(o+i(170),c-i(40),i(20),i(20)),this.is.includes(e)&&!e.a){const t={t:"soul-btn",bt:"s-"+e.id,pos:[o+i(140),c-i(40),i(20),i(20)],onClick:(t,i)=>(d.new("f#",3,.1).play(.5),setTimeout(()=>{d.new("c#",3,.1).play(.2)},50),setTimeout(()=>{this.is=this.is.filter(t=>t!==e),this.sl=this.sl.filter(t=>t!==e),this.w.delete("s-"+e.id,100),M.sd++},1e3),{pp:e.isDead=!0})},l={t:"soul-btn",bt:"s-"+e.id,pos:[o+i(170),c-i(40),i(20),i(20)],onClick:(t,i)=>(d.new("f#",3,.1).play(.5),setTimeout(()=>{d.new("b",3,.1).play(.2)},50),this.is=this.is.filter(t=>t.id!==e.id),e.z=3,this.w.move({n:"s-"+e.id,z:3,a:250}),e.a=!0,M.sa++,M.c+=e.c,{pp:!0})};0===s.wi.filter(t=>"soul-btn"===t.t).length?(s.wi.push(t),s.wi.push(l)):0<s.wi.filter(t=>"soul-btn"===t.t&&t.bt!=="s-"+e.id).length&&(s.wi=s.wi.filter(t=>"soul-btn"!==t.t))}}}:{removeOthers:!0}}}}drc(){this.w.delete("pl")}dh(t,e,i,s,l,n,r,h,a){if(n){if(r&&i)return void this.w.cube({n:"pl",x:(s<h?h:s)-Math.abs(s-h)/2,y:0,z:(l<a?a:l)-Math.abs(l-a)/2,w:Math.floor(s<h?h-s:s-h)+1,d:Math.floor(l<a?a-l:l-a)+1,h:.1,b:"#99110088"});t&&"cube"===t.t&&this.w.cube({n:"pl",x:s,y:t.h/2,z:l,d:t.d,w:t.w,h:t.h,b:this.iao(s,l,t.w,t.d)||M.c<t.c?"#ff000088":"#00aa0088"}),t&&"plane"===t.t&&this.w.cube({n:"pl",x:r?(s<h?h:s)-Math.abs(s-h)/2:s,y:0,z:r?(l<a?a:l)-Math.abs(l-a)/2:l,w:r?Math.floor(s<h?h-s:s-h)+t.w:t.w,d:r?Math.floor(l<a?a-l:l-a)+t.w:t.w,h:.1,b:this.iao(s,l,t.w,t.d)&&!r||(r?M.c<t.c*((Math.floor(s<h?h-s:s-h)+t.w)*(Math.floor(l<a?a-l:l-a)+t.w)):M.c<t.c)?"#ff000088":"#00aa0088"}),t||this.w.cube({n:"selector",x:s,y:0,z:l,w:this.scale,d:this.scale,h:.1,b:e?"#00aaaaaa":"#ffffffaa"})}e&&this.map[l][s]&&this.map[l][s].o&&!0!==this.map[l][s].o&&"plane"!==this.map[l][s].o.t?(this.mcc.includes(this.map[l][s].o.id)||this.mcc.push(this.map[l][s].o),this.map[l][s].o.do?this.w.move({n:"b-"+this.map[l][s].o.id,b:"#ff000044",mix:.8}):this.w.move({n:"b-"+this.map[l][s].o.id,b:"#00ff0044",mix:.8})):(this.mcc.forEach(t=>this.w.move({n:"b-"+t.id,mix:0})),this.mcc=[])}rmm(t){var e=this.m.find(e=>e.m.id===t);if(e&&e.m){e.m.do&&(e.m.do.m=null,e.m.do=null),e.m.s&&(e.m.s.g=null);for(let t=e.z-Math.floor(e.m.d/2);t<=e.z+Math.floor(e.m.d/2);t++)for(let i=e.x-Math.floor(e.m.w/2);i<=e.x+Math.floor(e.m.w/2);i++)this.map[t][i].o=null;M.c+=Math.floor(e.m.c/2),this.w.delete("sh-b"+e.x+e.z,1),this.w.delete("b-"+t,1),this.m=this.m.filter(e=>e.m.id!==t),this.um=this.um.filter(e=>e.m.id!==t)}}dm(){this.w.cube({g:"map",x:this.map.length-1,y:1,z:(this.map.length-1)/2,w:this.map.length,h:2,d:1,t:z,ry:-90}),this.w.cube({g:"map",x:(this.map.length-1)/2,y:1,z:0,w:this.map.length,h:2,d:1,t:z,ry:0}),this.w.cube({g:"map",x:0,y:1,z:(this.map.length-1)/2,w:this.map.length,h:2,d:1,t:z,ry:-90}),this.w.cube({g:"map",x:(this.map.length-1)/2,y:1,z:this.map.length-1,w:this.map.length,h:2,d:1,t:z,ry:0}),this.w.plane({g:"map",x:(this.map.length-1)/2,y:0,z:(this.map.length-1)/2,size:this.map.length,t:S,rx:-90}),this.w.cube({g:"map",x:this.map.length/2,y:0,z:3,w:7,h:.05,d:7,t:A,ry:0})}}(50,P));let U=0,N=0,O=(window.cams=[()=>{P.camera({x:0+U,y:32,z:0+N,rx:-45,ry:-135}),K.rs(-135)},()=>{P.camera({x:0+U,y:32,z:50+N,rx:-45,ry:-45}),K.rs(-45)},()=>{P.camera({x:50+U,y:32,z:50+N,rx:-45,ry:45}),K.rs(45)},()=>{P.camera({x:50+U,y:32,z:0+N,rx:-45,ry:135}),K.rs(135)}],null),q=null,Y=null,j=null,H=null,V=null,G=null,J=!(window.cc=1),X=(cui.width=$,cui.height=$,0),Q=[{m:"Welcome to Hell Inc. upper management!",pgc:!0},{m:"You've been hand-plucked from the demonic masses to manage this hell pit",pgc:!0},{m:"Let me show you around...",pgc:!0},{m:"This is the soul waiting area",clear:[321,349,60,50],al:[351,399],pgc:!0},{m:"Click the space below a soul",clear:[333,376,20,25],al:[344,396],cc:!0,rwp:!0},{m:"Sinful souls give you more üåÄ but they can lie about their sins",clear:[3,3,-176,-2],at:[0,0],cpu:!0,pgc:!0},{m:"This gives you more info about this soul",clear:[30,0,-38,-30],at:[0,0],cpu:!0,pgc:!0},{m:"Weak souls may perish during torture, so you want sturdy ones",clear:[30,0,-38,-30],at:[0,0],cpu:!0,pgc:!0},{m:"Souls perish if waiting for too long",pgc:!0},{m:"Don't let souls perish without extracting üåÄ!",pgc:!0},{m:"Click ‚úî to accept this soul",clear:[165,65,-170,-70],at:[0,0],cpu:!0,cc:!0},{m:"The soul gave you some coins (ü™ô). You now have 22 ü™ô!",clear:[3,1e3,110,70],al:[58,1e3],pgc:!0},{m:"It has nowhere to go, so it's waiting until there is an available machine",clear:[321,349,60,50],at:[351,399],pgc:!0},{m:"Click the Despair Room",clear:[236,856,115,115],al:[293,856],cc:!0},{m:"Then click your pit",clear:[422,311,70,70],at:[457,381],cc:!0},{m:"The soul will slowly travel to the machine",pgc:!0},{m:"Paths let them travel faster",clear:[10,856,115,115],al:[67,856],pgc:!0},{m:"You can click and drag to fill an area with paths",pgc:!0},{m:"Click your Dispair Room",clear:[422,311,70,70],at:[457,381],cc:!0,rwp:!0},{m:"This shows if the machine is working and who operates it",clear:[0,0,0,0],at:[0,0],cpu:!0,pgc:!0},{m:"You can sell this machine for 50% of the cost",clear:[165,65,-160,-70],at:[0,0],cpu:!0,pgc:!0},{m:"You can mass-sell machines (and paths) too",clear:[610,1025,60,60],ab:[635,1025],pgc:!0},{m:"When the soul's üåÄ is full, the soul will look for an Extractor",clear:[105,0,-160,0],at:[0,0],cpu:!0,pgc:!0},{m:"Click the Misery Extractor",clear:[120,856,115,115],al:[177,856],cc:!0},{m:"Then click your pit",clear:[522,411,70,70],at:[557,481],cc:!0},{m:"This is your available hiring pool",clear:[854,856,236,236],ar:[972,856],pgc:!0},{m:"Each demon can induce a certain üåÄ%, a certain üåÄ per cycle",clear:[854,856,236,236],ar:[972,856],pgc:!0},{m:"Their rating (‚≠ê) tells you how good they are at torturing without destroying a soul",clear:[854,856,236,236],ar:[972,856],pgc:!0},{m:"Demons cost some üåÄ every cycle",clear:[5,1074,160,20],al:[82,1074],pgc:!0},{m:"Now employ a demon by clicking a portrait",clear:[854,856,236,236],ar:[972,856],cc:!0},{m:"Then click your Misery Extractor",clear:[522,411,70,70],at:[557,481],cc:!0},{m:"If coins are tight, ask for a loan",clear:[30,1030,30,20],al:[45,1030],pgc:!0},{m:"You'll pay a little bit back every cycle",pgc:!0},{m:"Oh, you can use the mousewheel to zoom and WASD to pan",pgc:!0},{m:"Your progress is being monitored",clear:[125,1e3,300,70],al:[208,1e3],pgc:!0},{m:"That concludes your training. Have a miserable time!",pgc:!0}].map(t=>{const e={...t};return["clear","al","at","ar","ab"].forEach(t=>{t in e&&(e[t]=e[t].map(t=>D.r(t)))}),e});const Z=cui.getContext("2d");window.addEventListener("keydown",t=>{var e=[["KeyA","KeyD","KeyS","KeyW"],["KeyW","KeyS","KeyA","KeyD"],["KeyD","KeyA","KeyW","KeyS"],["KeyS","KeyW","KeyD","KeyA"]];X||(t.code===e[window.cc][0]&&(U+=1,--N),t.code===e[window.cc][1]&&(--U,N+=1),t.code===e[window.cc][2]&&(--U,--N),t.code===e[window.cc][3]&&(U+=1,N+=1),window.cams[window.cc]())}),ct.addEventListener("mousewheel",t=>{X||(F=0<t.deltaY?Math.min(85,F+10):Math.max(5,F-10),P.projection=new DOMMatrix([1/F,0,0,0,0,1/F,0,0,0,0,-2/998,0,0,0,-1e3/998,1]))}),ct.addEventListener("mousemove",t=>{J="mousedown"===G||J&&"hover"===G,G="hover";var e,i=t.target.getBoundingClientRect();O=t.clientX-i.left,q=t.clientY-i.top,P.v&&(({x:t,z:i}=(t=O/i.width,i=q/i.height,e=[[-.75,1],[0,0],[1,1],[0,2]],P.v.inverse().multiply(P.projection).transformPoint(new DOMPoint(2*F*t-F+e[window.cc][0],1,4*F*i-(3*F-45*(F/45-1))+e[window.cc][1])))),Y=Math.min(48,Math.max(1,Math.floor(t))),j=Math.min(48,Math.max(1,Math.ceil(i))),e=!X||X&&Q[0]&&!Q[0].cc||X&&Q[0]&&Q[0].clear&&Q[0].cc&&D.cmi(!0===Q[0].cpu?Q[0].clear.map((t,e)=>t+D.cwp[e]):Q[0].clear,O,q),O)&&q&&e&&(D.dh(O,q,Z.canvas.height)||K.dh(D.si,D.sd,D.dm,Y,j,D.ma,J,H,V))}),ct.addEventListener("click",t=>{G="click";var e=!X||X&&Q[0]&&!Q[0].cc||X&&Q[0]&&Q[0].clear&&Q[0].cc&&D.cmi(!0===Q[0].cpu?Q[0].clear.map((t,e)=>t+D.cwp[e]):Q[0].clear,O,q),i=X&&Q[0]&&Q[0].pgc;if(O&&q&&e&&(setTimeout(()=>{X&&Q[0]&&(!Q[0].rwp||Q[0].rwp&&0<D.wpu.length)&&(Q=Q.slice(1))},2),!i)&&!D.dc(O,q)){const t=K.dc(D.si,D.sd,D.dm,Y,j,D.ma,J,H,V,O,q);D.wpu=[],D.cwp=[0,0,0,0],t&&t.popup&&(D.wpu.push(t.popup),D.cwp=t.r(D.r)),t&&t.rs&&(D.sd=null,D.si=null,D.dm=!1)}}),ct.addEventListener("mousedown",t=>{H=Y,V=j,G="mousedown"}),ct.addEventListener("mouseout",()=>{G=null,O=null,q=null}),ct.oncontextmenu=t=>{t.preventDefault(),t.stopPropagation(),G="rightClick",D.wpu=[],O&&q&&(D.drc(O,q),K.drc(),d.new("b",3,.1).play(.5),setTimeout(()=>{d.new("b",3,.1).play(.2)},50))},window.speed=1,setTimeout(()=>{K.dm(1),P.projection=new DOMMatrix([1/F,0,0,0,0,1/F,0,0,0,0,-2/998,0,0,0,-1e3/998,1]),window.cams[window.cc]()},1);let et=!0,it=(setInterval(()=>{K.anim(et?.3:-.3),et=!et},250),(new Date).getTime()),st=(new Date).getTime(),lt=(new Date).getTime()+(0,p.int)(3500,15e3),nt=!1,rt=!1,ht="";const at=function(t){X||u()||C.play(t),ht=M.m<=-100?"too much üåÄ debt":M.ds>M.md?"destroyed too many souls":M.sd>M.md?"declined too many souls":M.c<-20?"lost too many coins":"",nt=!!ht;const e=(new Date).getTime();if(I.clearRect(0,0,cui.width,cui.height),K.ups(),X)if(I.fillStyle=nt?"#0003":"#000c",I.fillRect(0,0,cui.width,cui.height),Q[0]){let t=[0,0,0,0];Q[0].clear&&(t=!0===Q[0].cpu?Q[0].clear.map((t,e)=>t+D.cwp[e]):Q[0].clear,I.clearRect(...t)),I.fillStyle="#fff",I.font=D.r(24,13)+"px luminari, fantasy";const e=I.measureText(Q[0].m).width;I.fillText(Q[0].m,$/2-e/2,$/2+D.r(25)/2),I.strokeStyle="#fff",Q[0].al&&(I.beginPath(),I.moveTo($/2-e/2-D.r(10),$/2),I.lineTo(!0===Q[0].cpu?t[0]+t[2]/2+Q[0].al[0]:Q[0].al[0],$/2),I.lineTo(!0===Q[0].cpu?t[0]+t[2]/2+Q[0].al[0]:Q[0].al[0],!0===Q[0].cpu?t[1]+t[3]/2+Q[0].al[1]:Q[0].al[1]),I.stroke()),Q[0].ar&&(I.beginPath(),I.moveTo($/2+e/2+D.r(10),$/2),I.lineTo(!0===Q[0].cpu?t[0]+t[2]/2+Q[0].ar[0]:Q[0].ar[0],$/2),I.lineTo(Q[0].ar[0],$/2),I.lineTo(!0===Q[0].cpu?t[0]+t[2]/2+Q[0].ar[0]:Q[0].ar[0],!0===Q[0].cpu?t[1]+t[3]/2+Q[0].ar[1]:Q[0].ar[1]),I.stroke()),Q[0].at&&(I.beginPath(),I.moveTo(!0===Q[0].cpu?t[0]+t[2]/2+Q[0].at[0]:Q[0].at[0],$/2-D.r(25)),I.lineTo(!0===Q[0].cpu?t[0]+t[2]/2+Q[0].at[0]:Q[0].at[0],!0===Q[0].cpu?t[1]+t[3]+Q[0].at[1]:Q[0].at[1]),I.stroke()),Q[0].ab&&(I.beginPath(),I.moveTo(!0===Q[0].cpu?t[0]+t[2]/2+Q[0].ab[0]:Q[0].ab[0],$/2+D.r(25)),I.lineTo(!0===Q[0].cpu?t[0]+t[2]/2+Q[0].ab[0]:Q[0].ab[0],!0===Q[0].cpu?t[1]+t[3]+Q[0].ab[1]:Q[0].ab[1]),I.stroke())}else X=!1;!nt&&1e4<=D.c&&(D.c=0,K.pd(),M.pl()),!nt&&1e3<=e-st&&(K.uma(),K.sl.forEach(t=>t.u(X)),st=e),!nt&&e>=lt&&(K.ss(),lt=e+(0,p.int)(3500,15e3)),nt||(D.c=Math.min(D.c+(e-it)||0,1e4)),Z.clearRect(0,0,cui.width,cui.height),D.dr(Z),it=e,nt&&nt!==rt&&(X=!0,(Q=[]).push({m:`You have ${ht}!`,pgc:!0}),setTimeout(()=>{d.new("c#",4,.5).play(.5),setTimeout(()=>{d.new("b#",3,1).play(.5),setTimeout(()=>{d.new("f#",3,1).play(.5),setTimeout(()=>{d.new("c#",3,1).play(.5)},100)},350)},250)},0)),nt&&0<Q.length&&Q.push({m:"You're fired!",pgc:!0}),rt=nt,window.requestAnimationFrame(at)},ot=t=>{X=t,cui.removeAttribute("n"),cg.removeAttribute("n"),ct.removeAttribute("n"),menu.setAttribute("n",""),K.ss(X,1),at()};tt.addEventListener("click",t=>{ot(1)}),pp.addEventListener("click",t=>{ot()})})()</script>