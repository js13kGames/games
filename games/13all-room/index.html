<!doctype html><meta content="viewport-fit=cover,width=device-witdth,initial-scale=1,minimum-scale=1,maximum-scale=1,user-scalable=no" name=viewport><style>*{box-sizing:border-box;font-family:Arial,Helvetica,sans-serif;margin:0;padding:0}body{background-color:#000;display:flex;height:100dvh}canvas{height:100%;image-rendering:pixelated;touch-action:none;width:100%}</style><link href=# rel=icon><title>13all Room</title><canvas></canvas><script>"use strict";const gImgs={riko:"wBAMAAAClLOS0AAAAGFBMVEX22am+cVf35NVwi6LmuJLZlm7+/v5LRlliQKl9AAACjUlEQVQ4y2XUsXLbMAwAUFgHpWuZmPWqsLLmpErOK8VAmilVcFafzue5PqXH3y9IOXHa6jzYeCYAgrThdH1MZq4f4OPdREQ8Vv/BhADYMnf/wFQAABEqrv6GGJenYVp/hsktcfRIffcJvj8DGChA6tA4XqF4eQIJL+natvoA++IlkpkFaP8OB6gXSJRb/w4F7OxS3IigHd8ByvoCAM6gT0UEJovz0qy8hoLGtruAK8+ywgLFAki63S9wdPcKI3jAUTai2+ECWaMsJWjtCMTteoESWFuZBoy5K2UmzBcAAYLc40iGAKllvYBFZqLeYx/OJBtvWVURDhabFXLjcTOHNyS35T5BCZa32Hrxze0abbbVYwLp9OsxB4GSO2PMRukhwkG2++2Qs0fISOL39bl3EYoC8q7Ax7G0TgZsVuszH2JXWQlUFbiGYnSFrJCRjPF6wQ0gngD758JZE6HR6zRdOWicBM4uKyPQSul0HgCeZCvqyWYxbmyjVAKbe3cEVBpdgqLR+U2CxjqZkFqbCDSA4iwdFOQybIHBYPx+Vt5xl6UVW/DSsnKm9FH6n7yfIgylbDm3SmI8GNPoHbsE+yOUchhjLKBcrpUSiCPZS9qi+RWhVRJVvXaTtCUHnQFuAgvI1lQv4KcuFpf7kd/Vj9Lsl9+ae8WasUs7b2Ez1/WDMa9hbLln3fcxldylRuJ1bYoQ1jyS1jodLbXNJsbrH2UIZ/adpMtjKmJ1l6AuX0PQVPWa3a2A9JjCu90DyxJ/ajQPuYD0vksS3mgTQnUqNHNeRbhkCrNrQpDLL/8C8jdwBcmFccUk1Xkfob5AeILXMJ9OPfc0fIIwz7iaZYmkus0rUJvdBcKMpt7NVfwdbLs/3xr/Q+vU/5QAAAAASUVORK5CYII=",jimin:"wBAMAAAClLOS0AAAALVBMVEX82cj3wLb5ybz70cJZPVbqd4DvnJryrafhiI02IkTNP2Tfa3vZV3CWZXOZNVmsYsVnAAADV0lEQVQ4y3XSQY/bRBQA4NmM1OWYsdWkElSyM2J3JS7jGYlwr6XWCJB6mGzYlEN2ycQqVEoCsS11eyitE1OgJ1+sanPaSuANlRDdghJ64NA2ZHNgEYJWVThxaST4DR070S6VyrvYM5/njfXeA+h/AiBUeEnoEhQCFmG4rrZ4pRIwTb/JC7vMeac1PyFBYWnKvM8rDzjn+810qepAMeST4XYllvsBr3BFOQaMi3zjgJdqwubjzzA7AgLb4sZ+wO26KPOywvQFqGC55GwMO77o1IV94XtsLICAtbrYiO8JGa5T+4HROaiUCNeuxCPRbOarjj9kxEiBYNhBl+N+yXUNxRX+oIFxAgxrxU7+VElxkbtaFTV/sAU0JgEQ6JVcrwFyTccVts1/2mQAJMBorlSvZcFKV9Tbvs8PruokhQzKlUWgyX+2/RrnB+NRVU0A0pzNgxIBy2Wfy4L1472qkkJGFpBLOCEfvDKO40coBVl75PN1AJzccFiJZXw3B6gnMKoCzx9W9sb9Qbw5h0wBoY8noyC71gnqYvxwO24hRhJQDfRqXJ5uGc7vD9GNe9u3kQoTgBijk5PgZgtQr8kuB699rZMUACVGbqgaNBkCeFJs/6wCjaRFBBDZGkgBtLvb5zUM52UnzPCyMJuCp3zZZJAtOkjZagNWUTJUnndbpYtGIQWS5U9gWWShvGPwiB21FuFMRgWoIC9j7fE1CI+mRIEakpsSoD/JYno8cAQYxAs2AThRGlGiH4NKV7OOaAF4qrOeZDoCRFFrqU7Aki/uP9b/CwjlCgqAH3H0JDp8Ea78CsDawbrxfnh2AUsFhHW0Yt1C6ML+Fv0wfFfuYwlv/Hi11kWno97uOw94A34eWr/NG7XiuqIuU+8M9mTnX7HM6KyOtWQSi/mGvhaZt+QsbK7cfBaaO0qaihl5xbgeWjuO414ZzCzTjP7EyYgahTy6ZJnWe8H08K/JbmiaZnhYkFBE6IMoNK237/97bjb+W+6bUXiOyhP5u5b8LBxMJXy7m4BlRV0Jn0bJomdL+Kd7NwV5BihvWXOoXp8+vVZ8kkLUuwOUi7NnKaAp+oK9HqZ39PoTUOzH3ySr3tZX7h/0UvJqhbMhBxf7kzvyp8ze+eD0mTd/SRPN9jh/DlA5Pf2WIXMpAAAAAElFTkSuQmCC",kenny:"wBAMAAAClLOS0AAAAGFBMVEULDBAYGRtFREGhoYHLyLYmLSvr8fJyZ1k2zTjyAAACVUlEQVQ4y12TQXObMBCFV2k6uaJ0mFxtOYRrajHmnKLIV4tW43thyDWVMtm/390FPEn2gMR+vPc0QoLpQ42dbdpkTNBaw/S53NAaE8NHQJ97Hgdjqhg1+KU/VLq4kwl59SZcwGMZ4+meJh0iobhajZGr9OSYCaFZwUvJIPwhRTO0+S2Bd2TWNk+iiJTix2l0TQvcnwZNzfOeHrPeHxNYN4pTUDGR14HzrLUIuWPJX9VvtVpAZ22LYHk6QNknXegyeunTssA2NB+OJWJQhb4VIxQgGzG2iFuz0TcM2g9goheTNuq6Y2AxUzh5jX7gj8wJHra8mWxGwDrnBKSt8q2E86qQBkKiSNdj9S4Km2bQMEiYHp7Lb50lk5ygvgCDafezvGNBxkoUjXMtmhqx3msBmGZA6fvaoIAzR6cqAmLDoGv2Eq9/MzAMMvcJHDm/xh1ZJQZZIpxrhhpT0HXmBBMjbWJnZw2mAuBG+hUDavOJGnM6Ka2+s5HhU2Kl/DRgAXT+oEbumwoM0o4ROPKB1QVciRFZpZj3mcC+1EIU2Sxgl7I9DP/0XEXPIGgw4UxL9LMTgyu2YqBv0TZTWoFWBPgaVAwOQ3UBILcgQFWeMU8vce0XM9AQ4hnfp2dek1ICOH0B3j+KyQrYl8H9OG2kBbPVCvrs/UYUAAU9cL6DQfe196+yT1QCooDY7yijAFiBmUHsTeP88woKBmIVTe2cf/oEWEIDg1dajZqRMiIhkOm/nvQSQXeHFYHAjn/44nRLzTNff8owb1/Aj19sFaDmvjst/j2BTtL/Az2WE+urYCu6AAAAAElFTkSuQmCC"},gSnds={logo:""},canvas=document.querySelector("canvas"),ctx=canvas.getContext("2d"),cam={x:null,y:null},clrs={0:"rgba(0,0,0,0)",1:"rgb(255,255,255)",2:"rgb(255,0,0)",3:"rgb(255,164,0)",4:"rgb(255,255,0)",5:"rgb(0,255,0)",6:"rgb(0,0,255)",7:"rgb(127,0,127)",8:"rgb(0,0,0)",9:"rgba(255,255,255,0.5)",10:"rgba(255,255,255,0.25)",11:"rgba(0,0,0,0.5)",12:"rgba(0,0,0,0.25)",13:"rgb(255,104,179)",14:"rgb(0,0,139)"},gLogic={activeUnit:"riko",balls:0,coins:0,hasKey:{jimin:!1,riko:!1,kenny:!1},inGameTimer:780};let gTimer60=0,gTimer120=0;class Renderer{constructor(){this.gW=320,this.gH=320,this.massS=32,this.massL=10,this.rndr(),window.addEventListener("resize",(()=>this.rndr()))}calcRes(t,s){return t/(s/this.massL)*this.massS}rndr(){canvas.width=canvas.offsetWidth<canvas.offsetHeight?this.gW:this.calcRes(canvas.offsetWidth,canvas.offsetHeight),canvas.height=canvas.offsetWidth>=canvas.offsetHeight?this.gH:this.calcRes(canvas.offsetHeight,canvas.offsetWidth),cam.x=Math.floor(canvas.width/2),cam.y=Math.floor(canvas.height/2)}}class baseObj{constructor(t,s,i,r){this.dx=t,this.dy=s,this.dw=i||0,this.dh=r||0}rndr(){}rndr2(){}update(){}}class Coin extends baseObj{constructor(t,s){super(t,s,16,16)}rndr(t){const s=calcPan(t);ctx.fillStyle=`rgb(${sine(0,255,gTimer60/60)},${sine(0,164,gTimer60/60)},0)`,ctx.fillRect(s.x+this.dx+2,s.y+this.dy,12,1),ctx.fillRect(s.x+this.dx+1,s.y+this.dy+1,14,1),ctx.fillRect(s.x+this.dx,s.y+this.dy+2,16,12),ctx.fillRect(s.x+this.dx+1,s.y+this.dy+14,14,1),ctx.fillRect(s.x+this.dx+2,s.y+this.dy+15,12,1),ctx.fillStyle=`rgb(255,${sine(164,255,gTimer60/60)},${sine(0,255,gTimer60/60)})`,ctx.fillRect(s.x+this.dx+4,s.y+this.dy+2,8,12)}}class RoomBlock{constructor(){this.r=clrRng(),this.g=clrRng(),this.b=clrRng(),this.dw=Math.floor(64*Math.random())+1,this.dh=Math.floor(64*Math.random())+1,this.dx=Math.floor(Math.random()*canvas.width),this.dy=-this.dh,this.speed=Math.floor(6*Math.random())+1}rndr(){ctx.fillStyle=`rgb(${lerp(this.r,0,this.dy/canvas.height)},${lerp(this.g,0,this.dy/canvas.height)},${lerp(this.b,0,this.dy/canvas.height)})`,ctx.fillRect(this.dx,this.dy,this.dw,this.dh)}update(){this.dy+=this.speed,this.dy>canvas.height&&(this.dw=Math.floor(64*Math.random())+1,this.dh=Math.floor(64*Math.random())+1,this.dx=Math.floor(Math.random()*canvas.width),this.dy=-this.dh,this.r=clrRng(),this.g=clrRng(),this.b=clrRng(),this.speed=Math.floor(6*Math.random())+1,this.dx+this.dw>canvas.width&&(this.dx=canvas.width-this.dw))}}class DPad{constructor(){this.dir=null}rndr(){ctx.fillStyle=clrs[11],ctx.beginPath(),ctx.arc(64,canvas.height-64,48,0,2*Math.PI),ctx.fill(),this.rndrBlock("up",48,112,32,32),this.rndrBlock("down",48,48,32,32),this.rndrBlock("left",16,80,32,32),this.rndrBlock("right",80,80,32,32),this.dir=null}update(t,s){const i=t.pointer,r=t.pointer2;checkPntCol(i.dx+16,48,80,i.dy+16,canvas.height-112,canvas.height-80)||checkPntCol(r.dx+16,48,80,r.dy+16,canvas.height-112,canvas.height-80)?(this.dir="up",s.plr.body.dy-=s.plr.body.speed):checkPntCol(i.dx+16,48,80,i.dy+16,canvas.height-48,canvas.height-16)||checkPntCol(r.dx+16,48,80,r.dy+16,canvas.height-48,canvas.height-16)?(this.dir="down",s.plr.body.dy+=s.plr.body.speed):checkPntCol(i.dx+16,16,48,i.dy+16,canvas.height-80,canvas.height-48)||checkPntCol(r.dx+16,16,48,r.dy+16,canvas.height-80,canvas.height-48)?(this.dir="left",s.plr.body.dx-=s.plr.body.speed):(checkPntCol(i.dx+16,80,112,i.dy+16,canvas.height-80,canvas.height-48)||checkPntCol(r.dx+16,80,112,r.dy+16,canvas.height-80,canvas.height-48))&&(this.dir="right",s.plr.body.dx+=s.plr.body.speed)}rndrBlock(t,s,i,r,c){ctx.fillStyle=this.dir===t?clrs[1]:clrs[10],ctx.fillRect(s,canvas.height-i,r,c)}}class HUD{rndr(){ctx.fillStyle=clrs[11],this.rndrPic("jimin",16,16),this.rndrPic("riko",68,16),this.rndrPic("kenny",120,16),ctx.fillRect(16,68,152,60),ctx.fillStyle=clrs[1],ctx.font="16px Arial",ctx.textAlign="start",ctx.textBaseline="top",ctx.fillText(`Unit: ${gLogic.activeUnit} `,20,72),ctx.fillText(`Balls: ${gLogic.balls} /12`,20,92),ctx.fillText(`Coins: ${gLogic.coins}/169`,20,112),ctx.fillText(`Time: ${Math.floor(gLogic.inGameTimer/60)}:${(gLogic.inGameTimer-60*Math.floor(gLogic.inGameTimer/60)).toString().padStart(2,"0")}`,20,132),ctx.fillText(`${gLogic.activeUnit} ${gLogic.hasKey[gLogic.activeUnit]?"does":"doesn`t"} have a key.`,20,152)}rndrPic(t,s,i){ctx.drawImage(gImgs[t],s,i),gLogic.activeUnit!=t&&ctx.fillRect(s,i,48,48)}update(t){const s=t.pointer,i=t.pointer2;(checkPntCol(s.dx,16,64,s.dy,16,64)||checkPntCol(i.dx,16,64,i.dy,16,64))&&(gLogic.activeUnit="jimin"),(checkPntCol(s.dx,68,116,s.dy,16,64)||checkPntCol(i.dx,68,116,i.dy,16,64))&&(gLogic.activeUnit="riko"),(checkPntCol(s.dx,120,168,s.dy,16,64)||checkPntCol(i.dx,120,168,i.dy,16,64))&&(gLogic.activeUnit="kenny")}}class Plr{constructor(t){this.body={dx:t?.dx||0,dy:t?.dy||0,dw:32,dh:48,speed:2},this.hitBox={dx:0,dy:16,dw:32,dh:32}}rndr(){"jimin"===gLogic.activeUnit&&(ctx.fillStyle=clrs[13]),"riko"===gLogic.activeUnit&&(ctx.fillStyle=clrs[6]),"kenny"===gLogic.activeUnit&&(ctx.fillStyle=clrs[5]),ctx.fillRect(cam.x,cam.y,this.body.dw,this.body.dh)}update(t,s){const i=s.dPad;checkObjCol(this,s.walls,i,t),checkObjCol(this,s.warps,i,t),checkObjCol(this,s.gObjs,i,t)}}class Warp extends baseObj{constructor(t,s,i,r,c,e,n){super(t,s,i,r),this.rn=c,this.rx=e,this.ry=n}}class Brick extends baseObj{constructor(t,s){super(t,s)}rndr(t){const s=calcPan(t),i=new Path2D(`\n      M ${s.x+this.dx+0},${s.y+this.dy+1}\n      l 32,0z\n      M ${s.x+this.dx+15},${s.y+this.dy+1}\n      l 0,16z\n      M ${s.x+this.dx+16},${s.y+this.dy+1}\n      l 0,16z\n      M ${s.x+this.dx+0}, ${s.y+this.dy+16}\n      l 32,0z \n      M ${s.x+this.dx+1},${s.y+this.dy+16}\n      l 0,16z\n      M ${s.x+this.dx+31},${s.y+this.dy+16}\n      l 0,16z\n      M ${s.x+this.dx+0}, ${s.y+this.dy+31}\n      l 32,0z`);ctx.lineWidth=2,ctx.strokeStyle=clrs[9],ctx.beginPath(),ctx.stroke(i)}}class CursedBall extends baseObj{constructor(t,s){super(t,s)}dr=32;rndr(t){if(gLogic.balls<12){const s=calcPan(t),i=ctx.createRadialGradient(s.x+this.dx,s.y+this.dy-16,4,s.x+this.dx,s.y+this.dy-16,this.dr);i.addColorStop(0,clrs[1]),i.addColorStop(1,`rgba(0, 0, ${sine(0,255,gTimer120/120)}, 1)`),ctx.fillStyle=i,ctx.beginPath(),ctx.arc(s.x+this.dx,s.y+this.dy,this.dr-4,0,2*Math.PI),ctx.fill()}}}class RoomBall extends baseObj{constructor(t,s){super(t+16,s+16)}dr=16;rndr(t){const s=calcPan(t),i=ctx.createRadialGradient(s.x+this.dx,s.y+this.dy-8,4,s.x+this.dx,s.y+this.dy-8,this.dr);i.addColorStop(0,clrs[1]),i.addColorStop(1,`rgb(${sine(0,255,gTimer120/120)}, 0, 0)`),ctx.fillStyle=i,ctx.beginPath(),ctx.arc(s.x+this.dx,s.y+this.dy,this.dr-2,0,2*Math.PI),ctx.fill()}}class BallHolder extends baseObj{constructor(t,s,i){super(t,s),this.id=i}dr=16;rndr(t){if(gLogic.balls>this.id){const s=calcPan(t),i=ctx.createRadialGradient(s.x+this.dx-16,s.y+this.dy-16-8,4,s.x+this.dx-16,s.y+this.dy-16-8,this.dr);i.addColorStop(0,clrs[1]),i.addColorStop(1,`rgba(0, 0, ${sine(0,255,gTimer120/120)}, 1)`),ctx.fillStyle=i,ctx.beginPath(),ctx.arc(s.x+this.dx-16,s.y+this.dy-16,this.dr-2,0,2*Math.PI),ctx.fill()}else{const s=calcPan(t);ctx.fillStyle=clrs[12],ctx.beginPath(),ctx.arc(s.x+this.dx-16,s.y+this.dy-16,this.dr-2,0,2*Math.PI),ctx.fill()}}}class Ground extends baseObj{constructor(t,s,i,r,c,e){super(s,i,r,c),this.clr=t||"brown",this.clr2=e}rndr(t){const s=calcPan(t);if(this.clr2){const t=ctx.createLinearGradient(s.x+this.dx,s.y+this.dy,this.dw,this.dh);t.addColorStop(0,this.clr),t.addColorStop(.8,this.clr2),ctx.fillStyle=t,ctx.fillRect(s.x+this.dx,s.y+this.dy,this.dw,this.dh)}else ctx.fillStyle=this.clr,ctx.fillRect(s.x+this.dx,s.y+this.dy,this.dw,this.dh)}}class RoomLock extends baseObj{constructor(t="jimin",s,i){super(s,i,32,32),this.n=t}rndr(t){const s=calcPan(t),i=new Path2D(`M ${s.x+this.dx+16},${s.y+this.dy} l 16,0 0,4 -16,0 0,4 8,0 0,4 -8,0 0,8 10,0 0,10 -20,0 0,-10 6,0, 0,-20 z`);ctx.fillStyle=`rgb(${"jimin"===this.n?255:0},${"kenny"===this.n?255:0},${"riko"===this.n?255:0})`,ctx.fillRect(s.x+this.dx,s.y+this.dy,this.dw,this.dh),ctx.fillStyle=`rgb(${"jimin"===this.n?255:sine(255,0,gTimer120/120)}, ${"kenny"===this.n?255:sine(255,0,gTimer120/120)}, ${"riko"===this.n?255:sine(255,0,gTimer120/120)})`,ctx.beginPath(),ctx.fill(i)}}class RoomKey extends baseObj{constructor(t="jimin",s,i){super(s,i,32,32),this.n=t}rndr(t){if(gLogic.activeUnit===this.n){const s=calcPan(t),i=new Path2D(`M ${s.x+this.dx+16},${s.y+this.dy+sine(0,4,gTimer60/60)} l 16,0 0,4 -16,0 0,4 8,0 0,4 -8,0 0,8 10,0 0,10 -20,0 0,-10 6,0, 0,-20 z`);ctx.fillStyle=`rgb(${"jimin"===this.n?255:sine(255,0,gTimer120/120)}, ${"kenny"===this.n?255:sine(255,0,gTimer120/120)}, ${"riko"===this.n?255:sine(255,0,gTimer120/120)})`,ctx.beginPath(),ctx.fill(i)}}}class Wall extends baseObj{constructor(t,s,i,r,c,e=!0,n=!0){super(s,i,r,c),this.clr=t,this.solid=e,this.seeable=n}rndr(t){const s=calcPan(t);ctx.fillStyle=this.clr,(this.seeable||"jimin"==gLogic.activeUnit)&&ctx.fillRect(s.x+this.dx,s.y+this.dy,this.dw,this.dh)}}class EndGameMessage extends baseObj{constructor(t,s){super(t,s,32,32)}rndr(t){const s=calcPan(t);ctx.font="43px Arial",ctx.textAlign="center",ctx.textBaseline="top",ctx.fillStyle=clrs[8],12===gLogic.balls&&gLogic.inGameTimer>0?ctx.fillText("You Win",s.x+this.dx,s.y+this.dy):ctx.fillText("You Lose",s.x+this.dx,s.y+this.dy)}}class Kabin extends baseObj{constructor(t,s){super(t,s,32,32)}rndr(t){const s=calcPan(t);ctx.fillStyle=clrs[1],ctx.fillRect(s.x+this.dx,s.y+this.dy,this.dw,this.dh),ctx.fillStyle=clrs[5],ctx.fillRect(s.x+this.dx+4,s.y+this.dy+4,this.dw-8,this.dh-16),ctx.fillStyle=clrs[11],ctx.fillRect(s.x+this.dx+4,s.y+this.dy+4,this.dw-8,this.dh-26),ctx.fillStyle=clrs[11],ctx.fillRect(s.x+this.dx,s.y+this.dy+24,this.dw,this.dh-24)}}class TitleScene{constructor(){this.gObjs=[];for(let t=0;t<39;t++)this.gObjs.push(new RoomBlock)}rndr(){this.gObjs.forEach((t=>t.rndr()));const t=canvas.width/2,s=canvas.height/2;ctx.fillStyle=clrs[9],ctx.fillRect(0,s-48,canvas.width,43),ctx.font="43px Arial",ctx.textAlign="center",ctx.textBaseline="top",ctx.fillStyle=clrs[8],ctx.fillText("3ALL ROOM",t,s-46),ctx.fillText("1",t-117,s-46),ctx.fillStyle=clrs[9],ctx.font="24px Arial",ctx.textAlign="center",ctx.fillText("Tap or Click to Start",t,s+24),ctx.font="16px Arial",ctx.textAlign="start",ctx.textBaseline="top",ctx.fillText("#js13k 2024",4,4),ctx.textAlign="end",ctx.textBaseline="bottom",ctx.fillText("Made by: Kenny Fully",canvas.width-4,canvas.height-4)}update(t){if(t.isTapped)return t.isTapped=!1,countDown(),t.currentScene="start";this.gObjs.forEach((t=>t.update()))}}class Room{constructor(t,s,i,r,c){this.grounds=t,this.walls=s,this.warps=i,this.gObjs=r,this.plr=c||new Plr,this.hud=new HUD,this.dPad=new DPad;for(let t=0;t<this.grounds.length;t++)this.grounds[t]=new Ground(...this.grounds[t]);for(let t=0;t<this.walls.length;t++)this.walls[t]=new Wall(...this.walls[t]);for(let t=0;t<this.warps.length;t++)this.warps[t]=new Warp(...this.warps[t]);for(let t=0;t<this.gObjs.length;t++)"bh"===this.gObjs[t][0]&&(this.gObjs[t]=new BallHolder(this.gObjs[t][1],this.gObjs[t][2],this.gObjs[t][3])),"br"===this.gObjs[t][0]&&(this.gObjs[t]=new Brick(this.gObjs[t][1],this.gObjs[t][2])),"c"===this.gObjs[t][0]&&(this.gObjs[t]=new Coin(this.gObjs[t][1],this.gObjs[t][2])),"cb"===this.gObjs[t][0]&&(this.gObjs[t]=new CursedBall(this.gObjs[t][1],this.gObjs[t][2])),"eg"===this.gObjs[t][0]&&(this.gObjs[t]=new EndGameMessage(this.gObjs[t][1],this.gObjs[t][2])),"kb"===this.gObjs[t][0]&&(this.gObjs[t]=new Kabin(this.gObjs[t][1],this.gObjs[t][2])),"rb"===this.gObjs[t][0]&&(this.gObjs[t]=new RoomBall(this.gObjs[t][1],this.gObjs[t][2])),"rk"===this.gObjs[t][0]&&(this.gObjs[t]=new RoomKey(this.gObjs[t][1],this.gObjs[t][2],this.gObjs[t][3])),"rl"===this.gObjs[t][0]&&(this.gObjs[t]=new RoomLock(this.gObjs[t][1],this.gObjs[t][2],this.gObjs[t][3]))}rndr(){cam.x,this.plr.body.dx,cam.y,this.plr.body.dy;this.grounds.forEach((t=>t.rndr(this.plr))),this.walls.forEach((t=>t.rndr(this.plr))),this.gObjs.forEach((t=>t.rndr(this.plr))),this.plr.rndr(),this.hud.rndr(),this.dPad.rndr()}update(t){this.hud.update(t),this.dPad.update(t,this),this.gObjs.forEach((s=>s.update(t,this))),this.plr.update(t,this)}}class StartRoom extends Room{constructor(){super([[clrs[14],0,0,320,352],[clrs[1],32,32,256,256,clrs[0]]],[[clrs[11],32,0,96,32],[clrs[11],192,0,96,32],[clrs[9],0,0,32,320],[clrs[12],32,32,4,256,!1],[clrs[9],288,0,32,320],[clrs[9],32,288,96,32],[clrs[12],128,304,4,48,!1],[clrs[9],192,288,96,32],[clrs[11],0,320,128,32],[clrs[11],192,320,128,32]],[[128,0,64,32,"end",144,272],[128,320,64,32,"main",464,-16]],[["cb",160,32],["bh",64,64,0],["bh",96,64,1],["bh",128,64,2],["bh",224,64,3],["bh",256,64,4],["bh",288,64,5],["bh",80,96,6],["bh",112,96,7],["bh",144,96,8],["bh",208,96,9],["bh",240,96,10],["bh",272,96,11],["kb",96,128,12],["kb",192,128],["c",152,72],["c",48,192],["c",80,160],["c",112,192],["c",192,192],["c",224,160],["c",256,192],["c",48,224],["c",80,256],["c",112,224],["c",192,224],["c",224,256],["c",256,224]],new Plr({dx:144,dy:160})),rndrBricks(this.walls,3,1,0),rndrBricks(this.walls,3,6,0),rndrBricks(this.walls,4,0,10),rndrBricks(this.walls,4,6,10)}}class MainRoom extends Room{constructor(){super([[clrs[7],0,0,960,640]],[[clrs[14],0,-32,448,32],[clrs[14],512,-32,448,32],[clrs[3],-32,0,32,320],[clrs[3],-32,384,32,256],[clrs[3],960,0,32,640],[clrs[3],96,576,768,32,!0,!1],[clrs[3],64,640,832,32],[clrs[9],288,0,32,160],[clrs[9],640,0,32,160]],[[448,-32,64,32,"start",144,272],[-32,320,32,64,"r6",592,304],[0,640,64,32,"r7",16,0],[896,640,64,32,"r8",304,0]],[["rb",0,0],["rb",928,0],["rb",480,608],["kb",96,128],["c",32,32],["c",48,64],["c",64,32],["c",80,64],["c",96,32],["c",112,64],["c",128,32],["c",144,64],["c",160,32],["c",176,64],["c",196,32],["c",212,64],["c",228,32],["rl","riko",896,0],["rl","riko",896,32],["rl","riko",928,32]]),rndrBricks(this.walls,14,0,-1),rndrBricks(this.walls,14,16,-1)}}class JiminRoom extends Room{constructor(){super([[clrs[13],0,0,640,640,clrs[1]]],[[clrs[2],0,-32,640,32],[clrs[2],-32,0,32,640],[clrs[2],640,0,32,640],[clrs[2],64,640,576,32]],[[0,640,64,32,"r6",16,0]],[["rb",0,0],["c",542,0],["c",574,0],["c",608,0],["c",542,32],["c",574,32],["c",608,32],["c",542,64],["c",574,64],["c",608,64],["c",542,96],["c",574,96],["c",608,96],["c",574,128],["rk","jimin",Math.floor(604*Math.random()),Math.floor(604*Math.random())]])}}class RikoRoom extends Room{constructor(){super([[clrs[6],0,0,640,640],[clrs[11],0,0,640,640]],[[clrs[6],0,-32,576,32],[clrs[6],-32,0,32,640],[clrs[6],640,0,32,576],[clrs[6],0,640,640,32]],[[576,-32,64,32,"r7",272,592],[640,576,32,64,"r9",0,256]],[["rb",Math.floor(608*Math.random()),Math.floor(608*Math.random())],["rk","riko",Math.floor(608*Math.random()),Math.floor(608*Math.random())]]),rdmCoins(this.gObjs,13,Math.floor(628*Math.random()),Math.floor(628*Math.random()))}}class KennyRoom extends Room{constructor(){super([[clrs[5],0,0,640,640],[clrs[12],0,0,640,640]],[[clrs[5],0,-32,576,32],[clrs[5],-32,0,32,640],[clrs[5],640,0,32,640],[clrs[5],0,640,256,32],[clrs[5],320,640,320,32]],[[576,-32,64,32,"r11",272,256],[256,640,64,32,"r8",912,0]],[["rb",Math.floor(576*Math.random()),Math.floor(608*Math.random())],["rk","kenny",Math.floor(576*Math.random()),Math.floor(288*Math.random())],["rl","kenny",608,0],["rl","kenny",576,0]]),rdmCoins(this.gObjs,13,576,608)}}class R6Room extends Room{constructor(){super([[clrs[2],0,0,320,320,clrs[6]],[clrs[6],0,320,640,320,clrs[2]]],[[clrs[13],64,-32,256,32],[clrs[13],-32,0,32,640],[clrs[13],320,0,32,320],[clrs[13],352,288,288,32],[clrs[13],640,384,32,256],[clrs[13],64,640,576,32]],[[0,-32,64,32,"jimin",16,592],[640,320,32,64,"main",0,304],[0,640,64,32,"r10",16,0]],[["rb",128,64],["rl","jimin",0,608],["rl","jimin",32,608]]),rdmCoins(this.gObjs,6,304,304),rdmCoins(this.gObjs,7,608,304,0,320)}}class R7Room extends Room{constructor(){super([[clrs[6],0,0,320,640],[clrs[11],0,0,320,640],[clrs[11],0,320,320,320]],[[clrs[6],64,-32,256,32],[clrs[6],-32,0,32,640],[clrs[6],320,0,32,640],[clrs[6],0,640,256,32]],[[0,-32,64,32,"main",16,592],[256,640,64,32,"riko",592,0]],[["rb",Math.floor(304*Math.random()),Math.floor(624*Math.random())]]),rdmCoins(this.gObjs,13,304,624)}}class R8Room extends Room{constructor(){super([[clrs[5],0,0,960,320],[clrs[12],0,0,960,320]],[[clrs[5],0,-32,288,32],[clrs[5],352,-32,544,32],[clrs[5],-32,0,32,320],[clrs[5],960,0,32,320],[clrs[5],0,320,960,32]],[[288,-32,64,32,"main",912,592],[896,-32,64,32,"kenny",272,592]],[["rb",Math.floor(928*Math.random()),Math.floor(288*Math.random())]]);for(let t=0;t<96;t++)this.grounds.push(new Ground(clrs[4],Math.floor(896*Math.random()),Math.floor(256*Math.random()),64,64));rdmCoins(this.gObjs,13,944,304)}}class R9Room extends Room{constructor(){super([[clrs[6],0,0,960,320],[clrs[11],0,0,960,320],[clrs[11],0,0,960,320],[clrs[11],640,0,320,320],[clrs[6],960,256,32,64]],[[clrs[6],0,-32,960,32],[clrs[6],-32,0,32,256],[clrs[6],960,0,32,256],[clrs[6],0,320,960,32]],[[-32,256,32,64,"riko",592,576],[960,256,32,64,"r12",0,576]],[["rb",Math.floor(928*Math.random()),Math.floor(288*Math.random())]]),rdmCoins(this.gObjs,13,944,304)}}class R10Room extends Room{constructor(){super([[clrs[8],0,0,320,320]],[[clrs[13],64,-32,256,32],[clrs[13],-32,0,32,320],[clrs[13],320,0,32,320],[clrs[13],0,320,320,32],[clrs[7],0,64,256,32,!0,!1],[clrs[7],64,128,256,32,!0,!1],[clrs[7],160,192,32,128,!0,!1]],[[0,-32,64,32,"r6",16,592]],[["rb",0,288],["c",0,200],["c",0,216],["c",0,232],["c",0,248],["c",0,264],["c",40,304],["c",56,304],["c",72,304],["c",88,304],["c",104,304],["c",304,304],["c",304,288],["c",288,304]])}}class R11Room extends Room{constructor(){super([],[[clrs[5],0,-32,320,32],[clrs[5],-32,0,32,320],[clrs[5],320,0,32,320],[clrs[5],0,320,256,32]],[[256,320,64,32,"kenny",592,0]],[["rb",Math.floor(288*Math.random()),Math.floor(288*Math.random())]]),rdmCoins(this.gObjs,13,304,304)}}class R12Room extends Room{constructor(){super([[clrs[6],-32,576,32,64]],[[clrs[6],320,-32,320,32],[clrs[6],288,0,32,320],[clrs[6],640,0,32,640],[clrs[6],0,288,288,32],[clrs[6],-32,320,32,256],[clrs[6],0,640,640,32]],[[-32,576,32,64,"r9",928,256]],[["rb",Math.floor(608*Math.random()),Math.floor(288*Math.random())+320]]),rdmCoins(this.gObjs,6,304,304,320,0),rdmCoins(this.gObjs,7,608,304,0,320)}}class EndRoom extends Room{constructor(){super([[clrs[1],0,0,640,320]],[[clrs[4],0,-32,640,32],[clrs[4],-32,0,32,320],[clrs[4],640,0,32,320],[clrs[4],0,320,128,32],[clrs[4],192,320,448,32]],[[128,320,64,32,"start",144,32]],[["eg",128,64]]),rdmCoins(this.gObjs,13,628,304)}}class SceneManager{constructor(){this.scenes={title:new TitleScene,start:new StartRoom,main:new MainRoom,jimin:new JiminRoom,riko:new RikoRoom,kenny:new KennyRoom,r6:new R6Room,r7:new R7Room,r8:new R8Room,r9:new R9Room,r10:new R10Room,r11:new R11Room,r12:new R12Room,end:new EndRoom},this.currentScene="title",this.isTapped=!1,this.pointer={id:null,clr:"",dx:null,dy:null},this.pointer2={id:null,clr:"",dx:null,dy:null},canvas.addEventListener("pointerdown",(t=>{if(null===this.pointer.id)this.pointer.id=t.pointerId,this.setPntr(t,this.pointer,"rgba(255,255,255,0.25)");else{if(null!==this.pointer2.id)return;this.pointer2.id=t.pointerId,this.setPntr(t,this.pointer2,"rgba(255,255,255,0.25)")}})),canvas.addEventListener("pointermove",(t=>{if(this.pointer.id===t.pointerId)this.setPntr(t,this.pointer,"rgb(0,255,0,0.25)");else{if(this.pointer2.id!==t.pointerId)return;this.setPntr(t,this.pointer2,"rgb(0,255,0,0.25)")}})),canvas.addEventListener("pointerup",(t=>{this.pointer.id===t.pointerId?(this.isTapped=!0,this.unsetPntr(this.pointer)):this.pointer2.id===t.pointerId&&(this.isTapped=!0,this.unsetPntr(this.pointer2))})),document.addEventListener("keydown",(t=>{"r"===t.key&&(this.pointer.id=null,this.pointer2.id=null)}))}setPntr(t,s,i){const r=getPntrPos(t);s.clr=i,s.dx=r.x,s.dy=r.y}unsetPntr(t){t.id=null,t.dx=null,t.dy=null}rndr(){ctx.clearRect(0,0,canvas.width,canvas.height),this.scenes[this.currentScene].rndr(),null!=this.pointer.id&&(ctx.fillStyle=this.pointer.clr,ctx.fillRect(this.pointer.dx,this.pointer.dy,32,32)),null!=this.pointer2.id&&(ctx.fillStyle=this.pointer2.clr,ctx.fillRect(this.pointer2.dx,this.pointer2.dy,32,32)),this.update()}update(){this.scenes[this.currentScene].update(this),gTimer60>59?gTimer60=0:gTimer60++,gTimer120>119?gTimer120=0:gTimer120++,requestAnimationFrame((()=>this.rndr()))}}const countDown=()=>{setInterval((()=>{gLogic.inGameTimer--}),1e3)},getPntrPos=t=>{const s=t.target.getBoundingClientRect();return{x:(t.clientX-s.left)/s.right*canvas.width-16,y:(t.clientY-s.top)/s.bottom*canvas.height-16}},calcPan=(t={body:{dx:1,dy:1}})=>({x:cam.x-t.body.dx,y:cam.y-t.body.dy}),lerp=(t,s,i)=>t+(s-t)*i,sine=(t,s,i)=>t+(s-t)*Math.sin(Math.PI*(2*i)),clrRng=()=>Math.floor(256*Math.random()),rdmCoins=(t,s,i,r,c=0,e=0)=>{for(let n=0;n<s;n++)t.push(new Coin(Math.floor(Math.random()*i)+c,Math.floor(Math.random()*r)+e))},rndrBricks=(t,s,i=0,r=0)=>{for(let c=0;c<s;c++)t.push(new Brick(32*i+32*c,32*r))},checkPntCol=(t,s,i,r,c,e)=>t>s&&t<i&&r>c&&r<e,checkObjCol=(t,s,i,r)=>{const c=()=>{"up"===i.dir?t.body.dy+=t.body.speed:"down"===i.dir?t.body.dy-=t.body.speed:"left"===i.dir?t.body.dx+=t.body.speed:"right"===i.dir&&(t.body.dx-=t.body.speed)};for(let i=0;i<s.length;i++)(t.body.dx+t.body.dw>s[i].dx&&t.body.dx<s[i].dx+s[i].dw&&t.body.dy+t.body.dh>s[i].dy&&t.body.dy+16<s[i].dy+s[i].dh||t.body.dx+t.body.dw>s[i].dx-s[i].dr&&t.body.dx<s[i].dx+s[i].dr&&t.body.dy+t.body.dh>s[i].dy-s[i].dr&&t.body.dy+16<s[i].dy+s[i].dr)&&(s[i]instanceof Wall&&s[i].solid||s[i]instanceof CursedBall&&gLogic.balls<12||s[i]instanceof Kabin?c():s[i]instanceof Warp?(r.scenes[s[i].rn].plr.body.dx=s[i].rx,r.scenes[s[i].rn].plr.body.dy=s[i].ry,r.currentScene=s[i].rn):s[i]instanceof RoomBall?(s.splice(s.indexOf(s[i]),1),gLogic.balls++):s[i]instanceof Coin?(s.splice(s.indexOf(s[i]),1),gLogic.coins++):s[i]instanceof RoomKey&&s[i].n===gLogic.activeUnit?(s.splice(s.indexOf(s[i]),1),gLogic.hasKey[gLogic.activeUnit]=!0):s[i]instanceof RoomLock&&(gLogic.hasKey[s[i].n]?s.splice(s.indexOf(s[i]),1):c()))},renderer=new Renderer,sceneManager=new SceneManager;Object.entries(gImgs).forEach((t=>{const s=new Image;s.src=`data: image / png; base64, ${"logo"===t[0]?"":"iVBORw0KGgoAAAANSUhEUgAAADAAAAA"}${t[1]}`,gImgs[t[0]]=s})),Object.entries(gSnds).forEach((t=>{})),document.querySelector("link").href=gImgs.riko.src,sceneManager.rndr(),console.log("May God Bless Us!")</script>