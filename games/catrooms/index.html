<!doctype html><title>CatRooms - js13kGames 2025</title><style>html{background-color:rgba(0,0,0,.8)}#cv{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);height:min(100vh,100vw);width:min(100vh,100vw)}</style><canvas id=cv></canvas><script>function a(a,t){this.x=a,this.y=t}function t(t,i){return void 0===t?new a(0,0):new a(t,void 0!==i?i:t)}a.prototype.copy=function(){return new a(this.x,this.y)},a.prototype.equals=function(a){return this.x==a.x&&this.y==a.y},a.prototype.add=function(a){return t(this.x+a.x,this.y+a.y)},a.prototype.sub=function(a){return t(this.x-a.x,this.y-a.y)},a.prototype.mul=function(t){return new a(this.x*t,this.y*t)},a.prototype.dot=function(a){return this.x*a.x+this.y*a.y},a.prototype.length=function(){return void 0===this.l&&(this.l=Math.sqrt(this.x*this.x+this.y*this.y)),this.l},a.prototype.normalize=function(){if(void 0===this.n){let a=this.length();if(0==a)return this.copy();this.n=this.mul(1/a)}return this.n},a.prototype.reflection=function(a){return this.add(a.mult(-2*this.dot(a)))};const i=1.5,s=document.getElementById("cv"),h=s.getContext("2d");s.width=800,s.height=800;class e{constructor(){this.data=[]}push(a,t){this.data.push({f:a,node:t});let i=this.data.length-1;for(;i>0;){let a=i-1>>1;if(this.data[a].f<=this.data[i].f)break;[this.data[a],this.data[i]]=[this.data[i],this.data[a]],i=a}}pop(){if(0===this.data.length)return null;const a=this.data[0].node,t=this.data.pop();if(this.data.length>0){this.data[0]=t;let a=0;for(;;){let t=2*a+1,i=2*a+2,s=a;if(t<this.data.length&&this.data[t].f<this.data[s].f&&(s=t),i<this.data.length&&this.data[i].f<this.data[s].f&&(s=i),s===a)break;[this.data[a],this.data[s]]=[this.data[s],this.data[a]],a=s}}return a}isEmpty(){return 0===this.data.length}}let o=(a,i)=>{let s=Math.cos(i),h=Math.sin(i);return t(a.x*s-a.y*h,a.x*h+a.y*s)},l=(a,i)=>o(a.sub(i.pos),-i.rot).mul(i.zoom).add(t(s.width/2,s.height/2)),n=(a,t,i)=>1-Math.pow(1-t,a/i),r=(a,t,i,s,h)=>a.add(t.sub(a).mul(n(i,s,h))),d=(a,i)=>t(Math.cos(a),Math.sin(a)).mul(i);function f(a,s,h){let e=!1,o=Math.floor(a.x/i),l=Math.floor(a.y/i);for(let n=l-1;n<=l+1;n++)for(let l=o-1;l<=o+1;l++)if(n>=0&&n<h.length&&l>=0&&l<h[n].length&&" "!==h[n][l]){let h=l*i,o=(l+1)*i,r=n*i,d=(n+1)*i,p=t(Math.max(h,Math.min(a.x,o)),Math.max(r,Math.min(a.y,d))),f=a.sub(p),c=f.dot(f);if(c<s*s){let t=Math.sqrt(c)||1e-4,i=f.mul((s-t)/t);a=a.add(i),e=!0}}return[e,a]}function c(a,t,i,s){let h,e=t.sub(a),o=Math.floor(e.length()/i)+1;for(let t=1;t<=o&&(p=a.add(e.mul(t/o)),h=f(p,i,s),!h[0]);t++);return h[1]}const u=[];function y(a,i){this.world=a,this.pos=i,this.vel=t(),this.rot=0,this.rotVel=0,this.radius=.25,this.hit=0,this.life=1}function w(a,i){this.world=a,this.pos=i,this.vel=t(0),this.head=this.pos,this.pawsOffset=[t(1,-2),t(5,-2),t(5,2),t(1,2)],this.paws=[],this.pawsTargets=[];for(let a=0;a<4;a++)this.paws[a]=this.pos.add(this.pawsOffset[a]),this.pawsTargets[a]=this.paws[a];this.headR=1,this.pawR=.6,this.bodyR=1.3,this.legL=5,this.dead=!1,this.path=null,this.pathTimer=0}function g(){let a,s;this.time=0,this.cam={pos:t(),rot:0,zoom:20},this.cheese=[],this.grid="\naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa\na                                   a                                 a\na                                   a                                 a\na                                   a                                 a\na                                                                     a\na                                                                c    a\na                                   a                                 a\na                                   a                                 a\na                                  aa                                 a\na                                  aaaaaaaaaaa  a   a   a             a\na                                  a         a  a   a   a             a\na                                  a         a  a   a   a             a\na             aaaaaaaaaaa          a         a  a   a   a             a\na             a         a          a         a  a   a   a             a\na             a         a          a         a  a   a   a             a\na             a         a          a         a  a   a   aa            a\na             a  aaaaa  a          a         a  a   a    a            a\na       c     a     aa  a          a         a  a   aa   aa           a\na             a     ca  a          a         a  a   aa    a           a\na             a     aa  a          a         a  a    a    aa          a\na             aaaaaaaa  a          a            a    aa    a          a\na                       a          a            a     a    a          a\na                       a          a            a  c  aa   aa         a\na    aaaaaaaaaaaaaaaaaaaa          a            a      a    a         a\na    a                                          a      aa   a         a\na    a                                          aaa    aa c a         a\na    a                                           aaa    a   aa        a\na    aaaaaaaaaa                                   aaa   a    a        a\na                                                  aaa  aa   a        a\na                                                    a   a   a        a\na                            aaaaaaaaaaaaaaaaa       a   a   a        a\na              a             a               a           a   a        a\naaaaaaaaaa     a             a               a         c a   a        a\na              a             a               a           a   a        a\na b            a             a   a       a   aaa  aaaaaaaa   a        a\na              a  aaaaaaaaa  a   a       a   a               a        a\na              a             a   a       a   a               aaaa     a\na              a             a   a   h   a   a                        a\na              a             a   a       a   a                        a\na              a             a   a       a   a                        a\na              a             a   aaaaaaaaa   a                        a\na              a             a      aaa      a                        a\na                      a            aaa            a                  a\na                      a            aaa            a                  a\na                      a            aaa            a                  a\na                      a            aaa            aaaaaaaaaaa        a\na           m          a            aaa            a                  a\na               c      a            aaa            a                  a\na                      aaaaaaaaaaaaaaaaaaaaaaaaaaaaa                  a\na     aaaaaaa               a                                         a\na          ca               a                                a a a    a\na           a               a                                         a\na           a               a                                a c a    a\na           a               a                                         a\naaaaaaa     a               a                                a a a    a\na  c  a     a       aaaa  aaa       a                                 a\na     a     a       a               a                                 a\na     a     a       a               a                                 a\na     a     a       a               a      aaaaaaaaaaaaaaaa           a\na     a     a       a               a      a              aaaaaaaaaaaaa\na     a     a                       a      a\na     a     a                       a      a\na     a     a                       a      a\na     a                             a      a\na     a                             a      a\na     a                                    a\na     a                                    a\na     aaaaaaaaaaaaaaaaaaaaa                a\na                                          a\na                                          a\na                                          a\naaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa                           ".trim().split("\n").map(a=>[...a]);for(let h=0;h<this.grid.length;h++)for(let e=0;e<this.grid[h].length;e++){let o=this.grid[h][e],l=t(e+.5,h+.5).mul(i);"c"==o&&(this.cheese.push(l),this.grid[h][e]=" "),"h"==o&&(this.hole=l,this.grid[h][e]=" "),"b"==o&&(a=l,this.grid[h][e]=" "),"m"==o&&(s=l,this.grid[h][e]=" ")}this.weightedGrid=function(a){const t=a.length,i=t?a[0].length:0,s=Array.from({length:t},()=>Array(i).fill(1e9)),h=[];for(let e=0;e<t;e++)for(let t=0;t<i;t++)"a"===a[e][t]&&(s[e][t]=0,h.push([t,e]));for(let a=0;a<h.length;a++){const[e,o]=h[a],l=s[o][e]+1;[[1,0],[-1,0],[0,1],[0,-1]].forEach(([a,n])=>{const r=e+a,d=o+n;r>=0&&r<i&&d>=0&&d<t&&s[d][r]>l&&(s[d][r]=l,h.push([r,d]))})}const e=Array.from({length:t},()=>Array(i).fill(0));for(let h=0;h<t;h++)for(let t=0;t<i;t++){const i=s[h][t];e[h][t]="a"===a[h][t]?10:i<=5?10*(1-i/5):0}return e}(this.grid),console.log(this.weightedGrid),this.mouse=new y(this,s),this.cat=new w(this,a),this.objects=[this.mouse,this.cat],this.cheeseR=.6,this.holeR=2}function m(){this.world=new g,this.lastUpdateTime=null}window.addEventListener("keydown",function(a){u[a.code]=!0,["ArrowDown","ArrowUp","ArrowLeft","ArrowRight"].indexOf(a.code)>-1&&a.preventDefault()}),window.addEventListener("keyup",function(a){u[a.code]=!1}),y.prototype.update=function(a){let i=this.life>-.5,s=i?d(this.rot,(u.ArrowUp?15:0)-(u.ArrowDown?5:0)):t(),h=i?.06*((u.ArrowRight?1:0)-(u.ArrowLeft?1:0)):0;this.rotVel+=(h-this.rotVel)*n(a,.9,.2),this.rot+=this.rotVel,this.vel=r(this.vel,s,a,.9,.2);let e=this.pos.copy();for(let a of this.world.cat.paws){let t=this.pos.sub(a),s=this.radius+this.world.cat.pawR;i&&t.length()<s&&this.hit<0&&(this.pos=a.add(t.normalize().mul(s+.2*this.radius)),this.hit=.2,this.life-=.2,console.log(this.life))}for(let a=this.world.cheese.length-1;a>=0;a--)this.world.cheese[a].sub(this.pos).length()<this.radius+this.world.cheeseR&&this.world.cheese.splice(a,1);let o=this.pos.add(this.vel.mul(a));this.pos=c(e,o,this.radius,this.world.grid),this.vel=this.pos.sub(e).mul(1/a),this.hit-=a,i&&(this.life=Math.min(this.life+.05*a,1))},y.prototype.draw=function(a){h.globalAlpha=this.life>.2?this.life:.2*(this.life+.5)/.7,h.fillStyle=this.hit>0?"white":"rgb(185, 185, 185)",h.beginPath();let t=l(this.pos,a);h.arc(t.x,t.y,this.radius*a.zoom,this.rot-a.rot+Math.PI/2,this.rot-a.rot+3*Math.PI/2);let i=1.2*this.radius,s=l(this.pos.add(d(this.rot,i)),a);h.lineTo(s.x,s.y),h.closePath(),h.fill()},w.prototype.update=function(a){let s=this.world.hole;if(0==this.world.cheese.length&&this.pos.sub(s).length()<this.bodyR&&(this.dead=!0),this.dead){this.head=r(this.head,s,a,.9,.4),this.pos=r(this.pos,s,a,.9,.4);for(let t=0;t<4;t++)this.paws[t]=r(this.paws[t],s,a,.9,.4);return}if(this.pathTimer-=a,null==this.path||this.pathTimer<0){let a=t(Math.floor(this.pos.x/i),Math.floor(this.pos.y/i)),s={x:Math.floor(this.world.mouse.pos.x/i),y:Math.floor(this.world.mouse.pos.y/i)};this.path=function(a,t,i,s){const h=a.length,o=h?a[0].length:0;if(!h||!o)return null;function l(a,t){return a>=0&&a<o&&t>=0&&t<h}function n(t,i){return"a"!==a[i][t]}function r(a,t,i,s){return Math.hypot(i-a,s-t)}if(!l(i.x,i.y)||!l(s.x,s.y))return null;if(!n(i.x,i.y)||!n(s.x,s.y))return null;const d=Array.from({length:h},()=>Array(o).fill(null)),p=Array.from({length:h},()=>Array(o).fill(1/0));p[i.y][i.x]=0;const f=new e;f.push(r(i.x,i.y,s.x,s.y),i);const c=[{dx:1,dy:0,cost:1},{dx:-1,dy:0,cost:1},{dx:0,dy:1,cost:1},{dx:0,dy:-1,cost:1},{dx:1,dy:1,cost:Math.SQRT2},{dx:1,dy:-1,cost:Math.SQRT2},{dx:-1,dy:1,cost:Math.SQRT2},{dx:-1,dy:-1,cost:Math.SQRT2}];for(;!f.isEmpty();){const a=f.pop();if(a.x===s.x&&a.y===s.y){const t=[];let i=a;for(;i;)t.push({x:i.x,y:i.y}),i=d[i.y][i.x];return t.reverse()}for(const i of c){const h=a.x+i.dx,e=a.y+i.dy;if(!l(h,e)||!n(h,e))continue;const o=t[e][h]||0,c=i.cost*(1+o/10*10),u=p[a.y][a.x]+c;if(u<p[e][h]){p[e][h]=u,d[e][h]=a;const t=u+r(h,e,s.x,s.y);f.push(t,{x:h,y:e})}}}return null}(this.world.grid,this.world.weightedGrid,a,s),this.pathTimer=Math.min(this.path.length/5,3)}let h=this.world.mouse.pos.sub(this.pos),l=h;if(this.path.length>2){let a=t(this.path[0].x,this.path[0].y).mul(i).sub(this.pos);a.length()<this.bodyR+i&&this.path.splice(0,1),l=a}let n=l.normalize().mul(12);this.vel=r(this.vel,n,a,.9,.5),this.pos=c(this.pos,this.pos.add(this.vel.mul(a)),this.bodyR,this.world.grid);let d=this.pos.add(this.vel.normalize().mul(6));this.head=c(this.head,r(this.head,d,a,.8,.5),this.headR,this.world.grid),this.head.sub(d).length()>2*this.legL&&(this.head=d);for(let t=0;t<4;t++){let i=this.pos.add(o(this.pawsOffset[t],Math.atan2(this.vel.y,this.vel.x)));this.paws[t].sub(i).length()>this.legL&&(this.pawsTargets[t]=(1==t||2==t)&&h.length()<1.5*this.legL?this.world.mouse.pos:i),this.paws[t]=c(this.paws[t],r(this.paws[t],this.pawsTargets[t],a,.8,.1),this.pawR,this.world.grid),this.paws[t].sub(this.pawsTargets[t]).length()>2*this.legL&&(this.paws[t]=this.pawsTargets[t])}},w.prototype.draw=function(a,i){i&&(h.globalAlpha/=2,a.pos.x+=i),h.fillStyle="black",h.beginPath();let s=l(this.head,a);h.arc(s.x,s.y,this.headR*a.zoom,0,2*Math.PI),h.fill(),h.beginPath();let e=l(this.pos,a);h.arc(e.x,e.y,this.bodyR*a.zoom,0,2*Math.PI),h.fill(),h.beginPath(),h.moveTo(s.x,s.y),h.lineTo(e.x,e.y),h.stroke();let o=this.vel.normalize(),n=t(-o.y,o.x);h.lineWidth=.6*a.zoom,h.lineCap=h.lineJoin="round",h.beginPath(),h.moveTo(e.x,e.y);for(let t=0;t<10;t++){let i=l(this.pos.sub(o.mul(this.bodyR+.25*t)).add(n.mul(.1*t*Math.sin(.5*t+2*this.world.time))),a);h.lineTo(i.x,i.y)}h.stroke(),i&&(a.pos.x-=i);for(let t of this.paws){h.beginPath();let i=l(t,a);h.arc(i.x,i.y,this.pawR*a.zoom,0,2*Math.PI),h.fill(),h.lineWidth=.6*a.zoom,h.beginPath(),h.moveTo(e.x,e.y),h.lineTo(i.x,i.y),h.stroke()}i&&(h.globalAlpha*=2)},g.prototype.update=function(a){for(object of(this.cam.rot+=(this.mouse.rot+Math.PI/2-this.cam.rot)*n(a,.95,.8),this.cam.pos=r(this.cam.pos,this.mouse.pos.add(d(this.mouse.rot,1)),a,1,.5),this.objects))void 0!==object.update&&object.update(a);this.time+=a},g.prototype.draw=function(){h.fillStyle="rgb(62, 52, 40)",h.fillRect(0,0,s.width,s.height),this.drawGrid(!0),h.fillStyle=this.cheese.length>0?"rgb(85, 85, 85)":"black",h.beginPath();let a=l(this.hole,this.cam);h.arc(a.x,a.y,this.cam.zoom*this.holeR,0,2*Math.PI),h.fill(),h.fillStyle="rgb(245, 233, 104)";for(let t of this.cheese)h.beginPath(),a=l(t,this.cam),h.arc(a.x,a.y,this.cam.zoom*this.cheeseR,0,2*Math.PI),h.fill();for(object of(this.cat.draw(this.cam,.6),this.objects))void 0!==object.draw&&object.draw(this.cam);let t=this.cam.zoom;for(let a=1;a<30;a++)this.cam.zoom=t*(1+.03*a),this.drawGrid(!1);this.cam.zoom=t},g.prototype.drawGrid=function(a){for(let s=0;s<this.grid.length;s++)for(let e=0;e<this.grid[s].length;e++){let o=this.grid[s][e];if(" "!=o||a){h.fillStyle=" "!=o?"rgb(62, 52, 40)":(s+e)%2==0?"rgb(125, 118, 100)":"rgb(145, 137, 116)",h.beginPath();let a=[[0,0],[0,1],[1,1],[1,0]];for(let o=0;o<a.length;o++){let n=t(e,s).add(t(a[o][0],a[o][1])),r=l(n.mul(i),this.cam);0==o?h.moveTo(r.x,r.y):h.lineTo(r.x,r.y)}h.fill()}}},m.prototype.loop=function(){const a=Date.now(),t=null==this.lastUpdateTime?1e3/60:a-this.lastUpdateTime;this.lastUpdateTime=a;const i=Math.min(.1,t/1e3);this.world.update(i),this.world.draw(),h.fillStyle="white",h.textAlign="center",h.textBaseline="middle",h.font="30px Verdana";let e=this.world.cheese.length;this.world.cat.dead||h.fillText(e>0?e+" cheese left":"Guide Cat into hole",s.width/2,100),this.world.time<3&&h.fillText("Use Arrow Keys",s.width/2,300),this.world.mouse.life<-.5?(h.fillText("R to restart",s.width/2,s.height/2+30),h.font="60px Verdana",h.fillText("Game Over",s.width/2,s.height/2-40),u.KeyR&&(this.world=new g)):this.world.cat.dead&&(h.font="60px Verdana",h.fillText("You Win!!!",s.width/2,s.height/2-40)),requestAnimationFrame(this.loop.bind(this))};let x=new m;requestAnimationFrame(x.loop.bind(x))</script>