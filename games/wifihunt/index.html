<!doctype html><title>WiFiHunt - js13kGames 2018</title><meta name=viewport content="width=device-width"><style>body{font-family:Helvetica,sans-serif;margin:0}canvas{background:silver;display:block;width:100vw;height:100vh}footer{text-align:center;margin-top:1em}</style><canvas height=800px></canvas><script>const g={init(t){t=this.canvas=document.getElementById(t)||t||document.querySelector("canvas"),this.context=t.getContext("2d")},_noop:new Function,_tick:new Function};function m(t,e){return Math.round(t*10**e)/10**e}function k(t){return m(t*(Math.PI/180),4)}function b(t,e){return t=k(t),[Math.cos(t),Math.sin(t)].map(t=>m(e*t,4))}g.gameLoop=function(t){let e=(t=t||{}).fps||60,i=0;const n=1e3/e,o=1/e,s=!1===t.clearCanvas?g._noop:function(){g.context.clearRect(0,0,g.canvas.width,g.canvas.height)};let d,a,r,c;function l(){if(a=requestAnimationFrame(l),r=performance.now(),c=r-d,d=r,!(1e3<c)){for(g._tick(),i+=c;i>=n;)h.update(o),i-=n;s(),h.render()}}let h={update:t.update,render:t.render,isStopped:!0,start(){d=performance.now(),this.isStopped=!1,requestAnimationFrame(l)},stop(){this.isStopped=!0,cancelAnimationFrame(a)}};return h};{const m={};let n={};const b={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};for(let t=0;t<26;t++)b[65+t]=(10+t).toString(36);for(i=0;i<10;i++)b[48+i]=""+i;addEventListener("keydown",function(t){var e=b[t.which];n[e]=!0,m[e]&&m[e](t)}),addEventListener("keyup",function(t){n[b[t.which]]=!1}),addEventListener("blur",function(t){n={}}),g.keys={bind(t,e){[].concat(t).map(t=>{m[t]=e})},unbind(t,e){[].concat(t).map(t=>{m[t]=e})},pressed:t=>!!n[t]}}{class m{constructor(t,e){this._x=t||0,this._y=e||0}add(t,e){this.x+=(t.x||0)*(e||1),this.y+=(t.y||0)*(e||1)}clamp(t,e,i,n){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=n}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}g.vector=(t,e)=>new m(t,e),g.vector.prototype=m.prototype;class i{init(t,e,i,n){for(e in t=t||{},this.position=g.vector(t.x,t.y),this.velocity=g.vector(t.dx,t.dy),this.acceleration=g.vector(t.ddx,t.ddy),this.width=this.height=0,this.context=g.context,t)this[e]=t[e];if(i=t.image)this.image=i,this.width=i.width,this.height=i.height;else if(i=t.animations){for(e in i)this.animations[e]=i[e].clone(),n=n||i[e];this._ca=n,this.width=n.width,this.height=n.height}return this}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return 0<this.ttl}collidesWith(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this._ca=this.animations[t],this._ca.loop||this._ca.reset()}advance(t){this.velocity.add(this.acceleration,t),this.position.add(this.velocity,t),this.ttl--,this._ca&&this._ca.update(t)}draw(){this.image?this.context.drawImage(this.image,this.x,this.y):this._ca?this._ca.render(this):(this.context.fillStyle=this.color,this.context.fillRect(this.x,this.y,this.width,this.height))}}g.sprite=t=>(new i).init(t),g.sprite.prototype=i.prototype}class t{constructor(t,e){this.x=t,this.y=e}distanceTo(t){return Math.sqrt((this.x-t.x)**2+(this.y-t.y)**2)}}class e{constructor(t){this.ssid=t.ssid,this.centre=t.centre,this.radius=t.radius,this.speed=t.speed,this.jitter=t.jitter,this.encryption=t.encryption,this.password=t.password,this.cost=t.cost}isInRange(t){return t.distanceTo(this.centre)<=this.radius}speedAt(t,e){if(["download","upload"].includes(e))return t=t.distanceTo(this.centre),(t=this.speed[e]/(t+.01)**2)<0?0:t;throw new Error(`Invalid speed type '${e}'`)}}const _=[{ssid:"Verizon WiFi",centre:new t(2,3),radius:40,speed:{download:2,upload:1}},{ssid:"McDonald's Wifi",centre:new t(25,18),radius:15,speed:{download:7,upload:14}},{ssid:"Average Joe's iPhone",centre:new t(9,-8),radius:7.5,speed:{download:3,upload:5}},{ssid:"NETGEAR68",centre:new t(-4,5),radius:24,speed:{download:8,upload:5}},{ssid:"Who wants free WiFi",centre:new t(45,3),radius:24,speed:{download:1,upload:1},password:2208706,encryption:"WEP"},{ssid:"Free WiFi Initiative",centre:new t(18,-24),radius:100,speed:{download:.5,upload:1}},{ssid:"Prada WiFi",centre:new t(-16,0),radius:40,speed:{download:10,upload:10},cost:240},{ssid:"AndroidAP",centre:new t(29,-15),radius:15,speed:{download:7.5,upload:.78125}},{ssid:"Linksys",centre:new t(-5,7),radius:30,speed:{download:10,upload:20}},{ssid:"PuzzleConf",centre:new t(8,24),radius:24,speed:{download:8,upload:15}},{ssid:"Azure Diamond",centre:new t(14,-10),radius:35,speed:{download:10,upload:20},password:1265856690,encryption:"WPA2"},{ssid:"Hyatt",centre:new t(18,24),radius:20,speed:{download:10,upload:10},cost:300},{ssid:"xfinitywifi",centre:new t(-19,28),radius:20,speed:{download:5,upload:15}},{ssid:"xfinitywifi",centre:new t(40,-5),radius:40,speed:{download:5,upload:15},cost:160},{ssid:"Muller home",centre:new t(-7,-7),radius:33,speed:{download:4,upload:8}},{ssid:"Airtel",centre:new t(-80,50),radius:80,speed:{download:20,upload:20}},{ssid:"Junk",centre:new t(-17,18),radius:60,speed:{download:2,upload:14},cost:50},{ssid:"SystemAdmin",centre:new t(20,20),radius:30,speed:{download:5,upload:6}},{ssid:"🐌",centre:new t(0,0),radius:100,speed:{download:.25,upload:.25}},{ssid:"⏩",centre:new t(57.1,57.1),radius:.5,speed:{download:100,upload:100}},{ssid:"shreyas",centre:new t(75,40),radius:40,speed:{download:20,upload:20},password:1064706847,encryption:"WPA2 Personal"}].map(t=>new e(t)),M=["left","right","up","down","a","d","w","s"];let S=null;const A=new t(0,0);let T=90,R=!1,P=!1,E=0;window.onload=()=>{g.init();const e=g.gameLoop({fps:50,update(){t.update(),o.update(),i.update(),s.update(),null===S||S.isInRange(A)||(S=null)},render(){if(g.context.save(),c.render(),t.render(),o.render(),i.render(),n.render(),s.render(),d.render(),r.render(),P&&v({width:355,height:140},t=>{g.context.fillText("GAME PAUSED.",t.x+15,t.y+55),g.context.fillText("Press 'P' to unpause.",t.x+15,t.y+100)}),R){const a=f(A);v({width:355,height:82+25*a.length},(e,i)=>{g.context.fillText("Available Networks:",e.x+25,e.y+44);let n=75;for(let t=0;t<a.length;t++){var o=a[t],s=(g.context.fillStyle=E===t?"hsl(0, 0%, 75%)":"white",g.context.fillText(o.ssid,e.x+25,e.y+n),e.x+i.width-25-19),d=void 0!==o.password,o=0<o.cost;d&&g.context.fillText("🔒",s,e.y+n),o&&g.context.fillText("💰",s,e.y+n),n+=25}})}}}),t=(g.canvas.width=window.innerWidth-15,g.canvas.height=window.innerHeight,y(),g.keys.bind("p",u),g.keys.bind("n",x),e.start(),g.sprite({render(){var t=new Image;t.src="p.png",g.context.drawImage(t,(g.canvas.width-t.width)/2,g.canvas.height-t.height-20)}})),o=g.sprite({level:100,dropRate:{active:.3,idle:.1},update(){var t;o.dropRate.current=R?o.dropRate.active:o.dropRate.idle,P||(t=o.dropRate.current/50,o.level-=t),o.level<0&&(o.level=0,e.stop())},render(){g.context.strokeStyle="gray",g.context.strokeRect(25,25,30,19),g.context.fillStyle="gray",g.context.fillRect(55,30.5,3,8);var t=[139,0,0],e=[34,228,71],i=o.level/100,n=1-i,t=[Math.round(t[0]*n+e[0]*i),Math.round(t[1]*n+e[1]*i),Math.round(t[2]*n+e[2]*i)];g.context.fillStyle=`rgb(${t.join(", ")})`,g.context.fillRect(25,25,o.level/100*30,19),g.context.fillStyle="black",g.context.font="19px monospace",g.context.fillText(Math.ceil(o.level)+"%",70,44)}}),i=g.sprite({render(){null!==S?(g.context.strokeStyle="black",g.context.fillStyle="black"):(g.context.strokeStyle="gray",g.context.fillStyle="gray");var e=k(-50),i=k(-130);for(let t=10;t<=20;t+=5)g.context.beginPath(),g.context.arc(40,90,t,e,i,!0),g.context.stroke();g.context.beginPath(),g.context.arc(40,90,5,e,i,!0),g.context.lineTo(40,90),g.context.fill(),null!==S&&(g.context.font="19px monospace",g.context.fillText(S.ssid,70,90))}}),n=g.sprite({remaining:500,render(){g.context.fillStyle="hsl(50, 90%, 40%)",g.context.font="19px monospace",g.context.fillText("💰",25,130),g.context.fillStyle="black",g.context.fillText(n.remaining,70,130)}}),s=g.sprite({download:2048,upload:1024,update(){null!==S&&(s.download-=S.speedAt(A,"download")/50,s.upload-=S.speedAt(A,"upload")/50),s.download<0&&(s.download=0),s.upload<0&&(s.upload=0),0===s.download&&0===s.upload&&e.stop()},render(){g.context.fillStyle="black",g.context.font="19px monospace",g.context.fillText(`↓ Goal: ${Math.ceil(s.download)} MiB`,25,190),g.context.fillText(`↑ Goal: ${Math.ceil(s.upload)} MiB`,25,220)}}),d=g.sprite({render(){null!==S&&(g.context.fillStyle="black",g.context.font="19px monospace",g.context.fillText(`↓ Speed: ${Math.ceil(1024*S.speedAt(A,"download"))} KiB/s`,25,270),g.context.fillText(`↑ Speed: ${Math.ceil(1024*S.speedAt(A,"upload"))} KiB/s`,25,300))}}),r=g.sprite({render(){g.context.font="16px monospace",g.context.fillText(`(${m(A.x,2)}, ${m(A.y,2)})`,25,g.canvas.height-20),g.context.fillText(T+"°",25,g.canvas.height-45)}}),c=g.sprite({width:g.canvas.width/3,render(){g.context.save(),g.context.translate(g.canvas.width/2,g.canvas.height-80),g.context.rotate(k(-(90-T))),g.context.translate(-g.canvas.width/2,-(g.canvas.height-80));var t=Math.abs(Math.sin(k(T)+.1));g.context.fillStyle="hsl(220, 2%, 35%)",g.context.fillRect(c.width,-300,c.width,g.canvas.height/t+300+100),g.context.fillStyle="white";for(let t=10*(A.y%200-200);t<=700;t+=200)g.context.fillRect((g.canvas.width-25)/2,t,25,100);g.context.restore(),g.context.font="200px monospace";let e=c.width-190,i=c.width+c.width-100;for(let t=0;t<=g.canvas.height+100;t+=150)g.context.fillText("🌳",e-100*Math.cos(T),t+50),g.context.fillText("🌳",i-100*Math.cos(T),t),e-=150*Math.tan(k(90+T)),i-=175*Math.tan(k(90+T))}});function a(){var[t,e]=b(T,1);A.x+=t,A.y+=e}function l(){var[t,e]=b(T,1);A.x-=t,A.y-=e}function h(){T%5!=0&&(T+=1),T<180&&(T+=5)}function p(){T%5!=0&&(T+=1),0<T&&(T-=5)}function u(){P?(P=!1,y(),g.keys.bind("n",x)):(P=!0,g.keys.unbind([...M,"n","h"]))}function x(){R?w():(R=!0,E=0,g.keys.unbind([...M,"p","h"]),g.keys.bind("down",()=>{E<f(A).length-1&&E++}),g.keys.bind("up",()=>{0<E&&E--}),g.keys.bind("enter",()=>{var t=f(A)[E];if(void 0!==t.cost&&0<t.cost){if(!window.confirm(`Do you wish to pay ${t.cost} to use this network?`))return;if(!(n.remaining>=t.cost))return void alert("You don't have enough money to afford this network");n.remaining-=t.cost,t.cost=0}void 0!==t.password&&prompt(`Enter a ${t.encryption} password:`).split("").reduce((t,e)=>(t<<5)-t+e.charCodeAt(0)|0,0)!==t.password?alert("You entered an incorrect password"):(S=t,w())}))}function w(){R=!1,g.keys.unbind(["down","up","enter"]),y(),g.keys.bind("p",u)}function y(){g.keys.bind(["up","w"],a),g.keys.bind(["down","s"],l),g.keys.bind(["left","a"],h),g.keys.bind(["right","d"],p)}function f(e){return _.filter(t=>t.isInRange(e))}function v(t,e){g.context.fillStyle="hsla(0, 0%, 0%, 0.25)",g.context.fillRect(0,0,g.canvas.width,g.canvas.height);var i={x:(g.canvas.width-t.width)/2,y:(g.canvas.height-t.height)/2};g.context.fillStyle="hsl(218, 9%, 17%)",g.context.fillRect(i.x,i.y,t.width,t.height),g.context.fillStyle="white",g.context.font="19px monospace",e(i,t)}}</script>