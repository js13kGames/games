g=function(e){function o(e){var i={co:e?e.split(","):[],id:r++,on:f,t:c};t.push(i);for(var s in i.co){var o=i.co[s];!n[o]||n[o](i)}return i}function u(e,t){n[e]=t;var r=a(e);for(var i in r)t(r[i])}function a(e){var n=[];for(var r in t)for(var i in t[r].co)t[r].co[i]==e&&n.push(t[r]);return n}function f(e,t){return i[e]||(i[e]=[]),i[e].push({context:this,callback:t}),this}function l(e,t,n){return i[e]||(i[e]=[]),i[e].push({component:t,callback:n}),this}function c(e){if(!i[e])return this;var t=Array.prototype.slice.call(arguments,1);for(var n=0,r=i[e].length;n<r;n++){var s=i[e][n];if(s.context)s.callback.apply(s.context,t);else{var o=a(s.component);for(var u in o)s.callback.apply(o[u],t)}}return this}function h(e){e=e||1e3/60,s=!0,p(e)}function p(e){s&&(c("update",e),c("predraw"),c("draw"),c("postdraw"),setTimeout(function(){p(e)},e))}var t=[],n={},r=1,i={},s=!1;return e.onmousedown=function(e){e.isRightClick=e.which?e.which==3:e.button?e.button==2:!1,c("mousedown",e)},e.onmouseup=function(e){c("mouseup",e)},e.onmousemove=function(e){c("mousemove",e)},onkeydown=function(e){return c("keydown",e,e.keyCode),!1},onkeyup=function(e){return c("keyup",e,e.keyCode),!1},{e:o,c:u,cs:l,f:a,r:h,s:function(){s=!1}}},u={u:function(e,t){return t=t||0,Math.random()*(e-t)+t},r:function(e,t){return t=t||0,Math.floor(Math.random()*(e-t)+t)}},tt=function(e,t){function a(){i=!1,n.style.display="none",s&&s()}var n=e.getElementById("tt"),r=t.e("tooltip"),i=!1,s,o,u=['<div>Welcome to <em>At Sea</em>! You are a fisherman at sea trying to get the catch of your life. This is a game created for the <a href="http://js13kgames.com" target="_blank">js13kgames competition</a> by <a href="http://scottheckel.com">Scott Heckel</a>.<br><br>Move your ship with<br><br>Buy and sell items at islands with<br><br>Start fishing with<br><br></div><div id="kL">&#9668;</div><div id="kR">&#9658;</div><div id="kF">F</div><div id="kB">B</div>','<div style="text-align:center">To the left is a fuel gauge. Don\'t run out of gas.</div>','<div style="text-align:center">At the top is the map. As you discover islands they will appear here. You can also purchase a map at an island to reveal the entire world.</div>',"Congratulations on purchasing the sensor!  The sensor is on the right of your fuel gauge.  Watch it's level to tell if this area contains a high concentratoin of fish.","You will need to be patient reeling in your catch.<br><br>Fill up the catch bar on the right by hitting the <strong>'SPACEBAR'</strong> when your pointer is over a fishes 'sweet' spot on the circle.","The fish got away!","You have discovered your first island.  Use the <strong>'B'</strong> key to buy and sell items on the island.","You went a little too far away from home and ran out of gas.  Coincidentally, your radio is also broken, so you will remain forever lost at sea."];n.onclick=function(){a()},r.on("keydown",function(e,t){i&&(t==13||t==27||t==32)&&t!=o&&a()}).on("keyup",function(e,t){i&&o&&o==t&&(o=null)}).on("mousedown",function(){i&&a()}).on("tooltip",function(e,r,a,f,l,c,h){s=l,o=h;var p=t.f("camera")[0];f||(f=f||p.w),r||(r=p.w/2-f/2),a||(a=Math.max(p.h/2-150,20)),n.innerHTML=(c||u[e])+'<p class="ok">Ok</p>',n.style.top=a,n.style.left=r,n.style.width=f,i=!0,n.style.display=""})},f=function(e,t,n){function k(e,t){return t.s<=e&&t.s+t.l>=e||t.s<=e+d&&t.s+t.l>=e+d}function L(){T=b,r.style.display="none"}var r=e.getElementById("f"),i=e.getElementById("h"),s=e.getElementById("i"),o=e.getElementById("g"),u=o.getContext("2d"),a=t.e("fishing"),f=!1,l=[],c=0,h=0,p=3e3,d=Math.PI*2,v="rgb(0,0,0)",m,g,y,b=0,w=1,E=2,S=3,x=4,T=b,N=!0,C;o.height=o.width=350,a.on("update",function(e){function r(e,t){return e+=t,e<0&&(e+=d),e>=d&&(e-=d),e}if(T!=w)return;y=m=0;if(f)if(k(c,l[0])||k(c,l[1])){h+=e*2;if(!g){var t=o.height/2;g=u.createRadialGradient(t,t,10,t,t,t),g.addColorStop(.6,"#0F0"),g.addColorStop(1,"#00C100")}m=y=g}else h-=e,m="#C00";c+=.05,c=c>=d?c-d:c,h>=p&&(T=S,a.t("tooltip",-1,0,0,300,function(){L(),a.t("catch",C)},"Congratulations! You just caught a <strong>"+C.n+"</strong>.",f?32:null)),h<=0&&(T=E,a.t("tooltip",5,0,0,300,function(){L(),a.t("gotaway")},0,f?32:null)),h-=e/10,n.r(1e3)>990&&(l[0].d=-l[0].d),n.r(1e3)>990&&(l[1].d=-l[1].d),l[0].s=r(l[0].s,l[0].d),l[0].e=r(l[0].e,l[0].d),l[1].s=r(l[1].s,l[1].d),l[1].e=r(l[1].e,l[1].d)}).on("draw",function(){if(!T)return;var e=o.height/2;u.clearRect(0,0,o.width,o.height),u.beginPath(),u.lineWidth=1,u.strokeStyle=v,u.arc(e,e,e-30,0,d,!1),u.stroke(),l.forEach(function(t){u.beginPath(),u.lineWidth=30,u.strokeStyle=y||v,u.arc(e,e,e-u.lineWidth,t.s,t.e,!1),u.stroke()}),u.fillStyle=m||v,u.beginPath(),u.arc(e,e,e,c-.05,c+.05,!1),u.lineTo(e,e),u.fill(),s.style.height=h/p*300}).on("keydown",function(e,t){if(T!=w)return;f=t==32}).on("keyup",function(e,t){if(T!=w)return;f&=t!=32,f||(y=0),t==27&&(T=E,a.t("tooltip",5,0,0,300,function(){L(),a.t("gotaway")}))}).on("fish",function(e,t,i,s){if(T)return;var o=t.c,u=n.u(t.tc),p=0,v=0;for(var m in t.c){v+=t.c[m];if(v>=u){p=m;break}}C=e[p],s=C.d+i,l=[],l[0]={s:n.u(d,0)},l[0].e=l[0].s+s,l[0].d=n.u(.07,.01)-.035,l[1]={s:n.u(l[0].s+d-s,l[0].e)},l[1].s=l[1].s>d?l[1].s-d:l[1].s,l[1].e=l[1].s+s,l[1].d=n.u(.07,.01)-.035,l[0].l=l[1].l=s,T=w,f=c=0,h=1e3,r.style.display="",N&&(T=x,N=!1,a.t("tooltip",4,20,0,300,function(){T=w}))})},m=function(e,t,n){function d(e){i.style.display=l.style.display=e?"none":"",s.style.display=a.style.display=f.style.display=e?"":"none"}function v(){h=!0,r.style.display="none",c.t("start")}function m(e,t,n,r,i){function b(o){var u=this.getAttribute("data-f"),f=this.getAttribute("data-p"),l=this.getAttribute("data-q");d(!0),s.innerHTML="Would you like to sell <strong>"+l+" "+u+"</strong> for <strong>$"+f*l+"</strong>?",a.innerHTML="Sell",a.onclick=function(){c.t("sell",u,f),m(e,t,n,r,i),d(!1)}}function w(o){var u=this.getAttribute("data-i"),f=this.getAttribute("data-p");d(!0),e.u>=f?u==4&&!e.i.i[3]||u==7&&!e.i.i[6]||u==12&&!e.i.i[11]?(o="You do not have the prior requirement for this item.",a.style.display="none"):(o="<div>Would you like to purchase a <strong>",u>0?o+=r[u]:o+=e.deltaF+" units of gas",o+="</strong> for <strong>"+f+"</strong>.</div><div><br><strong>Description:</strong> "+p[u]+"</div>",a.innerHTML="Buy"):(o="You have insufficient funds to purchase "+r[u]+".",a.style.display="none"),s.innerHTML=o,a.onclick=function(){c.t("buy",u,f),m(e,t,n,r,i),d(!1)}}var f="",l=0;for(var h in n){var v=n[h].n,g=e.i.f[v];g&&(f+='<li data-f="'+v+'" data-p="'+n[h].p+'" data-q="'+g+'"><span>'+n[h].p*g+"</span>"+g+"x "+v+"</li>",l++)}l||(f+="<li>Nothing to Sell.</li>"),u.innerHTML=f,f="";for(var y in r)t.i.i[y]&&!e.i.i[y]&&(f+='<li data-i="'+y+'" data-p="'+i[y]+'"><span>'+i[y]+"</span>"+r[y]+"</li>");o.innerHTML=f;if(l>0)for(var E=0;E<u.children.length;E++)u.children[E].onclick=b;for(var S=0;S<o.children.length;S++)o.children[S].onclick=w}var r=e.getElementById("m"),i=e.getElementById("list"),s=e.getElementById("detail"),o=e.getElementById("b"),u=e.getElementById("s"),a=e.getElementById("ok"),f=e.getElementById("cancel"),l=e.getElementById("x"),c=t.e("menu"),h=!0,p=["Ten units of gas to help you travel the seas.","One hundred units of gas to help you travel the seas.","","Put a little extra oomph in your engine.  A little too fast for your Grandma's driving tastes.","This engine is not quite as fast as a jet, but it is fast enough for your needs.","","Help catch fish a little better.","If you can't catch the fish with this then you will never be able to catch it.","Helps you discover when lots of fish are hiding.","Find out where all the islands are in the world.","","Get a little bit further before you have to fill up the tank.","You will (maybe) be able to travel the seven seas and back before you have to fill up again."];f.onclick=function(){d(!1)},l.onclick=v,c.on("menu",function(t,n,i,s,o){h=!1,e.getElementById("t").innerHTML="Welcome to "+n.n,m(t,n,i,s,o),d(!1),r.style.display=""}).on("keydown",function(e,t){!h&&(t==27||t==13)&&v()})},function(e,t,n){function k(e,t){t=u.f("zone");for(var n in t)if(t[n].x<=e&&t[n].x+t[n].w>=e)return t[n];return null}function L(e,t,n,r,s){var o=e<n?e:n,u=t<r?t:r;i.fillStyle=s,i.fillRect(o,u,Math.abs(n-e),Math.abs(r-t))}function A(e,t,n,r){r=5,L(r/2,10+r/2-2*r,c.w-r/2,10+r/2+2*r,"rgba(0,0,0,0.5)");for(var s in e)if(l.i.i[9]||e[s].d)n=Math.floor((e[s].x+e[s].w/2)*c.w/a.length),i.fillStyle=e[s].style,i.fillRect(n-r/2,10,r,r);n=Math.floor((l.x+l.w/2)*c.w/a.length),i.fillStyle="rgb(255,255,0)",i.fillRect(n-r/2,10,r,r)}function O(e){e=l.f/l.maxF,L(10,30,35,130,"rgba(0,0,0,0.5)"),L(10,130-100*e,35,130,e<.3?"rgb(193,0,0)":"rgb(0,193,0)")}function M(){l.i.i[8]&&l.z&&(temp1=l.z.tc/S.length,L(40,30,65,130,"rgba(0,0,0,0.5)"),L(40,130-100*temp1,65,130,"#aaa"))}function _(e,t,r,i){t.c=[],t.length=n.r(5e4,1e4);for(var s=0;s<t.length;)i=e.e("zone"),i.x=s,s=i.x+i.w;var o=k(n.r(t.length)),u=o.tc,a=o.c[o.length-1];o.mc=o.c[o.length-1]=1,o.tc-=a+1;var f=n.r(t.length/800,1);for(i=0;i<f;i++){var l=e.e("city,inventory");l.x=n.r(t.length,0),l.w=n.r(700,200),t.c.push(l)}}function D(e,t){return e+t<c.x||e>c.x+c.w}var r=e.getElementById("c"),i=r.getContext("2d"),s=e.getElementById("z"),o=s.getContext("2d"),u=new t(r),a=u.e("world"),l=u.e("player,move1d,inventory"),c=u.e("camera"),h=u.e("cloud"),p=u.e("cloud"),d=u.e("cloud"),v=u.e("cloud"),g=u.e("cloud"),y,b,w,E=!0,S=[{n:"Rockfish",z:[],p:50,d:2},{n:"Grouper",z:[],p:100,d:1.8},{n:"Snapper",z:[],p:100,d:1.5},{n:"Tuna",z:[],p:500,d:1.1},{n:"Marlin",z:[],p:1e3,d:1},{n:"Sailfish",z:[],p:1e3,d:.9},{n:"Salmon",z:[],p:200,d:1.1},{n:"Ahab",z:[],p:1e6,d:.5}],x=["Gas x10","Gas x100","Small Engine","Large Engine","Super Engine","Small Rod","Large Rod","Magic Rod","Sensor","Map","Small Fuel Tank","Large Fuel Tank","X-Large Fuel Tank"],T=[100,1e3,-1,5e3,15e3,-1,1e4,3e4,1e3,5e3,-1,1e4,2e4],N=["York","Hampshire","Carolina","Dakota","Jersey","Falls","Edwards","Green","Franklin","Athens","Oak","Bern","Berlin","London","Shanghai","Paris","Rio","Seattle","Tokyo","Madison"],C=["North","South","East","West","Isle of","Grand","New","Saint","Fort","Bowling"];f(e,u,n),m(e,u,n),tt(e,u),u.c("camera",function(e){e.x=0,e.y=0}),u.c("cloud",function(e){e.m=new Image,e.m.src="cloud.png"}),u.cs("draw","cloud",function(){i.drawImage(this.m,this.x,this.y,this.w,this.h)}),u.cs("update","cloud",function(e,t){t=500;var r=n.r(t,0);if(this.x+this.w<c.x-t||this.x>c.x+c.w+t)l.a>0&&(this.x=c.x+c.w+r),l.a<0&&(this.x=c.x-this.w-r),this.y=n.r(280-this.h,0)}),u.c("move1d",function(e){e.v=0,e.a=0}),u.cs("update","move1d",function(e){this.v=this.v*this.d+this.a*this.s*.4,this.x+=this.v*(e/1e3),this.x<-c.w&&(this.x=a.length+c.w+l.w-100),this.x>a.length+c.w+l.w&&(this.x=-c.w+100)}),u.c("city",function(e,t,r,i){function s(e){return e.n==i}e.d=!1,e.t=n.r(10),e.t>1&&(t="rgb(0,200,0)",r="rgb(178,139,84)"),e.t||(t="rgb(252,225,139)",r="rgb(221,207,161)"),e.t==1&&(t="rgb(255,255,255)",r="rgb(178,139,84)"),e.style=t,e.style2=r,r=u.f("city");do t=n.r(C.length+5),i=t<C.length?C[t]+" ":"",i+=N[n.r(N.length)];while(r.some(s));e.n=i,e.b=[]}),u.cs("draw","city",function(){if(D(this.x,this.w))return;L(this.x,265,this.x+this.w,280,this.style),L(this.x,280,this.x+this.w,innerHeight,this.style2);for(var e in this.b){var t=this.b[e],n;L(t.x,265-t.h,t.x+51,265,t.c);for(var r=6;r<t.h-10;r+=12.5)n=Math.floor(265-r-4),L(t.x+3,n,t.x+5,n-6,"#000"),L(t.x+13,n,t.x+15,n-6,"#000"),L(t.x+23,n,t.x+25,n-6,"#000"),L(t.x+33,n,t.x+35,n-6,"#000"),L(t.x+43,n,t.x+45,n-6,"#000")}}),u.cs("update","city",function(){this.d|=l.x>=this.x&&l.x<=this.x+this.w||l.x+l.w>=this.x&&l.x+l.w<=this.x+this.w,E&&this.d&&!l.paused&&(E=!1,l.paused=!0,l.t("tooltip",6,0,0,400,function(){l.paused=!1}));if(!this.b.length){var e=n.r(this.w/50,1),t=this.x+(this.w-e*50)/2,r=["#C0C0C0","#999999","#ABABAB","#888888","#DADADA","#362E68","#201B3D","#45305D","#515151","#514B2B","#A5852B","#705A1E","#7E7E7E","#3a3a3a","#EFEFEF"];for(var i=0;i<e;i++)this.b.push({x:t+i*50,h:n.r(7,0)*25,c:r[n.r(r.length)]})}}),u.c("inventory",function(e){e.i={f:{},i:e===l?[0,0,1,0,0,1,0,0,0,0,1,0,0]:[1,1,0,1,1,0,1,1,1,1,0,1,1]};for(var t in S)e.i.f[S[t].n]=0}),u.c("zone",function(e,t){e.c=[],e.mc=e.tc=0;for(var r in S)t=Math.random()*(S[r].d-.47),t=t>1?1:t,e.c.push(t),e.tc+=t,e.mc=t>e.mc?t:e.mc;e.w=n.r(1500,200)}),u.cs("draw","zone",function(){this.mc>.75}),_(u,a,S),a.at=function(e){for(var t in a.c){var n=a.c[t];if(n.x<=e&&n.x+n.w>=e)return n}return null},l.on("draw",function(){e.getElementById("w").innerHTML="$"+l.u,l.j&&i.drawImage(l.dir>0?l.n:l.m,l.x,l.y)}).on("update",function(e){if(l.paused){l.a=0;return}l.i.i[8]&&(!l.z||!(l.z.x<=l.x+l.w/2&&l.z.x+l.z.w>=l.x+l.w/2))&&(l.z=k(l.x+l.w/2)),l.a=0;if(l.key){l.key==37&&(l.a=-1,l.dir=-1),l.key==39&&(l.a=1,l.dir=1),l.f||(l.a=0,l.t("tooltip",7,0,0,400)),l.a&&(l.f-=.25);if(l.key==66){var t=a.at(l.x+l.w/2);t&&(l.paused=!0,l.t("menu",l,t,S,x,T))}l.key==70&&(l.paused=!0,l.t("fish",S,k(l.x+l.w/2),l.r)),l.key==192&&(l.u+=1e4)}l.key=0}).on("keydown",function(e,t){l.key=t}).on("catch",function(e){l.i.f[e.n]++,l.paused=!1}).on("gotaway",function(){l.paused=!1}).on("start",function(){l.paused=!1}).on("buy",function(e,t){l.i.i[e]++,l.u-=t;switch(e){case"0":case"1":l.f+=e==1?1e3:l.deltaF,l.f=l.f>l.maxF?l.maxF:l.f,l.i.i[e]=0;break;case"4":l.speed+=75;break;case"3":l.speed+=50;break;case"7":l.r+=.25;break;case"6":l.r+=.15;break;case"8":l.paused=!0,l.z=k(l.x+l.w/2),l.t("tooltip",3,80,40,400,function(){l.paused=!1});break;case"11":case"12":l.maxF+=50}}).on("sell",function(e,t,n){l.u+=t*l.i.f[e],l.i.f[e]=0}),l.x=Math.floor(a.length/2),l.y=220,l.d=.98,l.dir=1,l.w=200,l.h=87,l.s=40,l.u=0,l.maxF=l.f=100,l.deltaF=10,l.paused=!1,l.r=0,l.m=new Image,l.n=new Image,l.m.src="boat.png",l.j=0,l.m.onload=function(){o.save(),o.scale(-1,1),o.drawImage(l.m,-l.w,0,l.w,l.h),l.n.src=s.toDataURL("image/png"),l.n.onload=function(){l.j=1},o.restore()},c.on("predraw",function(){i.save(),i.translate(-c.x,0),i.clearRect(c.x,0,c.w,c.h),b||(b=i.createLinearGradient(0,0,0,300),b.addColorStop(0,"rgb(163,164,255)"),b.addColorStop(.9,"rgb(200,200,255)"),b.addColorStop(1,"rgb(200,200,255)")),L(c.x,0,c.x+c.w,300,b)}).on("postdraw",function(){i.restore(),y||(y=i.createLinearGradient(0,300,0,500),y.addColorStop(0,"rgba(20,20,200,0.5)"),y.addColorStop(.3,"rgba(10,10,150,0.7)"),y.addColorStop(1,"rgba(10,10,150,0.95)")),L(0,300,c.w,c.h,y),A(a.c,a.length),O(),M()}).on("update",function(){c.x=l.x-c.w/2+l.w/2}),c.w=r.width=innerWidth,c.h=r.height=innerHeight,h.h=20,h.w=30,h.x=n.r(l.x+c.w,l.x-c.w),h.y=n.r(200),p.h=30,p.w=40,p.x=n.r(l.x+c.w,l.x-c.w),p.y=n.r(200),d.h=40,d.w=80,d.x=n.r(l.x+c.w,l.x-c.w),d.y=n.r(200),v.h=50,v.w=65,v.x=n.r(l.x+c.w,l.x-c.w),v.y=n.r(200),v.h=54,v.w=90,v.x=n.r(l.x+c.w,l.x-c.w),v.y=n.r(200),u.r(),l.t("tooltip",0,0,0,400,function(){l.t("tooltip",1,45,40,400,function(){l.t("tooltip",2,0,40,400,function(){l.t("start")})})}),l.paused=!0}(document,g,u);