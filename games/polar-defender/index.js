!function e(t,i,r){function o(s,a){var l,h;if(!i[s]){if(!t[s]){if(l="function"==typeof require&&require,!a&&l)return l(s,!0);if(n)return n(s,!0);throw Error("Cannot find module '"+s+"'")}h=i[s]={exports:{}},t[s][0].call(h.exports,function(e){var i=t[s][1][e];return o(i?i:e)},h,h.exports,e,t,i,r)}return i[s].exports}var s,n="function"==typeof require&&require;for(s=0;s<r.length;s++)o(r[s]);return o}({1:[function(e,t){var i=e("./levels-compiled");i.levels.forEach(function(e){e.waves.forEach(function(e){e.sprites=e.sprites.map(function(e){e=e.split(",");var t={};return e.forEach(function(e,r){e&&(t[i.keys[r]]=e)}),t})})}),t.exports=i},{"./levels-compiled":2}],2:[function(e,t){t.exports={messages:{gameWon:{heading:"Bravo!",message:"<p>Splendid, truly splendid. You eliminated all of the nuisance invaders!</p><p>Have yourself a cola, by Jove you've earned it!</p><p>As a way of saying thanks, we've unlocked infinite mode on the menu where you can blast aliens until your heart's content.</p>"},gameOver:{heading:"Oh well",message:"<p>You put up a good fight, your efforts are appreciated.</p><p>If we can't have the planet nobody can, so I'm going to press the doomsday button.</p><p>If you have any last words, best get to saying them.</p>"},zen:{heading:"Infinite mode locked",message:"<p>Complete the campaign to unlock infitnite mode.</p>"},unsupported:{heading:"You need an upgrade",message:'<p>Your browser is too old. <a href="//whatbrowser.org">Upgrade to play</a>.</p>'},about:{heading:"Polar Defender",message:'<p>Polar defender is brought to you by <a href="//spacekidgames.com">Space Kid Games</a>, aka <a href="//ash.ms">Ash Kyd</a>.'}},levels:[{title:"A fleet approaches",spiel:"<p>Blips on the radar show an alien fleet incoming, and these energy signatures aren't looking so friendly…</p><p>Due to recent budget cuts I'm afraid it's up to you to save the planet.</p>",spielM:"<p>Swipe left and right to move, and tap to&nbsp;fire!</p>",spielD:"<p>Use your arrow keys to move, and space to&nbsp;fire!</p>",size:10,r:.95,"class":"Earth",p:{o1:"#0d76b8",o2:"#48b8fb",c2:"#156b15",c3:"#1C7D1C",h1:"#48d6f9",h2:"rgba(134,59,249,0)",cloud:!0},waves:[{proceedAfter:1,flash:!1,powerup:90,sprites:["200,2,2,i1,5,1,2.5,y,1,10000,,,,,"]},{proceedAfter:0,sprites:["290,2,2,i1,5,1,2.5,y,1,10000,,,,,"]}]},{title:"Great job!",spiel:"<p>You sure made short work of those fiendish invaders.</p><p>Not to alarm you, but there may be a few more approaching.</p>",size:10,r:.95,waves:[{powerup:0,proceedAfter:1,sprites:["180,8,3,i1,5,1,2.5,y,1,,,,,,"]},{proceedAfter:15,sprites:["180,12,2,i1,5,1,2.5,y,1,,,,,,","180,12,2,i1,8,-1,2.5,p,1.5,,,,,,"]},{proceedAfter:15,sprites:["180,7,2,i2,6,1,3.5,g,1,,1.5,,,,","270,7,2,i2,7,-1,3.5,g,1.2,,1.5,,,,"]},{proceedAfter:3,powerup:0,sprites:["270,12,4,i1,5,-1,2.5,y,1,2000,,,,,","270,12,4,i1,8,1,2.5,p,1.5,2000,,,,,"]},{proceedAfter:5,sprites:["270,10,1,i2,6,1,3.5,g,1,,1.2,10,,,","90,10,1,i2,7,-1,3.5,g,1.5,,1.5,10,,,","180,10,2,i1,5,1,2.5,p,1.2,2000,,,1.25,,",",10,2,i1,5,1,2.5,p,1.2,2000,,,1.25,,"]}]},{title:"Incredible effort!",spiel:"<p>You saved the planet once again from those abominable invaders, with minimal catastrophic destruction I might add.</p><p>This next wave might be smaller, but it looks like there's a mothership nearby.</p>",size:10,r:.95,waves:[{proceedAfter:1,powerup:190,sprites:[",15,4,i1,5,-1,3.5,y,1,2000,,,,,"]},{proceedAfter:15,sprites:[",7,2,i2,6,1,3.5,g,1,3000,1.5,,,,","180,7,2,i2,7,-1,3.5,g,1.2,,1.5,,,,"]},{proceedAfter:15,sprites:["180,16,4,i1,5,-1,3.5,p,1,2000,1.5,,,,",",16,4,i1,8,1,3.5,y,1.5,2000,1.5,,,,"]},{proceedAfter:5,flash:!0,sprites:[",1,1,boss1,6.5,1,0.75,p,1,1500,,20,0.5,15,boom"]}]},{title:"A transmission from Jupiter:",spiel:"<p>It looks like the invaders are invading our colony on Europa, Jupiter's fourth-largest moon.</p><p>Did you know the surface of Europa is covered in an icy ocean?</p><p>It also has a thin oxygen atmosphere <small>(too thin to breathe, alas)</small>, making it a great location to send petty criminals to manufacture license plates!</p>",size:15,r:.95,"class":"Water",p:{o1:"#315A9E",o2:"#113A7D",c2:"#E1ECFF",c3:"#F2F7FF",h1:"rgba(255,255,255,.5)",h2:"rgba(134,59,249,0)",cloud:!0},waves:[{proceedAfter:1,sprites:["90,15,4,i1,5,-1,2.5,b,1,2000,1.5,,,,","90,15,4,i1,8,1,2.5,t,1.5,2000,1.5,,,,"]},{proceedAfter:15,sprites:["240,7,3,i3,6,1,3.5,s,1,2000,0.5,,,2,"]},{proceedAfter:1,powerup:1,sprites:["190,16,4,i1,5,-1,3.5,t,1,2000,1.5,,,,","90,16,4,i1,8,1,3.5,b,1.5,2000,1.5,,,,"]},{proceedAfter:1,sprites:["190,15,4,i1,5,-1,2.5,b,1,2000,1.5,,,,","190,15,4,i1,8,1,2.5,t,1.5,2000,1.5,,,,"]},{proceedAfter:15,sprites:[",7,2,i2,6,1,3.5,p,1,2000,2,,,,","190,7,5,i2,7,-1,3.5,p,1.2,2000,2,,,,"]},{proceedAfter:15,sprites:["190,20,4,i1,5,-1,3.5,t,1,2000,1.5,,,,",",20,4,i1,8,1,3.5,b,1.5,2000,1.5,,,,"]},{proceedAfter:15,sprites:["90,7,2,i3,6,1,3.5,s,1,2000,0.5,,,2,","270,7,5,i3,7,-1,3.5,s,1.2,2000,0.5,,,2,"]},{proceedAfter:2,flash:!0,powerup:60,sprites:["270,1,1,boss1,6.5,1,0.75,y,1,2000,,20,0.5,12,boom"]}]},{title:"Hey, I just terraformed that!",spiel:"<p>The scoundrel invaders are wreaking havoc on Mars, making the red planet even redder!</p><p>You're on fire with the controls, so go help put out the planet.</p>",size:11,r:.95,"class":"Fire",p:{o1:"#621100",o2:"#723F36",c2:"#FF2F00",c3:"#BD2200",h1:"rgba(255,122,0,.8)",h2:"rgba(255,12,0,0)"},waves:[{proceedAfter:1,sprites:[",15,4,i1,5,-1,2.5,b,1,2000,1.5,,,,",",15,4,i1,8,1,2.5,t,1.5,2000,1.5,,,,"]},{proceedAfter:0,sprites:[",7,2,i3,6,1,3.5,s,1,2000,,,,2,",",7,5,i3,7,-1,3.5,y,1.2,2000,,,,2,"]},{proceedAfter:15,sprites:[",16,4,i1,5,-1,3.5,t,1,2000,1.5,,,,",",16,4,i1,8,1,3.5,b,1.5,2000,1.5,,,,"]},{proceedAfter:5,sprites:[",15,4,i1,5,-1,2.5,b,1,2000,1.5,,,,",",15,4,i1,8,1,2.5,t,1.5,2000,1.5,,,,"]},{proceedAfter:15,sprites:[",7,2,i2,6,1,3.5,p,1,2000,2,,,,",",7,5,i2,7,-1,3.5,p,1.2,2000,2,,,,"]},{proceedAfter:15,flash:!0,sprites:[",20,4,i1,5,-1,3.5,t,1,2000,1.5,,,,",",20,4,i1,8,1,3.5,b,1.5,2000,1.5,,,,"]},{proceedAfter:5,flash:!0,sprites:[",1,1,boss1,6.5,1,0.75,r,1,2000,,20,0.5,12,boom","180,16,1,i2,8,1,3.5,r,1.5,2000,,20,0.5,,","180,16,1,i2,8.5,-1,3.5,y,1.5,2000,,1,0.5,,","180,16,1,i2,9,1,3.5,r,1.5,2000,,20,0.5,,"]},{proceedAfter:0,sprites:[",7,2,i3,6,1,3.5,s,1,2000,,,,2,",",7,5,i3,7,-1,3.5,y,1.2,2000,,,,2,"]},{proceedAfter:15,sprites:[",10,4,i2,5,-1,3.5,r,1,2000,,,,,",",7,5,i3,7,-1,3.5,y,1.2,2000,,,,2,"]},{proceedAfter:5,sprites:[",16,4,i1,5,-1,3.5,t,1,2000,1.5,,,,",",16,4,i1,8,1,3.5,b,1.5,2000,1.5,,,,"]},{proceedAfter:10,sprites:[",15,4,i1,5,-1,2.5,b,1,2000,1.5,,,,",",15,4,i1,8,1,2.5,t,1.5,2000,1.5,,,,"]},{proceedAfter:15,sprites:[",7,2,i2,6,1,3.5,p,1,2000,2,,,,",",7,5,i2,7,-1,3.5,p,1.2,2000,2,,,,"]},{proceedAfter:10,flash:!0,sprites:[",1,1,i3,6.5,1,0.75,s,1,2000,,20,1,40,boom"]}]},{title:"As a last-ditch attempt, they want to destroy the sun!",spiel:"<p>The audacity! Without the sun we're doomed!</p><p>You must stop these ghastly invaders!</p>",size:5,r:1,"class":"Wind",p:{o1:"#FFF500",o2:"#FFE300",c2:"#FFC700",c3:"#FFAF00",h1:"rgba(255,122,0,1)",h2:"rgba(255,12,0,0)",radiant:!0},waves:[{proceedAfter:1,sprites:[",15,4,i1,8,-1,2.5,b,1,2000,,,0.5,,",",15,4,i1,10,1,2.5,t,1.5,2000,,,0.5,,"]},{proceedAfter:15,sprites:[",7,2,i2,7,1,3.5,p,1,2000,,,0.5,,",",7,5,i2,9,-1,3.5,p,1.2,2000,,,0.5,,"]},{proceedAfter:15,sprites:[",16,4,i1,8,-1,3.5,t,1,2000,,,0.5,,",",16,4,i1,10,1,3.5,b,1.5,2000,,,0.5,,"]},{proceedAfter:1,sprites:[",15,4,i1,7,-1,2.5,b,1,2000,,,0.5,,",",15,4,i1,9,1,2.5,t,1.5,2000,,,0.5,,"]},{proceedAfter:15,sprites:[",7,2,i2,8,1,3.5,p,1,2000,,,1,,",",7,5,i2,10,-1,3.5,p,1.2,2000,,,1,,"]},{proceedAfter:15,flash:!0,sprites:[",20,4,i1,6,-1,3.5,t,1,2000,,,1,,",",20,4,i1,8,1,3.5,b,1.5,2000,,,1,,"]},{proceedAfter:15,flash:!0,sprites:[",1,1,i3,6,-1,0.75,r,1,1000,,20,0.5,20,boom"]},{proceedAfter:0,sprites:[",7,2,i3,6,1,3.5,s,1,2000,,,,2,",",7,5,i3,7,-1,3.5,y,1.2,2000,,,,2,"]},{proceedAfter:15,sprites:[",10,4,i2,5,-1,3.5,r,1,2000,,,,,",",7,5,i3,7,-1,3.5,y,1.2,2000,,,,2,"]},{proceedAfter:5,sprites:[",16,4,i1,5,-1,3.5,t,1,2000,1.5,,,,",",16,4,i1,8,1,3.5,b,1.5,2000,1.5,,,,"]},{proceedAfter:10,sprites:[",15,4,i1,5,-1,2.5,b,1,2000,1.5,,,,",",15,4,i1,8,1,2.5,t,1.5,2000,1.5,,,,"]},{proceedAfter:15,sprites:[",7,2,i2,6,1,3.5,p,1,1000,1.5,,,,",",7,5,i2,7,-1,3.5,p,1.2,1000,1.5,,,,"]},{proceedAfter:10,flash:!0,sprites:[",1,1,boss1,6.5,1,0.75,r,1,800,,,,30,boom","36,1,1,boss1,6.5,1,0.75,y,1,800,,,,30,boom","72,1,1,boss1,6.5,1,0.75,r,1,800,,,,30,boom","108,1,1,boss1,6.5,1,0.75,y,1,800,,,,30,boom","144,1,1,boss1,6.5,1,0.75,r,1,800,,,,30,boom","180,1,1,boss1,6.5,1,0.75,y,1,800,,,,30,boom","216,1,1,boss1,6.5,1,0.75,r,1,800,,,,30,boom","252,1,1,boss1,6.5,1,0.75,y,1,800,,,,30,boom","288,1,1,boss1,6.5,1,0.75,r,1,800,,,,30,boom","324,1,1,boss1,6.5,1,0.75,y,1,800,,,,30,boom"]}]}],keys:["d","rows","cols","src","dest","dir","w","color","start","missileInterval","speedModR","altFreqD","speedModD","hp","sound"]}},{}],3:[function(e,t){t.exports={background:'<svg style="background-color:#000" xmlns="http://www.w3.org/2000/svg" height="628" width="628"><defs><filter id="a" width="4" y="-1" x="-1" height="4" color-interpolation-filters="sRGB"><feGaussianBlur stdDeviation="134"/></filter><filter id="b" y="0" width="4" x="-1" height="2"><feGaussianBlur stdDeviation="151"/></filter></defs><path opacity=".58" d="M821 172L478 415l-300 95" filter="url(#a)" stroke="#204a87" stroke-width="200"/><path d="M397 506L207 290 186 63" filter="url(#b)" stroke="#a40000" stroke-width="100"/></svg>',boss1:'<svg xmlns="http://www.w3.org/2000/svg" height="95" width="205"><path d="M120 85h31V54h-31zm-66 0h31V54H54zM3 33v48h26V58h147v22h26V33h-200z" stroke="#800" stroke-width="5" fill="#f00"/><path d="M35 68v-13m134 13v-13" stroke="#f00" stroke-width="5" fill="none"/><path stroke="#f00" stroke-width="5" d="M10 35V0m185 35V0m-10 35V20M20 35V20" fill="none"/><path stroke="#800000" stroke-width="5" d="M103 58v36" fill="none"/><path stroke="#f00" stroke-width="3" d="M94 81h19m-19-10h19m-19 20h19" fill="none"/></svg>',i1:'<svg xmlns="http://www.w3.org/2000/svg" height="44" width="98"><path d="M49 25v17" stroke="#f00" stroke-width="10" fill="none"/><path d="M3 3v39H20V24h58v18h18V3z" fill="#f00" stroke="#800" stroke-width="5"/><path d="M35 34H64" stroke="#f00" stroke-width="6" fill="none"/></svg>',i2:'<svg xmlns="http://www.w3.org/2000/svg" height="53" width="98"><path d="M30 27l19-19L69 27" stroke="#f00" stroke-width="5" fill="none"/><path d="M64 34h31V2h-31zm-62 0h31V2H2z" stroke="#800" stroke-width="5" fill="#f00"/><path stroke="#800000" stroke-width="10" d="M5 33v20m88-20v20" fill="none"/><path d="M17 46v-35m64 35v-35m-12 35v-15m-41 15v-15" stroke="#F00" stroke-width="5" fill="none"/></svg>',i3:'<svg xmlns="http://www.w3.org/2000/svg" height="47" width="97"><path d="M10 47V19h77v29" stroke="#800" stroke-width="5" fill="none"/><path stroke="#f00" stroke-width="3" d="M0 42h20m0-10H0m77 0h20m0 10h-20" fill="none"/><path d="M36 33V4m25 30V4" stroke="#f00" stroke-width="20" fill="none"/></svg>',missile1:'<svg xmlns="http://www.w3.org/2000/svg" height="120" width="51"><g stroke="#F60"><path d="M39 14a13 13 0 1 1-25 0 13 13 0 1 1 25 0z" transform="matrix(1 0 0 1 -3 .497)" fill="#f00"/><path d="M25 70L1 119h49l-24-49z" fill="#F00"/><path fill="#FC0" d="M12 17h27v81h-27z"/></g></svg>',player:'<svg xmlns="http://www.w3.org/2000/svg" height="50" width="98"><path d="M49 25V0" fill="#babdb6" stroke="#ef2929" stroke-width="20"/><path d="M15 22H85l11 12v13H3V34z" fill="#a40000" stroke="#c00" stroke-width="5"/><text x="-48" y="46" transform="rotate(-90)" font-size="40" fill="#8b0000"><tspan x="-49" y="46">E</tspan></text><text transform="matrix(0 -1 -1 0 0 0)" y="-51" x="-48" font-size="40" fill="#8b0000"><tspan y="-51" x="-48">E</tspan></text></svg>'}},{}],4:[function(e,t){var i=["#ffffff","#ffe9c4","#d4fbff"],r=e("../img/"),o=e("./canv");t.exports={drawStarfield:function(e,t){var s,n,a,l,h,c,p,d=document.createElement("canvas");for(d.width=e,d.height=t,s=d.getContext("2d"),n=document.createElement("img"),n.width=e,n.height=t,n.src="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(r.background))),s.globalAlpha=.3,s.drawImage(n,0,0,e,t),a=0;e>a;a++)l=m.random()*e,h=m.random()*t,c=1*m.random(),p=i[m.round(m.random()*(i.length-1))],s.globalAlpha=m.random(),o.circle(s,{x:l,y:h},{width:c,fill:p});return d},drawPlanet:function(e){var t,i,r,s,n,a=o.grad,l=document.createElement("canvas");for(l.width=2.4*e.r,l.height=2.4*e.r,t=l.getContext("2d"),a(t,{r1:e.r,r2:1.2*e.r,c1:e.h1,c2:e.h2}),i=1.2*e.r-e.r,t.translate(i,i),t.beginPath(),t.arc(e.r,e.r,e.r,0,2*Math.PI),t.closePath(),t.clip(),a(t,{r1:0,r2:e.r,c1:e.o2,c2:e.o1}),r=0;r<e.r;r++)t.globalAlpha=.8,s=Math.random()*e.r*2,n=Math.random()*e.r*2,t.beginPath(),t.arc(s,n,Math.random()*(e.r/10),0,2*Math.PI),t.fillStyle=r>e.r/2?e.c3:e.c2,t.fill();if(e.cloud)for(r=0;r<e.r;r++)t.globalAlpha=.1,s=Math.random()*e.r*2,n=Math.random()*e.r*2,t.beginPath(),t.arc(s,n,Math.random()*(e.r/5),0,2*Math.PI),t.fillStyle="#fff",t.fill();return t.globalAlpha=1,a(t,{r1:e.r/2,r2:e.r,c1:"rgba(255,255,255,0)",c2:"rgba(255,255,255,.5)"}),e.radiant||a(t,{r1:1.3*e.r,r2:2*e.r,c1:"rgba(0,0,0,0)",c2:"rgba(0,0,0,.8)",x:-e.r/8}),l}}},{"../img/":3,"./canv":11}],5:[function(e,i){function r(){this.sounds={},this.mute=!1}var o,s,n,a=e("../vendor/jsfxr.min.js");r.prototype.play=function(e,i){if(!this.mute){{this.sounds[e]}t(function(){var e=t.length>1?t[m.floor(m.random()*t.length)]:t[0],t=e.pool[e.tick];t.duration&&t.play(),e.tick<e.count-1?e.tick++:e.tick=0},i)}},o=new r,s={shoot:[[3,,.1039,.7729,.4932,.0206,,-.0191,,,,.2871,.7986,,,,,,1,,,,,.5]],explode:[[3,,.5335,.2935,.6665,.1265,,-.305,,,,-.627,,,,,,,1,,,,,.3865],[3,,.2845,.6979,.6065,.0788,,,,,,-.1731,.7409,,,.768,,,1,,,,,.3865],[3,,.1029,.2024,.4658,.0841,,-.2592,,,,,,,,,-.2329,-.1724,1,,,,,.3865]],siren:[[1,,.3589,,.1592,.4013,,.1556,,,,,,,,.7307,,,1,,,,,.5]],respawn:[[1,,.354,,.3135,.2421,,.1683,,,,,,,,,,,1,,,,,.2465]],boom:[[3,.2065,.82,.5779,.6265,.4265,,-.4399,,,,,,,,,,,1,,,,,.5265],[3,,.1894,.4252,.7465,.1312,,,,,,,,,,,.204,-.0023,1,,,,,.4265]],miss:[[1,,.0406,,.1457,.5369,,-.5956,,,,,,,,,,,1,,,.2074,,.5],[1,,.0244,,.1947,.6505,,-.4682,,,,,,,,,,,1,,,,,.5]],done:[[0,,.3193,,.2593,.2904,,.2419,,,,,,,,,,,1,,,,,.4265]],menu:[[0,,.0141,.5771,.3626,.6261,,,,,,.4309,.5938,,,,,,1,,,,,.5]],menuItem:[[0,,.0567,.3019,.2113,.4684,,,,,,.3035,.533,,,,,,1,,,,,.1735]]};for(n in s)o.sounds[n]=[],s[n].forEach(function(e,t){var i,r;for(o.sounds[n].push({tick:0,count:5,pool:[]}),i=0;1>i;i++)r=new Audio,r.src=a(e),o.sounds[n][t].pool.push(r)},o);i.exports=o},{"../vendor/jsfxr.min.js":19}],6:[function(e,t){var i=e("./audio"),r=0;t.exports={init:function(){this.src=this.src||"invader",this.score=this.score||100,this.kinetic=1,this.invader=1,this.lastAlt=now()},tick:function(e){var t=this.speedModD||1,o=void 0===this.speedModR?1:this.speedModR,s=this.max/60,n=now();this.altFreqD&&n-this.lastAlt>1e3*this.altFreqD&&(this.dir=1==this.dir?-1:1,this.lastAlt=n),this.pos.r>this.dest?this.posInc(-e/200*s,0):(this.posInc(-e/2e3*s*o,this.dir*e/2e3*s*t),(!r||m.random()>.9&&this.pos.r<this.max&&n-r>(this.missileInterval||5e3))&&(i.play("shoot"),r=n,this.mkSprite({behaviour:"invmiss",cullMin:1},this.pos.r,this.pos.d)))}}},{"./audio":5}],7:[function(e,t){t.exports={init:function(){var e=this;e.score=550,e.kinetic=1,e.w=5,e.fill="orange",e.strokeWidth=e.w/2},tick:function(e){this.stroke=m.round(now()/200)%2==0?"orange":"yellow",this.posInc(0-e/10,0)}}},{}],8:[function(e,t){t.exports={init:function(){this.kinetic=1,this.src="missile1",this.w=10},tick:function(e){this.posInc(e/5,0)}}},{}],9:[function(e,t){t.exports={init:function(e){this.cullMax=1,this.cullMin=1,this.w=e.w||3*m.random()+1,this.h=this.w;var t=128+m.round(128*m.random());this.fill=e.fill||"rgb("+t+","+m.round(m.random()*t)+",0)",this.elapsed=0},tick:function(e){this.posInc(e/2*this.momentum[0],e/100*this.momentum[1]),this.elapsed+=e,this.elapsed>this.life&&(this.dead=!0),this.alpha=1-m.min(this.elapsed,this.life)/this.life}}},{}],10:[function(e,t){var i=e("./polar"),r=i.polar,o=(e("./colors"),e("./audio"));t.exports={init:function(e){"triplefire"==e.type&&(this.text="⁂",this.stroke="#fce94f",this.fill="#222",this.action=function(e){e.powerups.triplefire=1}),"+1"==e.type&&(this.text="❤",this.stroke="#f22",this.fill="#fff",this.action=function(e){e.lives++}),this.cullMin=1,this.kinetic=1,this.dest=this.max,this.w=this.max/90,this.textSize=this.max/60,this.start=1,this.speedModR=2,this.speedModD=2,this.momentum=[-.1,2],this.h=this.w,this.outline=!0,this.strokeWidth=5},tick:function(e){this.posInc(e/3*this.momentum[0],e/300*this.momentum[1]),this.mkSprite({behaviour:"particle",kinetic:0,fill:this.stroke,life:500*m.random(),pos:new r(this.pos.r,this.pos.d),momentum:[(m.random()-.5)/5,m.random()-.5],w:this.w/8})},go:function(e){this.action(e),o.play("menu")},die:function(){for(var e=0;30>e;e++)this.mkSprite({behaviour:"particle",kinetic:0,fill:15>e?this.stroke:this.fill,life:100*m.random()+1e3,pos:new r(this.pos.r,this.pos.d),momentum:[(m.random()-.5)/5,m.random()-.5],w:3*m.random()})}}},{"./audio":5,"./colors":12,"./polar":15}],11:[function(e,t){t.exports={line:function(e,t,i){i=i||{},e.strokeStyle=i.stroke||"#fff",e.lineWidth=i.w||2,e.beginPath();var r=t.pop();for(e.moveTo(r.x,r.y);t.length;)r=t.pop(),e.lineTo(r.x,r.y);e.closePath(),e.stroke()},circle:function(e,t,i){i=i||{},e.strokeStyle=i.stroke,e.fillStyle=i.fill,e.beginPath(),e.arc(t.x,t.y,i.width||10,0,2*m.PI),i.stroke&&(e.lineWidth=i.w||1,e.stroke()),i.fill&&e.fill()},grad:function(e,t){e.rect(0,0,2*t.r2,2*t.r2);var i=e.createRadialGradient(t.x||t.r2,t.x||t.r2,t.r1,t.x||t.r2,t.x||t.r2,t.r2);i.addColorStop(0,t.c1),i.addColorStop(1,t.c2),e.fillStyle=i,e.fill()}}},{}],12:[function(e,t){t.exports={y:{"#f00":"#ff0","#800":"#ff9e2a"},p:{"#f00":"#8800ff","#800":"#000088"},g:{"#f00":"#1dff00","#800":"#11aa00"},t:{"#f00":"#1dff00","#800":"#11aa00"},s:{"#f00":"#aaa","#800":"#ccc"},b:{"#f00":"#1a9bff","#800":"#0055d4"}}},{}],13:[function(e){function i(e,i){y&&document.body.removeChild(y),y=document.createElement("div"),y.innerHTML="<h1>"+e.heading+"</h1>"+e.message,e.dom&&y.appendChild(e.dom),document.body.appendChild(y),t(function(){y.className="visible "+(e.className||"")}),g.click=function(){return y.className="",i?i():p(),!1},w.play("menu",500)}function r(){i(k.messages.gameOver)}function o(){b.className="warn",t(function(){b.className=""},6e3)}function s(){b.className="rumble",t(function(){b.className=""},500)}function n(){i(k.messages.about)}function a(){w.mute=!w.mute,i({heading:"Audio "+(w.mute?"muted":"enabled"),message:""})}function l(){if(!v.cache.zen)return i(k.messages.zen);y.className="";new f(b,{gameOver:r,flash:o,rumble:s,level:{size:10,r:.95,waves:"zen",p:k.levels[0].p}})}function h(e){var t=document.createElement("a");return t.innerHTML=e,t.className="menu",t.href="#",t.onmouseenter=function(){w.play("menuItem")},t}function c(){var e=document.createElement("p");k.levels.forEach(function(t,i){var r,o,s,n;t.p&&(r=1>i||v.cache["l"+i],o=h(t.class),s=t.p,r?o.onclick=function(){d(i)}:s={o1:"#000",o2:"#000",c2:"#000",c3:"#000",h1:"rgba(255,86,132,.6)",h2:"rgba(97,0,210,0)"},s.r=100,n=u.drawPlanet(s),n.className="menu",o.appendChild(n),e.appendChild(o))}),i({heading:"Campaign Mode",message:"",dom:e,className:"main levels"})}function p(){var e,t,r,o,s={"☢;New Campaign":c,"☣;Infinite Mode":l,"♪;Toggle Sound":a,"ℹ;About":n},p=document.createElement("p");for(e in s)t=e.split(";"),r=h(t[1]),r.onclick=s[e],o=document.createElement("span"),o.innerHTML=t[0],r.appendChild(o),p.appendChild(r);i({heading:"Polar Defender",message:"",dom:p,className:"main"})}function d(e){function t(){v.set("zen",1),i(k.messages.gameWon)}function n(e){var c,p;return a&&(a.end=!0),v.set("l"+l,1),(c=k.levels[l])?(p="",c.spielM&&h?p+=c.spielM:c.spielD&&(p+=c.spielD),void i({heading:c.title,message:c.spiel+p},function(){a=new f(b,{nextLevel:n,gameOver:r,flash:o,rumble:s,level:c,levelNum:l++,lives:e.lives,score:e.score,powerups:e.powerups})})):t()}var a,l=e,h="ontouchstart"in document.documentElement;n({lives:3,score:0})}var f,u,v,w,g,b,k,y;window.m=Math,window.t=setTimeout,window.now=function(){return window.performance&&performance.now?performance.now():Date.now()},window.requestAnimationFrame=window.requestAnimationFrame||function(e){window.setTimeout(e,33)},f=e("./game"),u=e("./ambience"),v=e("./storage"),window.onload=function(){var r,o;return Array.prototype.forEach?(b=document.querySelector("#c"),r=m.min(innerHeight,innerWidth),b.width=r,b.height=r,window.onresize=function(){var e=m.min(innerHeight,innerWidth)+"px";b.style.width=e,b.style.height=e},o=b.getContext("2d"),o.drawImage(u.drawStarfield(r,r),0,0,r,r),void t(function(){w=e("./audio"),g=e("./touch"),k=e("../campaign"),p()})):i(k.messages.unsupported)}},{"../campaign":1,"./ambience":4,"./audio":5,"./game":14,"./storage":17,"./touch":18}],14:[function(e,i){var r=e("./polar"),o=(r.cartesian,r.polar),s=e("./sprite"),n=e("./audio"),a=e("./colors"),l=e("./ambience"),h={},c={},p=function(i,r){function p(e,t,i){var r=new s(e);return t&&r.setpos(t,i),N.push(r),r}function d(e){if("zen"==r.level.waves)return u(e);var t=r.level.waves[R];if(!(B||t&&e>t.proceedAfter||!t&&e>0)){if(!t)return B=!0,void window.setTimeout(function(){P=!0,r.nextLevel(r)},5e3);t.flash&&r.flash(),t.powerup&&f(t.powerup),t.sprites.forEach(function(e){var t,i,r,o;for(t=0;t<e.rows;t++)for(i=0;i<e.cols;i++){r={};for(o in e)r[o]=e[o];r.behaviour="inv1",r.dest=i*C+C*r.dest,r.w=C/r.w,p(r,A*e.start+i*C,(r.d||0)+4*t*m.PI)}}),R++}}function f(e){var t="triplefire";r.powerups[t]&&(t="+1"),p({behaviour:"powerup",type:t},A,e||360*m.random())}function u(e){var t,i,s,n,l,h,c,d,u,v,w,g,b=m.min(R,200);if(!(e>b/3)){if(t=Object.keys(a),i=b/100,s=10*i+4,n=5*i+1+m.round(m.random()),l=t[m.round(m.random()*(t.length-1))],h=m.round(3*m.random())-2,c=360*m.random(),d=5e3/(1+i)/(h?1:2),R%8==0&&f(),R++,b%10==0){for(r.flash(),u=0;u<m.min(b/20);u++)p({behaviour:"inv1",dest:5*C,w:C/.75,src:"boss1",dir:h,color:l,start:1,missileInterval:d/2,speedModD:.5,speedModR:0,hp:b/16+10,sound:"boom",altFreqD:20,score:1e3},A,c+60*u);return void p({behaviour:"particle",kinetic:!1,stroke:"#fff",text:"lol",textSize:30*m.random()+30,w:100,life:1500,pos:new o(F/2,360*m.random()),momentum:[m.random()/10,m.random()-.5]},A,c+180)}for(u=0;s>u;u++)for(v=5,w=0;n>w;w++)g={behaviour:"inv1",dest:w*C+5*C+w,w:C/2.5*(1-i/4),src:"i1",dir:h,color:l,start:1,rows:n,cols:s,missileInterval:d},p(g,A+w*C,c+4*u*m.PI+.5)}}function v(e,t){var i,s,a;if(!e.dead&&"particle"!=e.behaviour)if(i=25>M||N.length>250?2:10,s=k(e),s&&t!==!1){if(n.play("miss"),1===s)for(a=0;2*i>a;a++)p({behaviour:"particle",kinetic:!1,fill:"#fff",w:2,life:m.random()*i*150,pos:new o(e.pos.r,e.pos.d),momentum:[(m.random()-.5)/10,m.random()-.5]})}else{for(e.dead=!0,a=0;i>a;a++)p({behaviour:"particle",kinetic:!1,fill:m.random>.5?"#222":"#333",w:e.w/2,life:200*m.random()*i+100*i,pos:new o(e.pos.r,e.pos.d),momentum:[(m.random()-.5)/10,m.random()-.5]});if(e.score&&(r.score+=e.score),t===!0)return void e.die();for(a=0;(t||i)>a;a++)p({behaviour:"particle",life:1e3*m.random()+1e3*m.min(a,10),w:m.max(.5,m.random()*e.w/4),pos:new o(e.pos.r,e.pos.d),momentum:[(m.random()-.5)/5,m.random()-.5]});for(a=0;(t||i)>a;a++)p({behaviour:"particle",kinetic:!1,w:m.max(.5,m.random()*e/4),life:500*m.random(),pos:new o(e.pos.r,e.pos.d),momentum:[m.random(),m.random()]});n.play(e.sound||"explode"),e.score&&p({behaviour:"particle",kinetic:!1,stroke:"#fff",text:e.score,textSize:12,w:15,life:800,pos:e.pos,momentum:[-.01,0]})}}function w(){L||(N=N.filter(function(e){return e.pos.r<A}),j=0,L=1,g(A),t(function(){n.play("boom"),r.rumble(),v(p({w:F/10},.1,0),100),v(p({w:F/10},.1,90),100),V.dead=1,t(function(){r.gameOver()},5e3)},1e3))}function g(e){if(!j){if(!--r.lives)return void w();r.powerups={},j=1,N.forEach(function(i){i.kinetic&&i.pos.r<e&&t(function(){v(i,!1)},m.max(0,2*(i.pos.r-F)+1500))});for(var i=0;3>i;i++)n.play("siren",500*i);t(function(){n.play("boom"),r.rumble(),["☢","☠","☢","☢","☠","☢"].forEach(function(e){p({behaviour:"particle",kinetic:!1,stroke:"#fff",text:e,textSize:30*m.random()+30,w:100,life:1500,pos:new o(F/2,360*m.random()),momentum:[m.random()/10,m.random()-.5]})})},1010),t(function(){j=L,r.lives>0&&(W.dead=0,N.push(W),n.play("respawn"))},3e3)}}function b(){var e=!1;N.forEach(function(t){var i,o;if(t.kinetic&&"powerup"!=t.behaviour){if(t.pos.r<=F&&t.invader)return e=!0,t.die&&t.die(),void(t.score=0);i=t.box(),o=N.filter(function(e){if(e.kinetic&&e.behaviour!=t.behaviour){var r=e.box();return i[1].d<r[1].d&&i[1].d>r[0].d&&i[1].r>r[1].r&&i[1].r<r[0].r||i[0].d>r[0].d&&i[0].d<r[1].d&&i[0].r>r[1].r&&i[0].r<r[0].r}}),o.length&&("player"==t.src||"missile1"==t.behaviour?o.filter(function(e){return"powerup"==e.behaviour}).forEach(function(e){e.b.go.call(e,r),e.dead=!0,e.die()}):v(t),o.forEach(v))}}),(e||W.dead)&&g(F+A/5)}function k(e){return e.hp&&e.hp>0?void 0===e.lastHit||now()-e.lastHit>1e3?(e.lastHit=now(),e.hp--,1):2:0}function y(e){var t,i,o;for(t in N)N[t].draw(e,H);for(i=0,N=N.filter(function(e){if(e.dead)return!1;if(e.cullMax&&e.pos.r>.75*A)return e.score=0,!1;if(e.cullMin&&e.pos.r<F){if(e.score=0,!e.kinetic)return"particle"==e.behaviour&&W.dead?!0:!1;v(e)}return e.invader&&i++,!0}),W.dead||d(i),H.font="bold 20px Arial",H.fillStyle="#fff",H.fillText("Score: "+r.score,-A/2+10,-A/2+30),o="",H.font="bold 30px Arial",t=0;t<r.lives;t++)o+="♥ ";H.fillStyle="#f22",H.fillText(o,-A/2+10,-A/2+60)}function x(){var e,t;P||(e=-A/2,H.clearRect(e,e,A,A),H.drawImage(q,e,e),t=now()-D,M=(9*M+1e3/t)/10,E++,I=m.max(M,I),S=m.min(M,S),D=now(),O.hStart?W.posInc(0,O.h*m.min(6,(now()-O.hStart)/1e3*6)):W.posInc(0,O.h/(A-4*F)*(t/2)),b(),y(t),requestAnimationFrame(x))}var A,M,S,I,z,E,F,C,D,H,P,N,q,T,V,W,O,R,B,L,j;r=r||{},A=i.width,i.width=A,r.score=r.score||0,r.lives=r.lives||3,r.powerups=r.powerups||{},M=30,S=100,I=0,z=0,E=0,F=A/r.level.size,C=A/15,D=now(),H=i.getContext("2d"),H.translate(A/2,A/2),P=!1,N=[],s.prototype.max=A,s.prototype.planet=F,s.prototype.mkSprite=p,h[F]?(q=h[F],T=c[F]):(q=l.drawStarfield(A,A),h[F]=q,r.level.p.r=4*F,T=l.drawPlanet(r.level.p),c[F]=T),V=p({kinetic:!1,img:T,w:2*F},-F,0),W=p({src:"player",w:C/2.5,kinetic:!0},F*r.level.r,0),n.play("respawn"),O=e("./touch"),O.max=A,O.click=function(){W.dead||(p({behaviour:"missile1",kinetic:!0,cullMax:!0},W.pos.r+W.h,W.pos.d),r.powerups.triplefire&&(p({behaviour:"missile1",kinetic:!0,cullMax:!0},W.pos.r+W.h,W.pos.d+5),p({behaviour:"missile1",kinetic:!0,cullMax:!0},W.pos.r+W.h,W.pos.d-5)),n.play("shoot"))},R=0,B=!1,d(),L=!1,j=!1,requestAnimationFrame(x)};i.exports=p},{"./ambience":4,"./audio":5,"./colors":12,"./polar":15,"./sprite":16,"./touch":18}],15:[function(e,t){var i,r=360,o=function(e){return e*(m.PI/180)},s=function(e,t){this.r=+e,this.d=+t},n=s.prototype;n.toCartesian=function(){var e=this.r*m.cos(o(this.d)),t=this.r*m.sin(o(this.d));return new i(e,t)},n.abs=function(){for(;this.d<0;)this.d+=r;for(;this.d>=r;)this.d-=r;return this},n.rad=function(){return o(this.d)},i=function(e,t){this.x=+e,this.y=+t},t.exports={polar:s,cartesian:i}},{}],16:[function(e,t){var i=e("./polar"),r=e("./canv"),o=(i.cartesian,i.polar),s=e("./colors"),n=e("../img/"),a={},l={particle:e("./bhv.particle"),missile1:e("./bhv.missile1"),inv1:e("./bhv.inv1"),invmiss:e("./bhv.invmiss"),powerup:e("./bhv.powerup")},h=function(e){var t,i=this;for(t in e)i[t]=e[t];e.behaviour&&(i.b=l[i.behaviour],i.b.init&&i.b.init.call(this,e)),i.src&&i.createImg(i.src),e.img&&(i.img=e.img,i.calcHeight())},c=h.prototype;c.createImg=function(e){var t,i,r,o=this,l=e+this.color;if(a[l]&&0!=a[l].width)o.img=a[l],o.calcHeight();else{if(o.img=document.createElement("img"),o.img.onload=function(){o.calcHeight()},t=n[e],o.color)for(i in s[o.color])t=t.replace(RegExp(i,"g"),s[o.color][i]);r="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(t))),o.img.src=r,a[l]=o.img}},c.calcHeight=function(){this.h=this.img.height*(this.w/this.img.width)},c.setpos=function(e,t){return this.pos=void 0===t?e:new o(e,t),this},c.posInc=function(e,t){return this.pos.d+=t,this.pos.abs().r+=e,this},c.draw=function(e,t){var i,o,s=this,n=s.img,a=s.pos.toCartesian();return s.b&&s.b.tick.call(s,e),t.save(),isNaN(this.alpha)||(t.globalAlpha=this.alpha),n&&n.width?(t.translate(a.x,a.y),t.rotate(s.pos.rad()+m.PI/2),t.drawImage(n,0-s.w/2,0-s.h,s.w,s.h)):(i=s.pos.toCartesian(),o=s.textSize||30,(!this.text||this.outline)&&r.circle(t,i,{fill:s.fill||"#fff",stroke:s.stroke,width:s.w,w:s.strokeWidth}),this.text&&(t.font=o+"px Arial",t.textAlign="center",t.textBaseline="middle",t.fillStyle=s.stroke,t.fillText(s.text,i.x,i.y))),t.restore(),s},c.box=function(){var e,t=this;return e=this.img?t.pos.r/25:t.pos.r/50,[new o(this.pos.r+t.h,this.pos.d-t.w/e),new o(this.pos.r,this.pos.d+t.w/e)]},c.die=function(){this.b.die&&this.b.die.call(this)},t.exports=h},{"../img/":3,"./bhv.inv1":6,"./bhv.invmiss":7,"./bhv.missile1":8,"./bhv.particle":9,"./bhv.powerup":10,"./canv":11,"./colors":12,"./polar":15}],17:[function(e,t){var i=0,r={};try{localStorage.i="y",i="y"===localStorage.i}catch(o){}i&&localStorage.pd&&(r=JSON.parse(localStorage.pd)),t.exports={set:function(e,t){r[e]=t;var o=JSON.stringify(r);i&&(localStorage.pd=o)},cache:r}},{}],18:[function(e,t){function i(e){return"menu"!=e.target.className}var r,o,s,n,a={x:0,y:0,h:0,hStart:0,max:0};t.exports=a,r=document.body,r.ontouchstart=function(e){i(e)&&(a.x=0,o=e.targetTouches[0].clientX,e.preventDefault())},r.ontouchmove=function(e){if(e.preventDefault(),i(e)){a.x=e.targetTouches[0].clientX-o;var t=a.max/2.5;a.x=m.min(t,m.max(0-t,a.x)),a.h=a.x/(t/20),e.preventDefault()}},r.ontouchend=function(e){i(e)&&(m.abs(a.x)<10&&m.abs(a.y)<10&&a.click(),a.x=0,a.h=0)},r.onmouseup=function(e){i(e)&&a.click&&a.click()},s=!1,n=[32,27],r.onkeydown=function(e){37==e.which&&-1!=a.h&&(a.h=-1,a.hStart=now()),39==e.which&&1!=a.h&&(a.h=1,a.hStart=now()),-1==n.indexOf(e.which)||s||(a.click&&a.click(),s=!0)},r.onkeyup=function(e){37==e.which&&-1==a.h&&(a.h=0,a.hStart=0),39==e.which&&1==a.h&&(a.h=0,a.hStart=0),-1!=n.indexOf(e.which)&&(s=!1)}},{}],19:[function(e,t){function i(){this.A=function(e){for(var t=0;24>t;t++)this[String.fromCharCode(97+t)]=e[t]||0;.01>this.c&&(this.c=.01),e=this.b+this.c+this.e,.18>e&&(e=.18/e,this.b*=e,this.c*=e,this.e*=e)}}var r=new function(){this.z=new i;var e,t,r,o,s,n,a,l,h,c,p,d;this.reset=function(){var e=this.z;o=100/(e.f*e.f+.001),s=100/(e.g*e.g+.001),n=1-.01*e.h*e.h*e.h,a=1e-6*-e.i*e.i*e.i,e.a||(p=.5-e.n/2,d=5e-5*-e.o),l=1+e.l*e.l*(0<e.l?-.9:10),h=0,c=1==e.m?0:2e4*(1-e.m)*(1-e.m)+32},this.C=function(){this.reset();var i=this.z;return e=1e5*i.b*i.b,t=1e5*i.c*i.c,r=1e5*i.e*i.e+12,3*(0|(e+t+r)/3)},this.B=function(i,f){var m,u,v,w,g,b,k,y,x,A,M,S,I,z,E,F,C,D,H,P,N=this.z,q=1!=N.s||N.v,T=.1*N.v*N.v,V=1+3e-4*N.w,W=.1*N.s*N.s*N.s,O=1+1e-4*N.t,R=1!=N.s,B=N.x*N.x,L=N.g,j=N.q||N.r,Y=.2*N.r*N.r*N.r,U=N.q*N.q*(0>N.q?-1020:1020),G=N.p?(0|2e4*(1-N.p)*(1-N.p))+32:0,J=N.d,K=N.j/2,X=.01*N.k*N.k,Q=N.a,Z=e,$=1/e,_=1/t,et=1/r;for(N=5/(1+20*N.u*N.u)*(.01+W),N>.8&&(N=.8),N=1-N,b=!1,k=0,y=0,x=0,A=0,M=0,S=0,I=0,z=0,E=0,F=0,C=Array(1024),D=Array(32),H=C.length;H--;)C[H]=0;for(H=D.length;H--;)D[H]=2*Math.random()-1;for(H=0;f>H;H++){if(b)return H;if(G&&++E>=G&&(E=0,this.reset()),c&&++h>=c&&(c=0,o*=l),n+=a,o*=n,o>s&&(o=s,L>0&&(b=!0)),u=o,K>0&&(F+=X,u*=1+Math.sin(F)*K),u|=0,8>u&&(u=8),Q||(p+=d,0>p?p=0:p>.5&&(p=.5)),++y>Z)switch(y=0,++k){case 1:Z=t;break;case 2:Z=r}switch(k){case 0:x=y*$;break;case 1:x=1+2*(1-y*_)*J;break;case 2:x=1-y*et;break;case 3:x=0,b=!0}for(j&&(U+=Y,v=0|U,0>v?v=-v:v>1023&&(v=1023)),q&&V&&(T*=V,1e-5>T?T=1e-5:T>.1&&(T=.1)),g=0,P=8;P--;){if(I++,I>=u&&(I%=u,3==Q))for(m=D.length;m--;)D[m]=2*Math.random()-1;switch(Q){case 0:w=p>I/u?.5:-.5;break;case 1:w=1-2*(I/u);break;case 2:w=I/u,w=6.28318531*(w>.5?w-1:w),w=1.27323954*w+.405284735*w*w*(0>w?1:-1),w=.225*((0>w?-1:1)*w*w-w)+w;break;case 3:w=D[Math.abs(0|32*I/u)]}q&&(m=S,W*=O,0>W?W=0:W>.1&&(W=.1),R?(M+=(w-S)*W,M*=N):(S=w,M=0),S+=M,A+=S-m,w=A*=1-T),j&&(C[z%1024]=w,w+=C[(z-v+1024)%1024],z++),g+=w
}g*=.125*x*B,i[H]=g>=1?32767:-1>=g?-32768:0|32767*g}return f}};t.exports=function(e){var t,i,o,s,n;for(r.z.A(e),t=r.C(),e=new Uint8Array(4*(0|(t+1)/2)+44),t=2*r.B(new Uint16Array(e.buffer,44),t),i=new Uint32Array(e.buffer,0,44),i[0]=1179011410,i[1]=t+36,i[2]=1163280727,i[3]=544501094,i[4]=16,i[5]=65537,i[6]=44100,i[7]=88200,i[8]=1048578,i[9]=1635017060,i[10]=t,t+=44,i=0,o="data:audio/wav;base64,",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";t>i;i+=3)n=e[i]<<16|e[i+1]<<8|e[i+2],o+=s[n>>18]+s[63&n>>12]+s[63&n>>6]+s[63&n];return o}},{}]},{},[13]);