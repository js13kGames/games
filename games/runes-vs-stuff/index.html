<!doctype html><title>Runes vs Stuff</title><style>body{font:normal 20px monospace;overflow:hidden;cursor:default;margin:0;padding:50px 0}a,a:active,a:hover,a:visited{color:#000}#f,#t{width:1000px;box-shadow:0 1px 20px -3px #444;margin:auto}#t{height:45px;background:#555;text-align:center;color:#dfd}#f{height:400px;background:#999}#o{display:none;position:absolute;width:800px;height:300px;text-shadow:0 2px 20px #eee;text-align:center;transition:display ease .5s;margin:auto;padding:100px 100px 0}#s{color:#b0f}#ru.active,.R.rU{color:#feff66;text-shadow:0 2px 20px #feff66}#rt.active,.R.rT{color:#65d2f1;text-shadow:0 2px 20px #65d2f1}#rg.active,.R.rG{color:#abf5c2;text-shadow:0 2px 20px #abf5c2}#rh.active,.R.rH{color:#ae55fd;text-shadow:0 2px 20px #ae55fd}#h.h3{color:#3e5}#h.h2{color:#fe4}#h.h1{color:#e53}.T{float:left;width:20px;height:20px;line-height:1;text-align:center;font-weight:700}.M{color:#5f0;text-shadow:0 2px 20px #2d0}.C,.H{color:#fff}.R{font-size:140%;line-height:.8}#h.h0,#rg,#rh,#rt,#ru{color:#aaa}</style><table id=t><tr><td width=33>SCORE: <b id=s>0</b><td width=34>RUNES: <b id=ru>ᚢ</b> <b id=rt>ᛏ</b> <b id=rg>ᚷ</b> <b id=rh>ᚻ</b><td width=33>HEALTH: <b id=h>0</b></table><div id=f><div id=o></div></div><script>"use strict";function $(t){return document.getElementById(t)}function rand(t,e){return t&&!e?Math.floor(Math.random()*t):t&&e?rand(t)+e:Math.random()}function randomY(t){return rand(H-t)}function randomRune(t){return rand()<t?runes[rand(4)]:void 0}function extend(t,e){for(key in e)t[key]||(t[key]=e[key]);t._=e.constructor.prototype}function scorecounter(t){score+=t,scoreboard.innerHTML=score}function healthcounter(t){healthboard.innerHTML=t,healthboard.className="h"+t}function Field(){var t,e=this.f=[];for(i=0;H>i;i++)for(e[i]=[],j=0;W+2*xgap>j;j++)t=xgap>j||j>=W+xgap,e[i][j]=new Tile(j,i,t)}function Tile(t,e,n){var i=this.e=document.createElement("div");this._c(),n&&(i.style.display="none"),container.appendChild(i)}function Unit(t,e,n,i,o,r){var a=this;a.wrd=t,a.cls=e,a.crd=n,a.cX=i||0,a.cY=o||0,a.hp=r||1,a.spd=1,a.pow=1,a._p=0,a.mv()}function Mage(){var t=this;extend(t,new Unit("⇒","M",[[1,0],[0,1],[1,1],[2,1],[1,2]],2,8,3)),healthcounter(t.hp),t.type="mage",t.pow=100,t.runes={Uruz:{a:0,e:null},Teiwaz:{a:0,e:null},Gebo:{a:0,e:null},Hagalaz:{a:0,e:null}}}function Cube(){extend(this,new Unit("CUBE","C",[[0,0],[1,0],[0,1],[1,1]],W+2,randomY(1),1)),this.type="enemy",this.rune=randomRune(.25),this.rune?this.points=10:this.points=1,this.tick()}function Hypercube(){extend(this,new Unit("HYPERCUBE","H",[[0,0],[1,0],[2,0],[0,1],[1,1],[2,1],[0,2],[1,2],[2,2]],W+3,randomY(2),rand(2,3))),this.type="enemy",this.rune=randomRune(.5),this.rune?this.points=25:this.points=5,this.tick()}function Bullet(t,e,n,i,o,r,a){extend(this,new Unit("•","B",[[0,0]],t,e,0)),this.type="bullet",this.pow=n,this.spd=i,this.dirX=o,this.dirY=r||0,this.cb=a,this.tick()}function Rune(t,e){var n=[e[rand(e.length)]];extend(this,new Unit(t.symbol,"R "+t.cls,n,0,0,0)),this.type="rune",this.name=t.name,this.board=t.board,this.pow=0,this.tick()}function start(){"running"!==gameState&&(score=0,scorecounter(0),mage=new Mage,gameState="running",tick())}function tick(){rand()<.78?new Cube:new Hypercube,gameTimer=setTimeout(tick,rand(1200,600-Math.floor(score/10)))}function gameOver(){for(key in gameState="idle",controls)controls[key]=!1;clearTimeout(gameTimer),field.print("Game over! Your score is "+score+" points. Good job!",3e3)}var field,mage,key,i,j,gameState="idle",gameTimer=null,score=0,overlay=$("o"),container=$("f"),scoreboard=$("s"),healthboard=$("h"),runes={0:{name:"Uruz",symbol:"ᚢ",board:$("ru"),cls:"rU"},1:{name:"Teiwaz",symbol:"ᛏ",board:$("rt"),cls:"rT"},2:{name:"Gebo",symbol:"ᚷ",board:$("rg"),cls:"rG"},3:{name:"Hagalaz",symbol:"ᚻ",board:$("rh"),cls:"rH"}},W=Math.floor(container.offsetWidth/20),H=Math.floor(container.offsetHeight/20),xgap=10,ticktime=120,controls={};Field.prototype.is=function(t,e){return this.f[e]&&this.f[e][t+xgap]?this.f[e][t+xgap].u?-1:1:0},Field.prototype.get=function(t,e){return this.f[e][t+xgap]},Field.prototype.print=function(t,e,n){clearTimeout(this._t),overlay.innerHTML=t,overlay.style.display="block",this._t=setTimeout((function(){overlay.style.display="none",n&&setTimeout(n,400)}),e||2e3)},Field.prototype.interrupt=function(t){clearTimeout(this._t),setTimeout((function(){overlay.style.display="none"}),500),t()},Tile.prototype._c=function(t){this.e.className=t?"T "+t:"T"},Tile.prototype.set=function(t){t=t||null,this.u=t,this.e.innerHTML=t?t.gl():"",this._c(t?t.cls:0)},Unit.prototype.gc=function(t,e){return this.crd.map((function(n){return[n[0]+(0|t),n[1]+(0|e)]}))},Unit.prototype.gl=function(){return this._p>=this.wrd.length&&(this._p=0),this.wrd.charAt(this._p++)},Unit.prototype.mv=function(t,e){var n,o,r,a=this,c=a.cX+(0|t),s=a.cY+(0|e);a._nc=a.gc(c,s),r=a._lc?a._nc.filter((function(t){for(i=0;i<a._lc.length;i++)if(t[0]===a._lc[i][0]&&t[1]===a._lc[i][1])return!1;return!0})):a._nc,r.forEach((function(t){var e=field.is(t[0],t[1]);1>e&&(n=!0),0===e?"mage"!==a.type&&a.hit(1e4):-1===e&&((o=field.get(t[0],t[1]).u).type!==a.type&&(a.hit(o.pow,o),o.hit(a.pow,a)))})),n||(a.cX=c,a.cY=s,a.undraw(),a.draw(),a._lc=a._nc)},Unit.prototype.draw=function(){var t=this;t._nc.forEach((function(e){field.get(e[0],e[1]).set(t)}))},Unit.prototype.undraw=function(){this._lc&&this._lc.forEach((function(t){field.get(t[0],t[1]).set(null)}))},Unit.prototype.hit=function(t,e){var n=this;n.hp-=t,n.hp<=0&&(!e||"bullet"!==e.type&&"mage"!==e.type||scorecounter(0|n.points),n.timer&&clearTimeout(n.timer),n.undraw(),n.cb&&n.cb.call(n,n),n.rune&&new Rune(n.rune,n.gc(n.cX,n.cY)))},Unit.prototype._t=function(){var t=this;return t.hp<=0?t.undraw():void(t.timer=setTimeout((function(){t.tick()}),ticktime/(t.spd||1)))},Mage.prototype.attack=function(){var t=this,e=t.runes.Uruz.a,n=t.runes.Teiwaz.a,i=t.runes.Gebo.a,o=t.runes.Hagalaz.a,r=e&&n?3:e?2:1,a=i&&o?3:i?2:1,c=function(t){var n=t.cX,o=t.cY;e&&i&&(new Bullet(n,o,1,1,0,1),new Bullet(n,o,1,1,0,-1))};o&&n?(new Bullet(t.cX+3,t.cY+1,r,a,1,1,c),new Bullet(t.cX+3,t.cY+1,r,a,1,0,c),new Bullet(t.cX+3,t.cY+1,r,a,1,-1,c)):new Bullet(t.cX+3,t.cY+1,r,a,1,0,c)},Mage.prototype.hit=function(t,e){var n=this;return"rune"===e.type?void n.gain(e):(n._.hit.call(n,t,e),n.hp<0&&(n.hp=0),healthcounter(n.hp),void(0===n.hp&&gameOver()))},Mage.prototype.heal=function(t){var e=this;e.hp+=t,e.hp>3&&(e.hp=3),healthcounter(e.hp)},Mage.prototype.gain=function(t){var e=this.runes[t.name];for(key in clearTimeout(e.e),e.a=1,t.board.className="active",e.e=setTimeout((function(){e.a=0,t.board.className=""}),2e4),i=0,this.runes)i+=this.runes[key].a;4===i&&this.heal(3)},Cube.prototype.tick=Hypercube.prototype.tick=function(){var t=this;t.mv(-1,0),t._._t.call(t)},Bullet.prototype.tick=function(){var t=this;return t._pX==t.cX&&t._pY==t.cY?t.undraw():(t._pX=t.cX,t._pY=t.cY,t.mv(t.dirX,t.dirY),void t._._t.call(t))},Rune.prototype.tick=function(){var t=this;t.mv(-1,0),t._._t.call(t)},field=new Field,function(){var t=0,e=[['Welcome! This is \'Runes vs Stuff\' game.<br>It was made in two days for <a href="https://twitter.com/js13kGames" target="_blank">@js13kGames</a> competition.<br>I am <a href="https://twitter.com/xenohuntero" target="_blank">@xenohuntero</a>.',8e3],["By the way, you can skip that text with pressing on any key.",4e3],["Controls are ↑ &amp; ↓ and spacebar.<br>Your goal is to get as much points as possible.",6e3],["Runes will increase speed and damage of bullets.<br>Also, some set of active Runes will affect a way you attack.",7e3],["If you have all 4 Runes simultaneously, it restores your health.",4e3],["When game is over, you can start a new one by pressing spacebar.",4e3],["Enjoy!",2e3]],n=function(i){t==e.length&&i();var o=e[t++];field.print(o[0],o[1],(function(){n(i)}))};n((function(){window.onkeypress=function(){},start()})),window.onkeypress=function(){field.interrupt(start)}}(),function t(){controls.up?mage.mv(0,-1):controls.down&&mage.mv(0,1),controls.attack&&mage.attack(),setTimeout(t,ticktime)}(),window.onkeydown=function(t){if("running"===gameState){var e=t.keyCode;38==e?(controls.up=!0,controls.down=!1):40==e?(controls.down=!0,controls.up=!1):32==e&&(controls.attack=!0)}},window.onkeyup=function(t){if("running"===gameState){var e=t.keyCode;38==e?controls.up=!1:40==e?controls.down=!1:32==e&&(controls.attack=!1)}}</script>