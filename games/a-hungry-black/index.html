<!doctype html><meta name=viewport content="width=device-width"><title>A Hungry Black - js13kGames 2025</title><style>body{margin:0;padding:0;overflow:hidden;background:#fff;color:#000;font-family:Arial,sans-serif}.startPage{position:fixed;top:0;left:0;width:100%;height:100%;background:#fff;display:flex;flex-direction:column;align-items:center;justify-content:center;z-index:1000}.gameTitle{font-size:5vw;margin-bottom:5vh;color:#000;text-shadow:2px 2px 4px rgba(0,0,0,.3)}.startPageButton{padding:1.5vh 3vw;font-size:2vw;background:#000;color:#fff;border:none;border-radius:5px;cursor:pointer;transition:all .3s ease}.startPageButton:hover{background:#333;transform:scale(1.05)}.fishBackground{position:fixed;top:0;left:0;width:100%;height:100%;z-index:1;pointer-events:none}.fish{position:absolute;width:2vw;height:1.2vw;background:#000;border-radius:50%50%50%50%/60%60%40%40%}.fish::before{content:'';position:absolute;right:-.6vw;top:50%;transform:translateY(-50%);width:.8vw;height:1vw;background:#000;border-radius:50%0 0 50%}.fish::after{content:'';position:absolute;left:-.2vw;top:50%;transform:translateY(-50%);width:.4vw;height:.4vw;background:#000;border-radius:50%}.gameContainer{position:fixed;top:0;left:0;width:100%;height:100%;background:#fff;display:none;flex-direction:column;align-items:center;justify-content:center;z-index:2000;opacity:0;transition:opacity .5s ease}.gameContainer.show{display:flex;opacity:1}.gameContent{position:relative;display:flex;width:90vw;height:80vh;max-width:90vw;max-height:80vh;flex-shrink:0}.gameTutorial{width:25%;min-width:20vw;padding:2vw;background:rgba(255,255,255,.9);border-radius:2vw;margin-right:2vw;overflow-y:auto;box-shadow:0 2vw 10vw rgba(0,0,0,.1);flex-shrink:0}.gameTutorial h3{font-size:1.8vw;margin-top:0;margin-bottom:1.5vh}.gameTutorial ul{margin:0;padding-left:1.5vw}.gameTutorial li{margin-bottom:1vh;line-height:1.4;font-size:1.2vw}.gameCanvasContainer{flex:1;min-width:30vw;background:rgba(255,255,255,.9);border-radius:2vw;display:flex;align-items:center;justify-content:center;position:relative;box-shadow:0 2vw 10vw rgba(0,0,0,.1);padding:2vw}#gameCanvas{width:100%;height:100%;background:#f0f0f0;border-radius:5px;position:relative;z-index:5}.backButton{position:absolute;top:2vh;left:2vw;padding:1.5vh 3vw;font-size:2vw;background:#000;color:#fff;border:none;border-radius:5px;cursor:pointer;transition:all .3s ease;z-index:10}.backButton:hover{background:#333;transform:scale(1.05)}.gameMessage{font-size:3vw;color:#000;text-align:center;margin-bottom:5vh}</style><div class=startPage><h1 class=gameTitle>A Hungry Black</h1><div style=margin-bottom:3vh><label for=playerName style=font-size:1.5vw;display:block;margin-bottom:1vh>Enter your name:</label><input id=playerName placeholder=player style="padding:1vh 2vw;font-size:1.5vw;border:2px solid #000;border-radius:5px;text-align:center" maxlength=10></div><button class=startPageButton>Start Game</button><div class=fishBackground></div></div><div class=gameContainer><div class=fishBackground></div><button class=backButton>Back Home</button><button id=musicToggle style="position:absolute;top:2vh;left:22vw;padding:1.5vh 2vw;font-size:2vw;background:#000;color:#fff;border:none;border-radius:5px;cursor:pointer;transition:all .3s ease;z-index:10">ðŸ”Š</button><div class=gameContent><div class=gameTutorial><h3>Game Tutorial</h3><ul><li><strong>Basic Controls:</strong>Drag the mouse to move the black cat in the direction you want to go<li><strong>Touch Controls:</strong>Drag your finger across the screen on mobile devices<li><strong>Red Arrow:</strong>Indicates the direction your cat is moving<li><strong>Growing:</strong>Eat smaller enemies and food to increase your size<li><strong>Survival:</strong>Avoid enemies larger than you(10%bigger or more)<li><strong>Goal:</strong>Grow your size until your diameter exceeds the map width(2000)to win the game!</ul><h3 style=margin-top:2vh>Enemy Types</h3><div style=display:flex;flex-direction:column;gap:1vh><div style=display:flex;align-items:center;gap:1vw><div style=width:1.5vw;height:1.5vw;border-radius:50%;background:#8b4513></div><span style=font-size:1.2vw>Dog Balls(Brown)</span></div><div style=display:flex;align-items:center;gap:1vw><div style=width:1.5vw;height:1.5vw;border-radius:50%;background:#444></div><span style=font-size:1.2vw>Mouse Balls(Dark Gray)</span></div><div style=display:flex;align-items:center;gap:1vw><div style=width:1.5vw;height:1.5vw;border-radius:50%;background:#ff69b4></div><span style=font-size:1.2vw>Cat Balls(Pink)</span></div></div><h3 style=margin-top:2vh>Predator-Prey Relationships</h3><ul><li><strong>Black Cat(You)</strong>can eat:Smaller dog balls,mouse balls,and cat balls<li><strong>Dog Balls</strong>will chase:Smaller mouse balls and cat balls<li><strong>Mouse Balls</strong>will avoid:Larger dog balls and cat balls<li><strong>Cat Balls</strong>will chase:Smaller mouse balls and dog balls<li>All enemies will try to avoid being eaten by larger balls</ul><h3 style=margin-top:2vh>Tips</h3><ul><li>Start by eating small food items to grow safely<li>Use the red arrow to confirm your movement direction<li>Watch out for enemies that suddenly change direction<li>Remember:Size matters!Even a slightly larger enemy can eat you<li>As you grow,your view will expand,helping you spot danger from farther away<li>Eat<strong>mouse balls</strong>to gain a<strong>dash skill</strong>(âš¡):Dash quickly in your current direction<li>Eat<strong>dog balls</strong>to gain a<strong>roar skill</strong>(ðŸš«):Create a red circle that stops enemies from moving for 3 seconds<li>Eat<strong>cat balls</strong>to gain a<strong>double score skill</strong>(Ã—2):Double your points for 5 seconds<li>Activate skills by clicking the skill button at the bottom or pressing the space bar</ul></div><div class=gameCanvasContainer><canvas id=gameCanvas></canvas><button id=skillButton style="position:absolute;bottom:2vh;left:50%;transform:translateX(-50%);background:#000;color:#fff;border:none;border-radius:50%;width:8vw;height:8vw;font-size:2vw;cursor:pointer;opacity:.3;transition:all .3s ease;display:flex;align-items:center;justify-content:center;z-index:20"><span id=skillIcon>?</span></button></div><div class=leaderboard style="position:absolute;top:2vh;right:2vw;width:20%;min-width:15vw;padding:2vw;background:rgba(255,255,255,.15);border-radius:2vw;overflow-y:auto;box-shadow:0 2vw 10vw rgba(0,0,0,.1);z-index:10;font-size:1.2vw"><div style=display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5vh><h3 style=font-size:1.8vw;margin:0>Leaderboard</h3><button id=toggleLeaderboard style="background:#000;color:#fff;border:none;border-radius:5px;padding:.5vh 1vw;cursor:pointer;font-size:1vw">Hide</button></div><div id=leaderboardList></div></div></div></div><script>const startFishBg=document.querySelector(".startPage .fishBackground"),gameFishBg=document.querySelector(".gameContainer .fishBackground"),startPg=document.querySelector(".startPage"),startBtn=document.querySelector(".startPageButton"),playerNameInput=document.getElementById("playerName"),gameContainer=document.querySelector(".gameContainer"),backBtn=document.querySelector(".backButton"),gameCanvas=document.getElementById("gameCanvas"),leaderboardList=document.getElementById("leaderboardList"),toggleLeaderboard=document.getElementById("toggleLeaderboard"),leaderboardDiv=document.querySelector(".leaderboard"),skillButton=document.getElementById("skillButton"),skillIcon=document.getElementById("skillIcon");let isLeaderboardVisible=!0;function setPlayerSkill(e){currentSkill=e,skillActive=!1,skillCooldown=0,updateSkillButton()}function updateSkillButton(){currentSkill?(skillButton.style.opacity="1",skillButton.style.backgroundColor="#000","dash"===currentSkill?skillIcon.textContent="âš¡":"roar"===currentSkill?skillIcon.textContent="ðŸš«":"doubleScore"===currentSkill&&(skillIcon.textContent="Ã—2")):(skillButton.style.opacity="0.3",skillIcon.textContent="?")}function activateSkill(){if(currentSkill&&!skillActive&&"playing"===gameState){if(skillActive=!0,"dash"===currentSkill){const e=8*player.radius;0!==mouseDirection.x||0!==mouseDirection.y?(player.x+=mouseDirection.x*e,player.y+=mouseDirection.y*e):player.y-=e,currentSkill=null}else"roar"===currentSkill?(roarEffectTimer=180,currentSkill=null):"doubleScore"===currentSkill&&(doubleScoreTimer=300,currentSkill=null);updateSkillButton()}}function updateSkills(){if(doubleScoreTimer>0&&doubleScoreTimer--,roarEffectTimer>0){roarEffectTimer--;const e=5*player.radius;for(let t=0;t<enemies.length;t++){const a=enemies[t],r=player.x-a.x,i=player.y-a.y;Math.sqrt(r*r+i*i)<e?(a.originalDirection||(a.originalDirection={x:a.directionX,y:a.directionY}),a.directionX=0,a.directionY=0):a.originalDirection&&(a.directionX=a.originalDirection.x,a.directionY=a.originalDirection.y,a.originalDirection=null)}}else if(0===roarEffectTimer)for(let e=0;e<enemies.length;e++)enemies[e].originalDirection&&(enemies[e].directionX=enemies[e].originalDirection.x,enemies[e].directionY=enemies[e].originalDirection.y,enemies[e].originalDirection=null)}function drawSkillEffect(){if(roarEffectTimer>0){const e=5*player.radius;ctx.strokeStyle="rgba(255, 0, 0, "+roarEffectTimer/180+")",ctx.lineWidth=.2*player.radius,ctx.beginPath(),ctx.arc(player.x,player.y,e,0,2*Math.PI),ctx.stroke()}doubleScoreTimer>0&&(ctx.fillStyle="rgba(255, 215, 0, "+doubleScoreTimer/300+")",ctx.font=.8*player.radius+"px Arial",ctx.textAlign="center",ctx.textBaseline="middle",ctx.fillText("Ã—2",player.x,player.y-1.5*player.radius))}function createFishBg(e){e.innerHTML="";const t=Math.floor(6*Math.random())+10;for(let a=0;a<t;a++){const t=document.createElement("div");t.classList.add("fish");const a=100*Math.random(),r=100*Math.random();t.style.left=a+"%",t.style.top=r+"%",t.style.transform=Math.random()>.5?"scaleX(-1)":"scaleX(1)",e.appendChild(t),animateFish(t)}}function animateFish(e){let t=parseFloat(e.style.left),a=parseFloat(e.style.top),r=.5*(Math.random()-.5),i=.2*(Math.random()-.5);!function n(){t+=r,a+=i,t<-5&&(t=-5,r=Math.abs(r),e.style.transform="scaleX(1)"),t>105&&(t=105,r=-Math.abs(r),e.style.transform="scaleX(-1)"),(a<0||a>100)&&(i=-i),Math.random()<.005&&(r=.5*(Math.random()-.5),e.style.transform=r>0?"scaleX(1)":"scaleX(-1)"),Math.random()<.01&&(i=.2*(Math.random()-.5)),e.style.left=t+"%",e.style.top=a+"%",e.parentElement&&requestAnimationFrame(n)}()}function setupCanvas(){const e=document.querySelector(".gameCanvasContainer").getBoundingClientRect(),t=window.devicePixelRatio||1,a=e.width*t,r=e.height*t;gameCanvas.width=a,gameCanvas.height=r,gameCanvas.style.width=e.width+"px",gameCanvas.style.height=e.height+"px"}function initAudioContext(){if(!audioContext)try{audioContext=new(window.AudioContext||window.webkitAudioContext)}catch(e){console.log("Web Audio API not supported in this browser")}}function generatePianoTone(e,t){const a=(e,t,a,r)=>Math.sin(e/t*6.28*a+r),r=(e,t)=>Math.sin(e/44100*t*6.28+a(e,44100,t,0)**2+.75*a(e,44100,t,.25)+.1*a(e,44100,t,.5)),i=[],n=44100,o=Math.floor(n*t);for(let a=0;a<o;a++)i[a]=a<88?a/88.2*r(a,e):(1-(a-88.2)/(n*(t-.002)))**((.5*Math.log(1e4*e/44100))**2)*r(a,e);const l=audioContext.createBuffer(1,o,n),s=l.getChannelData(0);for(let e=0;e<o;e++)s[e]=i[e];return l}function playNote(e,t){if(!audioContext)return;const a=generatePianoTone(e,t),r=audioContext.createBufferSource(),i=audioContext.createGain();r.buffer=a,r.connect(i),i.connect(audioContext.destination),i.gain.value=.1,r.start(),backgroundMusic.activeNotes||(backgroundMusic.activeNotes=[]),backgroundMusic.activeNotes.push(r),r.onended=function(){const e=backgroundMusic.activeNotes.indexOf(r);e>-1&&backgroundMusic.activeNotes.splice(e,1)}}toggleLeaderboard.addEventListener("click",function(){isLeaderboardVisible=!isLeaderboardVisible,isLeaderboardVisible?(leaderboardList.style.display="block",toggleLeaderboard.textContent="Hide"):(leaderboardList.style.display="none",toggleLeaderboard.textContent="Show")}),skillButton.addEventListener("click",activateSkill),document.addEventListener("keydown",function(e){"Space"===e.code&&activateSkill()}),createFishBg(startFishBg),window.addEventListener("resize",()=>{setupCanvas()});const noteToFrequency={c:261.63,"c#":277.18,d:293.66,"d#":311.13,e:329.63,f:349.23,"f#":369.99,g:392,"g#":415.3,a:440,"a#":466.16,b:493.88,c5:523.25,"c#5":554.37,d5:587.33,"d#5":622.25,e5:659.25,f5:698.46,"f#5":739.99,g5:783.99,"g#5":830.61,a5:880,"a#5":932.33,b5:987.77},gameMelodies={main:[{note:"d3",duration:1.5},{note:"d3",duration:1.5},{note:"e3",duration:1.5},{note:"f3",duration:1.5},{note:"f3",duration:1.5},{note:"g3",duration:1.5},{note:"a3",duration:1.5},{note:"g3",duration:1.5},{note:"a3",duration:1.5},{note:"f3",duration:1.5},{note:"e3",duration:1.5},{note:"f3",duration:1.5},{note:"e3",duration:1.5},{note:"d3",duration:1.5},{note:"d3",duration:1.5},{note:"e3",duration:1.5},{note:"f3",duration:1.5},{note:"a3",duration:1.5},{note:"c4",duration:1.5},{note:"d4",duration:1.5},{note:"e4",duration:1.5},{note:"c4",duration:1.5},{note:"b3",duration:1.5},{note:"c4",duration:1.5},{note:"b3",duration:1.5},{note:"a3",duration:1.5},{note:"a3",duration:1.5},{note:"c4",duration:1.5},{note:"d4",duration:1.5},{note:"e4",duration:1.5},{note:"c4",duration:1.5},{note:"b3",duration:1.5},{note:"a3",duration:1.5},{note:"g3",duration:1.5},{note:"a3",duration:1.5},{note:"d3",duration:1.5},{note:"a3",duration:1.5},{note:"g3",duration:1.5},{note:"f3",duration:1.5},{note:"e3",duration:1.5},{note:"d3",duration:1.5},{note:"g3",duration:1.5},{note:"a3",duration:1.5},{note:"g3",duration:1.5},{note:"g3",duration:1.5},{note:"f3",duration:1.5},{note:"e3",duration:1.5},{note:"f3",duration:1.5},{note:"e3",duration:1.5},{note:"d3",duration:1.5},{rest:!0,duration:2}],harmony:[]};function createBackgroundMusic(){function e(e,t=0,a=180){let r=0;const i=60/a;setTimeout(()=>{const t=setInterval(()=>{if("playing"!==gameState||!musicPlaying)return void clearInterval(t);r>=e.length&&(r=0);const a=e[r];if(a.rest);else if(a.note){let e=a.note,t=4;const r=e.match(/^([a-g]#?)(\d+)$/i);if(r&&(e=r[1].toLowerCase(),t=parseInt(r[2])),noteToFrequency[e]){let r=noteToFrequency[e];if(t<4)for(let e=0;e<4-t;e++)r/=2;else if(t>5)for(let e=0;e<t-5;e++)r*=2;playNote(r,a.duration)}}r++},1e3*i);backgroundMusic.intervals.push(t)},t)}(audioContext||(initAudioContext(),audioContext))&&(backgroundMusic&&stopBackgroundMusic(),backgroundMusic={activeNotes:[],intervals:[]},e(gameMelodies.main,0,120),e(gameMelodies.harmony,500,120),musicPlaying=!0)}function stopBackgroundMusic(e=!0){backgroundMusic&&(backgroundMusic.intervals&&Array.isArray(backgroundMusic.intervals)&&backgroundMusic.intervals.forEach(e=>clearInterval(e)),backgroundMusic.activeNotes&&Array.isArray(backgroundMusic.activeNotes)&&backgroundMusic.activeNotes.forEach(e=>{try{e.stop()}catch(e){}}),backgroundMusic=null,e&&(musicPlaying=!1),updateMusicButtonIcon())}function updateMusicButtonIcon(){const e=document.getElementById("musicToggle");e&&(e.textContent=musicPlaying?"ðŸ”Š":"ðŸ”‡")}document.addEventListener("click",()=>{audioContext&&"suspended"===audioContext.state&&audioContext.resume()},{once:!0}),document.addEventListener("DOMContentLoaded",()=>{const e=document.getElementById("musicToggle");e&&e.addEventListener("click",()=>{musicPlaying?stopBackgroundMusic():createBackgroundMusic(),updateMusicButtonIcon()})});let ctx,gameState="idle",playerName="player",player={x:0,y:0,radius:20,speed:3,color:"#000",isBlackCat:!0,name:playerName},audioContext=null,musicPlaying=!1,backgroundMusic=null,currentSkill=null,skillActive=!1,skillCooldown=0,doubleScoreTimer=0,roarEffectTimer=0,enemies=[],score=0,food=[],mouseDirection={x:0,y:0},isMouseDown=!1;const FPS=60,frameInterval=1e3/60;let lastFrameTime=0,animationId=null;function initGame(){ctx=gameCanvas.getContext("2d"),setupCanvas(),resetGame(),gameCanvas.addEventListener("mousedown",handleMouseDown),document.addEventListener("mousemove",handleMouseMove),document.addEventListener("mouseup",handleMouseUp),gameCanvas.addEventListener("touchstart",handleTouchStart),document.addEventListener("touchmove",handleTouchMove),document.addEventListener("touchend",handleTouchEnd)}function handleMouseDown(e){isMouseDown=!0,updateMouseDirection(e)}function handleMouseMove(e){isMouseDown&&updateMouseDirection(e)}function handleTouchStart(e){e.preventDefault(),isMouseDown=!0,updateMouseDirection(e.touches[0])}function handleTouchMove(e){e.preventDefault(),isMouseDown&&e.touches.length>0&&updateMouseDirection(e.touches[0])}function handleTouchEnd(){isMouseDown=!1,mouseDirection={x:0,y:0}}function handleMouseUp(){isMouseDown=!1,mouseDirection={x:0,y:0}}function updateMouseDirection(e){const t=gameCanvas.getBoundingClientRect(),a=e.clientX-t.left,r=e.clientY-t.top,i=t.width/2,n=t.height/2;mouseDirection.x=a-i,mouseDirection.y=r-n;const o=Math.sqrt(mouseDirection.x*mouseDirection.x+mouseDirection.y*mouseDirection.y);o>0&&(mouseDirection.x/=o,mouseDirection.y/=o)}function resetGame(){player.x=1e3,player.y=1e3,player.radius=10,player.name=playerName,score=0,enemies=[],food=[],gameState="playing",currentSkill=null,skillActive=!1,skillCooldown=0,doubleScoreTimer=0,roarEffectTimer=0,updateSkillButton();for(let e=0;e<15;e++)spawnEnemy();for(let e=0;e<200;e++)spawnFood()}function isPositionValid(e,t,a){const r=e-player.x,i=t-player.y;if(Math.sqrt(r*r+i*i)<a+player.radius)return!1;for(let r=0;r<enemies.length;r++){const i=e-enemies[r].x,n=t-enemies[r].y;if(Math.sqrt(i*i+n*n)<a+enemies[r].radius)return!1}for(let r=0;r<food.length;r++){const i=e-food[r].x,n=t-food[r].y;if(Math.sqrt(i*i+n*n)<a+food[r].radius)return!1}return!0}function spawnEnemy(){const e=["dog","mouse","cat"],t=e[Math.floor(Math.random()*e.length)],a=15*Math.random()+5;let r,i=0;for(;;){if(i>=100){r={x:1e3,y:1e3,radius:a,speed:.1*(25-a)+.5,directionX:2*Math.random()-1,directionY:2*Math.random()-1,type:t,color:getEnemyColor(t),name:generateRandomName(t)};break}const e=200+1600*Math.random(),n=200+1600*Math.random();if(isPositionValid(e,n,a)){r={x:e,y:n,radius:a,speed:.1*(25-a)+.5,directionX:2*Math.random()-1,directionY:2*Math.random()-1,type:t,color:getEnemyColor(t),name:generateRandomName(t)};break}i++}enemies.push(r)}function getEnemyColor(e){return"dog"===e?"#8B4513":"mouse"===e?"#444444":"cat"===e?"#FF69B4":"#000000"}function generateRandomName(e){const t=["Rex","Max","Buddy","Rocky","Charlie","Cooper","Duke","Toby","Teddy","Bailey"],a=["Jerry","Mickey","Speedy","Squeaky","Nibbles","Scamper","Twitch","Whiskers","Cheese","Peanut"],r=["Felix","Tom","Garfield","Simba","Whiskers","Oliver","Luna","Bella","Chloe","Kitty"];let i;switch(e){case"dog":i=t;break;case"mouse":i=a;break;case"cat":i=r;break;default:i=["Enemy"]}return i[Math.floor(Math.random()*i.length)]}function spawnFood(){const e=2*Math.random()+1;let t,a=0;for(;;){if(a>=100){t={x:1e3,y:1e3,radius:e,color:"#"+Math.floor(16777215*Math.random()).toString(16)};break}let r,i;if(Math.random()<.7){const e=500;r=player.x+(Math.random()-.5)*e,i=player.y+(Math.random()-.5)*e,r=Math.max(0,Math.min(2e3,r)),i=Math.max(0,Math.min(2e3,i))}else r=200+1600*Math.random(),i=200+1600*Math.random();if(isPositionValid(r,i,e)){t={x:r,y:i,radius:e,color:"#"+Math.floor(16777215*Math.random()).toString(16)};break}a++}food.push(t)}function gameLoop(e){if("playing"!==gameState)return;lastFrameTime||(lastFrameTime=e);const t=e-lastFrameTime;if(t>=frameInterval){lastFrameTime=e-t%frameInterval,ctx.clearRect(0,0,gameCanvas.width,gameCanvas.height);const a=50,r=.5,i=Math.max(r,a/(.3*player.radius+10));ctx.save(),ctx.translate(gameCanvas.width/2,gameCanvas.height/2),ctx.scale(i,i),ctx.translate(-player.x,-player.y),ctx.fillStyle="#f0f0f0",ctx.fillRect(0,0,2e3,2e3),updatePlayer(),updateSkills(),drawPlayer(),drawSkillEffect(),updateEnemies(),drawEnemies(),updateFood(),drawFood(),checkCollisions(),ctx.restore(),drawScore(),Math.random()<.02&&spawnEnemy(),Math.random()<.3&&spawnFood(),updateLeaderboard()}animationId=requestAnimationFrame(gameLoop)}function updatePlayer(){if(isMouseDown){const e=Math.max(0,30-player.radius),t=Math.max(1,.8*Math.sqrt(e)+1);player.x+=mouseDirection.x*t,player.y+=mouseDirection.y*t;const a=2e3;player.x<0?player.x=a:player.x>a&&(player.x=0),player.y<0?player.y=a:player.y>a&&(player.y=0)}}function updateEnemies(){for(let e=enemies.length-1;e>=0;e--){const t=enemies[e];if(t.target||(t.target=null,t.targetUpdateCounter=0),t.targetUpdateCounter++>=30&&(t.targetUpdateCounter=0,t.target=findBestTarget(t)),t.target){let e,a;if("food"===t.target.type)e=t.target.x,a=t.target.y;else if("enemy"===t.target.type||"player"===t.target.type){if("player"===t.target.type&&t.radius>1.1*player.radius)e=player.x,a=player.y;else if("player"===t.target.type&&t.radius<1.1*player.radius){const r=player.x-t.x,i=player.y-t.y;e=t.x-r,a=t.y-i}else if("enemy"===t.target.type)if(shouldChase(t,t.target))e=t.target.x,a=t.target.y;else{const r=t.target.x-t.x,i=t.target.y-t.y;e=t.x-r,a=t.y-i}const r=e-t.x,i=a-t.y,n=Math.sqrt(r*r+i*i);n>3&&(t.directionX=r/n,t.directionY=i/n)}}else Math.random()<.02&&(t.directionX=2*Math.random()-1,t.directionY=2*Math.random()-1);const a=Math.max(0,30-t.radius),r=Math.max(1,.8*Math.sqrt(a)+1);t.x+=t.directionX*r,t.y+=t.directionY*r;const i=2e3;t.x<0?t.x=i:t.x>i&&(t.x=0),t.y<0?t.y=i:t.y>i&&(t.y=0)}}function findBestTarget(e){let t=null,a=-1;for(let r=0;r<food.length;r++){const i=food[r].x-e.x,n=food[r].y-e.y,o=Math.sqrt(i*i+n*n);o<200&&o<(t?Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):1/0)&&(t={x:food[r].x,y:food[r].y,type:"food",index:r},a=3)}for(let r=0;r<enemies.length;r++){const i=enemies[r];if(e===i)continue;const n=i.x-e.x,o=i.y-e.y,l=Math.sqrt(n*n+o*o);l<200&&(shouldAvoid(e,i)?a<4&&(t={x:i.x,y:i.y,type:"enemy",enemy:i},a=4):shouldChase(e,i)&&l<(t?Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2)):1/0)&&a<2&&(t={x:i.x,y:i.y,type:"enemy",enemy:i},a=2))}const r=player.x-e.x,i=player.y-e.y;return Math.sqrt(r*r+i*i)<200&&(player.radius>1.1*e.radius?a<4&&(t={type:"player"},a=4):e.radius>1.1*player.radius&&a<2&&(t={type:"player"},a=2)),t}function shouldChase(e,t){return!(e.radius<=1.1*t.radius)&&("mouse"===e.type?"dog"===t.type:"cat"===e.type?"mouse"===t.type:"dog"===e.type&&"cat"===t.type)}function shouldAvoid(e,t){return!(e.radius>1.1*t.radius)&&("mouse"===e.type?"cat"===t.type:"cat"===e.type?"dog"===t.type:"dog"===e.type&&"mouse"===t.type)}function updateFood(){for(;food.length<200;)spawnFood()}function checkCollisions(){if(player.radius>1e3)gameWin();else{for(let e=food.length-1;e>=0;e--){const t=player.x-food[e].x,a=player.y-food[e].y;Math.sqrt(t*t+a*a)<player.radius&&(food.splice(e,1),doubleScoreTimer>0?score+=2:score++,player.radius=Math.sqrt(player.radius*player.radius+.5))}for(let e=enemies.length-1;e>=0;e--){const t=enemies[e];for(let e=food.length-1;e>=0;e--){const a=t.x-food[e].x,r=t.y-food[e].y;Math.sqrt(a*a+r*r)<t.radius&&(food.splice(e,1),t.radius=Math.sqrt(t.radius*t.radius+.5))}}for(let e=enemies.length-1;e>=0;e--){const t=enemies[e],a=player.x-t.x,r=player.y-t.y,i=Math.sqrt(a*a+r*r);if(i<player.radius+t.radius)if(player.radius>1.1*t.radius){enemies.splice(e,1);const a=Math.floor(2*t.radius);score+=doubleScoreTimer>0?2*a:a,player.radius=Math.sqrt(player.radius*player.radius+t.radius*t.radius*.5),"mouse"===t.type?setPlayerSkill("dash"):"dog"===t.type?setPlayerSkill("roar"):"cat"===t.type&&setPlayerSkill("doubleScore")}else{if(t.radius>1.1*player.radius)return void gameOver();{const e=Math.atan2(r,a),n=.5*(player.radius+t.radius-i);player.x+=Math.cos(e)*n,player.y+=Math.sin(e)*n,t.x-=Math.cos(e)*n,t.y-=Math.sin(e)*n}}}for(let e=0;e<enemies.length;e++)for(let t=e+1;t<enemies.length;t++){const a=enemies[e],r=enemies[t],i=a.x-r.x,n=a.y-r.y,o=Math.sqrt(i*i+n*n);if(o<a.radius+r.radius)if(a.radius>1.1*r.radius)a.radius=Math.sqrt(a.radius*a.radius+r.radius*r.radius*.5),enemies.splice(t,1),t--;else{if(r.radius>1.1*a.radius){r.radius=Math.sqrt(r.radius*r.radius+a.radius*a.radius*.5),enemies.splice(e,1),e--;break}{const e=Math.atan2(n,i),t=.5*(a.radius+r.radius-o);a.x+=Math.cos(e)*t,a.y+=Math.sin(e)*t,r.x-=Math.cos(e)*t,r.y-=Math.sin(e)*t}}}}}function updateLeaderboard(){if(!leaderboardList)return;let e=[];e.push({name:player.name,size:player.radius,isPlayer:!0,color:player.color});for(let t=0;t<enemies.length;t++)e.push({name:enemies[t].name,size:enemies[t].radius,isPlayer:!1,color:enemies[t].color});e.sort((e,t)=>t.size-e.size),leaderboardList.innerHTML="";const t=Math.min(10,e.length);for(let a=0;a<t;a++){const t=e[a],r=document.createElement("div");r.style.display="flex",r.style.alignItems="center",r.style.marginBottom="1vh",r.style.padding="0.5vh",r.style.borderRadius="5px",r.style.background=a<3?"rgba(240, 240, 240, 0.7)":"transparent";const i=document.createElement("div");i.textContent=a+1+".",i.style.width="2vw",i.style.fontWeight="bold",i.style.marginRight="1vw";const n=document.createElement("div");n.style.width="1vw",n.style.height="1vw",n.style.borderRadius="50%",n.style.backgroundColor=t.color,n.style.marginRight="1vw";const o=document.createElement("div");o.style.flex="1";const l=document.createElement("span");l.textContent=t.name,l.style.fontWeight="bold",l.style.color=t.isPlayer?"blue":"black";const s=document.createElement("span");s.textContent=" - Size: "+Math.round(t.size),s.style.marginLeft="0.5vw",o.appendChild(l),o.appendChild(s),r.appendChild(i),r.appendChild(n),r.appendChild(o),leaderboardList.appendChild(r)}}function gameOver(){gameState="gameOver",animationId&&(cancelAnimationFrame(animationId),animationId=null),ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.fillStyle="rgba(255, 255, 255, 0.9)",ctx.fillRect(0,0,gameCanvas.width,gameCanvas.height),ctx.fillStyle="#000",ctx.font="30px Arial",ctx.textAlign="center",ctx.fillText("Game Over",gameCanvas.width/2,gameCanvas.height/2-20),ctx.font="20px Arial",ctx.fillText("Your Score: "+score,gameCanvas.width/2,gameCanvas.height/2+20),ctx.fillText("Click to play again",gameCanvas.width/2,gameCanvas.height/2+60),ctx.restore(),gameCanvas.addEventListener("click",restartGame)}function gameWin(){gameState="gameWin",animationId&&(cancelAnimationFrame(animationId),animationId=null),ctx.save(),ctx.setTransform(1,0,0,1,0,0),ctx.fillStyle="rgba(255, 255, 255, 0.9)",ctx.fillRect(0,0,gameCanvas.width,gameCanvas.height),ctx.fillStyle="#000",ctx.font="30px Arial",ctx.textAlign="center",ctx.fillText("Congratulations! You Won!",gameCanvas.width/2,gameCanvas.height/2-40),ctx.fillText("You have eaten everything!",gameCanvas.width/2,gameCanvas.height/2-10),ctx.font="20px Arial",ctx.fillText("Final Score: "+score,gameCanvas.width/2,gameCanvas.height/2+30),ctx.fillText("Final Size: "+Math.round(player.radius),gameCanvas.width/2,gameCanvas.height/2+60),ctx.fillText("Click to play again",gameCanvas.width/2,gameCanvas.height/2+100),ctx.restore(),gameCanvas.addEventListener("click",restartGame)}function restartGame(){"gameOver"!==gameState&&"gameWin"!==gameState||(gameCanvas.removeEventListener("click",restartGame),resetGame(),gameLoop(),stopBackgroundMusic(!1),createBackgroundMusic())}function drawPlayer(){if(ctx.fillStyle=player.color,ctx.beginPath(),ctx.arc(player.x,player.y,player.radius,0,2*Math.PI),ctx.fill(),isMouseDown&&(0!==mouseDirection.x||0!==mouseDirection.y)){const e=1.5*player.radius,t=player.x+mouseDirection.x*e,a=player.y+mouseDirection.y*e;ctx.strokeStyle="red",ctx.lineWidth=.1*player.radius,ctx.beginPath(),ctx.moveTo(player.x,player.y),ctx.lineTo(t,a),ctx.stroke();const r=Math.atan2(mouseDirection.y,mouseDirection.x),i=.4*player.radius,n=Math.PI/6;ctx.fillStyle="red",ctx.beginPath(),ctx.moveTo(t,a),ctx.lineTo(t-i*Math.cos(r-n),a-i*Math.sin(r-n));const o=.2*player.radius,l=t-o*Math.cos(r),s=a-o*Math.sin(r);ctx.lineTo(l,s),ctx.lineTo(t-i*Math.cos(r+n),a-i*Math.sin(r+n)),ctx.closePath(),ctx.fill()}ctx.fillStyle=player.color;const e=.6*player.radius;player.radius,ctx.beginPath(),ctx.moveTo(player.x-.3*player.radius,player.y-player.radius),ctx.lineTo(player.x-.7*player.radius,player.y-player.radius-e),ctx.lineTo(player.x-.1*player.radius,player.y-player.radius-.3*e),ctx.closePath(),ctx.fill(),ctx.beginPath(),ctx.moveTo(player.x+.3*player.radius,player.y-player.radius),ctx.lineTo(player.x+.7*player.radius,player.y-player.radius-e),ctx.lineTo(player.x+.1*player.radius,player.y-player.radius-.3*e),ctx.closePath(),ctx.fill(),ctx.fillStyle="white";const t=.15*player.radius,a=.35*player.radius;ctx.beginPath(),ctx.arc(player.x-a,player.y-a/2,t,0,2*Math.PI),ctx.arc(player.x+a,player.y-a/2,t,0,2*Math.PI),ctx.fill(),ctx.fillStyle="black";const r=.5*t;ctx.beginPath(),ctx.arc(player.x-a+.03*player.radius,player.y-a/2,r,0,2*Math.PI),ctx.arc(player.x+a+.03*player.radius,player.y-a/2,r,0,2*Math.PI),ctx.fill(),ctx.strokeStyle="white",ctx.lineWidth=.05*player.radius,ctx.beginPath(),ctx.moveTo(player.x-.2*player.radius,player.y+.1*player.radius),ctx.quadraticCurveTo(player.x,player.y+.25*player.radius,player.x+.2*player.radius,player.y+.1*player.radius),ctx.moveTo(player.x-.15*player.radius,player.y+.1*player.radius),ctx.quadraticCurveTo(player.x,player.y+.2*player.radius,player.x+.15*player.radius,player.y+.1*player.radius),ctx.stroke(),ctx.strokeStyle="white",ctx.lineWidth=.03*player.radius,ctx.beginPath(),ctx.moveTo(player.x-.4*player.radius,player.y+.05*player.radius),ctx.lineTo(player.x-.7*player.radius,player.y-.05*player.radius),ctx.moveTo(player.x-.4*player.radius,player.y+.1*player.radius),ctx.lineTo(player.x-.7*player.radius,player.y+.1*player.radius),ctx.moveTo(player.x-.4*player.radius,player.y+.15*player.radius),ctx.lineTo(player.x-.7*player.radius,player.y+.25*player.radius),ctx.moveTo(player.x+.4*player.radius,player.y+.05*player.radius),ctx.lineTo(player.x+.7*player.radius,player.y-.05*player.radius),ctx.moveTo(player.x+.4*player.radius,player.y+.1*player.radius),ctx.lineTo(player.x+.7*player.radius,player.y+.1*player.radius),ctx.moveTo(player.x+.4*player.radius,player.y+.15*player.radius),ctx.lineTo(player.x+.7*player.radius,player.y+.25*player.radius),ctx.stroke(),ctx.fillStyle="rgba(0, 0, 0, 0.7)",ctx.font=.4*player.radius+"px Arial",ctx.textAlign="center",ctx.textBaseline="top",ctx.fillText(player.name,player.x,player.y-player.radius-.8*player.radius)}function drawEnemies(){for(let e=0;e<enemies.length;e++){const t=enemies[e];if(ctx.fillStyle=t.color,ctx.beginPath(),ctx.arc(t.x,t.y,t.radius,0,2*Math.PI),ctx.fill(),ctx.fillStyle="white","dog"===t.type){const e=.3*t.radius;ctx.beginPath(),ctx.moveTo(t.x-.5*t.radius,t.y-t.radius),ctx.lineTo(t.x-.8*t.radius,t.y-t.radius-e),ctx.lineTo(t.x-.2*t.radius,t.y-t.radius-.5*e),ctx.closePath(),ctx.fill(),ctx.beginPath(),ctx.moveTo(t.x+.5*t.radius,t.y-t.radius),ctx.lineTo(t.x+.8*t.radius,t.y-t.radius-e),ctx.lineTo(t.x+.2*t.radius,t.y-t.radius-.5*e),ctx.closePath(),ctx.fill();const a=.15*t.radius,r=.4*t.radius;ctx.beginPath(),ctx.arc(t.x-r,t.y-r/2,a,0,2*Math.PI),ctx.arc(t.x+r,t.y-r/2,a,0,2*Math.PI),ctx.fill(),ctx.fillStyle="black",ctx.beginPath(),ctx.arc(t.x,t.y,a,0,2*Math.PI),ctx.fill()}else if("mouse"===t.type){const e=.3*t.radius;ctx.beginPath(),ctx.arc(t.x-.5*t.radius,t.y-.8*t.radius,e,0,2*Math.PI),ctx.arc(t.x+.5*t.radius,t.y-.8*t.radius,e,0,2*Math.PI),ctx.fill();const a=.15*t.radius,r=.4*t.radius;ctx.beginPath(),ctx.arc(t.x-r,t.y-r/4,a,0,2*Math.PI),ctx.arc(t.x+r,t.y-r/4,a,0,2*Math.PI),ctx.fill(),ctx.fillStyle="pink",ctx.beginPath(),ctx.arc(t.x,t.y+.2*t.radius,.8*a,0,2*Math.PI),ctx.fill()}else if("cat"===t.type){const e=.4*t.radius;ctx.beginPath(),ctx.moveTo(t.x-.5*t.radius,t.y-t.radius),ctx.lineTo(t.x-.7*t.radius,t.y-t.radius-e),ctx.lineTo(t.x-.3*t.radius,t.y-t.radius),ctx.closePath(),ctx.fill(),ctx.beginPath(),ctx.moveTo(t.x+.5*t.radius,t.y-t.radius),ctx.lineTo(t.x+.7*t.radius,t.y-t.radius-e),ctx.lineTo(t.x+.3*t.radius,t.y-t.radius),ctx.closePath(),ctx.fill();const a=.15*t.radius,r=.4*t.radius;ctx.beginPath(),ctx.arc(t.x-r,t.y-r/2,a,0,2*Math.PI),ctx.arc(t.x+r,t.y-r/2,a,0,2*Math.PI),ctx.fill(),ctx.strokeStyle="white",ctx.lineWidth=.03*t.radius,ctx.beginPath(),ctx.moveTo(t.x-.6*t.radius,t.y+.1*t.radius),ctx.lineTo(t.x-.3*t.radius,t.y+.05*t.radius),ctx.moveTo(t.x-.6*t.radius,t.y+.2*t.radius),ctx.lineTo(t.x-.3*t.radius,t.y+.2*t.radius),ctx.moveTo(t.x+.3*t.radius,t.y+.05*t.radius),ctx.lineTo(t.x+.6*t.radius,t.y+.1*t.radius),ctx.moveTo(t.x+.3*t.radius,t.y+.2*t.radius),ctx.lineTo(t.x+.6*t.radius,t.y+.2*t.radius),ctx.stroke()}ctx.fillStyle="black";const a=.08*t.radius;ctx.beginPath(),ctx.arc(t.x-.4*t.radius,t.y-.2*t.radius,a,0,2*Math.PI),ctx.arc(t.x+.4*t.radius,t.y-.2*t.radius,a,0,2*Math.PI),ctx.fill(),ctx.fillStyle="rgba(0, 0, 0, 0.7)",ctx.font=.4*t.radius+"px Arial",ctx.textAlign="center",ctx.textBaseline="top",ctx.fillText(t.name,t.x,t.y-t.radius-.6*t.radius)}}function drawFood(){for(let e=0;e<food.length;e++)ctx.fillStyle=food[e].color,ctx.beginPath(),ctx.arc(food[e].x,food[e].y,food[e].radius,0,2*Math.PI),ctx.fill()}function drawScore(){ctx.fillStyle="#000",ctx.font="20px Arial",ctx.textAlign="left",ctx.fillText("Score: "+score,20,30),ctx.fillText("Size: "+Math.round(player.radius),20,60),ctx.fillText("View: "+Math.round(player.radius/10*100)+"%",20,90)}function cleanupGame(){gameCanvas.removeEventListener("mousedown",handleMouseDown),document.removeEventListener("mousemove",handleMouseMove),document.removeEventListener("mouseup",handleMouseUp),gameCanvas.removeEventListener("touchstart",handleTouchStart),document.removeEventListener("touchmove",handleTouchMove),document.removeEventListener("touchend",handleTouchEnd),animationId&&(cancelAnimationFrame(animationId),animationId=null),stopBackgroundMusic()}startBtn.addEventListener("click",()=>{playerName=playerNameInput.value.trim()||"player",gameContainer.classList.add("show"),setupCanvas(),createFishBg(gameFishBg),"idle"===gameState&&initGame(),resetGame(),lastFrameTime=0,animationId&&cancelAnimationFrame(animationId),animationId=requestAnimationFrame(gameLoop),musicPlaying=!0,createBackgroundMusic()}),backBtn.addEventListener("click",()=>{gameContainer.classList.remove("show"),stopBackgroundMusic(),gameState="idle",animationId&&(cancelAnimationFrame(animationId),animationId=null),stopBackgroundMusic()})</script>