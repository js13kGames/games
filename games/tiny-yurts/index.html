<title>Tiny Yurts - js13kGames 2023</title><meta name=viewport content=width=device-width><body><script>let S="#8a5",P="#794",F="#b75",Y="#dee",q="#abb",d="#f80",G="#000",n="#443",Z="#e31",D="#0001",R="#0002",p=(t="svg")=>document.createElementNS("http://www.w3.org/2000/svg",t),s=(t="div")=>document.createElement(t),W=s(),K=(W.style.cssText="position:absolute;display:grid;place-items:center;overflow:hidden;background:"+S,W.style.width="100vw",W.style.height="100vh",document.body.append(W),s()),U=(K.style.cssText="position:absolute;display:grid;background:repeating-linear-gradient(-55deg,#0001 0 12px,#0000 0 24px)",K.style.width="100vw",K.style.height="100vh",K.style.opacity=0,K.style.willChange="opacity",K.style.transition="opacity.3s",s()),i=(U.style.cssText="position:absolute;display:grid;background:repeating-linear-gradient(-55deg,#f002 0 12px,#0000 0 24px)",U.style.width="100vw",U.style.height="100vh",U.style.opacity=0,U.style.willChange="opacity",U.style.transition="opacity.3s",W.append(K,U),p());function j(t){return 180*t/Math.PI}function V(t,e){return Math.atan2(e.y-t.y,e.x-t.x)}i.style.cssText="position:relative;display:grid;touch-action:none",i.setAttribute("viewBox","0 0 208 112"),i.setAttribute("preserveAspectRatio","xMidYMid slice"),i.style.width="100vw",i.style.height="100vh",i.style.maxHeight="68vw",i.style.maxWidth="200vh",W.append(i);class _{constructor(t=0,e=0,s){null!=t.x?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e)}set(t){this.x=t.x,this.y=t.y}add(t){return new _(this.x+t.x,this.y+t.y,this)}t(t){return new _(this.x-t.x,this.y-t.y,this)}scale(t){return new _(this.x*t,this.y*t)}normalize(t=this.length()||1){return new _(this.x/t,this.y/t)}i(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}h(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.i(t)/(this.length()*t.length()))}}function c(){return new _(...arguments)}class X extends class{constructor(t){return this.init(t)}init(t={}){this.position=new c,this.o=new c,this.l=new c,this.p=!0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let e=this.l,s=(t&&(e=e.scale(t)),this.o=this.o.add(e),this.o);t&&(s=s.scale(t)),this.position=this.position.add(s),this.u()}get dx(){return this.o.x}get dy(){return this.o.y}set dx(t){this.o.x=t}set dy(t){this.o.y=t}u(){}}{init({width:t=1,height:e=1,g:s=this.m,update:i=this.advance,children:r=[],...l}){this.M=[],super.init({width:t,height:e,...l}),this.k(r),this.v=s,this.$=i}update(e){this.$(e),this.children.map(t=>t.update&&t.update(e))}g(){this.v(),this.children.map(t=>t.g&&t.g())}u(){this.children.map(t=>t.u())}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this.u()}set y(t){this.position.y=t,this.u()}get width(){return this.T}set width(t){this.T=t,this.u()}get height(){return this._}set height(t){this._=t,this.u()}set children(t){this.removeChild(this.M),this.k(t)}get children(){return this.M}k(...t){t.flat().map(t=>{this.children.push(t),t.L=this,t.u=t.u||noop,t.u()})}}let N=p("rect"),J=p("rect");p("rect");let x,tt={S:((t=p("rect")).setAttribute("fill",S),t.setAttribute("width","160.5px"),t.setAttribute("height","80.5px"),t.setAttribute("transform","translate(23.75 15.75)"),void i.append(t)),B:(t=p("g"),i.append(t),t),D:(t=p("defs"),i.append(t),(Q=p("pattern")).setAttribute("id","grid"),Q.setAttribute("width",8),Q.setAttribute("height",8),Q.setAttribute("patternUnits","userSpaceOnUse"),t.append(Q),(O=p("path")).setAttribute("d","M8 0 0 0 0 8"),O.setAttribute("fill","none"),O.setAttribute("stroke","#0001"),O.setAttribute("stroke-width",1),Q.append(O),N.setAttribute("width","160.5px"),N.setAttribute("height","80.5px"),N.setAttribute("transform","translate(23.75 15.75)"),N.setAttribute("fill","url(#grid)"),N.style.opacity=0,N.style.willChange="opacity",N.style.transition="opacity.3s",(Q=p("pattern")).setAttribute("id","gridred"),Q.setAttribute("width",8),Q.setAttribute("height",8),Q.setAttribute("patternUnits","userSpaceOnUse"),t.append(Q),(O=p("path")).setAttribute("d","M8 0 0 0 0 8"),O.setAttribute("fill","none"),O.setAttribute("stroke","#f002"),O.setAttribute("stroke-width",1),Q.append(O),J.setAttribute("width","160.5px"),J.setAttribute("height","80.5px"),J.setAttribute("transform","translate(23.75 15.75)"),J.setAttribute("fill","url(#gridred)"),J.style.opacity=0,J.style.willChange="opacity",J.style.transition="opacity.3s",void i.append(N,J)),A:((t=p("g")).setAttribute("fill","none"),i.append(t),t),P:((Q=p("g")).setAttribute("fill",P),i.append(Q),Q),O:((O=p("g")).setAttribute("stroke-linecap","round"),O.setAttribute("fill","none"),O.setAttribute("stroke",P),O.setAttribute("stroke-width",3.14),i.append(O),O),Y:((t=p("g")).setAttribute("stroke-linecap","round"),t.setAttribute("fill","none"),t.setAttribute("stroke",G),t.setAttribute("opacity",.12),t.setAttribute("transform","translate(.3,.3)"),i.append(t),t),j:((Q=p("g")).setAttribute("stroke-linecap","round"),Q.setAttribute("fill","none"),Q.setAttribute("stroke","#dca"),Q.setAttribute("stroke-width",3.14),i.append(Q),Q),Z:((O=p("g")).setAttribute("opacity",.12),O.setAttribute("transform","translate(.3,.3)"),i.append(O),O),C:((t=p("g")).setAttribute("stroke-linecap","round"),t.setAttribute("fill","none"),t.setAttribute("stroke",G),t.setAttribute("opacity",.2),i.append(t),t),W:((Q=p("g")).setAttribute("stroke-linecap","round"),i.append(Q),Q),q:((O=p("g")).setAttribute("stroke-linecap","round"),O.setAttribute("fill","none"),i.append(O),O),N:((t=p("g")).setAttribute("stroke-linecap","round"),t.setAttribute("fill","none"),t.setAttribute("stroke",G),t.setAttribute("opacity",.12),t.setAttribute("transform","translate(.5,.5)"),i.append(t),t),R:((Q=p("g")).setAttribute("stroke-linecap","round"),Q.setAttribute("fill","none"),i.append(Q),Q),F:(O=p("g"),i.append(O),O),G:((t=p("g")).setAttribute("stroke-linecap","round"),t.setAttribute("fill","#fff"),i.append(t),t),U:(Q=p("g"),i.append(Q),Q),I:((O=p("g")).setAttribute("stroke-linecap","round"),i.append(O),O),J:((t=p("rect")).setAttribute("width","160.5px"),t.setAttribute("height","80.5px"),t.setAttribute("transform","translate(23.5 15.5)"),t.setAttribute("fill","none"),t.setAttribute("stroke-width",0),t.style.cursor="cell",t.style.pointerEvents="all",i.append(t),t)},{W:et,Z:st,P:it,R:rt,N:lt,A:nt,J:f,j:at,O:ht,q:ot,I:yt,B:pt,Y:ut,U:dt,F:ct,C:xt,G:ft}=tt,gt=()=>{et.innerHTML="",st.innerHTML="",it.innerHTML="",rt.innerHTML="",lt.innerHTML="",nt.innerHTML="",at.innerHTML="",ht.innerHTML="",ot.innerHTML="",yt.innerHTML="",pt.innerHTML="",ut.innerHTML="",dt.innerHTML="",ct.innerHTML="",xt.innerHTML="",ft.innerHTML=""},bt=44100,mt={H:"false"!=localStorage.getItem("Tiny Yurtss")},At=()=>x=x||new AudioContext,wt=(n,a=2,h=1,o=1,y=1,p=1e4,u=100,d=()=>2*Math.random()-1)=>{if(mt.H){let t,e=[],s=[],i=0,r=bt/(130.81*1.0595**n),l=()=>(t=!1,s.length>1+Math.floor(r)?(s[i]=.5*s[i<s.length-1?i+1:0]+s[i]*(.5-o/1e3),i>=Math.floor(r)&&(t=!0,s[i+1]=.5*s[0]+.5*s[i+1]),i=t?0:i+1,s[i]):(s.push(d()),s.at(-1)));for(let t=0;bt*a>t;t++)e[t]=t<88?t/88*l():(1-(t-88)/(bt*a))*l();(n=x.createBuffer(1,bt*a,bt)).getChannelData(0).set(e);var c=x.createBufferSource();c.buffer=n,c.playbackRate.value=h,(n=x.createBiquadFilter()).type="lowpass",n.frequency.value=p,(h=x.createBiquadFilter()).type="lowpass",h.frequency.value=p,(p=x.createBiquadFilter()).type="highpass",p.frequency.value=u,(u=x.createGain()).gain.value=y,c.connect(n),n.connect(h),h.connect(p),p.connect(u),u.connect(x.destination),c.start()}},Tt={[F]:{K:0,V:[[18,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[13,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[10,.5,.5,30,.2,1800,200],[18,.5,.5,30,.2,1800,200],[13,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[18,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[13,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[10,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[18,.5,.5,30,.2,1800,200],[13,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[18,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[13,.5,.5,30,.2,1800,200],[15,.5,.5,30,.2,1800,200],[10,.5,.5,30,.2,1800,200],[13,.5,.5,30,.2,1800,200],[8,.5,.5,30,.2,1800,200],[10,.5,.5,30,.2,1800,200],[5,.5,.5,30,.2,1800,200],[8,.5,.5,30,.2,1800,200]]},[q]:{K:0,V:[[30,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[25,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[22,1,1,1,.2,3e3,1e3],[30,1,1,1,.2,3e3,1e3],[25,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[30,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[25,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[22,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[30,1,1,1,.2,3e3,1e3],[25,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[30,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[25,1,1,1,.2,3e3,1e3],[27,1,.995,1,.2,3e3,1e3],[22,1,1,1,.2,3e3,1e3],[25,1,1,1,.2,3e3,1e3],[20,1,1,1,.2,3e3,1e3],[22,1,1,1,.2,3e3,1e3],[17,1,1,1,.2,3e3,1e3],[20,1,1,1,.2,3e3,1e3]]},[d]:{K:0,V:[[70,.1,.05,900,1,1e3,200],[73,.1,.05,900,1,1e3,200],[68,.1,.05,900,1,1e3,200],[70,.1,.05,900,1,1e3,200],[70,.1,.05,900,1,1e3,200],[73,.1,.05,900,1,1e3,200],[68,.1,.05,900,1,1e3,200]]}},vt=()=>{x&&wt(1,.5,1,0,1,1e3,300,()=>2)},Mt=t=>{var e;x&&(e=Tt[t].V[Tt[t].K],Tt[t].K=(Tt[t].K+1)%Tt[t].V.length,wt(...e))},kt=[];var t,$t;class Et extends X{constructor(t){super({...t}),kt.push(this),this.X=[],this.tt()}tt(){var t=4*Math.random(),e=4+8*this.x,s=4+8*this.y;this.et=p("g"),this.et.style.transform=`translate(${e}px,${s}px)`,dt.append(this.et),this.it=p("g"),this.it.style.transform=`translate(${e}px,${s}px)`,ct.append(this.it);for(let r=0;t>r;r++){let s=Math.random()/2+1,i=new c(8*Math.random()-4,8*Math.random()-4);if(!this.X.some(t=>t.position.h(i)<t.size+s+.5)){this.X.push({position:i,size:s});let t=p("circle"),e=(t.style.transform=`translate(${i.x}px,${i.y}px)`,t.setAttribute("fill","#ac6"),t.style.transition="r.4s cubic-bezier(.5,1.5,.5,1)",setTimeout(()=>t.setAttribute("r",s),100*r),this.et.append(t),p("ellipse"));e.setAttribute("rx",0),e.setAttribute("ry",0),e.style.opacity=0,e.style.transform=`translate(${i.x}px,${i.y}px)rotate(45deg)`,e.style.transition="all.4s cubic-bezier(.5,1.5,.5,1)",setTimeout(()=>{e.setAttribute("rx",1.2*s),e.setAttribute("ry",.9*s),e.style.opacity=.1,e.style.transform=`translate(${i.x+.7*s}px,${i.y+.7*s}px)rotate(45deg)`},100*r),this.it.append(e)}}}remove(){this.et.remove(),this.it.remove();for(let t=0;t<this.X.length;t++)setTimeout(()=>{x&&wt(10,.1,1,1e3,.2,1500,500,()=>2)},100*t);kt.splice(kt.findIndex(t=>t==this),1)}}let Lt=t=>4+8*t,Ht=[],Ct=[],zt=[],Bt=[],It=({st:s,ht:i})=>{let t=Ht,u=(Ct=[],t.forEach(s=>{t.forEach(e=>{s==e||Ct.find(t=>t.rt==e&&t.ot==s)||s.nt||e.nt||(s.lt[0].x==e.lt[0].x&&s.lt[0].y==e.lt[0].y?Ct.push({rt:s,ot:e,lt:[s.lt[1],s.lt[0],e.lt[1]]}):s.lt[0].x==e.lt[1].x&&s.lt[0].y==e.lt[1].y?Ct.push({rt:s,ot:e,lt:[s.lt[1],s.lt[0],e.lt[0]]}):s.lt[1].x==e.lt[0].x&&s.lt[1].y==e.lt[0].y?Ct.push({rt:s,ot:e,lt:[s.lt[0],s.lt[1],e.lt[1]]}):s.lt[1].x==e.lt[1].x&&s.lt[1].y==e.lt[1].y&&Ct.push({rt:s,ot:e,lt:[s.lt[0],s.lt[1],e.lt[0]]}))})}),[]);Ct.forEach(t=>{let{rt:e,ot:s,lt:i}=t,r=`M${4+8*i[0].x} `+(4+8*i[0].y),l=Lt(i[0].x+(i[1].x-i[0].x)/2),n=Lt(i[0].y+(i[1].y-i[0].y)/2),a=`L${l} `+n,h=`L${4+8*i[2].x} `+(4+8*i[2].y),o=`Q${4+8*i[1].x} ${4+8*i[1].y} ${Lt(i[1].x+(i[2].x-i[1].x)/2)} `+Lt(i[1].y+(i[2].y-i[1].y)/2),y=Ct.find(t=>i[0].x==t.lt[1].x&&i[0].y==t.lt[1].y)?`M${l} `+n:r+a,p=Ct.find(t=>i[2].x==t.lt[1].x&&i[2].y==t.lt[1].y)?"":h;u.push({rt:e,ot:s,d:y+o+p})}),t.forEach(e=>{var t,s;Ct.find(t=>t.rt==e||t.ot==e)||e.nt||(t=4+8*(s=e.lt)[0].x+" "+(4+8*s[0].y),s=4+8*s[1].x+" "+(4+8*s[1].y),u.push({path:e,d:`M${t}L`+s,dt:t,ct:s}))}),u.forEach(r=>{var t,e;zt.forEach(t=>{var e=r.path&&r.path==t.path,s=r.rt&&r.rt==t.rt,i=r.ot&&r.ot==t.ot;(e||s&&i)&&(r.ut=t.ut,r.xt=t.xt,r.ft=t.ft,r.d!=t.d)&&(t.d=r.d,r.ut.setAttribute("d",r.d),null!=(e=r.xt)&&e.setAttribute("d",r.d))}),zt.forEach(e=>{var t;u.find(t=>e.d==t.d)||e.path&&(s&&e.path&&e.path.lt[0].yt?setTimeout(()=>{var t;e.ut.remove(),null!=(t=e.xt)&&t.remove()},500):(e.ut.remove(),null!=(t=e.xt)&&t.remove()))}),r.ut||(r.ut=p("path"),r.ut.setAttribute("d",r.d),r.ut.style.transition="all.4s,opacity.2s",(null!=(t=r.path)&&t.lt[0].gt||null!=(t=r.path)&&t.lt[1].gt||null!=(t=r.rt)&&t.lt[0].gt||null!=(t=r.rt)&&t.lt[1].gt||null!=(t=r.ot)&&t.lt[0].gt||null!=(t=r.ot)&&t.lt[1].gt)&&(r.ut.style.strokeDasharray="0 3px",r.ut.style.strokeWidth="2px",r.ut.style.stroke="#bbb",r.xt=p("path"),r.xt.setAttribute("d",r.d),r.xt.style.transition="all.4s opacity.2s",r.xt.style.strokeDasharray="0 3px",r.xt.style.strokeWidth="2px",r.xt.style.stroke=G,ut.append(r.xt)),at.append(r.ut),t=r.path&&Bt.some(t=>t.x==r.path.lt[0].x&&t.y==r.path.lt[0].y||t.x==r.path.lt[1].x&&t.y==r.path.lt[1].y),e=null==(e=r.path)?void 0:e.lt[0].yt,null!=r.path&&t&&!e)||(r.ut.setAttribute("stroke-width",0),r.ut.setAttribute("opacity",0),r.ut.style.willChange="stroke-width,opacity",e&&(r.ut.setAttribute("d",`M${r.dt}L`+r.dt),setTimeout(()=>{r.ut.setAttribute("d",`M${r.dt}L`+r.ct)},20)),i||(r.ft=p("path"),r.ft.setAttribute("d",r.d),ht.append(r.ft),setTimeout(()=>{var t;null!=(t=r.ft)&&t.remove(),r.ut.style.willChange=""},500)),setTimeout(()=>{r.ut.removeAttribute("stroke-width"),r.ut.setAttribute("opacity",1)},20))}),zt=[...u],Bt=[]};class Qt extends X{constructor(t){var e=t.lt;super({...t,lt:e}),kt.filter(e=>this.lt.some(t=>t.x==e.x&&t.y==e.y)).forEach(t=>t.remove()),Ht.push(this)}remove(){zt=zt.filter(e=>{var t;return e.path!=this&&e.rt!=this&&e.ot!=this||(e.ut.setAttribute("opacity",0),e.ut.setAttribute("stroke-width",0),null!=(t=e.xt)&&t.setAttribute("opacity",0),null!=(t=e.xt)&&t.setAttribute("stroke-width",0),setTimeout(()=>{var t;e.ut.remove(),null!=(t=e.xt)&&t.remove()},500),!1)}),Ht.splice(Ht.findIndex(t=>t==this),1),Bt.push({x:this.lt[0].x,y:this.lt[0].y},{x:this.lt[1].x,y:this.lt[1].y})}}let g={wt:18},Ot=(t,e)=>{var s=f.getBoundingClientRect().width/20;return{x:3+Math.floor(t/s),y:2+Math.floor(e/s)}},St=(t,e)=>{var s=f.getBoundingClientRect().width/20;return{x:(3+t)*s,y:(2+e)*s}},Pt=[],Ft=({from:e,to:t})=>{var s=Pt.find(t=>t.x==e.x&&t.y==e.y),i=Pt.filter(e=>t.find(t=>e.x==t.x&&e.y==t.y));{var n=Pt,a=i;let r=[{node:s,path:[]}],l=[];for(;r.length;){let{node:i,path:t}=r.shift();if(null==i)return!1;if(a.find(t=>i.x==t.x&&i.y==t.y))return t.concat(i);if(!l.some(t=>t.x==i.x&&t.y==i.y)){l.push(i);let e=[],s=[];i.bt.forEach(t=>{(1==Math.abs(t.x-i.x)&&t.y==i.y||1==Math.abs(t.y-i.y)&&t.x==i.x?e:s).push(t)}),e.forEach(e=>{l.some(t=>t.x==e.x&&t.y==e.y)||r.push({node:n.find(t=>t.x==e.x&&t.y==e.y),path:t.concat({...i,h:1})})}),s.forEach(e=>{l.some(t=>t.x==e.x&&t.y==e.y)||r.push({node:n.find(t=>t.x==e.x&&t.y==e.y),path:t.concat({...i,h:1.41})})})}}return null}},Yt=t=>t.map(t=>({value:t,sort:Math.random()})).sort((t,e)=>t.sort-e.sort).map(({value:t})=>t),qt=[];class Gt extends X{constructor(t){super({...t});var t=2*Math.random()-1,e=2*Math.random()-1;this.type=this.L.type,this.Mt=!0,this.kt=0,this.destination=null,this.x=4+8*this.L.x+t,this.y=4+8*this.L.y+e,qt.push(this)}tt(){var t=this.x,e=this.y,s=p("path");s.setAttribute("d","M0 0 0 0"),s.setAttribute("transform",`translate(${t},${e})`),s.setAttribute("stroke",this.type),ot.append(s),this.ut=s,(s=p("path")).setAttribute("stroke-width",1.2),s.setAttribute("d","M0 0 .3 .3"),s.setAttribute("transform",`translate(${t},${e})`),xt.append(s),this.vt=s}g(){var t,e;this.ut&&(t=this.x,e=this.y,this.ut.setAttribute("transform",`translate(${t},${e})`),this.vt.setAttribute("transform",`translate(${t},${e})`))}update(){if(this.advance(),(this.Mt||this.kt)&&(this.dx*=.9,this.dy*=.9),this.kt&&(this.kt++,2==this.kt&&this.$t.type==d&&Yt(this.$t.children).forEach((t,e)=>setTimeout(()=>t.Tt.style.fill=d,250*e)),80<this.kt&&3<this._t.length||120<this.kt&&2<this._t.length||160<this.kt)&&(this.$t.type==d&&Yt(this.$t.children).forEach((t,e)=>setTimeout(()=>t.Tt.style.fill=R,1e3+1e3*e)),null!=(t=Ft({from:{x:this.destination.x,y:this.destination.y},to:[{x:this.L.x,y:this.L.y}]}))&&t.length?(this.Lt=!0,this.kt=0,this.St=!0,this.destination=t.at(-1),this.zt=t,this._t=[...t]):this.kt=40*Math.random()+40),this.St&&this.destination&&null!=(t=this.zt)&&t.length){var t=2*Math.random()-1,e=2*Math.random()-1,t=new c(4+8*this.zt[0].x+t,4+8*this.zt[0].y+e);if(this._t.length<3&&(this.dx*=.9,this.dy*=.9),1==this.zt.length){if(Math.abs(this.x-t.x)<1&&Math.abs(this.y-t.y)<1)return this.Lt?(this.Lt=!1,this.Mt=!0):(this.kt=1,this.$t.Bt-=this.$t.Dt,this.$t.At.splice(this.$t.At.indexOf(this),1)),void(this.St=!1)}else if(Math.abs(this.x-t.x)<2&&Math.abs(this.y-t.y)<2)return void this.zt.shift();for(;.1<this.o.length();)this.dx*=.98,this.dy*=.98;e=this.position.t(t).normalize(),this.x<t.x+.006&&(this.dx-=.01*e.x),this.x>t.x-.006&&(this.dx-=.01*e.x),this.y<t.y+.006&&(this.dy-=.01*e.y),this.y>t.y-.006&&(this.dy-=.01*e.y)}0<(null==(t=this.zt)?void 0:t.length)&&qt.filter(t=>t!=this&&!t.Mt).forEach(t=>{var e,s,i=t.position.h(this.position),r=t.position.h(this.position.add(this.o)),l=(r<i&&r<1.5&&(s=this.position.t(t.position).normalize(),l=Math.PI/2,s=new c({x:s.x*Math.cos(l)-+s.y,y:+s.x-s.y*Math.cos(l)}).scale(.1),this.o.set((e=(l=this.o).length(),s=(l=l.add(s)).length(),l.scale(e/s)))),t.position.h(this.position.add(this.o)));r<6&&.06<this.o.length()&&(l<i?r<1.5?(this.dx*=.86,this.dy*=.86):(this.dx*=.89,this.dy*=.89):(this.dx*=.9,this.dy*=.9))})}}let b=[];class Zt extends X{constructor(t){let{x:e,y:s}=t;super(t),this.lt=[{x:this.x,y:this.y}],setTimeout(()=>{this.Pt=new Qt({lt:[{x:e,y:s,yt:!0},{x:e+this.Qt.x,y:s+this.Qt.y}]}),It({Ot:[{x:e,y:s,yt:!0},{x:e+this.Qt.x,y:s+this.Qt.y}],ht:!0})},1e3),setTimeout(()=>{this.children.push(new Gt({x:this.x,y:this.y,L:this})),this.children.push(new Gt({x:this.x,y:this.y,L:this})),this.children.forEach(t=>t.tt())},2e3),setTimeout(()=>{x&&wt(39,.1,.25,10,.2,1e3,100)},100),b.push(this),this.tt()}Yt(t,e){this.Qt={x:t-this.x,y:e-this.y},zt.filter(t=>t.path==this.Pt||t.rt==this.Pt||t.ot==this.Pt).forEach(t=>{t.ut.setAttribute("stroke-width",0),t.ut.setAttribute("opacity",0),setTimeout(()=>{t.ut.remove()},500)}),this.Pt&&(this.jt=this.Pt,this.jt.nt=!0),this.Pt=new Qt({lt:[{x:this.x,y:this.y,yt:!0},{x:t,y:e}]}),It({Ot:[{x:this.x,y:this.y,yt:!0},{x:t,y:e}],st:!0}),setTimeout(()=>{var t;null!=(t=this.jt)&&t.remove()},400)}tt(){let t=4+8*this.x,e=4+8*this.y,s=p("circle");s.setAttribute("fill",D),s.setAttribute("r",0),s.setAttribute("stroke","none"),s.setAttribute("transform",`translate(${t},${e})`),s.style.willChange="r,opacity",s.style.opacity=0,s.style.transition="all.4s",it.append(s),setTimeout(()=>{s.setAttribute("r",3),s.style.opacity=1},100),setTimeout(()=>s.style.willChange="",600),this.et=p("g"),this.et.style.transform=`translate(${t}px,${e}px)`,ft.append(this.et),this.Zt=p("circle"),this.Zt.style.transition="r.4s",this.Zt.style.willChange="r",setTimeout(()=>this.Zt.setAttribute("r",3),400),setTimeout(()=>this.Zt.style.willChange="",900),this.Ct=p("path"),this.Ct.setAttribute("d","M0 0 0 0"),this.Ct.setAttribute("stroke-width",6),this.Ct.style.transform=`translate(${t}px,${e}px)`,this.Ct.style.opacity=0,this.Ct.style.willChange="d",this.Ct.style.transition="d.6s",xt.append(this.Ct),setTimeout(()=>this.Ct.style.opacity=.8,800),setTimeout(()=>this.Ct.setAttribute("d","M0 0 2 2"),900),setTimeout(()=>this.Ct.style.willChange="",1600),this.Wt=p("circle"),this.Wt.setAttribute("fill","none"),this.Wt.setAttribute("r",1),this.Wt.setAttribute("stroke-dasharray",6.3),this.Wt.setAttribute("stroke-dashoffset",6.3),this.Wt.setAttribute("stroke",this.type),this.Wt.style.willChange="stroke-dashoffset",this.Wt.style.transition="stroke-dashoffset.5s",this.et.append(this.Zt,this.Wt),setTimeout(()=>this.Wt.setAttribute("stroke-dashoffset",0),700),setTimeout(()=>this.Wt.style.willChange="",1300)}qt(){var t=4+8*this.x,e=4+8*this.y;this.Ct.style.transition="transform.2s d.3s",this.Ct.setAttribute("d","M0 0 3 3"),this.et.style.transition="transform.2s",this.et.style.transform=`translate(${t}px,${e}px)scale(1.1)`}Nt(){var t=4+8*this.x,e=4+8*this.y;this.Ct.style.transition="transform.3s d.4s",this.Ct.setAttribute("d","M0 0 2 2"),this.Ct.style.transform=`translate(${t}px,${e}px)scale(1)`,this.et.style.transition="transform.3s",this.et.style.transform=`translate(${t}px,${e}px)scale(1)`}}let Dt=()=>{var t=p(),e=(t.setAttribute("viewBox","0 0 16 16"),t.setAttribute("stroke-linecap","round"),p("path")),s=(e.setAttribute("fill",F),e.setAttribute("d","M15 2h-4c-1 0-5 0-6 2l-2 5c-1 2 0 5 2 5h4l2 2z"),p("path")),i=(s.setAttribute("fill",Y),s.setAttribute("d","M12 3c-2 2-5-1-7-1s-3-.5-3-1c0-.5 2-1 4-1s8 1 6 3z"),p("path"));return i.setAttribute("d","m8 6 0 0"),i.setAttribute("stroke-width",2),i.setAttribute("stroke",n),t.append(e,s,i),t},Rt=()=>{var t=p(),e=(t.setAttribute("viewBox","0 0 20 20"),t.setAttribute("stroke-linecap","round"),t.style.width="48px",t.style.height="48px",p("path")),s=(e.setAttribute("fill",q),e.setAttribute("d","M18 12c-2-3-4-8-7-8-4 0-10 5-10 9 0 3 6 3 8 3l2 4z"),p("path")),i=(s.setAttribute("fill","#bcc"),s.setAttribute("d","M7.4 7.5c-1-4 3.7-6 8-4 1 .4 1 1.3 0 1-3-1-6 1-4 4 1.1 1.6-3.2 2-4-1z"),p("path")),r=(i.setAttribute("fill","#cdd"),i.setAttribute("d","M6 5.8c-1-4 3.7-6 8-4 1 .4 1 1.3 0 1-3-1-6 1-4 4 1.1 1.6-3.2 2-4-1z"),p("path")),l=(r.setAttribute("fill","#cdd"),r.setAttribute("d","M6 15c0 4-2 5-2 4 0-2-1 0-1-1v-3z"),p("path"));return l.setAttribute("d","m7 9.3 0 0"),l.setAttribute("stroke-width",2),l.setAttribute("stroke",n),t.append(s,i,r,e,l),t},Wt=()=>{var t=p(),e=(t.setAttribute("viewBox","0 0 20 20"),t.setAttribute("stroke-linecap","round"),p("path")),s=(e.setAttribute("fill",d),e.setAttribute("d","m17 11 1-4c1-4-5 0-5 4s6 8 5 4zM4 6.5c0-2 2-4 2-4 4 0 7 4 8 8m-11 4c4 2 14 6 6-2"),p("path")),i=(s.setAttribute("fill",d),s.setAttribute("d","m0 11c0 10 16 4 16 0s-16-12-16 0"),p("path"));return i.setAttribute("d","m4 9 0 0"),i.setAttribute("stroke-width",2),i.setAttribute("stroke",n),t.append(s,e,i),t},Kt=s(),Ut=s(),jt=s(),Vt=s(),_t=s(),Xt=s(),Nt=s(),Jt=s(),te=s(),e=s(),m=s(),A=s(),r=s("button"),l=p("path"),ee=p("path"),a=s("button"),se=p("svg"),h=p("path"),o=s(),y=s("button"),ie=p("svg"),u=p("path"),w=s(),T=s("button"),re=p("svg"),le=p("path"),v=p("path"),M=s(),ne=(e,s)=>{var t=Ht.filter(t=>(t.lt[0].x==e&&t.lt[0].y==s||t.lt[1].x==e&&t.lt[1].y==s)&&!t.lt[0].yt&&!t.lt[1].yt);t.forEach(t=>{g.wt<99&&(g.wt++,A.innerText=g.wt),t.remove()}),t.length&&x&&wt(1,.5,1,0,6,800,1500,()=>2),It({Ot:[{x:e,y:s}]})};function ae(t,e,s){return 0==(t=(e.y-t.y)*(s.x-e.x)-(e.x-t.x)*(s.y-e.y))?0:0<t?1:2}let he=[],oe=(s,t)=>{var i=[];for(let e=-t/2+.5;t/2-.5>=e;e++)for(let t=-s/2+.5;s/2-.5>=t;t++)s/2-Math.abs(t)+2*Math.random()-1>Math.abs(e)&&i.push({x:Math.floor(t),y:Math.floor(e)});return 2<i.length?i:oe(s,t)},ye=({width:s,height:i,x:r,y:l})=>{let t=oe(s,i),n=[];t=t.map(t=>({x:r+t.x+Math.floor(s/2),y:l+t.y+Math.floor(i/2)}));for(let e=0;i>e;e++)for(let t=0;s>t;t++)n.push({x:r+t,y:l+e});he.push({width:s,height:i,x:r,y:l,lt:t,Rt:n});let a=(s=>{let i=0;for(let t=1;t<s.length;t++)(s[t].y<s[i].y||s[t].y==s[i].y&&s[t].x<s[i].x)&&(i=t);let t=[],r=i;do{t.push(s[r]);let e=(r+1)%s.length;for(let t=0;t<s.length;t++)2==ae(s[r],s[t],s[e])&&(e=t);r=e}while(r!=i);r=i;do{let e=(r-1+s.length)%s.length;for(let t=0;t<s.length;t++)2==ae(s[r],s[t],s[e])&&(e=t);(r=e)!=i&&t.push(s[r])}while(r!=i);return t})(t),e=p("path");e.setAttribute("fill","#69b");var h=a.reduce((t,e,s)=>{var s=a.at((s+1)%a.length),i=e.x+(s.x-e.x)/2;return t+` ${4+8*e.x} ${4+8*e.y} ${4+8*i} `+(4+8*(e.y+(s.y-e.y)/2))},`M${4+8*(a[0].x+(a.at(-1).x-a[0].x)/2)} ${4+8*(a[0].y+(a.at(-1).y-a[0].y)/2)}Q`),o=(e.setAttribute("d",h+"Z"),e.setAttribute("stroke-width",4),e.setAttribute("stroke-linejoin","round"),e.setAttribute("stroke","#6ab"),p("path")),y=(o.setAttribute("fill","#7bc"),o.setAttribute("d",h+"Z"),o.setAttribute("stroke","#7bc"),o.style.filter="blur(2px)",p("path"));y.setAttribute("d",h+"Z"),y.setAttribute("stroke-width",6),y.setAttribute("stroke","#9b6"),pt.append(y,e,o)},pe="true"==localStorage.getItem("Tiny Yurtsg"),ue={Ft:!1,H:!1},de=()=>{K.style.opacity=.9,N.style.opacity=1,pe||(h.setAttribute("d","M6 5 6 11M10 5 10 11M5 6 8 6 11 6M5 10 11 10"),h.style.transform="rotate(180deg)")},ce=()=>{pe||(K.style.opacity=0,N.style.opacity=0,h.setAttribute("d","M8 4.5 5 11M8 4.5 11 11M5 11 8 4.5 11 11M6 9.5 10 9.5"),h.style.transform="rotate(0)")},xe=(pe?(o.innerHTML="Grid: <u>On",de(),h.setAttribute("d","M6 5 6 11M10 5 10 11M5 6 8 6 11 6M5 10 11 10"),h.style.transform="rotate(180deg)"):(o.innerHTML="Grid: <u>Auto",ce()),()=>{f.style.cursor="crosshair",J.style.opacity=.9,U.style.opacity=.9,ue.Ft||(u.setAttribute("d","M4.5 4.5Q4.5 4.5 11.5 4.5 11.5 4.5 11.5 4.5 11.5 11.5 11.5 11.5 11.5 11.5 11.5 11.5 4.5 11.5 4.5 11.5ZM9 7 7 9M7 7Q9 9 9 9"),u.style.transform="rotate(180deg)")}),fe=()=>{ue.Ft||(J.style.opacity=0,U.style.opacity=0,u.setAttribute("d","M5 7Q5 4 8 4 11 4 11 7 11 8 11 9 11 12 8 12 5 12 5 9ZM8 4 8 8 M8 8 Q11 8 11 7.5"),u.style.transform="rotate(0)")},k=(ue.Ft?(w.innerHTML="Delete: <u>On",u.setAttribute("d","M4.5 4.5 Q4.5 4.5 11.5 4.5 11.5 4.5 11.5 4.5 11.5 11.5 11.5 11.5 11.5 11.5 11.5 11.5 4.5 11.5 4.5 11.5ZM9 7 7 9M7 7Q9 9 9 9"),u.style.transform="rotate(180deg)"):(w.innerHTML='Delete: <abbr title="Right Mouse Button">RMB',u.setAttribute("d","M5 7Q5 4 8 4 11 4 11 7 11 8 11 9 11 12 8 12 5 12 5 9ZM8 4 8 8 M8 8 Q11 8 11 7.5"),u.style.transform="rotate(0)"),{}),ge=!1,be=(e,s)=>b.find(t=>t.x==e&&t.y==s),me=(e,s)=>he.find(t=>t.lt.find(t=>t.x==e&&t.y==s)),Ae=(e,s)=>Ht.find(t=>t.lt[1].x==e&&t.lt[1].y==s&&t.lt[1].gt),we=(e,s,i,r)=>Ht.find(t=>t.lt[0].x==e&&t.lt[0].y==s&&t.lt[1].x==i&&t.lt[1].y==r||t.lt[1].x==e&&t.lt[1].y==s&&t.lt[0].x==i&&t.lt[0].y==r),Te=t=>4+8*t,ve=p("g"),$=p("path"),Me=($.style.opacity=0,$.style.scale=0,$.style.transition="all.2s,scale.4s cubic-bezier(.5,2,.5,1)",ve.append($),ht.append(ve),[]),ke=t=>3+Math.random()*(8*t-6);class $e extends X{constructor(t){super({...t,Gt:{x:.5,y:.5},x:ke((null==(e=t.L)?void 0:e.width)??0),y:ke((null==(e=t.L)?void 0:e.height)??0),rotation:t.rotation??Math.random()*Math.PI*4-2*Math.PI});var e=8*this.L.x+this.x,s=8*this.L.y+this.y;this.Et=t.Et??!1,this.Ut=t.Ut,this.It=!1,this.Jt=null,this.Ht=p("g"),this.Ht.style.opacity=0,this.Ht.style.willChange="opacity,transform",this.Ht.style.transition="all.8s cubic-bezier(.5,2,.5,1)",this.Ht.style.transformOrigin="bottom",this.Ht.style.transformBox="fill-box",this.Ht.style.transform=`translate(${e}px,${s-this.height/2}px)`,yt.append(this.Ht),(t=p("path")).setAttribute("fill","#fff"),t.setAttribute("d","m6 6-2-2a3 3 0 1 1 4 0Z"),t.setAttribute("transform","scale(.5) translate(-6 -8)"),this.Ht.append(t),this.Kt=p("path"),this.Kt.setAttribute("stroke",this.color),this.Kt.setAttribute("d","M3 6 3 6M3 4.5 3 3"),this.Kt.setAttribute("transform","scale(.5) translate(-3 -10.4)"),this.Kt.style.opacity=0,this.Ht.append(this.Kt),this.Vt=p("path"),this.Vt.setAttribute("fill",this.color),this.Vt.setAttribute("d","M6 6 4 4A1 1 0 1 1 6 2 1 1 0 1 1 8 4Z"),this.Vt.setAttribute("transform","scale(.3) translate(-6 -13)"),this.Vt.style.opacity=0,this.Ht.append(this.Vt),Me.push(this)}g(){var t=8*this.L.x+this.x,e=8*this.L.y+this.y;this.Ht.style.transform=`translate(${t}px,${e-this.height/2}px)scale(${this.It||this.Xt?1:0})`}te(){return{x:ke(this.L.width),y:ke(this.L.height)}}ee(){this.Xt=!0,this.Ht.style.opacity=1,this.Kt.style.opacity=0,this.Vt.style.opacity=1}ie(){this.Xt=!1,this.Ht.style.opacity=this.It?1:0,this.Kt.style.opacity=this.It?1:0,this.Vt.style.opacity=0}se(){Mt(this.color),this.It=!0,this.Kt.style.opacity=1,this.Vt.style.opacity=0,this.Ht.style.opacity=1}he(){this.It=!1,this.Vt.style.opacity=this.Xt?1:0,this.Ht.style.opacity=this.Xt?1:0,this.Kt.style.opacity=0}re(t){t?this.se():this.he()}}let Ee=[];class Le extends $e{constructor(t){super({...t,L:t.L,width:1.5,height:2.5,Ut:.6,color:F,Et:!!t.Et&&5e3}),Ee.push(this)}tt(){this.scale=0;let t=p("g");t.style.transformOrigin="center",t.style.transformBox="fill-box",t.style.transition="all 1s",t.style.willChange="transform",this.ut=t,et.prepend(t);var e=p("rect");e.setAttribute("fill",F),e.setAttribute("width",this.width),e.setAttribute("height",this.height),e.setAttribute("rx",this.Ut),t.append(e),(e=p("path")).setAttribute("fill","none"),e.setAttribute("stroke",Y),e.setAttribute("width",this.width),e.setAttribute("height",this.height),e.setAttribute("d","M0 2Q0 1 1 1Q2 1 2 2"),e.setAttribute("transform","translate(-0.2 .6)"),e.setAttribute("stroke-width",.4),this.Et&&(e.style.transition="all 1s",e.style.willChange="opacity",e.style.opacity=0),this.ae=e,t.append(e);let s=p("rect");s.setAttribute("width",this.width),s.setAttribute("height",this.height),s.setAttribute("rx",this.Ut),s.style.transformOrigin="center",s.style.transformBox="fill-box",s.style.transition="all 1s",s.style.willChange="transform",this.oe=s,st.prepend(s),this.g(),Ut.style.width="96px",Ut.style.opacity="1",setTimeout(()=>{this.scale=1,jt.innerText=Ee.length},500),setTimeout(()=>{t.style.transition="",t.style.willChange="",s.style.willChange="",s.style.transition=""},1500)}update(t){if(this.advance(),t&&(1==this.Et&&(this.ae.style.opacity=1),this.Et)&&this.Et--,.99<Math.random()&&(this.ne=this.te()),this.ne){var t=V(this,this.ne)-this.rotation,e=c(this.ne),s=1<e.h(this);if(.1<Math.abs(t%(2*Math.PI)))this.rotation+=0<t?.04:-.04;else if(.1<s){let t=e.t(this).normalize(),s=this.x+.05*t.x,i=this.y+.05*t.y;this.L.children.some(t=>{var e;return this!=t&&(e=(t=c(t)).h({x:this.x,y:this.y}),(t=t.h({x:s,y:i}))<4)&&t<e})||(this.x=s,this.y=i)}}}g(){super.g();var t=8*this.L.x+this.x-this.width/2,e=8*this.L.y+this.y-this.height/2;this.ut.style.transform=`translate(${t}px,${e}px)rotate(${j(this.rotation)-90}deg)scale(${this.scale*(this.Et?.5:1)})`,this.oe.style.transform=`translate(${t}px,${e}px)rotate(${j(this.rotation)-90}deg)scale(${(this.scale+.04)*(this.Et?.5:1)})`}}let E=[];class He extends X{constructor(t){let e=t.le;super(t),this.delay=this.delay??0,this.Bt=0,this.pe=0,this.de=16*this.width+16*this.height,this.ce=0,this.At=[],this.lt=[];for(let e=0;e<this.width;e++)for(let t=0;t<this.height;t++)this.lt.push({x:this.x+e,y:this.y+t});e&&setTimeout(()=>{this.Pt=new Qt({lt:[{x:this.x+e[0].x,y:this.y+e[0].y,yt:e[0].yt,gt:e[0].gt},{x:this.x+e[1].x,y:this.y+e[1].y,yt:e[1].yt,gt:e[1].gt}]}),It({})},1500+t.delay),E.push(this),setTimeout(()=>{this.tt()},t.delay)}ue(t){this.k(t),t.tt()}xe(){var t=this.children.filter(t=>!t.Et),e=t.filter(t=>!t.It),s=t.filter(t=>t.It);this.It?this.ce>t.length?this.children.forEach(t=>t.he()):this.he():(this.re(this.ce>t.length),s.length&&this.ce<s.length&&s[Math.floor(Math.random()*s.length)].he(),e.length&&this.ce>t.length-e.length&&e[Math.floor(Math.random()*e.length)].se())}update(e,t){if(!this.fe){e&&(this.ce=Math.floor(this.Bt/this.Dt),this.Bt+=this.children.length-1+t*t/1e9,this.It&&this.ye(),this.xe()),this.children.forEach(t=>t.update(e));for(let t=0;t<this.ce;t++){if(this.At.length>=this.ce)return;var i=qt.filter(t=>t.Mt&&t.type==this.type);if(0==i.length)return;let e=i[0],s=null;for(let t=0;t<i.length;t++){var r=Ft({from:{x:i[t].L.x,y:i[t].L.y},to:this.lt});s||(s=r,e=i[t]),r&&r.length<s.length&&(s=r,e=i[t]),r&&r.length==s.length&&i[t].L!=e.L&&s.reduce((t,e)=>t+(e.h??0),0)>r.reduce((t,e)=>t+(e.h??0),0)&&(s=r,e=i[t])}s&&(e.destination=s.at(-1),e.St=!0,e.zt=s,e._t=[...s],e.Mt=!1,this.At.push(e),e.$t=this)}}}g(){this.children.forEach(t=>t.g())}tt(){let e=.75+8*this.x,s=.75+8*this.y,i=8*this.width-1-.5,r=8*this.height-1-.5;if(this.type!=d){let t=p("rect");t.style.width=i,t.style.height=r,t.setAttribute("rx",2),t.setAttribute("transform",`translate(${e},${s})`),t.style.opacity=0,t.style.transition="opacity.8s",t.style.willChange="opacity",t.setAttribute("fill",S),nt.append(t),setTimeout(()=>t.style.opacity=1,1e3),setTimeout(()=>t.style.willChange="",2e3)}let t=p("rect"),l=(t.setAttribute("width",i),t.setAttribute("height",r),t.setAttribute("rx",2),t.setAttribute("transform",`translate(${e},${s})`),t.setAttribute("stroke",this.ge),t.setAttribute("stroke-dasharray",this.de),t.setAttribute("stroke-dashoffset",this.de),t.style.transition="all 1s",rt.append(t),p("rect"));l.setAttribute("width",i),l.setAttribute("height",r),l.setAttribute("rx",2),l.style.transform=`translate(${e-.5}px,${s-.5}px)`,l.style.willChange="stroke-dashoffset, transform",l.setAttribute("stroke-dasharray",this.de),l.setAttribute("stroke-dashoffset",this.de),l.style.transition="stroke-dashoffset 1s,transform.5s",lt.append(l),setTimeout(()=>{t.setAttribute("stroke-dashoffset",0),l.setAttribute("stroke-dashoffset",0)},100),setTimeout(()=>{l.style.transform=`translate(${e}px,${s}px)`},1e3),this.Ht=p("g"),this.Ht.translate=`${e+i/2}px,${s+r/2+1.5}px`,this.Ht.style.willChange="opacity,transform",this.Ht.style.transition="all.8s cubic-bezier(.5,2,.5,1)",this.Ht.style.transformOrigin="bottom",this.Ht.style.transformBox="fill-box",this.Ht.style.opacity=0,this.Ht.style.transform=`translate(${this.Ht.translate})scale(0)`,yt.append(this.Ht),this.me=p("path"),this.me.setAttribute("fill","#fff"),this.me.setAttribute("d","m6 6-2-2a3 3 0 1 1 4 0Z"),this.me.setAttribute("transform","translate(-9 -9) scale(1.5)"),this.Ht.append(this.me),this.we=p("circle"),this.we.setAttribute("fill","none"),this.we.setAttribute("stroke-width","2"),this.we.setAttribute("stroke-linecap","square"),this.we.setAttribute("r",2),this.we.setAttribute("stroke",n),this.we.setAttribute("opacity",.2),this.we.setAttribute("transform","scale(1.2) translate(0 -5.3)"),this.Ht.append(this.we),this.be=p("circle"),this.be.setAttribute("fill","none"),this.be.setAttribute("stroke-width","2"),this.be.setAttribute("stroke-linecap","butt"),this.be.setAttribute("r",2),this.be.setAttribute("stroke",Z),this.be.style.willChange="stroke-dashoffset",this.be.style.transition="stroke-dashoffset.5s",this.be.setAttribute("stroke-dasharray",12.56),this.be.setAttribute("stroke-dashoffset",12.56),this.be.style.transition="stroke-dashoffset.3s.1s",this.be.setAttribute("transform","scale(1.2) translate(0 -5.3) rotate(-90)"),this.Ht.append(this.be),this.Ht.style.opacity=1}se(){this.It=!0,this.Ht.style.opacity=1,this.be.style.transition="stroke-dashoffset.4s.8s",this.Ht.style.transform=`translate(${this.Ht.translate})scale(1)`,this.Ht.style.transition="all.8s cubic-bezier(.5,2,.5,1)",Mt(this.type),setTimeout(()=>{this.be.style.transition="stroke-dashoffset.4s"},1e3)}he(){this.It=!1,this.Ht.style.opacity=0,this.be.style.transition="stroke-dashoffset.3s",this.Ht.style.transform=`translate(${this.Ht.translate})scale(0)`,this.Ht.style.transition="all.8s cubic-bezier(.5,2,.5,1).4s"}re(t){t?this.se():this.he()}ye(){var t=2*(e=this.children.filter(t=>!t.Et)).length,e=this.ce-e.length;this.be.setAttribute("stroke-dashoffset",12.56-12.56/t*e),this.Me<e&&(Mt(this.type),this.Ht.style.transform=`translate(${this.Ht.translate})scale(1.2)`,setTimeout(()=>{this.Ht.style.transform=`translate(${this.Ht.translate})scale(1)`},200)),(this.Me=e)==t&&(this.p=!1)}}let Ce=[];class ze extends He{constructor(t){super({...t,ge:F}),this.Dt=225,this.type=F,Ce.push(this),setTimeout(()=>this.ue({}),2e3+t.delay),setTimeout(()=>this.ue({}),3e3+t.delay),setTimeout(()=>this.ue({Et:(Ce.length-1)%2}),4e3+t.delay),this.ke=3,this.fe=!0,setTimeout(()=>this.fe=!1,3e3)}ve(){if(5<=this.ke)return!1;this.ke+=2;for(let t=0;t<this.children.filter(t=>!t.Et).length;t++)setTimeout(()=>this.children.filter(t=>!t.Et)[t].ee(),1e3*t),setTimeout(()=>this.children.filter(t=>!t.Et)[t].ie(),7e3),t&&setTimeout(()=>this.ue({Et:!0}),1e3*t+7e3);return!0}ue({Et:t=!1}){super.ue(new Le({L:this,Et:t}))}update(t,e){super.update(t,e)}}let Be=[];class Ie extends $e{constructor(t){super({...t,L:t.L,width:1,height:1.5,Ut:.6,color:q,Et:!!t.Et&&4e3}),Be.push(this)}tt(){this.scale=0;let t=p("g");t.style.transformOrigin="center",t.style.transformBox="fill-box",t.style.transition="all 1s",t.style.willChange="transform",this.ut=t,et.prepend(t);var e=p("rect");e.setAttribute("fill",q),e.setAttribute("width",this.width),e.setAttribute("height",this.height),e.setAttribute("rx",this.Ut),t.append(e);let s=p("rect");s.setAttribute("width",this.width),s.setAttribute("height",this.height),s.setAttribute("rx",this.Ut),s.style.transformOrigin="center",s.style.transformBox="fill-box",s.style.transition="all 1s",s.style.willChange="transform",this.oe=s,st.prepend(s),this.g(),Vt.style.width="96px",Vt.style.opacity="1",setTimeout(()=>{this.scale=1,_t.innerText=Be.length},500),setTimeout(()=>{t.style.transition="",t.style.willChange="",s.style.willChange="",s.style.transition=""},1500)}update(t){if(this.advance(),t&&this.Et&&this.Et--,.96<Math.random()&&(this.ne=this.te()),this.ne){var t=V(this,this.ne)-this.rotation,e=c(this.ne),s=1<e.h(this);if(.1<Math.abs(t%(2*Math.PI)))this.rotation+=0<t?.1:-.1;else if(.1<s){let t=e.t(this).normalize(),s=this.x+.1*t.x,i=this.y+.1*t.y;this.L.children.some(t=>{var e;return this!=t&&(e=(t=c(t)).h({x:this.x,y:this.y}),(t=t.h({x:s,y:i}))<4)&&t<e})||(this.x=s,this.y=i)}}}g(){super.g();var t=8*this.L.x+this.x-this.width/2,e=8*this.L.y+this.y-this.height/2;this.ut.style.transform=`translate(${t}px,${e}px)rotate(${j(this.rotation)-90}deg)scale(${this.scale*(this.Et?.6:1)})`,this.oe.style.transform=`translate(${t}px,${e}px)rotate(${j(this.rotation)-90}deg)scale(${(this.scale+.04)*(this.Et?.6:1)})`}}let Qe=[];class Oe extends He{constructor(t){super({...t,ge:q}),this.Dt=240,this.type=q,Qe.push(this),setTimeout(()=>this.ue({}),2e3),setTimeout(()=>this.ue({}),3e3),setTimeout(()=>this.ue({Et:(Qe.length-1)%2}),4e3),this.ke=3,this.fe=!0,setTimeout(()=>this.fe=!1,3e3)}ve(){if(this.ke+=1,7<=this.ke)return!1;for(let t=0;t<2;t++)setTimeout(()=>this.children.filter(t=>!t.Et)[t].ee(),1e3*t),setTimeout(()=>this.children.filter(t=>!t.Et)[t].ie(),7e3),t&&setTimeout(()=>this.ue({Et:!0}),1e3*t+7e3);return!0}ue({Et:t=!1}){super.ue(new Ie({L:this,Et:t}))}update(t,e){super.update(t,e)}}let Se=[];class Pe extends $e{constructor(t){super({...t,L:t.L,width:.7,height:1,Ut:1,color:d}),Se.push(this)}tt(){this.scale=0,this.ut=p("g"),this.ut.style.transformOrigin="center",this.ut.style.transformBox="fill-box",this.ut.style.transition="all 1s",this.ut.style.willChange="transform",et.append(this.ut),this.Tt=p("rect"),this.Tt.setAttribute("fill",d),this.Tt.setAttribute("width",this.width),this.Tt.setAttribute("height",this.height),this.Tt.setAttribute("rx",this.Ut),this.Tt.style.transition="fill.2s",this.ut.append(this.Tt),this.g(),Xt.style.width="96px",Xt.style.opacity=1,setTimeout(()=>{this.scale=1,Nt.innerText=Se.length},500),setTimeout(()=>{this.ut.style.transition="",this.ut.style.willChange=""},1500),setTimeout(()=>{this.Tt.setAttribute("fill",R)},4e3)}update(t){if(this.advance(),t&&this.Et&&this.Et--,.96<Math.random()&&(this.ne=this.te()),this.ne){var t=V(this,this.ne)-this.rotation,e=c(this.ne),s=1<e.h(this);if(.1<Math.abs(t%(2*Math.PI)))this.rotation+=0<t?.1:-.1;else if(.1<s){let t=e.t(this).normalize(),s=this.x+.1*t.x,i=this.y+.1*t.y;this.L.children.some(t=>{var e;return this!=t&&(e=(t=c(t)).h({x:this.x,y:this.y}),(t=t.h({x:s,y:i}))<4)&&t<e})||(this.x=s,this.y=i)}}}g(){super.g();var t=8*this.L.x+this.x-this.width/2,e=8*this.L.y+this.y-this.height/2;this.ut.style.transform=`translate(${t}px,${e}px)rotate(${j(this.rotation)-90}deg)scale(${this.scale*(this.Et?.6:1)})`,this.It&&(this.Tt.style.fill=d)}}let Fe=[];class Ye extends He{constructor(t){super({...t,ge:"#eee",width:2,height:2}),this.Dt=1300,this.type=d,Fe.push(this),setTimeout(()=>this.ue({}),2e3+(t.delay??0)),setTimeout(()=>this.ue({}),2500+(t.delay??0)),setTimeout(()=>this.ue({}),3e3+(t.delay??0)),setTimeout(()=>this.ue({}),3500+(t.delay??0)),setTimeout(()=>this.ue({}),4e3+(t.delay??0)),this.ke=5,this.fe=!0,setTimeout(()=>this.fe=!1,3e3)}ve(){if(9<=this.ke)return!1;this.ke+=4;for(let t=0;t<2;t++)setTimeout(()=>this.children[t].ee(),1e3*t),setTimeout(()=>this.children[t].ie(),7e3);for(let t=0;t<4;t++)setTimeout(()=>this.ue({}),1e3*t+7e3);return!0}ue({Et:t=!1}){super.ue(new Pe({L:this,Et:t}))}update(t,e){super.update(t,e)}}let qe=[F,q],Ge=3e3,Ze=()=>{var t;return E.length<qe.length?qe[E.length]:(t=qe.filter(e=>{var t=b.filter(t=>t.type==e),s=E.filter(t=>t.type==e);return t.length>s.length})).at(Math.random()*t.length)},De=()=>{if(E.length<qe.length)return qe[E.length-1];let e={},s=(b.filter(t=>t.type!=d).forEach(t=>{e[t.type]=e[t.type]?e[t.type]+1:1}),{}),i=(E.filter(t=>t.type!=d).forEach(t=>{s[t.type]=s[t.type]?s[t.type]+1:1}),[]);return Object.keys(s).forEach(t=>{i.push(s[t]/e[t])}),Object.keys(s)[(e=>{let t=e.reduce((t,e)=>t+e,0),s=Math.random()*t,i=0;for(let t=0;t<e.length;t++)if((i+=e[t])>s)return t;return null})(i)]},Re=({width:n=1,height:a=1,Gt:h={x:13,y:7,width:0,height:0},$e:o=0,Te:y=99,_e:t=9,Le:p=!0,Se:u={x:0,y:0}})=>{let d=0;for(;t>d;){d++;let t=Math.max(3,h.x-y),e=Math.min(23-n+1,h.x+h.width+y-n+1),s=Math.max(2,h.y-y),i=Math.min(12-a+1,h.y+h.height+y-a+1),r=Math.floor(t+Math.random()*(e-t)),l=Math.floor(s+Math.random()*(i-s));if(!(r<h.x+h.width+o-1&&r>h.x-o-n+1&&l<h.y+h.height+o-1&&l>h.y-o-a+1||r+u.x<3||22<r+u.x||l+u.y<2||11<l+u.y||he.some(t=>t.Rt.some(s=>{for(let e=0;n>e;e++)for(let t=0;a>t;t++)if(r+e==s.x&&l+t==s.y)return!0;return r+u.x==s.x&&l+u.y==s.y}))||E.some(t=>t.lt.some(s=>{for(let e=0;n>e;e++)for(let t=0;a>t;t++)if(r+e==s.x&&l+t==s.y)return!0;return!1})))){let e=t=>t.x==r+u.x&&t.y==l+u.y;if(!(E.some(t=>t.lt.some(e))||Ht.some(s=>{for(let e=0;n>e;e++)for(let t=0;a>t;t++)if(r+e==s.lt[0].x&&l+t==s.lt[0].y||r+e==s.lt[1].x&&l+t==s.lt[1].y)return!0;return!1})||b.some(s=>{for(let e=0;n>e;e++)for(let t=0;a>t;t++)if(r+e==s.x&&l+t==s.y)return!0;if(r+u.x==s.x&&l+u.y==s.y)return!0})||p&&kt.some(s=>{for(let e=0;n>e;e++)for(let t=0;a>t;t++)if(r+e==s.x&&l+t==s.y)return!0;if(r+u.x==s.x&&l+u.y==s.y)return!0})))return{x:r,y:l}}}return null},We=()=>{var t,e=.5<Math.random(),s=e?{w:2,ze:3}:{w:3,ze:2},i={width:s.w,height:s.ze};return E.length||(t=Math.floor(Math.random()*s.w),s=Math.floor(Math.random()*s.ze),i.le=[{x:t,y:s},{x:e?3*t-1:t,y:e?s:3*s-1}]),i},Ke=()=>{var t=Math.random();return{Qt:t<.25?{x:0,y:-1}:t<.5?{x:1,y:0}:t<.75?{x:0,y:1}:{x:-1,y:0}}},Ue=0,je=0,Ve=0,_e=0,L={Be:!1},Xe=(t,n)=>{let a=!1;if(t%Ge==0&&(Ue=Math.floor(200*Math.random()),je=Math.floor(200*Math.random()),Ve=Math.floor(200*Math.random()),_e=Math.floor(200*Math.random())),0==t){.5<Math.random()?(s=Re({width:6,height:4,$e:5,_e:32}))&&ye({width:6,height:4,x:s.x,y:s.y}):((s=Re({width:4,height:4,$e:5,_e:16}))&&ye({width:4,height:4,x:s.x,y:s.y}),(s=Re({width:3,height:2,$e:5,_e:16}))&&ye({width:3,height:2,x:s.x,y:s.y}),(s=Re({width:3,height:2,$e:5,_e:16}))&&ye({width:3,height:2,x:s.x,y:s.y}));for(let t=0;t<9;t++){var e=Re({});new Et({x:e.x,y:e.y})}}if(0==t||1e3<t&&t%Ge==0+(E.length?Ue:0))if(1e4<t&&!Fe.length){var s=he.find(t=>4<=t.width&&4<=t.height),i=s.x<13?1:0,r=s.x<13?2:-1,l=s.x<13?3:-2,h=s.y<7?1:0,o=s.x+s.width/2-1,y=s.y+s.height/2-1;new Ye({x:o,y:y,le:[{x:i,y:h,yt:!0,gt:!0},{x:4<s.width?l:r,y:h,yt:!0,gt:!0}]})}else{let t,{width:e,height:s,le:i}=We(),r=Ze(),l=Re({width:e,height:s,Gt:1<E.length?b.filter(t=>t.type==r).at(Math.random()*b.length):E[E.length-1],Te:E.length+2,$e:E.length?2:0,_e:32,Se:i?{x:i[1].x,y:i[1].y}:{x:0,y:0},Le:!1});if(!l){var p=Yt(E);for(let t=0;t<p.length&&!a;t++)p[t].ve()&&(a=!0);return}if(r==F&&(t=new ze({width:e,height:s,x:l.x,y:l.y,le:i,delay:n})),t=r==q?new Oe({width:e,height:s,x:l.x,y:l.y,le:i,delay:n}):t)return void kt.filter(e=>t.lt.some(t=>t.x==e.x&&t.y==e.y)).forEach(t=>t.remove())}if(t%Ge!=500+(1<E.length?je:0))if(t%Ge==600+je&&L.Be)o=Ke().Qt,y=E.filter(t=>t.type==d).length&&b.filter(t=>t.type==d).length<2?E.find(t=>t.type==d):2<E.length?E.at(Math.random()*E.length):E[E.length-1],(i=Re({Gt:{x:y.x,y:y.y,width:y.width,height:y.height},$e:3,Te:2+E.length,Se:o}))?(new Zt({x:i.x,y:i.y,type:y.type,Qt:o}),L.Be=!1):L.Be=!0;else if(t%Ge==700+je&&L.Be)s=Ke().Qt,l=E.filter(t=>t.type==d).length&&b.filter(t=>t.type==d).length<2?E.find(t=>t.type==d):2<E.length?E.at(Math.random()*E.length):E[E.length-1],(r=Re({Gt:{x:l.x,y:l.y,width:l.width,height:l.height},$e:3,Te:2+E.length,Se:s}))?(new Zt({x:r.x,y:r.y,type:l.type,Qt:s}),L.Be=!1):L.Be=!0;else if(t%Ge!=1500+Ve){if(t%Ge==1600+Ve&&L.Be){let t=Ke().Qt,e=De(),s=b.filter(t=>t.type==e),i=s.at(Math.random()*s.length),r=Re({Gt:{x:i.x,y:i.y,width:1,height:1},$e:1,Te:E.length,Se:t});r?(new Zt({x:r.x,y:r.y,type:e,Qt:t}),L.Be=!1):L.Be=!0}else if(t%Ge==1700+Ve&&L.Be){let t=Ke().Qt,e=De(),s=b.filter(t=>t.type==e),i=s.at(Math.random()*s.length),r=Re({Gt:{x:i.x,y:i.y,width:1,height:1},$e:1,Te:E.length,Se:t});r?(new Zt({x:r.x,y:r.y,type:e,Qt:t}),L.Be=!1):L.Be=!0}else if(t%Ge==2500+_e&&2e4<t){let t,{width:e,height:s,le:i}=We(),r=Ze(),l=Re({width:e,height:s,Gt:1<E.length?b.filter(t=>t.type==r).at(Math.random()*b.length):E[E.length-1],Te:E.length+2,$e:E.length?2:0,Se:i?{x:i[1].x,y:i[1].y}:{x:0,y:0},Le:!1});if(l)r==F&&(t=new ze({width:e,height:s,x:l.x,y:l.y,le:i,delay:n})),(t=r==q?new Oe({width:e,height:s,x:l.x,y:l.y,le:i,delay:n}):t)&&kt.filter(e=>t.lt.some(t=>t.x==e.x&&t.y==e.y)).forEach(t=>t.remove());else{var u=Yt(E);for(let t=0;t<u.length&&!a;t++)u[t].ve()&&(a=!0)}}}else{let t=Ke().Qt,e=De(),s=b.filter(t=>t.type==e),i=s.at(Math.random()*s.length),r=Re({Gt:{x:i.x,y:i.y,width:1,height:1},$e:1,Te:E.length,Se:t});r?(new Zt({x:r.x,y:r.y,type:e,Qt:t}),L.Be=!1):L.Be=!0}else h=Ke().Qt,i=E.filter(t=>t.type==d).length&&b.filter(t=>t.type==d).length<2?E.find(t=>t.type==d):2<E.length?E.at(Math.random()*E.length):E[E.length-1],(y=Re({Gt:{x:i.x,y:i.y,width:i.width,height:i.height},$e:3,Te:2+E.length,Se:h}))?(new Zt({x:y.x,y:y.y,type:i.type,Qt:h}),L.Be=!1):L.Be=!0},H=s();H.style.cssText="backdrop-filter:blur(8px);position:absolute;inset:0;pointer-events:none;background:#fffb";let Ne,Je,ts=s(),es=s(),ss=s(),is=s(),C=s(),z=s(),rs=s(),ls=s("button"),ns=s(),as=s("button"),hs=s(),os=Dt(),ys=s(),ps=Rt(),us=s(),ds=Wt(),cs=s(),B=s("button"),xs=()=>{var t=2*b.length+Me.length,e=(Kt.style.zIndex="",t>localStorage.getItem("Tiny Yurts")&&localStorage.setItem("Tiny Yurts",t),H.style.clipPath="polygon(0 0,100%0,100%100%,0 100%)",H.style.transition="opacity 2s 1s",es.style.transition="opacity.5s 2s",ss.style.transition="opacity.5s 2s",is.style.transition="opacity.5s 2s",C.style.transition="opacity.5s 2s",rs.style.transition="opacity.5s 2.5s",ns.style.transition="opacity.5s 3s",B.style.transition="all.2s,opacity.5s 3.5s",hs.innerHTML="",hs.append(os,"×"+Ee.length),ys.innerHTML="",ys.append(ps,"×"+Be.length),us.innerHTML="",us.append(ds,"×"+Se.length),cs.innerHTML="Score:"+t,(t=s("u")).innerText=2*b.length+" settlers",s("u"));e.innerText=Me.length+" animals",is.innerHTML="",is.append(t," and ",e," lived in your camp."),C.innerHTML="",C.append(hs," ",ys," ",us," ",cs),T.style.transition="all.2s",y.style.transition="all.2s",a.style.transition="all.2s",T.style.opacity=0,y.style.opacity=0,a.style.opacity=0,Jt.style.opacity=0,setTimeout(()=>{B.style.pointerEvents="",ts.style.pointerEvents="",ts.style.opacity=1,H.style.opacity=1,es.style.opacity=1,ss.style.opacity=1,is.style.opacity=1,C.style.opacity=1,rs.style.opacity=1,ns.style.opacity=1,B.style.opacity=1})},fs=()=>{ts.style.transition="opacity 1s 2s",H.style.transition="opacity 1s 1s",es.style.transition="opacity.3s.6s",ss.style.transition="opacity.3s.5s",is.style.transition="opacity.3s.4s",C.style.transition="opacity.3s.3s",rs.style.transition="opacity.3s.2s",ns.style.transition="opacity.3s.1s",ts.style.pointerEvents="none",ts.style.opacity=0,H.style.opacity=0,es.style.opacity=0,ss.style.opacity=0,is.style.opacity=0,C.style.opacity=0,rs.style.opacity=0,ns.style.opacity=0},gs=s(),bs=s(),ms=s(),As=s(),ws=s(),Ts=s("button"),vs=s(),Ms=s("button"),ks=(t,e)=>{gs.style.pointerEvents="",H.style.clipPath="polygon(0 0,calc(20dvw + 400px)0,calc(20dvw + 350px)100%,0 100%)",H.style.transition="clip-path 1s,opacity 2s",bs.style.transition="opacity.5s 1s",vs.style.transition="opacity.5s 1.2s",ws.style.transition="opacity.5s 1.4s",ms.style.transition="opacity.5s 1.6s",e&&(H.style.transition="opacity 0s",bs.style.transition="opacity.5s.4s",vs.style.transition="opacity.5s.6s",ws.style.transition="opacity.5s.8s",ms.style.transition="opacity.5s 1s"),ms.innerHTML=localStorage.getItem("Tiny Yurts")?"Highscore: "+localStorage.getItem("Tiny Yurts"):"Tip: Left click & drag to connect yurts to<br>farms, or delete paths with right click.",e=St(t.x-13-3+t.width/2,t.y-7-2+t.height/2),t=innerWidth/4,i.style.transition="",i.style.transform=`translate(${t}px,0)rotate(-17deg)scale(2)translate(${-e.x}px,${-e.y}px)`,Kt.style.zIndex=1,H.style.opacity=1,bs.style.opacity=1,ms.style.opacity=1,ws.style.opacity=1,vs.style.opacity=1},$s=0,Es=0,I=0,Ls=!1;(Q=s("style")).innerText=`body{position:relative;font-weight:700;font-family:system-ui;color:#443;margin:0;width:100vw;height:100vh;user-select:none}button{font-weight:700;font-family:system-ui;color:#443;border:none;padding:0 20px;font-size:32px;height:56px;border-radius:64px;background:#fff;transition:all.2s,bottom.5s,right.5s,opacity 1s;box-shadow:0 0 0 1px ${D}}button:hover{box-shadow:4px 4px 0 1px ${D}}button:active{transform:scale(.95);box-shadow:0 0 0 1px ${D}}u,abbr{text-decoration-thickness:2px;text-underline-offset:2px}`,document.head.append(Q),Kt.style.cssText="position:absolute;inset:0;display:grid;overflow:hidden;pointer-events:none",Kt.style.zIndex=1,document.body.append(Kt),Jt.style.cssText="display:flex;position:absolute;top:16px;left:16px",Jt.style.transition="opacity 1s",Jt.style.opacity=0,Ut.style.cssText="display:flex;align-items:center;gap:8px;transition:width 1s,opacity 1s 1s";var Q=Dt(),Q=(Ut.style.width=0,Ut.style.opacity=0,Q.style.width="48px",Q.style.height="48px",Ut.append(Q,jt),Vt.style.cssText="display:flex;align-items:center;gap:8px;transition:width 1s,opacity 1s 1s",Rt()),Q=(Vt.style.width=0,Vt.style.opacity=0,Q.style.width="48px",Q.style.height="48px",Vt.append(Q,_t),Xt.style.cssText="display:flex;align-items:center;gap:8px;transition:width 1s,opacity 1s 1s",Wt()),Hs=(Xt.style.width=0,Xt.style.opacity=0,Q.style.width="48px",Q.style.height="48px",Xt.append(Q,Nt),Jt.append(Ut,Vt,Xt),te.style.cssText="position:absolute;display:grid;top:16px;right:16px;place-items:center;border-radius:64px;background:"+n,te.style.width="80px",te.style.height="80px",te.style.opacity=0,te.style.transition="opacity 1s",p("svg"));Hs.setAttribute("stroke-linejoin","round"),Hs.setAttribute("stroke-linecap","round"),Hs.setAttribute("viewBox","0 0 16 16"),Hs.style.width="80px",Hs.style.height="80px";for(let t=75;t<350;t+=25){var Cs=p("path");Cs.setAttribute("fill","none"),Cs.setAttribute("stroke","#eee"),Cs.setAttribute("transform-origin","center"),Cs.setAttribute("d","m8 14.5 0 0"),Cs.style.transform=`rotate(${t}grad)`,Hs.append(Cs)}ee.setAttribute("stroke","#eee"),ee.setAttribute("transform-origin","center"),ee.setAttribute("d","m8 4 0 4"),Hs.append(ee),e.style.cssText="position:absolute;bottom:8px;color:#eee",te.append(Hs,e),m.style.cssText="position:absolute;display:grid;place-items:center;place-self:center;bottom:20px;border-radius:20px;background:"+n,document.body.scrollHeight<500?m.style.left="20px":m.style.left="",addEventListener("resize",()=>{document.body.scrollHeight<500?m.style.left="20px":m.style.left=""}),m.style.transform="rotate(-45deg)",m.style.opacity=0,m.style.transition="scale.4s cubic-bezier(.5,2,.5,1),opacity 1s",m.style.width="72px",m.style.height="72px",A.style.cssText="position:absolute;display:grid;place-items:center;border-radius:64px;border:6px solid #443;transform:translate(28px,28px)rotate(45deg);font-size:18px;background:#eee;transition:all.5s}",A.style.width="28px",A.style.height="28px",(Q=p("svg")).setAttribute("viewBox","0 0 18 18"),Q.style.width="54px",Q.style.height="54px",Q.style.transform="rotate(45deg)";var O=p("path");O.setAttribute("fill","none"),O.setAttribute("stroke","#eee"),O.setAttribute("stroke-linecap","round"),O.setAttribute("stroke-width",2),O.setAttribute("d","M11 1h-3q-2 0-2 2t2 2h4q2 0 2 2t-2 2h-6q-2 0-2 2t2 2h4q2 0 2 2t-2 2h-3"),Q.append(O),m.append(Q,A),(O=p("svg")).setAttribute("viewBox","0 0 16 16"),O.setAttribute("width",64),O.setAttribute("height",64),l.setAttribute("fill",n),l.setAttribute("stroke",n),l.setAttribute("stroke-width",2),l.setAttribute("stroke-linecap","round"),l.setAttribute("stroke-linejoin","round"),l.setAttribute("d","M6 6 6 10M10 6 10 8 10 10"),l.style.transition="all.2s",l.style.transformOrigin="center",l.style.transform="rotate(180deg)",O.append(l),r.style.cssText="position:absolute;padding:0;pointer-events:all",document.body.scrollHeight<500?(r.style.top="108px",r.style.right="20px"):(r.style.top="24px",r.style.right="112px"),addEventListener("resize",()=>{document.body.scrollHeight<500?(r.style.top="108px",r.style.right="20px"):(r.style.top="24px",r.style.right="112px")}),r.style.width="64px",r.style.height="64px",r.style.opacity=0,r.append(O),ie.setAttribute("viewBox","0 0 16 16"),ie.setAttribute("width",48),ie.setAttribute("height",48),u.setAttribute("fill","none"),u.setAttribute("stroke",Z),u.setAttribute("stroke-width",2),u.setAttribute("stroke-linecap","round"),u.setAttribute("stroke-linejoin","round"),u.style.transition="all.3s",u.style.transformOrigin="center",ie.append(u),y.append(ie),y.style.cssText="position:absolute;bottom:72px;right:16px;padding:0;pointer-events:all",y.style.width="48px",y.style.height="48px",w.style.cssText="position:absolute;display:flex;right:16px;align-items:center;color:#eee;font-size:16px;border-radius:64px;padding:0 64px 0 16px;white-space:pre;pointer-events:all;bottom:72px;background:"+n,w.style.height="48px",w.style.width="96px",w.style.transition="all.5s",se.setAttribute("viewBox","0 0 16 16"),se.setAttribute("width",48),se.setAttribute("height",48),h.setAttribute("fill","none"),h.setAttribute("stroke",n),h.setAttribute("stroke-width",2),h.setAttribute("stroke-linecap","round"),h.setAttribute("stroke-linejoin","round"),h.style.transition="all.3s",h.style.transformOrigin="center",se.append(h),a.append(se),a.style.cssText="position:absolute;bottom:16px;right:16px;padding:0;pointer-events:all",a.style.width="48px",a.style.height="48px",o.style.cssText="position:absolute;display:flex;right:16px;align-items:center;color:#eee;font-size:16px;border-radius:64px;padding:0 64px 0 16px;white-space:pre;pointer-events:all;bottom:16px;background:"+n,o.style.height="48px",o.style.width="96px",o.style.transition="all.5s",re.setAttribute("viewBox","0 0 16 16"),re.setAttribute("width",48),re.setAttribute("height",48),le.setAttribute("fill","none"),le.setAttribute("stroke",n),le.setAttribute("stroke-width",2),le.setAttribute("stroke-linecap","round"),le.setAttribute("stroke-linejoin","round"),le.style.transition="all.3s",le.style.transformOrigin="center",le.style.transform="rotate(0)",le.setAttribute("d","M9 13 6 10 4 10 4 6 6 6 9 3"),v.setAttribute("fill","none"),v.setAttribute("stroke",n),v.setAttribute("stroke-width",2),v.setAttribute("stroke-linecap","round"),v.setAttribute("stroke-linejoin","round"),v.style.transition="all.3s",v.style.transformOrigin="center",v.style.transform="rotate(0)",re.append(le,v),T.append(re),T.style.cssText="position:absolute;bottom:128px;right:16px;padding:0;pointer-events:all",T.style.width="48px",T.style.height="48px",M.style.cssText="position:absolute;display:flex;right:16px;align-items:center;color:#eee;font-size:16px;border-radius:64px;padding:0 64px 0 16px;white-space:pre;pointer-events:all;bottom:128px;background:"+n,M.style.height="48px",M.style.width="96px",M.style.transition="all.5s",Kt.append(Jt,te,r,m,w,y,o,a,M,T),document.body.append(H),H.style.opacity=0,t=()=>{i.style.transition="transform 2s",i.style.transform=`rotate(0)scale(2)translate(0,${St(0,14).y/-2}px)`,T.style.transition="all.2s,width.5s 4s,opacity.5s 3s",y.style.transition="all.2s,width.5s 4s,opacity.5s 3s",a.style.transition="all.2s,width.5s 4s,opacity.5s 3s",M.style.transition="all.5s",w.style.transition="all.5s",o.style.transition="all.5s",T.style.opacity=1,y.style.opacity=1,a.style.opacity=1,Ut.style.width=0,Vt.style.width=0,Xt.style.width=0,Ut.style.opacity=0,Vt.style.opacity=0,Xt.style.opacity=0,jt.innerText=0,_t.innerText=0,Nt.innerText=0,r.style.opacity=0,B.style.opacity=0,B.style.pointerEvents="none",B.style.transition="all.2s,opacity.5s",setTimeout(()=>{Qe.length=0,Ce.length=0,qt.length=0,E.length=0,Me.length=0,Ee.length=0,Be.length=0,Se.length=0,b.length=0,Ht.length=0,he.length=0,$s=1,I=1,Es=1,g.wt=18,A.innerText=g.wt,gt(),fs(),i.style.transform="",setTimeout(()=>{Xe(0),zs.start()},1e3)},1e3)},Q=()=>{Ls=!1,i.style.transition="transform 2s",i.style.transform=`rotate(0)scale(2)translate(0,${St(0,14).y/-2}px)`,g.wt=18,Ut.style.width=0,Vt.style.width=0,Xt.style.width=0,Ut.style.opacity=0,Vt.style.opacity=0,Xt.style.opacity=0,jt.innerText=0,_t.innerText=0,Nt.innerText=0,B.style.opacity=0,B.style.pointerEvents="none",B.style.transition="all.2s,opacity.5s",M.style.transition="all.2s,width.5s 4s,opacity.5s 4s",w.style.transition="all.2s,width.5s 4s,opacity.5s 4s",o.style.transition="all.2s,width.5s 4s,opacity.5s 4s",T.style.transition="all.2s,width.5s 4s,opacity.5s 4s",y.style.transition="all.2s,width.5s 4s,opacity.5s 4s",a.style.transition="all.2s,width.5s 4s,opacity.5s 4s",M.style.width="96px",w.style.width="96px",o.style.width="96px",M.style.opacity=1,w.style.opacity=1,o.style.opacity=1,T.style.opacity=1,y.style.opacity=1,a.style.opacity=1,setTimeout(()=>{Qe.length=0,Ce.length=0,qt.length=0,E.length=0,Me.length=0,Ee.length=0,Be.length=0,Se.length=0,b.length=0,Ht.length=0,he.length=0,$s=0,Es=0,I=0,gt(),fs(),i.style.transform="",A.innerText=g.wt,setTimeout(()=>{Xe(I,Ls),ks(E[0]),zs.start()},750)},500)},O=()=>{(Ne?(Ne=!1,i.style.transform=`rotate(-17deg)scale(2)translate(${-Je.x}px,${-Je.y}px)`,xs):(Ne=!0,i.style.transform="",fs))()},ts.style.cssText="position:absolute;inset:0;padding:10vmin;display:flex;flex-direction:column",ts.style.pointerEvents="none",ts.style.opacity=0,es.style.cssText="font-size:72px;opacity:0",es.innerText="Game Over",ss.style.cssText="margin-top:48px;font-size:24px;opacity:0",ss.innerText="Too few people could tend to this farm in time.",is.style.cssText="margin-top:16px;font-size:24px;opacity:0",C.style.cssText="display:flex;flex-wrap:wrap;gap:4px;margin-top:24px;font-size:24px",C.style.opacity=0,document.body.scrollHeight<500?(C.style.position="absolute",C.style.bottom="10vmin",C.style.right="10vmin"):(C.style.position="",C.style.bottom="",C.style.right=""),addEventListener("resize",()=>{document.body.scrollHeight<500?(C.style.position="absolute",C.style.bottom="10vmin",C.style.right="10vmin"):(C.style.position="",C.style.bottom="",C.style.right="")}),hs.style.cssText="display:inline-flex;padding:6px 12px;line-height:24px;color:#fff;border-radius:64px;background:"+n,ys.style.cssText="display:inline-flex;padding:6px 12px;line-height:24px;color:#fff;border-radius:64px;background:"+n,us.style.cssText="display:inline-flex;padding:6px 12px;line-height:24px;color:#fff;border-radius:64px;background:"+n,cs.style.cssText="display:inline-flex;padding:6px 12px;line-height:24px;color:#fff;border-radius:64px;background:"+n,os.style.width="24px",os.style.height="24px",ps.style.width="24px",ps.style.height="24px",ds.style.width="24px",ds.style.height="24px",ns.style.opacity=0,rs.style.opacity=0,ns.append(as),rs.append(ls),ls.innerText="Restart",as.innerText="Menu",ls.addEventListener("click",t),as.addEventListener("click",Q),z.append(rs,ns),z.style.cssText="gap:16px;margin-top:48px",document.body.scrollHeight<500?(z.style.display="flex",z.style.position="absolute",z.style.bottom="10vmin",z.style.left="10vmin"):(z.style.display="grid",z.style.position="",z.style.bottom="",z.style.left=""),addEventListener("resize",()=>{document.body.scrollHeight<500?(z.style.display="flex",z.style.position="absolute",z.style.bottom="10vmin",z.style.left="10vmin"):(z.style.display="grid",z.style.position="",z.style.bottom="",z.style.left="")}),B.style.cssText="position:absolute;top:10vmin;right:10vmin",B.style.pointerEvents="none",B.style.opacity=0,B.innerText="Overlay On/Off",B.addEventListener("click",O),ts.append(es,ss,is,C,z),document.body.append(ts,B),W.addEventListener("pointerdown",()=>{xe()}),W.addEventListener("pointermove",t=>{1==t.buttons&&(xe(),ce())}),W.addEventListener("pointerup",()=>{fe()}),W.addEventListener("contextmenu",t=>t.preventDefault()),f.addEventListener("pointerdown",t=>{t.stopPropagation();var e,s=f.getBoundingClientRect(),{x:s,y:i}=Ot(t.x-s.left,t.y-s.top);1!=t.buttons||ue.Ft?2!=t.buttons&&!ue.Ft||(xe(),ne(s,i)):(de(),t=me(s,i),e=Ae(s,i),t&&!e||(ge=!0,k={x:s,y:i},(t=be(k.x,k.y))?(t.qt(),f.style.cursor="grabbing"):($.setAttribute("d","M0 0 0 0"),ve.setAttribute("transform",`translate(${4+8*s} ${4+8*i})`),$.style.opacity=1,$.style.scale=1.3,$.style.transition="all.2s,scale.4s cubic-bezier(.5,2,.5,1)")))}),f.addEventListener("pointermove",t=>{t.stopPropagation();var e,s,i,r,l,n,a,h,o,y,p=f.getBoundingClientRect(),{x:u,y:d}=Ot(t.x-p.left,t.y-p.top);2==t.buttons||1==t.buttons&&ue.Ft?(xe(),ne(u,d)):(e=be(k.x,k.y),s=be(u,d),r=me(u,d),l=Ae(u,d),r&&!l?f.style.cursor="not-allowed":(s&&1!=t.buttons?f.style.cursor="grab":1==t.buttons&&(e&&s||e&&!s)?f.style.cursor="grabbing":we(k.x,k.y,u,d)||(f.style.cursor="cell"),1==t.buttons&&(fe(),de(),ge)&&(r=u-k.x,l=d-k.y,i=new c({x:4+8*k.x,y:4+8*k.y}),y=Te(r/2-.5)+" "+Te(l/2-.5),ve.setAttribute("transform",`translate(${i.x} ${i.y})`),$.setAttribute("d","M0 0 "+y),$.style.opacity=1,$.style.scale=1.3,0==r&&0==l||1<Math.abs(r)||1<Math.abs(l)?$.setAttribute("d","M0 0 0 0"):($.style.transition="all.2s,scale.4s cubic-bezier(.5,2,.5,1)",$.style.scale=1,{De:i,from:y,to:r}={De:{x:t.x-p.left,y:t.y-p.top},from:{x:k.x,y:k.y},to:{x:u,y:d}},l=f.getBoundingClientRect().width/20,t=i.x-l*(y.x-3+.5),i=i.y-l*(y.y-2+.5),p=r.y-y.y<0,n=0<r.x-y.x,a=0<r.y-y.y,h=r.x-y.x<0,o=r.x==y.x,r=r.y==y.y,(p&&o?i<4-l:p&&n?2*l-4<t-i:r&&n?l-4<t:a&&n?2*l-4<t+i:a&&o?l-4<i:a&&h?t-i<2*-l+4:r&&h?t<4-l:p&&h&&t+i<2*-l+4)&&(e&&!s?(e.Yt(u,d),k={x:u,y:d},vt(),e.Nt(),$.style.transition=""):s&&!e?(s.Yt(k.x,k.y),k={},ge=!1,vt(),s.Nt()):e&&s||(g.wt<=0?(m.style.scale=1.1,A.innerText="!",x&&(setTimeout(()=>wt(8,.5,.5,40,.1,1e3,100),100),setTimeout(()=>wt(5,.5,.5,20,.1,1e3,100),250)),setTimeout(()=>{m.style.scale=1,A.innerText=g.wt},300),$.style.opacity=0,k={},ge=!1):we(k.x,k.y,u,d)?f.style.cursor="not-allowed":(vt(),y=new Qt({lt:[{x:k.x,y:k.y},{x:u,y:d}]}),g.wt--,A.innerText=g.wt,It({Ot:[{x:k.x,y:k.y},{x:u,y:d}],Ae:y}),k={x:u,y:d},$.style.transition="")))))))}),f.addEventListener("pointerup",t=>{t.stopPropagation();var e=f.getBoundingClientRect(),{x:t,y:e}=Ot(t.x-e.left,t.y-e.top),s=be(k.x,k.y),i=be(t,e),r=me(t,e),t=Ae(t,e);f.style.cursor=r&&!t?"not-allowed":i?"grab":"cell",ce(),fe(),$.style.opacity=0,$.style.scale=0,s&&s.Nt(),k={},ge=!1}),$t=()=>{i.style.transition="transform 2s",i.style.transform="",A.innerText=g.wt,gs.style.pointerEvents="none",Kt.style.zIndex="",H.style.transition="opacity 1s.6s",bs.style.transition="opacity.3s.4s",vs.style.transition="opacity.3s.3s",ws.style.transition="opacity.3s.2s",ms.style.transition="opacity.3s.1s",H.style.opacity=0,vs.style.opacity=0,ws.style.opacity=0,vs.style.transition=0,ms.style.opacity=0,bs.style.opacity=0,M.style.opacity=0,w.style.opacity=0,o.style.opacity=0,M.style.width=0,w.style.width=0,o.style.width=0,Ls=!0,$s=I=1,M.style.transition="all.5s",w.style.transition="all.5s",o.style.transition="all.5s",T.style.opacity=1,y.style.opacity=1,a.style.opacity=1},gs.style.cssText="position:absolute;inset:0;padding:10vmin;display:flex;flex-direction:column",gs.style.pointerEvents="none",H.style.clipPath="polygon(0 0, calc(20dvw + 400px) 0, calc(20dvw + 350px) 100%, 0 100%)",bs.style.cssText="font-size:72px;opacity:0",bs.innerText="Tiny Yurts",ms.style.cssText="margin:auto 4px 0;opacity:0",localStorage.getItem("Tiny Yurts")&&(ms.innerText="Highscore: "+localStorage.getItem("Tiny Yurts")),Ts.innerText="Start",Ts.addEventListener("click",()=>{At(),$t()}),ws.style.opacity=0,Ms.innerText="Fullscreen",Ms.addEventListener("click",()=>{At(),document.fullscreenElement?document.exitFullscreen():(document.documentElement.requestFullscreen(),screen.orientation.lock("landscape").catch(()=>{}))}),vs.style.opacity=0,As.style.cssText="display:grid;gap:16px;margin-top:48px",ws.append(Ts),vs.append(Ms),As.append(vs,ws),gs.append(bs,As,ms),document.body.append(gs),Xe(I,2500),ks(E[0],!0);let zs=function({update:t,g:e}){let s,i,r,l,n,a=0;function h(){for(i=requestAnimationFrame(h),r=performance.now(),l=r-s,s=r,a+=l;a>=1e3/60;)n.update(.016666666666666666),a-=1e3/60;n.g()}return n={update:t,g:e,Pe:!0,start(){s=performance.now(),this.Pe=!1,requestAnimationFrame(h)},stop(){this.Pe=!0,cancelAnimationFrame(i)}}}({update(){if(Ls){if(Xe(I,Ls),120==I&&(Jt.style.opacity=1),150==I&&(m.style.opacity=1),180==I&&(te.style.opacity=1),210==I&&(r.style.opacity=1),I%8640==0&&g.wt<99){m.style.scale=1.1,A.innerText="+9",setTimeout(()=>A.innerText=g.wt,1300);for(let t=0;t<9;t++)setTimeout(()=>{g.wt<99&&(g.wt++,A.innerText=g.wt)},1300+100*t);setTimeout(()=>{m.style.scale=1},300)}switch(ee.style.transform=`rotate(${I/2}deg)`,Math.floor(I/720%12)){case 0:e.innerText="Jan";break;case 1:e.innerText="Feb";break;case 2:e.innerText="Mar";break;case 3:e.innerText="Apr";break;case 4:e.innerText="May";break;case 5:e.innerText="Jun";break;case 6:e.innerText="Jul";break;case 7:e.innerText="Aug";break;case 8:e.innerText="Sep";break;case 9:e.innerText="Oct";break;case 10:e.innerText="Nov";break;case 11:e.innerText="Dec"}}switch($s++,I++,$s%4){case 0:Pt=(()=>{let s=[];for(let e=0;e<26;e++)for(let t=0;t<14;t++)s.push({x:e,y:t,bt:[]});return Ht.forEach(e=>{s&&(s.find(t=>t.x==e.lt[0].x&&t.y==e.lt[0].y).bt.push({x:e.lt[1].x,y:e.lt[1].y}),s.find(t=>t.x==e.lt[1].x&&t.y==e.lt[1].y).bt.push({x:e.lt[0].x,y:e.lt[0].y}))}),s})();break;case 1:Ce.forEach(t=>t.update(Ls,I));break;case 2:Qe.forEach(t=>t.update(Ls,I));break;case 3:Fe.forEach(t=>t.update(Ls,I))}$s<60||($s=0),E.forEach(t=>{t.p||(zs.stop(),Je=St(t.x-13-3+t.width/2,t.y-7-2+t.height/2),i.style.transition="transform 2s ease-out.5s",i.style.transform=`rotate(-17deg)scale(2)translate(${-Je.x}px,${-Je.y}px)`,Ut.style.opacity=0,Vt.style.opacity=0,Xt.style.opacity=0,te.style.opacity=0,m.style.opacity=0,r.style.opacity=0,ue.H=!1,ue.Qe=!1,fe(),xs())}),qt.forEach(t=>t.update())},g(){switch(++Es%4){case 0:break;case 1:Ce.forEach(t=>t.g());break;case 2:Qe.forEach(t=>t.g());break;case 3:Fe.forEach(t=>t.g())}Es<60||(Es=0),qt.forEach(t=>t.g())}}),Bs=()=>{zs.Pe?(zs.start(),l.setAttribute("d","M6 6 6 10M10 6 10 8 10 10"),l.style.transform="rotate(180deg)"):(zs.stop(),l.setAttribute("d","M7 6 7 10M7 6 10 8 7 10"),l.style.transform="rotate(0)")};mt.H?(v.setAttribute("d","M10 6Q12 8 10 10M10 6Q12 8 10 10"),v.style.stroke=n,M.innerHTML="Sound: <u>On"):(v.setAttribute("d","M11 7Q10 8 9 9M9 7Q10 8 11 9"),v.style.stroke=Z,M.innerHTML="Sound: <u>Off"),r.addEventListener("click",Bs),y.addEventListener("click",()=>{At(),ue.Ft?(ue.Ft=!1,fe(),w.innerHTML='Delete: <abbr title="Right Mouse Button">RMB'):(xe(),ue.Ft=!0,w.innerHTML="Delete: <u>On"),wt(27,1,1,1,.3,1e3,1e3)}),a.addEventListener("click",()=>{At(),pe?(pe=!1,ce(),localStorage.setItem("Tiny Yurtsg",!1),o.innerHTML="Grid: <u>Auto"):(de(),localStorage.setItem("Tiny Yurtsg",!0),pe=!0,o.innerHTML="Grid: <u>On"),wt(25,1,1,1,.3,1e3,1e3)}),T.addEventListener("click",()=>{At(),mt.H?(mt.H=!1,localStorage.setItem("Tiny Yurtss",!1),v.setAttribute("d","M11 7Q10 8 9 9M9 7Q10 8 11 9"),v.style.stroke=Z,M.innerHTML="Sound: <u>Off"):(mt.H=!0,localStorage.setItem("Tiny Yurtss",!0),v.setAttribute("d","M10 6Q12 8 10 10M10 6Q12 8 10 10"),v.style.stroke=n,M.innerHTML="Sound: <u>On"),wt(30,1,1,1,.3,1e3,1e3)}),M.addEventListener("click",()=>T.click()),w.addEventListener("click",()=>y.click()),o.addEventListener("click",()=>a.click()),document.addEventListener("keypress",t=>{" "==t.key&&(t.ne!=r&&Bs(),r.style.transform="scale(.95)",setTimeout(()=>r.style.transform="",150))}),setTimeout(()=>{zs.start()},1e3)</script>