<!doctype html><meta content="width=device-width" name=viewport><meta content=#000 name=theme-color><title>Hoop - js13kGames 2012</title><style>#game-screen,#game-screen #ballctx,#game-screen #bgctx,#game-screen #dotsctx,#game-screen #pause-overlay,#game-screen #rimctx{position:absolute;top:0;left:0;font-size:40px;width:8em;height:12em}#game-screen #msg{color:#fff;font-family:Arial;text-align:center;position:absolute;top:30%;width:100%}#game-screen #pause-overlay{width:100%;height:100%;z-index:20;background:rgba(0,0,0,.5);display:none}#game-screen #pause-overlay button{font-size:40px;width:6em;height:2em;position:absolute;top:50%;left:1em}#game-screen #bgctx{z-index:0}#game-screen #rimctx{z-index:1}#game-screen #dotsctx{z-index:2}#game-screen #ballctx{z-index:3}#announcement{position:absolute;left:0;top:50%;margin-top:-.5em;width:100%;font-family:Arial;color:#fff;text-align:center;white-space:nowrap;z-index:10;opacity:0;cursor:default}@-webkit-keyframes zoomfade{0%{opacity:1;-webkit-transform:scale(.5)}25%{opacity:1}100%{opacity:0;-webkit-transform:scale(1.5)}}@-moz-keyframes zoomfade{0%{opacity:1;-moz-transform:scale(.5)}25%{opacity:1}100%{opacity:0;-moz-transform:scale(1.5)}}.zoomfade{-webkit-animation-name:zoomfade;-webkit-animation-duration:1s;-moz-animation-name:zoomfade;-moz-animation-duration:1s}</style><section id=game><div id=game-screen><div id=announcement></div><div id=pause-overlay><div id=msg></div><button>Play again</button></div></div></section><script>window.onload=function(){var e,t,i,n,h,o=[],a=[],r=[],d={width:188,height:110},l={},s={},w={width:320,height:480,level:0,score:0,numBall:5};function m(){this.max=120,this.radius=50,this.hyp=0,this.release=!1,this.move=!1,this.hitBoard=!1,this.rotate=0,this.originalX=.5*w.width,this.originalY=.6*w.height,this.x=.5*w.width,this.y=.6*w.height,this.vX=0,this.vY=0}function u(e,t){this.x=e,this.y=t,this.hit=!1,this.radius=16}function c(e,t){e=document.getElementById(e);var i=document.createElement("canvas"),n=i.getContext("2d");return i.width=w.width,i.height=w.height,i.id=t,n.clearRect(0,0,i.width,i.height),e.appendChild(i),o[t]=n,o[t]}function g(){var e,t,i;w.numBall=5,w.level++,e=w.level,t={1:[[w.width/2,110],[w.width/2,170]],2:[[.2*w.width,110],[.4*w.width,130],[.6*w.width,150],[.8*w.width,170]],3:[[.33*w.width,80],[.66*w.width,120],[.33*w.width,160],[.66*w.width,200]],4:[[.25*w.width,80],[.5*w.width,110],[.75*w.width,140]],5:[[.1*w.width,20],[.2*w.width,35],[.3*w.width,50],[.4*w.width,65],[.5*w.width,80],[.6*w.width,95],[.7*w.width,110],[.8*w.width,125],[.9*w.width,140],[.8*w.width,155],[.7*w.width,170],[.6*w.width,185],[.5*w.width,200],[.4*w.width,215],[.3*w.width,230],[.2*w.width,245],[.1*w.width,260]]},a=[],t[e]?t[e].map(function(e){a.push(new u(e[0],e[1]))}):v("You won!"),y(),t="Level "+w.level,(i=document.getElementById("announcement")).innerHTML=t,i.className="",setTimeout(function(){i.className="zoomfade"},1)}function v(e){var t=document.getElementById("pause-overlay");document.getElementById("msg").innerHTML=e,t.style.display="block"}function f(e,t,i,n){return e-=i,i=t-n,Math.sqrt(e*e+i*i)}function y(){var e=o.rimctx,t=new Image,i=(t.src="bball.png",.885*w.height);e.save(),e.clearRect(0,.85*w.height,w.width,w.height);for(var n=0;n<w.numBall;n++)e.drawImage(t,w.width-55*(n+1),i,50,50);e.restore()}function p(e,t,i){r[r.length-1];var n,h,a,d,l=o.rimctx,s=.8*w.height;(n=l.createLinearGradient(15,s,15,s-i)).addColorStop(0,"rgb(42, 255, 7)"),n.addColorStop(.5,"rgb(253, 250, 23)"),n.addColorStop(1,"rgb(255, 130, 9)"),h=s,a=i,(d=l).save(!1),d.clearRect(15,h,15,-a),d.restore(),l.save(),l.fillStyle=n,l.fillRect(15,s,15,-t),l.restore(),e&&.5<t&&(t*=.8,requestAnimFrame(function(){p(!0,t,i)}))}function x(e){document.addEventListener("mousemove",X,!1),document.addEventListener("touchmove",X,!1),"BUTTON"==e.target.nodeName&&(e=document.getElementById("pause-overlay"),(r=[]).push(new m),w.level=0,e.style.display="none",g())}function X(e){var t=r[r.length-1],i=t;return f(e.clientX,e.clientY,i.x,i.y)<i.radius&&!t.release&&(t.x=e.pageX||e.clientX,t.y=e.pageY||e.clientY,t.vX=.25*(t.originalX-t.x),t.vY=.25*(t.originalY-t.y),t.hyp=Math.min(f(t.originalX,t.originalY,t.x,t.y),t.max),t.move=!0),p(!1,t.hyp,t.max),!1}function E(){var e=r[r.length-1],t=new Date;return e.move&&(e.release=t.getTime(),p(!0,e.hyp,e.max)),document.removeEventListener("mousemove",X,!1),document.removeEventListener("touchmove",X,!1),!1}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e){window.setTimeout(e,1e3/60)},h=(new Date).getTime(),r.push(new m),e=function(){var e=c("game-screen","rimctx");s.top=l.top+l.height+5,s.lineTo=l.left+l.width,e.save(),e.beginPath(),e.strokeStyle="red",e.lineWidth=3,e.moveTo(l.left,s.top),e.lineTo(s.lineTo,s.top),e.stroke(),e.closePath(),e.restore(),document.addEventListener("mousedown",x,!1),document.addEventListener("touchdown",x,!1),document.addEventListener("mouseup",E,!1),document.addEventListener("touchup",E,!1),g(),function e(t){for(var i,n,h,d,l,s=(new Date).getTime(),u=s-t,p=0;p<r.length;p++){r[p].release&&(h=u/1e3,d=-1*u/1e3*(n=r[p]).hyp,l=w.height/12*10.5,i=n.y>w.height?10:20*u/1e3,n.vY+=i,n.x+=n.vX,n.y+=n.vY,l<=n.y+n.radius&&(n.y=l-n.radius,n.vY*=-1,n.vY*=.65),n.x+n.radius>=w.width&&(n.x=w.width-n.radius,n.vX*=-1,n.vX*=.8),n.x-n.radius<=0&&(n.x=n.radius,n.vX*=-1,n.vX*=.8),n.y+n.radius==l&&(.1<n.vX?(n.vX-=h,n.rotate-=h):n.vX<-.1?(n.vX+=h,n.rotate+=h):(n.vX=0,n.rotate=0)),n.radius<25&&(n.hitBoard=!0),n.hitBoard||(n.radius+=d)),X=void 0,r[p];for(var x=r[r.length-1],X=0;X<a.length;X++)f(x.x,x.y,a[X].x,a[X].y)<x.radius&&(a[X].hit=!0);a.length==function(){for(var e=0,t=0;t<a.length;t++)1==a[t].hit&&e++;return 0<e?e:9999}()&&(r.push(new m),g());var E=void 0,b=void 0,B=void 0;E=o.ballctx||c("game-screen","ballctx");for((b=new Image).src="bball.png",E.clearRect(0,0,w.width,w.height),B=0;B<r.length;B++){var R=r[B].radius;E.save(),E.drawImage(b,r[B].x-R,r[B].y-R,2*R,2*R+3),E.restore()}}(t=r[r.length-1]).release&&0==t.vX&&t.vY<1&&(w.numBall?(r.push(new m),w.numBall--,y()):v("Game over"));var T=o.dotsctx||c("game-screen","dotsctx"),Y=new Image;Y.src="star.png",T.clearRect(0,0,w.width,w.height);for(var L=0;L<a.length;L++)a[L].hit||T.drawImage(Y,a[L].x-a[L].radius,a[L].y-a[L].radius);requestAnimFrame(function(){e(s)})}(h)},t=w.height/12*10.5,i=w.height/12*1.5,n=c("game-screen","bgctx"),d.left=(w.width-d.width)/2,d.top=(w.height-d.height)/8,l.width=d.width/72*24,l.height=d.height/42*18,l.left=(d.width-l.width)/2+d.left,l.top=.66*(d.height-l.height)+d.top,n.save(),n.fillStyle="#E9E9E9",n.fillRect(0,0,w.width,t),n.fillStyle="#FDBB2F",n.fillRect(0,t,w.width,i),n.beginPath(),n.strokeStyle="black",n.lineWidth=.1,n.moveTo(0,t),n.lineTo(w.width,t),n.stroke(),n.closePath(),n.fillStyle="white",n.fillRect(d.left,d.top,d.width,d.height),n.strokeStyle="black",n.lineWidth=2,n.strokeRect(d.left,d.top,d.width,d.height),n.strokeRect(l.left,l.top,l.width,l.height),n.restore(),e()}</script>