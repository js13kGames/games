<title>Agent XIII - js13kGames 2012</title><style>body{padding:0;text-align:center;background-color:#010f35;height:100%;width:100%;color:#fff;font-family:arial,Serif}.shadow{box-shadow:1px 1px 8px gray;horiz-align:center}h1{padding:0;margin:2px}</style><body style=margin:0;padding:0><div><h1>Agent XIII</h1>Attack of the atmospheric space junk!<br><canvas class=shadow height=480 id=gameCanvas width=640></canvas><br>Mobile Users :) <button onclick="Game.prototype.keysDown[90]=!0">Z</button> <button onclick="Game.prototype.keysDown[88]=!0">X</button><br><a href=mailto:craigpayne1985@googlemail.com>craigpayne1985@googlemail.com</a> <a href=http://craigpayne.info>Craigs Blog</a><br>Craig Payne's (ErrorOccured) submission for js13kGames contest<script>function i(){return i.prototype=this}function l(){l.prototype=this}function e(){return{Speed:0,X:0,Y:0,SizeModifier:0,Colour:"white",Score:0}}function n(){return{TL:0,TR:0,BL:0,BR:0}}function r(){return r.prototype=this}function p(){return p.prototype=this}function y(){y.prototype=this}function o(){return o.prototype=this}i.prototype.keysDown={},i.prototype.Canvas=null,i.prototype.Context=null,i.prototype.Ship=null,i.prototype.Stars=null,i.prototype.Images=null,i.prototype.TypeWriter=null,i.prototype.TickCount=0,i.prototype.FPS=0,i.prototype.LastTickCount=(new Date).getTime(),i.prototype.GameEnd=null,i.prototype.Logic=null,i.prototype.Debug=!1,i.prototype.GameStartTime=null,i.prototype.ShowTitleScreen=!0,i.prototype.ShowHelp=!1,i.prototype.StartGame=!1,i.prototype.InGame=!1,i.prototype.GameOver=!1,i.prototype.FadeStepCount=0,i.prototype.Settings={ShowFPS:!0,ViewPort:function(){return{width:640,height:480}}},i.prototype.Initialise=function(){var t=i.prototype,e=(addEventListener("keydown",function(t){i.prototype.keysDown[t.keyCode]=!0},!1),addEventListener("keyup",function(t){delete i.prototype.keysDown[t.keyCode]},!1),addEventListener("mousedown",function(t){i.prototype.InGame&&(t.clientY<i.prototype.Ship.Y?i.prototype.keysDown[38]=!0:i.prototype.keysDown[40]=!0)},!1),addEventListener("mouseup",function(){delete i.prototype.keysDown[38],delete i.prototype.keysDown[40]},!1),i.prototype.TypeWriter=new y,t.Canvas=document.getElementById("gameCanvas"),t.Canvas.width=i.prototype.Settings.ViewPort().width,t.Canvas.height=i.prototype.Settings.ViewPort().height,t.Context=t.Canvas.getContext("2d"),t.Ship=new r,t.Stars=new p,t.Logic=new l,t.Stars.Initialise(),t.TypeWriter.Initialise(),t.Logic.Initialise(),setInterval(t.Tick,5),setInterval(t.Render,60),new o);e.Speed=80,e.Text="Millions of lightyears away, in a far distant galaxy, AgentXIII is about to embark on one of the most important missions known to man... To clear the galaxy of space junk!!!!",i.prototype.TypeWriter.TypeText(e,t.Context)},i.prototype.Update=function(){var t=i.prototype,e=t.Ship;t.InGame?(38 in i.prototype.keysDown&&e.Up(),40 in i.prototype.keysDown&&e.Down(),37 in i.prototype.keysDown&&e.Left(),39 in i.prototype.keysDown&&e.Right(),90 in i.prototype.keysDown&&(e.Boost=!0)):t.GameOver||(90 in i.prototype.keysDown&&(t.ShowTitleScreen=!1,t.ShowHelp=!1,t.InGame=!0,t.GameStartTime=(new Date).getTime()),t.ShowTitleScreen&&88 in i.prototype.keysDown&&(t.ShowTitleScreen=!1,t.ShowHelp=!0,(e=new o).Speed=80,e.Text="The aim of the game is to collide your space ship into junk, to break it apart and protect the earth from atmospheric junk. Controls: Up, Down, Left, Right arrow keys to control the ship, and hold Z for nitro boost! Mobile users click the screen to move the ship in the Y direction",i.prototype.TypeWriter.Clear(),i.prototype.TypeWriter.TypeText(e,t.Context)))},i.prototype.Render=function(){var t,e,o=i.prototype;if(o.Context.fillStyle="#000000",o.Context.fillRect(0,0,i.prototype.Settings.ViewPort().width,i.prototype.Settings.ViewPort().height),o.Stars.Render(o.Context),o.ShowTitleScreen&&((t=new Image).src="agent13.png",o.Context.fillStyle="#72AFFF",o.Context.fillRect(100,50,440,280),o.Context.drawImage(t,120,70,100,100),o.TypeWriter.Render(o.Context,300),o.Context.fillStyle="yellow",o.Context.font="bold 70px Courier New",o.Context.fillText("AgentXIII",150,300),o.Context.fillStyle="white",o.Context.font="bold 14px Courier New",o.Context.fillText("PRESS 'Z' TO START",250,350),o.Context.fillText("PRESS 'X' FOR HELP",250,370)),o.ShowHelp&&((t=new Image).src="agent13.png",o.Context.fillStyle="#72AFFF",o.Context.fillRect(100,50,440,280),o.Context.drawImage(t,120,70,100,100),o.TypeWriter.Render(o.Context,300),o.Context.fillStyle="white",o.Context.font="bold 14px Courier New",o.Context.fillText("PRESS 'Z' TO START",250,350)),o.InGame&&(o.Logic.Render(o.Context),o.Context.fillStyle="white",o.Context.font="bold 20px Courier New",o.Context.fillText("Score:"+l.prototype.Score,500,465),o.Context.fillStyle="white",o.Context.font="bold 20px Courier New",e=(new Date).getTime()-o.GameStartTime,o.Context.fillText(e/1e3+"s",50,465),o.Context.beginPath(),o.Context.arc(-70,242,160,0,2*Math.PI,!1),o.Context.strokeStyle="#555555",o.Context.lineWidth=3,o.Context.fillStyle="#444444",i.prototype.Ship.Health<400&&(o.Context.fillStyle="#333333",o.Context.strokeStyle="#444444"),i.prototype.Ship.Health<300&&(o.Context.fillStyle="#222222",o.Context.strokeStyle="#333333"),i.prototype.Ship.Health<200&&(o.Context.strokeStyle="#222222",o.Context.fillStyle="#111111"),i.prototype.Ship.Health<100&&(o.Context.strokeStyle="#111111",o.Context.fillStyle="#000000"),o.Context.fill(),o.Context.stroke(),o.Context.beginPath(),o.Context.arc(-100,240,150,0,2*Math.PI,!1),o.Context.fillStyle="blue",o.Context.fill(),o.Context.beginPath(),o.Context.moveTo(0,170),o.Context.lineTo(15,190),o.Context.lineTo(22,220),o.Context.lineTo(17,280),o.Context.lineTo(0,290),o.Context.fillStyle="green",o.Context.fill(),o.Context.beginPath(),o.Context.moveTo(20,290),o.Context.lineTo(25,295),o.Context.lineTo(27,310),o.Context.lineTo(20,330),o.Context.lineTo(15,330),o.Context.lineTo(12,310),o.Context.fillStyle="green",o.Context.fill(),o.Ship.Render(o.Context)),o.GameOver&&(o.ShowTitleScreen=!1,o.ShowHelp=!1,o.StartGame=!1,o.InGame=!1,o.Context.fillStyle="white",o.Context.font="bold 50px Courier New",o.Context.fillText("Game Over!!",150,150),o.Context.font="bold 30px Courier New",o.Context.fillText("Score:"+l.prototype.Score,220,250),e=o.GameEnd-o.GameStartTime,o.Context.fillText(e/1e3+"s",220,200),o.Context.fillText("Check out my blog: ",100,300),o.Context.fillText("http://craigpayne.info",100,340)),o.Debug){for(var r=0,p=0;p<l.prototype.Explosions.length;p++)null!=l.prototype.Explosions[p]&&(r+=1);for(var n=0,p=0;p<l.prototype.Rocks.length;p++)null!=l.prototype.Rocks[p]&&(n+=1);o.Context.fillStyle="white",o.Context.font="bold 16px Courier New",o.Context.fillText(" Rocks:"+n+" Explosions:"+r+" ShipX:"+o.Ship.X+" ShipY:"+o.Ship.Y,5,465)}},i.prototype.Tick=function(){var t=i.prototype;t.Update(),t.Stars.Tick(),t.InGame&&(i.prototype.Ship.Tick(),i.prototype.Logic.Tick())},l.prototype.Explosions=[],l.prototype.Score=0,l.prototype.GenerateRockWaitTime=0,l.prototype.Rocks=[],l.prototype.Initialise=function(){},l.prototype.GenerateRock=function(){var t=new e;switch(t.X=680,t.Speed=Math.floor(3*Math.random()+3),t.Y=Math.floor(640*Math.random()+1),t.SizeModifier=Math.floor(5*Math.random()+1),t.Score=t.Y,Math.floor(5*Math.random()+1)){case 0:t.Colour="brown";break;case 1:t.Colour="orange";break;case 2:t.Colour="purple";break;case 3:t.Colour="white";break;case 4:t.Colour="grey"}return t},l.prototype._odd=!0,l.prototype.Tick=function(){if(l.prototype._odd)l.prototype._odd=!1;else{l.prototype._odd=!0,l.prototype.GenerateRockWaitTime+=1;for(var t,e=0;e<l.prototype.Rocks.length;e++)null!=(o=l.prototype.Rocks[e])&&(o.X-=o.Speed,t=Math.floor(10*Math.random()+1)-5,640<o.Y+t?o.Y-=t-10:o.Y-t<0?o.Y+=10+t:o.Y+=t);for(var o,r,p=0;p<l.prototype.Rocks.length;p++)null!=(o=l.prototype.Rocks[p])&&o.X>i.prototype.Ship.X-20&&o.X<i.prototype.Ship.X+30&&o.Y>i.prototype.Ship.Y-20&&o.Y<i.prototype.Ship.Y+20&&(l.prototype.Score+=10*o.SizeModifier,l.prototype.Rocks[p]=null,(r=new n).TL={X:o.X,Y:o.Y},r.TR={X:o.X,Y:o.Y},r.BL={X:o.X,Y:o.Y},r.BR={X:o.X,Y:o.Y},l.prototype.Explosions[l.prototype.Explosions.length]=r);for(e=0;e<l.prototype.Explosions.length;e++)null!=l.prototype.Explosions[e]&&(l.prototype.Explosions[e].TL.X+=-3,l.prototype.Explosions[e].TL.Y+=-3,l.prototype.Explosions[e].TR.X+=3,l.prototype.Explosions[e].TR.Y+=-3,l.prototype.Explosions[e].BL.X+=-3,l.prototype.Explosions[e].BL.Y+=3,l.prototype.Explosions[e].BR.X+=3,l.prototype.Explosions[e].BR.Y+=3);for(e=0;e<l.prototype.Rocks.length;e++)null!=l.prototype.Rocks[e]&&l.prototype.Rocks[e].X<-1&&(100<l.prototype.Rocks[e].Y&&l.prototype.Rocks[e].Y<540&&(i.prototype.Ship.Health-=5*l.prototype.Rocks[e].SizeModifier,i.prototype.Ship.Health<1)&&(i.prototype.GameOver=!0,i.prototype.GameEnd=(new Date).getTime(),i.prototype.InGame=!1),l.prototype.Rocks[e]=null);for(e=0;e<l.prototype.Explosions.length;e++)null!=l.prototype.Explosions[e]&&l.prototype.Explosions[e].TL.X<-500&&(l.prototype.Explosions[e]=null);50==l.prototype.GenerateRockWaitTime&&(l.prototype.Rocks[l.prototype.Rocks.length]=l.prototype.GenerateRock(),l.prototype.GenerateRockWaitTime=0)}},r.prototype={Boost:!(l.prototype.Render=function(t){for(var e=l.prototype.Rocks,o=0;o<e.length;o++)null!=e[o]&&(t.fillStyle=e[o].Colour,t.fillRect(e[o].X,e[o].Y,4*e[o].SizeModifier,4*e[o].SizeModifier));for(o=0;o<l.prototype.Explosions.length;o++){var r=l.prototype.Explosions[o];null!=r&&(t.fillStyle="yellow",t.fillRect(r.TL.X,r.TL.Y,5,5),t.fillRect(r.TR.X,r.TR.Y,5,5),t.fillRect(r.BL.X,r.BL.Y,5,5),t.fillRect(r.BR.X,r.BR.Y,5,5))}}),Health:500,X:100,Y:200,Up:function(){10<r.prototype.Y&&(r.prototype.Y-=2,r.prototype.Boost)&&(--r.prototype.Y,r.prototype.Boost=!1)},Down:function(){r.prototype.Y<i.prototype.Settings.ViewPort().height-20&&(r.prototype.Y+=2,r.prototype.Boost)&&(r.prototype.Y+=1,r.prototype.Boost=!1)},Left:function(){50<r.prototype.X&&(r.prototype.X-=2,r.prototype.Boost)&&(--r.prototype.X,r.prototype.Boost=!1)},Right:function(){r.prototype.X<i.prototype.Settings.ViewPort().width-20&&(r.prototype.X+=2,r.prototype.Boost)&&(r.prototype.X+=1,r.prototype.Boost=!1)},Tick:function(){},ColourTick:0,Render:function(t){(e=t.createLinearGradient(0,0,320,0)).addColorStop(0,"red"),e.addColorStop(1,"lime"),t.fillStyle=e;var e=1.2*i.prototype.Ship.Health;switch(t.fillRect(20,20,e,10),t.fillStyle="white",t.fillStyle="white",t.font="bold 14px Courier New",t.fillText("Earth Atmospheric Defence Level",30,40),t.strokeStyle="white",t.lineWidth=2,t.beginPath(),t.moveTo(20,20),t.lineTo(620,20),t.lineTo(620,30),t.lineTo(20,30),t.closePath(),t.stroke(),(e=i.prototype.Ship).ColourTick){case 0:t.strokeStyle="purple";break;case 1:t.strokeStyle="red";break;case 2:t.strokeStyle="orange";break;case 3:t.strokeStyle="yellow";break;case 4:t.strokeStyle="blue";break;case 5:t.strokeStyle="lime";break;case 6:t.strokeStyle="cyan";break;case 7:t.strokeStyle="white";break;case 8:t.strokeStyle="brown";break;case 9:t.strokeStyle="pink"}e.ColourTick+=1,9==e.ColourTick&&(e.ColourTick=0),t.fillStyle="purple",t.beginPath(),t.moveTo(e.X+5,e.Y-15),t.lineTo(e.X+60,e.Y),t.lineTo(e.X+5,e.Y+15),t.fill(),t.lineWidth=2,t.stroke(),t.fillStyle="lime",t.beginPath(),t.moveTo(e.X,e.Y),t.lineTo(e.X,e.Y-5),t.lineTo(e.X+20,e.Y-10),t.lineTo(e.X-10,e.Y-20),t.lineTo(e.X+20,e.Y),t.lineTo(e.X-10,e.Y+20),t.lineTo(e.X+20,e.Y+10),t.lineTo(e.X,e.Y+5),t.lineTo(e.X,e.Y),t.fill(),t.lineWidth=2,t.stroke(),t.fillStyle="red";var o=Math.floor(2*Math.random()+1);0==o?(t.fillStyle="yellow",r.prototype.frame=1):1==o&&(t.fillStyle="orange",r.prototype.frame=1),t.beginPath(),t.moveTo(e.X,e.Y),t.lineTo(e.X,e.Y-8),t.lineTo(e.X-10,e.Y),t.lineTo(e.X,e.Y+8),t.lineTo(e.X,e.Y),t.fill()}},p.prototype.TickType=0,p.prototype.StarMapLayerX=[],p.prototype.StarMapLayerY=[],p.prototype.StarMapLayerTickCount=[],p.prototype.StarCount=150,p.prototype.Initialise=function(){for(var t=0;t<p.prototype.StarCount;t++){var e=Math.floor(Math.random()*i.prototype.Settings.ViewPort().width+1),o=Math.floor(Math.random()*i.prototype.Settings.ViewPort().height+1);p.prototype.StarMapLayerX[t]=e,p.prototype.StarMapLayerY[t]=o}},p.prototype.Tick=function(){for(var t=0;t<p.prototype.StarCount;t++)t%(p.prototype.TickType+1)==0&&(--p.prototype.StarMapLayerX[t],0==p.prototype.StarMapLayerX[t])&&(p.prototype.StarMapLayerX[t]=i.prototype.Settings.ViewPort().width);15==(p.prototype.TickType+=1)&&(p.prototype.TickType=0)},p.prototype.Render=function(t){for(var e=0;e<p.prototype.StarCount;e++){switch(Math.floor(8*Math.random()+1)){case 0:case 5:case 6:case 7:t.strokeStyle="white";break;case 1:t.strokeStyle="yellow";break;case 2:t.strokeStyle="red";break;case 3:t.strokeStyle="cyan";break;case 4:t.strokeStyle="green"}t.lineWidth=1;var o=p.prototype.StarMapLayerX[e],r=p.prototype.StarMapLayerY[e];p.prototype.DrawStar(t,o,r,1)}},p.prototype.DrawStar=function(t,e,o,r){t.beginPath(),t.moveTo(e,o),t.lineTo(e,o-r),t.lineTo(e+r,o),t.lineTo(e,o+r),t.lineTo(e-r,o),t.lineTo(e,o),t.stroke()},y.prototype._text="",y.prototype.TextColor="white",y.prototype.Settings=null,y.prototype.Context=null,y.prototype.Initialise=function(){y.prototype.Settings=new o,setInterval(y.prototype.Tick,50)},y.prototype.TypeText=function(t,e){y.prototype.Context=e,y.prototype.Settings=t},y.prototype._charCount=0,y.prototype._ticksForRender=0,y.prototype._renderUp=!0,y.prototype.Tick=function(){var t=y.prototype.Settings.Text;y.prototype._charCount<t.length&&(y.prototype._text+=t[y.prototype._charCount],y.prototype._charCount+=1)},y.prototype.Render=function(t,e){t.fillStyle=y.prototype.TextColor,t.font="bold 18px Courier New";for(var o=y.prototype._convertToLines(t,y.prototype._text,e),r=0;r<o.length;r++)t.fillText(o[r],250,20*(r+1)+50)},y.prototype.Clear=function(){y.prototype._charCount=0,y.prototype._ticksForRender=0,y.prototype._text=""},y.prototype._convertToLines=function(t,e,o){for(var r=e.split(" "),p=[""],n=0;n<r.length;n++){var i=p[p.length-1]+r[n]+" ";t.measureText(i).width>o?p[p.length]=r[n]+" ":p[p.length-1]=i}return p},o.prototype={Text:"",Speed:100},window.ErrorOccuredGames=new function(){},window.ErrorOccuredGames.game=new i,window.ErrorOccuredGames.game.Initialise()</script></div>