<link rel="shortcut icon" href=favicon.ico type=image/x-icon><meta name=monetization content=$ilp.uphold.com/r3XrneeRrpQn><meta name=viewport content="width=device-width,user-scalable=no"><meta key=og:type property=og:type content=article><meta key=og:url property=og:url content=//ayuu.github.io/forgetfulgod-js13k2020><meta key=og:image property=og:image content=//ayuu.github.io/forgetfulgod-js13k2020/screenshots/combined%20skill%20level.png><meta key=og:description property=og:description content="A Javascript Puzzle (Sokoban) Based Game"><title>Forgetful God</title><style>@keyframes blink{0%,50%{opacity:1}51%,to{opacity:0}}@font-face{font-family:emoji;src:local("Apple Color Emoji"),url(https://ayuu.github.io/forgetfulgod-js13k2020/fonts/twemoji.ttf) format("truetype")}*{user-select:none;margin:0}body,html{margin:0;padding:0;font-family:emoji;overflow:hidden;height:100%;width:100%;background:#000}body{display:flex;align-items:center;justify-content:center}.ingame #scene *,.ingame #viewport{visibility:visible}#viewport{visibility:hidden;width:100%;height:100%;overflow:hidden;position:relative;perspective:500px;background:#000}#viewport *{transform-style:preserve-3d;box-sizing:border-box}#camera{width:0;height:0;position:absolute;top:50%;left:50%}#colorAccessibility.visible.empty,#scene *{visibility:hidden}#scene{padding:0;display:block;background:#fff;transition:.5s linear}.gui.bar,pre.console{position:absolute;bottom:0}pre.console{left:0;top:0;right:0;color:#8fa;white-space:pre-wrap;font-size:2vmin;padding:1em}.mobile pre.console{font-size:4vmin}.gui{z-index:101;display:none;height:6vmin;width:100vw}.mobile .gui{height:10vmin}.gui.bar{background:#333;flex-direction:row;justify-content:space-evenly;padding:2.5vmin 0}.gui.controls{position:fixed;bottom:15vmin}.gui.controls div{position:absolute;font-size:4vmin}.mobile .gui.controls div{font-size:8vmin}.gui.controls .keyl{bottom:2vmin;right:26vmin}.gui.controls .keyr{bottom:2vmin;right:2vmin}.gui.controls .keyu{bottom:14vmin;right:14vmin}.gui.controls .keyd{bottom:2vmin;right:14vmin}.ingame .gui div{width:4vmin}.mobile.ingame .gui div{width:8vmin}#scene,#soundbtn{font-family:emoji}.gui div:hover{cursor:pointer}.mobile .gui div{font-size:4vmin;line-height:8vmin}.gui div{font-family:-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto;padding:1vmin;border-radius:1vmin;color:#fff;text-align:center;transition:all .2s;border:.1em solid #fff;font-size:3vmin;line-height:3vmin}#console,.console{overflow:hidden;max-height:0;height:fit-content;transition:max-height .5s linear;opacity:1;background:#000;z-index:100;visibility:hidden}.ingame #console{opacity:.5}#console.visible{max-height:75vh;visibility:visible}#console::after{content:" ";display:inline-block;background:#8fa;animation:blink 1s linear infinite}#fog{width:100vw;height:100vh;top:0;left:0;position:absolute;z-index:97;background-image:radial-gradient(circle,transparent,#000 25%)}#fog.coil{background-image:radial-gradient(circle,transparent,#000 100%)}#colorAccessibility,#tips{position:absolute;visibility:hidden;z-index:98;color:rgba(0,0,0,.5);line-height:1.8;display:flex;flex-direction:column;align-items:center;font-weight:700;line-height:4vmin;max-height:25vmin;overflow-y:scroll;scrollbar-width:thin;scroll-behavior:smooth}#tips{padding:2vmin;font-size:4vmin}#colorAccessibility::-webkit-scrollbar,#tips::-webkit-scrollbar{background-color:#000;width:8px}#colorAccessibility::-webkit-scrollbar-track,#tips::-webkit-scrollbar-track{background-color:#000}#colorAccessibility::-webkit-scrollbar-thumb,#tips::-webkit-scrollbar-thumb{background-color:#786600;border:2px solid #000}#colorAccessibility::-webkit-scrollbar-button,#tips::-webkit-scrollbar-button{display:none}#tips{top:2vmin;right:2vmin;background-color:#f8f5de;background-image:linear-gradient(to right,rgba(255,210,0,.4),rgba(200,160,0,.1) 11%,transparent 35%,rgba(200,160,0,.1) 65%);box-shadow:inset 0 0 6vmin rgba(255,210,0,.3),inset 0 0 3vmin rgba(255,210,0,.4),inset 0 0 4vmin rgba(220,120,0,.8);scrollbar-color:#786600 black}#colorAccessibility{top:2vmin;left:2vmin;font-size:3vmin;padding:4vmin;white-space:pre-wrap;background-color:#bebebe;background-image:linear-gradient(to right,rgba(190,190,190,.4),rgba(40,40,40,.1) 11%,transparent 35%,rgba(40,40,40,.1) 65%);box-shadow:inset 0 0 6vmin #000,inset 0 0 3vmin #000,inset 0 0 4vmin #000;scrollbar-color:#bebebe black}#colorAccessibility.visible,#overlay.visible,#tips.coil.visible{visibility:visible}#tips div{height:4vmin;display:inline-flex;margin:1vmin}#tips div .color{height:2vmin;width:2vmin;border-radius:.1vmin;border:.1vmin solid #000}#overlay{position:fixed;width:80vmin;height:80vmin;margin:auto;opacity:.75;background-color:#000;z-index:98;visibility:hidden;border-radius:2vmin;color:#fff;font-size:3vmin;line-height:4vmin;padding:2vmin;text-align:center}.group,.plane,.sprite{transition:.1s linear}.triangle{clip-path:polygon(50% 0,100% 100%,0 100%)}.triangle-bottom{clip-path:polygon(0 0,100% 0,50% 100%)}.triangle-left{clip-path:polygon(0 50%,100% 0,100% 100%)}.triangle-right{clip-path:polygon(0 0,100% 50%,0 100%)}.triangle-top-left{clip-path:polygon(0 0,100% 0,0 100%)}.triangle-top-right{clip-path:polygon(0 0,100% 0,100% 100%)}.triangle-bottom-left{clip-path:polygon(0 0,100% 100%,0 100%)}.triangle-bottom-right{clip-path:polygon(100% 0,100% 100%,0 100%)}.circle{border-radius:50%;border:0}.origin-top{transform-origin:top center}.floor{background:#9b7653;background:linear-gradient(to bottom,#9b7653 0,#8c6744 100%);z-index:-1;border-radius:5%}.plane .inner{box-shadow:none!important}.cube .back,.cube .front,.cube .left,.cube .right,.plane .inner,.pyramid .left,.pyramid .right{filter:brightness(65%)}.d{opacity:.85}.pyramid.d::after,.sphere.d::after{box-shadow:3vmin 3vmin 1vmin 4vmin #fff}.d::after{box-shadow:3vmin 2vmin 1vmin 4vmin #fff}.exit::after{box-shadow:3vmin 2vmin 1vmin 4vmin #0071db}.d::after,.exit::after{content:"";border-radius:50%;position:absolute;transform:translateZ(-1vmin);z-index:-1}.annotate{position:absolute;font-size:3vmin;color:#fff;font-family:monospace;text-shadow:-1px 0 #000,0 1px #000,1px 0 #000,0 -1px #000;visibility:hidden!important;top:25%;left:25%;right:25%;bottom:25%;z-index:1;transform:translateZ(8vmin)}.accessibility .annotate{visibility:visible!important}</style><pre class=console id=console></pre><div id=viewport><div id=camera><div id=scene></div></div></div><div id=gctrl class="gui controls"></div><div id=gbar class="gui bar"></div><div id=fog></div><div id=tips></div><pre id=colorAccessibility></pre><pre id=overlay>Tips 💡

Generate new form:
Rectangle + Pyramid = Cube
Sphere + Pyramid = Cone
Sphere + Rectangle = Curved Rectangle
Sphere + Cube = Curved Cube

No new form:
Cube + Rectangle or Pyramid
Cone + Sphere or Pyramid
Curved Rectangle + Sphere or Rectangle
Curved Cube + Sphere or Cube
    </pre><script>((o,e,t,r,n,a,c,v,f,m)=>{function u(s){this.gxy=(i,o)=>this.g({x:i,y:o}),this.g=i=>this.m[this.c(i)],this.i=i=>this.m[i],this.cxy=(i,o)=>this.c({x:i,y:o}),this.c=({x:i,y:o})=>i+o*this.l,this.init=()=>{for(scene.innerHTML="",C.sprites=[],C.sprite_count=0,C.plane_count=0,C.cube_count=0,C.pyramid_count=0,C.sphere_count=0,C.form_count=0,Accessibility.colors={},C.plane({x:(this.l-1)*O/2,y:(this.l-1)*O/2,z:-2,w:this.l*O*2,h:this.l*O*2,css:"floor"}),this.wm=o(this.l),i=0;i<this.l;i++)this.wm[i]=o(this.l);this.m.forEach(((i,o)=>{const t=(""+i).split("-");let s,r=i,d=0;(""+i).includes("#")&&([r,s]=t,d=r.endsWith("d"),d&&(r=r.substr(0,r.length-1)));let[n,a]=[o%this.l,e.floor(o/this.l)];this.wm[a][n]=r===CELL.wall?-1:0,this.createNode({x:n,y:a},r,d,s)})),this.buildWall(),Coil.updateCheatSheet(this.m),Accessibility.update()},this.buildWall=()=>{let e=o(this.l);for(i=0;i<this.l;i++)e[i]=o(this.l);for(ws=0,i=0;i<this.l;i++)for(j=0;j<this.l;j++)if(!e[j][i]&&this.wm[j][i]){for(cc=cr=0,k=i+1;k<this.l&&-1===this.wm[j][k];k++,cr++);for(l=j+1;l<this.l&&-1===this.wm[l][i];l++,cc++);if(ws++,w=d=h=O,cc>cr){for(k=j;k<l;k++)this.wm[k][i]=ws,e[k][i]=1;[x,y]=[i*O,(j+(l-j-1)/2)*O],d=(l-j)*O}else{for(l=i;l<k;l++)this.wm[j][l]=ws,e[j][l]=1;[x,y]=[(i+(k-i-1)/2)*O,j*O],w=(k-i)*O}C.cube({y:y,x:x,w:w,d:d,h:h,r:0,css:"cube wall",b:"#b22222"})}},this.createNode=({x:i,y:o},e,t,s)=>{[x,y]=[i*O,o*O];let r=this.cxy(i,o),d=+e;switch(d){case CELL.exit:C.cube({y:y,x:x,w:O/2,d:O/2,h:O/2,css:"exit",b:"#ff6"});break;case CELL.player:this.m[r]=0;const e=C.sprite({y:y,x:x,w:O,h:O,d:O,html:"🖲",css:"char"});this.playerStartPosition={n:e,x:i,y:o,rz:0};break;default:let n=t?"d":"";switch(d){case CELL.hole:this.m[r]=[C.sprite({y:y,x:x,w:O,h:O,d:O,html:"🕳",css:"hole"}),d,s,t];break;case CELL.sphere:this.m[r]=[C.sphere({y:y,x:x,w:U,d:U,h:U,b:s,css:`form${C.form_count} ${n} sphere`}),d,s,t,C.form_count];break;case CELL.rect:this.m[r]=[C.cube({y:y,x:x,w:U,d:.5*U,h:.5*U,b:s,css:`form${C.form_count} ${n} cube`,r:0}),d,s,t,C.form_count];break;case CELL.rrect:this.m[r]=[C.cube({y:y,x:x,w:U,d:.5*U,h:.5*U,b:s,css:`form${C.form_count} ${n} cube`,r:2}),d,s,t,C.form_count];break;case CELL.pyramid:this.m[r]=[C.pyramid({y:y,x:x,w:U,d:U,h:U,css:`form${C.form_count} ${n} pyramid`,b:s,r:0}),d,s,t,C.form_count];break;case CELL.cone:this.m[r]=[C.pyramid({y:y,x:x,w:U,d:U,h:U,css:`form${C.form_count} ${n} pyramid`,b:s,r:40}),d,s,t,C.form_count];break;case CELL.cube:this.m[r]=[C.cube({y:y,x:x,w:U,d:U,h:U,b:s,css:`form${C.form_count} ${n} cube`,r:0}),d,s,t,C.form_count];break;case CELL.rcube:this.m[r]=[C.cube({y:y,x:x,w:U,d:U,h:U,b:s,css:`form${C.form_count} ${n} cube`,r:2}),d,s,t,C.form_count]}if(d>0){const i=C.form_count++;Accessibility.colors[i]=s}}},this.canInteract=(i,o)=>{var e,s;if([-1,-9].includes(this.g(o))||[-1,-8].includes(this.g(i)))return 0;let[[r,d,n,a,l],[c,v,h,f,m]]=[this.g(i),this.g(o)];return e=this,s=0,d===v?(n===h||n!==h&&!f)&&(t((()=>{e.m[e.c(i)]=0,f?(Sounds.destroy(),[C.$(r),C.$(c)].forEach((i=>i&&i.parentNode.removeChild(i))),e.m[e.c(o)]=0,delete Accessibility.colors[l],delete Accessibility.colors[m]):(Sounds.merge(),[C.$(r),C.$(c)].forEach((i=>i&&i.parentNode.removeChild(i))),delete Accessibility.colors[l],delete Accessibility.colors[m],e.createNode(o,v,f,addRGB(n,h))),Coil.updateCheatSheet(e.m),Accessibility.update()}),100),s=1):f||(t((()=>{e.m[e.c(i)]=0,v===CELL.hole?(Sounds.destroy(),[C.$(r)].forEach((i=>i&&i.parentNode.removeChild(i))),delete Accessibility.colors[l]):(Sounds.merge(),[C.$(r),C.$(c)].forEach((i=>i&&i.parentNode.removeChild(i))),delete Accessibility.colors[l],delete Accessibility.colors[m],e.createNode(o,mergeGeo(d,v),f,addRGB(n,h))),Coil.updateCheatSheet(e.m),Accessibility.update()}),100),s=1),s},this.move=(i,o)=>{let e=i.x,t=i.y,s=0;if(this.g(i)[3])return 0;switch(o){case"u":for(let o=t-1;o>=0;o--){let r={x:e,y:o},d=0===this.g(r);if(!d&&!this.canInteract(i,r))break;if(t=o,s=1,!d)break}break;case"d":for(let o=t+1;this.l>o;o++){let r={x:e,y:o},d=0===this.g(r);if(!d&&!this.canInteract(i,r))break;if(t=o,s=1,!d)break}break;case"r":for(let o=e+1;this.l>o;o++){let r={x:o,y:t},d=0===this.g(r);if(!d&&!this.canInteract(i,r))break;if(e=o,s=1,!d)break}break;case"l":for(let o=e-1;o>=0;o--){let r={x:o,y:t},d=0===this.g(r);if(!d&&!this.canInteract(i,r))break;if(e=o,s=1,!d)break}}if(s){Sounds.pushed();const o=this.g(i);return 0===this.gxy(e,t)&&(this.m[this.c(i)]=0,this.m[this.cxy(e,t)]=o),C.move({n:o[0],x:e*O,y:t*O}),1}return 0},this.m=s,this.l=e.floor(e.sqrt(s.length)),this.init()}function b(i){this.init=()=>{if(oi.innerHTML=i,oi.classList.add("visible"),gctrl.style.display="none",gbar.style.display="none",colorAccessibility.classList.remove("visible"),tips.classList.remove("visible"),I&&0===s){gctrl.style.display="none",gbar.style.display="flex",gbar.innerHTML="";const i=r.createElement("div");i.innerHTML="New Game",i.onclick=this.startNewGame;const o=r.createElement("div");o.innerHTML="Continue",o.onclick=this.resumeGame,gbar.appendChild(i),gbar.appendChild(o)}},this.startGame=()=>{s=1,ii[Y].init(),Sounds.background()},this.startNewGame=()=>{level=0,this.startGame()},this.resumeGame=()=>{level=(()=>{const i=a.parse(c.getItem(W)||"{}");return i.level&&i.level<maps.length||(i.level=0,H(i)),i.level})(),this.startGame()},this.proccesKeyUp=i=>{2!==s&&("enter"==i?this.startNewGame():"KeyC"===i&&this.resumeGame())}}zzfx=(...i)=>zzfxP(zzfxG(...i)),zzfxP=(...i)=>{let o=zzfxX.createBufferSource(),e=zzfxX.createBuffer(i.length,i[0].length,zzfxR);return i.map(((i,o)=>e.getChannelData(o).set(i))),o.buffer=e,o.connect(zzfxX.destination),o.start(),o},zzfxPLoop=(...i)=>{let o=zzfxX.createBufferSource(),e=zzfxX.createBuffer(i.length,i[0].length,zzfxR);return i.map(((i,o)=>e.getChannelData(o).set(i))),o.buffer=e,o.loop=1,o.connect(zzfxX.destination),o.start(),o},zzfxG=(i=1,o=.05,t=220,s=0,r=0,d=.1,n=0,a=1,l=0,c=0,v=0,h=0,f=0,m=0,u=0,b=0,y=0,g=1,C=0,p=zzfxR,x=99+s*p,z=r*p,$=d*p,w=C*p,L=y*p,k=2*e.PI,E=(i=>i>0?1:-1),S=x+w+z+$+L,A=(l*=500*k/p**2),G=(t*=(1+2*o*e.random()-o)*k/p),_=E(u)*k/4,M=0,T=0,P=0,R=0,X=0,j=0,H=1,I=[])=>{for(;S>P;I[P++]=j)++X>100*b&&(X=0,j=M*t*e.sin(T*u*k/p-_),j=E(j=n?n>1?n>2?n>3?e.sin((j%k)**3):e.max(e.min(e.tan(j),1),-1):1-(2*j/k%2+2)%2:1-4*e.abs(e.round(j/k)-j/k):e.sin(j))*e.abs(j)**a*i*zzfxV*(x>P?P/x:x+w>P?1-(P-x)/w*(1-g):x+w+z>P?g:S-L>P?(S-P-L)/$*g:0),j=L?j/2+(L>P?0:(S-L>P?1:(P-S)/L)*I[P-L|0]/2):j),M+=1-m+1e9*(e.sin(P)+1)%2*m,T+=1-m+1e9*(e.sin(P)**2+1)%2*m,t+=l+=500*c*k/p**3,H&&++H>h*p&&(t+=v*k/p,G+=v*k/p,H=0),f&&++R>f*p&&(t=G,l=A,R=1,H=H||1);return I},zzfxM=(i,o,e,t=125)=>{let s,r,d,n,a,l,c,v,h,f,m,u,b,y,g,C,p=[],x=[],z=[],$=0,w=1,L={},k=zzfxR/t*60>>2;for(;w;$++)p=[w=v=m=b=0],e.map(((t,m)=>{for(c=o[t][$]||[0,0,0],w|=!!o[t][$],g=b+(o[t][0].length-2-!v)*k,r=2,n=b;c.length+(m==e.length-1)>r;v=++r){for(a=c[r],h=f!=(c[0]||0)|a|0,d=0;k>d&&v;d++>k-99&&h?u+=(1>u)/99:0)l=(1-u)*p[y++]/2||0,x[n]=(x[n]||0)+l*C-l,z[n]=(z[n++]||0)+l*C+l;a&&(u=a%1,C=c[1]||0,(a|=0)&&(p=L[[f=c[y=0]||0,a]]=L[[f,a]]||(s=[...i[f]],s[2]*=2**((a-12)/12),zzfxG(...s))))}b=g}));return[x,z]},zzfxV=.1,zzfxR=44100,zzfxX=new AudioContext;const g=[zzfxG(void 0,void 0,400,.03,.08,.23,void 0,1.93,5.8,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,.57,.04),zzfxG(void 0,void 0,211,void 0,.07,.24,void 0,1.11,4.6,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,.97,.02)],p=[[[3,0,24,void 0,.2,.3,void 0,10],[1,0,216,void 0,void 0,.45,1,4,void 0,void 0,50],[.75,0,196,void 0,.08,.18,3],[,0,84,void 0,void 0,.1,void 0,.7,void 0,void 0,void 0,.5,void 0,6.7,1,.05],[,0,2200,void 0,void 0,.04,3,2,void 0,void 0,800,.02,void 0,4.8,void 0,.01,.1],[.8,0,2100,void 0,void 0,.3,3,3,void 0,void 0,-400,void 0,void 0,2]],[[[5,0,15,0,0,0,15,0,0,0,15,0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,0,0,0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0],[4,0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,void 0,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15],[3,0,38,38,0,void 0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0]],[[5,0,15,0,0,0,15,0,0,0,15,0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,0,0,0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0],[4,0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,void 0,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15],[3,0,38,38,0,void 0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0],[0,0,38,40,0,0,38,40,0,0,41,0,41,0,41,0,41,0,38,40,0,0,38,40,0,0,41,0,41,0,41,0,41,0,38,40,void 0,void 0,38,40,void 0,void 0,41,void 0,41,void 0,41,void 0,41,void 0,38,40,void 0,void 0,38,40,void 0,void 0,41,void 0,41,void 0,41,void 0,41]],[[5,0,15,0,0,0,15,0,0,0,15,0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,0,0,0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0,void 0,15,void 0,void 0],[4,0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,void 0,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15,void 0,15],[3,0,38,38,0,void 0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0,0,38,38,0,0,38,38,0,0,0,0,0,0,0,0,0],[0,0,38,40,41,void 0,43,43,void 0,void 0,38,40,41,void 0,43,43,void 0,void 0,38,40,41,void 0,43,0,43,void 0,43,45,43,45,43,0,43,void 0,38,40,41,0,43,43,0,void 0,38,40,41,void 0,43,43,0,void 0,38,40,41,0,43,void 0,43,void 0,43,45,43,45,43,void 0,43]]],[0,1,2,2,1],90],z=zzfxM(...p),$=[[[3,0,24,void 0,.2,.3,void 0,10],[1,0,216,void 0,void 0,.45,1,4,void 0,void 0,50]],[[[1,0,52,55,57,0]]],[0],125],L=zzfxM(...$),E=zzfxG(void 0,void 0,93,.24,.01,.55,void 0,1.92,void 0,void 0,242,.02,.04,void 0,void 0,void 0,void 0,.87,.06),S=zzfxG(void 0,void 0,791,.02,.03,.17,1,.82,-8.9,void 0,void 0,void 0,void 0,.3,void 0,.1,void 0,.81,.04),A=zzfxG(void 0,void 0,249,void 0,void 0,.34,4,2.33,void 0,2,void 0,void 0,void 0,1.4,.1,.2,void 0,.66,.1),G=zzfxG(void 0,void 0,723,void 0,.08,.2,2,.48,void 0,void 0,630,.03,.02,void 0,void 0,void 0,.01,.91,.08),_=zzfxG(2,void 0,91,.02,void 0,.43,1,.23,-.7,-.1,void 0,void 0,void 0,void 0,.7,.1,.1,.54,.02);let M=0,T=1,P=0,R=0;Sounds={move(i){i?T&&zzfxP(_):P||(P=1,R++,R==g.length&&(R=0),T&&zzfxP(g[R]),t((()=>{P=0}),400))},background(){s===Y&&(M?bgSound&&(bgSound.stop(),M=0):T&&(bgSound=zzfxPLoop(...z),M=1))},destroy:()=>T&&zzfxP(A),merge:()=>T&&zzfxP(G),pushed:()=>T&&zzfxP(S),winGame:()=>T&&zzfxP(E),win:()=>T&&zzfxP(...L)},sendSoundToOS13k=i=>{v.keys(i).forEach((o=>{c[`OS13kMusic,Forgetful God (${o})`]=a.stringify(i[o])}))},sendSoundToOS13k({win:$,background:p});const X=(i,o,t,s)=>{let r,d,n,a,l,c,v,h=f,m=e.round,u="string"==typeof t;return"number"!=typeof i||-1>i||i>1||"string"!=typeof o||"r"!=o[0]&&"#"!=o[0]||t&&!u?null:(this.pSBCr||(this.pSBCr=i=>{let o=i.length,e={};if(o>9){if([r,d,n,u]=i=i.split(","),o=i.length,3>o||o>4)return null;e.r=h(r.slice("a"==r[3]?5:4)),e.g=h(d),e.b=h(n),e.a=u?parseFloat(u):-1}else{if(8==o||6==o||4>o)return null;6>o&&(i="#"+i[1]+i[1]+i[2]+i[2]+i[3]+i[3]+(o>4?i[4]+i[4]:"")),i=h(i.slice(1),16),9==o||5==o?(e.r=i>>24&255,e.g=i>>16&255,e.b=i>>8&255,e.a=m((255&i)/.255)/1e3):(e.r=i>>16,e.g=i>>8&255,e.b=255&i,e.a=-1)}return e}),v=o.length>9,v=u?t.length>9?1:"c"==t?!v:0:v,l=this.pSBCr(o),a=0>i,c=t&&"c"!=t?this.pSBCr(t):a?{r:0,g:0,b:0,a:-1}:{r:255,g:255,b:255,a:-1},a=1-(i=a?-1*i:i),l&&c?(s?(r=m(a*l.r+i*c.r),d=m(a*l.g+i*c.g),n=m(a*l.b+i*c.b)):(r=m((a*l.r**2+i*c.r**2)**.5),d=m((a*l.g**2+i*c.g**2)**.5),n=m((a*l.b**2+i*c.b**2)**.5)),u=l.a,c=c.a,l=u>=0||c>=0,u=l?0>u?c:0>c?u:u*a+c*i:0,v?"rgb"+(l?"a(":"(")+r+","+d+","+n+(l?","+m(1e3*u)/1e3:"")+")":"#"+(4294967296+16777216*r+65536*d+256*n+(l?m(255*u):0)).toString(16).slice(1,l?void 0:-2)):null)},H=i=>c.setItem(W,a.stringify(i||{level:level})),I=["mobi","android","ios"].some((i=>m.navigator.userAgent.toLowerCase().includes(i))),Z=(i,o,e,t,s)=>{const d=r.createElement("div");d.innerHTML=i,s&&(d.id=s),o&&d.classList.add(o),d.onclick=e,t.appendChild(d)},B=()=>T?"🔉":"🔇";Accessibility={toggle(){s===Y&&(scene.classList.toggle("accessibility"),colorAccessibility.classList.toggle("visible"))},update(){colorAccessibility.innerText="";const i=v.keys(Accessibility.colors);i.length?colorAccessibility.classList.remove("empty"):colorAccessibility.classList.add("empty"),colorAccessibility.innerText=i.reduce(((i,o,e)=>{const t=hex2rgb(Accessibility.colors[o]);return i+`${0===e?"":"\n"}${o}: (r: ${t[0]}, g: ${t[1]}, b: ${t[2]})`}),"")}},isValidPosition=(i,{x:o,y:e})=>o>=0&&i.l>o&&e>=0&&i.l>e,mergeGeo=(i,o)=>{const t=e=>i===e||o===e;return i===o?i:t(CELL.rcube)?CELL.rcube:t(CELL.rrect)&&(t(CELL.rect)||t(CELL.sphere))?CELL.rrect:t(CELL.cone)&&(t(CELL.pyramid)||t(CELL.sphere))?CELL.cone:t(CELL.cube)&&(t(CELL.pyramid)||t(CELL.rect))?CELL.cube:e.min(i*o,CELL.rcube)};const N=i=>f(i,16),K=i=>1===i.length?`${i}${i}`:i;hex2rgb=i=>i.match(5>i.length?/[\da-z]{1}/gi:/[\da-z]{2}/gi).map((i=>""+N(K(i)))),addRGB=(i,o)=>{var e=i.match(5>i.length?/[\da-z]{1}/gi:/[\da-z]{2}/gi),t=o.match(5>o.length?/[\da-z]{1}/gi:/[\da-z]{2}/gi);return"#"+e.map(((i,o)=>(255*(N(K(i))/255+N(K(t[o]))/255)>>1).toString(16).padStart(2,0))).join("")},C={unit:"vmin",camX:0,camY:0,camZ:0,camRX:0,camRY:0,camRZ:0,sprites:[],sprite_count:0,plane_count:0,circle_count:0,cube_count:0,sphere_count:0,pyramid_count:0,form_count:0,options:{},$:i=>self[i],set_unit:i=>C.unit=i,set_perspective:i=>viewport.style.perspective=`${i}${C.unit}`,init(i){i.css||(i.css=""),i.html||(i.html=""),i.g||(i.g="scene"),i.o||(i.o="center"),"top left"==i.o&&(i.x+=i.w/2,i.y+=i.h/2),"top"==i.o&&(i.y+=i.h/2),"top right"==i.o&&(i.x-=i.w/2,i.y+=i.h/2),"right"==i.o&&(i.x-=i.w/2),"bottom right"==i.o&&(i.x-=i.w/2,i.y-=i.h/2),"bottom"==i.o&&(i.y-=i.h/2),"bottom left"==i.o&&(i.x+=i.w/2,i.y-=i.h/2),"left"==i.o&&(i.x+=i.w/2),i.w||(i.w=0),i.h||(i.h=0),i.x||(i.x=0),i.y||(i.y=0),i.z||(i.z=0),i.rx||(i.rx=0),i.ry||(i.ry=0),i.rz||(i.rz=0),i.sx||(i.sx=1),i.sy||(i.sy=1),i.sz||(i.sz=1),C.options[i.n]=i},group(i){i.d||0===i.d||(i.d=i.h),C.init(i);const o=["wall","exit","hole"].some((o=>i.css.includes(o)))?"":`<div class="annotate">${i.css.match(/form(\d+)/)[1]}</div>`;C.$(i.g).innerHTML+=`<div id="${i.n}"class="group ${i.css}"style="position:absolute;width:${i.w}${C.unit};height:${i.d}${C.unit};transform:${C.tr(i)}">${o}`},plane(i){const o=`box-shadow: inset 0 0 ${i.r}${C.unit} ${X(-.6,i.b)};border-radius: ${i.r}${C.unit};`;return i.n||(i.n="plane"+C.plane_count++),C.init(i),C.$(i.g).innerHTML+=`<div id="${i.n}"class="plane ${i.css}"style="${o}position:absolute;width:${i.w}${C.unit};height:${i.h}${C.unit};background:${i.b};transform-origin:${i.o};transform:${C.tr(i)}">${i.html}`,i.n},circle:i=>(i.n||(i.n="circle"+C.circle_count++),C.init(i),C.$(i.g).innerHTML+=`<div id="${i.n}"class="circle ${i.css}"style="position:absolute;width:${i.w}${C.unit};height:${i.h}${C.unit};background: radial-gradient(circle at ${i.h/2}${C.unit} ${i.h/2}${C.unit}, ${i.b}, ${X(-.6,i.b)});transform-origin:${i.o};transform:${C.tr(i)}">${i.html}`,i.n),sprite:i=>(i.n||(i.n="sprite"+C.sprite_count++),C.init(i),C.$(i.g).innerHTML+=`<div id="${i.n}"class="sprite ${i.css}"style="position:absolute;width:${i.w}${C.unit};font-size:${i.h}${C.unit};height:${i.h}${C.unit};background:${i.b};transform-origin:${i.o};transform:${C.tr(i)}">${i.html}`,C.sprites.push(i.n),i.n),sphere:i=>(i.n||(i.n="sphere"+C.sphere_count++),C.init(i),C.group(i),C.circle({g:i.n,x:i.w/2,y:i.d/2,d:i.d,w:i.w,h:i.h,b:i.b,css:"top"}),i.n),cube(i){i.n||(i.n="cube"+C.cube_count++),C.init(i),C.group(i);let o=i.r>0?.75:0;return C.plane({g:i.n,r:i.r,x:o,y:i.d/2,w:i.d-o,h:i.h-o,b:i.b,rx:-90,ry:-90,o:"bottom",css:"left"}),C.plane({g:i.n,r:i.r,x:i.w-o,y:i.d/2,w:i.d-o,h:i.h-o,b:i.b,rx:-90,ry:-90,o:"bottom",css:"right"}),C.plane({g:i.n,r:i.r,x:i.w/2,y:0,w:i.w-o,h:i.h-o,b:i.b,rx:-100,o:"bottom",css:"back"}),C.plane({g:i.n,r:i.r,x:i.w/2,y:i.d,w:i.w-o,h:i.h-o,b:i.b,rx:-80,o:"bottom",css:"front"}),C.plane({g:i.n,r:i.r,x:i.w/2,y:i.d/2,z:i.h,w:i.w,h:i.d,b:i.b,css:"top"}),i.n},pyramid:i=>(i.n||(i.n="pyramid"+C.pyramid_count++),C.init(i),C.group(i),C.plane({g:i.n,r:i.r,x:0,y:i.d/2,w:i.w,h:i.h,b:i.b,ry:-60,rz:90,css:"triangle left",o:"bottom"}),C.plane({g:i.n,r:i.r,x:i.w,y:i.d/2,w:i.w,h:i.h,b:i.b,ry:-120,rz:90,css:"triangle right",o:"bottom"}),C.plane({g:i.n,r:i.r,x:i.w/2,y:0,w:i.w,h:i.h,b:i.b,rx:-120,css:"triangle back",o:"bottom"}),C.plane({g:i.n,r:i.r,x:i.w/2,y:i.d,w:i.w,h:i.h,b:i.b,rx:-60,css:"triangle front",o:"bottom"}),i.n),camera(i){var o,t,s;for(o in i&&(i.x||0===i.x)&&(C.camX=i.x),i&&(i.y||0===i.y)&&(C.camY=i.y),i&&(i.z||0===i.z)&&(C.camZ=i.z),i&&(i.rx||0===i.rx)&&(C.camRX=i.rx),i&&(i.ry||0===i.ry)&&(C.camRY=i.ry),i&&(i.rz||0===i.rz)&&(C.camRZ=i.rz),C.camX+=(e.random()-.5)/1e3,scene.style.transformOrigin=`${C.camX}${C.unit} ${C.camY}${C.unit}`,scene.style.transform=`translateX(${-C.camX}${C.unit})translateY(${-C.camY}${C.unit})translateZ(${-C.camZ}${C.unit})rotateX(${C.camRX}deg)rotateY(${C.camRY}deg)rotateZ(${C.camRZ}deg)`,C.sprites)s=(t=C.$(C.sprites[o])).style.transform.replace(/ *rotate.*\(.*?deg\)/g,""),t.style.transform=s+`rotateZ(${-C.camRZ}deg)rotateX(${-C.camRX}deg)`},move(i){if(i.n){var o=C.$(i.n),e=C.options[i.n];(i.x||0===i.x)&&(e.x=i.x),(i.y||0===i.y)&&(e.y=i.y),(i.z||0===i.z)&&(e.z=i.z),(i.rx||0===i.rx)&&(e.rx=i.rx),(i.ry||0===i.ry)&&(e.ry=i.ry),(i.rz||0===i.rz)&&(e.rz=i.rz),C.options[i.n]=e,o.style.transform=C.tr(e)}},tr:i=>`translateX(-50%)translateY(-50%)translateX(${i.x}${C.unit})translateY(${i.y}${C.unit})translateZ(${i.z}${C.unit})rotateX(${i.rx}deg)rotateY(${i.ry}deg)rotateZ(${i.rz}deg)scaleX(${i.sx})scaleY(${i.sy})scaleZ(${i.sz})`},CELL={wall:-1,floor:0,sphere:2,rect:3,pyramid:5,rrect:6,cone:10,cube:15,rcube:30,hole:-8,exit:-9,player:1},r.monetization&&r.monetization.addEventListener("monetizationstart",(()=>{s===Y&&Coil.initLevel()})),Coil={initLevel(){fog.classList.remove(...fog.classList),r.monetization&&"started"===r.monetization.state&&(fog.classList.add("coil"),tips.classList.add("coil"))},updateCheatSheet(e){const t=e.filter((i=>o.isArray(i)&&i[2]&&!i[3]));if(tips.innerHTML="",t.length>1){const o=[...new Set(t.map((i=>i[2])))];if(1>=o.length)return tips.classList.remove("visible");tips.classList.add("visible");const e=i=>{const o=r.createElement("div");return o.classList.add("color"),o.style.background=i,o};for(i=0;i<o.length-1;i++)for(j=i+1;j<o.length;j++){const t=r.createElement("div");[e(o[i]),e(o[j]),e(addRGB(o[i],o[j]))].forEach(((i,o)=>{if(t.appendChild(i),2>o){const i=r.createElement("span");i.innerHTML=0===o?"+":"=",t.appendChild(i)}})),tips.appendChild(t)}}else tips.classList.remove("visible")}},internalMaps=[[0,0,0,0,0,-1,-1,-1,-1,-1,-1,1,"2-#7fb3d5","2d-#7fb3d5",-9,-1,-1,-1,-1,-1,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,1,"2-#7fb3d5",-8,-9,-1,-1,-1,0,0,0,-1,-1,-1,-1,-1,-1,-1],[0,0,-1,-1,-1,0,0,0,0,0,-1,-9,-1,0,0,0,-1,-1,-1,"2d-#7fb3d5",-1,-1,0,0,-1,0,0,"3-#7fb3d5",-8,-1,-1,-1,-1,0,-1,0,0,"2-#7fb3d5",0,-1,-1,0,0,1,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,0,0,0,-1,1,0,0,-1,0,0,0,-1,0,"3-#ff0000","3-#0000ff",-1,0,0,0,-1,-1,-1,"3d-#7f007f",-1,0,0,0,0,0,-1,-9,-1,0,0,0,0,0,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,-1,0,0,0,0,0,0,-8,-1,0,-1,1,0,"2-#ff0000",0,-1,"2-#0000ff",0,-1,0,-1,-1,0,0,0,0,0,0,-1,0,0,-1,0,"2-#ffff00",0,0,"2-#00ffff",0,-1,0,0,-1,0,0,-1,0,-1,"2d-#7f7f7f",-1,0,0,-1,0,0,0,-8,-1,-9,-1,0,0,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,0,0,0,0],[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,0,-1,"3d-#138d75","5d-#7d3c98",0,"5-#7d3c98",0,-1,0,-1,-9,-1,-1,0,0,-1,0,-1,-1,-1,1,"3-#138d75",0,-1,0,0,0,-1,0,0,0,-1,0,0,0,-1,-1,-1,-1,-1,0],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-8,0,0,0,0,1,-1,-1,0,"5-#0000ff",0,-1,"2-#ffffaa",0,-1,-1,0,0,0,0,0,0,-1,-1,0,-1,0,0,"3-#ffaaaa",0,-1,-1,"10d-#d47f55",0,"5-#aa0000","5-#a93226",0,0,-1,-1,-9,"15d-#7f55d4",0,0,-1,-8,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,0,0,-1,-9,-1,-1,0,-1,0,"2-#ff0000",0,"6d-#7f7f55",-1,-1,0,-1,0,0,0,"5-#aa0000",-1,-1,0,0,0,0,"2d-#aa5500",0,-1,-1,-1,0,"2-#aa5500",0,"6-#00ffaa",0,-1,-1,0,0,0,0,0,-8,-1,-1,-1,-1,-1,-1,-1,-1,-1],[0,0,0,0,-1,-1,-1,-1,0,-1,-1,-1,-1,0,1,-1,-1,-1,0,0,0,"2-#ffff00",0,-1,-9,"30d-#9f9f00","5-#7f0000",0,"3-#7dcea0",0,0,-1,-1,0,0,0,-1,"30-#f0b2fa",0,-1,-1,-1,0,0,0,"3-#007f00",0,-1,-1,0,0,0,0,-1,-8,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-9,"6d-#1abc9c","2d-#8e44ad",0,-1,-1,-1,-8,-1,-1,-1,-1,0,0,0,0,0,0,-1,-1,0,0,0,0,0,-1,0,0,-1,-1,0,0,0,0,-1,-1,"2-#1abc9c",0,-1,-1,0,0,-1,0,0,0,0,-1,-1,-1,0,"2-#8e44ad",-1,0,-1,"3-#1abc9c",0,0,-1,-1,0,0,0,0,0,0,-1,0,-1,-1,-1,-1,0,0,0,0,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,0,0,0,0,0,0,-1,-1,-1,-1,-1,0,0,0,"2-#55aa00",0,-1,-1,-8,0,0,0,"15-#9b59b6",0,0,0,-1,-1,0,"3-#aa0000",0,0,-1,"5-#2980b9",0,0,-1,-1,0,0,0,0,0,0,-1,0,-1,-1,0,0,0,-1,"30-#9b59b6",0,0,0,-1,-1,0,-1,0,"5-#005500",0,-1,-1,-1,-1,-1,0,0,0,0,0,"5d-#2980b9","30d-#3f5500",-9,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,1,0,-1,0,0,0,-1,-1,0,0,0,"2-#aaff00",0,-1,-1,-1,0,"2-#ffaa00",0,0,"2-#ff5500",-8,-1,-1,0,0,"2-#55aa00",-1,"2d-#ffaa00",-9,-1,-1,0,-1,0,0,0,"2d-#ff5500",-1,-1,0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-9,"30d-#78407a",0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,"3-#0000db",0,0,-1,-1,0,0,0,0,"10d-#eba118",0,0,-1,-1,-1,0,"2-#f1c40f",0,0,-1,0,0,-1,-1,-1,0,-1,-1,0,-1,-1,-1,0,-1,-1,0,"10-#f0801a",0,0,-1,0,0,0,-1,-1,0,0,"5-#e67e22",0,-1,0,"2-#8e44ad",0,-1,-1,0,0,0,0,"2d-#8e44ad",0,0,1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,0,-8,-1,-1,0,"2-#ff0000",0,"2-#ffff00",0,"2-#ff5500",-1,0,-1,-1,0,0,0,0,0,0,0,0,-1,-1,0,"2-#ff00ff",0,"2-#00ffff",0,"2-#ffffff",-1,0,-1,-1,0,0,0,0,0,0,0,1,-1,-1,0,"2-#0000ff",0,"2-#00ff00",0,"2-#aa00ff",-1,0,-1,-1,-1,0,0,0,0,0,0,0,-1,-1,-9,"2d-#bf6f9f",0,0,0,0,0,0,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1]],maps={init:i=>new u([...internalMaps[i]]),length:internalMaps.length};const Y=1,O=8,U=.8*O,W="X2pzMTNrMjAyMGZvcmdldGZ1bGdvZA==",D=[3,5,13],V={l:"⇦",u:"⇧",r:"⇨",d:"⇩"},F={keyr:"R",keyh:"H",keyi:"I",backquote:"`"},q={2:["🧩","Puzzle Solver","Insert the correct missing piece"],3:["🎨","Painter","Adding color has no secrets"],5:["📐📏","Mathematics","Adding form has no secrets"],6:["🧠","Brainy","Can solve anything"]},J="\n===\nControls:\nWASD / Arrows : Movement\nR : Restart level\nM : Mute Sound\nH : Help\nI : Color Accessibility\n` : Toggle console\n===\n",Q=(i,o)=>{v.keys(i).forEach((e=>Z(i[e],"key"+e,(()=>processKey(e)),o)))},ii=[new b(`\nWelcome back to your world!\n\nThe world we created last weekend doesn't seem right...\nA bunch of assets are missing... but fear not, they shouldn't be too far!\nPush the correct asset to the highlighted area to complete the scene!\n\n${J}\n${I?"":"Press Enter to start a new game or C to continue . . ."}`),new function(){this.init=i=>{!i&&D.includes(level)?toggleConsole():oi.classList.remove("visible"),r.body.classList.add("ingame"),this.loaded=0,this.initLevel(),this.initGUI(),this.loaded=1},this.initGUI=()=>{gctrl.style.display="flex",gctrl.innerHTML="",Q(V,gctrl),gbar.style.display="flex",gbar.innerHTML="",Z(B(),"keym",(()=>processKey("keym")),gbar,"soundbtn"),Q(F,gbar)},this.initLevel=()=>{Coil.initLevel(),this.map=maps.init(level),this.position=this.position2d=this.map.playerStartPosition,this.v={d:1},this.updatePosition(this.position2d)},this.updatePosition=i=>{this.position2d=i;const[o,e]=[i.x*O,i.y*O];this.position={...this.position,x:o,y:e,rz:i.rz},this.cameraPosition={x:o,y:e,z:40},C.camera(this.cameraPosition)},this.rotate=i=>{Sounds.move(1),this.position2d.rz=this.position.rz=i.rz,C.move(this.position)},this.move=i=>{Sounds.move(0),this.updatePosition(i),C.move(this.position)},this.proccesKeyUp=i=>{const o={...this.position2d};switch(i){case"u":o.y-=1,!this.v.u&&(o.rz=this.v.d?180:this.v.l?o.rz+90:o.rz-90);break;case"d":o.y+=1,!this.v.d&&(o.rz=this.v.u?0:this.v.r?o.rz+90:o.rz-90);break;case"r":o.x+=1,!this.v.r&&(o.rz=this.v.l?-90:this.v.u?o.rz+90:o.rz-90);break;case"l":o.x-=1,!this.v.l&&(o.rz=this.v.r?90:this.v.d?o.rz+90:o.rz-90)}if("lrdu".includes(i)&&(this.v={[i]:1},oi.classList.remove("visible")),o.x!==this.position2d.x||o.y!==this.position2d.y){if(!isValidPosition(this.map,o))return void this.rotate(o);switch(cs=this.map.g(o)){case CELL.wall:return void this.rotate(o);case CELL.exit:const e=q[level];if(e){const[i,o,t]=e;c[`OS13kTrophy,${i},Forgetful God,${o}`]=t}level++,H(),level<maps.length?(Sounds.win(),this.init()):(Sounds.background(),r.body.classList.remove("ingame"),Sounds.winGame(),t((()=>{oi.classList.add("visible"),s=2,ii[s].init()}),500));break;case CELL.floor:this.move(o);break;default:this.map.move(o,i)?this.move(o):this.rotate(o)}}},this.console=()=>{let i=`Current level: ${level}\nTIPS:\n- Push the assets to the highlighted area`;return level>1&&(i+="\n- Merging assets with different colors will add the colors together"),level>3&&(i+="\n- Merging assets with different form will form a new form"),level>12&&(i+="\n- Color mixing are subject to order (experiment and find the right order!)"),i}},new b("\nThe world is now ready to receive the alien...\nGo back to your heaven and watch them evolve through the century!\n\nThanks for playing!")],oi=r.getElementById("console");s=0;const ei={},ti={};ti.ArrowUp=ti.KeyW=ti.KeyZ="u",ti.ArrowDown=ti.KeyS="d",ti.ArrowLeft=ti.KeyQ=ti.KeyA="l",ti.ArrowRight=ti.KeyD="r",ti.Enter=ti.NumpadEnter="enter",toggleConsole=()=>{oi.innerHTML=`${J}\n${ii[s].console?ii[s].console():""}`,oi.classList.toggle("visible")},onkeyup=({code:i})=>ei[i]=0,processKey=i=>{if("F5"===i)return m.location.reload();switch(i.toLowerCase()){case"backquote":return overlay.classList.contains("visible")&&overlay.classList.toggle("visible"),s===Y&&toggleConsole();case"keyh":if(s!==Y)return;return oi.classList.contains("visible")&&toggleConsole(),overlay.classList.toggle("visible");case"keyi":if(s!==Y)return;return oi.classList.contains("visible")&&toggleConsole(),overlay.classList.remove("visible"),Accessibility.toggle();case"keym":zzfxV=0;const o=r.getElementById("soundbtn");return T=!T,o&&(o.innerHTML=B()),Sounds.background();case"keyr":return ii[s].init(1);default:return ii[s].proccesKeyUp(ti[i]||i)}},onkeydown=({code:i})=>{ei[i]||(ei[i]=1,processKey(i))},I&&r.body.classList.add("mobile"),ii[s].init()})(Array,Math,setTimeout,document,onclick,JSON,localStorage,Object,parseInt,window)</script>