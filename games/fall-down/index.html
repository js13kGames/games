<!doctype html><style>body,html{height:100%;display:grid;overflow:hidden;background:#000}#a{border-radius:10px;margin:auto}</style><canvas id=a></canvas><script>var $jscomp=$jscomp||{};$jscomp.scope={},$jscomp.arrayIteratorImpl=function(t){var e=0;return function(){return e<t.length?{done:!1,value:t[e++]}:{done:!0}}},$jscomp.arrayIterator=function(t){return{next:$jscomp.arrayIteratorImpl(t)}},$jscomp.makeIterator=function(t){var e="undefined"!=typeof Symbol&&Symbol.iterator&&t[Symbol.iterator];return e?e.call(t):$jscomp.arrayIterator(t)},$jscomp.arrayFromIterator=function(t){for(var e,o=[];!(e=t.next()).done;)o.push(e.value);return o},$jscomp.arrayFromIterable=function(t){return t instanceof Array?t:$jscomp.arrayFromIterator($jscomp.makeIterator(t))},$jscomp.ASSUME_ES5=!1,$jscomp.ASSUME_NO_NATIVE_MAP=!1,$jscomp.ASSUME_NO_NATIVE_SET=!1,$jscomp.SIMPLE_FROUND_POLYFILL=!1,$jscomp.ISOLATE_POLYFILLS=!1,$jscomp.FORCE_POLYFILL_PROMISE=!1,$jscomp.FORCE_POLYFILL_PROMISE_WHEN_NO_UNHANDLED_REJECTION=!1,$jscomp.objectCreate=$jscomp.ASSUME_ES5||"function"==typeof Object.create?Object.create:function(t){var e=function(){};return e.prototype=t,new e},$jscomp.defineProperty=$jscomp.ASSUME_ES5||"function"==typeof Object.defineProperties?Object.defineProperty:function(t,e,o){return t==Array.prototype||t==Object.prototype||(t[e]=o.value),t},$jscomp.getGlobal=function(t){t=["object"==typeof globalThis&&globalThis,t,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof global&&global];for(var e=0;e<t.length;++e){var o=t[e];if(o&&o.Math==Math)return o}throw Error("Cannot find global object")},$jscomp.global=$jscomp.getGlobal(this),$jscomp.IS_SYMBOL_NATIVE="function"==typeof Symbol&&"symbol"==typeof Symbol("x"),$jscomp.TRUST_ES6_POLYFILLS=!$jscomp.ISOLATE_POLYFILLS||$jscomp.IS_SYMBOL_NATIVE,$jscomp.polyfills={},$jscomp.propertyToPolyfillSymbol={},$jscomp.POLYFILL_PREFIX="$jscp$";var $jscomp$lookupPolyfilledValue=function(t,e){var o=$jscomp.propertyToPolyfillSymbol[e];return null==o?t[e]:void 0!==(o=t[o])?o:t[e]};$jscomp.polyfill=function(t,e,o,r){e&&($jscomp.ISOLATE_POLYFILLS?$jscomp.polyfillIsolated(t,e,o,r):$jscomp.polyfillUnisolated(t,e,o,r))},$jscomp.polyfillUnisolated=function(t,e,o,r){for(o=$jscomp.global,t=t.split("."),r=0;r<t.length-1;r++){var n=t[r];if(!(n in o))return;o=o[n]}(e=e(r=o[t=t[t.length-1]]))!=r&&null!=e&&$jscomp.defineProperty(o,t,{configurable:!0,writable:!0,value:e})},$jscomp.polyfillIsolated=function(t,e,o,r){var n=t.split(".");t=1===n.length,r=n[0],r=!t&&r in $jscomp.polyfills?$jscomp.polyfills:$jscomp.global;for(var i=0;i<n.length-1;i++){var a=n[i];if(!(a in r))return;r=r[a]}n=n[n.length-1],null!=(e=e(o=$jscomp.IS_SYMBOL_NATIVE&&"es6"===o?r[n]:null))&&(t?$jscomp.defineProperty($jscomp.polyfills,n,{configurable:!0,writable:!0,value:e}):e!==o&&(void 0===$jscomp.propertyToPolyfillSymbol[n]&&(o=1e9*Math.random()>>>0,$jscomp.propertyToPolyfillSymbol[n]=$jscomp.IS_SYMBOL_NATIVE?$jscomp.global.Symbol(n):$jscomp.POLYFILL_PREFIX+o+"$"+n),$jscomp.defineProperty(r,$jscomp.propertyToPolyfillSymbol[n],{configurable:!0,writable:!0,value:e})))},$jscomp.getConstructImplementation=function(){if($jscomp.TRUST_ES6_POLYFILLS&&"undefined"!=typeof Reflect&&Reflect.construct){if(function(){function t(){}return new t,Reflect.construct(t,[],(function(){})),new t instanceof t}())return Reflect.construct;var t=Reflect.construct;return function(e,o,r){return e=t(e,o),r&&Reflect.setPrototypeOf(e,r.prototype),e}}return function(t,e,o){return void 0===o&&(o=t),o=$jscomp.objectCreate(o.prototype||Object.prototype),Function.prototype.apply.call(t,o,e)||o}},$jscomp.construct=$jscomp.getConstructImplementation(),$jscomp.underscoreProtoCanBeSet=function(){var t={};try{return t.__proto__={a:!0},t.a}catch(t){}return!1},$jscomp.setPrototypeOf=$jscomp.TRUST_ES6_POLYFILLS&&"function"==typeof Object.setPrototypeOf?Object.setPrototypeOf:$jscomp.underscoreProtoCanBeSet()?function(t,e){if(t.__proto__=e,t.__proto__!==e)throw new TypeError(t+" is not extensible");return t}:null,$jscomp.inherits=function(t,e){if(t.prototype=$jscomp.objectCreate(e.prototype),t.prototype.constructor=t,$jscomp.setPrototypeOf){var o=$jscomp.setPrototypeOf;o(t,e)}else for(o in e)if("prototype"!=o)if(Object.defineProperties){var r=Object.getOwnPropertyDescriptor(e,o);r&&Object.defineProperty(t,o,r)}else t[o]=e[o];t.superClass_=e.prototype},$jscomp.getRestArguments=function(){for(var t=Number(this),e=[],o=t;o<arguments.length;o++)e[o-t]=arguments[o];return e};var windows=window,documents=document,math=Math,PI=math.PI,timer=performance,l=windows.localStorage;Rand=function(t){return math.random()*t},RandInt=function(t){return 0|Rand(t)},RandIntBetween=function(t,e){return t+RandInt(e-t+1)},Abs=function(t){return math.abs(t)},Distance=function(t,e){return math.hypot(t,e)},CollisionRect=function(t,e){return t.x+t.w>e.x&&e.x+e.w>t.x&&t.y+t.h>e.y&&e.y+e.h>t.y?1:0},Max=function(t,e){return t>e?t:e},Min=function(t,e){return t<e?t:e},IntToString=function(t){return t.toString()},Pad=function(t){return t.padStart(4,"0")},ToFixed=function(t){return t.toFixed(2)},StringToFloat=function(t){return parseFloat(t)},SlopeY=function(t,e,o){return t*(void 0===o?-20:o)+e},localSet=function(t,e){return l.setItem(t,e)},localGet=function(t){return l.getItem(t)},GetCanvas=function(t){return documents.getElementById(t)},GetContextAlpha=function(t){return t.getContext("2d",{alpha:!1,desynchronized:!0})},GetContext=function(t){return t.getContext("2d")},CreateElement=function(t){return documents.createElement("canvas")},CanvasToImage=function(t){var e=new Image;return e.src=t.toDataURL(),e};var innerWidth,canvasWidth,canvasHeight,mouseCanvas,resizeWindow,tw,th,startButton,returnButton,count=1,canvas=GetCanvas("a"),ctx=GetContextAlpha(canvas),GamePlayObject=[],BackgroundMoveObject=[],BadItemImage=[],wallSpeed=[4,4,4,4,4,4,4,4,8,8,8,8,8,8,16,16,16,16,32],levelUpMeter=wallSpeed.map((function(t,e){return 5+20*e})),level=1,SunToMoon=RandInt(3),key={},key1={},checkButton=[],INKEYIN=0,keyStopRestartMute=["r","m","p"];keyStopRestartMute.forEach((function(t){return key1[t]=0})),InitailLoopDict=function(t,e){for(var o in t)t[o]=e;return t},key1.r=1,onblur=function(t){key1.p=1,key1.m=0},onfocus=function(t){return key1.p=0},onmousedown=function(t){if(INKEYIN||(zzfxX=new(window.AudioContext||webkitAudioContext),Music(),INKEYIN=1),!t.button){t.pageX>innerWidth/2?key.s=1:key.a=1;var e=t.clientX-mouseCanvas.left,o=t.clientY-mouseCanvas.top,r=w=1;checkButton.forEach((function(t,n){CollisionRect(t,{x:e/2,y:o/2,w:w,h:r})&&(key1[keyStopRestartMute[n]]=!key1[keyStopRestartMute[n]])})),startButton&&CollisionRect(startButton,{x:e/2,y:o/2,w:w,h:r})&&(NewGame(),key1.r=0),returnButton&&CollisionRect(returnButton,{x:e/2,y:o/2,w:w,h:r})&&(NewGame(),key1.r=1)}},onmouseup=function(t){!t.button&&(key=InitailLoopDict(key,0)),INKEYIN&&key1.m&&PlaySound(1)},ontouchstart=function(t){var e=t.changedTouches[0].pageX,o=t.changedTouches[0].pageY,r=w=1;e>innerWidth/2?key.s=1:key.a=1,checkButton.forEach((function(t,n){CollisionRect(t,{x:e/2,y:o/2,w:w,h:r})&&(key1[keyStopRestartMute[n]]=!key1[keyStopRestartMute[n]])})),startButton&&CollisionRect(startButton,{x:e/2,y:o/2,w:w,h:r})&&(INKEYIN||(zzfxX=new(window.AudioContext||webkitAudioContext),Music(),INKEYIN=1),NewGame(),key1.r=0),returnButton&&CollisionRect(returnButton,{x:e/2,y:o/2,w:w,h:r})&&(NewGame(),key1.r=1)},ontouchend=function(t){INKEYIN&&key1.m&&PlaySound(1),key=InitailLoopDict(key,0)},onkeydown=function(t){INKEYIN||(zzfxX=new(window.AudioContext||webkitAudioContext),Music(),INKEYIN=1),"r"==(t=t.key)&&NewGame(),keyStopRestartMute.includes(t)?key1[t]=!key1[t]:key[t]=1},onkeyup=function(t){var e=t.key;("a"==e||"s"==e||"z"==e||"x"==e)&&INKEYIN&&key1.m&&PlaySound(1),key[t.key]=0};var resize=function(){var t=windows.innerWidth,e=Min(Min(t,windows.innerHeight)/32|0,24);tw=canvasWidth=canvas.width=32*e,th=canvasHeight=canvas.height=32*e+4*e,ctx.imageSmoothingEnabled=!1,tw=canvasWidth/2,th=canvasHeight/2,innerWidth=t,mouseCanvas=canvas.getBoundingClientRect(),checkButton=[],resizeWindow=0};onresize=function(t){return resize()},resize();var zzfxX=null;zzfxV=.3,zzfxR=44100,Music=function(){zzfx=function(){var t=$jscomp.getRestArguments.apply(0,arguments);return zzfxP(zzfxG.apply(null,$jscomp.arrayFromIterable(t)))}},zzfxP=function(){var t=$jscomp.getRestArguments.apply(0,arguments),e=zzfxX.createBufferSource(),o=zzfxX.createBuffer(t.length,t[0].length,zzfxR);return t.map((function(t,e){return o.getChannelData(e).set(t)})),e.buffer=o,e.connect(zzfxX.destination),e.start(),e},zzfxG=function(t,e,o,r,n,i,a,s,c,l,h,u,f,p,d,m,x,y,w,v){t=void 0===t?1:t,e=void 0===e?.05:e,o=void 0===o?220:o,a=void 0===a?0:a,s=void 0===s?1:s,c=void 0===c?0:c,p=void 0===p?0:p,d=void 0===d?0:d,m=void 0===m?0:m,y=void 0===y?1:y,v=void 0===v?0:v;var g=2*Math.PI,I=c*=500*g/Math.pow(zzfxR,2),S=(0<d?1:-1)*g/4;e=o*=(1+2*e*Math.random()-e)*g/zzfxR;var b,C=[],j=0,T=0,P=0,k=1,M=0,R=0,z=0;for(r=99+zzfxR*(void 0===r?0:r),w=(void 0===w?0:w)*zzfxR,n=(void 0===n?0:n)*zzfxR,i=(void 0===i?.1:i)*zzfxR,x=(void 0===x?0:x)*zzfxR,l=500*g/Math.pow(zzfxR,3)*(void 0===l?0:l),d*=g/zzfxR,h=g/zzfxR*(void 0===h?0:h),u=(void 0===u?0:u)*zzfxR,f=zzfxR*(void 0===f?0:f)|0,b=r+w+n+i+x|0;P<b;C[P++]=z){++R%(100*m|0)||(z=a?1<a?2<a?3<a?Math.sin(Math.pow(j%g,3)):Math.max(Math.min(Math.tan(j),1),-1):1-(2*j/g%2+2)%2:1-4*Math.abs(Math.round(j/g)-j/g):Math.sin(j),z=(f?1-v+v*Math.sin(2*Math.PI*P/f):1)*(0<z?1:-1)*Math.pow(Math.abs(z),s)*t*zzfxV*(P<r?P/r:P<r+w?1-(P-r)/w*(1-y):P<r+w+n?y:P<b-x?(b-P-x)/i*y:0),z=x?z/2+(x>P?0:(P<b-x?1:(b-P)/x)*C[P-x|0]/2):z);var F=(o+=c+=l)*Math.sin(T*d-S);j+=F-F*p*(1-1e9*(Math.sin(P)+1)%2),T+=F-F*p*(1-1e9*(Math.pow(Math.sin(P),2)+1)%2),k&&++k>u&&(o+=h,e+=h,k=0),!f||++M%f||(o=e,c=I,k=k||1)}return C},zzfxM=function(t,e,o,r){for(var n,i,a,s,c,l,h,u,f,p,d,m,x,y,w=0,v=[],g=[],I=[],S=0,b=0,C=1,j={},T=zzfxR/(void 0===r?125:r)*60>>2;C;S++)v=[C=u=m=0],o.map((function(r,P){for(h=e[r][S]||[0,0,0],C|=!!e[r][S],y=m+(e[r][0].length-2-!u)*T,x=P==o.length-1,i=2,s=m;i<h.length+x;u=++i){for(c=h[i],f=i==h.length+x-1&&x||p!=(h[0]||0)|c|0,a=0;a<T&&u;a++>T-99&&f?d+=(1>d)/99:0)l=(1-d)*v[w++]/2||0,g[s]=(g[s]||0)-l*b+l,I[s]=(I[s++]||0)+l*b+l;c&&(d=c%1,b=h[1]||0,(c|=0)&&(v=j[[p=h[w=0]||0,c]]=j[[p,c]]||((n=[].concat($jscomp.arrayFromIterable(t[p])))[2]*=Math.pow(2,(c-12)/12),0<c?zzfxG.apply(null,$jscomp.arrayFromIterable(n)):[])))}m=y}));return[g,I]};var SoundNode,v=.2,Sound={1:[v,,443,,.1,0,1,,-8.7,,,,,.6,,,,0,.03],2:[v,,887,.01,.06,.42,3,1.02,,.7,,,,.8,,1,,.36,.12],3:[v,,64,.06,.19,.3,1,.84,.1,-.5,216,.12,.17,,,.1,,.91,.15],song1:[[[,0,400]],[[[,-1,5,,,,,,5,,,,,5,,8,,13,13,,,,,6,,10,3,12,,12,,,,5,,8,,13,,13,,,,],[,1,,,8,,12,,8,,,,,,,,,,8,,,,,,,,,,,10,,,,,,,,,,8,,,,],[,-1,,,,,,,12,,,,,,,,,,5,,,,,,,,,,,6,,,,,,,,,,5,,,,]]],[0],,],song2:[[[,0,150]],[[[,,6,,,,22,,,13,10,,,1,5,,,,24,,,17,10,,,5,8,,,17,,22,,,24,,,18],[,-.1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],[,,27,29,30,32,34,32,30,29,30,32,34,36,36,34,32,34,32,34,36,36,36,34,36,32,32,34,36,34,36,34,36,32,34,36,29,25]]],[0],110]};PlaySound=function(t){zzfx.apply(null,$jscomp.arrayFromIterable(Sound[t]))},PlaySong=function(t){zzfxV=1,t=zzfxM.apply(null,$jscomp.arrayFromIterable(Sound[t])),SoundNode&&SoundNode.stop(),(SoundNode=zzfxP.apply(null,$jscomp.arrayFromIterable(t))).loop=1},StopSong=function(t){zzfxV=0,SoundNode.stop()},CanPlaysong=function(t){SoundNode&&StopSong(),INKEYIN&&key1.m&&PlaySong(t)},shadeColor=function(t,e){t=t.substr(1);var o=parseInt(t,16),r=Math.round(2.55*e),n=(o>>16)+r,i=(o>>8&255)+r;return"#"+(16777216+65536*(255>n?1>n?0:n:255)+256*(255>i?1>i?0:i:255)+(255>(o=(255&o)+r)?1>o?0:o:255)).toString(16).slice(1)},rect1=function(t,e,o,r,n,i,a,s){i=void 0===i?"red":i,a=void 0===a?5:a,s=void 0===s?0:s,t.save(),t.fillStyle=i,t.strokeStyle=i,t.beginPath(),t.lineWidth=2,t.moveTo(e,o),t.lineTo(e+r,o),t.arcTo(e+r+a,o,e+r+a,o+a,a),t.lineTo(e+r+a,o+n+a),t.arcTo(e+r+a,o+n+a+a,e+r,o+n+a+a,a),t.lineTo(e,o+n+a+a),t.arcTo(e-a,o+n+a+a,e-a,o+n+a,a),t.lineTo(e-a,o+a),t.arcTo(e-a,o,e,o,a),s?t.fill():t.stroke(),t.closePath(),t.restore()},CreateWall=function(t){var e,o=CreateElement(),r=GetContext(o),n=e=o.width=o.height=32;r.scale(2,2),r.fillStyle=shadeColor(t,-10),r.fillRect(0,0,n,e),n/=6,e/=6;for(var i=y=c=0,a=0,s=0;9>s;s++){r.fillStyle=shadeColor(t,RandInt(3));var l=RandInt(n/2);r.fillRect(i+a,y,n+l,e),a=l,2==c?(y+=e,i=c=0):(i+=n,c++)}return CanvasToImage(o)},CreateItem=function(t,e,o,r){r=void 0===r?0:r;var n=CreateElement(),i=GetContext(n);return n.width=n.height=64,i.translate(32,32),i.rotate(PI*r),i.translate(-32,-32),rect1(i,o.x,o.y,o.w,o.h,e,o.r,t),i.setTransform(1,0,0,1,0,0),CanvasToImage(n)},CreateItemDraw=function(t,e){for(var o=[],r=0;r<e;r++)o.push(CreateItem(t[0],shadeColor(t[1],1),{x:t[2][0]+r*t[3][0],y:t[2][1]+r*t[3][1],w:t[2][2]+r*t[3][2],h:t[2][3]+r*t[3][3],r:t[2][4]+r*t[3][4]},r*t[4]));return o},CreateCloud=function(t,e){var o=CreateElement(),r=GetContext(o);r.height=50,r.width=18*t+20,r.beginPath(),r.moveTo(20,20),r.fillStyle=e;for(var n=1;n<t;n++)r.quadraticCurveTo(20+10*n,10,20+20*n,20);for(r.quadraticCurveTo(20+20*n,45,20+18*(n-1),40),r.moveTo(20,20),r.quadraticCurveTo(10,30,30,40),n=1;n<t;n++)r.quadraticCurveTo(20+10*n,50,20+18*n,40);return r.fill(),r.stroke(),CanvasToImage(o)},cloudDrawImageFrame=function(t){t={};var e,o,r=["#fff","#58B","#BBC"];for(o=0;3>o;o++)for(t[o]=[],e=3;6>e;e++)t[o].push(CreateCloud(e,r[o]));return t};var cloudDrawImage=cloudDrawImageFrame(),Vector=function(t,e,o,r){o=void 0===o?32:o,this.x=t,this.y=e,this.h=void 0===r?32:r,this.maxWidth=this.w=o};Vector.prototype.set=function(t){return this.x=t.x,this.y=t.y,this},Vector.prototype.add=function(t){this.x+=t.x,this.y+=t.y},Vector.prototype.addOne=function(t){this.x+=t,this.y+=t},Vector.prototype.addX=function(t){this.x+=t.x},Vector.prototype.zero=function(){this.x=this.y=0},Vector.prototype.substract=function(t){return this.x-=t.x,this.y-=t.y,this},Vector.prototype.dot=function(t){return this.x*=t,this.y*=t,this},Vector.prototype.clone=function(){return new Vector(this.x,this.y,this.w,this.h)},Vector.prototype.norm=function(t){var e=t.x-this.x;t=t.y-this.y;var o=Distance(e,t);return new Vector(e/o,t/o)},Vector.prototype.size=function(t,e){this.w*=(this.maxWidth-t.w)/(e-t.y)},Vector.prototype.less=function(t,e){return this.x<t||this.y<e},Vector.prototype.collisionRect=function(t){return CollisionRect(this,t)};var PlayerConfig={speed:1,maxSpeed:32,targetPos:new Vector(tw/2,-th,2,2),score:0,meter:0,life:100,maxScore:0,maxMeter:0},player=null,GameObject=function(t,e,o,r,n){r=void 0===r?32:r,n=void 0===n?32:n,this.pos=new Vector(t,e,r,n),this.VectorXY=new Vector(0,0,r,n),this.w=r,this.h=n,this.p=o,this.frameTime=0,GamePlayObject.push(this)};GameObject.prototype.render=function(t){this.draw(),this.update(t)},GameObject.prototype.draw=function(){},GameObject.prototype.update=function(t){},GameObject.prototype.remove=function(){GamePlayObject.splice(GamePlayObject.indexOf(this),1)},hand=function(t,e,o,r,n,i,a){n=void 0===n?0:n,i=void 0===i?90:i,a=void 0===a?250:a,ctx.save(),ctx.translate(t,e),ctx.rotate(PI/360*i),ctx.translate(-t,-e),rect1(ctx,t+2,e+2*n+2*r,1,1,"black",n/5),ctx.fillStyle="#0fa",ctx.fill(),rect1(ctx,t,e,o,r+2*n,"black",n/8),ctx.fillStyle="#fff",ctx.fill(),ctx.restore(),ctx.save(),ctx.translate(t,e),ctx.rotate(PI/360*a),ctx.translate(-t,-e),rect1(ctx,t,e,o+r,r+2*n,"black",n/8),ctx.fillStyle="#fff",ctx.fill(),rect1(ctx,t,e+2*n+2*r,o+r,r,"black",n/8),ctx.fillStyle="#0ff",ctx.fill(),ctx.restore()},face=function(t,e,o,r,n,i,a,s,c){i=void 0===i?230:i,a=void 0===a?-20:a,s=void 0===s?0:s,c=void 0===c?0:c,hand(t,e,o,r/4,n,i,430+i/10),hand(t,e,o,r/4,n,a,330+a/10),ctx.save(),ctx.fillStyle="#fff",rect1(ctx,t,e-1.5*n,o,r+n/1.5,"black",n-n/4),rect1(ctx,t,e-1.5*n,o,r+n/1.5,"white",n-n/4,1),rect1(ctx,t,e,o,r,"black",n),rect1(ctx,t,e,o,r,"white",n,1),eye(t,e,o,r,n,s,c),ctx.restore()},eye=function(t,e,o,r,n,i,a){ctx.save(),rect1(ctx,t-n/3,e+1.5*n,2,2,"#111",n/4),rect1(ctx,t-n/3+i,e+1.7*n,2,2,"#111",n/8,1),rect1(ctx,t+n/2,e+1.5*n,2,2,"#111",n/4),rect1(ctx,t+n/2+i,e+1.7*n,2,2,"#111",n/8,1),ctx.beginPath(),ctx.moveTo(t-n/4,e+n/4),ctx.quadraticCurveTo(t-n/4*a,e+n,t-n/4+o+n/2,e+n/4),ctx.stroke(),ctx.fillStyle="#DD404B",ctx.fill(),ctx.closePath(),rect1(ctx,t-n/4,e+n/4,o+n/2,r+n/4,"#111",1),ctx.restore()};var Faller=function(t,e,o,r){GameObject.call(this,t,e,1,o,r),this.D=0,this.frameTime=1,this.tw=tw,this.life=100,this.leftAni=this.rightAni=this.score=0,this.rightHandAngle=90,this.leftHandAngle=-90,this.oldmeter=this.meter=this.tonePos=this.toneAni=0};$jscomp.inherits(Faller,GameObject),Faller.prototype.draw=function(){ctx.save(),1>this.frameTime&&(ctx.globalCompositeOperation="xor",rect1(ctx,this.pos.x,this.pos.y,this.w,this.h,"#aaa",5,10)),face(this.pos.x+this.w/2.5,this.pos.y-this.w/4,5,5,this.w-this.w/8,this.leftHandAngle,this.rightHandAngle,this.D,this.tonePos),ctx.restore()},Faller.prototype.move=function(t){t*=200,this.meter+=t,this.leftHandAngle+=this.leftAni?2:-2,this.rightHandAngle+=this.rightAni?2:-2,this.tonePos+=this.toneAni?.6:-.6,this.rightAni=200<this.rightHandAngle?0:this.rightAni,this.rightAni=80>this.rightHandAngle?1:this.rightAni,this.leftAni=-80<this.leftHandAngle?0:this.leftAni,this.leftAni=-200>this.leftHandAngle?1:this.leftAni,this.toneAni=-3>this.tonePos?1:this.toneAni,this.toneAni=3<this.tonePos?0:this.toneAni,this.VectorXY.zero(),this.meter/100>(levelUpMeter[level]||270)&&(this.oldmeter=this.meter,level++,INKEYIN&&key1.m&&PlaySound(3)),(key.a||key.A||key.z||key.Z)&&(this.VectorXY.substract(new Vector(t,0)),this.rightHandAngle+=this.rightAni?5:-5,this.D=-2),(key.S||key.s||key.X||key.x)&&(this.VectorXY.add(new Vector(t,0)),this.leftHandAngle+=this.leftAni?5:-5,this.D=2),this.oldPos=this.pos.clone(),this.pos.addX(this.VectorXY),this.pos.x>tw-tw/5.5&&(this.pos=this.oldPos.substract(this.VectorXY)),this.pos.x<tw/8.5&&(this.pos=this.oldPos.substract(this.VectorXY))},Faller.prototype.update=function(t){var e=this;this.move(t),this.frameTime+=t,1<=this.frameTime&&(this.score+=.1*t*level,this.life+=1.5*t,this.life=Min(this.life,100)),GamePlayObject.forEach((function(t){2<=t.p&&t.pos.collisionRect(e.pos)&&1<e.frameTime&&2==t.p&&(e.life-=20,e.frameTime=0,e.hurt())})),0>=this.life&&this.destory()},Faller.prototype.destory=function(){for(var t=0;30>t;t++)new Blood(this.pos.x,this.pos.y,RandIntBetween(5,10),shadeColor("#640D14",RandInt(5)));PlayerConfig.maxMeter=ToFixed(Max(this.meter/100|0,parseFloat(PlayerConfig.maxMeter))),PlayerConfig.maxScore=0|Max(this.score,PlayerConfig.maxScore),localSet("M",PlayerConfig.maxMeter),localSet("S",PlayerConfig.maxScore),this.remove()},Faller.prototype.hurt=function(){for(var t=0;20>t;t++)new Blood(this.pos.x,this.pos.y,5,shadeColor("#9A2D26",RandInt(20)));INKEYIN&&key1.m&&PlaySound(2)};var Blood=function(t,e,o,r){GameObject.call(this,t,e,0,o,o),this.dx=(.5>Rand(1)?3:-3)*Rand(3)*.8,this.dy=(.5>Rand(1)?3:-3)*Rand(3)*.8,this.c=r};$jscomp.inherits(Blood,GameObject),Blood.prototype.draw=function(){rect1(ctx,this.pos.x,this.pos.y,2,2,this.c,this.pos.w,1)},Blood.prototype.update=function(t){this.frameTime+=t,(3<this.frameTime||.3>this.pos.w)&&this.remove(),this.dy-=.9*t,this.pos.x-=this.dx,this.pos.y-=this.dy,this.pos.w-=.05,this.pos.w=Max(this.pos.w,1)};var Cloud=function(t,e,o){GameObject.call(this,t,e,0,0,0),this.frames=o};$jscomp.inherits(Cloud,GameObject),Cloud.prototype.draw=function(){ctx.drawImage(this.frames,this.pos.x,this.pos.y,this.frames.width,this.frames.height)},Cloud.prototype.update=function(t){this.VectorXY=this.pos.norm(new Vector(this.pos.x,-th)),this.VectorXY.dot(level),this.pos.add(this.VectorXY),this.pos.less(0,-this.frames.height)&&this.destory()},Cloud.prototype.destory=function(){var t=cloudDrawImage[RandInt(2)];new Cloud(this.pos.x,th+Rand(300),t[RandInt(t.length)]),this.remove()};var Item=function(t,e,o,r,n,i){GameObject.call(this,t,e,i,o,r),this.initialX=this.pos.x,this.frameArray=n,this.curFrame=n[0],this.frameTime=0,this.th=th};$jscomp.inherits(Item,GameObject),Item.prototype.draw=function(){ctx.drawImage(this.curFrame,this.pos.x,this.pos.y,this.pos.w,this.pos.h)},Item.prototype.update=function(t){t=this.frameArray.length,this.frameTime++,this.curFrame=this.frameArray[this.frameTime%t|0];var e=this.initialX+1;e=this.pos.x>=tw/2?Min(tw-tw/7,this.initialX)-this.w:Max(tw/4,e),this.VectorXY=this.pos.norm(new Vector(e,-this.th)),this.VectorXY.dot(level),this.pos.add(this.VectorXY),this.pos.w-=this.pos.maxWidth/Distance(0,2*this.th)*Abs(this.VectorXY.y),this.pos.w=Max(this.pos.w,this.pos.maxWidth/2),this.pos.less(0,-this.pos.h)&&this.destory(),this.frameTime=this.frameTime>2*t?0:this.frameTime},Item.prototype.destory=function(){this.remove()};var BuildingWall=function(t,e,o,r,n){n=void 0===n?"#5F6256":n,this.pos=new Vector(t,e,o,r),this.VectorXY=this.pos.clone(),this.initialX=t,this.initialY=canvasHeight/2,this.f=CreateWall(n),this.th=th,this.colorCount=this.meter=this.frameTime=0,BackgroundMoveObject.push(this)};BuildingWall.prototype.render=function(t){this.draw(),this.update(t)},BuildingWall.prototype.draw=function(){ctx.drawImage(this.f,this.pos.x,this.pos.y,this.pos.w,this.pos.h)},BuildingWall.prototype.update=function(t){this.VectorXY=this.pos.norm(new Vector(this.pos.x,-this.th,1,1)),this.meter+=200*t,this.VectorXY.dot(wallSpeed[level]||32),PlayerConfig.speed=this.VectorXY.y,this.pos.less(0,-this.pos.h)&&this.loop(),this.pos.add(this.VectorXY)},BuildingWall.prototype.loop=function(){this.pos.set({x:this.initialX,y:this.th})},background=function(t){t=CreateElement();var e=GetContext(t);t.width=tw,t.height=th;var o=e.createRadialGradient(tw,0,40,tw,0,th/10);for(o.addColorStop(.3,"#FFE261"),o.addColorStop(.7,"#F3CD05"),o.addColorStop(.8,"#F49F05"),o.addColorStop(1,"#FFF8C8"),e.beginPath(),e.fillStyle=o,e.fillRect(0,0,tw,th),o=0;o<tw;o+=40){var r=RandIntBetween(th/4,th-th/8),n=shadeColor("#36688D",RandIntBetween(-20,20));rect1(e,RandIntBetween(0,tw),th-r,RandInt(64),r,n,8,1)}return CanvasToImage(t)};var back=background();BackgroundView=function(t){ctx.drawImage(back,0,0,tw,th)},BuildingWallInitial=function(t){for(t=0;t<th/28;t++)for(var e=0;e<tw/32;e++)new BuildingWall(32*e,32*t,32,32);CloudCreate(0)},CloudCreate=function(t){t=cloudDrawImage[SunToMoon];for(var e=0;10>e;e++){var o=e%2?RandIntBetween(tw-tw/8,tw):RandIntBetween(0,tw/18)-Rand(10);new Cloud(o,th+Rand(300),t[RandInt(t.length)])}},TextField=function(t,e,o,r,n,i){n=void 0===n?"#fff":n,i=void 0===i?1:i,ctx.save(),ctx.fillStyle=n,ctx.font=r+"px Impact",ctx.fillText(t,e,o),i&&ctx.strokeText(t,e,o),ctx.restore()},Bar=function(t,e,o,r,n,i){ctx.save();var a=o/n*r;for(rect1(ctx,t,e+(o-a),5,a,"#1fc",5,1),rect1(ctx,t,e,5,o,"#000"),a=0;a<r;a+=25)rect1(ctx,t,e+(o-o/n*a),8,1,"#a11",1,1);ctx.fillStyle="#0F0",ctx.font="20px Impact",ctx.fillText(i,t-11,e+o+20),ctx.restore()};var miniMapY,reachColor="#b88 #8b8 #88b #FFE8D6 #DDBEA9 #5F6256 #7C6354 #F9FBB2 #B5179E".split(" "),cur1color=1,cur2color=0;ScaleLine=function(t,e,o,r,n){n=void 0===n?200:n,ctx.save(),ctx.beginPath(),ctx.lineWidth=3;for(var i=0,a=0;i<=n;i+=2*o,a++)ctx.strokeStyle="#fff",5==a?rect1(ctx,t-o/2,e+i,o,o,reachColor[r],5,1):rect1(ctx,t+o/2,e+i,-o,o),ctx.stroke();ctx.restore()},GameUIView=function(t){ctx.save(),ctx.beginPath();var e,o=1;for(e in keyStopRestartMute){ctx.globalAlpha=Max(1-key1[keyStopRestartMute[e]],.5);var r=tw-20*o-5;!resizeWindow&&checkButton.push({x:r,y:10,w:18,h:12}),ctx.fillText(o-1?o-2?"⏯️":"🎧":"🏠",r,20),o++}ctx.restore(),resizeWindow=1,ctx.save(),ctx.beginPath(),ctx.fillStyle="#fff",ctx.font="30px Impact",o=Pad(IntToString(Min(0|player.score,9999))),TextField(o,tw-70,60,30),TextField("Meter",10,25,15),TextField(ToFixed(player.meter/100)+"  /m",15,40,12),TextField("G-Speed",10,60,15),TextField(ToFixed(level+Rand(t))+"  /g",15,80,12),ScaleLine(20,th/2,10,cur1color,100),Bar(tw-20,80,40,0|player.life,100,"🧡"),miniMapY=100/levelUpMeter[level]*(player.meter-player.oldmeter)/100*level,rect1(ctx,25,th/2+miniMapY,2,2,reachColor[cur2color],2,1),87<=miniMapY&&(cur2color=cur1color,cur1color=++cur1color>=reachColor.length?0:cur1color),ctx.restore()};var itemColor="#25315D",iron_ball_shake=CreateItemDraw([1,itemColor,[64,32,-64,-64,30],[0,0,0,0,0],.5],20),long_wall=CreateItemDraw([1,itemColor,[16,16,32,-38,16],[0,0,0,0,0],0],1),iron_ball_rotate=CreateItemDraw([0,itemColor,[64,32,-64,-64,30],[0,0,0,0,0],.5],20),fix_arrow=CreateItemDraw([1,itemColor,[64,32,-64,-64,32],[0,-1,0,0,1],0],30),ciclre=CreateItemDraw([1,itemColor,[64,32,-64,-64,32],[0,-1,0,0,1],.1],30),fansa=CreateItemDraw([1,itemColor,[64,0,-64,-64,64],[0,0,0,0,0],.1],10),adsf=CreateItemDraw([0,itemColor,[64,32,-64,-32,32],[0,-1,0,-1,-.1],.1],30);BadItemImage=[iron_ball_shake,long_wall,fansa,fix_arrow,ciclre,iron_ball_rotate,adsf],AppearArry=function(t){for(t=new Set;6>t.size;)t.add(RandInt(6));return[].concat($jscomp.arrayFromIterable(t))},AppearDist=function(t){return t.join("").replace("0","#0#").split("#").filter((function(t){return t}))},WallResize=function(t){return t.map((function(t){return"0"!=t?t.length*tw/8:tw/6}))},Pause=function(t){ctx.save(),ctx.fillStyle="rgba(10,10,10,.5)",ctx.fillRect(0,0,tw,th),TextField("-- PAUSE --",tw/2-tw/4,th/2+th/15,tw/15+th/15),ctx.restore()};var lightx=scaleOut=0;Start=function(t){ctx.save(),TextField("- FALL　      -",tw/2-tw/4,th/5,tw/15+th/15),TextField("-  DOWN　-",tw/2-tw/4,th/3,tw/15+th/15),TextField("Score:"+Pad(IntToString(PlayerConfig.maxScore)),tw/2-tw/8,th/2+th/6,tw/15,"#b88"),TextField("Meter:"+Pad(IntToString(PlayerConfig.maxMeter)),tw/2-tw/8,th/2+th/4,tw/15,"#8b8"),TextField("Touch Me",tw/2-tw/7.5,th-th/10,tw/15,shadeColor("#aaaaaa",lightx)),rect1(ctx,tw/2-tw/4,th-th/5,tw/2,th/8,shadeColor("#aaaaaa",lightx)),startButton={x:tw/2-tw/4,y:th-th/5,w:tw/2,h:th/8},lightx=40<(lightx+=1)?0:lightx,GamePlayObject.forEach((function(t){t instanceof Cloud&&t.render()})),ctx.restore()},End=function(t){ctx.save(),ctx.fillStyle="rgba(10,10,10,.5)",ctx.fillRect(0,0,tw,th),rect1(ctx,tw/2-tw/4,th/4,tw/2,th/2,shadeColor("#555555",1),5,1),rect1(ctx,tw/2-tw/4,th/4,tw/2,th/2,shadeColor("#aaaaaa",lightx)),rect1(ctx,tw/2-tw/4,th/4+th/9,tw/2,1,shadeColor("#F7DD72",lightx)),TextField("Best",tw/2-tw/12,th/4+th/10,tw/10,"#F7DD72"),TextField("Score : "+Pad(IntToString(PlayerConfig.maxScore)),tw/4+tw/10,th/4+th/5,tw/16,"#b88"),TextField("Meter : "+Pad(IntToString(PlayerConfig.maxMeter)),tw/4+tw/10,th/2,tw/16,"#8b8"),rect1(ctx,tw/2-tw/9,th/2+th/32,tw/4,th/5,shadeColor("#F7DD72",lightx),5,1),returnButton={x:tw/2-tw/9,y:th/2+th/32,w:tw/4,h:th/5},TextField("AGAIN",tw/2-tw/9.5,th/2+th/5.5,tw/10,shadeColor("#8888bb",lightx)),lightx=40<(lightx+=1)?0:lightx,ctx.restore()};var tutorialTimes=removetutorialTimes=0;Tutorial=function(t){ctx.save();var e=tw,o=th;ctx.globalAlpha=.5,ctx.fillStyle="#333",ctx.fillRect(0,0,e,o),ctx.beginPath(),ctx.strokeStyle=shadeColor("#eeeeee",tutorialTimes),ctx.setLineDash([9]),ctx.lineWidth=5,ctx.strokeRect(e/2+e/3.5,5,e/5,o/16),ctx.moveTo(e/2,0),ctx.lineTo(e/2,o*t*tutorialTimes),tutorialTimes+=2,removetutorialTimes+=t,tutorialTimes=math.min(o,tutorialTimes),ctx.globalAlpha=tutorialTimes/o,ctx.stroke(),ctx.fillStyle=shadeColor("#eeeeee",tutorialTimes),ctx.font=e/20+"px sans-serif",ctx.fillText("Move Left",e/8,o-5),ctx.fillText("Move Right",e/8+e/2,o-5),t=e/4+e/2;var r=o/2+o/4;ctx.moveTo(t,r),ctx.bezierCurveTo(t+100,r+100,t-100,r,t,o-e/20),t=e/4,ctx.moveTo(t,r),ctx.bezierCurveTo(t+100,r+100,t-100,r,t,o-e/20),ctx.stroke(),ctx.closePath(),ctx.restore()},ItemGenerator=function(t){var e=Min(RandInt(t),5),o=AppearArry(),r=Min(6,t);if(level%3||!level)o.forEach((function(t,o){if(t&&t<=e){var n=RandInt(r);new Item(o*tw/6,th+32,48,48,BadItemImage[n],2)}}));else{var n=0,i=AppearDist(o);WallResize(i).forEach((function(t,e){"0"!=i[e]?new Item(n,th+32,t,32,BadItemImage[1],2):n+=tw/6,n+=t}))}},GameWorldInit=function(t){BackgroundMoveObject=[],BuildingWallInitial(),BadItemImage=[iron_ball_shake,long_wall,iron_ball_rotate,fix_arrow,ciclre,fansa,adsf],GamePlayObject=GamePlayObject.filter((function(t){return t instanceof Cloud})),PlayerConfig.maxScore=StringToFloat(localGet("S"))||0,PlayerConfig.maxMeter=StringToFloat(localGet("M"))||0},NewGame=function(t){GamePlayObject=[],CloudCreate(RandInt(3)),player=new Faller(tw/2,th/8,tw/16,th/16,10),startButton=returnButton=null,level=1,key1.p=0,key1.m=1,removetutorialTimes=0,CanPlaysong("song1")};var lastUpdate=timer.now(),distanceY=soundStop=0,changeSong=1;Update=function(){var t=timer.now(),e=(t-lastUpdate)/1e3;lastUpdate=t,BackgroundView(),!key1.m&&SoundNode?(StopSong(),soundStop=1):(soundStop&&(PlaySong(8>level?"song1":"song2"),soundStop=0),10<=level&&changeSong&&(StopSong(),PlaySong(10>level?"song1":"song2"),changeSong=0)),key1.r?Start(e):key1.p?(Pause(),GameUIView(0)):(ctx.save(),ctx.strokeStyle="#FF1",ctx.fillStyle="#555",ctx.beginPath(),ctx.moveTo(tw/8,0),ctx.lineTo(0,th),ctx.lineTo(tw,th),ctx.lineTo(tw-tw/8,0),ctx.fill(),ctx.clip(),BackgroundMoveObject.forEach((function(t){t.render(e)})),ctx.restore(),GamePlayObject.forEach((function(t){t.pos.y<=th?t.render(e):t.update(e)})),(distanceY+=level)>=128+20*level&&(ItemGenerator(level),distanceY=0),0>=player.life&&End(e),5>=removetutorialTimes?Tutorial(e):removetutorialTimes=6,GameUIView(e))},MainLoop=function(t){ctx.clearRect(0,0,canvasWidth,canvasHeight),ctx.save(),ctx.scale(2,2),tw=canvasWidth/2,th=canvasHeight/2,Update(),ctx.restore(),requestAnimationFrame(MainLoop)},GameWorldInit(0),MainLoop(0)</script>