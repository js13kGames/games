<!doctype html><title>Offline</title><meta content="width=device-width" name=viewport><meta content=#ff0000 name=theme-color><link href=manifest.webmanifest rel=manifest><style>body,html{width:100%;height:100%;margin:0;padding:0}canvas{max-width:100%;max-height:100%;margin:auto;display:block}</style><canvas height=3840 width=2160></canvas><script>"serviceWorker"in navigator&&navigator.serviceWorker.register("./worker.js")</script><script>function SfxrParams(){this.setSettings=function(t){for(var e=0;e<24;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var n=this.b+this.c+this.e;if(n<.18){var i=.18/n;this.b*=i,this.c*=i,this.e*=i}}}function SfxrSynth(){var t,e,n,i,s,h,o,r,a,l,c,u;this._params=new SfxrParams,this.reset=function(){var t=this._params;i=100/(t.f*t.f+.001),s=100/(t.g*t.g+.001),h=1-t.h*t.h*t.h*.01,o=-t.i*t.i*t.i*1e-6,t.a||(c=.5-t.n/2,u=5e-5*-t.o),r=1+t.l*t.l*(0<t.l?-.9:10),a=0,l=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var i=this._params;return t=i.b*i.b*1e5,e=i.c*i.c*1e5,n=i.e*i.e*1e5+12,3*((t+e+n)/3|0)},this.synthWave=function(_,f){var v=this._params,d=1!=v.s||v.v,p=v.v*v.v*.1,g=1+3e-4*v.w,y=v.s*v.s*v.s*.1,m=1+1e-4*v.t,w=1!=v.s,x=v.x*v.x,b=v.g,C=v.q||v.r,S=v.r*v.r*v.r*.2,k=v.q*v.q*(v.q<0?-1020:1020),M=v.p?32+((1-v.p)*(1-v.p)*2e4|0):0,P=v.d,T=v.j/2,L=v.k*v.k*.01,z=v.a,H=t,O=1/t,F=1/e,E=1/n,W=5/(1+v.u*v.u*20)*(.01+y);.8<W&&(W=.8),W=1-W;for(var R,D,A,B,I,U,j=!1,N=0,G=0,q=0,V=0,X=0,Y=0,J=0,$=0,K=0,Q=0,Z=new Array(1024),tt=new Array(32),et=Z.length;et--;)Z[et]=0;for(et=tt.length;et--;)tt[et]=2*Math.random()-1;for(et=0;et<f;et++){if(j)return et;if(M&&++K>=M&&(K=0,this.reset()),l&&++a>=l&&(l=0,i*=r),s<(i*=h+=o)&&(i=s,0<b&&(j=!0)),D=i,0<T&&(Q+=L,D*=1+Math.sin(Q)*T),(D|=0)<8&&(D=8),z||((c+=u)<0?c=0:.5<c&&(c=.5)),++G>H)switch(G=0,++N){case 1:H=e;break;case 2:H=n}switch(N){case 0:q=G*O;break;case 1:q=1+2*(1-G*F)*P;break;case 2:q=1-G*E;break;case 3:j=!(q=0)}C&&((A=0|(k+=S))<0?A=-A:1023<A&&(A=1023)),d&&g&&((p*=g)<1e-5?p=1e-5:.1<p&&(p=.1)),U=0;for(var nt=8;nt--;){if(D<=++J&&(J%=D,3==z))for(var it=tt.length;it--;)tt[it]=2*Math.random()-1;switch(z){case 0:I=J/D<c?.5:-.5;break;case 1:I=1-J/D*2;break;case 2:I=.225*(((I=1.27323954*(B=6.28318531*(.5<(B=J/D)?B-1:B))+.405284735*B*B*(B<0?1:-1))<0?-1:1)*I*I-I)+I;break;case 3:I=tt[Math.abs(32*J/D|0)]}d&&(R=Y,(y*=m)<0?y=0:.1<y&&(y=.1),w?(X+=(I-Y)*y,X*=W):(Y=I,X=0),V+=(Y+=X)-R,I=V*=1-p),C&&(Z[$%1024]=I,I+=Z[($-A+1024)%1024],$++),U+=I}U*=.125*q*x,_[et]=1<=U?32767:U<=-1?-32768:32767*U|0}return f}}var synth=new SfxrSynth;window.jsfxr=function(t){synth._params.setSettings(t);var e=synth.totalReset(),n=new Uint8Array(4*((e+1)/2|0)+44),i=2*synth.synthWave(new Uint16Array(n.buffer,44),e),s=new Uint32Array(n.buffer,0,44);s[0]=1179011410,s[1]=i+36,s[2]=1163280727,s[3]=544501094,s[4]=16,s[5]=65537,s[6]=44100,s[7]=88200,s[8]=1048578,s[9]=1635017060,s[10]=i,i+=44;for(var h=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="data:audio/wav;base64,";h<i;h+=3){var a=n[h]<<16|n[h+1]<<8|n[h+2];r+=o[a>>18]+o[a>>12&63]+o[a>>6&63]+o[63&a]}return r},function(t){"use strict";function e(t,e){function n(){}n.prototype=t;var i=new n;for(var s in e)i[s]=e[s];return e.toString!==Object.prototype.toString&&(i.toString=e.toString),i}var n=function(){this.length=0};n.__name__=!0,n.prototype={add:function(t){var e=new i(t,null);null==this.h?this.h=e:this.q.next=e,this.q=e,this.length++},isEmpty:function(){return null==this.h},remove:function(t){for(var e=null,n=this.h;null!=n;){if(n.item==t)return null==e?this.h=n.next:e.next=n.next,this.q==n&&(this.q=e),this.length--,!0;n=(e=n).next}return!1},__class__:n};var i=function(t,e){this.item=t,this.next=e};i.__name__=!0,i.prototype={__class__:i},Math.__name__=!0;var s=function(){this.snd=[{n:"connect",d:[0,.0569,.3164,.0057,.1189,.0894,0,.2936,0,0,.4187,.777,-.549,.4122,.1495,.2339,.0218,-.0899,.9101,-.0425,0,.0045,-.1496,.5]},{n:"cut",d:[3,.0031,.01,.6358,.7673,.623,0,.0064,-.2824,0,0,-.6987,.8818,.0843,.0151,0,.6129,-.1907,.8763,-.6456,-.1449,.2061,.8743,.5]},{n:"noconnect",d:[1,.0239,.01,.0027,.4547,8e-4,0,.9277,.0969,0,.0339,.742,-.842,0,.0753,.8261,.1601,-.111,.9888,-.2613,-.6261,.0521,-.0103,.5]},{n:"online",d:[2,0,.885,.0033,.69,.32,0,.24,-.12,.79,0,-.0999,0,.84,.27,0,.8799,.4099,.33,-.1899,.785,.175,-.57,.5]},{n:"select",d:[2,0,.4063,.081,.1983,.8418,0,0,.0046,.0313,.4542,.6823,.5928,.0208,-.1256,0,.2557,-.8902,.9999,-.9317,0,.1554,0,.5]}],this.lvl=[{device:[{y:4,x:4,type:"GW"},{y:12,x:4,type:"PC"}],name:"Tutorial 1",help:{ty:12,tx:5,fy:4,fx:5}},{device:[{y:4,x:4,type:"GW"},{y:12,x:1,type:"PC"},{y:9,x:4,type:"PC"},{y:12,x:7,type:"PC"}],name:"Tutorial 2"},{connection:[{b:"2",a:"1"}],device:[{id:"1",y:3,x:4,type:"GW"},{id:"2",y:13,x:7,type:"PR"},{y:9,x:2,type:"PC"}],name:"Tutorial 3",help:{ty:11,tx:4,fy:5,fx:7}},{device:[{y:2,x:4,type:"GW"},{y:5,x:1,type:"PC"},{y:5,x:7,type:"PC"},{y:8,x:1,type:"PC"},{y:8,x:7,type:"PC"},{y:11,x:1,type:"PC"},{y:11,x:7,type:"PC"},{y:14,x:4,type:"PR"}],name:"Simple 1"},{device:[{y:2,x:4,type:"GW"},{y:5,x:1,type:"PC"},{y:5,x:7,type:"PC"},{y:9,x:4,type:"SW"},{y:13,x:1,type:"PR"},{y:13,x:7,type:"PR"}],name:"Simple 2"},{device:[{y:3,x:4,type:"GW"},{y:13,x:4,type:"FW"},{subnet:"A",y:8,x:2,type:"PC"},{subnet:"B",y:8,x:6,type:"PC"}],name:"Subnets 1"},{device:[{y:3,x:4,type:"GW"},{y:10,x:2,type:"SW"},{y:10,x:6,type:"SW"},{y:7,x:4,type:"FW"},{subnet:"A",y:14,x:1,type:"PC"},{subnet:"B",y:14,x:3,type:"PC"},{subnet:"A",y:14,x:5,type:"PC"},{subnet:"B",y:14,x:7,type:"PC"}],name:"Subnets 2"}],this.img=[{name:"back",data:'<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1" viewBox="0 0 64 64" height="240" width="240"><defs><linearGradient id="a"><stop offset="0" stop-color="#fff"/><stop offset="1" stop-color="#fff" stop-opacity="0"/></linearGradient><linearGradient xlink:href="#a" id="b" x1="58" y1="22" x2="57" y2="3" gradientUnits="userSpaceOnUse"/></defs><path d="M0 50l20-13v8c29 1 33-24 33-45h11c0 20-6 56-44 56v8z" fill="url(#b)"/></svg>'},{name:"check",data:'<svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 64 64" height="240" width="240"><path d="M0 37c9 9 17 18 21 27 7-15 25-42 43-64-16 12-33 29-44 46-10-7-14-8-20-9z" fill="#fff"/></svg>'},{name:"firewall",data:'<svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 64 64" height="240" width="240"><path fill="#fff" d="M3 37h21v11H3zM28 37h21v11H28zM53 37h7v11h-7zM60 49H39v11h21zM35 49H14v11h21zM11 49H4v11h7zM60 25H39v11h21zM35 25H14v11h21zM11 25H4v11h7zM17 23c4-4 5-9 6-14l5 5c2-2 3-6 3-12 3 4 6 9 6 15 2-1 3-4 4-6 3 4 5 7 6 12H35l-3-6-4 6z"/></svg>'},{name:"gateway",data:'<svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 64 64" height="240" width="240"><path fill="#fff" d="M3 3h11v57H3zM49 3h11v57H49zM17 9h4v45h-4zM25 9h4v45h-4zM33 9h4v45h-4zM42 9h4v45h-4z"/><path fill="#fff" d="M17 13h28v4H17zM17 40h28v4H17z"/><path fill="#fff" d="M18 38l23-22 3 2-23 23zM13 16h5v8h-5zM13 42h5v8h-5zM44 20h8v5h-8z"/></svg>'},{name:"pc",data:'<svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 64 64" height="240" width="240"><g fill="#fff"><path d="M12 7h39v30H12zM3 38h57v20H3z"/></g></svg>'},{name:"printer",data:'<svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 64 64" height="240" width="240"><path d="M20 20h24M20 9v11H3v24h17v11h24V44h16V20H44V9zm0 35v-6h24v6" fill="none" stroke="#fff"/><path d="M44 40v-3H20v6H3V20h57v23H44z" fill="#fff"/><path d="M24 42h16M24 46h16M24 50h16" fill="#fff" stroke="#fff"/></svg>'},{name:"server",data:'<svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 64 64" height="240" width="240"><g fill="#fff"><path d="M12 7h39v30H12zM3 38h57v20H3z"/></g></svg>'},{name:"switch",data:'<svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 64 64" height="240" width="240"><path d="M4 4v55h55V4H4zm8 7h11v4h4v9H8v-9h4v-4zm29 0h11v4h4v9H37v-9h4v-4zM12 40h11v4h4v9H8v-9h4v-4zm29 0h11v4h4v9H37v-9h4v-4z" fill="#fff"/></svg>'},{name:"touch",data:'<svg xmlns="http://www.w3.org/2000/svg" version="1" viewBox="0 0 127 127" height="480" width="480"><path d="M93 103l-7-7c-4-4-9 0-23-5H49c-9 2-12-12-4-14l17-1-38-39c-6-6 5-17 11-11l19 19c3-5 27-23 33-18l19 19c6 6 0 19 5 25l8 7z" fill="gray" stroke="#000"/><circle cx="-1" cy="45" r="22" transform="rotate(-45)" fill="none" stroke="gray" stroke-width="6"/></svg>'}]};s.__name__=!0,s.prototype={__class__:s};var h=function(){};h.__name__=!0,h.string=function(t){return l.__string_rec(t,"")};var o=function(){},r=function(){this.h={}};r.__name__=o.__name__=!0,r.__interfaces__=[o],r.prototype={setReserved:function(t,e){null==this.rh&&(this.rh={}),this.rh["$"+t]=e},getReserved:function(t){return null==this.rh?null:this.rh["$"+t]},__class__:r};var a=function(t){Error.call(this),this.val=t,this.message=String(t),Error.captureStackTrace&&Error.captureStackTrace(this,a)};a.__name__=!0,a.wrap=function(t){return t instanceof Error?t:new a(t)},a.__super__=Error,a.prototype=e(Error.prototype,{__class__:a});var l=function(){};l.__name__=!0,l.getClass=function(t){if(t instanceof Array&&null==t.__enum__)return Array;var e=t.__class__;if(null!=e)return e;var n=l.__nativeClassName(t);return null!=n?l.__resolveNativeClass(n):null},l.__string_rec=function(t,e){if(null==t)return"null";if(5<=e.length)return"<...>";var n=typeof t;switch("function"==n&&(t.__name__||t.__ename__)&&(n="object"),n){case"function":return"<function>";case"object":if(t instanceof Array){if(t.__enum__){if(2==t.length)return t[0];var i=t[0]+"(";e+="\t";for(var s=2,h=t.length;s<h;){var o=s++;i+=2!=o?","+l.__string_rec(t[o],e):l.__string_rec(t[o],e)}return i+")"}var r="[";e+="\t";for(var a=0,c=t.length;a<c;){var u=a++;r+=(0<u?",":"")+l.__string_rec(t[u],e)}return r+"]"}var _;try{_=t.toString}catch(t){return"???"}if(null!=_&&_!=Object.toString&&"function"==typeof _){var f=t.toString();if("[object Object]"!=f)return f}var v=null,d="{\n";e+="\t";var p=null!=t.hasOwnProperty;for(var v in t)p&&!t.hasOwnProperty(v)||"prototype"!=v&&"__class__"!=v&&"__super__"!=v&&"__interfaces__"!=v&&"__properties__"!=v&&(2!=d.length&&(d+=", \n"),d+=e+v+" : "+l.__string_rec(t[v],e));return d+"\n"+(e=e.substring(1))+"}";case"string":return t;default:return String(t)}},l.__interfLoop=function(t,e){if(null==t)return!1;if(t==e)return!0;var n=t.__interfaces__;if(null!=n)for(var i=0,s=n.length;i<s;){var h=n[i++];if(h==e||l.__interfLoop(h,e))return!0}return l.__interfLoop(t.__super__,e)},l.__instanceof=function(t,e){if(null==e)return!1;switch(e){case Array:return t instanceof Array&&null==t.__enum__;case A:return"boolean"==typeof t;case R:return!0;case D:return"number"==typeof t;case W:return"number"==typeof t&&(0|t)===t;case String:return"string"==typeof t;default:if(null==t)return!1;if("function"==typeof e){if(t instanceof e)return!0;if(l.__interfLoop(l.getClass(t),e))return!0}else if("object"==typeof e&&l.__isNativeObj(e)&&t instanceof e)return!0;return e==B&&null!=t.__name__||e==I&&null!=t.__ename__||t.__enum__==e}},l.__cast=function(t,e){if(l.__instanceof(t,e))return t;throw new a("Cannot cast "+h.string(t)+" to "+h.string(e))},l.__nativeClassName=function(t){var e=l.__toStr.call(t).slice(8,-1);return"Object"==e||"Function"==e||"Math"==e||"JSON"==e?null:e},l.__isNativeObj=function(t){return null!=l.__nativeClassName(t)},l.__resolveNativeClass=function(e){return t[e]};var c=function(){};c.__name__=!0,c.getLocalStorage=function(){try{var t=window.localStorage;return t.getItem(""),t}catch(t){return null}};var u=function(){this.height=0,this.width=0,this.y=0,this.x=0};u.__name__=!0,u.prototype={update:function(t,e){},__class__:u};var _=function(t){u.call(this);var e=v.imageMap;this.image=null!=U[t]?e.getReserved(t):e.h[t]};_.__name__=!0,_.__super__=u,_.prototype=e(u.prototype,{update:function(t,e){u.prototype.update.call(this,t,e),e.drawImage(this.image,0,0,this.image.width,this.image.height,this.x,this.y,this.width,this.height)},__class__:_});var f=function(t){this.upListener=null,this.downListener=null,this.down=!1,this.y=0,this.x=0,(this.c=t).onmousedown=E(this,this.onMouseDown),t.onmousemove=E(this,this.onMouseMove),t.onmouseup=E(this,this.onMouseUp),t.ontouchstart=E(this,this.onTouchStart),t.ontouchmove=E(this,this.onTouchMove),t.ontouchend=E(this,this.onTouchEnd)};f.__name__=!0,f.prototype={onMouseDown:function(t){this.down=!0,this.x=(t.pageX-this.c.offsetLeft)/this.c.offsetWidth*this.c.width,this.y=(t.pageY-this.c.offsetTop)/this.c.offsetHeight*this.c.height,null!=this.downListener&&this.downListener(this.x,this.y)},onMouseMove:function(t){this.x=(t.pageX-this.c.offsetLeft)/this.c.offsetWidth*this.c.width,this.y=(t.pageY-this.c.offsetTop)/this.c.offsetHeight*this.c.height},onMouseUp:function(t){this.down=!1,this.x=(t.pageX-this.c.offsetLeft)/this.c.offsetWidth*this.c.width,this.y=(t.pageY-this.c.offsetTop)/this.c.offsetHeight*this.c.height,null!=this.upListener&&this.upListener(this.x,this.y)},onTouchStart:function(t){this.down=!0,this.x=(t.touches.item(0).pageX-this.c.offsetLeft)/this.c.offsetWidth*this.c.width,this.y=(t.touches.item(0).pageY-this.c.offsetTop)/this.c.offsetHeight*this.c.height,null!=this.downListener&&this.downListener(this.x,this.y)},onTouchMove:function(t){this.x=(t.touches.item(0).pageX-this.c.offsetLeft)/this.c.offsetWidth*this.c.width,this.y=(t.touches.item(0).pageY-this.c.offsetTop)/this.c.offsetHeight*this.c.height},onTouchEnd:function(t){this.down=!1,this.x=(t.changedTouches.item(0).pageX-this.c.offsetLeft)/this.c.offsetWidth*this.c.width,this.y=(t.changedTouches.item(0).pageY-this.c.offsetTop)/this.c.offsetHeight*this.c.height,null!=this.upListener&&this.upListener(this.x,this.y)},__class__:f};var v=function(){};v.__name__=!0,v.main=function(){v.canvas=window.document.getElementsByTagName("canvas").item(0),v.context=v.canvas.getContext("2d",null),v.controls=new f(v.canvas),v.save=new d,new T(v.r.img,(function(t){v.imageMap=t,v.init(),v.lastTime=window.performance.now(),v.step(v.lastTime)})),v.sound=new L(v.r.snd)},v.init=function(){v.grid=new P(9,16,10),v.grid.x=0,v.grid.y=0,v.grid.width=v.canvas.width,v.grid.height=v.canvas.height,v.setScreenToLevelSelect()},v.setScreenToLevelSelect=function(t,e){null==e&&(e=!1),null==t&&(t=-1),e&&v.save.setLevelComplete(t),v.setScreen(new p(v.r.lvl,t))},v.setScreenToStage=function(t){v.setScreen(O.build(v.r.lvl[t],t))},v.setScreen=function(t){null!=v.screen&&v.grid.removeCell(0,0),v.screen=t,v.grid.addCell(0,0,9,16,v.screen)},v.step=function(t){var e=(t-v.lastTime)/1e3;v.lastTime=t,v.context.fillStyle="#000",v.context.fillRect(0,0,v.canvas.width,v.canvas.height),v.grid.update(e,v.context),window.requestAnimationFrame(v.step)};var d=function(){this.failoverMap=new r,this.storage=c.getLocalStorage()};d.__name__=!0,d.prototype={getValue:function(t){if(null!=this.storage)return this.storage.getItem(t);var e=this.failoverMap;return null!=U[t]?e.getReserved(t):e.h[t]},setValue:function(t,e){if(null==this.storage){var n=this.failoverMap;null!=U[t]?n.setReserved(t,e):n.h[t]=e}else this.storage.setItem(t,e)},isLevelComplete:function(t){var e=this.getValue("level_"+(null==t?"null":""+t));return null!=e&&"t"==e},setLevelComplete:function(t,e){null==e&&(e=!0),this.setValue("level_"+(null==t?"null":""+t),e?"t":"f")},__class__:d};var p=function(t,e){u.call(this),this.grid=new P(5,16,20),this.grid.y=250,this.lvlEnt=[];for(var n=0,i=0;i<t.length;){var s=t[i];++i;var h=new g(s.name);this.lvlEnt.push(h),this.grid.addCell(0,n,4,1,h),v.save.isLevelComplete(n)&&this.grid.addCell(4,n,1,1,new _("check_green")),++n}v.controls.downListener=E(this,this.onDown)};p.__name__=!0,p.__super__=u,p.prototype=e(u.prototype,{onDown:function(t,e){var n=this.grid.getEntityAt(t,e);if(null!=n){var i=this.lvlEnt.indexOf(n);v.sound.play("select"),v.setScreenToStage(i)}},update:function(t,e){u.prototype.update.call(this,t,e),e.fillStyle="#f00",e.font="bold 240px monospace";var n=e.measureText("Offline");e.fillText("Offline",this.width/2-n.width/2,240),this.grid.width=this.width,this.grid.height=this.height-this.grid.y,this.grid.update(t,e)},__class__:p});var g=function(t){u.call(this),this.name=t};g.__name__=!0,g.__super__=u,g.prototype=e(u.prototype,{update:function(t,e){u.prototype.update.call(this,t,e),e.fillStyle="#fff",e.font="bold "+this.height+"px monospace",e.fillText(this.name,this.x,this.y+this.height)},__class__:g});var y=function(t,e,i){null==e&&(e=1),this.connectionChecking=!1,this.connectionChecked=!1,this.online=!1,u.call(this),this.connectionLimit=e,this.subnet=i,this.connectedDevice=new n;var s=v.imageMap,h=t+"_red";this.imageOffline=null!=U[h]?s.getReserved(h):s.h[h];var o=v.imageMap,r=t+"_green";this.imageOnline=null!=U[r]?o.getReserved(r):o.h[r]};y.__name__=!0,y.__super__=u,y.prototype=e(u.prototype,{update:function(t,e){u.prototype.update.call(this,t,e);var n=this.isOnline()?this.imageOnline:this.imageOffline;e.drawImage(n,0,0,n.width,n.height,this.x,this.y,this.width,this.height),e.fillStyle="#fff",e.strokeStyle="#fff",e.lineWidth=3;for(var i=this.width/8,s=0,h=this.connectionLimit;s<h;){var o=s++,r=2*i*o+i;e.beginPath(),e.ellipse(this.x+r,this.y+this.height+i,i,i,0,0,2*Math.PI),o<this.connectedDevice.length?e.fill():e.stroke()}this.isOnline()?(e.beginPath(),e.ellipse(this.x+this.width-i,this.y-i,i,i/2,0,0,2*Math.PI)):(e.beginPath(),e.ellipse(this.x+this.width-2*i,this.y-i,i/2,i,.5*Math.PI,0,Math.PI),e.fill(),e.beginPath(),e.ellipse(this.x+this.width-i,this.y-i,i/2,i,.5*Math.PI,Math.PI,2*Math.PI)),e.fill();var a=this.getSubnetName();null!=a&&(e.font="bold 94px monospace",e.fillText(a,this.x,this.y))},isOnline:function(){return this.online},resetConnection:function(){this.connectionChecked=!1,this.online=!1},checkConnection:function(){if(this.connectionChecking)return null;if(!this.connectionChecked){for(var t=this.connectionChecking=!0,e=this.connectedDevice.h;null!=e;){var n=e.item;e=e.next;var i=n.checkConnection();null!=i?i&&(this.online=!0):t=!1}this.connectionChecking=!1,this.connectionChecked=t}return this.isOnline()},hasOpenConnections:function(){return this.connectionLimit>this.connectedDevice.length},getEffectiveSubnet:function(){return null==this.subnet?"":this.subnet},checkSubnet:function(t,e){return null==e&&(e=!0),this.getEffectiveSubnet()==t.getEffectiveSubnet()||!!e&&t.checkSubnet(this,!1)},getSubnetName:function(){return this.getEffectiveSubnet()},__class__:y});var m=function(){y.call(this,"firewall",3)};m.__name__=!0,m.__super__=y,m.prototype=e(y.prototype,{checkSubnet:function(t,e){return null==e&&(e=!0),!0},__class__:m});var w=function(t){y.call(this,"gateway",1,t)};w.__name__=!0,w.__super__=y,w.prototype=e(y.prototype,{isOnline:function(){return!0},checkConnection:function(){return!0},__class__:w});var x=function(t){y.call(this,"pc",2,t)};x.__name__=!0,x.__super__=y,x.prototype=e(y.prototype,{__class__:x});var b=function(t){y.call(this,"printer",1,t)};b.__name__=!0,b.__super__=y,b.prototype=e(y.prototype,{__class__:b});var C=function(t){this.subnetUpdated=!1,this.updatingSubnet=!1,y.call(this,"switch",4,t)};C.__name__=!0,C.__super__=y,C.prototype=e(y.prototype,{resetConnection:function(){y.prototype.resetConnection.call(this),this.subnetUpdated=!1,this.effectiveSubnet=null},checkConnection:function(){return this.connectionChecking||this.connectionChecked||this.updateSubnet(),y.prototype.checkConnection.call(this)},updateSubnet:function(){if(this.updatingSubnet)return!1;if(this.subnetUpdated)return!0;this.updatingSubnet=!0;for(var t=this.connectedDevice.h;null!=t;){var e=t.item;t=t.next;var n=e;l.__instanceof(n,m)||(!l.__instanceof(n,C)||l.__cast(n,C).updateSubnet()&&null!=n.getEffectiveSubnet())&&(this.subnetUpdated||(this.effectiveSubnet=n.getEffectiveSubnet(),this.subnetUpdated=!0))}return!(this.updatingSubnet=!1)},getSubnetName:function(){return null==this.effectiveSubnet||0==this.effectiveSubnet.length?this.subnet:"~"+this.effectiveSubnet},getEffectiveSubnet:function(){return null==this.subnet?this.effectiveSubnet:y.prototype.getEffectiveSubnet.call(this)},checkSubnet:function(t,e){return null==e&&(e=!0),null==this.getEffectiveSubnet()||y.prototype.checkSubnet.call(this,t,e)},__class__:C});var S=function(t,e,n,i){null==i&&(i=0),null==n&&(n=0),null==e&&(e=0),null==t&&(t=0),this.a=new M(t,e),this.b=new M(n,i)};S.__name__=!0,S.prototype={__class__:S};var k=function(){};k.__name__=!0,k.check=function(t,e){var n=t.b.minus(t.a),i=e.b.minus(e.a),s=(-n.y*(t.a.x-e.a.x)+n.x*(t.a.y-e.a.y))/(-i.x*n.y+n.x*i.y),h=(i.x*(t.a.y-e.a.y)-i.y*(t.a.x-e.a.x))/(-i.x*n.y+n.x*i.y);return 0<=s&&s<=1&&0<=h&&h<=1?new M(t.a.x+h*n.x,t.a.y+h*n.y):null};var M=function(t,e){null==e&&(e=0),null==t&&(t=0),this.x=t,this.y=e};M.__name__=!0,M.prototype={set:function(t,e){this.x=t,this.y=e},minus:function(t){return new M(this.x-t.x,this.y-t.y)},__class__:M};var P=function(t,e,i){null==i&&(i=5),u.call(this),this.cell=new n,this.hCell=t,this.vCell=e,this.cellPad=i};P.__name__=!0,P.__super__=u,P.prototype=e(u.prototype,{addCell:function(t,e,n,i,s){this.cell.add({x:t,y:e,w:n,h:i,e:s})},update:function(t,e){u.prototype.update.call(this,t,e);for(var n=this.width/this.hCell,i=this.height/this.vCell,s=this.cell.h;null!=s;){var h=s.item;s=s.next;var o=h;o.e.x=this.x+n*o.x+this.cellPad,o.e.y=this.y+i*o.y+this.cellPad,o.e.width=n*o.w-2*this.cellPad,o.e.height=i*o.h-2*this.cellPad,o.e.update(t,e)}},getEntityAt:function(t,e){var n=t-this.x,i=e-this.y;if(n<0||n>this.width||i<0||i>this.height)return null;var s=this.width/this.hCell,h=this.height/this.vCell,o=Math.floor(n/s),r=Math.floor(i/h),a=this.getCell(o,r);return null==a?null:a.e},getCell:function(t,e){for(var n=this.cell.h;null!=n;){var i=n.item;n=n.next;var s=i;if(t>=s.x&&t<s.x+s.w&&e>=s.y&&e<s.y+s.h)return s}return null},removeCell:function(t,e){this.cell.remove(this.getCell(t,e))},getCenterX:function(t){return this.width/this.hCell*(t+.5)},getCenterY:function(t){return this.height/this.vCell*(t+.5)},__class__:P});var T=function(t,e){var n=[{n:"red",c:"#FF0000"},{n:"green",c:"#00FF00"}];this.img=new r,this.loadCount=t.length*n.length,this.callback=e;for(var i=new RegExp("#F{3,6}","ig".split("u").join("")),s=0;s<t.length;){var o=t[s];++s;for(var a=0;a<n.length;){var l=n[a];++a;var c="data:image/svg+xml;base64,"+window.btoa(o.data.replace(i,l.c)),u=[o.name+"_"+h.string(l.n)],_=window.document.createElement("img");_.onload=E(this,this.loadCallback),_.onerror=function(t){return function(){window.console.error("Failed to load image resource: "+t[0])}}(u),_.src=c;var f=this.img;null!=U[u[0]]?f.setReserved(u[0],_):f.h[u[0]]=_}}};T.__name__=!0,T.prototype={loadCallback:function(){this.loadCount--,0==this.loadCount&&this.callback(this.img)},__class__:T};var L=function(t){this.s=new r,this.v=1;for(var e=0;e<t.length;){var n=t[e];++e;var i=jsfxr(n.d),s=window.document.createElement("audio");s.src=i;var h=n.n,o=this.s;null!=U[h]?o.setReserved(h,s):o.h[h]=s}};L.__name__=!0,L.prototype={play:function(t){var e=this.s;(null!=U[t]?e.getReserved(t):e.h[t]).currentTime=0;var n=this.s;(null!=U[t]?n.getReserved(t):n.h[t]).volume=this.v;var i=this.s;(null!=U[t]?i.getReserved(t):i.h[t]).play()},__class__:L};var z=function(t,e,n){_.call(this,"touch_green"),this.grid=t,this.tx=e,this.ty=n};z.__name__=!0,z.__super__=_,z.prototype=e(_.prototype,{update:function(t,e){_.prototype.update.call(this,t,e),e.strokeStyle="#888",e.lineWidth=10,e.beginPath(),e.moveTo(this.x+.25*this.width,this.y+.25*this.height),e.lineTo(this.grid.getCenterX(this.tx),this.grid.getCenterY(this.ty)),e.stroke()},__class__:z});var H=function(t){this.downOnBack=!1,this.transitionTimer=1,this.allOnline=!1,this.cutFrom=null,this.connectFrom=null,u.call(this),this.index=t,this.grid=new P(9,16,10),this.connectionList=new n,this.deviceList=new n,v.controls.downListener=E(this,this.onDown),v.controls.upListener=E(this,this.onUp),this.backIcon=new _("back_green"),this.backIcon.width=240,this.backIcon.height=240};H.__name__=!0,H.__super__=u,H.prototype=e(u.prototype,{update:function(t,e){u.prototype.update.call(this,t,e),this.grid.x=this.x,this.grid.y=this.y,this.grid.width=this.width,this.grid.height=this.height;for(var n=this.connectionList.h;null!=n;){var i=n.item;n=n.next;var s=i;this.updateConnection(s,t,e)}var h="Offline";this.allOnline?(this.transitionTimer-=t,this.transitionTimer<=0&&v.setScreenToLevelSelect(this.index,!0),e.fillStyle="#0f0",h="Online"):(null!=this.connectFrom&&(e.strokeStyle="#00f",e.lineWidth=3,e.beginPath(),e.moveTo(this.connectFrom.x+this.connectFrom.width/2,this.connectFrom.y+this.connectFrom.height/2),e.lineTo(v.controls.x,v.controls.y),e.stroke()),null!=this.cutFrom&&(e.strokeStyle="#f00",e.lineWidth=3,e.beginPath(),e.moveTo(this.cutFrom.x,this.cutFrom.y),e.lineTo(v.controls.x,v.controls.y),e.stroke()),e.fillStyle="#f00"),e.font="bold 240px monospace";var o=e.measureText(h);e.fillText(h,this.width/2-o.width/2,240),this.grid.update(t,e),this.backIcon.update(t,e)},updateConnection:function(t,e,n){n.strokeStyle="#0f0",n.lineWidth=3,n.beginPath();var i=t.a,s=t.a;n.moveTo(i.x+i.width/2,s.y+s.height/2);var h=t.b,o=t.b;n.lineTo(h.x+h.width/2,o.y+o.height/2),n.stroke()},checkDeviceConnections:function(){for(var t=this.deviceList.h;null!=t;){var e=t.item;t=t.next,e.resetConnection()}for(var n=!0,i=this.deviceList.h;null!=i;){var s=i.item;i=i.next,s.checkConnection()||(n=!1)}(this.allOnline=n)&&v.sound.play("online")},addDevice:function(t,e,n){this.grid.addCell(t,e,1,1,n),this.deviceList.add(n)},getConnection:function(t,e){for(var n=this.connectionList.h;null!=n;){var i=n.item;n=n.next;var s=i;if(!(s.a!=t&&s.b!=t||s.a!=e&&s.b!=e))return s}return null},addConnection:function(t,e,n){return null==n&&(n=!0),!(t==e||!t.hasOpenConnections()||!e.hasOpenConnections()||!t.checkSubnet(e)||null!=this.getConnection(t,e)||(this.connectionList.add({a:t,b:e}),t.connectedDevice.add(e),e.connectedDevice.add(t),n&&this.checkDeviceConnections(),0))},removeConnection:function(t,e,n){null==n&&(n=!0);var i=this.getConnection(t,e);null!=i&&(this.connectionList.remove(i),t.connectedDevice.remove(e),e.connectedDevice.remove(t)),n&&this.checkDeviceConnections()},addHelp:function(t,e,n,i){this.grid.addCell(t,e,2,2,new z(this.grid,n,i))},onDown:function(t,e){if(!this.allOnline){var n=this.grid.getEntityAt(t,e);this.connectFrom=null!=n&&l.__instanceof(n,y)?n:null,null==this.connectFrom&&(t<240&&e<240&&(this.downOnBack=!0),this.cutFrom=new M(t,e))}},onUp:function(t,e){if(this.downOnBack&&t<240&&e<240)return v.setScreenToLevelSelect(),void v.sound.play("select");if(null==this.connectFrom)null!=this.cutFrom&&(this.doCut(new S(this.cutFrom.x,this.cutFrom.y,t,e)),v.sound.play("cut"));else{var n=this.grid.getEntityAt(t,e),i=null!=n&&l.__instanceof(n,y)?n:null;null!=this.connectFrom&&null!=i&&(this.addConnection(this.connectFrom,i)?v.sound.play("connect"):v.sound.play("noconnect"))}this.connectFrom=null,this.cutFrom=null,this.downOnBack=!0},doCut:function(t){for(var e=new n,i=new S,s=this.connectionList.h;null!=s;){var h=s.item;s=s.next;var o=h,r=o.a,a=o.a;i.a.set(r.x+r.width/2,a.y+a.height/2);var l=o.b,c=o.b;i.b.set(l.x+l.width/2,c.y+c.height/2),null!=k.check(t,i)&&e.add(o)}for(var u=e.h;null!=u;){var _=u.item;u=u.next;var f=_;this.removeConnection(f.a,f.b,!1)}e.isEmpty()||this.checkDeviceConnections()},__class__:H});var O=function(){};O.__name__=!0,O.build=function(t,e){for(var n=new H(e),i=new r,s=0,h=t.device;s<h.length;){var o,l=h[s];switch(++s,l.type){case"FW":o=new m;break;case"GW":o=new w(l.subnet);break;case"PC":o=new x(l.subnet);break;case"PR":o=new b(l.subnet);break;case"SW":o=new C(l.subnet);break;default:throw new a("Unknown device type: "+l.type)}if(n.addDevice(l.x,l.y,o),null!=l.id){var c=l.id;null!=U[c]?i.setReserved(c,o):i.h[c]=o}}if(null!=t.connection)for(var u=0,_=t.connection;u<_.length;){var f=_[u];++u;var v=f.a,d=null!=U[v]?i.getReserved(v):i.h[v],p=f.b;n.addConnection(d,null!=U[p]?i.getReserved(p):i.h[p])}return null!=t.help&&n.addHelp(t.help.fx,t.help.fy,t.help.tx,t.help.ty),n};var F=0;function E(t,e){return null==e?null:(null==e.__id__&&(e.__id__=F++),null==t.hx__closures__?t.hx__closures__={}:n=t.hx__closures__[e.__id__],null==n&&((n=function(){return n.method.apply(n.scope,arguments)}).scope=t,n.method=e,t.hx__closures__[e.__id__]=n),n);var n}String.prototype.__class__=String,String.__name__=!0,Array.__name__=!0;var W={__name__:["Int"]},R={__name__:["Dynamic"]},D=Number;D.__name__=["Float"];var A=Boolean;A.__ename__=["Bool"];var B={__name__:["Class"]},I={},U={};l.__toStr={}.toString,v.r=new s,v.main()}("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this)</script><noscript>Javascript must be enabled to run this game</noscript>