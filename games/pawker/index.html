<!doctype html><meta name=viewport content="width=device-width"><title>Pawker - js13kGames 2025</title><style>body{margin:0;padding:0;display:flex;justify-content:center;align-items:center;height:100vh;background-color:#000}canvas{image-rendering:pixelated;border:1px solid #fff;transform:scale(1);background-color:#361}@media screen and (min-width:512px){canvas{transform:scale(2)}}@media screen and (min-width:768px){canvas{transform:scale(3)}}@media screen and (min-width:1024px){canvas{transform:scale(4)}}</style><canvas id=canvas width=256 height=240></canvas><script>!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver(t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)}).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();var t=(t=>(t.Linear="linear",t.EaseIn="easeIn",t.EaseOut="easeOut",t.EaseInOut="easeInOut",t))(t||{});class e{constructor(){this.x=0,this.y=0,this.opacity=1,this.scale=1,this.rotation=0,this.animations=[]}moveTo(t,e,s,i="linear",n){const a=performance.now();this.animations.push({startValue:this.x,targetValue:t,startTime:a,duration:s,easing:i,property:"x"}),this.animations.push({startValue:this.y,targetValue:e,startTime:a,duration:s,easing:i,property:"y",callback:n})}fadeTo(t,e,s="linear",i){const n=performance.now();this.animations.push({startValue:this.opacity,targetValue:t,startTime:n,duration:e,easing:s,property:"opacity",callback:i})}scaleTo(t,e,s="linear",i){const n=performance.now();this.animations.push({startValue:this.scale,targetValue:t,startTime:n,duration:e,easing:s,property:"scale",callback:i})}rotateTo(t,e,s="linear",i){const n=performance.now();this.animations.push({startValue:this.rotation,targetValue:t,startTime:n,duration:e,easing:s,property:"rotation",callback:i})}easeFunction(t,e){switch(e){case"easeIn":return t*t;case"easeOut":return 1-(1-t)*(1-t);case"easeInOut":return t<.5?2*t*t:1-Math.pow(-2*t+2,2)/2;default:return t}}update(t){const e=performance.now();this.animations=this.animations.filter(t=>{const s=e-t.startTime,i=Math.min(s/t.duration,1);if(i>=1)return this[t.property]=t.targetValue,t.callback&&t.callback(),!1;{const e=this.easeFunction(i,t.easing),s=t.startValue+(t.targetValue-t.startValue)*e;return this[t.property]=s,!0}})}isAnimating(){return this.animations.length>0}stopAnimations(){this.animations=[]}}function s(){return document.getElementById("canvas").getContext("2d")}class i extends e{constructor(t){super(),Object.assign(this,t),this.context=s()}update(t){super.update(t)}render(){this.context&&this.draw(this.context)}draw(t){t.save(),t.globalAlpha=this.opacity,t.translate(this.x+this.width/2,this.y+this.height/2),t.scale(this.scale,this.scale),t.rotate(this.rotation*Math.PI/180),t.translate(-this.x-this.width/2,-this.y-this.height/2)}postDraw(t){t.restore()}}const n=class t{constructor(e,i,n,a="#ffffff"){this.content=e,this.x=i,this.y=n,this.color=a,this.context=s(),t.fontImage||(t.fontImage=new Image,t.fontImage.src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAAAgCAMAAADt/IAXAAAAAXNSR0IArs4c6QAAAAZQTFRFAAAA////pdmf3QAAAbRJREFUWIXFVFGyxCAIg/tf+s3uVgkJWO37qDPbrlYwJEGzGO7X8/enGe7yeQaODYtwjdsAgCk/f+l7nPx9Xr/z88eCcwL/Fn1V7i4UJADfjXsIOgC8SqSrBAzA9ijQ41YAZlE/CbyKO2Rg1ypuRMCxB1qvbUPy7EIWIQPQLtgG8HjcZLw7aRZEFUQl2f7YDhhfXBBb505RY35NMyIkGhGPOeQB2KvzKQFEkKuuzvIM5L8AJEFnJoeL6epBkWxKcKpBJE0JCWAkrirFvjxjQBIID5zXVwCeSDCZQBejuxNUdX0ZD4n3GHh/DJM1/c0e0+9glmI96wim1gvVk8bwK6UV7amNFYDHmuW4sp9L5y+AFAAI+CjQMwCtvL75Cg/63F8CUK9yfqpcJbhjoJIA8nIhbiRpw8CuB7wGQAd0JiwYyBKEN2KKQNg7uJGl8wLA3P/6qCqWeSOPleuHpd3ob/jcATAjBtXsHr2AVoffAxAvkLmNGC0A8EXEG1sAbh7fMdAAQPdODBgB0NqJdgMAEIBt8gTAMBtRGt1V9WUrXcMkipunXV+LeeJV7Y8KG/MtmuSNm+EPXZoEwevTlxwAAAAASUVORK5CYII=")}getCharacterPosition(e){const s={" ":0,"!":1,'"':2,"&":6,"(":8,")":9,"©":10,",":12,".":15,"/":16,0:16,1:17,2:18,3:19,4:20,5:21,6:22,7:23,8:24,9:25,":":26,";":27,"<":28,"=":29,">":30,"?":31,"Å":32,A:33,B:34,C:35,D:36,E:37,F:38,G:39,H:40,I:41,J:42,K:43,L:44,M:45,N:46,O:47,P:48,Q:49,R:50,S:51,T:52,U:53,V:54,W:55,X:56,Y:57,Z:58,"♥":59,"♦":60,"♠":61,"♣":62},i=void 0!==s[e]?s[e]:0,n=i%t.FONT_COLS,a=Math.floor(i/t.FONT_COLS);return{sx:n*t.CHAR_WIDTH,sy:a*t.CHAR_HEIGHT}}draw(e){const s=e||this.context;if(!s||!t.fontImage||!t.fontImage.complete)return;s.save();let i=this.x;for(let e=0;e<this.content.length;e++){const n=this.content[e];if(" "===n){i+=t.CHAR_WIDTH;continue}const{sx:a,sy:o}=this.getCharacterPosition(n),h=document.createElement("canvas");h.width=t.CHAR_WIDTH,h.height=t.CHAR_HEIGHT;const c=h.getContext("2d");c.drawImage(t.fontImage,a,o,t.CHAR_WIDTH,t.CHAR_HEIGHT,0,0,t.CHAR_WIDTH,t.CHAR_HEIGHT);const r=c.getImageData(0,0,t.CHAR_WIDTH,t.CHAR_HEIGHT),d=r.data;for(let t=0;t<d.length;t+=4){const e=d[t],s=d[t+1],i=d[t+2];if(0===e&&0===s&&0===i)d[t+3]=0;else if("#ffffff"!==this.color){const e=this.hexToRgb(this.color);e&&(d[t]=e.r,d[t+1]=e.g,d[t+2]=e.b)}}c.putImageData(r,0,0),s.drawImage(h,i,this.y),i+=t.CHAR_WIDTH}s.restore()}hexToRgb(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:null}getWidth(){return this.content.length*t.CHAR_WIDTH}getHeight(){return t.CHAR_HEIGHT}setText(t){this.content=t.toUpperCase()}setPosition(t,e){this.x=t,this.y=e}};n.fontImage=null,n.CHAR_WIDTH=8,n.CHAR_HEIGHT=8,n.FONT_COLS=16,n.FONT_ROWS=4;let a=n;class o extends i{constructor(t){super({x:t.x,y:t.y,width:20,height:30}),this.faceDown=!1,this.width=20,this.height=30,this.value=t.value,this.suit=t.suit,this.faceDown=!!t.faceDown,this.image=this.generateCardImage();const e="♥"===this.suit||"♦"===this.suit?"#ff0000":"#000000";this.valueText=new a(this.value,this.x+2,this.y+2,e),this.suitText=new a(this.suit,this.x+2,this.y+12,e)}generateCardImage(){const t=document.createElement("canvas");t.width=this.width,t.height=this.height;const e=t.getContext("2d");t.style.imageRendering="pixelated",e.imageSmoothingEnabled=!1,e.fillStyle="#ffffff",e.fillRect(0,0,this.width,this.height),e.strokeStyle="#000000",e.lineWidth=2,e.strokeRect(3,3,this.width-6,this.height-6);const s=new Image;return s.src=t.toDataURL(),s}draw(t){if(super.draw(t),this.faceDown){t.fillStyle="#002b5c",t.fillRect(this.x,this.y,this.width,this.height),t.fillStyle="#104070";for(let e=2;e<this.width-2;e+=4)for(let s=2;s<this.height-2;s+=4)t.fillRect(this.x+e,this.y+s,1,1);return t.strokeStyle="#000000",t.lineWidth=2,t.strokeRect(this.x+2,this.y+2,this.width-4,this.height-4),void super.postDraw(t)}this.image&&t.drawImage(this.image,this.x,this.y,this.width,this.height),this.valueText.setPosition(this.x+6,this.y+6),this.suitText.setPosition(this.x+6,this.y+16),this.valueText.draw(t),this.suitText.draw(t),super.postDraw(t)}}class h{constructor(){this.deck=[],this.hands=[[],[]],this.comboRows=[[],[]],this.currentPlayer=0,this.playerId=null,this.opponentId=null,this.gameOver=!1,this.activeAnimations=[],this.animatingSlots=new Set,this.pendingAnimations=0,this.seedApplied=!1,this.seedConfirmed=!1,this.ackSet=new Set,this.participants=new Set,this.hasSentHostSeed=!1;const t=s();if(!t)throw new Error("No canvas context");this.ctx=t,this.statusText=new a("Waiting...",10,10),this.resetDeck(),h.generateDeckFromSeed(1)}static mulberry32(t){return function(){let e=t+=1831565813;return e=Math.imul(e^e>>>15,1|e),e^=e+Math.imul(e^e>>>7,61|e),((e^e>>>14)>>>0)/4294967296}}static generateDeckFromSeed(t){const e=["♥","♦","♠","♣"],s=["A","2","3","4","5","6","7","8","9","10","J","Q","K"],i=[];for(const t of e)for(const e of s)i.push({value:e,suit:t});const n=h.mulberry32(Math.floor(t));for(let t=i.length-1;t>0;t--){const e=Math.floor(n()*(t+1));[i[t],i[e]]=[i[e],i[t]]}return i}resetDeck(){const t=["♥","♦","♠","♣"],e=["A","2","3","4","5","6","7","8","9","10","J","Q","K"];this.deck=[];for(const s of t)for(const t of e)this.deck.push({value:t,suit:s});for(let t=this.deck.length-1;t>0;t--){const e=Math.floor(Math.random()*(t+1));[this.deck[t],this.deck[e]]=[this.deck[e],this.deck[t]]}}dealInitial(){for(let t=0;t<2;t++)for(let e=0;e<5;e++){const e=this.deck.pop();e&&this.hands[t].push(e)}}draw(){const t=this.ctx;t.fillStyle="#203070",t.fillRect(0,0,t.canvas.width,t.canvas.height),t.fillStyle="#ffffff",t.fillRect(t.canvas.width/2-12,t.canvas.height/2-18,24,36),t.strokeStyle="#000",t.strokeRect(t.canvas.width/2-12,t.canvas.height/2-18,24,36);const e=t.canvas.height-50;let s=20;for(let i=0;i<this.hands[0].length;i++){if(this.animatingSlots.has(`hand:0:${i}`)){s+=28;continue}const n=this.hands[0][i];new o({x:s,y:e,value:n.value,suit:n.suit}).draw(t),s+=28}s=20;for(let e=0;e<this.hands[1].length;e++){if(this.animatingSlots.has(`hand:1:${e}`)){s+=28;continue}const i=this.hands[1][e];new o({x:s,y:20,value:i.value,suit:i.suit,faceDown:!0}).draw(t),s+=28}const i=t.canvas.height/2+40;s=60;for(let e=0;e<this.comboRows[0].length;e++){if(this.animatingSlots.has(`combo:0:${e}`)){s+=28;continue}const n=this.comboRows[0][e];new o({x:s,y:i,value:n.value,suit:n.suit}).draw(t),s+=28}const n=t.canvas.height/2-80;s=60;for(let e=0;e<this.comboRows[1].length;e++){if(this.animatingSlots.has(`combo:1:${e}`)){s+=28;continue}const i=this.comboRows[1][e];new o({x:s,y:n,value:i.value,suit:i.suit}).draw(t),s+=28}for(const e of this.activeAnimations)e.draw(t);this.statusText.draw(t)}attachWebSocket(t){this.ws=new WebSocket(t),this.ws.onopen=()=>{this.statusText.setText("Connected");try{this.ws.send(JSON.stringify({type:"join",data:"hello"}))}catch(t){}setTimeout(()=>{if(!this.seedApplied&&(this.electHost(),!this.seedApplied)){const t=Date.now()^Math.floor(4294967295*Math.random());this.deck=h.generateDeckFromSeed(t),this.hands=[[],[]],this.comboRows=[[],[]],this.dealInitial(),this.seedApplied=!0,this.seedConfirmed=!0,this.statusText.setText("Local seed applied (solo)")}},800)},this.ws.onmessage=t=>{const e=t.data;if("string"==typeof e)if("@"!==e[0]||this.playerId)if("+"===e[0]){const t=e.slice(1);this.participants.add(t),this.statusText.setText("Player joined: "+t),this.electHost()}else if("-"===e[0]){const t=e.slice(1);this.participants.delete(t),this.statusText.setText("Player left: "+t),this.electHost()}else try{const s=JSON.parse(e);if("play"===s.type){const t=s.data&&s.data.played?s.data.played:null,e=s.data&&s.data.draw?s.data.draw:null;t&&this.onOpponentPlay(t,e)}else if("host-seed"===s.type){if(!this.seedApplied){const e=Number(s.data)||Date.now();this.deck=h.generateDeckFromSeed(e),this.hands=[[],[]],this.comboRows=[[],[]],this.dealInitial(),this.seedApplied=!0,this.statusText.setText("Host seed applied — sending ACK");try{this.ws.send(JSON.stringify({type:"host-seed-ack",data:this.playerId||""}))}catch(t){}}}else if("host-seed-ack"===s.type)try{const t=String(s.data||"");t&&(this.ackSet.add(t),this.playerId&&this.hasSentHostSeed&&!this.seedConfirmed&&this.ackSet.size>0&&this.sendSeedConfirm())}catch(t){}else"seed-confirm"===s.type?(this.seedConfirmed=!0,this.statusText.setText("Seed confirmed — game ready")):"join"===s.type?this.statusText.setText("Player joined"):"join"===s.type&&(this.opponentId=s.data)}catch(t){}else this.playerId=e.slice(1),this.participants.add(this.playerId),this.statusText.setText("My id: "+this.playerId),this.electHost()},this.ws.onclose=()=>{this.statusText.setText("Disconnected")}}electHost(){if(!this.playerId)return;const t=Array.from(this.participants).map(t=>Number(t)).filter(t=>!isNaN(t));if(0===t.length)return;const e=String(Math.min(...t));if(this.playerId===e&&!this.hasSentHostSeed){this.hasSentHostSeed=!0;const e=Date.now()^Math.floor(4294967295*Math.random());this.deck=h.generateDeckFromSeed(e),this.hands=[[],[]],this.comboRows=[[],[]],this.dealInitial(),this.seedApplied=!0;try{this.ws.send(JSON.stringify({type:"host-seed",data:e}))}catch(t){}this.statusText.setText("I am host — seed sent (waiting for ACK)"),this.seedConfirmTimeoutId=window.setTimeout(()=>this.sendSeedConfirm(),1500)}}sendSeedConfirm(){if(!this.seedConfirmed){if(this.seedConfirmed=!0,this.ws)try{this.ws.send(JSON.stringify({type:"seed-confirm",data:""}))}catch(t){}this.seedConfirmTimeoutId&&(clearTimeout(this.seedConfirmTimeoutId),this.seedConfirmTimeoutId=void 0),this.statusText.setText("Seed confirmed — game ready")}}update(t){for(const e of this.activeAnimations)e.update(t)}getHandPosition(t,e){const s=this.ctx;return{x:20+28*e,y:0===t?s.canvas.height-50:20}}getComboPosition(t,e){const s=this.ctx;return{x:60+28*e,y:0===t?s.canvas.height/2+40:s.canvas.height/2-80}}sendPlay(t){}sendPlayWithDraw(t,e){if(!this.ws)return;const s={type:"play",data:{played:t,draw:e||null}};this.ws.send(JSON.stringify(s))}onOpponentPlay(e,s){const i=this.hands[1].findIndex(t=>t.value===e.value&&t.suit===e.suit);let n={x:this.ctx.canvas.width/2-12,y:this.ctx.canvas.height/2-18},a=null;i>=0&&(this.animatingSlots.add(`hand:1:${i}`),n=this.getHandPosition(1,i),a=i,this.hands[1].splice(i,1)),this.comboRows[1].push(e),this.animatingSlots.add("combo:1:"+(this.comboRows[1].length-1)),this.currentPlayer=0;const h=this.comboRows[1].length-1,c=this.getComboPosition(1,h),r=new o({x:n.x,y:n.y,value:e.value,suit:e.suit});if(this.activeAnimations.push(r),this.pendingAnimations++,r.moveTo(c.x,c.y,500,t.EaseInOut,()=>{const t=this.activeAnimations.indexOf(r);t>=0&&this.activeAnimations.splice(t,1),this.animatingSlots.delete(`combo:1:${h}`),null!==a&&this.animatingSlots.delete(`hand:1:${a}`),this.pendingAnimations--}),r.rotateTo(360,500,t.EaseInOut),r.scaleTo(1.05,300,t.EaseInOut),s){const e=s;this.hands[1].push(e);const i=this.hands[1].length-1,n=this.getHandPosition(1,i);this.animatingSlots.add(`hand:1:${i}`);const a={x:this.ctx.canvas.width/2-12,y:this.ctx.canvas.height/2-18},h=new o({x:a.x,y:a.y,value:e.value,suit:e.suit});this.activeAnimations.push(h),this.pendingAnimations++,h.scale=.2,h.moveTo(n.x,n.y,400,t.EaseInOut,()=>{const t=this.activeAnimations.indexOf(h);t>=0&&this.activeAnimations.splice(t,1),this.animatingSlots.delete(`hand:1:${i}`),this.pendingAnimations--}),h.rotateTo(180,400,t.EaseInOut),h.scaleTo(1,400,t.EaseInOut)}else if(this.deck.length>0){const e=this.deck.pop();this.hands[1].push(e);const s=this.hands[1].length-1,i=this.getHandPosition(1,s);this.animatingSlots.add(`hand:1:${s}`);const n={x:this.ctx.canvas.width/2-12,y:this.ctx.canvas.height/2-18},a=new o({x:n.x,y:n.y,value:e.value,suit:e.suit});this.activeAnimations.push(a),this.pendingAnimations++,a.scale=.2,a.moveTo(i.x,i.y,400,t.EaseInOut,()=>{const t=this.activeAnimations.indexOf(a);t>=0&&this.activeAnimations.splice(t,1),this.animatingSlots.delete(`hand:1:${s}`),this.pendingAnimations--}),a.rotateTo(180,400,t.EaseInOut),a.scaleTo(1,400,t.EaseInOut)}this.checkRound()}playCardFromHand(e){if(this.gameOver)return;if(!this.seedConfirmed)return void this.statusText.setText("Waiting for seed confirmation");if(0!==this.currentPlayer)return void this.statusText.setText("Not your turn");if(this.pendingAnimations>0)return void this.statusText.setText("Wait for animations");this.animatingSlots.add(`hand:0:${e}`);const s=this.hands[0].splice(e,1)[0];this.comboRows[0].push(s);const i=this.comboRows[0].length-1;this.animatingSlots.add(`combo:0:${i}`);const n=this.deck.length>0?this.deck.pop():null;this.sendPlayWithDraw(s,n);const a=this.getHandPosition(0,e),h=i,c=this.getComboPosition(0,h),r=new o({x:a.x,y:a.y,value:s.value,suit:s.suit});if(this.activeAnimations.push(r),this.pendingAnimations++,r.moveTo(c.x,c.y,500,t.EaseInOut,()=>{const t=this.activeAnimations.indexOf(r);t>=0&&this.activeAnimations.splice(t,1),this.animatingSlots.delete(`combo:0:${h}`),this.animatingSlots.delete(`hand:0:${e}`),this.pendingAnimations--}),r.rotateTo(360,500,t.EaseInOut),r.scaleTo(1.08,220,t.EaseInOut),n){const e=n;this.hands[0].push(e);const s=this.hands[0].length-1,i=this.getHandPosition(0,s);this.animatingSlots.add(`hand:0:${s}`);const a={x:this.ctx.canvas.width/2-12,y:this.ctx.canvas.height/2-18},h=new o({x:a.x,y:a.y,value:e.value,suit:e.suit});this.activeAnimations.push(h),this.pendingAnimations++,h.scale=.2,h.moveTo(i.x,i.y,400,t.EaseInOut,()=>{const t=this.activeAnimations.indexOf(h);t>=0&&this.activeAnimations.splice(t,1),this.animatingSlots.delete(`hand:0:${s}`),this.pendingAnimations--}),h.rotateTo(180,400,t.EaseInOut),h.scaleTo(1,400,t.EaseInOut)}this.checkRound(),this.currentPlayer=1}checkRound(){if(5===this.comboRows[0].length&&5===this.comboRows[1].length){const t=t=>t.reduce((t,e)=>t+h.valueToNumber(e.value),0),e=t(this.comboRows[0]),s=t(this.comboRows[1]);e>s?this.statusText.setText("Round: Bottom wins "+e+" > "+s):s>e?this.statusText.setText("Round: Top wins "+s+" > "+e):this.statusText.setText("Round: Tie "+e+" = "+s),this.comboRows[0]=[],this.comboRows[1]=[];for(let t=0;t<2;t++)if(this.deck.length>0){const e=this.deck.pop();this.hands[t].push(e)}}0===this.deck.length&&0===this.hands[0].length&&0===this.hands[1].length&&(this.statusText.setText("Game Over"),this.gameOver=!0)}static valueToNumber(t){return"A"===t?1:"J"===t?11:"Q"===t?12:"K"===t?13:parseInt(t,10)}}const c=document.getElementById("canvas");c.getContext("2d").imageSmoothingEnabled=!1;const r=new h;r.attachWebSocket("wss://relay.js13kgames.com/pawker"),c.addEventListener("click",t=>{const e=c.getBoundingClientRect(),s=c.width/e.width,i=c.height/e.height,n=(t.clientX-e.left)*s,a=(t.clientY-e.top)*i,o=c.height-50;if(a>=o&&a<=o+30){const t=Math.floor((n-20)/28);t>=0&&t<r.hands[0].length&&r.playCardFromHand(t)}});let d=performance.now();!function t(e=performance.now()){requestAnimationFrame(t);const s=e-d;d=e,r.update(s),r.draw()}()</script>