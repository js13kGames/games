<!doctype html><html><head><meta name=viewport content="width=device-width,maximum-scale=1,user-scalable=no"><title>Semi-Charmed Kind of Dice - js13kGames 2025</title><style>:root{--dark: #5a3b60;--light: #fff;--surface: #2b173e;font-size:22px;@media (max-width: 500px){font-size:4.3vw}}body{background-color:var(--dark);color:var(--light);font-family:system-ui,-apple-system;font-weight:800;user-select:none;margin:0;text-align:center}h2{margin:0rem}h3{margin:1.1rem 0 .31rem}.dice-game-container{display:flex;flex-direction:column;justify-content:center;align-items:center;height:100vh;margin:0 auto;max-width:25rem;@media (max-width: 500px){justify-content:flex-end}}.dice-game{display:flex;flex-direction:column;justify-content:flex-end;align-items:center;gap:.75rem;padding:1rem;width:100%;box-sizing:border-box;@media (min-width: 500px){height:38rem}}.dice{display:flex;flex-wrap:wrap;width:100%;justify-content:center;align-items:flex-end;transition:all .5s ease;gap:0 .5rem;.menu-mode &{opacity:0;pointer-events:none}.die.clickable svg{path,rect{cursor:pointer}}@media (max-width: 600px){gap:.25rem}}button{cursor:pointer}.die-container{display:flex;flex-direction:column;align-items:center;width:5em;button{width:100%}}.die{width:5em;height:5.5em;display:flex;align-items:center;justify-content:center;transition:all .3s ease;position:relative;.die-number,.cat,.charm{transition:all .3s ease}.cat{width:1.5em;opacity:0;.cat-body{fill:currentColor}.cat-whisker{stroke:currentColor;stroke-width:.1875rem;stroke-linecap:round}}.charm{width:2rem;opacity:0;paint-order:stroke;fill:#f1da41;& path{stroke:#000;stroke-width:15px}}.die-number{font-size:1.125rem;z-index:10;position:absolute;color:#000;pointer-events:none;user-select:none}svg.die-svg rect:first-of-type,svg.die-svg path:first-of-type{transition:stroke .3s ease;stroke:transparent;paint-order:stroke;stroke-width:.5rem}&.selected svg.die-svg rect:first-of-type,&.selected svg.die-svg path:first-of-type{stroke:#fff}.dice &.clickable svg.die-svg rect:first-of-type:hover,.dice &.clickable svg.die-svg path:first-of-type:hover{stroke:#fff6}.edges{pointer-events:none}&.die-number-cat{.dice &{opacity:.4}.die-number{opacity:0}.cat{opacity:1}}&.die-number-charm{.die-number{opacity:0}&.d4{.charm-1{opacity:1}}&.d6,&.d8{.charm-2{opacity:1}}&.d20,&.d12,&.d10{.charm-3{opacity:1}}}&.rolling{opacity:.5;animation:die-roll .45s linear infinite;.die-number,.cat,.charm{opacity:0}}&.d4{.die-number{font-size:1.75em;translate:0 .25em}.charm{width:1.3em;translate:0 .25em}.cat{width:1.2em;translate:0 .3em}}&.d6{.die-number{font-size:2em;translate:0 -.05em}.cat,.charm{width:1.6em}}&.d8{.die-number{font-size:1.65em;translate:0 -.15em}.cat{width:1.2em}.charm{width:1.3em;translate:0 -.1em}}&.d10{.die-number{font-size:1.5em;translate:0 -.125em}.charm{width:1em;translate:0 -.1em}.cat{width:1.15em;translate:0 -.05em}}&.d12{.die-number{font-size:1.5em;translate:0 -.075em}.cat{width:1.2em}.charm{width:1em;translate:0 -.1em}}&.d20{.die-number{font-size:.9em;translate:0 -.2em}.cat{width:1.6em;translate:0 -.1em}.charm{width:1.75em;translate:0 -.25em}}}.die-svg{fill:none;width:5em;height:5.5em;.face{fill:currentColor}.edges{stroke:#000;stroke-width:.12rem;stroke-linecap:round;stroke-linejoin:round}.d4 &{width:5.5em}}.controls{display:flex;flex-direction:column;justify-content:space-between;gap:.5rem;width:100%;transition:all .3s ease;.menu-mode &{opacity:0;pointer-events:none}.buttons button{width:5.625rem;height:3.9375rem;padding:.5rem}.buttons{display:flex;gap:.25rem}.info{background-color:var(--surface);border:.125rem solid black;padding:.5rem;border-radius:8px;display:flex;flex-direction:row;.round-count,.charm-count,.chip-count{flex:1;display:flex;flex-direction:column;align-items:center;gap:.1rem;font-size:1rem}}}canvas{position:fixed;inset:0;pointer-events:none;width:100%;height:100%}.background-canvas{z-index:-1;image-rendering:pixelated}.particle-canvas{z-index:11}.menu{position:absolute;inset:0;display:flex;flex-direction:column;justify-content:center;align-items:center;gap:1rem;transition:all .3s ease;button:first-of-type{padding:1.25rem}.buttons{display:flex;flex-direction:column;gap:8px}}.modal-overlay{position:fixed;inset:0;background-color:#000000b3;display:flex;justify-content:center;align-items:center;z-index:1000;opacity:0;transition:opacity .3s ease;pointer-events:none}.modal-overlay.open{opacity:1;pointer-events:all}.modal{background-color:var(--surface);border:.2rem solid black;border-radius:8px;padding:.8rem 1.7rem;width:100%;max-width:20rem;font-size:14px;@media (max-width: 500px){font-size:2.4vw}}.modal-content{display:flex;justify-content:center;flex-wrap:wrap;margin-bottom:20px}.hidden{display:none!important}button{border:.125rem solid #000;background-color:#8457d8;color:#000;border-radius:8px;font:700 .8rem sans-serif;transition:all .2s ease;-webkit-tap-highlight-color:transparent;@media (pointer: fine){&:hover{background-color:#6840b2}}padding:.25rem .375rem}.charm-count{color:#f1da41}.chip-count{color:#489dff}button,.die{touch-action:manipulation}button:disabled{cursor:not-allowed;opacity:.5;background-color:#564477}.shake{animation:shake .18s infinite linear}@keyframes die-roll{25%{transform:rotateX(20deg) translateY(-7px)}75%{transform:rotateX(-20deg) translateY(7px)}}@keyframes shake{25%{transform:rotate(-2deg)}75%{transform:rotate(2deg)}}</style></head><body><script>const t={20:"#ff7f50",12:"#f1c432ff",10:"#35c356ff",8:"#40c3ebff",6:"#3855f8ff",4:"#8051d5ff"},e={cat:'<svg fill="#fff" class="cat die-number" viewBox="-3 0 189 129"><path fill-rule="evenodd" d="m139.18 128.81-88.943.009c2.36-4.565 9.472-11.158 8.453-16.317-.692-3.501-17.192-16-20.897-38.691C34.087 51.12 45.473.002 53.498.002c4 0 14.08 19.839 19.312 28.978 13.863-5.206 34.687-4.478 44.423-.478 5.265-9.498 15.228-28.5 18.764-28.5 4 0 13.505 55.286 12 73.809-1.505 18.523-18.255 34.189-18.255 38.69 0 4.5 3.755 10.5 9.437 16.309zM71.252 63.957c7.461 5.615-6.173 13.217-12.177 8.268-8.342-6.882 5.816-13.05 12.177-8.268zm58.671 9.107c-5.752 4.108-19.505-.927-12.689-7.807 6.457-6.512 21.021 1.867 12.689 7.807zm-30.747 8.329c11.172-8.49-21.422-9.566-9.608.157 5.563 4.573-1.089 6.85-3.09 8.66 3.09 4.293 7.373-1.991 8.52-4.707 0 0 5.495 9.32 8 4.707-1.18-1.387-7.057-6.365-3.822-8.817z" class="cat-body" clip-rule="evenodd"/><path d="M33.221 71.156 18.5 66.5 3.156 64.779M33.5 79.5h-16L2 81M33.5 86h-5l-6 4M155.779 71.156 171 67.5l14.844-2.721M155.5 79.5l16-.5 15.5 2M155.5 86l6 1.5 5 2.5" class="cat-whisker"/></svg>',charm:'<svg class="charm charm-1 die-number" viewBox="0 0 200 200" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M100.44 42L117.351 83.326L161.88 86.638L127.803 115.491L138.412 158.864L100.44 135.371L62.468 158.864L73.078 115.491L39 86.638L83.529 83.326L100.44 42Z"/></svg>',"charm-2":'<svg class="charm charm-2 die-number" viewBox="0 0 200 200" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M146.5 62L157.372 88.5219L186 90.6474L164.092 109.164L170.912 137L146.5 121.923L122.088 137L128.909 109.164L107 90.6474L135.628 88.5219L146.5 62Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M53.5 62L64.3721 88.5219L93 90.6474L71.0918 109.164L77.9123 137L53.5 121.923L29.0877 137L35.9089 109.164L14 90.6474L42.6279 88.5219L53.5 62Z"/></svg>',"charm-3":'<svg class="charm charm-3 die-number" viewBox="0 0 200 200" fill="none"><path fill-rule="evenodd" clip-rule="evenodd" d="M148.5 102L158.822 127.107L186 129.12L165.201 146.649L171.676 173L148.5 158.727L125.324 173L131.8 146.649L111 129.12L138.178 127.107L148.5 102Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M51.5 102L61.8217 127.107L89 129.12L68.2011 146.649L74.6763 173L51.5 158.727L28.3237 173L34.7996 146.649L14 129.12L41.1783 127.107L51.5 102Z"/><path fill-rule="evenodd" clip-rule="evenodd" d="M101.5 25L111.822 50.1074L139 52.1195L118.201 69.649L124.676 96L101.5 81.727L78.3237 96L84.7996 69.649L64 52.1195L91.1783 50.1074L101.5 25Z"/></svg>',d4:'<svg class="die-svg" viewBox="-8 0 96 69"><path fill="currentColor" d="m1.875 66.497 37.26-64.012a1 1 0 0 1 1.73 0l37.26 64.012A1 1 0 0 1 77.261 68H2.739a1 1 0 0 1-.864-1.503z" class="face"/><path stroke="#000" stroke-width="3" d="m1.875 66.497 37.26-64.012a1 1 0 0 1 1.73 0l37.26 64.012A1 1 0 0 1 77.261 68H2.739a1 1 0 0 1-.864-1.503z" class="edges"/></svg>',d6:'<svg class="die-svg" viewBox="-8 0 94 78"><rect width="76" height="76" x="1" y="1" class="face" rx="3"/><rect width="76" height="76" x="1" y="1" class="edges" rx="3"/></svg>',d8:'<svg class="die-svg" viewBox="-8 0 96 92"><path d="M3.025 22.987 40 2l36.975 20.987A4 4 0 0 1 79 26.466v41.493L42.035 89.798a4 4 0 0 1-4.07 0L1 67.959V26.466a4 4 0 0 1 2.025-3.479Z" class="face"/><path d="M40 2 3.025 22.987A4 4 0 0 0 1 26.466v41.493M40 2l36.975 20.987A4 4 0 0 1 79 26.466v41.493M40 2 1 67.96M40 2l39 65.96m0 0L42.035 89.797a4 4 0 0 1-4.07 0L1 67.959m78 0H1" class="edges"/></svg>',d10:'<svg class="die-svg" viewBox="-8 0 96 78"><path d="M40.245 76 1 49.536v-16.6a4 4 0 0 1 1.627-3.221L40.245 2l37.147 27.714A4 4 0 0 1 79 32.92v16.616L40.245 76Z" class="face"/><path d="M40.245 76 1 49.536M40.245 76 79 49.536M40.245 76V61.788M1 49.536v-16.6a4 4 0 0 1 1.627-3.221L40.245 2M1 49.536h13.736M40.246 2l37.146 27.714A4 4 0 0 1 79 32.92v16.616M40.245 2l-25.51 47.536M40.246 2l25.02 47.536m13.735 0H65.264m-50.528 0 25.51 12.252m25.018-12.252L40.245 61.788" class="edges"/></svg>',d12:'<svg class="die-svg" viewBox="-8 0 96 86"><path d="M1 55.399V30.82l14.746-19.76a4 4 0 0 1 1.907-1.391L40 2l22.864 7.66a4 4 0 0 1 1.978 1.458L79 30.82v24.62a4 4 0 0 1-.783 2.378L64.838 75.917a4 4 0 0 1-1.946 1.415L41.286 84.57a4 4 0 0 1-2.57-.01l-22.231-7.629L1.827 57.837A4 4 0 0 1 1 55.4z" class="face"/><path d="M1 30.819v24.579a4 4 0 0 0 .827 2.436L16.485 76.93M1 30.819l14.746-19.76a4 4 0 0 1 1.907-1.391L40 1.999M1 30.82l13.191 4.034M40 1.999l22.863 7.66a4 4 0 0 1 1.978 1.458L79 30.819M40 1.999v13.258m39 15.562v24.62a4 4 0 0 1-.783 2.377l-13.378 18.1a4 4 0 0 1-1.946 1.415l-21.606 7.238a4 4 0 0 1-2.57-.01l-22.231-7.63M79 30.82l-13.765 4.035M16.485 76.93l7.456-12.104h31.544m-31.544 0-9.75-29.972m41.294 29.972 8.602 12.68m-8.602-12.68 9.75-29.972L40 15.257 14.19 34.854" class="edges"/></svg>',d20:'<svg class="die-svg" viewBox="-8 0 96 94"><path d="M1 69.877V23.62L40 2l39 21.62v46.257L40 92 1 69.877Z" class="face"/><path d="M1 69.877V23.62m0 46.257L40 92M1 69.877l12.156-7.039M1 23.62 40 2M1 23.62l39-9.553M1 23.62l12.156 39.218M40 2l39 21.62M40 2v12.067m39 9.553v46.257m0-46.257-39-9.553m39 9.553L67.35 62.838M79 69.878 40 92m39-22.123-11.65-7.039M40 92l27.35-29.162M40 92 13.156 62.838M40 14.067 13.156 62.838M40 14.067l27.35 48.771m0 0H13.157" class="edges"/></svg>'},i=(t,...e)=>{const i="object"!=typeof e[0]||e[0]instanceof HTMLElement?null:e.shift(),a=document.createElement(t);return i&&s(a,i),a.append(...e.map(t=>t)),a},s=(t,e)=>Object.entries(e).forEach(([e,i])=>{if("object"==typeof i&&e in t)return s(t[e],i);Object.assign(t,{[e]:i})}),a=new class{particles=[];orbitalParticles=[];canvas=null;ctx=null;animationId=null;initialized=!1;globalOrbitalAngle=0;baseAngularVelocity=.02;orbitalParticleCount=0;pointCount=0;fadeAlpha=0;centerX=innerWidth/2;centerY=innerHeight/2;centerYOffset=0;scale=1;constructor(){"loading"===document.readyState?document.addEventListener("DOMContentLoaded",()=>this.init()):this.init()}init(){this.initialized||(this.canvas=i("canvas",{className:"particle-canvas"}),document.body.appendChild(this.canvas),this.ctx=this.canvas.getContext("2d"),this.initialized=!0,this.animate(),this.resize(),addEventListener("resize",()=>this.resize()))}resize(){this.canvas&&(this.canvas.width=innerWidth,this.canvas.height=innerHeight,this.centerX=this.canvas.width/2,this.centerY=this.canvas.height/2,this.scale=Math.min(500,this.canvas.width)/500)}createConfetti(t,e,i,s=20,a){for(let n=0;n<s;n++){const r=2*Math.PI*n/s+.5*Math.random(),l=(.5+3*Math.random())*this.scale,o=(40+90*Math.random())*this.scale;this.particles.push({x:t,y:e,rotation:0,color:i,isStar:a,life:o,maxLife:o,vx:Math.cos(r)*l,vy:Math.sin(r)*l,size:5+5*Math.random(),rotationSpeed:.2*Math.random()})}this.animationId||this.animate()}createOrbitalParticle(){this.orbitalParticles.forEach((t,e)=>{t.orbitalIndex=e,t.currentSpeedMultiplier=1}),this.orbitalParticles.push({x:this.centerX,y:this.centerY+this.centerYOffset,rotation:0,orbitalIndex:this.orbitalParticles.length,currentSpeedMultiplier:1}),this.orbitalParticleCount=this.orbitalParticles.length,this.animationId||this.animate()}fireOffOrbitalParticles(){this.convertOrbitalParticlesToRegular(.1*this.scale,1)}removeOrbitalParticle(){const t=this.orbitalParticles.shift();this.particles.push({x:t.x,y:t.y,vx:0,vy:0,life:30,maxLife:30,size:18,color:"#FFD700",isStar:!0,rotation:t.rotation,rotationSpeed:.1}),setTimeout(()=>this.createConfetti(t.x,t.y,"#FFD700",10,!0),200)}convertOrbitalParticlesToRegular(t,e){this.orbitalParticles.forEach(i=>{const s=this.globalOrbitalAngle+2*Math.PI*i.orbitalIndex/this.orbitalParticleCount,a=-Math.sin(s)*this.baseAngularVelocity*t,n=Math.cos(s)*this.baseAngularVelocity*t,r=100*(a+Math.cos(s)*t*.5*e),l=100*(n+Math.sin(s)*t*.5*e),o=60*this.scale;this.particles.push({x:i.x,y:i.y,vx:r,vy:l,life:o,maxLife:o,size:18,color:"#FFD700",isStar:!0,rotation:i.rotation,rotationSpeed:.1})}),this.orbitalParticles=[],this.animationId||this.animate()}animate(){if(this.canvas&&this.ctx){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),0===this.pointCount?this.fadeAlpha=Math.max(0,this.fadeAlpha-.02):this.pointCount>0&&(this.fadeAlpha=Math.min(1,this.fadeAlpha+.1)),this.renderNumber(),this.globalOrbitalAngle+=this.baseAngularVelocity,this.globalOrbitalAngle=this.globalOrbitalAngle%(2*Math.PI);for(let t=0;t<this.orbitalParticles.length;t++){const e=this.orbitalParticles[t],i=this.globalOrbitalAngle+2*Math.PI*e.orbitalIndex/this.orbitalParticleCount,s=(100+50*(1-Math.exp(-.05*this.orbitalParticleCount)))*this.scale,a=this.centerX+Math.cos(i)*s,n=this.centerY+this.centerYOffset+Math.sin(i)*s;let r=i-Math.atan2(e.y-(this.centerY+this.centerYOffset),e.x-this.centerX);r=(r+Math.PI)%(2*Math.PI)-Math.PI;const l=Math.PI/4,o=Math.abs(r)/l;Math.abs(r)>.05?(e.currentSpeedMultiplier=1+(r>0?2*o:.5*-o),e.currentSpeedMultiplier=Math.max(.2,Math.min(3,e.currentSpeedMultiplier))):e.currentSpeedMultiplier=1;const c=.15;e.x=e.x+(a-e.x)*c,e.y=e.y+(n-e.y)*c,e.rotation=i+.2}for(let t=this.particles.length-1;t>=0;t--){const e=this.particles[t];e.x+=e.vx,e.y+=e.vy,e.vx*=.98,e.vy*=.98,e.life--,void 0!==e.rotationSpeed&&void 0!==e.rotation&&(e.rotation+=e.rotationSpeed),e.life<=0&&this.particles.splice(t,1)}this.orbitalParticles.forEach(t=>{this.renderOrbitalParticle(t)}),this.particles.forEach(t=>{this.renderParticle(t)}),this.animationId=requestAnimationFrame(()=>this.animate())}}renderNumber(){if(!this.ctx)return;this.ctx.save();const t=.001*Date.now(),e=(1+Math.min(this.pointCount,200)/400+.05*Math.sin(4*t))*this.scale;this.ctx.translate(this.centerX,this.centerY+this.centerYOffset),this.ctx.scale(e,e),this.ctx.rotate(.1*Math.sin(1.5*t)),this.ctx.font="bold 42px system-ui",this.ctx.fillStyle=`rgba(72, 157, 255, ${this.fadeAlpha})`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillText(`${this.pointCount}`,0,0),this.ctx.restore()}renderOrbitalParticle(t){if(!this.ctx)return;this.ctx.save();const e=document.querySelector(".charm-1 path");this.ctx.fillStyle="#FFD700",this.ctx.beginPath();const i=.45*this.scale;this.ctx.translate(t.x,t.y),this.ctx.scale(i,i),this.ctx.rotate(t.rotation),this.ctx.translate(-100,-100);let s=new Path2D(e.getAttribute("d"));this.ctx.lineWidth=10,this.ctx.stroke(s),this.ctx.fill(s),this.ctx.restore()}renderParticle(t){if(!this.ctx)return;const e=t.life/t.maxLife,i=t.size*e;this.ctx.save();const s=document.querySelector(".charm-1 path");this.ctx.fillStyle=t.color,this.ctx.beginPath();const a=i/40*this.scale,n="black"!==t.color;let r=n?0:15;if(this.ctx.translate(t.x-r,t.y-r),this.ctx.scale(a,a),void 0!==t.rotation&&this.ctx.rotate(t.rotation),this.ctx.lineWidth=10,t.isStar){n&&this.ctx.translate(-100,-100);let t=new Path2D(s.getAttribute("d"));this.ctx.stroke(t),this.ctx.fill(t)}else this.ctx.arc(0,0,10*i,0,360),this.ctx.stroke(),this.ctx.fill();this.ctx.restore()}},n=[1,,95,.01,.01,,,4.4,,4,193,.05,,,,,.28,.82,.02,.09],r=[.7,,296,.01,.21,.14,3,1.6,,-8,3,.01,,,4.2,,.02,.62],l=[1.6,,459,.08,,.12,1,4.7,-1,,-195,.01,.02,.1,.3,,.21,.67,.03,.05,161],o=[.25,.2,400,.05,.02,.2,,.3,,,132,.1,,.1,,,,.6,.02],c=[1.6,,190,.33,.13,.26,,2.5,,-91,,,.12,,77,,,.58,.01,,134],d=[,,488,.16,.09,.15,1,.7,,52,,,.06,,,,,.96,.05,.45],h=[.2,,858,.01,.1,,1,2.7,-9,-43,,,,,,,,.68,.07],m=[.8,,691,.01,.17,.4,2,.6,,91,473,.31,,,,,.08,,.04,,-1473],u=[.18,,900,,.01,.01,4,,,,,,,,,,,.2],p=[[[.25,0,25,.001,.05,,3,,,,,,,,,,.02],[.9,0,120,,,.03,1,1.25,,,,,.02,6.8,-.3,,.5,.5],[.6,0,40,,,,,.7,,,,.5,,6.7,1,.05],[1.5,0,40,,,,,1.1,,-.1,-10,-.05,-.01,1],[.35,0,25,,.06,.14,3,,,,,,,,,,,.57]],[[[2,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,],[,,16,,16,,19,,21,,,,21,,19,,21,,16,,16,,19,,21,,,,21,,19,,14,,16,,16,,19,,21,,,,21,,19,,21,,16,,16,,19,,21,,,,21,,19,,19,,],[1,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,],[3,,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30]],[[2,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,],[,,16,,16,,19,,21,,,,21,,19,,21,,16,,16,,19,,21,,,,21,,19,,14,,16,,16,,19,,21,,,,21,,19,,21,,16,,16,,19,,21,,,,21,,19,,19,,],[4,,31,,,28,,,26,,,,28,,,,,,31,,,28,,,31,,,,28,,,,,,28,,,28,,,26,,,,28,,31,,33,,33,,28,,,,26,,,,28,,,,,,],[1,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,],[3,,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30]],[[2,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,],[,,16,,16,,19,,21,,,,21,,19,,21,,16,,16,,19,,21,,,,21,,19,,14,,16,,16,,19,,21,,,,21,,19,,21,,16,,16,,19,,21,,,,21,,19,,14,,],[4,,28,,26,28,,26,31,33,35,33,31,28,26,,28,,28,,26,28,,26,31,33,28,,,,,,,,28,,26,28,,26,28,31,33,35,33,31,26,,28,,28,,,28,,,26,,26,,28,,28,,,,],[1,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,],[3,,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30]],[[2,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,29,,,,,,,,,29,29,,29,,,,],[,,16,,16,,19,,21,,,,21,,19,,21,,16,,16,,19,,21,,,,21,,19,,14,,16,,16,,19,,21,,,,21,,19,,21,,16,,16,,19,,21,,,,21,,19,,14,,],[4,,14,16,,16,,16,,14,16,,19,,21,,23,,14,16,,16,,19,,21,16,,,,,,,,14,16,,16,,16,,14,16,,19,,21,,23,,19,19,,19,,16,,14,16,,,,,,,,],[1,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,,,32,,,,32,,32,,,,,,,,],[3,,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30,,,,,30,,,,,,,,,,29,30]]],[0,1,1,2,2,3,3]];let g=.3,f=null;const v=44100,M=new AudioContext,L=()=>{z.muteState=(z.muteState+1)%3,g=0===z.muteState?0:.3,2===z.muteState&&b(...n),f&&(f.gain.value=1===z.muteState?1:0)},x=()=>{const t=y(...P(...p));f=M.createGain(),f.connect(M.destination),t.disconnect(),t.connect(f),t.loop=!0,f.gain.value=1===z.muteState?1:0};function b(...t){return 0===z.muteState?{}:y(S(...t))}function y(...t){const e=M.createBuffer(t.length,t[0].length,v),i=M.createBufferSource();return t.map((t,i)=>e.getChannelData(i).set(t)),i.buffer=e,i.connect(M.destination),i.start(),i}function S(t=1,e=.05,i=220,s=0,a=0,n=.1,r=0,l=1,o=0,c=0,d=0,h=0,m=0,u=0,p=0,f=0,M=0,L=1,x=0,b=0,y=0){const S=2*Math.PI,P=t=>t<0?-1:1,A=o=o*(500*S)/v/v,w=i=i*((1+2*e*Math.random()-e)*S)/v,C=[];let N,D,O=0,k=0,T=0,I=1,H=0,U=0,E=0;const z=S*Math.abs(y)*2/v,B=Math.cos(z),q=Math.sin(z)/2/2,Y=1+q,F=-2*B/Y,$=(1-q)/Y,V=(1+P(y)*B)/2/Y,Z=-(P(y)+B)/Y,j=V;let R=0,W=0,X=0,_=0;for(c*=500*S/v**3,p*=S/v,d*=S/v,h*=v,m=m*v|0,t*=g,D=(s=s*v+9)+(x*=v)+(a*=v)+(n*=v)+(M*=v)|0;T<D;)++U%(100*f|0)||(E=r?r>1?r>2?r>3?Math.sin(O**3):Math.max(Math.min(Math.tan(O),1),-1):1-(2*O/S%2+2)%2:1-4*Math.abs(Math.round(O/S)-O/S):Math.sin(O),E=(m?1-b+b*Math.sin(S*T/m):1)*P(E)*Math.abs(E)**l*(T<s?T/s:T<s+x?1-(T-s)/x*(1-L):T<s+x+a?L:T<D-M?(D-T-M)/n*L:0),M&&(M>T?E/=2:E=E/2+(T<D-M?1:(D-T)/M)*C[T-M|0]/2/t),y&&(R=W,W=E,X=_,_=j*R+Z*R+V*W-$*X-F*_,E=_)),N=(i+=o+=c)*Math.cos(p*k++),O+=N+N*u*Math.sin(T**5),I&&++I>h&&(i+=d,I=0),!m||++H%m||(i=w,o=A,I=I||1),C[T++]=E*t;return Float32Array.from(C)}const P=(t,e,i,s=125)=>{let a,n,r,l,o,c,d,h,m,u,p,g,f,M,L=0,x=[],b=[],y=[],P=0,A=0,w=1,C={},N=v/s*60>>2;for(;w;P++)x=[w=h=g=0],i.map((s,v)=>{for(d=e[s][P]||[0,0,0],w|=!!e[s][P],M=g+(e[s][0].length-2-!h)*N,f=v==i.length-1,n=2,l=g;n<d.length+f;h=++n){for(o=d[n],m=n==d.length+f-1&&f||u!=(d[0]||0)|o|0,r=0;r<N&&h;r++>N-99&&m?p+=(p<1)/99:0)c=(1-p)*x[L++]/2||0,b[l]=(b[l]||0)-c*A+c,y[l]=(y[l++]||0)+c*A+c;o&&(p=o%1,A=d[1]||0,(o|=0)&&(x=C[[u=d[L=0]||0,o]]=C[[u,o]]||(a=[...t[u]],a[2]*=2**((o-12)/12),o>0?S(...a):[])))}g=M});return[b,y]},A={4:4,6:6,8:7,10:9,12:12,20:21},w={4:1,6:1,8:2,10:2,12:3,20:5},C=t=>!!t.roll&&t.roll>=A[t.sides],N=t=>!!t.roll&&t.roll<=w[t.sides],D=(t,e)=>({sides:t,roll:t,index:e}),O=t=>z.dice=z.dice.map(t),k=async(e,i)=>{if(N(e))return;const s=document.querySelector(".dice-game");return new Promise(n=>setTimeout(()=>{s.classList.remove("shake");const i=E(e.sides,e.index);z.dice=z.dice.map((t,s)=>s===e.index?{...t,roll:i}:t);const c={sides:z.dice[e.index].sides,roll:i},d=C(c),h=N(c),m=d?c.sides>=10?3:c.sides>=6?2:1:0,u=h||d?0:i??0;z.pendingPoints+=u;const p=document.querySelectorAll(".die")[e.index].getBoundingClientRect(),g=p.left+p.width/2+(h?20:0),f=p.top+p.height/2+(h?20:0),v=h?"black":d?"#f1da41":t[c.sides],M=d||h?10:6;if(a.createConfetti(g,f,v,M,d),d)for(let t=0;t<m;t++)setTimeout(()=>{b(...o),z.pendingCharms++,a.createOrbitalParticle()},150*t);else h?(z.dice.every(t=>N(t))?(a.fireOffOrbitalParticles(),a.createConfetti(a.centerX,a.centerY+a.centerYOffset,"black",30),b(...r)):b(...l),setTimeout(()=>s.classList.add("shake"),10),setTimeout(()=>s.classList.remove("shake"),200)):b(...(L=z.pendingPoints,[.45,,600-Math.min(500,L),,,.02,,3.5,-33,,,,,.2,17,,,.64,.08]));var L;n(void 0)},i))},T=t=>20===t?7:t/2,I=()=>2*(z.dice.length-2),H=()=>{const t=I();z.charms<t||(b(...d),z.dice=[...z.dice,D(4,z.dice.length)],z.charms-=t)},U=new Map,E=(t,e)=>{if(t<1)return 0;const i=t+"-"+e;let s=U.get(i);if(!s||0===s.length){s=[];for(let e=1;e<=t;e++)s.push(e,e,e);s=(t=>{const e=t.slice();for(let t=e.length-1;t>0;t--){const i=Math.floor(Math.random()*(t+1));[e[t],e[i]]=[e[i],e[t]]}return e})(s),U.set(i,s)}return s.pop()};let z=(t=>{const e=Object.fromEntries(Object.keys(t).map(t=>[t,[]]));return new Proxy({...t,_updates:e,_update:t=>e[t].forEach(t=>t()),addUpdate:(t,i)=>e[t].push(i)},{set:(t,e,i)=>"string"==typeof e&&(t[e]=i,t._update(e),!0)})})({dice:[],charms:0,points:0,highScore:JSON.parse(localStorage.getItem("jynx-dice-highscore")||"0"),pendingCharms:0,pendingPoints:0,muteState:1,selectedDie:-1,round:1,status:"menu",isAnimating:!1});const B=async()=>{if(!z.isAnimating){if(z.isAnimating=!0,b(...h),await q(z.pendingPoints,z.pendingCharms),z.isAnimating=!1,13===z.round)return z.status="menu",b(...m),void(z.points>z.highScore&&(z.highScore=z.points,localStorage.setItem("jynx-dice-highscore",z.points.toString())));z.round++,z.dice=z.dice.map(t=>({...t,roll:t.sides})),z.status="shop"}},q=(t=0,e=0)=>new Promise(i=>{if(0===t&&0===e)return i(!0);const s=Math.min(1e3+10*t,3e3),n=Math.min(150*e,1500),r=Date.now();let l=0;const c=()=>{const d=Date.now()-r,h=Math.min((d-1.2*n)/s,1),m=Math.min(d/n,1),p=1-Math.pow(1-h,1.8),g=Math.floor(t*p)-(t-z.pendingPoints),f=Math.floor(e*m)-(e-z.pendingCharms);if(g>0&&(z.points+=g,z.pendingPoints-=g,(z.pendingPoints<=1||t<50||l++>=5)&&(b(...u),l=0)),f>0){z.charms+=f,z.pendingCharms-=f;for(let t=0;t<f;t++)a.removeOrbitalParticle();b(...o)}m>=1&&h>=1?i(!0):requestAnimationFrame(c)};requestAnimationFrame(c)}),Y=async()=>{if("rolling"===z.status)return;b(...n),z.status="rolling",O(t=>({...t,roll:N(t)?t.roll:null}));let t=0;const e=1750/z.dice.length;await Promise.all(z.dice.filter(t=>!N(t)).map(async i=>{const s=++t*e;await k(i,s)})),z.dice.every(t=>N(t))&&(z.pendingCharms=0,z.pendingPoints=0),z.status="ready"},F=()=>{z.charms=3,z.points=0,z.pendingCharms=0,z.pendingPoints=0,z.round=1,z.status="shop",z.dice=[D(4,0),D(4,1),D(4,2)],z.selectedDie=-1,z.isAnimating=!1,b(...h)},$=t=>{const e=i("div",{className:"die-container"}),s=i("button",{className:"die-upgrade",onclick:()=>(t=>{const e=z.dice[t].sides;if(e>=20)return!1;const i=T(e);z.charms<i||(z.charms-=i,(t=>{b(...c),O((e,i)=>{const s=e.sides>=12?20:e.sides+2;return i===t?{...e,sides:s,roll:s}:e})})(t))})(t)},"Upgrade"),a=V();e.append(a.container,s);const n=()=>{const e=z.dice[t];if(!e)return;const i="shop"!==z.status,n=T(e.sides),r=20===e.sides?"Upgrade -<br/>Max Level":"Upgrade -<br/>"+n+" Charms";a.update(()=>{return z.status.match(/ready|shop/)&&(e=t,void(z.selectedDie=e));var e},e.sides,e.roll,"rolling"===z.status&&null==e.roll,z.selectedDie===t),s.toggleAttribute("disabled",z.charms<n||e.sides>=20),s.classList.toggle("hidden",i),s.innerHTML=r};return z.addUpdate("dice",n),z.addUpdate("charms",n),z.addUpdate("status",n),z.addUpdate("selectedDie",n),n(),e},V=()=>{const e=i("div",{className:"die-number"}),s=document.querySelector("#cat svg").cloneNode(!0),a=document.querySelector("#charm svg").cloneNode(!0),n=document.querySelector("#charm-2 svg").cloneNode(!0),r=document.querySelector("#charm-3 svg").cloneNode(!0),l=i("svg"),o=i("div",{className:"die"});o.append(e,s,a,n,r,l);let c=-1;return{container:o,update:(i,s=4,a=1,n=!1,r=!1)=>{if(o.style.color=t[s],o.classList.remove("d4","d6","d8","d10","d12","d20"),o.classList.add("d"+s),o.classList.toggle("clickable",!!z.status.match(/ready|shop/)),o.classList.toggle("rolling",n),o.classList.toggle("selected",r),o.classList.toggle("die-number-cat",N({roll:a,sides:s})),o.classList.toggle("die-number-charm",C({roll:a,sides:s})),o.style.animationDuration=1750/z.dice.length+"ms",e.textContent=a?a+"":"",c!==s){const t=document.querySelector("#d"+s+" svg").cloneNode(!0);c=s,l.innerHTML="",l.append(t),t.querySelector(".face")&&(t.querySelector(".face").onclick=i)}}}};class Z{grad3;p;perm;simplex;constructor(t=Math){this.grad3=[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1]],this.p=[];for(let e=0;e<256;e++)this.p[e]=Math.floor(256*t.random());this.perm=[];for(let t=0;t<512;t++)this.perm[t]=this.p[255&t];this.simplex=[[0,1,2,3],[0,1,3,2],[0,0,0,0],[0,2,3,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,3,0],[0,2,1,3],[0,0,0,0],[0,3,1,2],[0,3,2,1],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,3,2,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[1,2,0,3],[0,0,0,0],[1,3,0,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,3,0,1],[2,3,1,0],[1,0,2,3],[1,0,3,2],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,3,1],[0,0,0,0],[2,1,3,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0],[2,0,1,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,0,1,2],[3,0,2,1],[0,0,0,0],[3,1,2,0],[2,1,0,3],[0,0,0,0],[0,0,0,0],[0,0,0,0],[3,1,0,2],[0,0,0,0],[3,2,0,1],[3,2,1,0]]}dot(t,e,i,s=0){return t[0]*e+t[1]*i+t[2]*s}noise3d(t,e,i){let s,a,n,r;const l=(t+e+i)*(1/3),o=Math.floor(t+l),c=Math.floor(e+l),d=Math.floor(i+l),h=1/6,m=(o+c+d)*h,u=t-(o-m),p=e-(c-m),g=i-(d-m);let f,v,M,L,x,b;u>=p?p>=g?(f=1,v=0,M=0,L=1,x=1,b=0):u>=g?(f=1,v=0,M=0,L=1,x=0,b=1):(f=0,v=0,M=1,L=1,x=0,b=1):p<g?(f=0,v=0,M=1,L=0,x=1,b=1):u<g?(f=0,v=1,M=0,L=0,x=1,b=1):(f=0,v=1,M=0,L=1,x=1,b=0);const y=u-f+h,S=p-v+h,P=g-M+h,A=u-L+2*h,w=p-x+2*h,C=g-b+2*h,N=u-1+.5,D=p-1+.5,O=g-1+.5,k=255&o,T=255&c,I=255&d,H=this.perm[k+this.perm[T+this.perm[I]]]%12,U=this.perm[k+f+this.perm[T+v+this.perm[I+M]]]%12,E=this.perm[k+L+this.perm[T+x+this.perm[I+b]]]%12,z=this.perm[k+1+this.perm[T+1+this.perm[I+1]]]%12;let B=.6-u*u-p*p-g*g;B<0?s=0:(B*=B,s=B*B*this.dot(this.grad3[H],u,p,g));let q=.6-y*y-S*S-P*P;q<0?a=0:(q*=q,a=q*q*this.dot(this.grad3[U],y,S,P));let Y=.6-A*A-w*w-C*C;Y<0?n=0:(Y*=Y,n=Y*Y*this.dot(this.grad3[E],A,w,C));let F=.6-N*N-D*D-O*O;return F<0?r=0:(F*=F,r=F*F*this.dot(this.grad3[z],N,D,O)),32*(s+a+n+r)}}function j(t){const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return e?{r:parseInt(e[1],16),g:parseInt(e[2],16),b:parseInt(e[3],16)}:{r:0,g:0,b:0}}const R=i("div",{className:"svgs hidden"},"");["d20","d12","d10","d8","d6","d4","cat","charm","charm-2","charm-3"].forEach(t=>{const s=e[t];s&&R.append(i("div",{id:`${t}`,innerHTML:s}))}),document.body.append(R),document.body.append((()=>{const t=i("div",{className:"dice-game"},(()=>{const t=i("div",{className:"dice"});return z.addUpdate("dice",()=>{t.querySelectorAll(".die").length!==z.dice.length&&(t.innerHTML="",z.dice.forEach((e,i)=>t.append($(i))))}),t})(),(()=>{const t=i("button",""),e=i("button",""),s=i("div",{className:"round-count"}),n=i("div",{className:"charm-count"}),r=i("div",{className:"chip-count"}),l=i("div",{className:"buttons"},e,t),o=i("div",{className:"info"},s,n,r),c=i("div",{className:"controls"},o,l),d=()=>{const l=z.isAnimating||!!z.status.match(/rolling|menu/),o=z.dice.every(N);t.toggleAttribute("disabled",l),t.textContent=o?"End Day":"shop"===z.status?"Start Day":"Roll",t.style.flex="1",e.toggleAttribute("disabled",z.isAnimating||("shop"===z.status?z.charms<I()||z.dice.length>=8:"ready"!==z.status)),e.style.display=o||"shop"===z.status&&z.dice.length>=8?"none":"block",e.innerHTML="shop"===z.status?z.dice.length>=8?"":`Buy Die -<br/>${I()} Charms`:"End Day",t.onclick=o?B:Y,e.onclick="shop"===z.status?H:B,a.pointCount=z.pendingPoints;const c=document.querySelector(".dice-game"),d=c?.getBoundingClientRect().height??0,h=innerHeight/2-d-150;a.centerYOffset=innerWidth<500?h:z.dice.length>4?-210:-105,s.innerHTML="",n.innerHTML="",r.innerHTML="",s.append(i("div",{},`${z.round}`),i("div",{},"DAY")),n.append(i("div",{},`${z.charms}${"shop"===z.status?"":` + ${z.pendingCharms}`}`),i("div",{},"CHARMS")),r.append(i("div",{},`${z.points}${"shop"===z.status?"":` + ${z.pendingPoints}`}`),i("div",{},"POINTS"))};return document.addEventListener("keydown",i=>{if("Space"===i.code){if(i.preventDefault(),"menu"===z.status)return F();t.hasAttribute("disabled")||t.click()}"Enter"!==i.code||e.hasAttribute("disabled")||(i.preventDefault(),e.click()),"KeyM"===i.code&&L()}),z.addUpdate("status",d),z.addUpdate("points",d),z.addUpdate("charms",d),z.addUpdate("pendingCharms",d),z.addUpdate("pendingPoints",d),z.addUpdate("isAnimating",d),z.addUpdate("dice",d),d(),c})(),(()=>{const t=i("div",{className:"modal-overlay"}),e=i("div",{className:"modal"}),s=i("div",{className:"modal-content"}),a=i("div",{className:"modal-content"}),n=i("h3"),r=i("h3"),l=()=>z.selectedDie=-1,o=i("button",{onclick:l},"Close"),c=i("div",{className:"modal-buttons"},o);return t.onclick=e=>e.target===t&&l(),e.append(n,s,r,a,c),t.appendChild(e),z.addUpdate("selectedDie",()=>{const e=-1!==z.selectedDie;if(t.classList.toggle("open",e),!e)return;const i=z.dice[z.selectedDie]?.sides;s.innerHTML="";for(let t=1;t<=i;t++){const{container:e,update:a}=V();a(null,i,t,!1,!1),s.append(e)}if(n.innerText="Current Level (d"+i+")",a.innerHTML="",i<=12){const t=12===i?20:i+2;for(let e=1;e<=t;e++){const{container:i,update:s}=V();s(null,t,e,!1,!1),a.append(i)}r.innerText="Next Level (d"+t+")"}else r.innerText="Max Level Reached"}),t})(),(()=>{const t=i("button","Start Game"),e=i("button"),s=i("h2");s.innerHTML="Semi-Charmed<br/>Kind of Dice";const a=i("div","By Daniel Whiffing"),n=i("div"),r=i("div"),l=i("div",{className:"buttons"},t,e),o=i("div",{className:"menu"},s,a,n,r,l),c=()=>{const t="menu"!==z.status;o.style.opacity=t?"0":"1",o.style.pointerEvents=t?"none":"auto",a.style.marginBottom="10px",r.textContent="High Score: "+z.highScore,n.textContent="Last Score: "+z.points,r.style.display=z.highScore?"block":"none",n.style.display=z.points?"block":"none",e.textContent=0===z.muteState?"Muted":2===z.muteState?"Music off":"Sound/Music on"};return t.onclick=()=>F(),e.onclick=()=>L(),z.addUpdate("points",c),z.addUpdate("highScore",c),z.addUpdate("muteState",c),z.addUpdate("status",c),c(),o})()),e=i("div",{className:"dice-game-container"},(()=>{const t=i("canvas",{className:"background-canvas"}),e=t.getContext("2d"),s=new Z,a=()=>{t.width=Math.floor(.15*window.innerWidth),t.height=Math.floor(.15*window.innerHeight)};let n;a(),window.addEventListener("resize",()=>{clearTimeout(n),n=setTimeout(a,100)});const r=["#42176A","#441771","#471976","#4a1a7a","#4c1b7e","#511C85"];let l=0;const o=()=>{l+=25e-5;const i=e.createImageData(t.width,t.height),a=i.data;for(let e=0;e<t.height;e++)for(let i=0;i<t.width;i++){const n=.01*i,o=.01*e,c=s.noise3d(n,o,l),d=Math.floor((c+1)/2*7),h=j(r[Math.min(5,Math.max(0,d))]),m=4*(e*t.width+i);a[m]=h.r,a[m+1]=h.g,a[m+2]=h.b,a[m+3]=255}e.putImageData(i,0,0),requestAnimationFrame(o)};return o(),t})(),t),s=()=>{t.classList.toggle("shop-mode",z.status.includes("shop")),t.classList.toggle("menu-mode",z.status.includes("menu"))};return z.addUpdate("status",s),s(),e})());const W=()=>{setTimeout(x,10),document.removeEventListener("pointerdown",W)};document.addEventListener("pointerdown",W)</script></body></html>