<!doctype html><title>Shoot Those Spaceships - js13kGames 2012</title><style>body{background-color:#fff;margin:0;overflow:hidden}.information{width:800px}</style><body style=background:#ccc onkeydown=keyIsDown(event) onkeyup=keyIsUp(event)><div id=canvasContainer style=width:100%;margin-left:auto;text-align:center;font-family:Orbitron,cursive;font-size:32px;color:#000><div class=information style="margin:25px auto">Shoot Those Spaceships!</div><div style="margin:10px auto 0 auto"><canvas id=canvas></canvas></div><div class=information style="margin:20px auto;font-size:20px">How to play:</div><div class=information style="margin:10px auto">← left → right ↑ up ↓ down</div><div class=information style="margin:10px auto">CTRL: fire</div><div class=information style="margin:10px auto">Space: bomb</div></div><script>var x,y,width,height,widthEnnemy,heightEnnemy,widthMissile,heightMissile,left,right,move,bombKey,fire,canvas=document.getElementById("canvas"),ctx=document.getElementById("canvas").getContext("2d"),inertiaX=0,inertiaY=0,life=100,muf=0,firePower=100,gotBonus=0,bonusType="",laser=0,bomb=0,bombLife=300,bombDuration=bombLife,bombAfterEffect=0,bombOnFire=0,missileNumber=3,level=2,ennemies=new Array,missiles=new Array,explosions=new Array,bonusList=new Array,starField=new Array,img=new Image,imgEnnemy=new Image,imgMissile=new Image,f=1,k=2,rSpiral=0,decalSpiral=0,distArc=0,sepia=0,score=0,userHighScore=0,gameOverFrame=0,nbEnnemKilled=0,nbEnnemyWave=1,ennemyCountDown=640;!function(){for(var e=0,i=["ms","moz","webkit","o"],t=0;t<i.length&&!window.requestAnimationFrame;++t)window.requestAnimationFrame=window[i[t]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[i[t]+"CancelAnimationFrame"]||window[i[t]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(i,t){var o=(new Date).getTime(),a=Math.max(0,16-(o-e)),n=window.setTimeout((function(){i(o+a)}),a);return e=o+a,n}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(e){clearTimeout(e)})}();var keyboard={top:0,right:0,bottom:0,left:0,fire:0,spiral:0,explode:0,muf:0,bomb:0},me={direction:Math.PI/2+Math.PI,energy:100,fire:0,speed:1};function Star(e,i){this.x=e,this.y=i,this.speed=~~(255*Math.random()),this.move=function(){this.x-=this.speed/80,this.x<0&&(this.speed=~~(255*Math.random()),this.x=canvas.width,this.y=Math.random()*canvas.height)}}function Ennemy(){for(this.direction=0,this.x=canvas.width+100,this.y=30+~~((canvas.height-60)*Math.random()),this.energy=120,this.score=100,this.speed=3*Math.random(),this.nbOscill=30+60*Math.random(),this.oscill=2+3*Math.random();this.y<100||this.y>canvas.height-100;)this.y=30+(canvas.height-60)*Math.random()||0;this.move=function(){this.x-=1.5+this.speed,this.y+=Math.cos(f/this.nbOscill*Math.PI)*this.oscill}}function Bonus(e,i){this.x=e,this.y=i,this.alpha=1;var t=11*Math.random();this.type=t<6?"L":t<7?"A":t<8?"+3":t<9?"+S":t<10?"B":"",this.move=function(){this.x-=1,this.alpha-=.005}}function Missile(e){this.direction=null==e?me.direction:e,this.alpha=1,this.x=me.x,this.y=me.y,this.speed=20+me.speed,this.energy=100,this.move=function(){this.alpha-=.025,this.x-=Math.cos(this.direction+Math.PI/2+Math.PI)*this.speed,this.y+=Math.sin(this.direction+Math.PI/2+Math.PI)*this.speed}}function Explosion(e,i){this.x=e,this.y=i,this.alpha=1,this.direction=Math.random()*Math.PI*2,this.speed=1+7.5*Math.random(),this.lifeTime=13+12*Math.random(),this.subX=.0625*this.lifeTime+Math.random()*this.lifeTime*.0625-.03625*this.lifeTime,this.subY=.0625*this.lifeTime+Math.random()*this.lifeTime*.0625-.03625*this.lifeTime;var t=200+55*Math.random()|0,o=50+205*Math.random()|0;this.color="rgba("+t+","+o+",0,0.9)",this.move=function(){this.x+=Math.cos(this.direction)*this.speed,this.y-=Math.sin(this.direction)*this.speed}}function keyIsDown(e){0===bomb&&e.keyCode==fire&&(keyboard.fire=1),e.keyCode==bombKey&&bombLife==bombDuration&&(keyboard.bomb=1,bombLife=0),e.keyCode==move&&(keyboard.top=1),e.keyCode==left&&(keyboard.left=1),e.keyCode==right&&(keyboard.right=1),e.keyCode==bottom&&(keyboard.bottom=1)}function keyIsUp(e){e.keyCode==bottom&&(keyboard.bottom=0),e.keyCode==fire&&(keyboard.fire=0),e.keyCode==move&&(keyboard.top=0),e.keyCode==left&&(keyboard.left=0),e.keyCode==right&&(keyboard.right=0),71==e.keyCode&&(keyboard.muf=0)}function input(){0===keyboard.fire&&firePower<100&&(firePower+=2),keyboard.left&&inertiaX<4&&(inertiaX+=.4),keyboard.right&&inertiaX>-4&&(inertiaX-=.4),keyboard.top&&inertiaY<4&&(inertiaY+=.4),keyboard.bottom&&inertiaY>-4&&(inertiaY-=.4),inertiaX>0?inertiaX-=.02:inertiaX<0&&(inertiaX+=.02),inertiaY>0?inertiaY-=.02:inertiaY<0&&(inertiaY+=.02),x-=inertiaX*me.speed,y-=inertiaY*me.speed,x<0&&(x=0),y>canvas.height+img.height/2&&(y=canvas.height+img.height/2),y<90&&(y=90),0===bomb&&bombLife<bombDuration&&(bombLife+=.5)}function gameOver(){for(var e=0;e<explosions.length;e++)ctx.beginPath(),explosions[e].x+=explosions[e].dx*explosions[e].speed,explosions[e].y+=explosions[e].dy*explosions[e].speed,explosions[e].lifeTime=explosions[e].lifeTime-1,ctx.fillRect(explosions[e].x,explosions[e].y,1,1),ctx.fill(),ctx.closePath(),0===explosions[e].lifeTime&&explosions.splice(e,1);ctx.fillStyle="rgba(0,0,0,0.1)",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.fillStyle="rgb(255,"+(255-100*rSpiral-50*(5-life))+","+(255-100*rSpiral-50*(5-life))+")",ctx.fillText("Game over",canvas.width/2-50,canvas.height/2-50),ctx.fillText("Your score: "+score,canvas.width/2-60,canvas.height/2),ctx.fillText("Click to restart",canvas.width/2-60,canvas.height/2+50),canvas.onmousedown=function(){document.location=document.location}}function update(){0!==keyboard.bomb||0===bombLife?(ctx.fillStyle="rgba(0,0,0,0.8)",ctx.globalCompositeOperation="lighter"):(ctx.fillStyle="rgb(0,0,0)",ctx.globalCompositeOperation="source-over"),ctx.fillRect(0,0,canvas.width,canvas.height);for(var e=0;e<starField.length;e++){var i=starField[e];i.move(),ctx.fillStyle="rgb("+i.speed+","+i.speed+","+i.speed+")",ctx.fillRect(i.x,i.y,i.speed/70,i.speed/70)}if(f%ennemyCountDown<160&&level>2&&(ctx.fontSize=32,ctx.fillStyle="rgba('255,255,255,0.8')",ctx.fillText("Wave "+(level-2),canvas.width/2-43,canvas.height/2-16),ctx.fontSize="20px"),0==f%ennemyCountDown){for(e=0;e<nbEnnemyWave;e+=1)ennemies.push(new Ennemy);nbEnnemyWave+=~~(3*Math.random()),level++}if(ctx.globalCompositeOperation="source-over",0!==keyboard.bomb&&(missiles.length=0,bombLife==bombDuration&&(explosions=new Array),bomb<200&&(ctx.beginPath(),ctx.lineWidth=7,ctx.globalCompositeOperation="source-over",ctx.strokeStyle="rgba(255"+2*bomb+","+2*bomb+",0,0.9)",ctx.beginPath(),ctx.bezierCurveTo(50+4*bomb,100-2*bomb,4*bomb,250,50+4*bomb,400+2*bomb),ctx.stroke(),ctx.strokeStyle="rgba(255"+(1.5*bomb||0)+","+(1.5*bomb||0)+",0.9)",ctx.beginPath(),ctx.bezierCurveTo(50+3*bomb,100-1.5*bomb,bomb,250,50+3*bomb,400+1.5*bomb),ctx.stroke(),ctx.strokeStyle="rgba(255"+bomb+","+bomb+",0.9)",ctx.beginPath(),ctx.bezierCurveTo(50+2*bomb,100-bomb,350+bomb,250,50+2*bomb,400+bomb),ctx.stroke(),ctx.fillStyle="rgb(255, 255, 255)",ctx.lineWidth=1),200==(bomb+=10)&&(muf=-10,keyboard.bomb=0,bomb=0),bomb>310&&(bomb=0)),keyboard.fire&&firePower>1&&f%10>8&&"L"!=bonusType)for((a=new Missile(-Math.PI/2)).x=x+10,a.y=y,missiles.push(a),firePower-=.05*missileNumber,e=1;e<missileNumber;e++)(a=new Missile(e%2==0?-(e-1)*Math.PI/36-Math.PI/2:e*Math.PI/36-Math.PI/2)).x=x+10,a.y=y,missiles.push(a),firePower-=.025*missileNumber;for(e=0;e<ennemies.length;e++){var t=ennemies[e];if(keyboard.bomb){5*Math.random()>4&&bonusList.push(new Bonus(t.x,t.y)),score+=t.score,ennemies.splice(e,1),e--,nbEnnemKilled++;break}if("L"!=bonusType)for(var o=0;o<missiles.length;o++){var a=missiles[o];if(e<ennemies.length&&a.x>t.x&&a.x+14<t.x+44&&a.y>t.y&&a.y+12<t.y+29){if(t.energy-=90,t.energy<0){for(var n=0;n<7&&explosions.length<40;n++){var s=new Explosion(a.x-img.width/2,a.y-img.height/2);explosions.push(s)}10*Math.random()>8&&bonusList.push(new Bonus(t.x,t.y)),score+=t.score,ennemies.splice(e,1),e--,nbEnnemKilled++;break}s=new Explosion(a.x-img.width/2,a.y-img.height/2),explosions.push(s),missiles.splice(o,1),o--}}else t.x>x&&t.y>me-5+img/2&&t.y}for(o=0;o<missiles.length;o++)if(missiles[o].alpha<0)missiles.splice(o,1),--o;else{var r=missiles[o].x,l=missiles[o].y,m=missiles[o].direction;r-img.width/2>canvas.width||l<0||l-img.height/2>canvas.height?missiles.splice(o,1):(ctx.translate(r-img.width,l-img.height),ctx.rotate(-(m+Math.PI/2)),ctx.globalAlpha=missiles[o].alpha,ctx.drawImage(imgMissile,-widthMissile/2,-heightMissile/2,widthMissile,heightMissile),ctx.rotate(m+Math.PI/2),ctx.translate(-(r-img.width),-(l-img.height)),ctx.moveTo(50,canvas.width/2),missiles[o].move())}for(ctx.globalAlpha=1,e=0;e<ennemies.length;e++)null!=ennemies[e]&&ennemies[e].x<0?(muf=1,life-=10,ennemies.splice(e,1)):(ctx.drawImage(imgEnnemy,ennemies[e].x,ennemies[e].y,widthEnnemy,heightEnnemy),ennemies[e].move());if(0===bomb){for(e=0;e<explosions.length;e++)explosions[e].alpha<.2&&(explosions.splice(e,1),e--);for(e=0;e<explosions.length;e++)(s=explosions[e]).alpha-=.02,e%2==0&&(ctx.fillStyle=s.color,ctx.globalAlpha=s.alpha,s.move(),ctx.beginPath(),ctx.arc(s.x,s.y,s.lifeTime/2.5,0,2*Math.PI,!0),ctx.fill());for(ctx.fillStyle="rgb(0,0,0)",ctx.globalAlpha=1,e=0;e<explosions.length;e++)e%2==0&&((s=explosions[e]).subX-=.02,s.subY-=.02,ctx.beginPath(),ctx.arc(s.x+s.subX,s.y+s.subY,s.lifeTime/2*s.lifeTime/30,0,2*Math.PI,!0),ctx.fill())}if(ctx.globalAlpha=1,0===bomb?(ctx.beginPath(),ctx.fillStyle="rgb(255,255,255)",ctx.fillText("Score: "+score+"     Highscore:"+userHighScore,5,20),ctx.fillText("Life: ",5,46),ctx.fillText("Ammo:",180,46),ctx.fillText("Bomb:",380,46),ctx.fillStyle="rgb("+~~(255-2.5*life)+","+~~(2.5*life)+",0)",ctx.fillRect(62,29,life,20),ctx.fillStyle="rgb("+~~(255-2.5*firePower)+","+~~(2.5*firePower)+",0)",ctx.fillRect(260,29,firePower,20),ctx.fillStyle=bombLife==bombDuration?"rgb(0,255,0)":"rgb(255,0,0)",ctx.fillRect(460,29,bombLife,20),ctx.fill(),ctx.closePath(),ctx.globalAlpha=1):(ctx.globalCompositeOperation="lighter",ctx.globalAlpha=.8),0!==muf&&f%2==0){var h=ctx.getImageData(0,0,canvas.width,canvas.height);for(e=0;e<h.data.length;e+=200){var c=~~(200*Math.random());for(o=0;o<10;o++)h.data[e+4*o]=h.data[e+0]+(0===bomb?0:e/h.data.length*60),h.data[e+4*o+1]=h.data[e+1]+(0===bomb?0:e/h.data.length*7),h.data[e+4*o+2]=h.data[e+2],h.data[e+4*o+3]-=2*c}muf++,ctx.putImageData(h,10-~~(20*Math.random()),10-~~(20*Math.random())),0==muf%10&&(muf=0),ctx.globalCompositeOperation="xor"}for(e=0;0===bomb&&e<bonusList.length;e++)bonusList[e].alpha<0?(bonusList.splice(e,1),e--):(ctx.fillStyle="rgba(255,255,255,"+bonusList[e].alpha+")",ctx.fillText(bonusList[e].type,bonusList[e].x,bonusList[e].y),bonusList[e].move(),x>bonusList[e].x&&x<bonusList[e].x+64&&y>bonusList[e].y&&y<bonusList[e].y+64&&("A"==(bonusType=bonusList[e].type)?firePower=100:"B"==bonusType?bombLife=bombDuration:"+3"==bonusType&&missileNumber<9?missileNumber+=3:"L"==bonusType?(life+10<100?life+=10:life=100,bonusType=""):"S"==bonusType&&me.speed<3&&(me.speed+=.5),bonusList.splice(e,1),gotBonus=20)),bonusList[e]&&bonusList[e].x<0&&bonusList.splice(e,1);if(gotBonus>0&&(gotBonus-=.2)%3==0&&(ctx.globalCompositeOperation="xor"),keyboard.fire&&firePower>1&&"L"==bonusType&&(ctx.fillStyle="rgba(255,255,255,0.5)",cutIt(x-65,y-97,canvas.width,64),firePower-=.4),ctx.translate(x-img.width,y-img.height),ctx.rotate(-(me.direction+Math.PI/2)),ctx.drawImage(img,-width/2,-height/2,width,height),ctx.rotate(me.direction+Math.PI/2),ctx.translate(-(x-img.width),-(y-img.height)),ctx.moveTo(50,canvas.width/2),0===bomb&&0===muf&&0!==sepia){for(h=ctx.getImageData(0,0,canvas.width,canvas.height),data=h.data,e=0;e<data.length;e+=4)data[e]=255-data[e],data[e+1]=255-data[e+1],data[e+2]=255-data[e+2];ctx.putImageData(h,0,0)}}function explose(e,i,t){}function cutIt(e,i,t,o){var a=ctx.getImageData(e+16,0,10,canvas.height);noiseIt(a,e+16,0),i+=70,e=0,noiseIt(a=ctx.getImageData(e,i,t,10),e,i)}function noiseIt(e,i,t){data=e.data;for(var o=0;o<e.data.length;o+=4)data[o]=200-data[o],data[o+1]=200-data[o+1],data[o+2]=200-data[o+2];ctx.putImageData(e,i,t)}function run(){if(0===life){if(gameOver(),0===gameOverFrame){for(i=0;i<500;i++)explosions.push(new Explosion(50,canvas.height/2));forrest=new Array,score>userHighScore&&(localStorage.defendMeScore=score,userHighScore=score)}gameOverFrame+=1}else input(),update();requestAnimFrame(run),f++}function init(){for(userHighScore=localStorage.defendMeScore?localStorage.defendMeScore:0,ctx.strokeStyle="rgb(255,255,255)",ctx.lineWidth=5,ctx.canvas.width=window.innerWidth-100,ctx.canvas.height=500,ctx.font="normal 20px 'Orbitron'",img.src="motha.gif",imgEnnemy.src="ennemy.gif",imgMissile.src="missile.gif",img.onload=function(){width=img.w,x=250,y=ctx.canvas.height/2+125-img.height/2,width=img.width,height=img.height},imgEnnemy.onload=function(){widthEnnemy=imgEnnemy.width,heightEnnemy=imgEnnemy.height},imgMissile.onload=function(){widthMissile=imgMissile.width,heightMissile=imgMissile.height},localStorage.defendMeRight?right=localStorage.defendMeRight:(right=39,localStorage.defendMeRight=right),localStorage.defendMeLeft?left=localStorage.defendMeLeft:(left=37,localStorage.defendMeLeft=left),localStorage.defendMeMove?move=localStorage.defendMeMove:(move=38,localStorage.defendMeMove=move),localStorage.defendMeBottom?bottom=localStorage.defendMeBottom:(bottom=40,localStorage.defendMeBottom=bottom),localStorage.defendMeBomb?bombKey=localStorage.defendMeBomb:(bombKey=17,localStorage.defendMeBomb=bombKey),localStorage.defendMeFire?fire=localStorage.defendMeFire:(fire=32,localStorage.defendMeFire=fire),i=0;i<250;i++)starField.push(new Star(Math.random()*canvas.width,Math.random()*canvas.height))}window.requestAnimFrame=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(e,i){window.setTimeout(e,1e3/60)},init(),run()</script>