<title>Furball - js13kGames 2025</title><script>onload=()=>{const e=document.createElement("style");e.textContent="*{margin:0;padding:0;position:fixed;box-sizing:border-box;touch-action:none;user-select:none}canvas{background:linear-gradient(to top,blue,skyblue)}body{background:black}",document.head.appendChild(e);const t=document.createElement("canvas");let n=Object.assign(document.createElement("input"),{type:"range",value:3,min:1,max:10});n.addEventListener("input",()=>f=n.value/10),document.body.append(t,n);let o,a,i,l,r,s,d,c,x,f,u,y,m,p,g=0,v=new AudioContext;const h=t.getContext("2d");function b(){o=setInterval(z,1e3/60)}function z(){h.clearRect(0,0,i,l),h.strokeStyle="rgb(255,255,255,0.1)",h.lineWidth=.5,h.beginPath(),h.moveTo(i/2,0),h.lineTo(i/2,l),h.stroke(),r.forEach(e=>{e.x+=e.vx,e.x<0?e.x=i:e.x>i&&(e.x=0),e.y+=f,e.y>l&&(e.y=-u,e.x=Math.random()*i,e.vx=.5*(Math.random()<.5?-1:1)*(l/600)),s.onplatform===e&&(s.x+=e.vx,s.x<0?s.x=i:s.x>i&&(s.x=0))}),function(){if(!s.jumping)return s.y+=f,void(s.y>l&&M());s.vy+=d,s.y+=s.vy,s.x+=s.vx,s.angle+=.05*s.vx,s.x+s.size<0?s.x=i:s.x>i&&(s.x=-s.size),r.some(e=>{if(s.vy>0&&s.x+s.size>e.x-u&&s.x<e.x+u&&s.y+s.size>e.y-u&&s.y+s.size<e.y+s.vy+1)return Object.assign(s,{vy:0,jumping:!1,y:e.y-s.size,angle:0}),s.onplatform!==e&&g++,s.onplatform=e,!0})||(s.onplatform=null),s.y>l&&M()}(),r.forEach(e=>{h.save(),h.translate(e.x,e.y),h.scale(s.size,s.size);const t=h.createLinearGradient(-1,-1,1,1);t.addColorStop(0,"rgba(255,255,255,0.9)"),t.addColorStop(.5,"rgba(200,200,255,0.6)"),t.addColorStop(1,"rgba(150,150,200,0.3)"),h.fillStyle=t,h.fill(y),h.restore()}),h.save(),h.translate(s.x+s.size/2,s.y+s.size/2),h.rotate(s.angle),h.scale(s.size,s.size),h.fillStyle="rgba(0,0,0,0.7)",h.fill(m),h.fillStyle="rgba(0,255,0,0.9)",h.fill(p),h.restore(),h.fillStyle="black",h.fillText("Score:"+g,20,40)}function w(){const e=9/16;l=window.innerHeight,i=l*e,i>window.innerWidth&&(i=window.innerWidth,l=i/e),t.width=i,t.height=l,t.style.left=(window.innerWidth-i)/2+"px";const o=l/600;d=.5*o,c=-12*o,x=90*o,f=n.value/10*o,u=20*o,a=150*o,h.font=Math.max(10,Math.min(20,10*o))+"px monospace",r=[];for(let e=0;e<l;e+=x){const t=Math.random()*i,n=.5*(Math.random()<.5?-1:1)*o;r.push({x:t,vx:n,y:e})}s={size:u,x:r[0].x,y:r[0].y-u,vx:0,vy:0,jumping:!1,angle:0,onplatform:r[0]}}function M(){new Audio("furball.aac").play(),g-=5;const e=r.reduce((e,t)=>Math.abs(t.y-l/2)<Math.abs(e.y-l/2)?t:e);Object.assign(s,{x:e.x,y:e.y-s.size,vx:0,vy:0,jumping:!1,angle:0,onplatform:e})}function j(e,t=20,n=!0){let o=new Path2D;for(let a of e)for(let e of n?[1,-1]:[1]){o.moveTo(e*a[0]/t,a[1]/t);for(let n=2;n<a.length;n+=2)o.lineTo(e*a[n]/t,a[n+1]/t)}return o}y=j([[0,0,16,0,20,4,0,20]]),m=j([[0,-6,3,-6,6,-10,10,-2,10,2,7,7,4,9,0,9]]),p=j([[2,0,3,-2,5,-3,5,-1,2,0]]),w(),b(),addEventListener("resize",w),addEventListener("visibilitychange",()=>{document.hidden?clearInterval(o):b()}),t.addEventListener("pointerdown",e=>{if(s.jumping)return;!function(){const e={n:1e4,exp:1.055,mask:128};if(!e)return;let t=t=>t>e.n?null:(Math.pow(t,e.exp)&e.mask?1:-1)*Math.pow((t=>(e.n-t)/e.n)(t),2),n=v.createBuffer(1,96e3,48e3),o=n.getChannelData(0);for(let e=96e3;e--;)o[e]=t(e);let a=v.createBufferSource();a.buffer=n,a.connect(v.destination),a.start()}();let t=.05*Math.max(-a,Math.min(a,e.offsetX-i/2));Object.assign(s,{vx:t,vy:c,jumping:!0,onplatform:null})})}</script>