<!DOCTYPE html><html><head><title>Nine Lives - js13kGames 2025</title><style>#aw{display:none}html{background:#000;color:#fff} body{margin:0;overflow:hidden}canvas{width:100vw;height:100vh;image-rendering:pixelated;object-fit:contain}</style><xyz id="aw">class P extends AudioWorkletProcessor{constructor(...args){super();this.rom=null;this.bufferv=[];this.minb=0;this.wasm={};this.msgv=[];this.port.onmessage=msg=>{if(msg.data?.wasm){this.prepareClient(msg.data.wasm,msg.data.r,msg.data.c).catch((e)=>{console.error("Failed to initialize audio thread.",e);});}else if(msg.data?.msg){this.msgv.push(msg.data.msg);}else{console.log(`AudioWorkletProcessor unexpected message`,msg);}};}process(i,o,p){if(!this.run||(this.minb&lt;1))return true;let op=0;while(op&lt;o[0][0].length){let updc=o[0][0].length-op;if(updc>this.minb)updc=this.minb;this.upd(updc);for(let chid=o[0].length;chid-->0;){const sb=this.bufferv[chid];if(sb){const src=new Float32Array(sb.buffer,sb.byteOffset+op*4,updc);const dst=new Float32Array(o[0][chid].buffer,o[0][chid].byteOffset+op*4,updc);dst.set(src);}}op+=updc;}return true;}prepareClient(s,rt,c){if(this.wi)throw new Error("Multiple audio init.");return WebAssembly.instantiate(s,{env:{sh_spcm:(chid,p,c)=>this.spb(chid,p,c),sh_log:p=>this.log(p),sh_mr:(p,a)=>this.rcv(p,a),}}).then(r=>{this.wi=r.instance;this.mem=new Uint8Array(this.wi.exports.memory.buffer);this.upd=this.wi.exports.sha_update;if(this.wi.exports.sha_init(rt,c)<0){throw new Error("sha_init failed");}}).then(()=>{this.run=true;});}spb(chid,p,c){if(this.run)return;this.bufferv[chid]=new Float32Array(this.mem.buffer,this.mem.byteOffset+p,c);this.minb=this.bufferv.reduce((a,v)=>((a&lt;v?.length)?a:v.length),9999);}rcv(p,a){if(this.msgv.length<1)return 0;const msg=this.msgv[0];this.msgv.splice(0,1);if(msg.length<=a){new Uint8Array(this.mem.buffer,this.mem.byteOffset+p,msg.length).set(msg);}return msg.length;}log(p){}}registerProcessor("AWP",P);</xyz><script>const e=new TextDecoder("utf8"),t=new TextEncoder("utf8"),n={ArrowLeft:1,ArrowRight:2,ArrowUp:4,ArrowDown:8,Enter:4096,KeyA:1,KeyD:2,KeyW:4,KeyS:8,Space:16,KeyE:32,KeyR:64,KeyX:32,KeyZ:16};let r,o,i,s,a,f,u,c,d,l,h,m,w,y,g=0,p=0;function b(t,n){return t<0||n<0||t>o.length-n?"":e.decode(new Uint8Array(o.buffer,o.byteOffset+t,n))}function A(e,n,r,i){return function(e,n,r){if(e<0||n<0||e>o.length-n||r.length<1)return 0;let i=(r=t.encode(r)).length;return i>n&&(r=new Uint8Array(r.buffer,0,i=n)),new Uint8Array(o.buffer,o.byteOffset+e,i).set(r),i}(e,n,localStorage.getItem(b(r,i))||"")}function E(e,t,n,r){return localStorage.setItem(b(e,t),b(n,r)),0}function v(e,t){if(!w)return-1;const n=new Uint8Array(o.buffer,o.byteOffset+e,t);return w.port.postMessage({msg:n}),0}function U(e,t,n){const r=t*n*4;e<0||e>o.length-r||(s=new Uint8Array(o.buffer,o.byteOffset+e,r),a=t,f=n)}function _(){w=new AudioWorkletNode(m,"AWP"),w.connect(m.destination),w.port.postMessage({wasm:i.a,r:m.sampleRate,c:m.destination.channelCount})}function x(e){if(e.ctrlKey||e.altKey)return;e.stopPropagation(),e.preventDefault();const t=n[e.code];if(t)if("keydown"===e.type){if(g&t)return;g|=t}else{if(!(g&t))return;g&=~t}}function L(){requestAnimationFrame(e=>{if("number"==typeof u)return r.exports.shm_quit(u),console.log(`Terminated with status ${u}.`),d.clearRect(0,0,c.width,c.height),void m?.suspend();if(y)return;!function(){for(const e of navigator?.getGamepads?.()){const t=(t,n)=>{if(e.buttons[t]?.value){if(p&n)return;p|=n,g|=n}else{if(!(p&n))return;p&=~n,g&=~n}};e&&(t(0,16),t(1,64),t(2,32),t(9,4096),t(12,4),t(13,8),t(14,1),t(15,2))}}();let t=e-h;t>=14&&(h=e,t>19&&(t=19),r.exports.shm_update(t/1e3),s&&(l&&a===l.width&&f===l.height||(c.width=a,c.height=f,l=new ImageData(a,f)),l.data.set(s),d.putImageData(l,0,0),s=null)),L()})}addEventListener("load",t=>{fetch("game.rom").then(e=>{if(!e.ok)throw e;return e.arrayBuffer()}).then(t=>(i=function(e){if(e.length<16)throw new Error("Malformed ROM.");if(0!==e[0]||83!==e[1]||86!==e[2]||76!==e[3])throw new Error("Malformed ROM.");const t=e[4]<<24|e[5]<<16|e[6]<<8|e[7],n=e[8]<<24|e[9]<<16|e[10]<<8|e[11],r=e[12]<<24|e[13]<<16|e[14]<<8|e[15];if(t<16||n<0||r<0||t+n+r>e.length)throw new Error("Malformed ROM.");return{m:new Uint8Array(e.buffer,t,n),a:new Uint8Array(e.buffer,t+n,r)}}(new Uint8Array(t)),WebAssembly.instantiate(i.m,{env:{sh_log:t=>console.log("GAME: "+function(t){if(t<0)return"";let n=0;for(;t+n<o.length&&n<256&&o[t+n];)n++;return e.decode(new Uint8Array(o.buffer,o.byteOffset+t,n))}(t)),sh_term:e=>u=e,sh_now:e=>Date.now()/1e3,sh_sg:A,sh_ss:E,sh_ms:v,sh_in:e=>g,sh_fb:U}}))).then(({module:e,instance:t})=>(r=t,o=new Uint8Array(t.exports.memory.buffer),function(){const e=new Blob([document.getElementById("aw").innerText],{type:"text/javascript"}),t=URL.createObjectURL(e);return m=new AudioContext({latencyHint:"interactive"}),m.audioWorklet.addModule(t).then(()=>{URL.revokeObjectURL(t),"suspended"===m.state?addEventListener("click",()=>{m.resume().then(_)},{once:1}):_()})}())).then(e=>{if(r.exports.shm_init()<0)throw new Error("shm_init");document.getElementById("msg").remove(),c=document.createElement("CANVAS"),d=c.getContext("2d"),document.body.appendChild(c),addEventListener("keydown",x),addEventListener("keyup",x),addEventListener("focus",()=>{y&&"number"!=typeof u&&(y=!1,L(),m?.resume())}),addEventListener("blur",()=>{y||(y=!0,m?.suspend())}),h=performance.now(),L()}).catch(e=>{console.error(e),document.getElementById("msg").innerText=e.toString()})},{once:1});</script></head><body><p id="msg">Loading</p></body></html>