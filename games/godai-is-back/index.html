<!doctype html><meta content="width=device-width" name=viewport><title>Godai's back</title><style>html{background:#000;text-align:center}canvas{background:#000;margin-top:130px;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;-ms-interpolation-mode:nearest-neighbor;image-rendering:pixelated;border:1px solid #fff;transform:scale(3)}#hide,img{display:none}</style><canvas height=144 width=160></canvas><p id=hide>// bg std (b1) - 160x144 <img id=b1 src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACQCAMAAAC4a5CyAAAAOVBMVEVxc17Fw7YyNCny8uxyc2EyMiszNSjFw7Pz8u1wcF8zNCzw7+vIxrcxMyXHxbY0NivFxrTGx7k2NioE1GbyAAAFO0lEQVR42u2cjZaaMBCFExmcTBG0ff+HLROCg4Qg+bGmLZeDy8jp8HG5ISv2rLpUrhPwBIzUCVid6gcsqcZJldS1kNrGmBnQGNOW6lvqEnfNWj/KNC4EaDzAzpTprEoImk2BqkWd2eIzZQbLJVuSv0/kMAvQz1/5HKp8NTsCUl+WDJBqB0q3x2fg6zNJb3YB+9z+H0tgqXn5BFSR+vsA9bZIhYT6Re9m47d9Ue8qBDgE+TYBiQJ86l1fTATURx1XTqF55F1f/UbRlxhu5S6x9AvLy0J0Js3uBIdp2RMdzcIQAwgeRmz2RMezEBDs/w6DadkTeVmIuMTh8QviU1L29gdJLGhjmoBMp44LywAOMb8RdhDBlw8YzmJjsv1TBS+xL8j2L5xJFQ8U8PCofxg356uYzIUFh/1DjJvzI+5/UYgQN5f7KnSJRUTLx2+wk7W4OV8dhPGzkys8aIafh5zsJN/3wj29PERkJ0eH8+5ZnJGdzPseHTkTKpu7/HyuAYf83OULfUBRfu7ytTfVUdnc5edTnTr1Twg3x2IFj39nIfoj/FERYAAFVSUSr3xfS4gAru24Xka1kDxzwsZkkNDNcVim+a2+v9/HlXfc+zRAuMErDGlKA3QcExN439aleRj6PSjVP5EHyOyJc+eAL2LkFP98QMcsKvagGwp89wobgNdryjgbeVg3PW7PVfy3XluAPf+49uM+GOH6Cysphy57JFWkpvE7rrzV2tfrSAIWEDRZQEgBnDLnsjdIlQIIPQPCT+i5BuLrDuPCgHoE1Ck51AGl5E/bVaG62kUJ4GD3UQqgy57I1SmA8IsB8QWQg2hduPacxqSRjBr8Oh6Qk9demAUYTgDJ3reuwGlMAZRhIXUKICcPer6vIkyAkiJQvC/jg5j/RpJ61fv//KE1JwaIcCX6NCCupECBncs10rIbxX/vmQ+4d8zXmYgAEWU3LKQHpE8BIq6ONWtA5HrrPGAZcKkO8cUSousPL5WI5DzEOQ8QCW5InwBkl5DWgOKku3Zbd30BdKv+ACBqByeAW+F0WwCI6jEuW4AP9rA0ICLgNiCSeiC8PKOeoTS8ArpzlD07fD7gPqHrSxsOarf9BKQZClaAgJwTRbKnnLivO8IakNw2TYBj6aBQs+bMuW2lPymxeoLSVg4QLQkgbgByClj2HvmqMvY5zQXiFiAi3JYZ1AJo8/HnRIqP7gFaGrjBzQGS5gVsdAlR/zkNCModmZcZ0H7a1vCcL3hx0n9eMoZnBye2xexB4/JAkpCICmcw2BiRKWbAl8MtRhTqL8kenrxZRQAR7ZzyNUA7fwxIIUBkfv1NueOHAQlQf1cDQAiQ7I4KpNhHHxAQAKsARGAW71my/v7/GRdNNDjzWQEeVBGTdiU0ND8L/f7ofZHwPD+RfH30rjXAzVpNqkr/lh5W6d/CQ/UV//C4h6pS/54eqirzt/BQVeuf81DpukW1Aw61A2oFlat+B3XlOgFPwEidgNWp/j8EcalcI2DTNdnyGxfqy4CmzZbx8Ur1ZQfbS642HCzT9wQ8AU/A44BNY1/aZtIP+yp1Wwrw2V+OJ3U31u79HcCW9cP+NK425QClv2m5WNZmF5DlOShn+gEHu8kxqZ+OdhuXWBwTB8e1OKD0vzvHpJ52spehDHbi3LreB/Qz/N7B8PE2B0k7vt7HM2kn/VjVEYAtKwjo9/fr8reZ+ew7yXJ198F72xnTOodMhYDs4TJjFQLe20XGagT83+fiE/AEPAH/YsAf2Y06/61SfdX4arK1AVim79/x8Khu/QYODYcXfP9JtwAAAABJRU5ErkJggg=="> // bg death (b2) - 160x144 <img id=b2 src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAKAAAACQAQMAAAC1e/LDAAAABlBMVEXEw7UyMyk6MQVsAAAANUlEQVRIx2P4jwWMCo4KkiOIDVBqJtGAQjMptWgUjIJRMApGwfAG9KpQKLRoMFblo4K0FwQAsvarjXDOGDcAAAAASUVORK5CYII="> // godai (g) - 55x55 <img id=g src="data:image/png;base64,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"> // slash (e) - 40x49 <img id=e src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAAxAgMAAABsXYXlAAAACVBMVEUAAADy8e7y9OIQWR5nAAAAAXRSTlMAQObYZgAAAORJREFUOMut1F0OwyAIB3BZ5vsexn04Ag9wnx19H6nlL1rTZG3SpOEXBS1a5g9pWT1sS3ZfKbnLgqv7kBwC7G7DEIHUI5NB6kltezl1yqyRelJ69Ug9ZYHJNTPtoQM2qE2Pd5oOWPK+PIB5Z26sHWtL3lg6tnNM3eQxJrNNuVzD3nEs/CTLmvUqZuAtzvYX65IrsCNLnKyR2xd93ns0YOItQbWNh6aNeA0mt541sfZspTCyYP//wB06NXAbR8iWWSowa2bFY8mC/BVjYC+Z8cYgG5mD40fARRbLfgZBl7XCb68WfwOGMmf4RUK0uQAAAABJRU5ErkJggg=="> // weapon / sword flying (w) - 25x25 <img id=w src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAAAZBAMAAAA1cJZ4AAAAFVBMVEUAAAAyMyny8e4zNCsxMify8evz8fL5yvVMAAAAAXRSTlMAQObYZgAAAJ1JREFUOMvN0NENwjAMBNBLJP5zwADEE1CxAIgJkFiA/ZdAldK6TZXY/Wu+IllPvjMAhIQ97wikPeFhCdejMP8GUyghuwSxJmQhFyeRXADwfiUHiaJBBzb759UKIM3eQYQJS3I3iZQSSqz+kfXkY5GMHaRV9ot+mbAdnJ6OK3f6s0pmE4qL4DclDhRXMiU8q/AkC6Tc3Ae4PkayXPEHYz0LAk651wwAAAAASUVORK5CYII="> // life meter (l) - 40x5 <img id=l src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACgAAAAFAQMAAAANAjzGAAAABlBMVEXy8e3Fw7b5zSdKAAAADUlEQVQI12PABf6DAAAPDwT8G4kgbAAAAABJRU5ErkJggg=="> // waiting for opponent (i) - 95x7 <img id=i src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAF8AAAAHAQMAAABUXwMsAAAABlBMVEUAAADy8e3AO1BIAAAAAXRSTlMAQObYZgAAAFpJREFUCNdjmOj6ibnPmHHGYYUncgyzUoJcOLyaQpYsaWlhiFoS7MHR1mKyoqSthSFrSdDJvnYWmxc5T4GcL0FHOryaAlrWtLYwqIoEuXdUOV9oX/KkhQEZAACALiEiM8yL/gAAAABJRU5ErkJggg=="> // click to start (q) - 59x6 <img id=q src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADsAAAAGAQMAAABHD3SDAAAABlBMVEUAAADy8e3AO1BIAAAAAXRSTlMAQObYZgAAADdJREFUCNdjsGif+Izvk+EDBo+OBZ4CyhoODB0TDgR0qEIZbaoGDmApJvUVDgx1/Rv85TSWOAAAHdUTHMpz+68AAAAASUVORK5CYII="></p><script src=/socket.io.js></script><script>kontra={init(t){var i=this.canvas=document.getElementById(t)||t||document.querySelector("canvas");this.context=i.getContext("2d")},_noop:new Function,_tick:new Function},kontra.gameLoop=function(t){let i,e,a,s,n=(t=t||{}).fps||60,o=0,r=1e3/n,h=1/n,d=!1===t.clearCanvas?kontra._noop:function(){kontra.context.clearRect(0,0,kontra.canvas.width,kontra.canvas.height)};function l(){if(e=requestAnimationFrame(l),a=performance.now(),s=a-i,i=a,!(s>1e3)){for(kontra._tick(),o+=s;o>=r;)m.update(h),o-=r;d(),m.render()}}let m={update:t.update,render:t.render,isStopped:!0,start(){i=performance.now(),this.isStopped=!1,requestAnimationFrame(l)},stop(){this.isStopped=!0,cancelAnimationFrame(e)}};return m},function(){let t={},e={},a={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};for(let t=0;t<26;t++)a[65+t]=(10+t).toString(36);for(i=0;i<10;i++)a[48+i]=""+i;addEventListener("keydown",(function(i){let s=a[i.which];e[s]=!0,t[s]&&t[s](i)})),addEventListener("keyup",(function(t){e[a[t.which]]=!1})),addEventListener("blur",(function(t){e={}})),kontra.keys={bind(i,e){[].concat(i).map((function(i){t[i]=e}))},unbind(i,e){[].concat(i).map((function(i){t[i]=e}))},pressed:t=>!!e[t]}}(),function(){class t{constructor(t,i){this._x=t||0,this._y=i||0}add(t,i){this.x+=(t.x||0)*(i||1),this.y+=(t.y||0)*(i||1)}clamp(t,i,e,a){this._c=!0,this._a=t,this._b=i,this._d=e,this._e=a}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}kontra.vector=(i,e)=>new t(i,e),kontra.vector.prototype=t.prototype;class i{init(t,i,e,a){for(i in t=t||{},this.position=kontra.vector(t.x,t.y),this.velocity=kontra.vector(t.dx,t.dy),this.acceleration=kontra.vector(t.ddx,t.ddy),this.width=this.height=0,this.context=kontra.context,t)this[i]=t[i];if(e=t.image)this.image=e,this.width=e.width,this.height=e.height;else if(e=t.animations){for(i in e)this.animations[i]=e[i].clone(),a=a||e[i];this._ca=a,this.width=a.width,this.height=a.height}return this}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}collidesWith(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.y+this.height>t.y}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this._ca=this.animations[t],this._ca.loop||this._ca.reset()}advance(t){this.velocity.add(this.acceleration,t),this.position.add(this.velocity,t),this.ttl--,this._ca&&this._ca.update(t)}draw(){this.image?this.context.drawImage(this.image,this.x,this.y):this._ca?this._ca.render(this):(this.context.fillStyle=this.color,this.context.fillRect(this.x,this.y,this.width,this.height))}}kontra.sprite=t=>(new i).init(t),kontra.sprite.prototype=i.prototype}(),function(){let t,i=/(jpeg|jpg|gif|png)$/,e=/(wav|mp3|ogg|aac)$/,a=/^no$/,s=/^\//,n=/\/$/,o=new Audio,r={wav:"",mp3:o.canPlayType("audio/mpeg;").replace(a,""),ogg:o.canPlayType('audio/ogg; codecs="vorbis"').replace(a,""),aac:o.canPlayType("audio/aac;").replace(a,"")};function h(t,i){return[t.replace(n,""),t?i.replace(s,""):i].filter((t=>t)).join("/")}function d(t){return t.split(".").pop()}function l(t){let i=t.replace("."+d(t),"");return 2==i.split("/").length?i.replace(s,""):i}function m(i,e){return new Promise((function(a,s){let n=new Image;e=h(t.imagePath,i),n.onload=function(){t.images[l(i)]=t.images[e]=this,a(this)},n.onerror=function(){s(e)},n.src=e}))}function p(i,e,a){return new Promise((function(s,n){if(i=[].concat(i).reduce((function(t,i){return r[d(i)]?i:t}),a)){let a=new Audio;e=h(t.audioPath,i),a.addEventListener("canplay",(function(){t.audio[l(i)]=t.audio[e]=this,s(this)})),a.onerror=function(){n(e)},a.src=e,a.load()}else n(i)}))}function f(i,e){return e=h(t.dataPath,i),fetch(e).then((function(t){if(!t.ok)throw t;return t.clone().json().catch((function(){return t.text()}))})).then((function(a){return t.data[l(i)]=t.data[e]=a,a}))}t=kontra.assets={images:{},audio:{},data:{},imagePath:"",audioPath:"",dataPath:"",load(){let t,a,s,n,o,r=[];for(n=0;s=arguments[n];n++)o=(a=d(t=[].concat(s)[0])).match(i)?m(s):a.match(e)?p(s):f(s),r.push(o);return Promise.all(r)}}}(),function(){class t{constructor(t,i){t=t||{},this.spriteSheet=t.spriteSheet,this.frames=t.frames,this.frameRate=t.frameRate,this.loop=void 0===t.loop||t.loop,i=t.spriteSheet.frame,this.width=i.width,this.height=i.height,this.margin=i.margin||0,this._f=0,this._a=0}clone(){return kontra.animation(this)}reset(){this._f=0,this._a=0}update(t){if(this.loop||this._f!=this.frames.length-1)for(t=t||1/60,this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render(t){t=t||{};let i=this.frames[this._f]/this.spriteSheet._f|0,e=this.frames[this._f]%this.spriteSheet._f|0;(t.context||kontra.context).drawImage(this.spriteSheet.image,e*this.width+(2*e+1)*this.margin,i*this.height+(2*i+1)*this.margin,this.width,this.height,t.x,t.y,this.width,this.height)}}kontra.animation=function(i){return new t(i)},kontra.animation.prototype=t.prototype;class i{constructor(t){t=t||{},this.animations={},this.image=t.image,this.frame={width:t.frameWidth,height:t.frameHeight,margin:t.frameMargin},this._f=t.image.width/t.frameWidth|0,this.createAnimations(t.animations)}createAnimations(t){let i,e,a,s;for(s in t)e=(i=t[s]).frames,a=[],[].concat(e).map((function(t){a=a.concat(this._p(t))}),this),this.animations[s]=kontra.animation({spriteSheet:this,frames:a,frameRate:i.frameRate,loop:i.loop})}_p(t,i){if(+t===t)return t;let e=[],a=t.split(".."),s=i=+a[0],n=+a[1];if(s<n)for(;i<=n;i++)e.push(i);else for(;i>=n;i--)e.push(i);return e}}kontra.spriteSheet=function(t){return new i(t)},kontra.spriteSheet.prototype=i.prototype}();class Game{constructor(){this.init()}init(){kontra.init();["b1","b2","g","e","w","l","i","q"].forEach((t=>{kontra.assets.images[t]=document.getElementById(t)})),this.main()}main(){let t,i=23,e=24,a=(Math.random,160),s=(kontra.context,2);kontra.canvas.addEventListener("click",function(){2==s&&(s=0,t=io({path:location.pathname+"io",upgrade:!1,transports:["websocket"]}),t.on("match",(()=>{0==s&&(s=1)})),t.on("mov",((t,i)=>{1==s&&(W.x=i,W.goesTo=t)})),t.on("dmg",(t=>{1==s&&(M.percent-=t,n(o))})),t.on("end",(()=>{s=0})),t.on("disconnect",(()=>{s=0})),t.on("error",(()=>{s=0})))}.bind(this));let n=function(t){try{var i=jsfxr(t),e=new Audio;e.src=i,e.play()}catch(t){}},o=[3,,.38,,.2212,.5172,,-.5812,,,,,,,,,,,1,,,.2404,,.5],r=[3,.1822,.3,.055,.44,.83,,-.0799,-.013,,,,,,-.1661,,.3762,-.5237,.8838,.2939,,.0684,,.33],h=[3,.28,.27,.055,.22,.35,,-.0799,-.013,,,,,,-.1661,,.3762,-.5237,.71,.8999,,.0684,,.32],d=[2,,.21,.697,.4208,.6121,,.0439,.0484,,,-.0533,.9143,.8145,-.0385,.0019,-.2199,.86,.8623,.2122,.0316,,-.5227,.57],l=[3,,.6875,.5194,.6151,.6789,,.0063,.3624,.0015,-.0428,.8318,.7676,.2346,-.4347,.2729,-.0128,.0657,.9999,-.1319,,.051,-.6832,.57],m=[0,.5898,.71,1e-4,.8124,.59,,-.02,-.02,,.93,-.6417,,,.2593,.1546,.5485,-.0023,1,-.26,.91,.83,.58,.57],p=[3,.36,.89,.61,.95,.54,,.52,.0036,,.9771,.453,.4408,,-.0252,.6625,.0891,.0016,.4128,-.5699,.6257,.0698,1e-4,.57],f=function(t){t.keyRightTimer=0,t.keyLeftTimer=0,t.lastkeyLeftTimer=0,t.lastkeyRightTimer=0,t.lastKeyTimer=0,t.isMoving=!1,t.isRetreating=!1,t.isStanding=!0,t.dontStandAnymore=!1,t.additionalAnimMovement=0,t.finalAdditionalMovement=0,t.additionalSprFrame=0,t.additionalSprName="",t.additionalSprIsSword=!1,t.additionalSprPosition={x:0,y:0},t.lastMove="",kontra.sprite.prototype.init.call(this,t)};f.prototype=Object.create(kontra.sprite.prototype);let c=function(){let t=kontra.context;this.flip&&(t.save(),t.translate(a,0),t.scale(-1,1)),this.draw(),this.flip&&t.restore(),this.advance()};f.prototype.render=c,f.prototype.update=function(e){this.realX=this.flip?a-this.x:this.x,this.keyRightTimer+=e,this.keyLeftTimer+=e,this.lastKeyTimer+=e;let s=kontra.keys.pressed(this.keys.a)||this.flip&&"L"==this.goesTo,f=kontra.keys.pressed(this.keys.d)||this.flip&&"R"==this.goesTo,c=kontra.keys.pressed(this.keys.w)||this.flip&&"S"==this.goesTo,g=kontra.keys.pressed(this.keys.s)||this.flip&&"W"==this.goesTo;if(this.isMoving){let e=this._ca.frames,a=e[e.length-1]==i;if(this.additionalSprName.length&&this._ca._f==this.additionalSprFrame){let i=this.additionalSprIsSword?k:this.flip?_:w;this.additionalSprIsSword&&(i.flip=this.flip),i.position.x=this.x+this.additionalSprPosition.x,i.position.y=this.y+this.additionalSprPosition.y,i.playAnimation(this.additionalSprName);let e="atkH"==this.additionalSprName?15:20;this.additionalSprFrame=0,this.additionalSprName="",this.additionalSprIsSword=!1,i==w&&I()&&(W.isRetreating||W.isStanding?(W.isMoving=!0,W.playAnimation("block"),W.additionalAnimMovement=-.6,n(d)):(W.isMoving=!0,W.playAnimation("hit"),W.additionalAnimMovement=-1,b.percent-=e,t.emit("dmg",e),n(o))),i==_&&N()&&(D.isRetreating||D.isStanding?(D.isMoving=!0,D.playAnimation("block"),D.additionalAnimMovement=-.6,n(d)):(D.isMoving=!0,D.playAnimation("hit"),D.additionalAnimMovement=-1))}if(this._ca._f!=e.length-1)return void(this.x+=this.additionalAnimMovement);(a||this.dontStandAnymore)&&(this.x+=this.finalAdditionalMovement,this.additionalAnimMovement=0,this.finalAdditionalMovement=0,this.x=0|this.x,this.flip||t.emit("mov","",this.x),this.isMoving=!1)}if(M.isDead||b.isDead){M.isDead=b.isDead=!1;let t=M.percent<=0?D:W,i=M.percent<=0?W:D;t.isMoving=!0,t.playAnimation("death"),t.additionalSprName="death",t.additionalSprFrame=0,t.additionalSprPosition={x:24,y:15},t.additionalSprIsSword=!0,t.additionalAnimMovement=0,t.finalAdditionalMovement=-6,t.dontStandAnymore=!0,y.enabled=!0,n(l),setTimeout(function(){v.x=t.x+24,v.y=t.y+15,v.playAnimation("fly"),v.flip=t.flip,v.enabled=!0}.bind(this),750),setTimeout(function(){y.enabled=!1,n(m)}.bind(this),1500),setTimeout(function(){i.isMoving=!0,i.playAnimation("victory"),i.additionalSprName="victory",i.additionalSprFrame=2,i.additionalSprPosition={x:12,y:-3},i.dontStandAnymore=!0}.bind(this),2e3),setTimeout((function(){location.reload(!1)}),5e3)}if(!this.dontStandAnymore){if(c||this.flip&&"S"==this.goesTo)return this.isMoving=!0,this.isStanding=!1,this.playAnimation("atkL"),this.additionalSprName="atkL",this.additionalSprFrame=2,this.additionalSprPosition={x:37,y:0},this.finalAdditionalMovement=6,this.flip||(t.emit("mov","S",this.x),this.lastMove="S"),void n(r);if(g||this.flip&&"W"==this.goesTo)return this.isMoving=!0,this.isStanding=!1,this.playAnimation("atkH"),this.additionalSprName="atkH",this.additionalSprFrame=1,this.additionalSprPosition={x:37,y:0},this.finalAdditionalMovement=6,this.flip||(t.emit("mov","W",this.x),this.lastMove="W"),void n(h);if(f||s||(this.isStanding=!0,this.isRetreating=!1),this.keyRightTimer>.02&&(this.keyRightTimer=0,f&&!s&&(this.lastkeyRightTimer=this.lastKeyTimer,this.x+=1,this.isStanding=!1)),this.keyLeftTimer>.04&&(this.keyLeftTimer=0,s&&!f&&(this.lastkeyLeftTimer=this.lastKeyTimer,this.x-=1,this.isStanding=!1,this.isRetreating=!0)),this.isStanding){let i=!1;if((s&&this.lastKeyTimer-this.lastkeyLeftTimer<.8&&!this.flip||this.flip&&"FL"==this.goesTo)&&(this.keyLeftTimer=this.lastkeyLeftTimer=0,this.playAnimation("fastL"),this.x-=8,this.additionalAnimMovement=-.4,i=!0,this.flip||(this.fastMov="FL")),(f&&this.lastKeyTimer-this.lastkeyRightTimer<.8&&!this.flip||this.flip&&"FR"==this.goesTo)&&(this.keyRightTimer=this.lastkeyRightTimer=0,this.playAnimation("fastR"),this.x+=8,this.additionalAnimMovement=.4,i=!0,this.flip||(this.fastMov="FR")),i)return this.isMoving=!0,this.isStanding=!1,this.flip?this.goesTo="":t.emit("mov",this.fastMov,this.x),void n(p)}this.flip||(s&&"L"!=this.lastMove?(t.emit("mov","L",this.x),this.lastMove="L"):f&&"R"!=this.lastMove?(t.emit("mov","R",this.x),this.lastMove="R"):this.isStanding&&"ST"!=this.lastMove&&(t.emit("mov","ST",this.x),this.lastMove="ST")),f||s?this.playAnimation("walk"):this.playAnimation("stand")}},kontra.keys.bind(["g","h","w","s","left","right","up","down"],(function(t){t.preventDefault()}));let g=kontra.sprite({x:0,y:0,enabled:!0,image:kontra.assets.images.b1,render(){this.enabled&&this.draw()}}),y=kontra.sprite({x:0,y:0,enabled:!1,image:kontra.assets.images.b2,render(){this.enabled&&this.draw()}}),u=kontra.spriteSheet({image:kontra.assets.images.w,frameWidth:25,frameHeight:25,animations:{hidden:{frames:[e],frameRate:0},death:{frames:[3,e],frameRate:1,loop:!1},fly:{frames:[0,1],frameRate:12},ground:{frames:[2],frameRate:0}}}),k=kontra.sprite({x:0,y:0,flip:!1,animations:u.animations,render(){c.call(this)}}),v=kontra.sprite({x:40,y:55,dx:1,dy:-3.5,ddy:.1,animations:u.animations,enabled:!1,flip:!1,update(t){this.enabled&&(this.advance(),this.y>84&&(this.dy=this.dx=this.ddy=0,this.y=84,this.x=0|this.x,this.playAnimation("ground")))},render(){this.enabled&&c.call(this)}}),x={hidden:{frames:[e],frameRate:0},victory:{frames:[0,e],frameRate:6,loop:!1},atkL:{frames:[1,e],frameRate:6,loop:!1},atkH:{frames:[2,e],frameRate:6,loop:!1}},S=kontra.spriteSheet({image:kontra.assets.images.e,frameWidth:40,frameHeight:49,animations:x}),w=kontra.sprite({x:0,y:0,animations:S.animations}),R=kontra.spriteSheet({image:kontra.assets.images.e,frameWidth:40,frameHeight:49,animations:x}),_=kontra.sprite({x:0,y:0,flip:!0,animations:R.animations,render(){c.call(this)}}),T=function(){if(!this.enableDraw)return;this.draw();let t=kontra.context;t.fillStyle="#323429",t.fillRect(this.x,this.y,this.width*(100-this.percent)/100|0,this.height)},A=function(t){this.enabled&&(this.percent<0&&(this.percent=0,this.enabled=!1,this.isDead=!0),this.timer+=t,this.timer>.3&&(this.timer=0,this.percent<30&&(this.enableDraw=!this.enableDraw)))},M=kontra.sprite({x:8,y:130,image:kontra.assets.images.l,percent:100,timer:0,enableDraw:!0,enabled:!0,update(t){A.call(this,t)},render(){T.call(this)}}),b=kontra.sprite({x:112,y:130,image:kontra.assets.images.l,percent:100,timer:0,enableDraw:!0,enabled:!0,update(t){A.call(this,t)},render(){T.call(this)}}),L={stand:{frames:[0],frameRate:0},walk:{frames:[1,0],frameRate:3},fastL:{frames:[3,3,3,i],frameRate:8,loop:!1},fastR:{frames:[4,4,4,i],frameRate:8,loop:!1},block:{frames:[2,2,2,i],frameRate:8,loop:!1},hit:{frames:[13,13,13,i],frameRate:8,loop:!1},atkH:{frames:[7,8,8,i],frameRate:4,loop:!1},atkL:{frames:[5,5,6,i],frameRate:3,loop:!1},victory:{frames:[9,9,10],frameRate:4,loop:!1},death:{frames:[11,11,12],frameRate:2,loop:!1}},P=kontra.spriteSheet({image:kontra.assets.images.g,frameWidth:55,frameHeight:55,animations:L}),F=kontra.spriteSheet({image:kontra.assets.images.g,frameWidth:55,frameHeight:55,animations:L}),D=new f({x:20,y:55,flip:!1,animations:P.animations,keys:{a:"a",d:"d",w:"w",s:"s"}}),W=new f({x:20,y:55,flip:!0,goesTo:"",animations:F.animations,keys:{}}),H=kontra.sprite({image:kontra.assets.images.i,frameWidth:95,frameHeight:6,timer:0,timesToReload:7,enableDraw:!1,x:33,y:68,update(t){this.timer+=t,this.timer>.7&&(this.timer=0,this.enableDraw=!this.enableDraw,this.timesToReload--<0&&location.reload(!1))},render(){this.enableDraw&&this.draw()}}),E=kontra.sprite({image:kontra.assets.images.q,frameWidth:59,frameHeight:6,x:51,y:68});D.position.clamp(-20,0,a-D.width,144-D.height),W.position.clamp(-20,0,a-D.width,144-D.height);let I=function(){let t=D.realX+34,i=D.realX+59,e=W.realX-34,a=W.realX-14;return i>e&&i<a||t>e&&t<a},N=function(){let t=D.realX+16,i=D.realX+34,e=W.realX-59,a=W.realX-34;return i>e&&i<a||t>e&&t<a};kontra.gameLoop({update:function(t){if(0==s)H.update(t);else if(1==s){[D,W,w,_,k,v,M,b].forEach((i=>{i.update(t)}))}},render:function(){if(2==s)E.render();else if(0==s)H.render();else if(1==s){[g,M,b,y,w,_,v,k,D,W].forEach((t=>{t.render()}),this)}}}).start()}}let g=new Game</script>