<!doctype html><html><head><title>Q1K3 - js13kGames 2021</title></head><body><style>*{font-family:sans-serif;}a,body{color:#fff;background:#111;text-align:center;margin:0;}#c{display:block;width:100%;image-rendering:optimizeSpeed;image-rendering:pixelated;max-height:100vh;object-fit:contain;}#g{position:relative;margin:0 0 32px 0;font-weight:bold;}#ts{position:absolute;bottom:2em;left:0;right:0;font-size:1.2vw;}#msg{position:absolute;top:8vw;left:0;right:0;font-size:1.2vw;display:none;}#a,#h{position:absolute;bottom:3%;left:20%;right:0;font-size:3.2vw;}#h{left:-20%;}h1{font-size:16vw;margin:0;}</style><div id="g"><canvas id=c width=320 height=180></canvas><div id="ts"><h1>Q1K3</h1>CLICK TO START</div><div id="h"></div><div id="a"></div><div id="msg"></div></div><p>MOUSE SPEED: <input id="m" type="range" value=10 min=1 max=50></p><p><input id="f" type="button" value="FULLSCREEN"></p><p>code: <a href="https://phoboslab.org">phoboslab.org</a> / music: <a href="http://no-fate.net">no-fate.net</a></p><script>let t,s=[[64,64,0,2,3,1.4,2,17176,1.3],[64,64,38751,1,18,4,2,2,27,9,65530,0,7,1,-1,9,13,5,52,8,8,65528,39039,4,0,0,0,64,512,15,4,0,0,0,64,64,14],[64,64,38751,1,18,4,2,2,27,9,65530,0,7,1,-1,0,13,64,52,64,8,65531,39039,4,0,0,0,64,512,15,4,0,0,0,64,64,14],[64,64,13119,4,1,0,0,64,64,15,0,24,11,17,50,65523,2,8],[32,32,21839,1,0,2,10,2,11,4,65528,10,25931,4,0,0,0,32,32,14],[32,32,17487,0,1,1,30,30,65528,11,21580,4,0,0,0,32,32,15],[32,32,30015,4,5,0,0,32,32,15,1,5,4,2,2,22,6,65522,0,8],[32,32,8751,1,1,1,8,4,11,5,65524,15,17487,4,0,0,0,64,64,15],[32,32,13119,4,4,0,0,32,32,15,1,10,3,11,6,25,10,64536,64568,65519],[32,32,8751,1,1,1,3,3,4,4,65524,14,21565,1,1,-1,15,1,16,16,65522,7,0,1,-1,0,1,15,16,6,65521,0,4,4,0,0,0,32,32,15],[32,32,8719,2,63506,1,4,0,0,0,32,32,12],[32,32,21295,4,10,0,-4,32,298,10,2,4372,1],[32,32,8463,1,-1,1,35,1,35,4,65522,10,34399,0,-1,6,34,6,65526,2,34399,2,29479,1,4,6,0,0,32,32,5],[32,32,5535,4,0,0,0,128,64,14],[32,32,8463,1,0,0,3,3,4,4,0,10,65521,0,4,4,23,23,10,64885,21551,3,4,16,13,0,11,"::][::",4,0,4,4,26,26,15],[32,32,8751,1,1,1,8,3,11,5,65524,15,17487,0,9,6,14,13,15,65525,4383,4,0,0,0,64,64,12,3,10,11,20267,0,8,"---"],[32,32,17487,4,5,0,0,32,32,15,1,4,4,3,3,22,22,65523,7,30587],[64,64,38767,2,36875,2.5,1,4,10,15,8,39,59,15,15,8463,1,3,30,14,5,15,6,12813,4367,38671,0,20,1,22,6,13119,10,38671,4,0,0,0,64,64,11],[32,32,40975,2,63308,1.5,2,63751,7.3],[64,64,13119,4,17,0,0,64,64,15,0,0,29,64,64,0,0,89,4,4,21,-6,22,24,15],[32,32,13119,4,9,0,0,32,32,15,4,8,6,-22,21,32,15,4,18,0,0,32,32,4],[64,64,13119,0,0,0,64,64,0,0,64271,3,-1,50,33795,0,32,"XXX",4,7,0,0,64,64,6],[64,64,34063,4,7,0,0,64,64,12,2,12554,1],[32,32,65535,4,12,0,0,32,32,9,3,6,30,61455,0,25,"+"],[32,32,5903,4,12,0,0,32,32,9,3,5,14,65529,0,12,"NIИ"],[32,32,64271,0,12,1,7,30,65528,8,63247,4,7,0,0,32,32,8],[32,32,13119,1,1,1,14,14,16,32,56328,15,26399,1,-7,17,14,14,16,32,56328,8,26159,2,29706,1,4,0,0,0,32,320,14],[32,32,33567,1,1,1,6,30,16,31,65526,15,33823,1,9,-14,6,30,16,32,65526,15,29743,2,55625,1.5,4,0,0,0,32,320,15],[32,32,12559,1,1,1,14,14,16,16,65525,7,21295,0,1,1,14,14,65525,0,34399,0,17,17,14,14,65524,0,34399,2,8,1.5],[32,32,9503,4,11,0,0,32,32,12,1,1,1,6,7,6,8,65521,0,4],[32,32,15,4,18,0,16,32,32,15,4,27,0,-16,32,32,10]],i=[6014,21,88,[[[7,0,0,1,255,0,7,0,0,1,255,0,0,100,0,3636,254,2,1199,254,4,71,0,0,0,0,0,0,0],[1,1,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1],[[126,126,0,0,126,0,0,0,0,0,0,0,0,0,0,0,126,126,0,0,126,0,0,0,0,0,0,0,0,0,0,0]]],[[6,0,0,0,255,2,6,0,18,0,255,2,0,1e5,56363,1e5,199,2,200,254,8,24,0,0,0,0,0,0,0],[0,0,2,2,3,4,2,2,3,5,2,2,3,4,2,2,3,5],[[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[132,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[133,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,128,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[125,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[120,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],[[7,0,0,0,87,2,8,0,0,0,16,3,8,0,22,2193,255,3,1162,51,10,182,2,190,0,1,10,96,0],[0,0,0,0,0,0,1,1,1,1,1,1,1,1],[[149,149,0,0,149,0,149,0,149,149,0,0,149,0,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]]],[[8,0,0,0,65,2,6,0,0,0,243,3,0,200,7505,2e4,204,4,6180,81,4,198,0,0,0,0,6,131,0],[0,0,0,0,0,0,0,0,0,0,1,1,2,3,1,1,2,3],[[132,0,0,0,0,0,0,0,133,0,0,0,137,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[132,0,0,0,0,0,0,0,133,0,0,0,130,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],[132,0,0,0,0,0,0,0,133,0,0,0,125,0,0,0,0,0,0,0,125,0,0,0,0,0,0,0,0,0,0,0]]]]],e=44100,r=4096,n=r-1,o=new Float32Array(4*r),l=(s,i=1,h=0,e=0)=>{let r=t.createGain(),a=t.createBufferSource(),n=t.createStereoPanner();r.gain.value=i,r.connect(t.destination),n.connect(r),n.pan.value=e,a.buffer=s,a.loop=h,a.connect(n),a.start()},p=(s,i)=>{let h=t.createBuffer(2,s.length,e);return h.getChannelData(0).set(s),h.getChannelData(1).set(i),h},u=(t,s,i,h,a,l,p,c,f,u,v,m,y,x,d,M,g,z,Y,w,k,L,_,F,A,b,P,j,I,T,K,q,S,Z)=>{let C,U=Z*r,O=v*r,H=g*r,B=Math.pow(2,j-8)/t,D=Math.pow(2,q-8)/t,N=0,E=0,J=A/255,X=0,R=0,G=(i.length,Y+w+k-1),$=.00390625*Math.pow(1.059463094,s+12*(l-8)+p-128)*(1+8e-4*c),V=.00390625*Math.pow(1.059463094,s+12*(m-8)+y-128)*(1+8e-4*x);for(let t=G;0<=t;--t){let s,l=t+a,p=o[U+(l*D*r&n)]*S/512+.5,c=0,v=F,m=1;t<Y?m=t/Y:t>=Y+w&&(m-=(t-Y-w)/k),s=$,T&&(s*=p),f&&(s*=m*m),N+=s,c+=o[O+(N*r&n)]*u,s=V,d&&(s*=m*m),E+=s,c+=o[H+(E*r&n)]*M,z&&(c+=(2*Math.random()-1)*z*m),c*=m/255,K&&(v*=p),v=1.5*o[.5*v/e*r&n],X+=v*R,C=J*(c-R)-X,R+=v*C,c=[c,C,X,R,X+C][_],s=o[l*B*r&n]*I/512+.5,c*=.00476*L,i[l]+=c*(1-s),h[l]+=c*s}},v=(t,s,i=5605)=>{var h=s[20]*i>>1,e=s[21]/255,r=s[13]+s[14]+s[15]+32*h*e,a=new Float32Array(r);return r=new Float32Array(r),u(i,t,a,r,0,...s),y(h,e,a,r),p(a,r)},y=(t,s,i,h)=>{for(let e=0;e<i.length-t;e++)i[e+t]+=h[e]*s,h[e+t]+=i[e]*s},x={W:1,p:1,A:2,e:2,S:3,o:3,D:4,i:4,Q:5,E:6,c:9},d=[0,0,0,0,0,0,0],M=0,z=0,Y=0;document.onkeydown=t=>{var s=x[t.code[6]||t.code[3]];s&&(t.preventDefault(),d[s]=1)},document.onkeyup=t=>{var s=x[t.code[6]||t.code[3]];s&&(t.preventDefault(),d[s]=0)},document.onwheel=t=>{.1<Cs-Y&&(d[5+(1<t.deltaY?1:0)]=1,Y=Cs)},c.onmousemove=t=>{M+=t.movementX,z+=t.movementY},c.onmousedown=t=>{t.preventDefault(),d[7+t.button]=1},c.onmouseup=t=>{t.preventDefault(),d[7+t.button]=0};let w,k,L,_,F,A,b,P,j,I=(t,s=-1,i=0)=>t.filter((t,i)=>s<0||i==s).map(s=>{let h=0,e=document.createElement("canvas"),r=e.getContext("2d"),a=t=>"rgba("+[17*(t>>12&15),17*(t>>8&15),17*(t>>4&15),(15&t)/15].join()+")",n=(t,s,i,h,...e)=>e.map((e,n)=>{r.fillStyle=a(e),r.fillRect(t+[-1,1,0][n],s+[-1,1,0][n],i,h)});for(e.width=s[h++],e.height=s[h++],n(0,0,e.width,e.height,0,0,s[h++]);h<s.length;){let o=[(t,s,i,h,e,r,a)=>{n(t,s,i,h,e,r,a)},(t,s,i,h,r,a,o,l,p)=>{for(let c=t;c<e.width;c+=r)for(let t=s;t<e.height;t+=a)n(c,t,i,h,o,l,p)},(t,s)=>{for(let i=0;i<e.width;i+=s)for(let h=0;h<e.height;h+=s)n(i,h,s,s,0,0,(65520&t)+Math.random()*(15&t))},(t,s,i,h,e,n)=>{r.fillStyle=a(i),r.font=e+"px "+["sans-",""][h]+"serif",r.fillText(n,t,s)},(s,h,e,a,n,o)=>{r.globalAlpha=o/15,s<t.length&&i<16&&r.drawImage(I(t,s,i+1)[0],h,e,a,n),r.globalAlpha=1}][s[h++]];o(...s.slice(h,h+=o.length))}return e}),T=(t,s,i)=>t<s?s:i<t?i:t,K=(t,s,i,h,e)=>h+(t-s)/(i-s)*(e-h),q=(t=0,s=0,i=0)=>({x:t,y:s,z:i}),S=(t,s,i)=>Z(((t,s)=>q(t.x,t.y*Math.cos(s)-t.z*Math.sin(s),t.y*Math.sin(s)+t.z*Math.cos(s)))(t,i),s),Z=(t,s)=>q(t.z*Math.sin(s)+t.x*Math.cos(s),t.y,t.z*Math.cos(s)-t.x*Math.sin(s)),C=(t,s)=>Math.atan2(s.x-t.x,s.z-t.z),U=t=>q(t.x,t.y,t.z),O=t=>Math.hypot(t.x,t.y,t.z),H=(t,s)=>O(D(t,s)),B=(t,s)=>q(t.x+s.x,t.y+s.y,t.z+s.z),D=(t,s)=>q(t.x-s.x,t.y-s.y,t.z-s.z),N=(t,s)=>q(t.x*s,t.y*s,t.z*s),E=t=>N(t,1/O(t)),J=(t,s,i)=>E(((t,s)=>q(t.y*s.z-t.z*s.y,t.z*s.x-t.x*s.z,t.x*s.y-t.y*s.x))(D(t,s),D(i,s))),X={antialias:!1},R=c.getContext("webgl",X)||c.getContext("experimental-webgl",X),G=new Float32Array(524288),$=0,V=new Float32Array(192),Q=0,W=[],tt=q(0,0,-50),st=.2,it=0,ht=[],et=(t,s)=>(t=R.crS(t),R.shS(t,s),R.coS(t),t),rt=(t,s,i,h,e)=>(s=R.geAL(t,s),R.enVAA(s),R.veAP(s,i,5126,!1,4*h,4*e),s),at=t=>{var s={t:R.crT(),c:t};R.biT(3553,s.t),R.teI2D(3553,0,6408,6408,5121,t),R.teP(3553,10240,9728),R.teP(3553,10241,9984),R.teP(3553,10242,10497),R.teP(3553,10243,10497),R.geM(3553),W.push(s)},nt=(t,s,i)=>{R.clC(t,s,i,1),R.cl(16640),Q=0,V.fill(0)},ot=()=>{R.un4f(w,tt.x,tt.y,tt.z,16/9),R.un2f(L,it,st),R.un3fv(k,V);let t=0,s=-1;for(var i of ht)s!=i[5]&&(s=i[5],R.biT(3553,W[s].t)),R.un3f(_,i[0],i[1],i[2]),R.un2f(F,i[3],i[4]),R.un1f(A,i[8]),t!=i[7]-i[6]&&(t=i[7]-i[6],R.veAP(b,3,5126,!1,32,8*t*4),R.veAP(P,3,5126,!1,32,4*(8*t+5))),R.drA(4,i[6],i[9]);ht=[]},lt=(t,s,i,h,e,r,a,n)=>{ht.push([t.x,t.y,t.z,s,i,h,e,r,a,n])},pt=(t,s,i,h)=>{G.set([t.x,t.y,t.z,i,h,s.x,s.y,s.z],8*$),$++},ct=(t,s,i,h,e,r)=>{var a=J(t,s,i);pt(t,a,e,0),pt(s,a,0,0),pt(i,a,e,r),pt(h,a,0,r),pt(i,a,e,r),pt(s,a,0,0)},ft=(t,s,i,h,e,r,a)=>{var n=W[a].c,o=$,l=h/n.width,p=e/n.height,c=r/n.width,f=q(t,s+e,i),u=q(t+h,s+e,i),v=q(t,s+e,i+r);return a=q(t+h,s+e,i+r),n=q(t,s,i+r),e=q(t+h,s,i+r),r=q(t,s,i),i=q(t+h,s,i),ct(f,u,v,a,l,c),ct(n,e,r,i,l,c),ct(v,a,n,e,l,p),ct(u,f,i,r,l,p),ct(a,u,e,i,c,p),ct(f,v,r,n,c,p),o},ut=(t,s,i,h,e)=>{(s=T(K(H(t,tt),768,1024,1,0),0,1)*s*10)&&Q<32&&(V.set([t.x,t.y,t.z,i*s,h*s,e*s],6*Q),Q++)},vt=(t,s=1,i=1,h=1)=>{let e=0,r=t[e++],a=t[e++],n=t[e++],o=new Float32Array(a*r*3),l=new Uint8Array(3*n),p=0,c=16,f=-16,u=16,v=-16;for(let n=0;n<a*r*3;n+=3)o[n]=(t[e++]-15)*s,o[n+1]=(t[e++]-15)*i,o[n+2]=(t[e++]-15)*h,n<3*a&&(c=Math.min(c,o[n]),f=Math.max(f,o[n]),u=Math.min(u,o[n+1]),v=Math.max(v,o[n+1]));for(let s=0;s<3*n;s+=3)p+=t[e++],l[s]=p,l[s+1]=t[e++],l[s+2]=t[e++];var m=1/(f-c),y=-c*m,x=-1/(v-u),d=v*x;let M=[];for(let t=0;t<r;t++){M.push($);var g=t*a*3;for(let t=0;t<3*n;t+=3){let s=[],i=[];for(let h=0;h<3;h++){var z=3*l[t+h];s[h]=q(o[g+z],o[g+z+1],o[g+z+2]),i[h]={u:o[0+z]*m+y,v:o[1+z]*x+d}}var Y=J(s[2],s[1],s[0]);pt(s[2],Y,i[2].u,i[2].v),pt(s[1],Y,i[1].u,i[1].v),pt(s[0],Y,i[0].u,i[0].v)}}return{f:M,nv:3*n}},mt=128,yt=(t,s,i)=>j.cm[i*mt*mt+s*mt+t>>3]&1<<(7&t),xt=(t,s)=>{s=D(s,t);var i=N(E(s),16),h=O(s)/16;for(let s=0;s<h;s++)if(t=B(t,i),yt(t.x>>5,t.y>>4,t.z>>5))return t;return null};class dt{constructor(t,s,i){this.a=q(),this.v=q(),this.p=t,this.s=q(2,2,2),this.f=0,this.h=50,this.l=0,this._=0,this.m=0,this.M=0,this.g=1,this.k=0,this.F=0,this.T=[1,[0]],this.U=Math.random(),this.q=0,this.C=0,this.O=0,this.N=0,this.Y(s,i)}Y(t,s){}K(){this.j&&this.H()}I(){if(this._&&this._<Cs)this.L();else{this.a.y=-1200*this.g;var t,s=Math.min(this.f*Zs,1);this.v=B(this.v,D(N(this.a,Zs),(t=this.v,s=q(s,0,s),q(t.x*s.x,t.y*s.y,t.z*s.z)))),this.P=[[],Vt,$t][this.O];var i,h=this.m,e=(s=N(this.v,Zs),Math.ceil(O(s)/16)),r=N(s,1/e);for(let t=0;t<e;t++){let s=U(this.p);this.p=B(this.p,r),this.R(q(this.p.x,s.y,s.z))&&(!this.m||!this.q||0<this.v.y||this.R(q(this.p.x,s.y+this.m,s.z))?(this.X(0),this.p.x=s.x,this.v.x=-this.v.x*this.M):(s.y+=this.m,this.N=Cs),t=e),this.R(q(this.p.x,s.y,this.p.z))&&(!this.m||!this.q||0<this.v.y||this.R(q(this.p.x,s.y+this.m,this.p.z))?(this.X(2),this.p.z=s.z,this.v.z=-this.v.z*this.M):(s.y+=this.m,this.N=Cs),t=e),this.R(this.p)&&(this.X(1),this.p.y=s.y,i=200<Math.abs(this.v.y)?this.M:0,this.q=this.v.y<0&&!i,this.v.y=-this.v.y*i,t=e),this.m=h}}}R(t){if(!this.l){for(var s of this.P)if(H(t,s.p)<this.s.y+s.s.y)return this.m=0,this.G(s),!0;return!(!this.q||!this.C||yt(t.x>>5,t.y-this.s.y-8>>4,t.z>>5)||yt(t.x>>5,t.y-this.s.y-24>>4,t.z>>5))||((t,s)=>{for(let i=t.z>>5;i<=s.z>>5;i++)for(let h=t.y>>4;h<=s.y>>4;h++)for(let e=t.x>>5;e<=s.x>>5;e++)if(yt(e,h,i))return!0;return!1})(D(t,this.s),B(t,this.s))}}X(t){}G(t){}H(){this.U+=Zs;let t=this.U/this.T[0],s=t-(0|t),i=this.T[1][(0|t)%this.T[1].length],h=this.T[1][(1+t|0)%this.T[1].length];h<i&&([h,i]=[i,h],s=1-s),lt(this.p,this.k,this.F,this.Z,this.j.f[i],this.j.f[h],s,this.j.nv)}$(t,s=1,i,h,e){for(let r=0;r<t;r++){let t=Bs(kt,this.p);t.j=i,t.Z=h,t._=Cs+e+Math.random()*e*.2,t.v=q((Math.random()-.5)*s,Math.random()*s,(Math.random()-.5)*s)}}B(t,s){this.l||(this.h-=s,this.h<=0&&this.L())}J(t){var s=T(K(H(this.p,tt),64,1200,1,0),0,1),i=-1*Math.sin(C(this.p,tt)-it);l(t,s,0,i)}L(){this.l=1}}class Mt extends dt{Y(){this.s=q(12,24,12),this.f=10,this.V=3e3,this.m=17,this.t0=0,this.i0=0,this.h=100,this.O=2,this.s0=[new Et],this.h0=0,this.k+=Wt*Math.PI,this.e0=0,Qt=this,Vt.push(this)}K(){this.F=T(this.F+z*m.value*15e-5,-1.5,1.5),this.k=(this.k+M*m.value*15e-5)%(2*Math.PI),this.a=N(Z(q(d[4]-d[2],0,d[1]-d[3]),this.k),this.V*(this.q?1:.3)),d[9]&&this.q&&this.t0&&(this.v.y=400,this.q=0,this.t0=0),d[9]||(this.t0=1),this.h0=(this.h0+d[6]+this.s0.length-d[5])%this.s0.length;let t=this.i0-Cs,s=this.s0[this.h0];d[7]&&t<0&&(this.i0=Cs+s.a0,s.r0&&0==s.n0?l(Fs):(s.l0(this.p,this.k,this.F),Bs(zt,this.p,10,255)._=Cs+.1)),this.e0+=1e-4*O(this.a),this.f=this.q?10:2.5,this.I(),tt.x=this.p.x,tt.z=this.p.z,tt.y=this.p.y+8- -160*T(Cs-this.N,0,.1),it=this.k,st=this.F,lt(B(tt,S(q(0,.3*Math.sin(this.e0)-10,12+T(K(t,0,s.a0,5,0),0,5)),this.k,this.F)),this.k+Math.PI/2,this.F,s.Z,s.j.f[0],s.j.f[0],0,s.j.nv),h.textContent=0|this.h,a.textContent=s.r0?s.n0:"∞"}B(t,s){l(As),super.B(t,s)}L(){super.L(),h.textContent=0|this.h,Ns("YOU DIED"),setTimeout(()=>Os(Wt),2e3)}}class gt extends dt{Y(t,s){this.j=Ys,this.Z=t,this.h=10,this.s=q(64,64,64),this.o0=U(this.p),this._0=0,this.k=s*Math.PI/2,this.d0=0,this.c0=1==Wt,$t.push(this),Vt.push(this)}K(){if(this.H(),H(this.p,Qt.p)<128){if(this.c0)return void Ds("YOU NEED THE KEY...");this._0=Cs+3}this._0<Cs?this.d0=Math.max(0,this.d0-Zs):this.d0=Math.min(1,this.d0+Zs),this.p=B(this.o0,Z(q(96*this.d0,0,0),this.k))}B(){}}class zt extends dt{Y(t,s){this.p0=t,this.f0=Cs,1==t&&(this.u0=!0),s||console.log("no color!"),this.v0=[(7&s)<<5,(28&s)<<3,192&s]}K(){this.u0&&.9<Math.random()&&(this.p0=.5<Math.random()?10:0);let t=this.p0;this._&&(this._<Cs&&this.L(),t=K(Cs,this.f0,this._,1,0)*this.p0),ut(this.p,t,this.v0[0],this.v0[1],this.v0[2])}}class Yt extends dt{Y(){for(var t of(this.Z=30,this.j=us,this.T=[.05,[0,1,2,1,2,0,0,1,2]],this.p.x-=16,this.p.z-=16,this.m0=this.p,[q(-32,0,0),q(32,0,0),q(0,0,-32),q(0,0,32)]))if(B(this.p,t),xt(this.p,B(this.p,t))){this.p=B(this.p,N(t,.4)),this.m0=D(this.p,N(t,2));break}this.p0=0}K(){super.K(),.8<Math.random()&&(this.p0=Math.random()),ut(this.m0,Math.sin(Cs)+this.p0+6,255,192,16)}}class wt extends dt{Y(){this.j=fs,this.Z=21,this.F=Math.PI/2,this.h=10,this.s=q(8,32,8),$t.push(this)}L(){for(var t of $t){var s=H(this.p,t.p);t!==this&&s<256&&t.B(this,K(s,0,256,60,0))}for(var i of(super.L(),this.J(Ss),Js))this.$(2,600,i,21,1);Bs(zt,B(this.p,q(0,16,0)),250,143)._=Cs+.2,$t=$t.filter(t=>t!=this)}}class kt extends dt{Y(){this.M=.5,this.f=.1}K(){this.k+=.001*this.v.y,this.F+=.001*this.v.x,this.I(),this.H()}}class Lt extends dt{Y(){this.Z=8,this.j=ws,this._=Cs+2,this.M=.5,this.M0=120}K(){super.I(),this.H(),ut(B(this.p,q(0,16,0)),.5*(Math.sin(10*Cs)+2),255,32,0),this.f=this.q?5:.5}X(t){(1!=t||this.v.y<-128)&&(this.k+=Math.random(),this.J(qs))}G(t){this.L()}L(){for(var t of this.P){var s=H(this.p,t.p);s<196&&t.B(this,K(s,0,196,this.M0,0))}super.L(),this.J(Ss),this.$(20,800,es,8,1),Bs(zt,B(this.p,q(0,16,0)),250,143)._=Cs+.2}}class _t extends dt{Y(){this.Z=2,this.j=model_nail,this.g=0,this._=Cs+3}K(){this.I(),this.H()}X(t){this.L(),this.J(Ts),this.$(2,80,es,8,.4),Bs(zt,this.p,1,255)._=Cs+.1}G(t){this.L(),t.B(this,9)}}class Ft extends dt{Y(){this.Z=21,this.j=model_nail,this.g=0,this._=Cs+3}K(){this.I(),this.H(),ut(this.p,5,255,128,0)}X(t){this.L(),this.J(Ts),this.$(2,80,es,8,.4),Bs(zt,B(this.p,q(0,10,0)),5,245)._=Cs+.1}G(t){this.L(),t.B(this,15)}}class At extends dt{Y(){this.Z=18,this.M=0,this._=Cs+2,this.j=as,this.k=Math.random(),this.F=Math.random()}K(){super.I(),this.H(),this.f=this.q?15:0}X(t){1==t&&this.v.y<-128&&this.J(ks)}G(t){t.B(this,10),this.L()}}class bt extends dt{Y(){this.g=0,this._=Cs+.1}K(){this.I()}X(t){this.L(),this.$(2,80,es,4,.4),Bs(zt,this.p,.5,255)._=Cs+.1}G(t){this.L(),t.B(this,4)}}class Pt extends dt{Y(t){this.g0=[[1,[0]],[.4,[1,2,3,4]],[.2,[1,2,3,4]],[.25,[0,5,5,5]],[.25,[5,0,0,0]]],this.x0=[0,0,.1],this.w0=[1,.5,.5],this.y0=[2,1,.3],this.k0=[0,0,.1,this.y0],this.b0=[4,0,.4,this.k0],this.A0=[3,0,.4,this.b0],this.F0=[0,0,.1,this.A0],this.T0=[2,1,.8,this.F0],this.s=q(12,28,12),this.m=17,this.V=196,this.z0=this.k,this.E0=0,this.U0=800,this.D0=96,this.q0=.65,this.C=1,this.C0=1,this.O=1,$t.push(this),t?(this.O0(this.w0),this.z0=Math.PI/2*t,this.U=Math.random()):this.O0(this.x0)}O0(t){this.S0=t,this.T=this.g0[t[0]],this.U=0,this.E0=Cs+t[2]+t[2]/4*Math.random()}K(){var t,s;this.E0<Cs&&(this.C0=.5<Math.random()?.5:-.5,t=H(this.p,Qt.p),s=C(this.p,Qt.p),this.S0[3]&&this.O0(this.S0[3]),this.S0==this.y0&&(xt(this.p,Qt.p)||(this.z0=s),t<this.U0&&(t<this.D0||Math.random()>this.q0?(this.O0(this.T0),this.z0+=Math.PI/2+Math.random()*Math.PI):this.O0(this.F0))),this.S0==this.k0&&(this.z0=s),this.S0!=this.w0&&this.S0!=this.x0||t<700&&!xt(this.p,Qt.p)&&this.O0(this.F0),this.S0==this.F0&&(this.z0=s,xt(this.p,Qt.p)&&this.O0(this.T0)),this.S0==this.b0&&this.N0()),this.k+=.1*(s=this.z0-this.k,Math.atan2(Math.sin(s),Math.cos(s))),this.q&&(this.v=Z(q(0,this.v.y,this.S0[1]*this.V),this.z0)),this.I(),this.H()}Y0(t,s,i,h){let e=Bs(t,this.p);return e.O=1,e.k=this.k+Math.PI/2,e.v=S(q(0,0,s),this.k+i,Math.atan2(this.p.y-Qt.p.y,H(this.p,Qt.p))+h),e}B(t,s){super.B(t,s),this.J(ks),this.S0!=this.x0&&this.S0!=this.w0||(this.z0=C(this.p,Qt.p),this.O0(this.y0)),this.$(2,200,rs,18,.5)}L(){for(var t of(super.L(),Js))this.$(2,300,t,18,1);this.J(Ls),$t=$t.filter(t=>t!=this)}X(t){1!=t&&(this.S0==this.w0?this.z0+=Math.PI:this.z0+=this.C0)}}class jt extends Pt{Y(t){super.Y(t),this.j=ns,this.Z=17,this.h=40}N0(){this.J(Ps),Bs(zt,B(this.p,q(0,30,0)),10,255)._=Cs+.1;for(let t=0;t<3;t++)this.Y0(bt,1e4,.08*Math.random()-.04,.08*Math.random()-.04)}}class It extends Pt{Y(t){super.Y(t),this.j=os,this.Z=19,this.h=80,this.s=q(14,44,14)}N0(){this.J(bs),this.Y0(Ft,800,0,0)}}class Tt extends Pt{Y(t){super.Y(t),this.j=ls,this.Z=20,this.V=96,this.h=200,this.s=q(14,36,14),this.U0=350,this.g0=[[1,[0]],[.8,[1,2,3,4]],[.4,[1,2,3,4]],[.35,[0,5,5,5]],[.35,[5,0,0,0]]]}N0(){this.J(Ks),this.Y0(Lt,600,0,-.4).M0=40}}class Kt extends Pt{Y(t){super.Y(t),this.j=ps,this.Z=18,this.V=0,this.U0=350,this.h=60,this.g0[3]=[.25,[0,0,5,5]],this.y0=[0,0,.1],this.k0=[0,0,1.1,this.x0],this.b0=[4,0,.4,this.k0],this.A0=[3,0,.4,this.b0],this.F0=[0,0,.1,this.A0],this.T0=[0,0,.1,this.F0],this.O0(this.x0)}B(t,s){60<s&&super.B(t,s)}N0(){this.J(ks),this.Y0(At,600,0,-.5)}}class qt extends Pt{Y(t){super.Y(t),this.j=cs,this.Z=22,this.h=25,this.O=1,this.s=q(12,16,12),this.U0=200,this.D0=64,this.q0=.7,this.V=256,this.g0=[[1,[0]],[.15,[0,1]],[.15,[0,1]],[1,[0]],[.1,[0,1,1,1,0,0,0]]],this.w0=[1,.2,.5],this.k0=[0,0,.5,this.y0],this.b0=[4,0,1,this.k0],this.A0=[3,0,0,this.b0],this.F0=[0,0,0,this.A0],this.T0=[2,1,.3,this.F0],this.O0(this.x0)}G(t){this.K0||this.S0!=this.b0||(this.K0=1,t.B(this,14))}N0(){this.J(_s),this.v=Z(q(0,250,600),this.z0),this.q=0,this.K0=0,this.C=0,clearTimeout(this.j0),this.j0=setTimeout(()=>this.C=1,1e3)}}class St extends dt{Y(){this.j=Ms,this.s=q(12,12,12),this.k+=Math.PI/2}K(){this.q||this.I(),this.H(),H(this.p,Qt.p)<40&&this.H0()}}class Zt extends St{Y(){super.Y(),this.Z=21,this.j=zs}K(){this.k+=.02,super.K()}H0(){for(var t of(l(sfx_pickup),Ds("YOU GOT THE KEY!"),Gt))if(t.c0){t.c0=0;break}this.L()}}class Ct extends St{Y(){super.Y(),this.Z=12,this.j=xs}K(){this.k+=.02,super.K()}H0(){l(sfx_pickup),Qt.h0=Qt.s0.push(new Jt)-1,this.L()}}class Ut extends St{Y(){super.Y(),this.Z=21,this.j=ds}K(){this.k+=.02,super.K()}H0(){l(sfx_pickup),Qt.h0=Qt.s0.push(new Xt)-1,this.L()}}class Ot extends St{Y(){super.Y(),this.Z=23}H0(){l(sfx_pickup),Qt.h+=25,this.L()}}class Ht extends St{Y(){super.Y(),this.Z=24}H0(){for(var t of Qt.s0)t instanceof Jt&&(t.n0+=50,l(sfx_pickup),this.L())}}class Bt extends St{Y(){super.Y(),this.Z=25,this.j=gs}H0(){for(var t of Qt.s0)t instanceof Xt&&(t.n0+=10,l(sfx_pickup),this.L())}}class Dt extends dt{K(){!this.l&&H(this.p,Qt.p)<64&&(Hs(),this.l=1)}}class Nt{constructor(){this.r0=1,this.I0=q(0,0,8),this.Y()}l0(t,s,i){this.r0&&this.n0--,l(this.L0),this.Y0(t,s,i)}Y0(t,s,i){let h=Bs(this.P0,B(t,B(q(0,12,0),S(this.I0,s,i))));h.v=S(q(0,0,this.R0),s,i),h.k=s-Math.PI/2,h.F=-i,h.O=2,this.I0.x*=-1}}class Et extends Nt{Y(){this.Z=7,this.j=vs,this.L0=Ps,this.r0=0,this.a0=.9,this.P0=bt,this.R0=1e4}Y0(t,s,i){setTimeout(()=>l(js),200),setTimeout(()=>l(js),350);for(let h=0;h<8;h++)super.Y0(t,s+.08*Math.random()-.04,i+.08*Math.random()-.04)}}class Jt extends Nt{Y(){this.Z=4,this.j=ms,this.L0=Is,this.n0=100,this.a0=.09,this.P0=_t,this.R0=1300,this.I0=q(6,0,8)}}class Xt extends Nt{Y(){this.Z=21,this.j=ys,this.L0=Ks,this.n0=10,this.a0=.65,this.P0=Lt,this.R0=900}}let Rt,Gt,$t,Vt,Qt,Wt,ss,is,hs,es,rs,as,ns,os,ls,ps,cs,fs,us,vs,ms,ys,xs,ds,Ms,gs,zs,Ys,ws,ks,Ls,_s,Fs,As,bs,Ps,js,Is,Ts,Ks,qs,Ss,Zs=0,Cs=.016,Us=0,Os=t=>{ts.style.display="none",Gt=[],$t=[],Vt=[],Wt=t,(t=>{j=t;var s=[Mt,jt,It,Tt,Kt,qt,Ct,Ut,Ot,Ht,Bt,wt,zt,Dt,gt,Zt,Yt];for(let h=0;h<j.e.length;){var i=s[t.e[h++]];Bs(i,q(32*t.e[h++],16*t.e[h++],32*t.e[h++]),t.e[h++],t.e[h++])}})(is[Wt])},Hs=()=>{ss=1},Bs=(t,s,i,h)=>(h=new t(s,i,h),Gt.push(h),h),Ds=t=>{msg.textContent=t,msg.style.display="block",clearTimeout(Us),Us=setTimeout(()=>msg.style.display="none",2e3)},Ns=(t,s="")=>{ts.innerHTML="<h1>"+t+"</h1>"+s,ts.style.display="block"},Es=t=>{requestAnimationFrame(Es),t*=.001,Zs=Math.min(t-(Rt||t),.05),Rt=t,Cs+=Zs,nt(.1,.2,.5);let s=[];for(var i of Gt)i.l||(i.K(),s.push(i));Gt=s,(()=>{var t,s=q();for(t of j.r)lt(s,0,0,t.t,t.b,t.b,0,36)})(),ot(),M=z=0,d[6]=d[5]=0,ss&&(ss=0,Wt++,2==Wt?(Ns("THE END","THANKS FOR PLAYING ❤"),h.textContent=a.textContent="",Qt.l=1,tt=q(1856,784,2272),it=0,st=.5):Os(Wt))},Js=[],Xs=t=>{nt(),lt(q(0,0,0),0,0,1,model_q.f[0],model_q.f[0],0,model_q.nv),ut(q(200*Math.sin(33e-5*t),100,-100),10,255,192,32),ut(Z(q(0,0,100),63e-5*t),10,32,64,255),ut(Z(q(100,0,0),53e-5*t),10,196,128,255),ot(),requestAnimationFrame(Xs)};(async()=>{(()=>{for(var t in R)null!=R[t].length&&(R[t.match(/(^..|[A-Z]|\d.|v$)/g).join("")]=R[t]);var s=R.crP();R.atS(s,et(35633,"precision highp float;varying vec3 vp,vn;varying vec2 vt;attribute vec3 p,n,p2,n2;attribute vec2 t;uniform vec4 c;uniform vec3 mp;uniform vec2 mr;uniform vec2 m;uniform float f;mat4 rx(float r){return mat4(1,0,0,0,0,cos(r),sin(r),0,0,-sin(r),cos(r),0,0,0,0,1);}mat4 ry(float r){return mat4(cos(r),0,-sin(r),0,0,1,0,0,sin(r),0,cos(r),0,0,0,0,1);}mat4 rz(float r){return mat4(cos(r),sin(r),0,0,-sin(r),cos(r),0,0,0,0,1,0,0,0,0,1);}void main(void){mat4 mry=ry(mr.x),mrz=rz(mr.y);vp=(mry*mrz*vec4(mix(p,p2,f),1.)).xyz+mp;vn=(mry*mrz*vec4(mix(n,n2,f),1.)).xyz;vt=t;gl_Position=mat4(1,0,0,0,0,c.w,0,0,0,0,1,1,0,0,-2,0)*rx(-m.y)*ry(-m.x)*vec4(vp-c.xyz,1.);}")),R.atS(s,et(35632,"precision highp float;varying vec3 vp,vn;varying vec2 vt;uniform sampler2D s;uniform vec3 l[64];void main(void){gl_FragColor=texture2D(s,vt);vec3 vl;for(int i=0;i<64;i+=2) {vl+=max(dot(vn, normalize(l[i]-vp)),0.)*(1./pow(length(l[i]-vp),2.))*l[i+1];}gl_FragColor.rgb=floor(gl_FragColor.rgb*pow(vl,vec3(0.75))*16.0+0.5)/16.0;}")),R.liP(s),R.usP(s),w=R.geUL(s,"c"),k=R.geUL(s,"l"),L=R.geUL(s,"m"),_=R.geUL(s,"mp"),F=R.geUL(s,"mr"),A=R.geUL(s,"f"),R.biB(34962,R.crB()),rt(s,"p",3,8,0),rt(s,"t",2,8,3),rt(s,"n",3,8,5),b=rt(s,"p2",3,8,0),P=rt(s,"n2",3,8,5),R.en(2929),R.en(3042),R.en(2884),R.vi(0,0,c.width,c.height)})(),I(s).map(at),is=await(async()=>{let t=new Uint8Array(await(await fetch("l")).arrayBuffer()),s=[];for(let l=0;l<t.length;){let p,c=t[l++]|t[l++]<<8,f=new Uint8Array(262144),u=(new Uint8Array(262144),t.subarray(l,l+=c)),v=[];for(let t=0;t<u.length;){255==u[t]&&(t++,p=u[t++]);var i=u[t++],h=u[t++],e=u[t++],r=u[t++],a=u[t++],n=u[t++];v.push({t:p,b:ft(i<<5,h<<4,e<<5,r<<5,a<<4,n<<5,p)});for(let t=e;t<e+n;t++)for(let s=h;s<h+a;s++)for(let h=i;h<i+r;h++)f[t*mt*mt+s*mt+h>>3]|=1<<(7&h)}var o=t[l++]|t[l++]<<8;o=t.subarray(l,l+=6*o),s.push({cm:f,e:o,r:v})}return s})(),hs=await(async()=>{let t=new Uint8Array(await(await fetch("m")).arrayBuffer()),s=[];for(let h=0;h<t.length;){var i=3*(t[h++]*t[h++]+t[h++]);s.push(t.subarray(h-3,h+=i))}return s})(),model_q=vt(hs[3]),es=vt(hs[0],.1,.1,.1),rs=vt(hs[0],.1,.2,.1),as=vt(hs[0],.3,.6,.3),ns=vt(hs[1],2.5,2.2,2.5),os=vt(hs[1],3,2.7,3),ps=vt(hs[1],1.5,2,1.5),ls=vt(hs[1],4,3,4),cs=vt(hs[4],2.5,2.5,2.5),fs=vt(hs[2],2,2,2),us=vt(hs[7],.6,1,.6),xs=vt(hs[6],1,1,1),ds=vt(hs[2],1,.5,.5),Ms=vt(hs[5],.7,.7,.7),gs=vt(hs[5],.5,1,.5),zs=vt(hs[5],.1,.7,.1),Ys=vt(hs[5],5,5,.5),vs=vt(hs[2],1,.2,.2),ys=vt(hs[2],.7,.4,.4),ms=vt(hs[6],.7,.7,.7),ws=vt(hs[2],.3,.3,.3),model_nail=vt(hs[2],.5,.1,.1);for(let t=0;t<204;t+=34){let s=vt(hs[1],2,1,2);s.f[0]+=t,s.nv=34,Js.push(s)}R.buD(34962,G.subarray(0,8*$),35044),requestAnimationFrame(Xs),f.onclick=()=>g.requestFullscreen(),g.onclick=()=>{g.onclick=()=>c.requestPointerLock(),g.onclick(),(()=>{t=new AudioContext,t.resume();for(let t=0;t<r;t++)o[t]=Math.sin(6.283184*t/r),o[t+r]=o[t]<0?-1:1,o[t+2*r]=t/r-.5,o[t+3*r]=t<r/2?t/(r/4)-1:3-t/(r/4)})(),setTimeout(()=>{ks=v(135,[8,0,0,1,148,1,3,5,0,0,139,1,0,2653,0,2193,255,2,639,119,2,23,0,0,0,0,0,0,0]),Ls=v(140,[7,0,0,1,148,1,7,5,0,1,139,1,0,4611,789,15986,195,2,849,119,3,60,0,0,0,1,10,176,1]),_s=v(132,[8,0,0,1,192,1,8,0,0,1,120,1,0,5614,0,20400,192,1,329,252,1,55,0,0,1,1,8,192,3]),Fs=v(120,[8,0,0,0,96,1,8,0,0,0,0,0,255,0,0,1075,232,1,2132,255,0,0,0,0,0,0,0,0,0]),As=v(135,[7,3,140,1,232,3,8,0,9,1,139,3,0,4611,1403,34215,256,4,1316,255,0,0,0,1,0,1,7,255,0]),sfx_pickup=v(140,[7,0,0,1,187,3,8,0,0,1,204,3,0,4298,927,1403,255,0,0,0,3,35,0,0,0,0,0,0,0]),bs=v(135,[8,0,0,1,147,1,6,0,0,1,159,1,0,197,1234,21759,232,2,2902,255,2,53,0,0,0,0,0,0,0]),Ps=v(135,[7,3,0,1,255,1,6,0,0,1,255,1,112,548,1979,11601,255,2,2902,176,2,77,0,0,1,0,10,255,1]),js=v(125,[9,0,0,1,131,1,0,0,0,0,0,3,255,137,22,1776,255,2,4498,176,2,36,2,84,0,0,3,96,0]),Is=v(130,[7,0,0,1,132,1,8,4,0,1,132,2,162,0,0,8339,232,2,2844,195,2,40,0,0,0,0,0,0,0]),Ts=v(135,[8,0,0,1,148,1,0,0,0,0,0,1,255,0,0,2193,128,2,6982,119,2,23,0,0,0,0,0,0,0]),Ks=v(127,[8,0,0,1,171,1,9,3,0,1,84,3,96,2653,0,13163,159,2,3206,255,2,64,0,0,0,1,9,226,0]),qs=v(168,[7,0,124,0,128,0,8,5,127,0,128,0,125,88,0,2193,125,1,1238,240,1,91,3,47,0,0,0,0,0]),Ss=v(135,[8,0,0,1,195,1,6,0,0,1,127,1,255,197,1234,21759,232,2,1052,255,4,73,3,25,1,0,10,227,1]),l(((t,s,i,h)=>{let r=e*i,a=new Float32Array(r),n=new Float32Array(r);for(var o of h){let i=new Float32Array(r),h=new Float32Array(r),e=0,p=o[0][20]*t>>1,c=o[0][21]/255;for(let r=0;r<s;r++)for(let s=0;s<32;s++){var l=o[2][o[1][r]-1]?.[s];l&&u(t,l,i,h,e,...o[0]),e+=t}y(p,c,i,h);for(let t=0;t<r;t++)a[t]+=i[t],n[t]+=h[t]}return p(a,n)})(...i),1,1),Os(0),Xs=Es},100)}})()</script>