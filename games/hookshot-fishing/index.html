<meta content=$coil.xrptipbot.com/KlevPlENTriYZgB8hQi9cA name=monetization><script src=/2019/webxr/aframe.js></script><script>!function t(e,i,o){function n(s,a){if(!i[s]){if(!e[s]){var c="function"==typeof require&&require;if(!a&&c)return c(s,!0);if(r)return r(s,!0);var h=new Error("Cannot find module '"+s+"'");throw h.code="MODULE_NOT_FOUND",h}var u=i[s]={exports:{}};e[s][0].call(u.exports,(function(t){return n(e[s][1][t]||t)}),u,u.exports,t,e,i,o)}return i[s].exports}for(var r="function"==typeof require&&require,s=0;s<o.length;s++)n(o[s]);return n}({1:[function(t,e,i){"use strict";t("./src/misc/sphere-collider")},{"./src/misc/sphere-collider":2}],2:[function(t,e,i){"use strict";e.exports=AFRAME.registerComponent("sphere-collider",{schema:{objects:{default:""},state:{default:"collided"},radius:{default:.05},watch:{default:!0}},init:function(){this.observer=null,this.els=[],this.collisions=[],this.handleHit=this.handleHit.bind(this),this.handleHitEnd=this.handleHitEnd.bind(this)},remove:function(){this.pause()},play:function(){var t=this.el.sceneEl;this.data.watch&&(this.observer=new MutationObserver(this.update.bind(this,null)),this.observer.observe(t,{childList:!0,subtree:!0}))},pause:function(){this.observer&&(this.observer.disconnect(),this.observer=null)},update:function(){var t,e=this.data;t=e.objects?this.el.sceneEl.querySelectorAll(e.objects):this.el.sceneEl.children,this.els=Array.prototype.slice.call(t)},tick:function(){var t=new THREE.Vector3,e=new THREE.Vector3,i=new THREE.Vector3,o=new THREE.Vector3,n=new THREE.Box3,r=new Map;return function(){var s=this.el,a=this.data,c=[],h=void 0;s.getObject3D("mesh")&&(r.clear(),s.object3D.getWorldPosition(t),s.object3D.getWorldScale(i),h=a.radius*function(t){return Math.max.apply(null,t.toArray())}(i),this.els.forEach((function(i){var s=void 0,a=void 0,u=void 0,l=void 0;i.isEntity&&(a=i.getObject3D("mesh"))&&(n.setFromObject(a).getSize(o),l=Math.max(o.x,o.y,o.z)/2,s=Math.sqrt(2*l*l),n.getCenter(e),s&&(u=t.distanceTo(e))<s+h&&(c.push(i),r.set(i,u)))})),c.sort((function(t,e){return r.get(t)>r.get(e)?1:-1})).forEach(this.handleHit),0===c.length&&s.emit("hit",{el:null}),this.collisions.filter((function(t){return!r.has(t)})).forEach(this.handleHitEnd),this.collisions=c)}}(),handleHit:function(t){t.emit("hit"),t.addState(this.data.state),this.el.emit("hit",{el:t})},handleHitEnd:function(t){t.emit("hitend"),t.removeState(this.data.state),this.el.emit("hitend",{el:t})}})},{}]},{},[1]),function(t,e){"function"==typeof define&&define.amd?define(["exports"],e):e("object"==typeof exports&&"string"!=typeof exports.nodeName?exports:t.TinyMusic={})}(this,(function(t){function e(t){var i=t.split(r);this.frequency=e.getFrequency(i[0])||0,this.duration=e.getDuration(i[1])||0}function i(t,e,i){this.ac=t||new AudioContext,this.createFxNodes(),this.tempo=e||120,this.loop=!0,this.smoothing=0,this.staccato=0,this.notes=[],this.push.apply(this,i||[])}var o=440*Math.pow(Math.pow(2,1/12),-9),n=/^[0-9.]+$/,r=/\s+/,s=/(\d+)/,a={};"B#-C|C#-Db|D|D#-Eb|E-Fb|E#-F|F#-Gb|G|G#-Ab|A|A#-Bb|B-Cb".split("|").forEach((function(t,e){t.split("-").forEach((function(t){a[t]=e}))})),e.getFrequency=function(t){var e=t.split(s),i=a[e[0]],n=(e[1]||4)-4;return o*Math.pow(Math.pow(2,1/12),i)*Math.pow(2,n)},e.getDuration=function(t){return n.test(t)?parseFloat(t):t.toLowerCase().split("").reduce((function(t,e){return t+("w"===e?4:"h"===e?2:"q"===e?1:"e"===e?.5:"s"===e?.25:0)}),0)},i.prototype.createFxNodes=function(){var t=this.gain=this.ac.createGain();return[["bass",100],["mid",1e3],["treble",2500]].forEach(function(e,i){(i=this[e[0]]=this.ac.createBiquadFilter()).type="peaking",i.frequency.value=e[1],t.connect(t=i)}.bind(this)),t.connect(this.ac.destination),this},i.prototype.push=function(){return Array.prototype.forEach.call(arguments,function(t){this.notes.push(t instanceof e?t:new e(t))}.bind(this)),this},i.prototype.createCustomWave=function(t,e){e||(e=t),this.waveType="custom",this.customWave=[new Float32Array(t),new Float32Array(e)]},i.prototype.createOscillator=function(){return this.stop(),this.osc=this.ac.createOscillator(),this.customWave?this.osc.setPeriodicWave(this.ac.createPeriodicWave.apply(this.ac,this.customWave)):this.osc.type=this.waveType||"square",this.osc.connect(this.gain),this},i.prototype.scheduleNote=function(t,e){var i=60/this.tempo*this.notes[t].duration,o=i*(1-(this.staccato||0));return this.setFrequency(this.notes[t].frequency,e),this.smoothing&&this.notes[t].frequency&&this.slide(t,e,o),this.setFrequency(0,e+o),e+i},i.prototype.getNextNote=function(t){return this.notes[t<this.notes.length-1?t+1:0]},i.prototype.getSlideStartDelay=function(t){return t-Math.min(t,60/this.tempo*this.smoothing)},i.prototype.slide=function(t,e,i){var o=this.getNextNote(t),n=this.getSlideStartDelay(i);return this.setFrequency(this.notes[t].frequency,e+n),this.rampFrequency(o.frequency,e+i),this},i.prototype.setFrequency=function(t,e){return this.osc.frequency.setValueAtTime(t,e),this},i.prototype.rampFrequency=function(t,e){return this.osc.frequency.linearRampToValueAtTime(t,e),this},i.prototype.play=function(t){return t="number"==typeof t?t:this.ac.currentTime,this.createOscillator(),this.osc.start(t),this.notes.forEach(function(e,i){t=this.scheduleNote(i,t)}.bind(this)),this.osc.stop(t),this.osc.onended=this.loop?this.play.bind(this,t):null,this},i.prototype.stop=function(){return this.osc&&(this.osc.onended=null,this.osc.disconnect(),this.osc=null),this},t.Note=e,t.Sequence=i}));for(var ac=new AudioContext,fishSounds=[],fishNotes=["C","D","E","F","G"],fishNoteIndex=0,i=0;i<5;i++){var note=fishNotes[i],hitSound=new TinyMusic.Sequence(ac,125,[note+"3 s",note+"4 s"]);hitSound.staccato=.5,hitSound.gain.gain.value=.1,hitSound.loop=!1,fishSounds[i]=hitSound}var collectSound=new TinyMusic.Sequence(ac,140,["C5 s","F5 s"]);collectSound.staccato=.5,collectSound.gain.gain.value=.1,collectSound.loop=!1;var gameOverSound=new TinyMusic.Sequence(ac,140,["G4 s","F4 s","E4 s","D4 s","C4 s"]);gameOverSound.staccato=.6,gameOverSound.gain.gain.value=.2,gameOverSound.loop=!1;var rareSound=new TinyMusic.Sequence(ac,135,["A5 s","E5 s","A5 s","E5 s","A5 s","E5 s"]);rareSound.staccato=.5,rareSound.gain.gain.value=.2,rareSound.loop=!1;var NORMAL_SPEED=1,currentScore=0,highScore=0,State={MENU:0,GAMEPLAY:1,GAMEOVER:2},currentState=State.MENU;function addPoints(t){(currentScore+=t)>highScore&&(highScore=currentScore),document.getElementById("score").setAttribute("text",{value:"Score: "+currentScore+"\nHigh Score: "+highScore})}function randRange(t,e){return Math.random()*(e-t+1)+t}function startGame(){currentState=State.GAMEPLAY,currentScore=0,addPoints(0);for(var t=0;t<16;t++){spawnFishAt(randRange(-6,6),randRange(.5,4),randRange(-6,-3))}document.getElementById("time").emit("startTimer"),document.getElementById("title").setAttribute("visible",!1)}function endGame(){currentState=State.GAMEOVER,gameOverSound.play();var t=document.getElementById("starting-fish");t.setAttribute("visible",!0),t.emit("reappear"),document.getElementById("right-controller").emit("resetHook"),document.getElementById("left-controller").emit("resetHook");for(var e=document.getElementById("fish-spawn-root").querySelectorAll("*"),i=0;i<e.length;i++)e[i].caught&&e[i].parentNode.removeChild(e[i]),e[i].emit("swimAway");document.getElementById("title").setAttribute("visible",!0)}function spawnFishAt(t,e,i,o=!1){var n=document.getElementById("fish-spawn-root"),r=document.createElement("a-box");r.className="collider",r.setAttribute("width",1),r.setAttribute("height",.5),r.setAttribute("depth",.1),r.setAttribute("opacity",0),r.setAttribute("position",t+" "+e+" "+i);var s=Math.random(),a=randRange(.5,NORMAL_SPEED);s<.5?r.object3D.rotation.y=Math.PI:a*=-1,r.setAttribute("velocity",{vel:{x:a,y:0,z:0}}),r.setAttribute("hook-target",o?"isRare: true":"");var c=document.createElement("a-entity");c.setAttribute("fish",o?"color: #8836c2":""),n.appendChild(r),r.appendChild(c)}AFRAME.registerShader("sky-gradient",{schema:{topColor:{type:"vec3",default:{x:0,y:195,z:255},is:"uniform"},bottomColor:{type:"vec3",default:{x:255,y:255,z:255},is:"uniform"}},vertexShader:["varying vec3 vWorldPosition;","void main(){","  vec4 worldPosition = modelMatrix * vec4(position, 1.0);","  vWorldPosition = worldPosition.xyz;","  gl_Position = projectionMatrix * modelViewMatrix * vec4(position, 1.0);","}"].join("\n"),fragmentShader:["uniform vec3 topColor;","uniform vec3 bottomColor;","varying vec3 vWorldPosition;","void main(){","  float h = normalize(vWorldPosition).y;","  vec3 bCol = vec3(bottomColor.x/255.0, bottomColor.y/255.0, bottomColor.z/255.0);","  vec3 tCol = vec3(topColor.x/255.0, topColor.y/255.0, topColor.z/255.0);","  gl_FragColor = vec4(mix(bCol, tCol, max(pow(max(h , 0.0), 0.6), 0.0)), 1.0);","}"].join("\n")}),AFRAME.registerComponent("timer",{schema:{duration:{type:"number",default:60}},init:function(){var t=this.el;t.duration=this.data.duration,t.timeLeft=t.duration,t.prevTime=t.timeLeft,t.isActive=!1,t.spawnedRareFish=!1,t.addEventListener("startTimer",(function(e){t.spawnedRareFish=!1,t.timeLeft=t.duration,t.prevTime=t.duration,document.monetization&&"started"===document.monetization.state&&(t.timeLeft+=30,t.prevTime+=30),t.setAttribute("text",{value:"Time left: "+t.duration}),t.isActive=!0}))},tick:function(t,e){var i=this.el;if(i.isActive){i.timeLeft-=e/1e3;var o=Math.floor(i.timeLeft);if(o<i.prevTime&&(i.prevTime=o,i.setAttribute("text",{value:"Time left: "+o})),o<=0&&(i.isActive=!1,endGame()),!i.spawnedRareFish&&o<=10){rareSound.play(),i.spawnedRareFish=!0;for(var n=0;n<3;n++){spawnFishAt(randRange(-6,6),randRange(.5,4),randRange(-6,-3),!0)}}}}}),AFRAME.registerComponent("hookshot",{schema:{hand:{default:""}},init:function(){this.data;var t=this.el,e={hand:this.data.hand,model:!1};t.setAttribute("vive-controls",e),t.setAttribute("oculus-touch-controls",e),"right"===this.data.hand?t.shot=document.getElementById("projectile"):t.shot=document.getElementById("projectile-left"),t.addEventListener("buttondown",(function(){var e=t.shot;if(e.isExtended){e.isReturning=!0;var i=e.object3D.position,o=t.object3D.position;e.homePos=o,(r=new THREE.Vector3).subVectors(o,i).normalize().multiplyScalar(9),e.emit("updateVelocity",{x:r.x,y:r.y,z:r.z},!1),e.emit("updateGravity",{gravity:0})}else{e.isExtended=!0,e.setAttribute("visible",!0),t.querySelector(".hook").setAttribute("visible",!1),e.setAttribute("position",t.object3D.position),e.object3D.rotation.x=t.object3D.rotation.x,e.object3D.rotation.y=t.object3D.rotation.y,e.object3D.rotation.z=t.object3D.rotation.z;var n=new THREE.Vector3(0,-1,0);t.object3D.localToWorld(n);var r,s=(r=n.sub(t.object3D.position)).multiplyScalar(8);e.emit("updateVelocity",{x:s.x,y:s.y,z:s.z},!1),e.emit("updateGravity",{gravity:-5})}})),t.addEventListener("resetHook",(function(e){t.shot.setAttribute("position","0 0 0"),t.shot.isReturning=!1,t.shot.isExtended=!1,t.shot.setAttribute("visible",!1),t.querySelector(".hook").setAttribute("visible",!0),t.shot.emit("updateVelocity",{x:0,y:0,z:0},!1)}))},tick:function(t,e){var i=this.el;i.shot.isReturning?i.shot.object3D.position.distanceTo(i.shot.homePos)<=.5&&this.resetHookshot():i.shot.object3D.position.y<=0&&(i.shot.object3D.position.y=0,i.shot.emit("updateVelocity",{x:0,y:0,z:0},!1),i.shot.emit("updateGravity",{gravity:0}))},resetHookshot:function(){var t=this.el;t.shot.setAttribute("position","0 0 0"),t.shot.isReturning=!1,t.shot.isExtended=!1,t.shot.setAttribute("visible",!1),t.querySelector(".hook").setAttribute("visible",!0),t.shot.emit("updateVelocity",{x:0,y:0,z:0},!1)}}),AFRAME.registerComponent("fish",{schema:{radius:{type:"number",default:.4},color:{default:"#fcc201"}},init:function(){var t=new THREE.PolyhedronBufferGeometry([-1,0,0,1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,4,2,4,1,2,4,0,3,4,3,1,5,0,2,5,2,1,0,5,3,5,1,3],this.data.radius,0),e=new THREE.MeshPhongMaterial({color:this.data.color}),i=new THREE.Mesh(t,e);i.scale.set(1.2,1,.4),this.el.object3D.add(i);var o=new THREE.Mesh(t,e);o.position.set(.6,0,0),o.scale.set(.4,.5,.2),this.el.object3D.add(o)}}),AFRAME.registerComponent("hook-target",{schema:{startGame:{type:"boolean",default:!1},isRare:{type:"boolean",default:!1}},init:function(){var t=this.data,e=this.el;e.deathTimer=1+Math.random(),e.gameOverDelayTimer=2,e.isReappearing=!1,e.caught=!1,e.isActive=!0,e.hookshotLeft=document.getElementById("projectile-left"),e.hookshotRight=document.getElementById("projectile"),e.hookshot=null,e.firstElementChild.setAttribute("animation","property: rotation; from: 0 -20 0; to: 0 20; dur: 250; loop: true; dir: alternate; startEvents: struggle; pauseEvents: relax"),e.firstElementChild.setAttribute("animation__2","property: rotation; from: 0 -20 0; to: 0 20; dur: 800; loop: true; dir: alternate; startEvents: swim; pauseEvents: struggle"),e.addEventListener("hit",(function(i){if(e.isActive&&!e.caught&&(t.startGame&&currentState===State.MENU||currentState===State.GAMEPLAY)){var o=e.hookshotLeft.object3D.position.distanceTo(e.object3D.position),n=e.hookshotRight.object3D.position.distanceTo(e.object3D.position);e.hookshot=n<o?e.hookshotRight:e.hookshotLeft,e.hookshot.object3D.position.distanceTo(e.object3D.position)<=.8&&(e.caught=!0,fishSounds[fishNoteIndex++].play(),fishNoteIndex>4&&(fishNoteIndex=4),e.emit("updateVelocity",{x:0,y:0,z:0},!1),e.firstElementChild.emit("struggle"))}})),e.addEventListener("swimAway",(function(t){var i=THREE.Math.degToRad(randRange(0,360)),o=9*Math.cos(i),n=9*Math.sin(i);e.emit("updateVelocity",{x:o,y:0,z:n},!1),e.object3D.rotation.y=-i+Math.PI,e.firstElementChild.emit("struggle")})),e.addEventListener("reappear",(function(t){e.isReappearing=!0})),e.addEventListener("relax",(function(t){e.firstElementChild.object3D.rotation.y=0})),t.startGame||e.firstElementChild.emit("swim")},tick:function(t,e){var i=this.el,o=this.data;i.caught?(i.object3D.position.x=i.hookshot.object3D.position.x,i.object3D.position.y=i.hookshot.object3D.position.y,i.object3D.position.z=i.hookshot.object3D.position.z,i.object3D.position.length()<1.7&&(i.caught=!1,fishNoteIndex=0,collectSound.play(),o.startGame?(i.setAttribute("visible",!1),i.setAttribute("position","0 1.7 -4"),i.isActive=!1,i.firstElementChild.emit("relax"),startGame()):o.isRare?(addPoints(50),i.object3D.position.y=-50):(addPoints(10),this.respawn()))):currentState===State.GAMEOVER?o.startGame?i.isReappearing&&(i.gameOverDelayTimer-=e/1e3,i.gameOverDelayTimer<=0&&(i.gameOverDelayTimer=2,i.isReappearing=!1,i.isActive=!0,currentState=State.MENU)):i.deathTimer>0&&(i.deathTimer-=e/1e3,i.deathTimer<=0&&i.parentNode.removeChild(i)):currentState===State.GAMEPLAY&&(i.object3D.position.x<-8&&(i.emit("updateVelocity",{x:NORMAL_SPEED,y:0,z:0},!1),i.object3D.rotation.y=Math.PI),i.object3D.position.x>8&&(i.emit("updateVelocity",{x:-NORMAL_SPEED,y:0,z:0},!1),i.object3D.rotation.y=0))},respawn:function(){var t=this.el;t.object3D.position.y=randRange(1,4),t.object3D.position.z=randRange(-5,-3);var e=0,i=0,o=Math.random(),n=Math.random()-.5;o<.5?(e=6,i=-NORMAL_SPEED+n,t.object3D.rotation.y=0):(e=-6,i=NORMAL_SPEED+n,t.object3D.rotation.y=Math.PI),t.object3D.position.x=e,t.emit("updateVelocity",{x:i,y:0,z:0},!1),t.firstElementChild.emit("swim")}}),AFRAME.registerComponent("velocity",{schema:{vel:{type:"vec3",default:{x:0,y:0,z:0}},gravity:{type:"number",default:0}},init:function(){var t=this.el,e=this.data;t.vel={x:e.vel.x,y:e.vel.y,z:e.vel.z},t.gravity=e.gravity,t.addEventListener("updateVelocity",(function(e){t.vel={x:e.detail.x,y:e.detail.y,z:e.detail.z}})),t.addEventListener("updateGravity",(function(e){t.gravity=e.detail.gravity}))},tick:function(t,e){this.data;var i=this.el,o=e/1e3;i.object3D.position.x+=i.vel.x*o,i.object3D.position.y+=i.vel.y*o,i.object3D.position.z+=i.vel.z*o,i.vel.y+=i.gravity*o,i.vel.y<-10&&(i.vel.y=-10)}})</script><body><a-scene><a-entity geometry="primitive: plane; width: 50; height: 50" material="color: #81b33b" rotation="-90 0 0"></a-entity><a-camera wasd-controls-enabled=false></a-camera><a-sky material="shader: sky-gradient"></a-sky><a-text align=center color=#ff8300 id=title position="0 2.3 -2.2" value=Hookshot\nFishing width=6></a-text><a-entity rotation="0 15 0"><a-entity id=score geometry="primitive: plane; width: 0.8; height: 0.3" material="color: #cdcdcd" position="0 0.8 -1.8" text="value: Hook the fish\nto Start!; color: black; width: 2; align: center"></a-entity></a-entity><a-entity rotation="0 -15 0"><a-entity id=time geometry="primitive: plane; width: 0.6; height: 0.3" material="color: #cdcdcd" position="0 0.8 -1.8" text="value: Time left: 0; color: black; width: 2; align: center" timer></a-entity></a-entity><a-box animation="property: position; from: 0 0 -4; to: 0 1.7 -4; dur: 1950; startEvents: reappear" class=collider color=white depth=0.1 height=0.5 hook-target="startGame: true" id=starting-fish opacity=0 position="0 1.7 -4" width=1><a-entity fish></a-entity></a-box><a-entity id=fish-spawn-root></a-entity><a-entity id=mountains-root></a-entity><a-entity id=projectile geometry="primitive: sphere; radius: 0.05" material="opacity: 0" position="0 -10 0" sphere-collider="objects: .collider; radius: 0.05" velocity="vel: 0 0 0"><a-tetrahedron class=hook color=#a4bdca position="0 -0.07 0.01" radius=0.08 rotation="35 60 45"></a-tetrahedron></a-entity><a-entity id=projectile-left geometry="primitive: sphere; radius: 0.05" material="opacity: 0" position="0 -10 0" sphere-collider="objects: .collider; radius: 0.05" velocity="vel: 0 0 0"><a-tetrahedron class=hook color=#a4bdca position="0 -0.07 0.01" radius=0.08 rotation="35 60 45"></a-tetrahedron></a-entity><a-entity id=right-controller hookshot="hand: right"><a-tetrahedron class=hook color=#a4bdca position="0 -0.07 0.01" radius=0.08 rotation="35 60 45"></a-tetrahedron><a-torus color=#363654 position="0 0 0" radius=0.04 radius-tubular=0.004 rotation="0 90 0"></a-torus></a-entity><a-entity id=left-controller hookshot="hand: left"><a-tetrahedron class=hook color=#a4bdca position="0 -0.07 0.01" radius=0.08 rotation="35 60 45"></a-tetrahedron><a-torus color=#363654 position="0 0 0" radius=0.04 radius-tubular=0.004 rotation="0 90 0"></a-torus></a-entity></a-scene><script>for(var shades=["#66573e","#82735b","#9e907a"],i=3;i<37;i++){var parentEl=document.getElementById("mountains-root"),boxRoot=document.createElement("a-entity");boxRoot.setAttribute("rotation","0 "+9*i+" 0");var boxEl=document.createElement("a-box");boxEl.className="collider",boxEl.setAttribute("width",8),boxEl.setAttribute("height",4+6*Math.random()),boxEl.setAttribute("depth",8),boxEl.setAttribute("color",shades[Math.floor(3*Math.random())]),boxEl.setAttribute("position","0 "+3*Math.random()+" "+(5*Math.random()-35)),boxEl.setAttribute("rotation",Math.floor(360*Math.random())+" "+Math.floor(360*Math.random())+" "),parentEl.appendChild(boxRoot),boxRoot.appendChild(boxEl)}</script>