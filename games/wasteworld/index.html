<meta name="monetization" content="$ilp.gatehub.net/407176549"><style>@font-face{font-family:emoji;src:url(https://xem.github.io/unicode13/Twemoji.ttf)}*{font-family:Roboto}body{overflow:hidden}#c{--x:0;--y:100px;--z:0;--X:0;--Y:0;--perspective:700px;position:absolute;width:100%;height:100%;top:0;left:0;perspective:var(--perspective);overflow:hidden;z-index:500;background:#52e3f1;transition:4s filter}#s{position:absolute;top:50%;left:50%;width:0;height:0;transform-style:preserve-3d;transform:rotateX(var(--X)) rotateY(var(--Y)) translate3D(var(--x),var(--y),var(--z)) translateZ(var(--perspective));transform-origin:50% 50% var(--perspective)}#menu,#z{z-index:15000;position:absolute;width:100%;text-align:center}.container{position:absolute;top:50%;left:50%;transform-style:preserve-3d}.face2{position:absolute;top:0;left:0;transform-origin:0 0;image-rendering:pixelated;background-size:100px 100px;background-repeat:no-repeat;box-sizing:border-box}#o{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);width:10px;height:10px;backdrop-filter:invert();border-radius:50%;z-index:1000}.playerSide{width:60px;height:140px;transform-origin:50% 100%;clip-path:polygon(50% 0,100% 100%,0 100%);background:#000}.playerSide:after{content:'';width:inherit;height:inherit;position:absolute;clip-path:inherit;background:var(--bg);transform:translateY(1px) scale(.98);background-size:100% 100%;top:0;left:0}.playerFace{background:var(--skin)}.playerFace:nth-child(3):after{content:'';width:100%;height:100%;position:absolute;clip-path:polygon(10% 26%,27% 26%,27% 10%,10% 10%,10% 68%,38% 76%,67% 77%,91% 69%,91% 26%,74% 26%,74% 10%,91% 10%,91% 79%,67% 87%,38% 86%,11% 79%,10% 68%);background:#000;transform:scale(.9);top:5px;left:0}.playerFace:nth-child(2):before,.playerFace:nth-child(4):before{content:'';width:48.5px;height:48.5px;position:absolute;background:var(--hair);top:0;left:0;clip-path:polygon(0 0,100% 0,100% 10px,0 100%)}.playerFace:nth-child(1),.playerFace:nth-child(5){background:var(--hair)}.playerFace:nth-child(4):before{transform:scaleX(-1)}.playerFace:nth-child(3):before{content:'';width:48.5px;height:10px;position:absolute;background:var(--hair);top:0;left:0}#preview{position:absolute;top:250px;left:52%;width:200px;height:200px;background:#fff;perspective:800px;display:inline-block}#y{position:absolute;top:250px;right:52%;width:200px;height:200px}#preview>div{transform:translateY(80px) rotateY(180deg)}.n{position:absolute;height:40px;width:40px}#c1{left:10px;top:75px}#c2{left:10px;top:120px}#v{position:absolute;top:110%;transform:none!important;text-align:center;width:100%}#v button{width:30px;height:30px;margin:3px}#hair{right:10px;top:10px}#skin{right:10px;top:60px}#name{position:absolute;width:200px;top:-30px;left:0;box-sizing:border-box;text-align:center}#y button{font-size:1.5rem;height:80px;width:90%}#d{z-index:2000;position:absolute;width:100%;text-align:center;padding-top:150px;font-size:2rem}#d button{font-size:3rem}#w2{position:relative;width:400px;height:300px;border:1px solid;overflow-y:scroll;display:inline-block;background:lightgray}#w2 .elem{font-size:20px;height:30px;width:100%;box-sizing:border-box;text-align:left;position:relative;margin:0}#z input,#z button,#z label{font-size:1.5rem}#butJoin input{width:7rem;text-align:center}#q{--dir:1;position:absolute;transform-style:preserve-3d;top:50px;right:50px;width:100px;height:100px;--img:url(textures/cobblestone.png);transform:scale(.6) rotateX(calc(var(--dir) * -30deg)) rotateY(calc(var(--dir) * -45deg));z-index:2000}#r{position:absolute;font-size:40px;color:#fff;top:110px;right:45px;z-index:2100}.l{position:absolute;width:100px;height:100px;left:calc(50% - 50px);background-size:100px 100px;image-rendering:pixelated;background-image:var(--img2)}.l:nth-child(3){background-image:var(--img)}#rad{position:absolute;z-index:3000}.maskSide{width:30px;height:20px;box-sizing:border-box;background:#151515;border:2px solid;transform-origin:50% 50%}.maskFront{width:30px;height:27px;background:#151515;border:2px solid;clip-path:polygon(0 0,100% 0,50% 100%);transform:translateZ(-9px)}.maskFilter{width:30px;height:27px;background:#151515;clip-path:polygon(30% 0,30% 70%,0 70%,0 100%,100% 100%,100% 70%,70% 70%,70% 0);transform-origin:50% 50%}#hp{--color:#ff4d4d;--text:'HP';--progress:100%;bottom:50px}#u{--color:#9dff6b;--text:'MASK';--progress:100%;bottom:80px}.m{position:absolute;bottom:50px;right:10px;width:200px;height:15px;border:2px solid var(--color);border-top:none;z-index:3000;background:linear-gradient(90deg,var(--color) var(--progress),transparent var(--progress))}.m:before{content:var(--text);color:var(--color);position:absolute;right:105%}#give{position:absolute;width:100%;text-align:center;top:54%;z-index:3000;left:0;color:#fff}#i{position:absolute;width:600px;height:400px;background:rgba(148,134,131,.5);border:2px ridge gray;z-index:3000;box-sizing:border-box;top:50%;left:50%;transform:translate(-50%,-50%);user-select:none}.i{font-size:25px;width:40px;text-align:center;margin-left:5px}.i:first-child{margin-top:20px;margin-bottom:20px}#l{position:absolute;height:370px;width:300px;border:1px solid;top:20px;left:50px;overflow-y:scroll}#m,#n{position:absolute;height:150px;width:210px;top:20px;left:370px}#n{top:180px;padding:5px;box-sizing:border-box}#l .item{position:relative;width:calc(100% - 10px);height:50px;line-height:46px;font-size:25px;margin:3px;text-align:left}#l .item img{position:absolute;width:44px;right:1px;top:1px image-rendering:pixelated}.reqelem{width:40px;padding-top:40px;background-size:40px 40px;background-position:top;background-repeat:no-repeat;display:inline-block;image-rendering:pixelated;margin:5px}.waypoint{height:10000px;width:200px;background:#fff;transform:translateY(-50%)}.block2D{--rot:0;width:100px;height:100px;transform-origin:50% 0}</style><body><div id='c'><div id='s'></div></div><div id='d' hidden> Paused<br><br><button id='r0'>RESUME</button><br><br>Distance<br><button id='r1'>1</button><button id='r2'>2</button><button id='r3'>3</button><br><br><button id='r5'>QUIT</button></div><div id='i' hidden><button class='i' id='I1'>X</button><br><button class='i' id='I2'>‚õè</button><br><button class='i' id='I3'>üì¶</button><div id='l'></div><button id='m'></button><div id='n'></div></div><div id='o' hidden></div><div id='give' hidden>[G] Give</div><div id='q' hidden><div class='l'></div></div><div id='r'></div><div id='rad'></div><div class='m' id='hp' hidden></div><div class='m' id='u' hidden></div></body><div id='menu'><div id='preview'><input class='n' id='c1' type='color'><input class='n' id='c2' type='color' hidden><input class='n' id='hair' type='color' value='#d1d425'><input class='n' id='skin' value='#deac9d' type='color'><input id='name' value='me'><input id='color' hidden><div id='v' hidden></div></div><div id='y'><button id='m1'>HOST</button><br><input id='w'><button id='m4'>JOIN üåç</button></div><br><div id='z' hidden><div id='w2'></div><br><div id='butHost'><input id='x'><button id='m5'>Create</button></div><div></div></div></div><canvas hidden id='texture'></canvas><script src="/socket.io.js"></script><script type=module>const r=e=>Math.random(),Y=(e,t)=>e.style.transform=t,s=e=>d.getElementById(e);function on(e,t){window.socket&&socket.on(e,t)}function emit(e,t){window.socket&&socket.emit(e,t)}const d=document,b=d.body,f=Math.floor,P=Math.PI;function cT(){const  textureData=[null,[{h:140,s:60,l:35,n:15},{h:"y>(ss=(3+r()*3))?20:140",s:"y>ss?50:60",l:"y>ss?45:35",n:13}],{h:60,s:"r()*30+60",l:70,n:15},{h:0,s:0,l:"(Math.abs(noise(x/6,y/6)) < .35 ? 35 : 50)",n:8},{h:0,s:0,l:50,n:8},{h:30,s:70,l:"y%4==0?40:55",n:10},{h:20,s:50,l:45,n:13},{h:0,s:0,l:"((x%16==y%16)||((16-x)%16==y%16)?30:40)",n:-15},[{h:24,s:68,l:"Math.min(8-Math.abs(x-8),8-Math.abs(y-8))/10*50+30",n:5},{h:24,s:68,l:"(noise(x/10-4,y/2-4)>.4?20:30)",n:5}],{h:295,s:90,l:"(y%4==x%4?40:50)",n:3},[{h:90,s:70,l:"((y%15==0||~~(x%3)==0||~~(y%3)==0?2:0)?40:65)",n:5},{e:"\u26a1",h:90,s:70,l:"((y%15==0||~~(x%3)==0?2:0)?40:65)",n:5}],{h:0,s:50,l:"((y%4==0||x%8==(~~(y/4)%2==0?2:0))?45:55)",n:5},[{h:38,s:65,l:"(((side||x==7||x==8)?0:(((x+y)/32)*30+10))+40)",n:5},{h:38,s:65,l:"((side?0:(((x+y)/32)*30+10))+40)",n:5}],{h:110,s:75,l:"(Math.abs(noise(x/6-4,y/6-4)) < .35 ? 35 : 50)",n:15},{h:40,s:"noise(x/6-4,y/6-4) > .2 ? 30: 0",l:50,n:8},{h:40,s:"noise(x/6-4,y/6-4) > .2 ? 80: 0",l:50,n:8},{h:340,s:"noise(x/6-4,y/6-4) > .2 ? 60: 0",l:50,n:8},{h:210,s:"noise(x/6-4,y/6-4) > .2 ? 60: 0",l:50,n:8},{h:140,s:"noise(x/6-4,y/6-4) > .2 ? 60: 0",l:50,n:8},{h:20,s:50,l:"((y%4==0||x%4==(~~(y/4)%2==0?2:0))?30:45)",n:13},{h:40,s:20,l:"((side?0:(((32-(x+y))/32)*40))+50)",n:3},{h:60,s:80,l:"((side?0:(((32-(x+y))/32)*30))+40)",n:3},{h:350,s:80,l:"((side?0:(((32-(x+y))/32)*30))+40)",n:3},{h:220,s:80,l:"((side?0:(((32-(x+y))/32)*30))+40)",n:3},{h:120,s:80,l:"((side?0:(((32-(x+y))/32)*30))+40)",n:3},{h:0,s:0,l:"((y%8==0||x%8==(~~(y/8)%2==0?4:0))?40:50)",n:8},{e:"\ud83c\udf31"},{h:60,s:75,l:"((y%8==0||x%8==(~~(y/8)%2==0?4:0))?55:70)",n:10},{h:40,s:20,l:"(((y%4==0||x%8==(~~(y/4)%2==0?2:0))?0:20))+50",n:4},{h:60,s:80,l:"(((y%4==0||x%8==(~~(y/4)%2==0?2:0))?0:10))+40",n:4},{h:350,s:80,l:"(((y%4==0||x%8==(~~(y/4)%2==0?2:0))?0:10))+40",n:4},{h:220,s:80,l:"(((y%4==0||x%8==(~~(y/4)%2==0?2:0))?0:10))+40",n:4},{h:120,s:80,l:"(((y%4==0||x%8==(~~(y/4)%2==0?2:0))?0:10))+40",n:4},{h:60,s:"(x < 8 == y < 8) ? 0 : 75 ",l:"((y%8==0||x%8==0)?40:50)+((x < 8 == y < 8) ? 0 : 20)",n:8},{h:60,s:"(x < 8 == y < 8) ? 0 : 10 ",l:"((y%8==0||x%8==0)?20:30)+((x < 8 == y < 8) ? 0 : 60)",n:8},{h:"(x < 8 == y < 8) ? 0 : 240",s:60,l:"((y%8==0||x%8==0)?52:60)",n:5},{h:0,s:0,l:"((y%8==0||x%8==(~~(y/8)%2==0?4:0))?80:90)",n:8},{e:"\ud83c\udf37"},{e:"\ud83c\udf39"},{e:"\ud83c\udf3c"},{e:"\ud83c\udf39",filter:"hue-rotate(200deg) brightness(1.5)"},{e:"\ud83e\udd86"}]; textureData[100]=null, textureData.push({e:"\ud83d\udc8e",filter:"contrast(.5) sepia(.5) saturate(1.3) hue-rotate(0deg)"},{e:"\ud83d\udc8e",filter:"contrast(.3) sepia(1) saturate(2) hue-rotate(10deg)"},{e:"\ud83d\udc8e",filter:"contrast(.3) sepia(1) saturate(2) hue-rotate(300deg)"},{e:"\ud83d\udc8e",filter:"contrast(.3) sepia(1) saturate(2) hue-rotate(180deg)"},{e:"\ud83d\udc8e",filter:"contrast(.3) sepia(1) saturate(2) hue-rotate(100deg)"},{e:"\u26cf"},{e:"\ud83c\udf4e"},{e:"\ud83e\udd6b"},{e:"\ud83e\udd6b",filter:"hue-rotate(260deg)"},{e:"\ud83e\uddf5",filter:"grayscale(1)"},{e:"\ud83e\udded"},{e:"\ud83e\udded",filter:"hue-rotate(120deg)"});const c=s("texture"),ctx=c.getContext("2d");ctx.font="14px emoji";const size=16;c.width=c.height=size;const noise=n2(()=>0);for(let i in textureData) if(null!== textureData[i]){let loopamount= textureData[i].length||1;for(let j=0;j<loopamount;++j){const t=loopamount>1? textureData[i][j]: textureData[i]; if(c.width=c.height=size,i<100){for(let x=0;x<size;++x)for(let y=0;y<size;++y){const side=0==x||x==size-1||0==y||y==size-1,color=`hsl(${t.h}, ${t.s}%, ${t.l+t.n*r()}%)`;ctx.fillStyle=color,ctx.fillRect(x,y,1,1)}isPlant(+i)&&(c.width=c.height=1,c.width=c.height=size),ctx.font="13px emoji",t.e&&ctx.fillText(t.e,1,12.5),ctx.filter=t.filter,ctx.drawImage(c,0,0)}else c.width=c.height=1,c.width=c.height=size,ctx.font="14px emoji",ctx.fillText(t.e,1,13),ctx.filter=t.filter,ctx.drawImage(c,0,0);c.toBlob(e=>{loopamount>1?(bt[i]||(bt[i]=[]),bt[i][j]=URL.createObjectURL(e)):bt[i]=URL.createObjectURL(e)})}}}d.G=d.createElement;const L=localStorage;const is2D=[26],bn=[["Air"],["Grass"],["Sand"],["Cobblestone"],["Stone"],["Planks"],["Dirt"],["Bedrock"],["Log"],["Carpet"],["Nuclear Battery"],["Brick"],["Box"],["Leaves"],["Iron Ore"],["Gold Ore"],["Redium Ore"],["Blueium Ore"],["Uranium Ore"],["Dirt Brick"],["Iron Block"],["Gold Block"],["Redium Block"],["Blueium Block"],["Uranium Block"],["Stone Brick"],["Sappling"],["Sand Brick"],["Iron Brick"],["Gold Brick"],["Red Brick"],["Blue Brick"],["Uranium Brick"],["Sand Stone Tile"],["Kitchen Tile"],["Blue-Red Tile"],["Marble Brick"],["Tulip"],["Rose"],["Poppy"],["Cyan Flower"],["Duck"],...Array(59),["Iron"],["Gold"],["Redium"],["Blueium"],["Uranium"],["Pickaxe"],["Apple"],["Can of Beans"],["Canned Apples"],["Mask Cartridge"],["Compass"],["WFS\u2122 Compass"]],consumables=[107,108,109,110];let I=[],invSaveName;function getItem(e,t=!0,s=1){ if(0==e)return ; if(t){9==(e=ti(e))?s=10+~~(20*r()):108==e?s=2+~~(5*r()):110==e?s=1+~~(2*r()):26==e&&(s=2+~~(3*r()))} if(-1==e)return ;const n=ie();I[e]?I[e]+=s:I[e]=s,rc(),n&&sB(!0)}function ti(e){return 1==e?6:4==e?3:14==e?101:15==e?102:16==e?103:17==e?104:18==e?105:13==e?r()>.75?r()>.5?26:107:-1:12==e?[9,108,110,106,26][~~(5*r())]:e}function he(e){return I[e]&&I[e]>0}function re(e){I[e]&&(I[e]=Math.max(0,I[e]-1)),rc(),0==I[e]&&sB(!0)}function rc(){s("r").innerHTML=I[sb]?I[sb]:0}function ie(){for(let e=1;e<I.length;++e) if(I[e])return !1;return !0}function sI(){const e=JSON.parse(L.getItem("wwc21"));e[invSaveName]=[I,status,D],L.setItem("wwc21",JSON.stringify(e))}function lI(e){invSaveName=e;const t=L.getItem("wwc21");let s;null==t?(L.setItem("wwc21",JSON.stringify({})),s={}):(s=JSON.parse(t),s[e]?(I=s[e][0],status.hp=s[e][1].hp,status.c=s[e][1].c,D.x=s[e][2].x,D.y=s[e][2].y,D.z=s[e][2].z):I=[]),sB(!0)}function shareResource(){T&&he(si)&&(emit("n",[T,si]),re(si))}function getResource(e){getItem(+e,!1)}let RD=2,SESSION_ID=function (){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let t="";for(let s=0;s<4;++s)t+=e[~~(r()*e.length)];return t}();const bt=[];let GT;class W{f=[];g=[];h=[];constructor(e){ this.a=e||r(), this.b=n2(()=> this.a), this.c=n2(()=>1- this.a), this.d=n2(()=> this.a+.3), this.e=!1, this.r(), this.t(), this.s()}i(e,t){return  this.f[e]&& this.f[e][t]}j(e,t,s){return  this.f[e]||( this.f[e]=[]), this.f[e][t]||( this.f[e][t]= this.p(e,t,s)), this.f[e][t]}k(e,t){return t<30&&t>-30&&e<30&&e>-30?0:( this.d(e/500,t/500)+1)/2}l(e,t){return  this.e?0: this.k(e,t)}m(e,t,s){return e=f(-e/100),t=f(-t/100),s=f(-s/100), this.n(e,t,s)}n(e,t,s){const n=f(e/6),i=f(t/6),o=(e%6+6)%6,r=(t%6+6)%6;return  this.f[n]&& this.f[n][i]? this.f[n][i].n(o,r,s):null}o(e,t,s,n){ if(s<0||s>=31)return ;const i=f(e/6),o=f(t/6),r=(e%6+6)%6,a=(t%6+6)%6; this.f[i]&& this.f[i][o]&& this.f[i][o].o(r,a,s,n), this.g.includes( this.f[i][o])&&(0==r&& this.i(i-1,o)? this.f[i-1][o].w():5==r&& this.i(i+1,o)&& this.f[i+1][o].w(),0==a&& this.i(i,o-1)? this.f[i][o-1].w():5==a&& this.i(i,o+1)&& this.f[i][o+1].w())}p(e,t,s){const n=new C(e,t, this.b, this.c, this,s);return  this.h[e+"_"+t]&& this.h[e+"_"+t].forEach(e=>n.o(e[0],e[1],e[2],e[3])),n}r(){const e=~~(60*Math.sin( this.a*P*2)),t=~~(60*Math.cos( this.a*P*2)); this._endChunkId={x:e,z:t}, this._endChunk= this.j(e,t,!0);for(let s=-1;s<=1;++s)for(let n=-1;n<=1;++n) this.j(e+s,t+n,!0);Y(waypointElems[1],`translate3D(${6*(e+.5)*100}px,-70%,${6*(t+.5)*100}px)`)}s(){for(let e in this.g) this.g[e]&&s("s").appendChild( this.g[e].k)}t(){const e=[];for(let e=-(RD+1);e<=RD+1;++e)for(let t=-(RD+1);t<=RD+1;++t) this.j(currentChunk.x+e,currentChunk.z+t);for(let t=-RD;t<=RD;++t)for(let s=-RD;s<=RD;++s){const n= this.j(currentChunk.x+t,currentChunk.z+s);e.push(n),n.j=!0, this.g.includes(n)|| this.g.push(n)}const t=[];for(let n=0;n< this.g.length;++n) if( this.g[n]){const i= this.g[n];e.includes(i)?(i.i||i.p(),s("s").contains(i.k)||(s("s").appendChild(i.k),i.v(!1))):t.push(i)}t.forEach(e=> this.u(e))}u(e){ this.g.includes(e)&&(e.v(!0), this.g.splice( this.g.indexOf(e),1),setTimeout(()=>{s("s").contains(e.k)&&s("s").removeChild(e.k)},400))}}class C{a=[];b=[];c=[];d=0;constructor(e,t,s,n,i,o=!1){ this.e={x:e,z:t}, this.f=s, this.g=n, this.h=i, this.q(),o&& this.r(),e==i._endChunkId.x&&t==i._endChunkId.z&& this.t(), this.i=!1, this.j=!1, this.k=G("container"),Y( this.k,`translate3D(${6* this.e.x*100}px, 0, ${6* this.e.z*100}px)`), this.l=[], this.m={}}p(){ this.s(), this.i=!0}q(){ this.a=[];for(let e=0;e<6;++e){ this.a[e]=[];for(let t=0;t<6;++t){ this.a[e][t]=[];for(let s=0;s<32;++s) this.a[e][t][s]=0}}let e,t;t=Math.abs( this.e.x)%4==1&&Math.abs( this.e.z)%2==1?2:Math.abs( this.e.x)%4==3&&Math.abs( this.e.z)%2==1?3:Math.abs( this.e.x)%2==0&&Math.abs( this.e.z)%2==0?1:0;for(let s=0;s<6;++s)for(let n=0;n<6;++n){const i=(6* this.e.x+s)/40,o=(6* this.e.z+n)/40,r=f(5* this.f(i,o)+18);0==s&&0==n&&(e=r);const a= this.g(i/5,o/5)>-.2?"plains":"desert",l= this.h.k(40*i,40*o),c="plains"==a?l>.5?6:1:2; this.a[s][n][r]=c,1==c&& this.b.push(`${s}|${n}|${r}`);let h=0;l>.75&&(t=4);for(let e=r+1;e<32;++e){ if(h++<4) this.a[s][n][e]=2==c?2:6;else{let r=4; this.f(7*o,7*i)>1-e/70.4&&(r=14+t), this.a[s][n][e]=r}31==e&&( this.a[s][n][e]=7)}"plains"==a&&(s+n)%3==0&&s>0&&s<5&&n>0&&n<5&& this.g(10*( this.e.x+s),10*( this.e.z+n))* this.f(10*( this.e.z+n),10*( this.e.x+s))>.5&&placeStructure( this.a,"tree"+(l>.5?"2":""),r,s,n)} this.f(5* this.e.x,5* this.e.z)* this.f(5* this.e.z,5* this.e.x)>.75&&placeStructure( this.a,"house",e)}r(){for(let e=0;e<6;++e)for(let t=0;t<6;++t)for(let s=0;s<24;++s) this.a[e][t][s]=s<20?0:25}t(){ this._endSlots=[], this._isEndChunk=!0;for(let e=0;e<6;++e)for(let t=0;t<6;++t)for(let s=17;s<20;++s)(1!=e&&4!=e||0!=t&&5!=t)&&(1!=t&&4!=t||0!=e&&5!=e)||18!=s? this.a[e][t][s]=7:( this.a[e][t][s]=0, this._endSlots.push(()=> this.n(e,t,s)))}n(e,t,s){return  this.a[+e]&& this.a[+e][+t]&& this.a[+e][+t][+s]? this.a[+e][+t][+s]:-1==e||-1==t||6==e||6==t? this.h.n(6* this.e.x+e,6* this.e.z+t,s):0}o(e,t,s,n){ if(isPlant( this.n(e,t,s))&& this.m[`${e}|${t}|${s}`]&&( this.m[`${e}|${t}|${s}`].parentElement.removeChild( this.m[`${e}|${t}|${s}`]), this.l[ this.l.indexOf( this.m[`${e}|${t}|${s}`])]=void 0, this.m[`${e}|${t}|${s}`]=void 0,-- this.d),isPlant(n)){const i= this.x(n,e,s,t); this.l.push(i), this.m[`${e}|${t}|${s}`]=i,++ this.d}1== this.n(e,t,s)&&delete this.b[ this.b.indexOf(`${e}|${t}|${s}`)],1==n&& this.b.push(`${e}|${t}|${s}`),26== this.n(e,t,s)&&delete this.c[ this.b.indexOf(`${e}|${t}|${s}`)],26==n&& this.c.push(`${e}|${t}|${s}`), this.a[e][t][s]=n, this.w(), this._isEndChunk&&! this.h.e&& this.u()}u(){for(let e in this._endSlots) if(10!== this._endSlots[e]())return ;completeGame()}v(e){Y( this.k,`translate3D(${6* this.e.x*100}px, ${1e3*!e}px, ${6* this.e.z*100}px)`), this.k.style.transition="transform 400ms",setTimeout(()=>{Y( this.k,`translate3D(${6* this.e.x*100}px, ${1e3*e}px, ${6* this.e.z*100}px)`)})}w(){ this.i&&( this.k.innerHTML="", this.s())}s(){const e= this.k;for(let t=0;t<32;++t){const s= this.y(t,"y");s&&e.appendChild(s)}for(let t=0;t<6;++t){const s= this.y(t,"z");s&&e.appendChild(s)}for(let t=0;t<6;++t){const s= this.y(t,"x");s&&e.appendChild(s)}for(let t in this.l) this.l[t]&&e.appendChild( this.l[t]);return e}x(e,t,s,n){const i=G("face2 block2D");return i.x=t+6* this.e.x,i.y=s,i.z=n+6* this.e.z,i.style.backgroundImage=`url(${bt[e]})`,Y(i,`translate3D(${100*t}px, ${100*s}px, ${100*n+50}px) rotateY(var(--rot))`),i}y(e,t){let s,n,i,[o,r,a,l]=[-1,-1,-1,-1];"y"==t?(n=6,i=6):("z"==t||"x"==t)&&(n=6,i=32);for(let s=0;s<n;++s)for(let n=0;n<i;++n){let i,c,h,d,u,p;"y"==t?(i=s,c=e,h=n,d=s,u=e-1,p=n):"z"==t?(i=s,c=n,h=e,d=s,u=n,p=e-1):"x"==t&&(i=e,c=n,h=s,d=e-1,u=n,p=s);const f= this.n(i,h,c),y= this.n(d,p,u);B(f)&&B(y)||!B(f)&&!B(y)||(-1==o&&(o=s),-1==a&&(a=n),l=Math.max(n,l),r=Math.max(s,r),o=Math.min(s,o),a=Math.min(n,a))} if(o>-1){let n=r-o+1,i=l-a+1;s=G("face2"),s.setAttribute("face-orientation",t),s.style.width=100*n+"px",s.style.height=100*i+"px","y"==t?Y(s,`translate3D(${100*o}px, ${100*e}px, ${100*a}px) rotateX(90deg)`):"z"==t?Y(s,`translate3D(${100*o}px, ${100*a}px, ${100*e}px) rotateX(0deg)`):"x"==t&&Y(s,`translate3D(${100*e}px, ${100*a}px, ${100*o}px) rotateY(-90deg)`);let c="",h="",d="";"y"==t?s.style.filter="brightness(90%)":"z"==t&&(s.style.filter="brightness(80%)");for(let s=o;s<=r;++s)for(let n=a;n<=l;++n){let i,r,l,u,p,f;"y"==t?(i=s,r=e,l=n,u=s,p=e-1,f=n):"z"==t?(i=s,r=n,l=e,u=s,p=n,f=e-1):"x"==t&&(i=e,r=n,l=s,u=e-1,p=n,f=s);const y= this.n(i,l,r),m= this.n(u,f,p); if((!B(y)||!B(m))&&(B(y)||B(m))){""!==c&&(c+=", "),""!==h&&(h+=", "),""!==d&&(d+=", ");const e=B(y)?m:y;let i;const r=bt[e],l=`${100*(s-o)}px ${100*(n-a)}px`;i="string"==typeof r?r:"y"==t?r[0]:r[1],i=i.includes("blob")?i:"textures/"+i,c+=`url(${i})`,h+=l,d+="100px 100px"}}s.style.backgroundImage=c,s.style.backgroundPosition=h,s.style.backgroundSize=d}return s}}function G(e){const t=d.G("div");return t.className=e,t}function placeStructure(e,t,s,n=0,i=0,o="plains"){ if("house"==t){for(let t=0;t<5;++t)for(let n=0;n<6;++n)for(let i=0;i<4;++i)e[t][n][s-i]=0==t||4==t||0==n||5==n||0==i||3==i?11:0;e[0][2][s-1]=e[0][2][s-2]=0,e[3][4][s-1]=12}else if("tree"==t||"tree2"==t)for(let o=0;o<6;++o) if(e[n][i][s-o]=8,"tree"==t)for(let t=0;t<9;++t)o>2&&(4!==t||5==o)&&(e[n+t%3-1][i+~~(t/3)-1][s-o]=13)}function placeTree(e,t,s){for(let n=1;n<6;++n){const i= world.n(e,t,s-n); if(0!==i&&13!==i)return }for(let n=0;n<6;++n){E(e,t,s-n,8);for(let i=0;i<9;++i) if(n>2&&(4!==i||5==n)){const o=e+i%3-1,r=t+~~(i/3)-1,a=s-n;0== world.n(o,a,r)&&E(o,r,a,13)}}}function B(e){return 0==e||isPlant(e)}function isPlant(e){return 26==e||37==e||38==e||39==e||40==e||41==e}const F2=.5*(Math.sqrt(3)-1),G2=(3-Math.sqrt(3))/6,fastFloor=e=>0|f(e),grad2=new Float64Array([1,1,-1,1,1,-1,-1,-1,1,0,-1,0,1,0,-1,0,0,1,0,-1,0,1,0,-1]);function n2(e=Math.random){const t=buildPermutationTable(e),s=new Float64Array(t).map(e=>grad2[e%12*2]),n=new Float64Array(t).map(e=>grad2[e%12*2+1]);return function (e,i){let o=0,r=0,a=0;const l=(e+i)*F2,c=fastFloor(e+l),h=fastFloor(i+l),d=(c+h)*G2,u=e-(c-d),p=i-(h-d);let f,y;u>p?(f=1,y=0):(f=0,y=1);const m=u-f+G2,x=p-y+G2,g=u-1+2*G2,k=p-1+2*G2,v=255&c,D=255&h;let w=.5-u*u-p*p; if(w>=0){const e=v+t[D];w*=w,o=w*w*(s[e]*u+n[e]*p)}let b=.5-m*m-x*x; if(b>=0){const e=v+f+t[D+y];b*=b,r=b*b*(s[e]*m+n[e]*x)}let $=.5-g*g-k*k; if($>=0){const e=v+1+t[D+1];$*=$,a=$*$*(s[e]*g+n[e]*k)}return 70*(o+r+a)}}function buildPermutationTable(e){const t=new Uint8Array(1024);for(let e=0;e<512;e++)t[e]=e;for(let s=0;s<511;s++){const n=s+~~(e()*(256-s)),i=t[s];t[s]=t[n],t[n]=i}for(let e=256;e<1024;e++)t[e]=t[e-256];return t}function createPointer(e="black"){const t=G("container");for(let s=0;s<6;s++){const n=G("face2");n.style.width=n.style.height="102px",n.style.transformOrigin="50% 50%",n.style.boxSizing="border-box",n.style.border="solid 3px "+e,Y(n,s<4?`rotateY(${90*s}deg) translateZ(51px)`:`rotateX(${180*s+90}deg) translateZ(51px)`),t.appendChild(n)}return t}function createPlayerModel(e,t,s,n){const i=G("container"),o=G("container");i.style.setProperty("--hair",t||"#ff3f5a"),i.style.setProperty("--bg",e||"#deac9d"),i.style.setProperty("--skin",s||"#deac9d"),o.style.transformOrigin="50% 25px";for(let e=0;e<6;e++){const t=G("face2 playerFace");t.style.width=t.style.height="50px",t.style.transformOrigin="50% 50%",t.style.border="solid 1px rgba(0,0,0,.5)",t.idp=n,Y(t,e<4?`translate(-50%,-50%) rotateY(${90*e}deg) translateZ(25px)`:`translate(-50%,-50%) rotateX(${180*e+90}deg) translateZ(25px)`),o.appendChild(t)}i.appendChild(o),Y(o,"translateY(-135px)");for(let e=0;e<4;++e){const t=G("face2 playerSide");Y(t,`translate(-50%, -100%) rotateY(${90*e}deg) translateZ(30px) rotateX(12deg)`),t.idp=n,i.appendChild(t)}return o.style.transition=i.style.transition="transform 100ms linear",i.head=o,i.mask=createGasMask(),o.appendChild(i.mask),i.mask.hidden=!0,i}function createGasMask(){const e=G("container u");for(let t=0;t<3;++t){const s=G("face2 maskSide");Y(s,`rotateZ(${120*t}deg) translateY(-8.5px) rotateX(90deg) `),e.appendChild(s)}e.appendChild(G("face2 maskFront"));for(let t=0;t<2;++t){const s=G("face2 maskFilter");Y(s,`translateY(-5px) rotate(${100*t-50}deg) translateY(10px) scale(.9)`),e.appendChild(s)}return Y(e,"translate3D(-15px, 0px,-35px)"),e}let status,T,currentSlot, saveData;function clamp(e,t,s){return Math.max(t,Math.min(e,s))}function useItem(e){ if(consumables.includes(e)){switch(e){case 107:getHp(25);break;case 108:getHp(50);break;case 109:getHp(100);break;case 110:status.c=100}re(e)}}function getHp(e){status.hp=Math.min(status.hp+e,100)}function E(e,t,s,n){"host"==GT&& world.o(e,t,s,n),sendBlockUpdate(e,t,s,n)}function canPlaceBlock(e,t,s){ if(s<0||s>=32)return !1;for(const [n,i]of Object.entries( playersPos)) if(i)for(let n=-1;n<=1;n+=2)for(let o=-1;o<=1;o+=2)for(let r=0;r<=2;r++){const a=posToCords(i.x+pRadius*n,i.z+pRadius*o,i.y+[25,-135,-55][r]); if(a.x==e&&a.z==t&&a.y==s)return !1}return !0}function posToCords(e,t,s){return {x:f(-e/100),z:f(-t/100),y:f(-s/100)}}function sendBlockUpdate(e,t,s,n){bU.push([e,t,s,n]),emit("b",[e,t,s,n])}function receiveBlockUpdate(e){const t=f(e[0]/6),s=f(e[1]/6),n=(e[0]%6+6)%6,i=(e[1]%6+6)%6; world.i(t,s)? world.o(e[0],e[1],e[2],e[3]):( world.h[t+"_"+s]||( world.h[t+"_"+s]=[]), world.h[t+"_"+s].push([n,i,e[2],e[3]])),bU.push(e),"host"==GT&&emit("b",e)}function gameloop(){const e=Date.now(),t=Math.max(prevTime-e,-1e3);prevTime=e;const n=(KeyPressed.KeyA?-1:0)+(KeyPressed.KeyD?1:0),i=(KeyPressed.KeyW?-1:0)+(KeyPressed.KeyS?1:0);KeyPressed.Space&&0==accelerationY&&(accelerationY=2.5);const o=-accelerationY,a=i*t*-Math.sin(D.Y)*movementSpeed+n*t*Math.cos(D.Y)*movementSpeed,l=i*t*Math.cos(D.Y)*movementSpeed+n*t*Math.sin(D.Y)*movementSpeed,c=o*t*movementSpeed;accelerationY+=t/100,accelerationY<-10&&(accelerationY=-10);let h=!1,u=!1,p=!1;F(D.x+a,D.z,D.y)||(h=!0),F(D.x,D.z+l,D.y)||(u=!0),F(D.x,D.z,D.y+c-.01)?accelerationY=0:p=!0,h&&(D.x+=a),u&&(D.z+=l),p&&(D.y+=c),D.y<-3200&&(D.y=0);const y=f(-D.x/100/6),m=f(-D.z/100/6); if(m!==currentChunk.z||y!==currentChunk.x){const e=currentChunk.x-y,t=currentChunk.z-m;currentChunk.x=y,currentChunk.z=m, world.t(e,t)}const x= world.l(-D.x/100,-D.z/100); if(toggleBadVision(~~(4*x)),s("rad").innerHTML=Math.round(100*x)+"% RADIATION<br>"+["LOW","MODERATE","HIGH","EXTREME"][~~(4*x)]+`<br><br>ID: ${SESSION_ID}<br>[F] Toggle Mask<br>[E] Open Inventory`,++iter%5==0&&(raycastResult=raycast(),null!==raycastResult?Y(indicator,`translate3D(${100*raycastResult.x-.5}px, ${100*raycastResult.y-.5}px, ${100*raycastResult.z+50-.5}px)`):Y(indicator,"translateY(3000px)")),null==status.c&&(status.c=100),status.mask&&status.c>0?(status.c=Math.max(0,status.c+t/3e3),s("u").style.setProperty("--q",status.c+"%"),s("hp").style.setProperty("--q",status.hp+"%")):(status.hp+=x*x*(t/200),s("hp").style.setProperty("--q",status.hp+"%"),status.hp<0&&gameOver()),sE-=t,sT-=t,sE>100&&("client"==GT?emit("i",D):emit("g",JSON.stringify( playersPos)),sE=0,T=d.elementsFromPoint(innerWidth/2,innerHeight/2)[1].idp,s("give").hidden=!Boolean(T)),sT>5e3/ world.g.length){sT=0;let e=~~( world.g.length*r());const t= world.g[e];for(let e in t.c) if(t.c[e]){const s=t.c[e].split("|");1==t.n(+s[0],+s[1],+s[2]+1)&&placeTree(+s[0]+6*t.e.x,+s[1]+6*t.e.z,+s[2])}for(let e in t.b) if(t.b[e]){const s=t.b[e],[n,i,o]=s.split("|");!B(t.n(n,i,+o-1))&&r()<.1&&E(+n+6*t.e.x,+i+6*t.e.z,+o,6),B(t.n(n,i,+o-1))&&t.d<1&&r()<.005&&E(+n+6*t.e.x,+i+6*t.e.z,+o-1,[37,39,38,40][~~(4*r())]);for(let e=-1;e<2;++e)for(let s=0;s<2;++s)for(let a=0;a<2;++a){const [l,c,h]=[+n-1+2*s,+i-1+2*a,+o+e];6==t.n(l,c,h)&&B(t.n(l,c,h-1))&& world.l(l+6*t.e.x,c+6*t.e.z)<.25&&r()<.05&&E(l+6*t.e.x,c+6*t.e.z,h,1)}}}[["--x",D.x+"px"],["--y",D.y+"px"],["--z",D.z+"px"],["--X",D.X+"rad"],["--Y",D.Y+"rad"]].forEach(e=>s("c").style.setProperty(e[0],e[1]));const g=(-D.x-50)/100,k=(-D.z-50)/100;for(let e in world.g){const t= world.g[e];for(let e in t.l) if(t.l[e]){const s=t.l[e],n=-Math.atan2(s.z-k,s.x-g)+P/2;t.l[e].style.setProperty("--rot",n+"rad")}}requestAnimationFrame(gameloop)}function F(e,t,s,n=!1){for(let i=-1;i<=1;i+=2)for(let o=-1;o<=1;o+=2)for(let r=0;r<=2;r++){const a= world.m(e+pRadius*i,t+pRadius*o,s+[25,-135,-55][n?1:r]); if(a>0&&!isPlant(a))return !0}return !1}function raycast(){const e={x:-D.x/100,y:-D.y/100,z:-D.z/100};let t=0;const s=Math.cos(D.X)*Math.sin(D.Y)*.1,n=Math.cos(D.X)*-Math.cos(D.Y)*.1,i=.1*-Math.sin(D.X);for(;t<5;){e.x+=s,e.z+=n,e.y+=i,t+=.1;const o={x:f(e.x),z:f(e.z),y:f(e.y)}; if( world.n(o.x,o.z,o.y)>0)return o;raycastPrevious=o}return raycastPrevious=null,null};function hostGame(e){startCommon(),GT="host",on("d",e=>playerJoin(e)), playersPos.host=D, playersData.host={name:pName,color:pColor,hair:pHair,skin:pSkin},status=playersStatus.host={mask:!1,hp:100,c:100},onHostConnect(e)}function joinGame(e){emit("p",e)}function startCommon(){window.pName=s("name").value,window.pColor=s("color").value,window.pHair=s("hair").value,window.pSkin=s("skin").value,removeEventListener("mousemove",previewEvent),clearInterval(previewInterval),s("o").hidden=!1,s("q").hidden=!1,on("n",e=>getResource(e))}function startGame(e){gameStarted=!0,window. world=new W(e),D.x=D.z=10,s("menu").hidden=!0,s("hp").hidden=!1,d.querySelector("#c").requestPointerLock(),lI(e),setTimeout(()=>gameloop())}function joinServer(e){GT="client",on("h",e=>updatePlayerData(e)),on("k",()=>{sI(),alert("The host has left the game"),location.reload()}),onClientConnect(e)}function updatePlayerData(e){for(const [t,s]of Object.entries(e))t!==socket.id&&( playersElem[t]||playerJoin([t,s.name,s.color,s.hair,s.skin]));for(const [t,s]of Object.entries( playersData))e[t]||removePlayer(t)}function onConnectCommon(){on("m",e=>receiveMessage(e[0],e[1])),on("o",()=>completeGame())}function playerJoin(e){const t=e[0]; playersPos[t]={x:0,y:0,z:0,Y:0,X:0}, playersElem[t]=createPlayerModel(e[2],e[3],e[4],t), playersData[t]={color:e[2],name:e[1],hair:e[3],skin:e[4]},s("s").appendChild( playersElem[t]),"host"==GT&&(emit("d", playersData),emit("fs",[t,bU]))}function updateClientPos(e){const t=e[0],s=e[1];Object.assign( playersPos[t],s),Y( playersElem[t],`translateY(135px) translate3D(${-s.x}px, ${-s.y}px, ${-s.z}px) rotateY(${-s.Y}rad)`),Y( playersElem[t].head,`translateY(-135px) rotateX(${-s.X/2}rad)`), playersElem[t].mask.hidden=!s.mask}function onHostConnect(e=-1){-1!=e&& saveData[e]?(currentSlot=e,startGame( saveData[e][0]),setTimeout(()=>rB( saveData[e][1]))):(startGame(),currentSlot= saveData.length, saveData.push([ world.a,[],s("x").value])),emit("a",[SESSION_ID, world.a,0, saveData[currentSlot][2]]),on("i",e=>updateClientPos(e)),on("b",e=>receiveBlockUpdate(e)),on("j",e=>removePlayer(e)),onConnectCommon()}function removePlayer(e){ playersData[e]&&(delete playersData[e],delete playersPos[e], playersElem[e].outerHTML="",delete playersElem[e],"host"==GT&&emit("d", playersData))}function onClientConnect(e){SESSION_ID=e,emit("c",[SESSION_ID,pName,pColor,pHair,pSkin]),on("e",e=>{e&&startGame(e)}),on("g",e=>updateMovement(JSON.parse(e))),on("b",e=>receiveBlockUpdate(e)),on("fs",e=>rB(e)), playersData[socket.id]={name:pName,color:pColor,hair:pHair,skin:pSkin}, playersPos[socket.id]=D,status=playersStatus[socket.id]={mask:!1,hp:100,c:100},onConnectCommon()}function rB(e){e.forEach(e=>receiveBlockUpdate(e))}function updateMovement(e){for(const [t,s]of Object.entries(e))t!==socket.id&& playersElem[t]&&updateClientPos([t,s])}function lockChangeAlert(){d.pointerLockElement!=s("c")?togglePause(!0,inInventory):(s("d").hidden=!0,s("i").hidden=!0,paused=!1,inInventory=!1)}function togglePause(e,t=!1){e?(t?(s("i").hidden=!1,inInventory=!0,d.exitPointerLock()):s("d").hidden=!1,paused=!0,sI(),"host"==GT&&save()):d.querySelector("#c").requestPointerLock()}function toggleInventory(){inInventory?togglePause(!1):(togglePause(!0,!0),uiInCrafting?listRecipes():listInventory())}function initSave(){const e=L.getItem("wwc22"); saveData=e?JSON.parse(e):[]}function save(){const e=[],t=[];for(let s=bU.length-1;s>=lastSaveEnd;--s){const n=bU[s],i=n[0]+"_"+n[1]+"_"+n[2];t[i]||(t[i]=!0,e.push(n))}for(let s= saveData[currentSlot][1].length-1;s>=0;--s){const n= saveData[currentSlot][1][s],i=n[0]+"_"+n[1]+"_"+n[2];t[i]||(t[i]=!0,e.push(n))}lastSaveEnd=Math.max(0,bU.length-1), saveData[currentSlot][1]=e,L.setItem("wwc22",JSON.stringify( saveData))}function sB(e){const t=ie(); if(s("q").hidden=s("r").hidden=t,!t)for(let t=1;t<=I.length;++t){const s=(si+(e?t:-t)+I.length)%I.length; if(he(s))return void cB(s)}}function cB(e){e=+e,onDequip(+si);const t="string"==typeof bt[e]?bt[e]:bt[e][1];s("q").style.setProperty("--img",`url(${t})`),s("r").innerHTML=I[e]?I[e]>1?I[e]:"":0,sb=e,si=e,onEquip(+e)}function onEquip(e){111==e?(s("s").appendChild(waypointElems[0]),Y(waypointElems[0],`translateY(-70%) rotateY(${-Math.atan2(0-D.z,0-D.x)-P/2}rad)`)):112==e&&s("s").appendChild(waypointElems[1])}function onDequip(e){111==e&&s("s").contains(waypointElems[0])&&s("s").removeChild(waypointElems[0]),112==e&&s("s").contains(waypointElems[1])&&s("s").removeChild(waypointElems[1])}let isCoil=!1,gameStarted=!1,D={X:0,Y:0,x:0,y:0,z:0,mask:!1},paused=!1;d.body.onmousemove=e=>{paused||(D.Y+=clamp(e.movementX,-50,50)/500,D.X-=clamp(e.movementY,-50,50)/500,D.X<-P/2?D.X=-P/2:D.X>P/2&&(D.X=P/2))};let KeyPressed={};addEventListener("keydown",e=>{ if(gameStarted){switch(e.code){case"KeyF":toggleMask();break;case"KeyG":shareResource();break;case"KeyE":paused==inInventory&&toggleInventory()}paused||(KeyPressed[e.code]=!0)}}),addEventListener("keyup",e=>KeyPressed[e.code]=!1),addEventListener("mousedown",e=>{ if(!paused) if(3==e.which){const e=raycastPrevious; if(sb>=100&&he(sb))return void useItem(sb); if(null==e)return ;sb<100&&he(sb)&&0== world.n(e.x,e.z,e.y)&&canPlaceBlock(e.x,e.z,e.y)&&(E(e.x,e.z,e.y,sb),re(sb))}else if(2==e.which){const e= world.n(raycastResult.x,raycastResult.z,raycastResult.y);0!==e&&cB(e)}else{const e=raycastResult; if(null==e||e.y<0||e.y>=31||7== world.n(e.x,e.z,e.y))return ;getItem( world.n(e.x,e.z,e.y),!(106==si&&I[si]>0)),"host"==GT&& world.o(e.x,e.z,e.y,0),sendBlockUpdate(e.x,e.z,e.y,0)}});let prevTime=Date.now(),movementSpeed=.35,currentChunk={x:0,z:0},raycastResult=null,raycastPrevious=null,iter=0,sE=0,sT=0,pRadius=30,accelerationY=0,indicator=createPointer();s("s").appendChild(indicator);let playersPos={},playersElem=[],playersData={},playersStatus={},bU=[];d.addEventListener("pointerlockchange",lockChangeAlert,!1);let inInventory=!1,lastSaveEnd=0;addEventListener("wheel",e=>{ if(paused)return;let t;t=e.wheelDelta?e.wheelDelta:-1*e.deltaY,t>0?sB(!0):t<0&&sB(!1)});let si=0,sb=3;function toggleBadVision(e){s("c").style.filter=`sepia(${[.4,.6,.8,1][e]}) saturate(${[1,1.5,2.2,3][e]})`}function toggleMask(e=!inMask){inMask=e,status.mask=D.mask=e,s("u").hidden=!e}function gameOver(){alert("You Died"),D.x=0,D.y=0,D.z=0,status.hp=100,s("hp").style.setProperty("--q",status.hp+"%")}let inMask=!1,UT="Can only be found in zones with 'EXTREME' radiation";const recipes=["Tools",[111,1,[101,10,102,5,103,3],!1,"Shows you the way home"],[110,1,[101,3,2,1,26,1],!1,"Refills your mask with oxygen"],[109,1,[107,2,101,2],!1,"Restores your health"],"Quest",[112,1,[105,10,102,5,104,3],!1,"Shows you where the WFS\u2122 is"],[10,1,[24,1,101,2,5,3],!1,"8 of these batteries can power the World Filtration System\u2122"],"Decorative",[5,5,[8,1]],[25,5,[3,5]],[27,5,[2,10]],[36,5,[25,5,101,5]],[33,4,[25,2,27,2]],[34,4,[33,4,101,4]],[35,4,[33,4,103,2,104,2]],[19,5,[6,5],!0],[28,1,[11,1,20,1],!0],[29,1,[11,1,21,1],!0],[30,1,[11,1,22,1],!0],[31,1,[11,1,23,1],!0],[32,1,[11,1,24,1],!0],"Misc",[20,1,[101,5]],[21,1,[102,5]],[22,1,[103,5]],[23,1,[104,5]],[24,1,[105,5],!1,UT],[101,5,[20,1]],[102,5,[21,1]],[103,5,[22,1]],[104,5,[23,1]],[105,5,[24,1],!1,UT],[41,1,[20,1,21,1,22,1,23,1,24,1]]];function listRecipes(){const e=s("l");e.innerHTML="";for(let t in recipes) if(rec=recipes[t],"string"==typeof rec){const t=d.G("h2");t.innerHTML=rec,e.appendChild(t)}else if(!rec[3]||rec[3]&&isCoil){const s=d.G("button");s.className="item",s.innerHTML=`${bn[rec[0]]} ${rec[1]>1?"x"+rec[1]:""} <img src='${"string"==typeof bt[rec[0]]?bt[rec[0]]:bt[rec[0]][1]}'>`,rec[3]&&(s.style.outline="2px solid red");let n=!0;for(let e=0;e<rec[2].length;e+=2)I[rec[2][e]]&&I[rec[2][e]]>=rec[2][e+1]||(n=!1);s.style.color=n?"black":"gray",e.appendChild(s),s.onclick=()=>selectRecipe(t)}}function listInventory(){const e=s("l");e.innerHTML="";for(let t in I) if(I[t]&&I[t]>0){const s=d.G("button");s.className="item",s.innerHTML=`${bn[t]} ${I[t]>1?"x"+I[t]:""} <img src='${"string"==typeof bt[t]?bt[t]:bt[t][1]}'>`,e.appendChild(s),s.onclick=()=>cB(t),s.ondblclick=()=>{useItem(+t),listInventory()}}}function selectRecipe(e){selectedRecipe=e;const t=recipes[e][2];s("m").innerHTML="";for(let e=0;e<t.length;e+=2){const n=t[e],i=t[e+1],o=`<div class='o' style='background-image: url(${"string"==typeof bt[n]?bt[n]:bt[n][1]})'>${I[n]||0} / ${i}</div>`;s("m").innerHTML+=o}s("n").innerHTML=recipes[e][4]||""}function craftRecipe(e){const t=recipes[e];for(let e=0;e<t[2].length;e+=2) if(!(I[t[2][e]]&&I[t[2][e]]>=t[2][e+1]))return ;for(let e=0;e<t[2].length;e+=2)for(let s=0;s<t[2][e+1];++s)re(t[2][e]);getItem(t[0],!1,t[1]),listRecipes(),selectRecipe(e)}function changeInventory(e){s("l").style.width=e?"300px":"540px",s("m").hidden=!e,s("n").hidden=!e,uiInCrafting=e,e?listRecipes():listInventory()}let isDuck=!1,selectedRecipe=-1,uiInCrafting=!0;d.fonts.onloadingdone=()=>cT();const waypointElems=[G("face2 waypoint"),G("face2 waypoint")];function completeGame(){ world.e||( world.e=!0,emit("o"))}function startCoil(){isCoil=!0,s("v").hidden=s("c2").hidden=!1}function setupPreview(){const e=createPlayerModel("blue"),t=s("preview");t.appendChild(e);const n=t.offsetTop+100,i=t.offsetLeft+100;e.head.style.transition="",window.previewEvent=t=>{const s=(t.clientX-i)/30,o=(t.clientY-n)/20;Y(e.head,`translateY(-135px) rotateX(${o}deg) rotateY(${s}deg)`)},window.addEventListener("mousemove",previewEvent),window.previewInterval=setInterval(()=>{s("c1").onchange(),s("c2").onchange(),s("hair").onchange(),s("skin").onchange(),saveChar()},50),s("c1").onchange=()=>{s("color").value=parseSkin(),e.style.setProperty("--bg",s("color").value)},s("c2").onchange=()=>{s("color").value=parseSkin(),e.style.setProperty("--bg",s("color").value)},s("hair").onchange=()=>e.style.setProperty("--hair",s("hair").value),s("skin").onchange=()=>e.style.setProperty("--skin",s("skin").value)}waypointElems[1].style.setProperty("--c","red"),d.monetization&&d.monetization.addEventListener("monetizationstart",()=>startCoil()),cT(),s("c1").value=s("c2").value="#"+f(16777215*r()).toString(16);let skinMode=0;function parseSkin(e=s("c1").value,t=s("c2").value,n=skinMode){return [e,`linear-gradient(90deg, ${e} 50%,${t} 50%)`,`linear-gradient(${e} 50%,${t} 50%,${t} 60%, ${e} 60%)`,`conic-gradient(${e} 25%,${t} 25%,${t} 50%, ${e} 50%,${e} 75%,${t} 75%,${t} 100%, ${e} 100%)`,`linear-gradient(${e},${t})`][n]}function changeSkinMode(e){skinMode=e,s("c1").onchange()}for(let e=0;e<5;++e)s("v").appendChild(d.G("button")),s("v").querySelectorAll("button")[e].onclick=()=>changeSkinMode(e),s("v").querySelectorAll("button")[e].style.background=parseSkin("#EED","#112",e);function openMenu(e){s("preview").style.display="none",s("y").style.display="none",s("z").hidden=!1,s("butHost").hidden=!e,s("w2").innerHTML="";for(let e in saveData) saveData[e]&&(s("w2").innerHTML+=` <button onclick='hostGame(${e})' class='elem'>${ saveData[e][2]}</button>`);s("x").value="World "+ +( saveData.length+1)}function saveChar(){L.setItem("wwc23",JSON.stringify([s("name").value,s("c1").value,s("c2").value,s("hair").value,s("skin").value,skinMode]))}function loadChar(){const e=L.getItem("wwc23"); if(e){const t=JSON.parse(e);s("name").value=t[0],s("c1").value=t[1],s("c2").value=t[2],s("hair").value=t[3],s("skin").value=t[4],changeSkinMode(t[5])}}setupPreview(),initSave(),window.io&&(window.socket=io({path:location.pathname+'socket.io',upgrade:!1,transports:["websocket"]})),on("p",e=>{e[0]?(startCommon(),joinServer(e[1])):alert("Could not find "+e[1])}),loadChar();for(let e=1;e<=3;++e)s("r"+e).onclick=()=>{RD=e, world.t()};s("r0").onclick=()=>togglePause(!1),s("r5").onclick=()=>location.reload(),s("I1").onclick=()=>togglePause(!1),s("I2").onclick=()=>changeInventory(!0),s("I3").onclick=()=>changeInventory(!1),s("m").onclick=()=>craftRecipe(selectedRecipe),s("m1").onclick=()=>openMenu(!0),s("m4").onclick=()=>joinGame(s("w").value.toUpperCase()),s("m5").onclick=()=>hostGame(-1)</script>
