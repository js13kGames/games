<!doctype html><title>Epic Loot</title><meta name=viewport content="width=device-width,user-scalable=no"><style>*{cursor:default;margin:0;padding:0;-webkit-box-sizing:border-box;box-sizing:border-box}html{font-family:Cochin,Baskerville,Georgia,Times,serif;font-size:62.5%}body{background:#757161;color:#1d0029;font-size:1.6rem}a,a:visited{color:inherit;text-decoration:none}.row{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-direction:row;flex-direction:row}.col{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:vertical;-webkit-box-direction:normal;-ms-flex-direction:column;flex-direction:column}.world{width:32rem;margin:0 auto 1.6rem auto}.quest{height:37.2rem}.ui{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;padding:1rem .5rem}.player{font-size:1.4rem;line-height:1.6rem;font-variant:small-caps;text-transform:capitalize;padding:.5rem .5rem 1rem .5rem}#game-progress{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;margin-bottom:.5rem}.check,.diamond{display:inline-block;width:.6rem;height:.6rem;border:1px solid #1d0029}.diamond{-webkit-transform:rotate(45deg);transform:rotate(45deg)}.diamond.filled{background:#745617}.day .celestial:before{content:'\00263c'}.night .celestial:before{content:'\00263e'}.stats .col+.col,.stats .gem{margin-left:1rem}.stats .stat{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center}#xp-progress{width:0%;display:inline-block;background:#745617;border-radius:.5rem}.experience{-webkit-box-pack:end;-ms-flex-pack:end;justify-content:flex-end;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;margin:0 .5rem 0 1rem}.experience>.points{-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center}.experience>.points>span{margin:0 .5rem}.experience>.levels{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.experience>.levels>.progress{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;border:1px solid #1d0029;margin:0 1rem;height:.84rem;border-radius:.42rem}#narrative{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1}.narrative{min-height:7.25rem}.narrative .button{width:4.8rem;height:4.8rem;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;margin-left:.5rem}#used-items{min-height:4.8rem}.level-up{-ms-flex-pack:distribute;justify-content:space-around;-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;margin-bottom:4rem}.level-up>.row{-ms-flex-pack:distribute;justify-content:space-around}#signpost{-ms-flex-pack:distribute;justify-content:space-around}.sign{position:relative;-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:end;-ms-flex-align:end;align-items:flex-end}.sign .text{padding-left:.5rem;padding-right:2.9rem}.sign .title{display:block}.mini.sign .text{display:none}.sign .gems{position:absolute;right:0;bottom:0}.mini.sign .gems{left:0;right:auto}.mini.sign .gems.gold{display:none}.sign .value{position:absolute;top:-.6rem;right:0;display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;height:2.4rem;width:2.4rem;border:1px solid #1d0029;border-bottom-right-radius:33%;border-top-left-radius:33%;opacity:.8}.mini.sign .value{left:0;right:auto}.mini.sign.loot .value{left:auto;right:0}.day .sign .value{background:#fff;color:#1d0029}.night .sign .value{background:#1d0029;color:#fff}.sign.loot .value{background:#fff;color:#1d0029}.gem{display:inline-block;height:1.2rem;width:1.2rem;border:1px solid #1d0029;border-radius:50%;background:currentColor;-webkit-box-shadow:inset rgba(0,0,0,.5) 0 -1px 3px;box-shadow:inset rgba(0,0,0,.5) 0 -1px 3px}.str{color:#e69f00}.bld{color:#009e73}.qck{color:#f0e442}.int{color:#cc79a7}.wil{color:#d55e00}.chr{color:#0090b2}#gems{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between}.set{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-orient:horizontal;-webkit-box-direction:normal;-ms-flex-flow:row wrap;flex-flow:row wrap;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-ms-flex-line-pack:start;align-content:flex-start;width:4.8rem;height:4.8rem}.box{position:relative;display:inline-block;height:1.4rem;width:1.4rem}.box:nth-child(2n){top:.04rem;left:.04rem}.box:nth-child(3n){top:-.24rem;left:-.24rem}.box:nth-child(4n){top:.14rem;left:.14rem}.box:nth-child(5n){top:-.18rem;left:-.18rem}.box .gem{position:absolute;top:0;left:0}.bag{padding:.5rem}.bag .icon{width:2.4rem;height:2.4rem;max-width:32px;max-height:32px;margin-right:.5rem}.bag .name{-webkit-box-flex:1;-ms-flex-positive:1;flex-grow:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.bag .info{-ms-flex-item-align:end;align-self:flex-end}.bag .value{margin-right:.5rem}.skills{padding:.5rem}.skill{-webkit-box-align:center;-ms-flex-align:center;align-items:center}.check{margin:0 1rem 0 .8rem}.dw .check{background:#745617}.dw #used-items,.dw .narrative,.dw .player-info{-webkit-box-orient:horizontal;-webkit-box-direction:reverse;-ms-flex-direction:row-reverse;flex-direction:row-reverse}.dw .narrative .button{margin:0 1rem 0 0}.dw .experience{margin:0 1rem 0 .5rem}.button{color:#1d0029;border:1px solid currentColor;border-radius:.5rem}.hitbox{display:-webkit-box;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-ms-flex-pack:center;justify-content:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;min-width:4.8rem;min-height:4.8rem}.iconic{font-variant:small-caps;text-transform:capitalize}.flavor::first-letter{float:left;font-size:1.76rem;line-height:1;margin-right:.5rem;padding:.5rem;color:#1d0029;border:4px double currentColor}.flavor .iconic{font-weight:700;font-size:1.8rem;line-height:1.8rem}.hr{-webkit-box-pack:justify;-ms-flex-pack:justify;justify-content:space-between;-webkit-box-align:center;-ms-flex-align:center;align-items:center;border-top:1px solid #1d0029;border-bottom:1px solid #1d0029;height:.3rem;margin:0 .5rem}.hr .diamond{background:#ded5bf}.pickable .d1,.pickable .d2,.pickable .d3,.pickable .d4,.pickable .value,.pickable.button{-webkit-box-shadow:.2rem .2rem .5rem rgba(0,0,0,.3);box-shadow:.2rem .2rem .5rem rgba(0,0,0,.3)}.picked .d1,.picked .d2,.picked .d3,.picked .d4,.picked .value,.picked.button{-webkit-box-shadow:none!important;box-shadow:none!important}.paper{background:#f1e9d2;border:1px solid #1d0029;position:relative;-webkit-box-shadow:0 0 5px rgba(0,0,0,.4),inset 0 0 50px rgba(0,0,0,.3);box-shadow:0 0 5px rgba(0,0,0,.4),inset 0 0 50px rgba(0,0,0,.3)}.paper:after,.paper:before{position:absolute;width:40%;height:10px;content:' ';left:12px;bottom:12px;background:0 0;-webkit-transform:skew(-5deg) rotate(-5deg);transform:skew(-5deg) rotate(-5deg);-webkit-box-shadow:0 6px 12px rgba(0,0,0,.5);box-shadow:0 6px 12px rgba(0,0,0,.5);z-index:-1}.paper:after{left:auto;right:10px;-webkit-transform:skew(5deg) rotate(5deg);transform:skew(5deg) rotate(5deg)}.dice{-webkit-box-align:start;-ms-flex-align:start;align-items:flex-start}.d1,.d2,.d3,.d4{position:relative;display:inline-block;width:2.5rem;height:2.5rem;background:#fff;color:#1d0029;border:1px solid currentColor;opacity:.8}.d1:before,.d2:after,.d2:before,.d3:after,.d3:before,.d4:after,.d4:before{position:absolute;content:' ';display:block;width:.5rem;height:.5rem;background:currentColor;border-radius:50%}.d1:before{top:1rem;left:1rem}.d2:before,.d3:before,.d4:before{top:.375rem;right:.375rem}.d2:after,.d3:after,.d4:after{bottom:.375rem;left:.375rem}.d3:after{-webkit-box-shadow:.55rem -.55rem 0 currentColor;box-shadow:.55rem -.55rem 0 currentColor}.d4:before{-webkit-box-shadow:-1.1rem 0 0 currentColor;box-shadow:-1.1rem 0 0 currentColor}.d4:after{-webkit-box-shadow:1.1rem 0 0 currentColor;box-shadow:1.1rem 0 0 currentColor}.d1{-webkit-transform:rotate(7deg);transform:rotate(7deg)}.d2{-webkit-transform:rotate(-14deg);transform:rotate(-14deg)}.d3{-webkit-transform:rotate(14deg);transform:rotate(14deg)}.d4{-webkit-transform:rotate(-7deg);transform:rotate(-7deg)}.colophon{margin:1.6rem .5rem .8rem .5rem;font-size:1rem;line-height:1rem;color:rgba(0,0,0,.55);text-align:right}.colophon>a:hover{cursor:auto;text-decoration:underline}abbr[title=and]{font-style:italic;text-decoration:none;font-size:110%;cursor:auto;line-height:0;position:relative;vertical-align:baseline}.hidden{display:none!important}.invisible{visibility:hidden!important}.unselectable{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;-khtml-user-select:none;-webkit-touch-callout:none}.icon{display:inline-block;width:4.8rem;height:4.8rem;background:url(sprites.png);background-size:2700%}.pixelated{image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:optimize-contrast;-ms-interpolation-mode:nearest-neighbor;image-rendering:-o-pixelated;image-rendering:pixelated}.mushrooms{background-position:0 0}.rabbit{background-position:3.84615% 0}.arachnid{background-position:7.69231% 0}.bat{background-position:11.53846% 0}.snake{background-position:15.38462% 0}.boar{background-position:19.23077% 0}.scorpion{background-position:23.07692% 0}.octo{background-position:26.92308% 0}.ghost{background-position:30.76923% 0}.eye{background-position:34.61538% 0}.skeleton{background-position:38.46154% 0}.gold{background-position:42.30769% 0}.helmet0{background-position:46.15385% 0}.helmet1{background-position:50% 0}.helmet2{background-position:53.84615% 0}.armour0{background-position:57.69231% 0}.armour1{background-position:61.53846% 0}.armour2{background-position:65.38462% 0}.sword0{background-position:69.23077% 0}.sword1{background-position:73.07692% 0}.sword2{background-position:76.92308% 0}.bow0{background-position:80.76923% 0}.bow1{background-position:84.61538% 0}.staff0{background-position:88.46154% 0}.staff1{background-position:92.30769% 0}.staff2{background-position:96.15385% 0}.bottle0{background-position:100% 0}@media only screen and (min-width:40em){html{font-size:100%}}</style><body class=unselectable><div id=world class="col paper world"><div class="col quest"><div class="col player"><div id=game-progress class=row></div><div class="row player-info"><div class="row stats"><div class=col><span>str</span><span>bld</span><span>qck</span></div><div class=col><span id=stats-str></span><span id=stats-bld></span><span id=stats-qck></span></div><div class=col><span>int</span><span>wil</span><span>chr</span></div><div class=col><span id=stats-int></span><span id=stats-wil></span><span id=stats-chr></span></div></div><div class="col experience"><div class="row points"><span id=xp-points></span>/<span id=xp-needed></span>XP</div><div class="row levels"><span id=this-level></span><span class="row progress"><span id=xp-progress></span></span><span id=next-level></span></div></div><div id=d6 class="hitbox dice"><span class=d2></span><span class=d4></span></div></div></div><div class="row hr"><span class=diamond></span> <span class=diamond></span></div><div class="col ui"><div class="narrative row"><div id=narrative class=flavor></div><div id=button class="hitbox iconic button"></div></div><div id=used-items class=row></div><div id=level-up class="col level-up hidden"><div class=row><div id=level-str></div><div id=level-bld></div><div id=level-qck></div></div><div class=row><div id=level-int></div><div id=level-wil></div><div id=level-chr></div></div></div><div id=signpost class=row><div id=sign1></div><div id=sign2></div></div><div id=gems class=row><div id=gems-str class=set></div><div id=gems-bld class=set></div><div id=gems-qck class=set></div><div id=gems-int class=set></div><div id=gems-wil class=set></div><div id=gems-chr class=set></div></div></div></div><div class="row hr"><span class=diamond></span> <span class=diamond></span></div><div class="col bag"><div class="iconic title">Bag</div><div id=bag class=col></div></div><div class="row hr"><span class=diamond></span> <span class=diamond></span></div><div class="col skills"><div class="iconic title">Skills</div><div class="row skill"><span id=dw><span class=check></span>Dual Wielding</span></div></div><div class="row hr"><span class=diamond></span> <span class=diamond></span></div><div class=colophon>Design <abbr title=and>&</abbr> dev by <a href=//www.frankmitchell.org title="retrofuturist decker and ice cream piggy">Frank Mitchell</a> for <a href=//js13kgames.com/2017/ title="Andrzej Mazur (Enclave Games): HTML5 and JavaScript game development competition in just 13 kB">js13kGames</a>. <a href=https://creativecommons.org/licenses/by-nc-sa/3.0/ title="Creative Commons - Attributeion-NonCommercial-ShareAlike 3.0 Unported">CC BY-NC-SA 3.0</a><br>An epic variation of Mike Richey’s <a href=http://wiki.decktet.com/game:tinker-sailor-soldier-spy title="Mike Richey (The Decktet Wiki): Tinker, Sailor, Soldier, Spy"><em>Tinker, Sailor, Soldier, Spy</em></a>.</div></div><script>const Decktet=function(){const e=Object.prototype.hasOwnProperty,t={str:{value:1,suits:["str"]},bld:{value:1,suits:["bld"]},qck:{value:1,suits:["qck"]},int:{value:1,suits:["int"]},wil:{value:1,suits:["wil"]},chr:{value:1,suits:["chr"]},exc:{value:0,suits:[]},aut:{value:2,suits:["int","wil"]},pai:{value:3,suits:["str","int"]},sav:{value:3,suits:["bld","chr"]},sai:{value:4,suits:["bld","qck"]},sol:{value:5,suits:["int","chr"]},lun:{value:6,suits:["qck","wil"]},pen:{value:6,suits:["str","chr"]},dip:{value:8,suits:["str","wil"]},mer:{value:9,suits:["bld","int"]},wat:{value:10,suits:["int","wil","chr"]},lgt:{value:10,suits:["str","qck","int"]},con:{value:11,suits:["qck","int","wil"]},bar:{value:12,suits:["str"]},hun:{value:12,suits:["wil"]},jou:{value:3,suits:["qck","wil"]},bat:{value:4,suits:["int","chr"]},dis:{value:5,suits:["str","qck"]},mar:{value:6,suits:["bld","int"]},cha:{value:7,suits:["bld","wil"]},bet:{value:8,suits:["int","chr"]},pac:{value:9,suits:["str","wil"]},har:{value:10,suits:["str","bld","wil"]},rit:{value:11,suits:["bld","wil","chr"]},cal:{value:12,suits:["chr"]},win:{value:12,suits:["int"]},ori:{value:2,suits:["bld","qck"]},des:{value:2,suits:["str","chr"]},mou:{value:4,suits:["str","wil"]},for:{value:5,suits:["bld","wil"]},cas:{value:7,suits:["str","int"]},cav:{value:7,suits:["qck","chr"]},mil:{value:8,suits:["bld","qck"]},drk:{value:9,suits:["qck","chr"]},bor:{value:10,suits:["bld","qck","chr"]},isl:{value:11,suits:["str","qck","chr"]},dow:{value:11,suits:["str","bld","int"]},sea:{value:12,suits:["qck"]},end:{value:12,suits:["bld"]}};return{attributes:function(){return["str","bld","qck","int","wil","chr"]},personalities:function(){return["exc","aut","pai","sav","sai","sol","lun","pen","dip","mer","wat","lgt","con","bar","hun"]},events:function(){return["jou","bat","dis","mar","cha","bet","pac","har","rit","cal","win"]},locations:function(){return["ori","des","mou","for","cas","cav","mil","drk","bor","isl","dow","sea","end"]},get:function(n){if(e.call(t,n))return Object.assign({name:n,title:n,text:""},t[n])}}}(),PRNG=function(){function e(){return((n+=n*n|5)>>>32)/t}const t=2**32;let n=Math.floor(Math.random()*t);return{random:e,shuffle:function(t){let n,s,i=t.length;for(;i>0;)s=Math.floor(e()*i),n=t[i-=1],t[i]=t[s],t[s]=n},pick:function(t){return t[Math.floor(e()*t.length)]}}}(),Loot=function(){function e(e){const t=Decktet.get(e);if(!t||t.suits.length<=0||t.value<=0)return{type:"mushrooms",variety:"",title:"mushrooms",article:"some",pronoun:"them"};if(Decktet.locations().indexOf(e)>-1)return{type:"gold",variety:"",title:"some gold",article:"",pronoun:""};let n=t.suits[1];n||(n=t.suits[0]),(!(n={str:"armour",bld:"bow",qck:"staff",int:"sword",wil:"helmet",chr:"helmet"}[n])||t.value<=1)&&(n="bottle");return i.call(d,n)?(d[n]+=1,d[n]%={helmet:3,armour:3,sword:3,bow:2,staff:3,bottle:1}[n]):d[n]=0,{type:n,variety:d[n],article:"a",pronoun:"it"}}function t(){return o.length<=0&&(o=["wonder through the forest","come to a clearing in the forest","halt at a glade in the forest","arrive at a fork in the road"],PRNG.shuffle(o)),o.pop()}function n(){return a.length<=0&&(a=["blinks","growls","hisses","howls","glares"],PRNG.shuffle(a)),a.pop()}function s(s){const i=e(s);if(i.where=t(),i.what=n(),i.how=function(e){const t=Decktet.get(e);if(t){const e={str:"strong",bld:"bold",qck:"quick",int:"intelligent",wil:"wilful",chr:"charming"},n=t.suits.map((t=>e[t]));let s="";for(;n.length>0;){const e=n.shift();e&&(s+=` ${e}`,n.length>1&&(s+=","),1===n.length&&(s+=" and"))}return s.trim()}}(s),i.title)return i;"helmet"===i.type?i.title=function(){c.length<=0&&(c=["coif","helmet","helm"],PRNG.shuffle(c));let e=c.pop();const t=PRNG.pick(["plate","mail","leather",void 0]);return t&&(e=`${t} ${e}`),e}():"armour"===i.type?i.title=function(){l.length<=0&&(l=["brigandine","hauberk","cuirass","plackart"],PRNG.shuffle(l));let e=l.pop();const t=PRNG.pick(["plate","mail","leather",void 0]);return t&&(e=`${t} ${e}`),e}():"bottle"===i.type?i.title=function(){r.length<=0&&(r=["potion","tonic","salve"],PRNG.shuffle(r));let e=r.pop();const t=PRNG.pick(["sticky","noxious","fragrent",void 0]);return t&&(e=`${t} ${e}`),e}():i.title=function(e){let t=e;const n=PRNG.pick(["metal","glass","bone",void 0]);return n&&(t=`${n} ${t}`),t}(i.type);const o=PRNG.pick(["epic","greater","lesser",void 0]);o&&(i.title=`${o} ${i.title}`),"epic"===o&&(i.article="an");const a=PRNG.pick(["healing","casting","shocking","poisoning","burning","freezing","archery","smiting","wondering",void 0]);return a&&(i.title=`${i.title} of ${a}`),i}const i=Object.prototype.hasOwnProperty;let o=[],a=[],c=[],l=[],r=[],u={},d={};return{get:function(e){return i.call(u,e)||(u[e]=s(e)),u[e]},reset:function(){o=[],a=[],c=[],l=[],r=[],u={},d={}}}}(),Personalities=function(){let e=[];return{deal:function(){return e.pop()},remove:function(t){const n=e.indexOf(t);n>-1&&e.splice(n,1)},reset:function(){e=Decktet.personalities(),PRNG.shuffle(e)}}}(),Events=function(){let e=[];return{deal:function(){return e.pop()},size:function(){return e.length},reset:function(){e=Decktet.events(),PRNG.shuffle(e)}}}(),Locations=function(){let e=[],t=[];return{add:function(e){Decktet.locations().indexOf(e)>-1&&t.push(e)},shuffle:function(){e=e.concat(t),t=[],PRNG.shuffle(e)},deal:function(){return e.pop()},size:function(){return e.length+t.length},reset:function(){e=Decktet.locations(),t=[],PRNG.shuffle(e)}}}(),Obstacles=function(){let e,t=1,n=[],s=[],i=[];return{get:function(){let t=i;return e&&(t=[e]),t.map((e=>Object.assign({},e)))},deal:function(){if(i=[],e=void 0,1===t){const e=Personalities.deal(),n=Events.deal();e&&n?i=[e,n]:t=2}if(2===t){let e=Locations.deal();e||(Locations.shuffle(),e=Locations.deal()),e&&i.push(e);let t=Locations.deal();t||(Locations.shuffle(),t=Locations.deal()),t&&i.push(t)}PRNG.shuffle(i),i=i.map((e=>Decktet.get(e)));for(let e=0;e<i.length;e+=1)i[e].value<=0?i[e].title="mushrooms":1===t?(n.length<=0&&(n=["rabbit","arachnid","bat","snake","boar"],PRNG.shuffle(n)),i[e].title=n.pop()):(s.length<=0&&(s=["scorpion","ghost","skeleton","eye","octo"],PRNG.shuffle(s)),i[e].title=s.pop())},pick:function(t){e||i.length<1||(i.length<2?e=i[0]:(i[0].name===t&&(Locations.add(i[1].name),e=i[0]),i[1].name===t&&(Locations.add(i[0].name),e=i[1]),i=[e]))},use:function(t){if(!e)return;const n=Decktet.get(t);if(!n)return;let s=!1;n.suits.forEach((t=>{e.suits.indexOf(t)>-1&&(s=!0)})),s&&(e.value-=n.value,e.value<0&&(e.value=0))},defeated:function(){return e&&e.value<=0},stage:function(){return t},reset:function(){Personalities.reset(),Events.reset(),Locations.reset(),t=1,n=[],s=[],i=[],e=void 0}}}(),Deck=function(){function e(t,n){const s=[];let i,o,a,c;for(i=0;i<t.length;i+=1)if(1===n)s.push([t[i]]);else for(a=e(t.slice(i+1,t.length),n-1),o=0;o<a.length;o+=1)(c=a[o]).unshift(t[i]),s.push(c);return s}const t=[];let n=[],s=[],i=[],o=[],a=!1;return{get:function(){const e=[],t=[].concat(o).reverse();return[].concat(n,s).forEach((t=>{Decktet.attributes().indexOf(t)>-1&&e.push(t)})),{cards:n.length,discards:s.length,attributes:e,bag:t}},empty:function(){return a},shuffle:function(){n=[].concat(n,s,i),s=[],i=[],PRNG.shuffle(n)},deal:function(){const e=n.pop();return e&&s.push(e),e||(a=!0),e},add:function(e){e&&Decktet.locations().indexOf(e)<0&&(i.push(e),o.push(e),Decktet.attributes().indexOf(e)>-1&&(a=!1))},used:function(e){return n.indexOf(e)<0},reset:function(){t.length<=0&&(e(Decktet.personalities(),4).forEach((e=>{let n=[];e.forEach((e=>{const t=Decktet.get(e);n=n.concat(t.suits)})),6===(n=new Set(n)).size&&(PRNG.shuffle(e),t.push(e))})),PRNG.shuffle(t)),n=t.pop(),s=[],i=[],o=[].concat(n,s),a=!1}}}(),Gems=function(){const e=Object.prototype.hasOwnProperty;let t={};return{get:function(){return t},count:function(n){return e.call(t,n)?t[n]:0},spend:function(n){e.call(t,n)&&t[n]>0&&(t[n]-=1)},add:function(n){e.call(t,n)&&t[n]<9&&(t[n]+=1)},max:function(){return 9},reset:function(){t={},Decktet.attributes().forEach((e=>{t[e]=9}))},size:function(){return Object.values(t).reduce(((e,t)=>e+t),0)}}}(),Stage=function(){function e(){Loot.reset(),Obstacles.reset(),Deck.reset(),Gems.reset(),s=[],i="encumbered"}function t(e){const t=e.split("-");if("d6"===e){const e=Decktet.attributes();for(PRNG.shuffle(e),t[0]="gems",t[1]=e.pop();t[1]&&Gems.count(t[1])<=0;)t[1]=e.pop()}if("gems"===t[0]){const e=t[1];if(Gems.count(e)<=0)return this;if(Obstacles.defeated())return this;if(1!==Obstacles.get().length)return this;Gems.spend(e),Obstacles.use(e);let n=Deck.deal();n||(Deck.shuffle(),n=Deck.deal()),Obstacles.use(n),s.push(n)}if("items"===e){if(Obstacles.defeated())return i="loot",this;if(Gems.size()<=0)return i="madness",this}return this}function n(e){if("items"!==e)return this;let t=Obstacles.get();return t.length<1?this:(Deck.add(t[0].name),Obstacles.deal(),t=Obstacles.get(),s=[],t.length<1?(i="victory",this):Deck.empty()?(i="level-up",this):(i="choice",this))}let s=[],i="encumbered";return{get:function(){return i},next:function(s){return"encumbered"===i?function(e){return"d6"===e&&Deck.reset(),"items"===e&&(Deck.get().bag.forEach((e=>{Personalities.remove(e)})),Deck.shuffle(),Obstacles.deal(),i="choice"),this}(s):"choice"===i?function(e){const t=Obstacles.get();if(t.length<1)return this;let n;return"d6"===e&&(n=Math.floor(PRNG.random()*t.length)),"sign1"===e&&(n=0),"sign2"===e&&(n=1),void 0===n||(n>=t.length&&(n=0),Obstacles.pick(t[n].name),i="combat"),this}(s):"combat"===i?t(s):"loot"===i?n(s):"level-up"===i?function(e){const t=e.split("-");if("d6"===e){const e=Decktet.attributes(),n=Math.floor(PRNG.random()*e.length);t[0]="level",t[1]=e[n]}return"level"!==t[0]||Decktet.attributes().indexOf(t[1])<0?this:Deck.empty()?(Gems.add(t[1]),Deck.add(t[1]),i="choice",this):this}(s):("victory"!==i&&"madness"!==i||"items"===s&&e(),this)},items:function(){return[].concat(s)},reset:e}}(),Renderer=function(){function e(e,t,n){let s;if(e){let i="col sign";(n||t)&&(i+=" mini"),t&&(i+=" loot");let o=e.title;t&&(o=`${t.type}${t.variety}`);let a="gems";t&&"gold"===t.type&&(a+=" gold"),s="",s+=`<div class="${i}">`,s+=`<span class="value">${e.value}</span>`,s+='<div class="row">',s+=`<span class="pixelated icon ${o}"></span>`,s+='<span class="text">',s+=`<span class="iconic title">${e.title}</span>`,s+="</span>",s+="</div>",s+=`<div class="row ${a}">`,e.suits.forEach((e=>{s+=`<span class="${e} gem"></span>`})),s+="</div>",s+="</div>"}return s}let t=!0;return{render:function n(){t&&(function(){const e=window.jQuery;Decktet.attributes().forEach((t=>{const n=Gems.max();let s=n-Gems.count(t);s<1&&(s=1),s>n&&(s=n);let i="";i+=`<span class="stat">${s}`,i+=`<span class="${t} gem"></span>`,i+="</span>",e(`#stats-${t}`).html(i.trim())}))}(),function(){const e=window.jQuery,t=Deck.get().bag,n=t.filter((e=>Deck.used(e))),s=t.filter((e=>!Deck.used(e)));let i="";[].concat(s,["end"],n).forEach((e=>{const t=Decktet.get(e),n=Loot.get(e);if(i+='<div class="row item">',i+=`<span class="pixelated icon loot ${n.type}${n.variety}"></span>`,i+=`<span class="name">${n.title}</span>`,"gold"!==n.type){i+='<span class="info">',i+=`<span class="value">${t.value}</span>`,t.suits.forEach((e=>{i+=`<span class="${e} gem"></span>`}));for(let e=t.suits.length;e<3;e+=1)i+='<span class="invisible gem"></span>'}i+="</span>",i+="</div>"})),e("#bag").html(i)}(),function(){const t=window.jQuery;let n,s,i;switch(Stage.get()){case"encumbered":n="",Deck.get().bag.forEach((t=>{s=Decktet.get(t),i=Loot.get(t),s&&i&&(n+=e(s,i,!0))})),t("#used-items").remove("hidden").html(n);break;case"combat":n="",Stage.items().slice(-6).forEach((t=>{s=Decktet.get(t),i=Loot.get(t),s&&i&&(n+=e(s,i,!0))})),t("#used-items").remove("hidden").html(n);break;case"loot":case"victory":case"madness":t("#used-items").remove("hidden").html("");break;default:t("#used-items").add("hidden").html("")}}(),function(){const t=window.jQuery,n=Obstacles.get();let s,i,o,a;switch(Stage.get()){case"encumbered":s='<div class="col sign"></div>';break;case"combat":s=e(n[0],void 0,!1);break;case"choice":s=e(n[0],void 0,!0),i=e(n[1],void 0,!0),1===n.length&&(i=s);break;case"loot":s=e(o=Decktet.get(n[0].name),a=Loot.get(n[0].name),!0)}s||i?t("#signpost").remove("hidden"):t("#signpost").add("hidden"),s?t("#sign1").remove("hidden").html(s):t("#sign1").add("hidden").html(""),i?t("#sign2").remove("hidden").html(i):t("#sign2").add("hidden").html("")}(),function(){const e=window.jQuery,t=Gems.get();"encumbered"===Stage.get()?e("#gems").add("invisible"):e("#gems").remove("invisible"),Object.keys(t).forEach((n=>{let s="";for(let e=0;e<9;e+=1){s+='<span class="box">';let i=!1;(i=(i=(i=(i=(i=(i=(i=(i=(i=i||0===e&&t[n]>=7)||1===e&&t[n]>=6)||2===e&&t[n]>=5)||3===e&&t[n]>=8)||4===e&&t[n]>=1)||5===e&&t[n]>=4)||6===e&&t[n]>=9)||7===e&&t[n]>=2)||8===e&&t[n]>=3)&&(s+=`<span class="${n} gem"></span>`),s+="</span>"}e(`#gems-${n}`).html(s.trim())}))}(),function(){const e=window.jQuery,t=Deck.get(),n=Stage.get();let s=t.discards,i=t.discards+t.cards,o=100*s/i;if(Deck.empty()&&(s="??",i="??",o=100),e("#xp-points").html(s),e("#xp-needed").html(i),e("#this-level").html(t.attributes.length+1),e("#next-level").html(t.attributes.length+2),e("#xp-progress").style("width",`${o}%`),1===Obstacles.stage()?(e("#world").add("day"),e("#world").remove("night")):(e("#world").add("night"),e("#world").remove("day")),"encumbered"===n||"loot"===n){let t='<span class="celestial"></span>',n=0;for(s=(i=Decktet.events().length+Decktet.locations().length)-Events.size()-Locations.size(),n=0;n<s;n+=1)t+='<span class="filled diamond"></span>';for(n=s;n<i;n+=1)t+='<span class="diamond"></span>';e("#game-progress").html(t)}}(),function(){const t=window.jQuery;let n,s,i;"level-up"===Stage.get()?(Decktet.attributes().forEach((o=>{s=Decktet.get(o),i=Loot.get(o),n=e(s,i,!0),t(`#level-${o}`).html(n)})),t("#level-up").remove("hidden"),t("#used-items").add("hidden")):(t("#used-items").remove("hidden"),t("#level-up").add("hidden"))}(),function(){const e=window.jQuery,t=Obstacles.get();let n,s,i="";switch(Stage.get()){case"encumbered":i='You are encumbered! You empty your bag on the ground and pick through the items you&rsquo;ve collected, looking for <span class="iconic">epic loot</span>.';break;case"choice":n=Loot.get(t[0].name),i=1===Obstacles.stage()?`You ${n.where}. Wild animals block your path. You&rsquo;ll have to scare one of them away. Pick an animal or roll the dice.`:`You ${n.where}. Monsters block your path. You&rsquo;ll have to scare one of them away. Pick a monster or roll the dice.`;break;case"combat":(s=Stage.items()).length>0?(i=`You pull ${(n=Loot.get(s.slice(-1)[0])).article} ${n.title} from your bag and throw ${n.pronoun} at the ${t[0].title}, which`,Obstacles.defeated()?i+=" flees.":i+=` ${n.what} at you.`):"mushrooms"===t[0].title?i="You find some mushrooms growing in the forest.":(n=Loot.get(t[0].name),i=`The ${t[0].title} ${n.what} at you.`,n.how&&(i+=` If you are ${n.how}, you may be able to scare it away.`),i+=" Pick a gem or roll the dice.");break;case"loot":i="mushrooms"===(n=Loot.get(t[0].name)).type?"The mushrooms look delicious.":`You find ${n.article} ${n.title}!`;break;case"level-up":i="You have gained in experience. Level up! Pick a bottle or roll the dice.";break;case"victory":i='You are victorious! You heft your bag of <span class="iconic">epic loot</span> and realize&hellip;';break;case"madness":i='The monsters chew a hole in your bag and take some of your <span class="iconic">epic loot</span>. But that&rsquo;s okay. You were starting to feel like&hellip;'}e("#narrative").html(i)}(),function(){const e=window.jQuery;let t;switch(Stage.get()){case"encumbered":case"loot":t="take";break;case"combat":Gems.size()<=0&&(t="flee"),Obstacles.defeated()&&(t="loot");break;case"victory":case"madness":t="rest"}t?e("#button").remove("hidden").html(t):e("#button").add("hidden").html("")}(),function(){const e=window.jQuery,t=new Set(["#button","#d6"]),n=Decktet.attributes().map((e=>`#gems-${e}`)),s=Decktet.attributes().map((e=>`#level-${e}`));switch(Stage.get()){case"choice":t.add("#sign1"),t.add("#sign2");break;case"combat":Obstacles.defeated()||n.forEach((e=>t.add(e)));break;case"level-up":s.forEach((e=>t.add(e)))}const i=new Set(["#d6","#button","#sign1","#sign2"].concat(n,s));t.forEach((t=>{e(t).add("pickable"),i.delete(t)})),i.forEach((t=>{e(t).remove("pickable")}))}(),t=!1),requestAnimationFrame(n)},invalidate:function(){t=!0}}}(),Game=function(){function e(e){e.add("picked")}function t(e){e.remove("picked"),Stage.next(e.unwrap().id),Renderer.invalidate()}function n(e){e.remove("picked"),Stage.next(e.unwrap().id),Renderer.invalidate()}function s(e){e.remove("picked"),Stage.next("items"),Renderer.invalidate()}function i(e){e.remove("picked"),Stage.next(e.unwrap().id),Renderer.invalidate()}function o(){return l.length<=0&&(l=["d1","d2","d3","d4"],PRNG.shuffle(l)),l.pop()}function a(e){let t="";t+=`<span class="${o()}"></span>`,t+=`<span class="${o()}"></span>`,e.html(t).remove("picked"),Stage.next("d6"),Renderer.invalidate()}function c(){(0,window.jQuery)("#world").toggle("dw")}let l=[];return{play:function(){const o=window.jQuery;Decktet.attributes().forEach((s=>{o(`#gems-${s}`).touch(e,t),o(`#level-${s}`).touch(e,n)})),o("#button").touch(e,s),o("#sign1").touch(e,i),o("#sign2").touch(e,i),o("#d6").touch(e,a),o("#dw").touch(void 0,c),Stage.reset(),Renderer.invalidate(),Renderer.render()}}}();!function(){function e(t){return t instanceof e?t:(this.element=t,"string"==typeof t&&0===t.indexOf("#")&&(this.element=document.getElementById(t.slice(1))),this)}e.prototype.html=function(e){return this.element&&(this.element.innerHTML=e),this},e.prototype.add=function(e){return this.element&&this.element.classList&&this.element.classList.add(e),this},e.prototype.remove=function(e){return this.element&&this.element.classList&&this.element.classList.remove(e),this},e.prototype.toggle=function(e){return this.element&&this.element.classList&&this.element.classList.toggle(e),this},e.prototype.style=function(e,t){if(this.element){if(!t)return this.element.style[e];this.element.style[e]=t}return this},e.prototype.touch=function(e,t){const n=this;return this.element&&("ontouchstart"in document.documentElement==0?this.element.onmousedown=function(s){e&&e(n,s),document.onmousemove=function(e){e.preventDefault()},document.onmouseup=function(e){t&&t(n,e),document.onmousemove=void 0,document.onmouseup=void 0}}:this.element.ontouchstart=function(s){e&&e(n,s),document.ontouchmove=function(e){e.preventDefault()},document.ontouchend=function(e){t&&t(n,e),document.ontouchmove=void 0,document.ontouchend=void 0}}),this},e.prototype.unwrap=function(){return this.element},window.jQuery=function(t){return new e(t)}}(),Game.play()</script>