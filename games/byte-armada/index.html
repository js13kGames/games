<title>Byte Armada - js13kGames 2025</title><meta name=viewport content="width=device-width,interactive-widget=resizes-content"><script>function e(e,t){return(t||document.body).appendChild(document.createElement(e))}function t(t,n){e("style").textContent="*{position:fixed;margin:0;padding:0;box-sizing:border-box;touch-action:none;user-select:none;}",document.body.style.background="black";let{floor:i,ceil:o,random:a,PI:r,abs:l,atan2:s,min:c}=Math,d=12,f=c(innerWidth,innerHeight),h=0,u=null,p=[],y=f/5/600,g=e("canvas"),w=g.getContext("2d");g.width=g.height=f,g.addEventListener("pointerdown",e=>{h?(h=0,k(e)):function({clientX:e,clientY:i}){let a=x.entities;a.length>=5||(i=o((f-i)/(f/5)),u?(u.range=i,a.push(u),t&&t.send(JSON.stringify({x:u.x,w:f,range:u.range,speed:u.speed,side:u.side=n,id:u.id=x.id++})),u=null):u=R(e,f,0,-i))}(e)});let m=function(){let e=new AudioContext,t=function(){let t=e.createBuffer(1,1*e.sampleRate,e.sampleRate);return t.getChannelData(0).forEach((e,t,n)=>n[t]=2*a()-1),t}();return{explosion:function(){let n=e.createBufferSource();n.buffer=t;let i=e.createGain();i.gain.value=3;let o=e.createBiquadFilter();o.type="lowpass",o.frequency.value=300,i.gain.linearRampToValueAtTime(0,e.currentTime+1),n.connect(o),o.connect(i),i.connect(e.destination),n.start(0,0,n.buffer.duration),n.onended=function(){n.disconnect(),i.disconnect(),o.disconnect()}}}}(),x={id:0,health:1,speak:"Good job!",entities:[],laser:"blue",hull:A(w,[[0,"white"],[.08,"skyblue"],[.4,"blue"],[.6,"white"]]),shape:P([[0,-10,2,-1,3,1,3,-2,5,-2,5,2,6,2,10,-1,9,5,3,10,3,7,2,6,2,7,0,7],[0,8,2,8,0,10]])},v={health:1,speak:"Try again!",entities:[],laser:"red",hull:A(w,[[0,"white"],[.08,"gold"],[.4,"red"],[.6,"white"]]),shape:P([[0,-1,1,-1,2,4,3,4,4,3,6,2,7,-1,8,-3,8,-7,9,-9,10,-7,10,4,8,7,6,8,3,10,2,7,0,7],[0,9,1,9,0,10]])};function b(){if(p.forEach(clearInterval),p=[],w.clearRect(0,0,f,f),h=1,x.entities=[],v.entities=[],t)return h=0,x.health=v.health=1,void k();w.strokeStyle="white";for(let e=0;e<25;e++){let t=e%5*(f/5),n=i(e/5)*(f/5);w.strokeRect(t,n,f/5,f/5),w.fillStyle="white",w.textAlign="center",w.textBaseline="middle",w.font=f/35+"px monospace",w.fillText(e+1,t+f/10,n+f/10)}x.health?(d++,w.strokeStyle="lime"):w.strokeStyle="red",d>25&&(d=0);let e=(d-1)%5*(f/5),n=i((d-1)/5)*(f/5);w.strokeRect(e,n,f/5,f/5),x.health=v.health=1}function k(e){if(e){let{clientX:t,clientY:n}=e;d=i(5*t/f)+5*i(5*n/f)+1}if(!t){for(let e=0;e<3;e++)T();let e=6e3-5e3/24*(d-1);p.push(setInterval(()=>{T()},e))}p.push(setInterval(S,1e3/30))}function S(){w.clearRect(0,0,f,f),w.drawImage(E,0,0);for(let e of[x,v])e.entities.forEach(e=>{e.y+=e.speed*y});for(let[e,t]of[[x,v],[v,x]])for(let n of e.entities)if(!(n.y>0&&n.y<f)&&(--t.health,t.health<=0))return D(e.speak),void b();if(t)for(let e of[x,v])e.entities.forEach(e=>{e.hp<=0&&t.send(JSON.stringify({...e,delete:!0}))});for(let e of[x,v])e.entities.filter(e=>e.hp<=0||!0===e.delete).forEach(C);for(let e of[x,v])e.entities=e.entities.filter(e=>e.hp>0&&e.y>0&&e.y<f&&!0!==e.delete);for(let e of[x,v])w.strokeStyle=e.hull,e.entities.forEach(t=>{w.save(),w.translate(t.x,t.y),w.rotate(t.angle);let n=f/100*t.hp+5;w.scale(n,n),w.lineWidth=1/n,w.stroke(e.shape),w.restore()});for(let[e,t]of[[x,v],[v,x]])for(let n of e.entities){if(n.cooldown>0){n.cooldown--;continue}n.cooldown=30;let i=null,o=1/0,a=(n.range*(f/5))**2;for(let e of t.entities){let t=e.x-n.x,r=e.y-n.y,l=t*t+r*r;l<=a&&l<o&&(i=e,o=l)}i&&(i.hp-=1/n.range,n.angle=s(i.y-n.y,i.x-n.x)+r/2,w.strokeStyle=e.laser,w.lineWidth=1,w.beginPath(),w.moveTo(n.x,n.y),w.lineTo(i.x,i.y),w.stroke())}}function R(e,t,n,i,o,a,r){return{x:e,y:t,angle:n,speed:i,hp:5/l(i),range:o,side:a,id:r}}function T(){v.entities.push(R(I(f),0,r,I(6,1),I(6,1)))}function C(e){w.save(),w.translate(e.x,e.y),w.fillStyle="gold",w.fill(P([Array.from({length:40},()=>I(40)-20)],1,!1)),w.restore(),m.explosion()}b(),t&&(t.onmessage=({data:e})=>{let t;try{t=JSON.parse(e)}catch{return}let{delete:n,id:i,side:o,x:a,w:l,speed:s,range:c}=t;!0!==n?v.entities.push(R(a/l*f,0,r,-s,c,o,i)):([v,x].flatMap(e=>e.entities).find(e=>e.id===i&&e.side===o)||{}).delete=!0});let E=(()=>{let e=document.createElement("canvas").getContext("2d");e.canvas.width=e.canvas.height=f,e.strokeStyle="rgba(0,255,0,0.1)";for(let t=0;t<25;t++){let n=t%5*(f/5),o=i(t/5)*(f/5);e.strokeRect(n,o,f/5,f/5)}return e.canvas})();function D(e){if(!window.speechSynthesis)return;let t=window.speechSynthesis,n=new SpeechSynthesisUtterance(e);t.speak(n)}function A(e,t,n="radial",i){let o="linear"===n?e.createLinearGradient(...i||[0,f,0,f-50]):e.createRadialGradient(...i||[0,0,0,0,0,1]);return t.forEach(e=>o.addColorStop(...e)),o}function P(e,t=20,n=!0){let i=new Path2D;for(let o of e)for(let e of n?[1,-1]:[1]){i.moveTo(e*o[0]/t,o[1]/t);for(let n=2;n<o.length;n+=2)i.lineTo(e*o[n]/t,o[n+1]/t)}return i}function I(e,t=0){return i(a()*(e-t))+t}}window.onload=()=>{document.body.style.background="white";let n,i,o=e("div");o.style="position:fixed;inset:0;font:16 monospace;display:flex;align-items:center;justify-content:center;text-align:center;user-select:none",o.innerHTML="B y t e<br>A r m a d a<br><br><br><br><br>The controls are non-intuitive<br>Please read the instructions",o.onpointerdown=a=>{a.preventDefault(),i=setTimeout(()=>{n=!0,o.remove(),function(){let n,i,o=null,a=null,r="";const l=e("div");l.style="position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:flex-start;background:black;gap:10px;padding:10px;overflow:auto";const s=e("canvas",l);s.style.width="90vw",s.style.maxWidth="400px",s.style.height="auto";const c=s.getContext("2d"),d=e("video");d.style="display:none",d.autoplay=d.muted=d.playsInline=!0;const f=e("div");function h(e){if(e.includes("\n")){const t=t=>(e.match(t)||[])[1],n=e.split("\n").map(e=>e.trim()),i=n.find(e=>e.startsWith("a=setup:"))||"",o=i.includes("active")?"answer":i.includes("actpass")?"offer":"",a=t(new RegExp("^a=fingerprint:sha-256 (.+)","m"))?.replace(/:/g,""),r=(n.find(e=>e.startsWith("a=candidate:"))||"").slice(12).trim().replace(/\s+/g," "),l=t(new RegExp("^o=- (\\d+)","m")),s=t(new RegExp("^a=ice-ufrag:(.+)","m")),c=t(new RegExp("^a=ice-pwd:(.+)","m"));if(!(o&&l&&s&&c&&a&&r))throw"Invalid SDP";return[o,l,s,c,a,r].join("|")}{const[t,n,i,o,a,r]=e.split("|"),l="offer"===t?"actpass":"active";return["v=0","o=- "+n+" 2 IN IP4 0.0.0.0","s=-","t=0 0","m=application 9 UDP/DTLS/SCTP webrtc-datachannel","a=ice-ufrag:"+i,"a=ice-pwd:"+o,"a=fingerprint:sha-256 "+a.match(/.{2}/g).join(":"),"a=setup:"+l,"a=candidate:"+r,"a=end-of-candidates"].join("\r\n")+"\r\n"}}function u(e){a&&a.remove();let t=Math.min(screen.width,screen.height)<600?Math.round(.7*window.innerWidth):Math.round(192*window.devicePixelRatio),[n,i]=function(e){let t=[],n=(e,n)=>(t[n]??=[])[e]=1,i=[],o=(new TextEncoder).encode(e),a=o.length;for(let e=0;e<a;e++){let t=o[e],n=e+1<a?o[e+1]:0;t>47&&t<58&&n>47&&n<58?(i.push(10*(t-48)+n+82),e++):i.push(t+1)}let r,l,s=i.length,c=6,d=-1,f=1,h=1,u=2,p=[5,7,10,12,14,18,20,24,28,36,42,48,56,68,84,112,144,192,224,272,336,408,496,620],y=Array(70),g=Array(70),w=Array(256),m=Array(255);do{if(++d===p.length)return;c>11*u&&(u=4+u&12),c+=u,a=c*c>>3}while(a-p[d]<s);for(c>27&&(h=2*(c/54|0)+2),a>255&&(f=2*(a>>9)+2),r=p[d],l=c/h,s<a-r&&(i[s++]=129);s<a-r;)i[s++]=(149*s%253+130)%254;for(r/=f,d=1,u=0;u<255;u++)m[u]=d,w[d]=u,d+=d,d>255&&(d^=301);for(y[r]=0,u=1;u<=r;u++)for(d=r-u,y[d]=1;d<r;d++)y[d]=y[d+1]^m[(w[y[d]]+u)%255];for(let e=0;e<f;e++){for(u=0;u<=r;u++)g[u]=0;for(u=e;u<s;u+=f){let e=g[0]^i[u];for(d=0;d<r;d++)g[d]=g[d+1]^(e?m[(w[y[d]]+w[e])%255]:0)}for(u=0;u<r;u++)i[s+e+u*f]=g[u]}for(u=0;u<c+2*h;u+=l+2)for(d=0;d<c+2*h;d++)n(d,u+l+1),!(1&d)&&n(d,u);for(u=0;u<c+2*h;u+=l+2)for(d=0;d<c;d++)n(u,d+2*(d/l|0)+1),1&d&&n(u+l+1,d+2*(d/l|0));r=2;let x=0,v=4,b=[0,0,-1,0,-2,0,0,-1,-1,-1,-2,-1,-1,-2,-2,-2];for(u=0;u<a;){if(v===c-3&&-1===x)y=[c,6-c,c,5-c,c,4-c,c,3-c,c-1,3-c,3,2,2,2,1,2];else if(v!==c+1||1!==x||7&c||6!=(7&c)){if(0===v&&x===c-2&&3&c){u++;continue}if(v<0||x>=c||v>=c||x<0)for(r=-r,v+=2+r/2,x+=2-r/2;v<0||x>=c||v>=c||x<0;)v-=r,x+=r;if(v===c-2&&0===x&&3&c)y=[c-1,3-c,c-1,2-c,c-2,2-c,c-3,2-c,c-4,2-c,0,1,0,0,0,-1];else if(v===c-2&&0===x&&4==(7&c))y=[c-1,5-c,c-1,4-c,c-1,3-c,c-1,2-c,c-2,2-c,0,1,0,0,0,-1];else{if(1===v&&x===c-1&&!(7&c)&&6==(7&c)){u++;continue}y=b}}else y=[c-2,-c,c-3,-c,c-4,-c,c-2,-1-c,c-3,-1-c,c-4,-1-c,c-2,-2,-1,-2];let e=i[u++];for(d=0;e>0;d+=2,e>>=1)if(1&e){let e=x+y[d],t=v+y[d+1];e<0&&(e+=c,t+=4-(c+4&7)),t<0&&(t+=c,e+=4-(c+4&7)),n(e+2*(e/l|0)+1,t+2*(t/l|0)+1)}v-=r,x+=r}for(u=c;3&u;u--)n(u,u);return[t,c+2*h]}(e),o=i+4,r=document.createElement("canvas");r.width=r.height=t;let c=r.getContext("2d"),d=t/o;c.fillStyle="white",c.fillRect(0,0,t,t),c.fillStyle="black";for(let e=0;e<i;e++)for(let t=0;t<i;t++)n[e][t]&&c.fillRect((t+2)*d,(e+2)*d,d,d);l.insertBefore(a=r,s)}function p(e){if(o)for(const e of o.getTracks())e.stop();o=null;for(const e of[...document.body.children])"SCRIPT"!==e.tagName&&e.remove();t(i,e)}f.style="position:fixed;inset:0;display:flex;align-items:center;justify-content:center;font:20px sans-serif;color:white;background:rgba(0,128,0,0.8);z-index:999;opacity:0;transition:opacity 0.3s",f.textContent="SCAN OK!",navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"}}).then(async e=>{o=d.srcObject=e,await d.play();const t=new window.BarcodeDetector({formats:["data_matrix"]}),a=async()=>{s.width=d.videoWidth,s.height=d.videoHeight,c.drawImage(d,0,0,s.width,s.height);let e=(s.width-200)/2,o=(s.height-200)/2;c.strokeStyle="#0f0",c.lineWidth=4,c.strokeRect(e,o,200,200);try{const e=await t.detect(s);e.length&&await async function(e){if(e===r)return;if(r=e,e.length<10)return;f.style.opacity=1,setTimeout(()=>f.style.opacity=0,1e3);const t=e.split("|")[0];"offer"===t?(s.style.display="none",n=new RTCPeerConnection,n.ondatachannel=e=>{i=e.channel,i.onopen=()=>p("b")},await n.setRemoteDescription({type:"offer",sdp:h(e)}),await n.setLocalDescription(await n.createAnswer()),await new Promise(e=>{n.onicecandidate=t=>{t.candidate&&e()}}),u(h(n.localDescription.sdp))):"answer"===t&&await n.setRemoteDescription({type:"answer",sdp:h(e)})}(e[0].rawValue)}catch{}requestAnimationFrame(a)};requestAnimationFrame(a)}),async function(){n=new RTCPeerConnection,i=n.createDataChannel("x"),i.onopen=()=>p("a"),await n.setLocalDescription(await n.createOffer()),await new Promise(e=>{n.onicecandidate=t=>{t.candidate&&e()}}),u(h(n.localDescription.sdp))}()}()},600)},o.onpointerup=e=>{clearTimeout(i),n||(o.remove(),t()),n=!1}}</script>