<!doctype html><meta content="width=device-width" name=viewport><script src=/2024/webxr/aframe.js></script><script type=module>var _e=Object.defineProperty,ve=(e,t,n)=>t in e?_e(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,z=(e,t,n)=>ve(e,"symbol"!=typeof t?t+"":t,n);function S(){}function ce(e){return e()}function ne(){return Object.create(null)}function A(e){e.forEach(ce)}function ue(e){return"function"==typeof e}function J(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let j,V;function ye(e,t){return e===t||(j||(j=document.createElement("a")),j.href=t,e===j.href)}function we(e){return 0===Object.keys(e).length}function g(e,t){e.appendChild(t)}function T(e,t,n){e.insertBefore(t,n||null)}function E(e){e.parentNode&&e.parentNode.removeChild(e)}function $e(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function v(e){return document.createElement(e)}function de(e){return document.createTextNode(e)}function $(){return de(" ")}function fe(){return de("")}function k(e,t,n,o){return e.addEventListener(t,n,o),()=>e.removeEventListener(t,n,o)}function be(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function s(e,t,n){const o=t.toLowerCase();o in e?e[o]="boolean"==typeof e[o]&&""===n||n:t in e?e[t]="boolean"==typeof e[t]&&""===n||n:be(e,t,n)}function xe(e){return Array.from(e.childNodes)}function Se(e,t,{bubbles:n=!1,cancelable:o=!1}={}){return new CustomEvent(e,{detail:t,bubbles:n,cancelable:o})}function P(e){V=e}function he(){if(!V)throw new Error("Function called outside component initialization");return V}function Ee(e){he().$$.on_mount.push(e)}function me(){const e=he();return(t,n,{cancelable:o=!1}={})=>{const i=e.$$.callbacks[t];if(i){const r=Se(t,n,{cancelable:o});return i.slice().forEach((t=>{t.call(e,r)})),!r.defaultPrevented}return!0}}!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const L=[],ie=[];let U=[];const oe=[],Ae=Promise.resolve();let K=!1;function Ce(){K||(K=!0,Ae.then(ge))}function X(e){U.push(e)}const W=new Set;let F=0;function ge(){if(0!==F)return;const e=V;do{try{for(;F<L.length;){const e=L[F];F++,P(e),ke(e.$$)}}catch(e){throw L.length=0,F=0,e}for(P(null),L.length=0,F=0;ie.length;)ie.pop()();for(let e=0;e<U.length;e+=1){const t=U[e];W.has(t)||(W.add(t),t())}U.length=0}while(L.length);for(;oe.length;)oe.pop()();K=!1,W.clear(),P(e)}function ke(e){if(null!==e.fragment){e.update(),A(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(X)}}function Te(e){const t=[],n=[];U.forEach((o=>-1===e.indexOf(o)?t.push(o):n.push(o))),n.forEach((e=>e())),U=t}const G=new Set;let M;function Me(){M={r:0,c:[],p:M}}function Re(){M.r||A(M.c),M=M.p}function I(e,t){e&&e.i&&(G.delete(e),e.i(t))}function H(e,t,n,o){if(e&&e.o){if(G.has(e))return;G.add(e),M.c.push((()=>{G.delete(e),o&&(n&&e.d(1),o())})),e.o(t)}else o&&o()}function D(e){return void 0!==(null==e?void 0:e.length)?e:Array.from(e)}function Be(e,t){e.d(1),t.delete(e.key)}function Oe(e,t,n,o,i,r,s,a,c,l,u,d){let h=e.length,f=r.length,g=h;const m={};for(;g--;)m[e[g].key]=g;const p=[],v=new Map,y=new Map,$=[];for(g=f;g--;){const e=d(i,r,g),o=n(e);let a=s.get(o);a?$.push((()=>a.p(e,t))):(a=l(o,e),a.c()),v.set(o,p[g]=a),o in m&&y.set(o,Math.abs(g-m[o]))}const b=new Set,w=new Set;function x(e){I(e,1),e.m(a,u),s.set(e.key,e),u=e.first,f--}for(;h&&f;){const t=p[f-1],n=e[h-1],o=t.key,i=n.key;t===n?(u=t.first,h--,f--):v.has(i)?!s.has(o)||b.has(o)?x(t):w.has(i)?h--:y.get(o)>y.get(i)?(w.add(o),x(t)):(b.add(i),h--):(c(n,s),h--)}for(;h--;){const t=e[h];v.has(t.key)||c(t,s)}for(;f;)x(p[f-1]);return A($),p}function pe(e){e&&e.c()}function Q(e,t,n){const{fragment:o,after_update:i}=e.$$;o&&o.m(t,n),X((()=>{const t=e.$$.on_mount.map(ce).filter(ue);e.$$.on_destroy?e.$$.on_destroy.push(...t):A(t),e.$$.on_mount=[]})),i.forEach(X)}function Y(e,t){const n=e.$$;null!==n.fragment&&(Te(n.after_update),A(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Fe(e,t){-1===e.$$.dirty[0]&&(L.push(e),Ce(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Z(e,t,n,o,i,r,s=null,a=[-1]){const c=V;P(e);const l=e.$$={fragment:null,ctx:[],props:r,update:S,not_equal:i,bound:ne(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(t.context||(c?c.$$.context:[])),callbacks:ne(),dirty:a,skip_bound:!1,root:t.target||c.$$.root};s&&s(l.root);let u=!1;if(l.ctx=n?n(e,t.props||{},((t,n,...o)=>{const r=o.length?o[0]:n;return l.ctx&&i(l.ctx[t],l.ctx[t]=r)&&(!l.skip_bound&&l.bound[t]&&l.bound[t](r),u&&Fe(e,t)),n})):[],l.update(),u=!0,A(l.before_update),l.fragment=!!o&&o(l.ctx),t.target){if(t.hydrate){const e=xe(t.target);l.fragment&&l.fragment.l(e),e.forEach(E)}else l.fragment&&l.fragment.c();t.intro&&I(e.$$.fragment),Q(e,t.target,t.anchor),ge()}P(c)}class ee{constructor(){z(this,"$$"),z(this,"$$set")}$destroy(){Y(this,1),this.$destroy=S}$on(e,t){if(!ue(t))return S;const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!we(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}const Le="4";function Ue(e,t){let n=e.font.match(/(\d+)px/),o=n?Number(n[1]):10,i=Ie(e),r=o;t.split(/\n/).forEach((t=>{for(;;){let n=Pe(e,t,i,r);if(r+=o,t===n||!(t=n))break}}))}function Ie(e){switch(e.textAlign){case"start":return 0;case"center":return.5*e.canvas.width;case"right":return e.canvas.width}throw new Error("Unknown textAlign: "+e.textAlign)}function Pe(e,t,n,o){let i=e.canvas.width;for(let r=1;r<t.length;++r){let s=t.substr(0,r);if(e.measureText(s).width>i){let i=t.lastIndexOf(" ",r),a=-1===i?r-1:i+1,c=s.substr(0,a);return e.fillText(c,n,o),t.substr(a)}}return e.fillText(t,n,o),null}typeof window<"u"&&(window.__svelte||(window.__svelte={v:new Set})).v.add(Le),AFRAME.registerComponent("canvas-text",{dependencies:["canvas-material"],schema:{text:{type:"string"},font:{type:"string"},strokeStyle:{type:"string"},fillStyle:{type:"string"},textAlign:{type:"string"},textBaseline:{type:"string"},direction:{type:"string"},shadowBlur:{type:"number"},shadowColor:{type:"string"}},update(){let e=this.el.components["canvas-material"],t=e.data.width,n=e.data.height,o=this.ctx;o=e.getContext(),o.clearRect(0,0,t,n),o.font=this.data.font,o.strokeStyle=this.data.strokeStyle,o.fillStyle=this.data.fillStyle,o.textAlign=this.data.textAlign,o.textBaseline=this.data.textBaseline,o.direction=this.data.direction,o.shadowBlur=this.data.shadowBlur,o.shadowColor=this.data.shadowColor,Ue(o,this.data.text),e.updateTexture()}}),AFRAME.registerComponent("canvas-material",{schema:{width:{type:"int",default:200},height:{type:"int",default:200},byId:{type:"boolean",default:!1},id:{type:"string",default:""}},update:function(){this.canvas||(this.canvas=document.createElement("canvas")),this.canvas.width=this.data.width,this.canvas.height=this.data.height;const e=new THREE.CanvasTexture(this.canvas),t=new THREE.MeshStandardMaterial({map:e,transparent:!0,side:AFRAME.THREE.DoubleSide});this.data.byId&&this.data.id?(this.canvas.setAttribute("id",this.data.id),document.body.appendChild(this.canvas),this.el.setAttribute("src",`#${this.data.id}`)):setTimeout((()=>{this.el.object3D.children[0].material=t}),100),this.getContext=()=>this.canvas.getContext("2d"),this.updateTexture=()=>e.needsUpdate=!0}}),AFRAME.registerShader("grid-shader",{schema:{time:{type:"time",is:"uniform"},uvScale:{type:"float",is:"uniform",default:5}},vertexShader:"varying vec2 vUV;uniform float uvScale;void main(){vUV=uv*uvScale;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",fragmentShader:"varying vec2 vUV;uniform float time;void main(){vec3 color1=vec3(1.0,0.0,0.0);vec3 color2=vec3(0.0,0.0,1.0);vec3 color3=vec3(0.0,1.0,0.0);vec3 gridColor;float phase=mod(time*0.0001,3.0);if(phase<1.0){gridColor=mix(color1,color2,phase);}else if(phase<2.0){gridColor=mix(color2,color3,phase-1.0);}else{gridColor=mix(color3,color1,phase-2.0);}float gridWidth=0.05;vec2 grid=fract(vec2(vUV.x,vUV.y+time*0.00005)*10.0)-0.5;float line=min(abs(grid.x),abs(grid.y));float intensity=smoothstep(gridWidth,gridWidth-0.02,line);vec3 color=gridColor*intensity;float alpha=intensity>0.0?0.5:0.0;gl_FragColor=vec4(color,alpha);}"}),AFRAME.registerShader("sun-shader",{schema:{time:{type:"time",is:"uniform"}},vertexShader:"varying vec2 vUV;void main(){vUV=uv;gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.0);}",fragmentShader:"precision mediump float;uniform float time;varying vec2 vUV;void main(){vec2 uv=vUV;vec2 sunCenter=vec2(0.5,0.5);float sunRadius=0.45;vec3 topColor=vec3(1.2,0.9,0.0);vec3 bottomColor=vec3(1.2,0.3,0.4);float dist=length(uv-sunCenter);vec3 color=mix(bottomColor,topColor,smoothstep(0.0,1.0,uv.y));float glowIntensity=smoothstep(sunRadius-0.02,sunRadius,dist);if(dist<sunRadius&&uv.y<0.5){float lineThickness=0.2;float speed=time*0.0001;float lines=mod(uv.y*2.0+speed,0.3);if(step(lineThickness,lines)>0.0){discard;}}if(dist<sunRadius){gl_FragColor=vec4(color,1.0);}else{discard;}}"}),AFRAME.registerComponent("canvas-sky",{init:function(){const e=document.createElement("canvas");e.width=1024,e.height=512;const t=e.getContext("2d"),n=e.width,o=e.height,i=t.createLinearGradient(n/2,0,n/2,o);i.addColorStop(0,"#303461"),i.addColorStop(.3,"#85536E"),i.addColorStop(.6,"#D46A4B"),i.addColorStop(.9,"#EB7337"),t.fillStyle=i,t.fillRect(0,0,n,o);const r=new THREE.CanvasTexture(e);this.el.setAttribute("material","shader","flat"),this.el.setAttribute("material","src",r)}}),AFRAME.registerComponent("mountains",{init:function(){const e=this.el,t=document.createElement("canvas");t.width=1024,t.height=512;const n=t.getContext("2d");["#813945","#7B3647","#753146","#663047"].forEach((e=>{let o=0,i=t.height*(.2*Math.random()+.7);for(n.strokeStyle=e,n.beginPath(),n.moveTo(o,i);o<t.width;){let e=20*Math.random()+50,r=100*(Math.random()-.5);o+=e,i+=r,(i<0||i>t.height)&&(i-=2*r),n.lineTo(o,i)}n.lineTo(t.width,i),n.lineTo(t.width,t.height),n.lineTo(0,t.height),n.lineTo(0,.7*t.height),n.stroke(),n.fillStyle=e,n.fill()}));const o=new THREE.CanvasTexture(t);e.setAttribute("material","src",o)}});const Ve=new URL("pistol.glb",location.href).href;function re(e,t,n){const o=e.slice();return o[5]=t[n],o[7]=n,o}function ae(e,t){let n,o,i,r,a,c,l,u,d;return{key:e,first:null,c(){n=v("a-entity"),o=v("a-gltf-model"),i=v("a-plane"),r=$(),a=v("a-entity"),l=$(),s(i,"position",".17 .04 0"),s(i,"rotation","0 90 0"),s(i,"geometry","primitive: plane; width: .2; height: .2"),s(i,"canvas-material","width:1024; height:1024"),s(i,"canvas-text"," text: 💥; font: 500px sans-serif; textAlign: center; textBaseline: middle; "),s(i,"animation","startEvents: bang; property: scale; to: 1 1 1; dur: 100;"),s(i,"animation__hide","startEvents: hidebang; property: scale; to: 0 0 0; dur: 10;"),s(i,"scale","0 0 0"),s(a,"class","gun-raycaster"),s(a,"raycaster","objects: .target; showLine: true; lineColor:red; far: 40; autoRefresh: true; enabled: true"),s(a,"position","-.05 .07 0"),s(a,"rotation","0 -90 0"),s(o,"position","0 0 0"),s(o,"rotation","0 90 -45"),ye(o.src,c=Ve)||s(o,"src",c),s(n,"oculus-touch-controls",`hand: ${t[0](t[7])}; model: false;`),s(n,"haptics","events: triggerdown; dur: 200; force: 0.5"),this.first=n},m(e,s){T(e,n,s),g(n,o),g(o,i),g(o,r),g(o,a),g(n,l),u||(d=[k(i,"animationcomplete",t[1]),k(n,"triggerdown",t[2]),k(n,"pinchstarted",t[2])],u=!0)},p(e,n){t=e},d(e){e&&E(n),u=!1,A(d)}}}function Ne(e){let t,n=[],o=new Map,i=D(Array(2));const r=e=>e[7];for(let t=0;t<i.length;t+=1){let s=re(e,i,t),a=r(s);o.set(a,n[t]=ae(a,s))}return{c(){for(let e=0;e<n.length;e+=1)n[e].c();t=fe()},m(e,o){for(let t=0;t<n.length;t+=1)n[t]&&n[t].m(e,o);T(e,t,o)},p(e,[s]){7&s&&(i=D(Array(2)),n=Oe(n,s,r,1,e,i,o,t.parentNode,Be,ae,t,re))},i:S,o:S,d(e){e&&E(t);for(let t=0;t<n.length;t+=1)n[t].d(e)}}}function je(e){const t=me();return[e=>0===e?"left":"right",e=>{e.target.emit("hidebang")},e=>{const n=e.target,o=e.target.querySelector(".gun-raycaster");(e=>{e.children[0].children[0].emit("bang")})(n),0!==o.components.raycaster.intersections.length&&(o.components.raycaster.intersections[0].object.el.emit("hit"),t("hit"))}]}class Ge extends ee{constructor(e){super(),Z(this,e,je,Ne,J,{})}}function se(e,t,n){const o=e.slice();return o[9]=t[n],o[11]=n,o}function le(e){let t,n,o,i;return{c(){t=v("a-image"),n=$(),s(t,"position",e[4]()),s(t,"animation",`startEvents: start-animation; property: position; to: ${2*Math.random()-1} 0 ${2*Math.random()}; dur: 5000; easing: linear; loop: false`),s(t,"class",`enemy-${e[11]} target`),s(t,"width","1"),s(t,"height","1"),s(t,"visible","true"),s(t,"canvas-material","width:2048; height:2048"),s(t,"canvas-text","text: 🤖; font: 1300px sans-serif; textAlign: center; textBaseline: middle;")},m(r,s){T(r,t,s),T(r,n,s),o||(i=[k(t,"animationcomplete",e[1]),k(t,"hit",e[2]),k(t,"loaded",e[3])],o=!0)},p:S,d(e){e&&(E(t),E(n)),o=!1,A(i)}}}function He(e){let t,n=D(e[0]),o=[];for(let t=0;t<n.length;t+=1)o[t]=le(se(e,n,t));return{c(){for(let e=0;e<o.length;e+=1)o[e].c();t=fe()},m(e,n){for(let t=0;t<o.length;t+=1)o[t]&&o[t].m(e,n);T(e,t,n)},p(e,[i]){if(30&i){let r;for(n=D(e[0]),r=0;r<n.length;r+=1){const s=se(e,n,r);o[r]?o[r].p(s,i):(o[r]=le(s),o[r].c(),o[r].m(t.parentNode,t))}for(;r<o.length;r+=1)o[r].d(1);o.length=n.length}},i:S,o:S,d(e){e&&E(t),$e(o,e)}}}function De(e){const t=me();let n=[{},{},{},{},{}];function o(e){e.setAttribute("position",r()),e.emit("start-animation")}function i(){n.forEach(((e,t)=>{const n=document.querySelector(`.enemy-${t}`);n&&n.emit("start-animation")}))}const r=()=>`${26*Math.random()-5} -1 ${-100*Math.random()-10}`;return Ee((()=>{i()})),[n,function(e){const n=e.target;t("miss"),o(n)},function(e){const n=e.target;t("hit"),o(n)},i,r]}class qe extends ee{constructor(e){super(),Z(this,e,De,He,J,{})}}function ze(e){let t,n,o,i,r,a;return r=new qe({props:{position:"0 -1 0"}}),r.$on("miss",e[5]),r.$on("hit",e[4]),{c(){t=v("a-entity"),n=v("a-text"),i=$(),pe(r.$$.fragment),s(n,"value",o="Score: "+e[0]),s(n,"align","center"),s(n,"width","4"),s(t,"position","0 3 -4")},m(e,o){T(e,t,o),g(t,n),g(t,i),Q(r,t,null),a=!0},p(e,t){(!a||1&t&&o!==(o="Score: "+e[0]))&&s(n,"value",o)},i(e){a||(I(r.$$.fragment,e),a=!0)},o(e){H(r.$$.fragment,e),a=!1},d(e){e&&E(t),Y(r)}}}function We(e){let t,n,o,i,r,a,c,l,u,d,h;return{c(){t=v("a-entity"),n=v("a-text"),i=$(),r=v("a-entity"),a=v("a-plane"),c=$(),l=v("a-text"),s(n,"value",o=`${e[0]<-10?"Game Over":"Defend yourself!\n13's are coming!"}\n\nScore: ${e[0]}\n\nHigh Score: ${e[1]}`),s(n,"align","center"),s(n,"width","6"),s(n,"position","0 1 0"),s(a,"color","#4CAF50"),s(a,"height","0.3"),s(a,"width","1.5"),s(a,"class","clickable target"),s(a,"position","0 0 0"),s(a,"event-set__enter","_event: mouseenter; color: #45a049"),s(a,"event-set__leave","_event: mouseleave; color: #4CAF50"),s(l,"value",u=e[0]<-10?"Restart Game":"Shoot to Start"),s(l,"align","center"),s(l,"position","0 0 0.01"),s(l,"width","4"),s(r,"position","0 -0.5 0"),s(t,"position","0 1.5 -4")},m(o,s){T(o,t,s),g(t,n),g(t,i),g(t,r),g(r,a),g(r,c),g(r,l),d||(h=[k(a,"click",e[3]),k(a,"hit",e[3])],d=!0)},p(e,t){3&t&&o!==(o=`${e[0]<-10?"Game Over":"Defend yourself!\n13's are coming!"}\n\nScore: ${e[0]}\n\nHigh Score: ${e[1]}`)&&s(n,"value",o),1&t&&u!==(u=e[0]<-10?"Restart Game":"Shoot to Start")&&s(l,"value",u)},i:S,o:S,d(e){e&&E(t),d=!1,A(h)}}}function Ke(e){let t,n,o,i,r,a,c,l,u,d,h,f,m,p;d=new Ge({}),d.$on("hit",e[4]);const y=[We,ze],b=[];function w(e,t){return e[2]?1:0}return f=w(e),m=b[f]=y[f](e),{c(){t=v("a-scene"),n=v("a-image"),o=$(),i=v("a-plane"),r=$(),a=v("a-image"),c=$(),l=v("a-sky"),u=$(),pe(d.$$.fragment),h=$(),m.c(),s(n,"mountains",""),s(n,"width","35"),s(n,"height","2"),s(n,"position","0 0.8 -45"),s(n,"scale","3 3 3"),s(i,"scale","35 35 35"),s(i,"material","shader: sun-shader;"),s(i,"position","0 19 -100"),s(a,"material","shader: grid-shader;"),s(a,"width","40"),s(a,"height","40"),s(a,"position","0 -1 -10"),s(a,"rotation","90 180 0"),s(l,"canvas-sky",""),s(l,"segments-width","8"),s(l,"segments-height","16"),s(t,"cursor","rayOrigin: mouse"),s(t,"raycaster","objects: .clickable"),s(t,"fog","type: exponential; density: 0.001")},m(e,s){T(e,t,s),g(t,n),g(t,o),g(t,i),g(t,r),g(t,a),g(t,c),g(t,l),g(t,u),Q(d,t,null),g(t,h),b[f].m(t,null),p=!0},p(e,[n]){let o=f;f=w(e),f===o?b[f].p(e,n):(Me(),H(b[o],1,1,(()=>{b[o]=null})),Re(),m=b[f],m?m.p(e,n):(m=b[f]=y[f](e),m.c()),I(m,1),m.m(t,null))},i(e){p||(I(d.$$.fragment,e),I(m),p=!0)},o(e){H(d.$$.fragment,e),H(m),p=!1},d(e){e&&E(t),Y(d),b[f].d()}}}function Xe(e,t,n){let o=0,i=localStorage.getItem("highScore")||0,r=!1;function s(){r&&o>i&&(n(1,i=o),localStorage.setItem("highScore",i)),n(0,o=0),n(2,r=!r)}function a(){o<-10&&s()}return[o,i,r,s,function(){n(0,o+=10),a()},function(){n(0,o-=5),a()}]}class Je extends ee{constructor(e){super(),Z(this,e,Xe,Ke,J,{})}}new Je({target:document.getElementById("app")})</script><div id=app style=height:100%;width:100%></div>