<!doctype html><title>Black Hat // Black Cat - js13kGames 2025</title><meta name=viewport content="width=device-width,minimum-scale=1"><style>:root{--green-700:#00ff00;--color-text-primary:var(--green-700)}body,html{margin:0;background:#000;color:var(--color-text-primary);font-family:monospace;font-size:16px;overflow:hidden}*{font-family:monospace}body:before{content:"";position:absolute;width:100%;height:100%;background:repeating-linear-gradient(to bottom,#00ff001a,#00ff001a 1px,#0000001a 1px 3px);pointer-events:none;z-index:100}#terminal{white-space:pre-wrap;padding:1em;line-height:1.5;animation:flicker .15s infinite alternate}#inputLine:after{content:"_";animation:blink 1s infinite step-start}#status{position:absolute;top:0;right:0;padding:.5em;color:red;font-size:14px}.flash{animation:flashBg .15s}@keyframes blink{50%{opacity:0}}@keyframes flicker{0%{opacity:1}to{opacity:.98}}@keyframes flashBg{0%{background-color:#8b0000}to{background-color:#000}}#wavyCanvas{position:absolute;top:30%;transform:translate(-50%,-50%);left:50%;width:100%;min-width:500px;max-width:800px;pointer-events:none;image-rendering:pixelated;background-color:transparent}#notes-canvas{position:absolute;top:0;left:50%;transform:translate(-50%);max-width:100%;height:100%;pointer-events:none;image-rendering:pixelated;background-color:transparent}#ascii-cat{position:absolute;top:60%;transform:translate(-70%,-50%);left:50%;pointer-events:none;user-select:none;font-size:clamp(16px,2vw,25px)}.container{max-width:400px;margin:0 auto;text-align:center;position:absolute;top:40%;left:50%;transform:translate(-50%,-50%)}button{display:block;width:100%;padding:10px;margin:5px 0;font-size:16px;cursor:pointer;background-color:transparent;color:var(--color-text-primary);border:2px solid var(--green-700)}button:active,button:hover{background-color:var(--green-700);color:#000}.tempo-list{margin-top:20px}#level-state-ui{font-family:monospace}</style><canvas id=notes-canvas></canvas><div id=terminal></div><div id=status></div><div id=ascii-cat></div><script>var t=new(window.AudioContext||window.webkitAudioContext),e=60/110,i=t.createGain();function r(e,r,n="sine",s=t.currentTime,a=.3){let o=t.createOscillator(),h=t.createGain();o.type=n,o.frequency.setValueAtTime(e,s),h.gain.setValueAtTime(0,s),h.gain.linearRampToValueAtTime(a,s+.01),h.gain.exponentialRampToValueAtTime(.001,s+r),o.connect(h).connect(i),o.start(s),o.stop(s+r)}function n(t){r(100,.5,"sine",t,.8)}function s(e){let r=t.createBufferSource(),n=t.createBuffer(1,.2*t.sampleRate,t.sampleRate),s=n.getChannelData(0);for(let t=0;t<s.length;t++)s[t]=2*Math.random()-1;r.buffer=n;let a=t.createGain();a.gain.setValueAtTime(.4,e),a.gain.exponentialRampToValueAtTime(.01,e+.2);let o=t.createBiquadFilter();o.type="highpass",o.frequency.setValueAtTime(1e3,e),r.connect(o).connect(a).connect(i),r.start(e),r.stop(e+.2)}function a(e){let r=t.createBufferSource(),n=t.createBuffer(1,.05*t.sampleRate,t.sampleRate),s=n.getChannelData(0);for(let t=0;t<s.length;t++)s[t]=2*Math.random()-1;r.buffer=n;let a=t.createGain();a.gain.setValueAtTime(.15,e),a.gain.exponentialRampToValueAtTime(.01,e+.05);let o=t.createBiquadFilter();o.type="highpass",o.frequency.setValueAtTime(5e3,e),r.connect(o).connect(a).connect(i),r.start(e),r.stop(e+.05)}i.connect(t.destination);var o=[55,65,73,82],h=[220,247,220,262,0,220,196,0],l=0,u=0,c=!1;function m(){for(;l<t.currentTime+.1;){u%8==0&&n(l),u%8==4&&s(l),u%2==0&&a(l),u%2==0&&r(o[u/2%o.length],.4,"sawtooth",l,.3);let t=h[u%h.length];t&&r(t,.2,"square",l,.15),l+=e/2,u++}c||requestAnimationFrame(m)}var d=class t{static packs={instrument:{},rhythm:{},tuning:{}};static signatureToNoteLengthRatio={2:6,4:3,8:4.5};audioContext;masterVolume;instruments=[];player=null;pitches;notes;masterVolumeLevel=1;beatsPerBar=4;noteGetsBeat=3;tempo=.5;totalDuration=0;currentSeconds=0;percentageComplete=0;noteBufferLength=20;onTickerCallback=()=>{};onFinishedCallback=()=>{};onDurationChangeCallback=()=>{};constructor(e="equalTemperament",i="northAmerican"){if(typeof t.packs.tuning[e]>"u")throw new Error(`${e} is not a valid tuning pack.`);if(typeof t.packs.rhythm[i]>"u")throw new Error(`${i} is not a valid rhythm pack.`);this.audioContext=new AudioContext,this.masterVolume=this.audioContext.createGain(),this.masterVolume.connect(this.audioContext.destination),this.pitches=t.packs.tuning[e],this.notes=t.packs.rhythm[i],this.setMasterVolume(1),this.setTempo(120),this.setTimeSignature(4,4)}load(t){if(this.instruments.length>0&&this.destroy(),!t)throw new Error("JSON is required for this method to work.");if(!t.instruments||0===Object.keys(t.instruments).length)throw new Error("You must define at least one instrument.");if(!t.notes||0===Object.keys(t.notes).length)throw new Error("You must define notes for each instrument.");t.timeSignature&&this.setTimeSignature(t.timeSignature[0],t.timeSignature[1]),t.tempo&&this.setTempo(t.tempo);let e={};for(let i in t.instruments)if(Object.prototype.hasOwnProperty.call(t.instruments,i)){let r=t.instruments[i];e[i]=this.createInstrument(r.name,r.pack)}for(let i in t.notes)if(Object.prototype.hasOwnProperty.call(t.notes,i)){let r=e[i];if(!r){console.warn(`Notes defined for unknown instrument alias: ${i}`);continue}let n=t.notes[i];for(let t of n)if("string"==typeof t){let e=t.split("|"),i=e[0],n=e[1],s=e[2];"rest"===n?r.rest(i):r.note(i,n,"true"===s||"tie"===s)}else"rest"===t.type?r.rest(t.rhythm):"note"===t.type&&r.note(t.rhythm,t.pitch||[],t.tie)}return this.finish()}createInstrument(t,e){let i=new class{conductor;name;pack;lastRepeatCount=0;volumeLevel=1;articulationGapPercentage=.05;totalDuration=0;bufferPosition=0;instrument;notes=[];getPackName(){return this.pack}constructor(t,e,i){if(!i)throw new Error("Conductor instance is required to create an Instrument.");this.conductor=i,this.name=t||"sine",this.pack=e||"oscillators";let r=d.getInstrumentPack(this.pack);if(!r)throw new Error(`${this.pack} is not a currently loaded Instrument Pack or failed to retrieve.`);this.instrument=r(this.name,this.conductor.audioContext)}getDuration(t){if(typeof this.conductor.notes[t]>"u")throw new Error(`${t} is not a correct rhythm.`);return this.conductor.notes[t]*this.conductor.tempo/this.conductor.noteGetsBeat*10}clone(t){return null===t||"object"!=typeof t?t:{...t}}setVolume(t){let e=t;return t>1&&t<=100&&(e=t/100),this.volumeLevel=Math.max(0,Math.min(1,e)),this}note(t,e,i){let r=this.getDuration(t),n=i?0:r*this.articulationGapPercentage,s=e;if(e){let t="string"==typeof e?e.split(",").map(t=>t.trim()):Array.isArray(e)?e.map(t=>"string"==typeof t?t.trim():t):[e];if("noises"===this.pack)s=1===t.length?t[0]:t;else{let e=[...t];for(let t=0;t<e.length;t++){let i=e[t];if("string"==typeof i&&typeof this.conductor.pitches[i]>"u"){let r=Number.parseFloat(i);if(Number.isNaN(r)||r<0)throw new Error(`Pitch "${i}" is not a valid named pitch or frequency.`);e[t]=r}}s=1===e.length?e[0]:e}}return this.notes.push({rhythm:t,pitch:s,duration:r,articulationGap:n,tie:i,startTime:this.totalDuration,stopTime:this.totalDuration+r-n,volumeLevel:this.volumeLevel/4}),this.totalDuration+=r,this}rest(t){let e=this.getDuration(t);return this.notes.push({rhythm:t,pitch:!1,duration:e,articulationGap:0,startTime:this.totalDuration,stopTime:this.totalDuration+e}),this.totalDuration+=e,this}repeatStart(){return this.lastRepeatCount=this.notes.length,this}repeatFromBeginning(t=1){return this.lastRepeatCount=0,this.repeat(t),this}repeat(t=1){let e=this.notes.slice(this.lastRepeatCount);for(let i=0;i<t;i++)for(let t=0;t<e.length;t++){let i=e[t],r=this.clone(i);r.startTime=this.totalDuration,r.stopTime=this.totalDuration+r.duration-r.articulationGap,this.notes.push(r),this.totalDuration+=r.duration}return this}resetDuration(){this.totalDuration=0;for(let t=0;t<this.notes.length;t++){let e=this.notes[t],i=this.getDuration(e.rhythm),r=e.tie?0:i*this.articulationGapPercentage;e.duration=i,e.startTime=this.totalDuration,e.stopTime=this.totalDuration+i-r,!1!==e.pitch&&(e.articulationGap=r),this.totalDuration+=i}}}(t,e,this);return this.instruments.push(i),i}finish(){return this.player=new class{conductor;bufferTimeout;allNotes;currentPlayTime=0;totalPlayTime=0;faded=!1;paused=!1;playing=!1;looping=!1;muted=!1;constructor(t){this.conductor=t,this.allNotes=this.bufferNotes(),this.calculateTotalDuration(),this.getCurrentPlayTime=()=>this.currentPlayTime,this.getTotalPlayTime=()=>this.totalPlayTime,this.getTimeOffset=()=>this.conductor.audioContext.currentTime-this.totalPlayTime}reset(t=!1){let e=-1,i=this.conductor.instruments.length;for(;++e<i;){let i=this.conductor.instruments[e];t?(i.resetDuration(),i.bufferPosition=0):i.bufferPosition=this.findBufferPositionForTime(i,this.totalPlayTime)}for(t&&(this.calculateTotalDuration(),this.totalPlayTime=this.conductor.percentageComplete*this.conductor.totalDuration),e=-1;++e<this.allNotes.length;)this.allNotes[e]?.gain&&this.allNotes[e].gain.disconnect();clearTimeout(this.bufferTimeout),this.allNotes=this.bufferNotes()}findBufferPositionForTime(t,e){for(let i=0;i<t.notes.length;i++){let r=t.notes[i];if(r&&r.stopTime>e)return i}return t.notes.length}fade(t,e,i=!1){this.faded="down"===t,"up"===t?(this.conductor.masterVolume.gain.linearRampToValueAtTime(0,this.conductor.audioContext.currentTime),this.conductor.masterVolume.gain.linearRampToValueAtTime(this.conductor.masterVolumeLevel,this.conductor.audioContext.currentTime+.2)):(this.conductor.masterVolume.gain.linearRampToValueAtTime(this.conductor.masterVolumeLevel,this.conductor.audioContext.currentTime),this.conductor.masterVolume.gain.linearRampToValueAtTime(0,this.conductor.audioContext.currentTime+.2)),setTimeout(()=>{"function"==typeof e&&e.call(this),i&&(this.faded=!this.faded,this.conductor.masterVolume.gain.linearRampToValueAtTime(this.conductor.masterVolumeLevel,this.conductor.audioContext.currentTime))},200)}calculateTotalDuration(){let t=-1,e=0;for(;++t<this.conductor.instruments.length;){let i=this.conductor.instruments[t];i.totalDuration>e&&(e=i.totalDuration)}this.conductor.totalDuration=e}bufferNotes(){let t=[],e=-1,i=this.conductor.noteBufferLength;for(;++e<this.conductor.instruments.length;){let r=this.conductor.instruments[e],n=i,s=-1;for(;++s<n;){let e=r.notes[r.bufferPosition+s];if(typeof e>"u")break;let{pitch:i,startTime:a,stopTime:o,volumeLevel:h,tie:l}=e,u="number"==typeof h?h:1;if(o<=this.totalPlayTime){n++;continue}if(!1===i)continue;let c,m=this.conductor.audioContext.createGain();if(m.connect(this.conductor.masterVolume),m.gain.value=u,"noises"!==r.getPackName()&&void 0!==i){let t=Array.isArray(i)?i[0]:i;c="string"==typeof t?this.conductor.pitches[t.trim()]||Number.parseFloat(t):t,Number.isNaN(c)&&(c=void 0)}let d=r.instrument.createNote(m,c);t.push({startTime:a,stopTime:o,node:d,gain:m,volumeLevel:u,tie:l}),Array.isArray(i)&&i.slice(1).forEach(e=>{let i,n=this.conductor.audioContext.createGain();n.connect(this.conductor.masterVolume),n.gain.value=u,i="string"==typeof e?this.conductor.pitches[e.trim()]||Number.parseFloat(e):e;let s=r.instrument.createNote(n,i);t.push({startTime:a,stopTime:o,node:s,gain:n,volumeLevel:u,tie:!0})})}r.bufferPosition+=n}return t}totalPlayTimeCalculator(){!this.paused&&this.playing&&(this.conductor.totalDuration<this.totalPlayTime?(this.stop(!1),this.looping?this.play():this.conductor.onFinishedCallback()):(this.updateTotalPlayTime(),setTimeout(()=>this.totalPlayTimeCalculator(),1e3/60)))}updateTotalPlayTime(){this.totalPlayTime+=this.conductor.audioContext.currentTime-this.currentPlayTime;let t=Math.round(this.totalPlayTime);t!==this.conductor.currentSeconds&&(setTimeout(()=>{this.conductor.onTickerCallback(t)},1),this.conductor.currentSeconds=t),this.conductor.percentageComplete=this.totalPlayTime/this.conductor.totalDuration,this.currentPlayTime=this.conductor.audioContext.currentTime}play(){this.playing=!0,this.paused=!1,this.currentPlayTime=this.conductor.audioContext.currentTime,this.totalPlayTimeCalculator(),this.conductor.audioContext.currentTime,this.totalPlayTime;let t=t=>{let e=-1;for(;++e<t.length;){let i=t[e],{startTime:r,stopTime:n}=i;if(!i.tie){r>0&&(r-=.001),n+=.001;let t="number"==typeof i.volumeLevel?i.volumeLevel:1;i.gain.gain.setValueAtTime(0,r),i.gain.gain.linearRampToValueAtTime(t,r+.001),i.gain.gain.setValueAtTime(t,i.stopTime-.001),i.gain.gain.linearRampToValueAtTime(0,i.stopTime),i.node.frequency&&i.node.frequency.value}let s,a=i.startTime,o=i.stopTime,h=o-a,l=0;if(a<this.totalPlayTime){if(o<=this.totalPlayTime)continue;s=this.conductor.audioContext.currentTime,l=this.totalPlayTime-a}else s=this.conductor.audioContext.currentTime+(a-this.totalPlayTime),l=0;if(s<this.conductor.audioContext.currentTime){let t=this.conductor.audioContext.currentTime-s;s=this.conductor.audioContext.currentTime,"buffer"in i.node&&null!==i.node.buffer&&(l+=t)}let u=h-l;if(u<=0)continue;let c=s+u;if(i.node&&"function"==typeof i.node.start)try{"buffer"in i.node&&null!==i.node.buffer?i.node.start(s,l):i.node.start(s),i.node.stop(c)}catch(t){console.error("Error scheduling note:",{noteStartTime:a,noteStopTime:o,totalPlayTime:this.totalPlayTime,scheduleTime:s,playOffset:l,remainingDuration:u,audioCurrentTime:this.conductor.audioContext.currentTime,error:t})}}},e=()=>{this.bufferTimeout=setTimeout(()=>{if(this.playing&&!this.paused){let i=this.bufferNotes();i.length>0&&(t(i),this.allNotes=this.allNotes.concat(i),e())}},5e3*this.conductor.tempo)};t(this.allNotes),e(),this.faded&&!this.muted&&this.fade("up")}stop(t=!0){this.playing=!1,this.conductor.currentSeconds=0,this.conductor.percentageComplete=0,t&&!this.muted?this.fade("down",()=>{this.totalPlayTime=0,this.reset(),setTimeout(()=>{this.conductor.onTickerCallback(this.conductor.currentSeconds)},1)},!0):(this.totalPlayTime=0,this.reset(),setTimeout(()=>{this.conductor.onTickerCallback(this.conductor.currentSeconds)},1))}pause(){this.paused=!0,this.updateTotalPlayTime(),this.muted?this.reset():this.fade("down",()=>{this.reset()})}loop(t){this.looping=t}setTime(t){this.totalPlayTime="string"==typeof t?Number.parseInt(t):t,this.reset(),this.playing&&!this.paused&&this.play()}resetTempo(){this.reset(!0),this.playing&&!this.paused&&this.play()}mute(t){this.muted=!0,this.fade("down",t)}unmute(t){this.muted=!1,this.fade("up",t)}}(this),this.player}destroy(){this.audioContext?.close&&this.audioContext.close().catch(t=>console.error("Error closing AudioContext:",t)),this.audioContext=new AudioContext,this.masterVolume=this.audioContext.createGain(),this.masterVolume.connect(this.audioContext.destination),this.instruments=[],this.totalDuration=0,this.currentSeconds=0,this.percentageComplete=0,this.player,this.player=null}setMasterVolume(t){this.masterVolumeLevel=Math.max(0,Math.min(1,t)),this.masterVolume?.gain&&this.masterVolume.gain.setValueAtTime(this.masterVolumeLevel,this.audioContext.currentTime)}getTotalSeconds(){return Math.round(this.totalDuration)}setTickerCallback(t){if("function"!=typeof t)throw new Error("Ticker must be a function.");this.onTickerCallback=t}setTimeSignature(e,i){if(typeof t.signatureToNoteLengthRatio[i]>"u")throw new Error(`The bottom time signature (${i}) is not supported.`);this.beatsPerBar=e,this.noteGetsBeat=t.signatureToNoteLengthRatio[i]}setTempo(t){this.tempo=60/t,this.player&&(this.player.resetTempo(),this.onDurationChangeCallback())}setOnFinishedCallback(t){if("function"!=typeof t)throw new Error("onFinished callback must be a function.");this.onFinishedCallback=t}setOnDurationChangeCallback(t){if("function"!=typeof t)throw new Error("onDurationChanged callback must be a function.");this.onDurationChangeCallback=t}setNoteBufferLength(t){this.noteBufferLength=t}static getInstrumentPack(e){if(Object.prototype.hasOwnProperty.call(t.packs.instrument,e))return t.packs.instrument[e]}static loadPack(e,i,r){if(-1===["tuning","rhythm","instrument"].indexOf(e))throw new Error(`${e} is not a valid Pack Type.`);if(!Object.prototype.hasOwnProperty.call(t.packs[e],i))switch(e){case"tuning":t.packs.tuning[i]=r;break;case"rhythm":t.packs.rhythm[i]=r;break;case"instrument":if("function"!=typeof r)throw new Error(`Invalid data provided for instrument pack "${i}". Expected a function.`);t.packs.instrument[i]=r}}};d.loadPack("tuning","equalTemperament",{C0:16.35,"C#0":17.32,Db0:17.32,D0:18.35,"D#0":19.45,Eb0:19.45,E0:20.6,F0:21.83,"F#0":23.12,Gb0:23.12,G0:24.5,"G#0":25.96,Ab0:25.96,A0:27.5,"A#0":29.14,Bb0:29.14,B0:30.87,C1:32.7,"C#1":34.65,Db1:34.65,D1:36.71,"D#1":38.89,Eb1:38.89,E1:41.2,F1:43.65,"F#1":46.25,Gb1:46.25,G1:49,"G#1":51.91,Ab1:51.91,A1:55,"A#1":58.27,Bb1:58.27,B1:61.74,C2:65.41,"C#2":69.3,Db2:69.3,D2:73.42,"D#2":77.78,Eb2:77.78,E2:82.41,F2:87.31,"F#2":92.5,Gb2:92.5,G2:98,"G#2":103.83,Ab2:103.83,A2:110,"A#2":116.54,Bb2:116.54,B2:123.47,C3:130.81,"C#3":138.59,Db3:138.59,D3:146.83,"D#3":155.56,Eb3:155.56,E3:164.81,F3:174.61,"F#3":185,Gb3:185,G3:196,"G#3":207.65,Ab3:207.65,A3:220,"A#3":233.08,Bb3:233.08,B3:246.94,C4:261.63,"C#4":277.18,Db4:277.18,D4:293.66,"D#4":311.13,Eb4:311.13,E4:329.63,F4:349.23,"F#4":369.99,Gb4:369.99,G4:392,"G#4":415.3,Ab4:415.3,A4:440,"A#4":466.16,Bb4:466.16,B4:493.88,C5:523.25,"C#5":554.37,Db5:554.37,D5:587.33,"D#5":622.25,Eb5:622.25,E5:659.26,F5:698.46,"F#5":739.99,Gb5:739.99,G5:783.99,"G#5":830.61,Ab5:830.61,A5:880,"A#5":932.33,Bb5:932.33,B5:987.77,C6:1046.5,"C#6":1108.73,Db6:1108.73,D6:1174.66,"D#6":1244.51,Eb6:1244.51,E6:1318.51,F6:1396.91,"F#6":1479.98,Gb6:1479.98,G6:1567.98,"G#6":1661.22,Ab6:1661.22,A6:1760,"A#6":1864.66,Bb6:1864.66,B6:1975.53,C7:2093,"C#7":2217.46,Db7:2217.46,D7:2349.32,"D#7":2489.02,Eb7:2489.02,E7:2637.02,F7:2793.83,"F#7":2959.96,Gb7:2959.96,G7:3135.96,"G#7":3322.44,Ab7:3322.44,A7:3520,"A#7":3729.31,Bb7:3729.31,B7:3951.07,C8:4186.01}),d.loadPack("rhythm","northAmerican",{whole:1,dottedHalf:.75,half:.5,dottedQuarter:.375,tripletHalf:.33333334,quarter:.25,dottedEighth:.1875,tripletQuarter:.166666667,eighth:.125,dottedSixteenth:.09375,tripletEighth:.083333333,sixteenth:.0625,tripletSixteenth:.041666667,thirtySecond:.03125}),d.loadPack("instrument","oscillators",function(t,e){if(!function(t){return["sine","square","sawtooth","triangle"].includes(t)}(t))throw new Error(`Invalid oscillator name: "${t}". Must be one of 'sine', 'square', 'sawtooth', 'triangle'.`);return{createNote:(i,r)=>{let n=e.createOscillator();return n.connect(i),n.type=t,"number"==typeof r&&(n.frequency.value=r),n}}}),d.loadPack("instrument","noises",function(t,e){if(!function(t){return["white","pink","brown","brownian","red"].includes(t)}(t))throw new Error(`Invalid noise type: "${t}". Must be one of 'white', 'pink', 'brown', 'brownian', 'red'.`);return{createNote:(i,r)=>{switch(t){case"white":return function(t,e){let i=2*t.sampleRate,r=t.createBuffer(1,i,t.sampleRate),n=r.getChannelData(0);for(let t=0;t<i;t++)n[t]=2*Math.random()-1;let s=t.createBufferSource();return s.buffer=r,s.loop=!0,s.connect(e),s}(e,i);case"pink":return function(t,e){let i=2*t.sampleRate,r=t.createBuffer(1,i,t.sampleRate),n=r.getChannelData(0),s=0,a=0,o=0,h=0,l=0,u=0,c=0;for(let t=0;t<i;t++){let e=2*Math.random()-1;s=.99886*s+.0555179*e,a=.99332*a+.0750759*e,o=.969*o+.153852*e,h=.8665*h+.3104856*e,l=.55*l+.5329522*e,u=-.7616*u-.016898*e,n[t]=s+a+o+h+l+u+c+.5362*e,n[t]*=.11,c=.115926*e}let m=t.createBufferSource();return m.buffer=r,m.loop=!0,m.connect(e),m}(e,i);case"brown":case"brownian":case"red":return function(t,e){let i=2*t.sampleRate,r=t.createBuffer(1,i,t.sampleRate),n=r.getChannelData(0),s=0;for(let t=0;t<i;t++){let e=2*Math.random()-1;n[t]=(s+.02*e)/1.02,s=n[t],n[t]*=3.5}let a=t.createBufferSource();return a.buffer=r,a.loop=!0,a.connect(e),a}(e,i)}}}});var p=["purr","whisker","tail","furball","napStack","yarn","paw","scratch","meow","claw","hiss"],g=["connect","init","push","log","deploy","encrypt","chase","splice","compile","attack","trace"],f=["'mouse'","'laser'","'bed'","'intruder'","'fish'","'data'","'firewall'","'sock'","'admin'"];new(window.AudioContext||window.webkitAudioContext),document.addEventListener("keydown",function(t){});var b={};document.addEventListener("keydown",t=>{(t=>{b[t]||(b[t]={}),!b[t].down&&(b[t].justUp=!1,b[t].down=!0,b[t].justDown=!0,setTimeout(()=>{b[t].justDown=!1},0))})(t.key)}),document.addEventListener("keyup",t=>{(t=>{b[t]&&(b[t].justUp=!0,b[t].down=!1,b[t].justDown=!1,setTimeout(()=>{b[t].justUp=!1},0))})(t.key)});var T,y,C=b,A=class{canvas;ctx;text;animationFrameId=null;offset=0;yOffset;constructor(t,e){let i=document.createElement("canvas");i.id="wavyCanvas",document.body.appendChild(i),this.canvas=i,this.ctx=i.getContext("2d"),this.text=t,this.yOffset=e,this.canvas.width=800,this.canvas.height=400,this.animate()}drawText(){let{ctx:t,canvas:e,text:i,offset:r}=this;t.clearRect(0,0,e.width,e.height),t.font="30px monospace",t.textAlign="center",t.fillStyle="#00ff00";let n=e.width/2,s=e.height/2+this.yOffset;for(let e=0;e<i.length;e++){let a=i[e],o=n-20*i.length/2+20*e,h=s+10*Math.sin(.5*(e+r));t.fillText(a,o,h)}}animate=()=>{this.offset+=.1,this.drawText(),this.animationFrameId=requestAnimationFrame(this.animate)};stop(){this.animationFrameId&&cancelAnimationFrame(this.animationFrameId)}destroy(){this.canvas.remove()}},w={hits:0,misses:0,total:0},v=null,q=(t,e)=>{T=new A(t.name,0),y=function(){let t=0,e=document.querySelector("#ascii-cat"),i=setInterval(()=>{0===t||2===t?(t++,e.innerHTML="<pre>\n    _______\n  _/_______\\_\n    (     )\n   _ >   < _\n    <     >\n    --------\n       ||\n       ||\n       ||\n</pre>"):1===t?(t++,e.innerHTML="<pre>\n    _______\n  _/_______\\_\n    (     )\n   _ >   < /\n    <     >\n    --------\n      //\n      \\\\//\n\n</pre>"):(t=0,e.innerHTML="<pre>\n    _______\n  _/_______\\_\n    (     )\n   \\ >   < _\n    <     >\n    --------\n       \\\\\n     \\\\//\n\n</pre>")},500);return()=>{clearInterval(i),e.innerHTML=""}}(),w={hits:0,misses:0,total:t.conductor.instruments[3].notes.filter(t=>t.pitch&&(t.pitch.includes("A1")||t.pitch.includes("B1")||t.pitch.includes("C1")||t.pitch.includes("D1"))).reduce((t,e)=>t+(Array.isArray(e.pitch)?e.pitch.length:1),0)},t.conductor.setOnFinishedCallback(()=>(console.log("end level"),v?.destroy(),v=null,y?.(),T?.destroy(),T=null,y=null,void function(t,e){let{hits:i,misses:r,total:n}=e,s="o_O",a=i/n*100;0===r?s="A+":a>=90?s="A":a>=80?s="B":a>=70?s="C":a>=60?s="D":a>=50?s="F":a>=30&&(s="F-");let o=document.createElement("div");o.id="level-state-ui",o.style.position="fixed",o.style.top="0",o.style.left="0",o.style.width="100%",o.style.height="100%",o.style.display="flex",o.style.flexDirection="column",o.style.justifyContent="center",o.style.alignItems="center",o.style.color="var(--green-700)",o.style.fontSize="24px",o.style.zIndex="1000",o.innerHTML=`\n    <div style="text-align: center;">\n      <p>Level Complete!</p>\n      <p>Hits: ${i}</p>\n      <p>Misses: ${r}</p>\n      <p>Grade: ${s}</p>\n      <button id="close-level-state-ui" style="padding: 10px 20px; font-size: 18px;">Close</button>\n    </div>\n  `,document.body.appendChild(o),document.getElementById("close-level-state-ui")?.addEventListener("click",()=>{document.body.removeChild(o),D()})}(0,w))),console.log("start song",w),t.conductor.setTempo(e),t.player.resetTempo(),v=new class{canvas;ctx;columns;columnWidth;items;songStartTime;songElapsedTime;itemHeight;speed;song;activeHits;activeMisses;constructor(t=4,e=100){let i=document.createElement("canvas");i.id="notes-canvas",i.width=800,i.height=600,document.body.appendChild(i),this.canvas=i,this.ctx=i.getContext("2d"),this.columns=t,this.columnWidth=this.canvas.width/this.columns,this.items=[],this.songStartTime=0,this.songElapsedTime=0,this.itemHeight=14,this.speed=e,this.activeHits={0:0,1:0,2:0,3:0},this.activeMisses={0:0,1:0,2:0,3:0}}start(t,e){this.song=e,this.songStartTime=t,this.songElapsedTime=0,this.items=[],this.clearCanvas()}addItem(t,e,i){if(e<0||e>=this.columns)throw new Error(`Invalid column: ${e}. Must be between 0 and ${this.columns-1}.`);this.items.push({text:t,column:e,startTime:i})}update(t){this.songElapsedTime=t-this.songStartTime,this.clearCanvas(),this.renderItems(),this.renderLines()}clearCanvas(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height)}renderItems(){this.items.forEach(t=>{let e=this.songElapsedTime-1e3*t.startTime;if(e>=-2e4){let i=t.column*this.columnWidth+this.columnWidth/2,r=e*this.speed+this.canvas.height-50;r<this.canvas.height&&this.drawText(t.text,i,r)}})}getItemY(t){return(this.songElapsedTime-1e3*t.startTime)*this.speed+this.canvas.height-50}renderLines(){this.ctx.strokeStyle="rgba(0, 255, 0, 1)",this.ctx.fillStyle="rgba(0, 255, 0, 1)";let t=["A","S","D","F"];this.ctx.fillText(`${t[0]}:/`,15,this.canvas.height-50);for(let e=1;e<this.columns;e++){let i=e*this.columnWidth;this.ctx.beginPath(),this.ctx.moveTo(i,0),this.ctx.lineTo(i,this.canvas.height),this.ctx.stroke(),this.ctx.fillText(`${t[e]}:/`,i+15,this.canvas.height-50)}this.ctx.beginPath(),this.ctx.moveTo(0,this.canvas.height-70),this.ctx.lineTo(this.canvas.width,this.canvas.height-70),this.ctx.stroke(),this.ctx.beginPath(),this.ctx.moveTo(0,this.canvas.height-30),this.ctx.lineTo(this.canvas.width,this.canvas.height-30),this.ctx.stroke();for(let t=0;t<this.columns;t++)if(this.activeHits[t]>0){let e=t*this.columnWidth;this.ctx.fillStyle="rgba(0, 255, 0, 0.5)",this.ctx.fillRect(e,0,this.columnWidth,this.canvas.height),this.activeHits[t]--}for(let t=0;t<this.columns;t++)if(this.activeMisses[t]>0){let e=t*this.columnWidth;this.ctx.fillStyle="rgba(255, 0, 0, 0.5)",this.ctx.fillRect(e,0,this.columnWidth,this.canvas.height),this.activeMisses[t]--}}drawText(t,e,i){this.ctx.font=`${this.itemHeight}px Arial`,this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle="rgba(0, 255, 0, 1)",this.ctx.fillText(t,e,i)}destroy(){this.canvas.remove()}hitColumn(t){console.log("hit column"),this.activeHits[t]=5}missColumn(t){console.log("miss column"),this.activeMisses[t]=5}}(4,.4),v.start(performance.now(),t);let i=t=>{switch(t){case"A1":return 0;case"B1":return 1;case"C1":return 2;case"D1":return 3;default:return-1}},r=[],n=t=>{!t.pitch||-1===i(t.pitch)||(v?.addItem(function(){let t=p[Math.floor(Math.random()*p.length)],e=g[Math.floor(Math.random()*g.length)];return Math.random()<.5?`${t}.${e}(${f[Math.floor(Math.random()*f.length)]})`:`${t}.${e}()`}(),i(t.pitch),t.startTime),t.column=i(t.pitch),r.push(t))};t.conductor.instruments[3].notes.forEach(t=>{Array.isArray(t.pitch)?t.pitch.forEach(e=>n({...t,pitch:e})):n(t)}),function t(){v&&(v.update(performance.now()),C.a?.justDown&&(console.log("a check"),r.forEach(t=>{0===t.column&&x(t)})),C.s?.justDown&&(console.log("s check"),r.forEach(t=>{1===t.column&&x(t)})),C.d?.justDown&&(console.log("s check"),r.forEach(t=>{2===t.column&&x(t)})),C.f?.justDown&&(console.log("s check"),r.forEach(t=>{3===t.column&&x(t)})),r.forEach(t=>{!t.hit&&!t.miss&&(v?.getItemY(t)??0)>(v?.canvas?.height??900)&&(w.misses++,t.miss=!0,console.log("MISS Out of bounds",t.column,w),v?.missColumn(t.column))}),requestAnimationFrame(t))}(),t.player.play()};function x(t){let e=v?.getItemY(t)??0,i=(v?.canvas?.height??800)-30,r=(v?.canvas?.height??800)-70;e<i&&e>r&&!t.hit&&!t.miss&&(w.hits++,t.hit=!0,console.log("HIT",t.column,w),v?.hitColumn(t.column)),e<i+50&&e>r-50&&!t.hit&&!t.miss&&(w.misses++,t.miss=!0,console.log("MISS",t.column,w),v?.missColumn(t.column))}var k=[{name:"Basic Baps",tempos:[60,80,100],factory:()=>{let t=["quarter|D5","quarter|D5","quarter|rest","quarter|D5","quarter|F5","quarter|D5","quarter|rest","quarter|D5","quarter|D5","quarter|D5","quarter|rest","quarter|D5","quarter|C5","quarter|D5","quarter|rest","quarter|D5"],e="quarter|A1",i="quarter|B1",r="quarter|C1",n="quarter|D1",s=[e,"quarter|rest","quarter|rest","quarter|rest",r,"quarter|rest","quarter|rest","quarter|rest",n,"quarter|rest","quarter|rest","quarter|rest",i,"quarter|rest","quarter|rest","quarter|rest"];s.push(e,"quarter|rest",n,"quarter|rest",r,"quarter|rest",i,"quarter|rest",n,"quarter|rest",e,"quarter|rest",i,"quarter|rest",r,"quarter|rest");let a=["quarter|D5","quarter|rest","quarter|rest","quarter|rest","quarter|F5","quarter|rest","quarter|rest","quarter|rest","quarter|E5","quarter|rest","quarter|rest","quarter|rest","quarter|C5","quarter|rest","quarter|rest","quarter|rest"];a.push("quarter|D5","quarter|rest","quarter|D5","quarter|rest","quarter|F5","quarter|rest","quarter|F5","quarter|rest","quarter|E5","quarter|rest","quarter|E5","quarter|rest","quarter|C5","quarter|rest","quarter|C5","quarter|rest");let o=["quarter","quarter|rest"],h=[],l=[],u=[],c=[],m=[];new Array(5).fill(0).forEach(()=>h.push(...t)),new Array(8).fill(0).forEach(()=>l.push("quarter|rest")),new Array(4).fill(0).forEach(()=>u.push(...s)),new Array(4).fill(0).forEach(()=>c.push(...a)),new Array(4).fill(0).forEach(()=>m.push(...o));let p={timeSignature:[2,2],tempo:104,instruments:{leftHand:{name:"triangle",pack:"oscillators"},rightHand:{name:"square",pack:"oscillators"},drum:{name:"white",pack:"noises"},arrows:{name:"square",pack:"oscillators"}},notes:{leftHand:[...l,...h],rightHand:[...l,...c],drum:[...m],arrows:[...l,...u]}},g=new d,f=g.load(p);return g.instruments[3].notes.forEach(t=>t.volumeLevel=0),f.resetTempo(),{conductor:g,player:f,arrowInstrumentIndex:3}}},{name:"Catnip",tempos:[70,90,110],factory:()=>{let t="whole|Ab4,C5,D#5",e="whole|Bb4,C#5,F5",i="whole|Db4,F4,G#4",r=["whole|rest",t,e,t,i,t,e,t,i,t,i,t,i,t,i,t,i],n="eighth|A1",s="eighth|B1",a="eighth|C1",o="eighth|D1",h=["whole|rest",n,"eighth|Ab5",o,"eighth|Ab5",n,"eighth|Ab5",a,"eighth|rest",o,"eighth|Ab5",n,"eighth|Ab5",o,"eighth|Ab5",a,"eighth|rest",o,"eighth|rest",n,"eighth|rest",o,"eighth|rest",a,"eighth|rest",s,"eighth|rest","eighth|rest","eighth|A1,B1","eighth|rest","eighth|rest","eighth|C1,D1","eighth|rest"];h.push(n,"eighth|Ab5",o,"eighth|Ab5",n,"eighth|Ab5",a,"eighth|rest",o,"eighth|Ab5",n,"eighth|Ab5",o,"eighth|Ab5",a,"eighth|rest",o,"eighth|rest",n,"eighth|rest",o,"eighth|rest",a,"eighth|rest",s,"eighth|rest",a,"eighth|C6",s,"eighth|C6",o,"eighth|Ab5",n,"eighth|Ab5",n,"eighth|rest",o,"eighth|rest",a,"eighth|rest",n,"eighth|rest",a,"eighth|C6",s,"eighth|C6",o,"eighth|Ab5",n,"eighth|Ab5",n,"eighth|rest",o,"eighth|rest",a,"eighth|rest",n,"eighth|rest",a,"eighth|C6",s,"eighth|C6",o,"eighth|Ab5",n,"eighth|Ab5",n,"eighth|rest",o,"eighth|rest",a,"eighth|rest",n,"eighth|rest",a,"eighth|C6",s,"eighth|C6",o,"eighth|Ab5",n,"eighth|Ab5",n,"eighth|rest",s);let l={timeSignature:[4,4],tempo:84,instruments:{leftHand:{name:"triangle",pack:"oscillators"},rightHand:{name:"square",pack:"oscillators"},drum:{name:"white",pack:"noises"},arrows:{name:"pink",pack:"noises"}},notes:{leftHand:[...r],rightHand:["quarter|C6","quarter|Ab5","quarter|F5","quarter|Eb5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","quarter|C6","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","quarter|C6","quarter|C6","quarter|Bb5","quarter|Ab5","eighth|F5","quarter|Eb5","eighth|rest","quarter|Bb5","quarter|rest","quarter|D#6","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","quarter|C6","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","eighth|Ab5","quarter|C6","quarter|C6","quarter|Ab5","eighth|C6","quarter|C6","quarter|Ab5","eighth|Bb5","eighth|C6","eighth|C6","eighth|C6","eighth|Bb5","eighth|Ab5","eighth|F5","quarter|Ab5","quarter|rest","eighth|Eb6","quarter|F6","quarter|Ab5","eighth|Bb5","eighth|C6","eighth|C6","eighth|C6","eighth|Bb5","eighth|Ab5","eighth|F5","quarter|Ab5","quarter|rest","eighth|Eb6","quarter|F6","quarter|Ab5","eighth|Bb5","eighth|C6","eighth|C6","eighth|C6","eighth|Bb5","eighth|Ab5","eighth|F5","quarter|Ab5","quarter|rest","eighth|Eb6","quarter|F6","quarter|Ab5","eighth|Bb5","eighth|C6","eighth|C6","eighth|C6","eighth|Bb5","eighth|Ab5","eighth|F5","quarter|C6","eighth|rest","half|Ab5"],arrows:[...h]}},u=new d,c=u.load(l);return u.instruments[0].notes.forEach(t=>{t.volumeLevel=.1}),u.instruments[3].notes.forEach(t=>{t.volumeLevel=0}),c.resetTempo(),{conductor:u,player:c}}}];function D(){let t=document.body,e=document.createElement("div");e.className="container";let r=document.createElement("h2");r.textContent="Attack Pattern",e.appendChild(r);let n=document.createElement("div");n.className="song-list",e.appendChild(n);let s=document.createElement("div");s.className="tempo-list",s.style.display="none",e.appendChild(s);let a=document.createElement("p");return a.id="output",e.appendChild(a),k.forEach(t=>{let r=document.createElement("button");r.textContent=t.name,r.className="song-button",r.addEventListener("click",()=>{!function(t){s.innerHTML="",s.style.display="block",n.style.display="none",t.tempos.forEach(r=>{let n=document.createElement("button");n.textContent=`${r} BPM`,n.className="tempo-button",n.addEventListener("click",()=>{a.textContent=`You selected: ${t.name} at ${r} BPM`;let n=t.factory();console.log("stop song"),i.gain.setValueAtTime(0,0),c=!0,n.name=t.name,q(n,r),function(t){t.remove()}(e)}),s.appendChild(n)}),a.textContent=`You selected: ${t.name}`}(t)}),n.appendChild(r)}),t.appendChild(e),e}var E=document.getElementById("terminal");document.getElementById("status"),E.textContent="",function(t,e,i=500){let r=0;!function n(){r<t.length?(E.textContent+=t[r++]+"\n",setTimeout(n,i)):e()}()}(["BL@CK C@T SYSTEM v0.13","Initializing...","Patching firewall claws...","Uploading furball payload...","Injecting pawprints...","Ready. Bap to start.\n"],()=>{booting=!1;let e,i,r=0,n=()=>{r?(D(),i&&i(),e&&e.destroy(),document.removeEventListener("keydown",n),document.removeEventListener("click",n)):(E.textContent="",e=new A("Bl@ck H@t // Bl@ck C@t",0),i=function(){let t=0,e=document.querySelector("#ascii-cat"),i=setInterval(()=>{0===t||2===t?(t++,e.innerHTML="<pre>\n    _______\n  _/_/\\_/\\_\\_\n    ( O.o )\n     > ^ <\n    < | | >\n    -------\n       ||\n       ||\n       ||\n</pre>"):1===t?(t++,e.innerHTML="<pre>\n    _______\n  _/_/\\_/\\_\\_\n    ( O.o )\n     > ^ <\n    < | | >\n    -------\n      //\n      \\\\//\n\n</pre>"):(t=0,e.innerHTML="<pre>\n    _______\n  _/_/\\_/\\_\\_\n    ( O.o )\n     > ^ <\n    < | | >\n    -------\n       \\\\\n     \\\\//\n\n</pre>")},500);return()=>{clearInterval(i),e.innerHTML=""}}(),c=!1,"suspended"===t.state&&t.resume(),l=t.currentTime+.1,u=0,m()),r++};document.addEventListener("keydown",n),document.addEventListener("click",n)},400)</script>