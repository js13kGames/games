<!doctype html><title>GeekTacToe</title><body style=background:#2e426c><div align=center width=500 height=500 id=board></div><script>var canvas,ctx,transition0,transition1,transition2,transition3,room2,t,coord1,coord2,coord3,coord4,playField=0,playerx=0,player0=0,ct=new Array,gameEnd=!1,playWithX=!1,turnAI=!1,turnHuman=!0,humanEnded=!1,emptyBox=!0,gameSize=500,size=gameSize/1.6818,lineWidth=size/100,xsize=size/11,playFieldBit=0,room=1,image1=new Image,image2=new Image,image=new Image,clicable=!0,scoreWinn=0,scoreDraw=0,scoreLoose=0,scoreTotal=0,winn=!1,timer=0;function update(){setTimeout(update,100);room=1,image1.src=canvas0.toDataURL(),image2.src=canvas2.toDataURL(),ctx.clearRect(0,0,canvas.width,canvas.height),ctx.drawImage(image,(gameSize-size)/2,(gameSize-size)/2),ctx.beginPath(),ctx.font=size/7+"30px Arial",ctx.fillStyle="white",ctx.textAlign="center",ctx.fillText("Geek Tac Toe",canvas.width/2,(gameSize-size)/4+size/12),ctx.fillText("Geek: "+scoreWinn+" / ai: "+scoreLoose,canvas.width/2,gameSize-size/4+size/12)}function flip(){setTimeout(flip,1e3);10==(timer+=1)&&(timer=0,image=image==image1?image2:image1)}function reatach(){canvas.addEventListener("mousedown",mouseClick)}function mouseClick(e){var a=e.target,i=e.clientX-a.offsetLeft,t=e.clientY-a.offsetTop;if(1==gameEnd&&(drawBoard(),playerx=0,player0=0,playWithX=Math.random()>=.5,turnAI=Math.random()>=.5,turnHuman=!1,humanEnded=!0,gameEnd=!gameEnd),clicable){var c=(gameSize-size)/2;i>c&&i<size+c&&t>c&&t<size+c&&(Math.abs(canvas.width/2-i)+Math.abs(canvas.height/2-t)<size/4?playField=9:i<=t&&i+t<=canvas.width&&i<=canvas.width/2&&t<=canvas.height/2?playField=1:i>=t&&i+t<=canvas.width&&i<=canvas.width/2&&t<=canvas.height/2?playField=2:i>=t&&i+t<=canvas.width&&i>=canvas.width/2&&t<=canvas.height/2?playField=3:i>=t&&i+t>=canvas.width&&i>=canvas.width/2&&t<=canvas.height/2?playField=4:i>=t&&i+t>=canvas.width&&i>=canvas.width/2&&t>=canvas.height/2?playField=5:i<=t&&i+t>=canvas.width&&i>=canvas.width/2&&t>=canvas.height/2?playField=6:i<=t&&i+t>=canvas.width&&i<=canvas.width/2&&t>=canvas.height/2?playField=7:i<=t&&i+t<=canvas.width&&i<=canvas.width/2&&t>=canvas.height/2&&(playField=8),playField>0&&playField<9&&(playField=room%2*((room+playField+6)%8+1)+(room+1)%2*((room-playField+8)%8+1)),playFieldBit=Math.pow(2,playField-1),turnAI!==turnHuman?1==turnHuman?(playHuman(),checkWinner(playerx),checkWinner(player0),updateScore(),0==gameEnd&1==humanEnded&&(playAI(),checkWinner(playerx),checkWinner(player0),updateScore())):(playAI(),checkWinner(playerx),checkWinner(player0),updateScore()):turnHuman=!turnAI)}}function updateScore(){winn?(turnHuman?(scoreLoose+=1,scoreTotal+=1):(scoreWinn+=1,scoreTotal+=1),winn=!1):gameEnd&&(scoreTotal+=1,scoreDraw+=1)}function playHuman(){if(checkEmpty(),1==emptyBox){switch(playWithX){case!0:drawX(playField),playerx|=playFieldBit;break;case!1:draw0(playField),player0|=playFieldBit}turnAI=!turnAI,turnHuman=!turnHuman,playWithX=!playWithX,humanEnded=!0}}function playAI(){switch(getBestField(),playWithX){case!0:drawX(playField),playerx|=playFieldBit;break;case!1:draw0(playField),player0|=playFieldBit}turnAI=!turnAI,turnHuman=!turnHuman,playWithX=!playWithX,humanEnded=!1}function checkEmpty(){emptyBox=0==(playerx&playFieldBit)&&0==(player0&playFieldBit)}function getRandomField(){randomField=0,randomFieldBit=0;for(var e=1;1==e;)randomField=Math.floor(9*Math.random()+1),randomFieldBit=Math.pow(2,randomField-1),0==(playerx&randomFieldBit)&&0==(player0&randomFieldBit)&&(e=0);playField=randomField,playFieldBit=Math.pow(2,playField-1),checkEmpty()}function getBestField(){playField=0,search2(1==playWithX?playerx:player0),0==playField&&search2(1==playWithX?player0:playerx),playFieldBit=Math.pow(2,playField-1),0==playField&&getRandomField()}function search2(e){switch(7&e){case 3:0==(4&(playerx|player0))&&(playField=3);break;case 5:0==(2&(playerx|player0))&&(playField=2);break;case 6:0==(1&(playerx|player0))&&(playField=1)}switch(392&e){case 384:0==(8&(playerx|player0))&&(playField=4);break;case 136:0==(256&(playerx|player0))&&(playField=9);break;case 264:0==(128&(playerx|player0))&&(playField=8)}switch(112&e){case 96:0==(16&(playerx|player0))&&(playField=5);break;case 80:0==(32&(playerx|player0))&&(playField=6);break;case 48:0==(64&(playerx|player0))&&(playField=7)}switch(193&e){case 129:0==(64&(playerx|player0))&&(playField=7);break;case 65:0==(128&(playerx|player0))&&(playField=8);break;case 192:0==(1&(playerx|player0))&&(playField=1)}switch(290&e){case 258:0==(32&(playerx|player0))&&(playField=6);break;case 34:0==(256&(playerx|player0))&&(playField=9);break;case 288:0==(2&(playerx|player0))&&(playField=2)}switch(28&e){case 12:0==(16&(playerx|player0))&&(playField=5);break;case 20:0==(8&(playerx|player0))&&(playField=4);break;case 24:0==(4&(playerx|player0))&&(playField=3)}switch(324&e){case 260:0==(64&(playerx|player0))&&(playField=7);break;case 68:0==(256&(playerx|player0))&&(playField=9);break;case 320:0==(4&(playerx|player0))&&(playField=3)}switch(273&e){case 17:0==(256&(playerx|player0))&&(playField=9);break;case 257:0==(16&(playerx|player0))&&(playField=5);break;case 272:0==(1&(playerx|player0))&&(playField=1)}}function drawBoard(){for(var e=0;e<3;e++)ct[e].lineWidth=lineWidth,ct[e].lineCap="round",ct[e].rect(0,0,size,size),ct[e].fillStyle="white",ct[e].fill(),ct[e].beginPath(),ct[e].moveTo(0,0),ct[e].lineTo(size,size),ct[e].lineTo(size/2,size),ct[e].lineTo(size/2,0),ct[e].lineTo(0,0),2==e&&(ct[e].fillStyle="#3ea",ct[e].fill()),ct[e].lineWidth=lineWidth,ct[e].strokeStyle="black",ct[e].stroke(),ct[e].closePath(),ct[e].beginPath(),ct[e].moveTo(0,size),ct[e].lineTo(size,0),ct[e].lineTo(size,size/2),ct[e].lineTo(0,size/2),ct[e].lineTo(0,size),0==e&&(ct[e].fillStyle="#3ea",ct[e].fill()),ct[e].strokeStyle="black",ct[e].stroke(),ct[e].closePath(),ct[e].beginPath(),ct[e].moveTo(size/2,size/4),ct[e].lineTo(.75*size,size/2),ct[e].lineTo(size/2,.75*size),ct[e].lineTo(size/4,size/2),ct[e].lineTo(size/2,size/4),ct[e].fillStyle="#3ea",ct[e].fill(),ct[e].strokeStyle="black",ct[e].stroke(),ct[e].closePath(),ct[e].beginPath(),ct[e].moveTo(lineWidth/2,lineWidth/2),ct[e].rect(lineWidth/2,lineWidth/2,size-lineWidth,size-lineWidth),ct[e].strokeStyle="black",ct[e].stroke(),ct[e].closePath()}function drawX(e){getCoord(e),ct[0].beginPath(),ct[0].strokeStyle="black",ct[0].moveTo(coord1-xsize,coord2-xsize),ct[0].lineTo(coord1+xsize,coord2+xsize),ct[0].moveTo(coord1+xsize,coord2-xsize),ct[0].lineTo(coord1-xsize,coord2+xsize),ct[0].stroke(),ct[2].beginPath(),ct[2].moveTo(coord1+xsize,coord2),ct[2].arc(coord1,coord2,xsize,0,2*Math.PI),ct[2].stroke(),ct[1].beginPath(),ct[1].moveTo(coord3+xsize,coord4),ct[1].arc(coord3,coord4,xsize,0,2*Math.PI),ct[1].stroke()}function draw0(e){getCoord(e),ct[0].beginPath(),ct[0].moveTo(coord1+xsize,coord2),ct[0].arc(coord1,coord2,xsize,0,2*Math.PI),ct[0].stroke(),ct[2].beginPath(),ct[2].strokeStyle="black",ct[2].moveTo(coord1-xsize,coord2-xsize),ct[2].lineTo(coord1+xsize,coord2+xsize),ct[2].moveTo(coord1+xsize,coord2-xsize),ct[2].lineTo(coord1-xsize,coord2+xsize),ct[2].stroke(),ct[1].beginPath(),ct[1].strokeStyle="black",ct[1].moveTo(coord3-xsize,coord4-xsize),ct[1].lineTo(coord3+xsize,coord4+xsize),ct[1].moveTo(coord3+xsize,coord4-xsize),ct[1].lineTo(coord3-xsize,coord4+xsize),ct[1].stroke()}function getCoord(e){switch(e){case 1:coord1=size/8,coord2=3*size/8,coord3=7*size/8,coord4=3*size/8;break;case 2:coord1=3*size/8,coord2=size/8,coord3=5*size/8,coord4=size/8;break;case 3:coord1=5*size/8,coord2=size/8,coord3=3*size/8,coord4=size/8;break;case 8:coord1=size/8,coord2=5*size/8,coord3=7*size/8,coord4=5*size/8;break;case 9:coord1=size/2,coord2=size/2,coord3=size/2,coord4=size/2;break;case 4:coord1=7*size/8,coord2=3*size/8,coord3=size/8,coord4=3*size/8;break;case 7:coord1=3*size/8,coord2=7*size/8,coord3=5*size/8,coord4=7*size/8;break;case 6:coord1=5*size/8,coord2=7*size/8,coord3=3*size/8,coord4=7*size/8;break;case 5:coord1=7*size/8,coord2=5*size/8,coord3=size/8,coord4=5*size/8}}function checkWinner(e){ct[0].lineWidth=lineWidth,ct[0].strokeStyle="black",7==(7&e)?(ct[0].moveTo(0,3*size/8),ct[0].lineTo(3*size/4,0),ct[0].stroke(),ct[1].moveTo(1*size/4,0),ct[1].lineTo(size,3*size/8),ct[1].stroke(),gameEnd=!0,winn=!0):392==(392&e)?(ct[0].moveTo(0,3*size/4),ct[0].lineTo(size,size/4),ct[0].stroke(),ct[1].moveTo(0,1*size/4),ct[1].lineTo(size,3*size/4),ct[1].stroke(),gameEnd=!0,winn=!0):112==(112&e)?(ct[0].moveTo(1*size/4,size),ct[0].lineTo(size,5*size/8),ct[0].stroke(),ct[1].moveTo(0,5*size/8),ct[1].lineTo(3*size/4,size),ct[1].stroke(),gameEnd=!0,winn=!0):193==(193&e)?(ct[0].moveTo(0,1*size/4),ct[0].lineTo(3*size/8,size),ct[0].stroke(),ct[1].moveTo(size,1*size/4),ct[1].lineTo(5*size/8,size),ct[1].stroke(),gameEnd=!0,winn=!0):290==(290&e)?(ct[0].moveTo(1*size/4,0),ct[0].lineTo(3*size/4,size),ct[0].stroke(),ct[1].moveTo(3*size/4,0),ct[1].lineTo(1*size/4,size),ct[1].stroke(),gameEnd=!0,winn=!0):28==(28&e)?(ct[0].moveTo(5*size/8,0),ct[0].lineTo(size,3*size/4),ct[0].stroke(),ct[1].moveTo(3*size/8,0),ct[1].lineTo(0,3*size/4),ct[1].stroke(),gameEnd=!0,winn=!0):324==(324&e)?(ct[0].moveTo(3*size/4,0),ct[0].lineTo(1*size/4,size),ct[0].stroke(),ct[1].moveTo(1*size/4,0),ct[1].lineTo(3*size/4,size),ct[1].stroke(),gameEnd=!0,winn=!0):273==(273&e)?(ct[0].moveTo(0,1*size/4),ct[0].lineTo(size,3*size/4),ct[0].stroke(),ct[1].moveTo(size,1*size/4),ct[1].lineTo(0,3*size/4),ct[1].stroke(),gameEnd=!0,winn=!0):511==(playerx|player0)&&(gameEnd=!0)}window.onload=function(){(canvas=document.createElement("canvas")).width=canvas.height=gameSize,ctx=canvas.getContext("2d"),document.getElementById("board").appendChild(canvas),canvas0=document.createElement("canvas"),canvas0.width=canvas0.height=size,ct[0]=canvas0.getContext("2d"),canvas1=document.createElement("canvas"),canvas1.width=canvas1.height=size,ct[1]=canvas1.getContext("2d"),canvas2=document.createElement("canvas"),canvas2.width=canvas2.height=size,ct[2]=canvas2.getContext("2d"),ctx.fillStyle="#2e426c",ctx.fillRect(0,0,canvas.width,canvas.height),image1.src=canvas0.toDataURL(),image2.src=canvas1.toDataURL(),image=image1,canvas.addEventListener("mousedown",mouseClick),ctx.lineWidth=lineWidth,ctx.lineCap="round",drawBoard(),update(),flip();var e=document.createElement("link");e.type="image/png",e.rel="icon",e.href=canvas0.toDataURL("image/png"),document.getElementsByTagName("head")[0].appendChild(e)}</script>