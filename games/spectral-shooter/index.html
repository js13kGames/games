<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><link rel="shortcut icon" href="#"><script type="text/javascript">(()=>{var t={279:(t,e)=>{function i(){this.setSettings=function(t){for(var e=0;e<24;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(i<.18){var s=.18/i;this.b*=s,this.c*=s,this.e*=s}}}var s=new function(){var t,e,s,h,n,a,o,l,r,c,d,f;this._params=new i,this.reset=function(){var t=this._params;h=100/(t.f*t.f+.001),n=100/(t.g*t.g+.001),a=1-t.h*t.h*t.h*.01,o=-t.i*t.i*t.i*1e-6,t.a||(d=.5-t.n/2,f=5e-5*-t.o),l=1+t.l*t.l*(t.l>0?-.9:10),r=0,c=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var i=this._params;return t=i.b*i.b*1e5,e=i.c*i.c*1e5,s=i.e*i.e*1e5+12,3*((t+e+s)/3|0)},this.synthWave=function(i,p){var g=this._params,u=1!=g.s||g.v,x=g.v*g.v*.1,y=1+3e-4*g.w,w=g.s*g.s*g.s*.1,m=1+1e-4*g.t,_=1!=g.s,b=g.x*g.x,v=g.g,S=g.q||g.r,M=g.r*g.r*g.r*.2,T=g.q*g.q*(g.q<0?-1020:1020),k=g.p?32+((1-g.p)*(1-g.p)*2e4|0):0,A=g.d,P=g.j/2,E=g.k*g.k*.01,I=g.a,C=t,D=1/t,Y=1/e,X=1/s,z=5/(1+g.u*g.u*20)*(.01+w);z>.8&&(z=.8),z=1-z;for(var R,j,W,O,L,U,$=!1,F=0,H=0,N=0,q=0,G=0,B=0,K=0,Q=0,V=0,Z=0,J=new Array(1024),tt=new Array(32),et=J.length;et--;)J[et]=0;for(et=tt.length;et--;)tt[et]=2*Math.random()-1;for(et=0;et<p;et++){if($)return et;if(k&&++V>=k&&(V=0,this.reset()),c&&++r>=c&&(c=0,h*=l),(h*=a+=o)>n&&(h=n,v>0&&($=!0)),j=h,P>0&&(Z+=E,j*=1+Math.sin(Z)*P),(j|=0)<8&&(j=8),I||((d+=f)<0?d=0:d>.5&&(d=.5)),++H>C)switch(H=0,++F){case 1:C=e;break;case 2:C=s}switch(F){case 0:N=H*D;break;case 1:N=1+2*(1-H*Y)*A;break;case 2:N=1-H*X;break;case 3:N=0,$=!0}S&&((W=0|(T+=M))<0?W=-W:W>1023&&(W=1023)),u&&y&&((x*=y)<1e-5?x=1e-5:x>.1&&(x=.1)),U=0;for(var it=8;it--;){if(++K>=j&&(K%=j,3==I))for(var st=tt.length;st--;)tt[st]=2*Math.random()-1;switch(I){case 0:L=K/j<d?.5:-.5;break;case 1:L=1-K/j*2;break;case 2:L=.225*(((L=1.27323954*(O=6.28318531*((O=K/j)>.5?O-1:O))+.405284735*O*O*(O<0?1:-1))<0?-1:1)*L*L-L)+L;break;case 3:L=tt[Math.abs(32*K/j|0)]}u&&(R=B,(w*=m)<0?w=0:w>.1&&(w=.1),_?(G+=(L-B)*w,G*=z):(B=L,G=0),q+=(B+=G)-R,L=q*=1-x),S&&(J[Q%1024]=L,L+=J[(Q-W+1024)%1024],Q++),U+=L}U*=.125*N*b,i[et]=U>=1?32767:U<=-1?-32768:32767*U|0}return p}};e.v=function(t){s._params.setSettings(t);var e=s.totalReset(),i=new Uint8Array(4*((e+1)/2|0)+44),h=2*s.synthWave(new Uint16Array(i.buffer,44),e),n=new Uint32Array(i.buffer,0,44);n[0]=1179011410,n[1]=h+36,n[2]=1163280727,n[3]=544501094,n[4]=16,n[5]=65537,n[6]=44100,n[7]=88200,n[8]=1048578,n[9]=1635017060,n[10]=h,h+=44;for(var a=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="data:audio/wav;base64,";a<h;a+=3){var r=i[a]<<16|i[a+1]<<8|i[a+2];l+=o[r>>18]+o[r>>12&63]+o[r>>6&63]+o[63&r]}return l}}},e={};function i(s){var h=e[s];if(void 0!==h)return h.exports;var n=e[s]={exports:{}};return t[s](n,n.exports,i),n.exports}(()=>{"use strict";let t=()=>{};let e,s,h={};function n(t,...e){(h[t]||[]).map((t=>t(...e)))}let a={get:(e,i)=>"_proxy"==i||t};function o(){return e}function l(){return s}function r(t,{contextless:i=!1}={}){if(e=document.getElementById(t)||t||document.querySelector("canvas"),i&&(e=e||new Proxy({},a)),!e)throw Error("You must provide a canvas element for the game");return s=e.getContext("2d")||new Proxy({},a),s.imageSmoothingEnabled=!1,n("init"),{canvas:e,context:s}}function c(t,e){return Math.atan2(e.y-t.y,e.x-t.x)+Math.PI/2}function d(t,e,i){return Math.min(Math.max(t,i),e)}class f{constructor(t=0,e=0,i={}){this.x=t,this.y=e,i._c&&(this.clamp(i._a,i._b,i._d,i._e),this.x=t,this.y=e)}add(t){return new f(this.x+t.x,this.y+t.y,this)}subtract(t){return new f(this.x-t.x,this.y-t.y,this)}scale(t){return new f(this.x*t,this.y*t)}normalize(t=this.length()){return new f(this.x/t,this.y/t)}dot(t){return this.x*t.x+this.y*t.y}length(){return Math.hypot(this.x,this.y)}distance(t){return Math.hypot(this.x-t.x,this.y-t.y)}angle(t){return Math.acos(this.dot(t)/(this.length()*t.length()))}clamp(t,e,i,s){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=s}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?d(this._a,this._d,t):t}set y(t){this._y=this._c?d(this._b,this._e,t):t}}function p(){return new f(...arguments)}class g extends class extends class{constructor(t){return this.init(t)}init(t={}){this.position=p(),this.velocity=p(),this.acceleration=p(),this.ttl=1/0,Object.assign(this,t)}update(t){this.advance(t)}advance(t){let e=this.acceleration;t&&(e=e.scale(t)),this.velocity=this.velocity.add(e);let i=this.velocity;t&&(i=i.scale(t)),this.position=this.position.add(i),this._pc(),this.ttl--}get dx(){return this.velocity.x}get dy(){return this.velocity.y}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}isAlive(){return this.ttl>0}_pc(){}}{init({width:t=0,height:e=0,context:i=l(),render:s=this.draw,update:h=this.advance,children:n=[],anchor:a={x:0,y:0},opacity:o=1,rotation:r=0,scaleX:c=1,scaleY:d=1,...f}={}){this._c=[],super.init({width:t,height:e,context:i,anchor:a,opacity:o,rotation:r,scaleX:c,scaleY:d,...f}),this._di=!0,this._uw(),this.addChild(n),this._rf=s,this._uf=h}update(t){this._uf(t),this.children.map((e=>e.update&&e.update(t)))}render(){let t=this.context;t.save(),(this.x||this.y)&&t.translate(this.x,this.y),this.rotation&&t.rotate(this.rotation),1==this.scaleX&&1==this.scaleY||t.scale(this.scaleX,this.scaleY);let e=-this.width*this.anchor.x,i=-this.height*this.anchor.y;(e||i)&&t.translate(e,i),this.context.globalAlpha=this.opacity,this._rf(),(e||i)&&t.translate(-e,-i),this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){this._uw(),this.children.map((t=>t._pc()))}get x(){return this.position.x}get y(){return this.position.y}set x(t){this.position.x=t,this._pc()}set y(t){this.position.y=t,this._pc()}get width(){return this._w}set width(t){this._w=t,this._pc()}get height(){return this._h}set height(t){this._h=t,this._pc()}_uw(){if(!this._di)return;let{_wx:t=0,_wy:e=0,_wo:i=1,_wr:s=0,_wsx:h=1,_wsy:n=1}=this.parent||{};this._wx=this.x,this._wy=this.y,this._ww=this.width,this._wh=this.height,this._wo=i*this.opacity,this._wsx=h*this.scaleX,this._wsy=n*this.scaleY,this._wx=this._wx*h,this._wy=this._wy*n,this._ww=this.width*this._wsx,this._wh=this.height*this._wsy,this._wr=s+this.rotation;let{x:a,y:o}=function(t,e){let i=Math.sin(e),s=Math.cos(e);return{x:t.x*s-t.y*i,y:t.x*i+t.y*s}}({x:this._wx,y:this._wy},s);this._wx=a,this._wy=o,this._wx+=t,this._wy+=e}get world(){return{x:this._wx,y:this._wy,width:this._ww,height:this._wh,opacity:this._wo,rotation:this._wr,scaleX:this._wsx,scaleY:this._wsy}}set children(t){this.removeChild(this._c),this.addChild(t)}get children(){return this._c}addChild(...e){e.flat().map((e=>{this.children.push(e),e.parent=this,e._pc=e._pc||t,e._pc()}))}removeChild(...t){t.flat().map((t=>{(function(t,e){let i=t.indexOf(e);if(-1!=i)return t.splice(i,1),!0})(this.children,t)&&(t.parent=null,t._pc())}))}get opacity(){return this._opa}set opacity(t){this._opa=t,this._pc()}get rotation(){return this._rot}set rotation(t){this._rot=t,this._pc()}setScale(t,e=t){this.scaleX=t,this.scaleY=e}get scaleX(){return this._scx}set scaleX(t){this._scx=t,this._pc()}get scaleY(){return this._scy}set scaleY(t){this._scy=t,this._pc()}}{init({image:t,width:e=(t?t.width:void 0),height:i=(t?t.height:void 0),...s}={}){super.init({image:t,width:e,height:i,...s})}get animations(){return this._a}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){super.advance(t),this.currentAnimation&&this.currentAnimation.update(t)}draw(){this.image&&this.context.drawImage(this.image,0,0,this.image.width,this.image.height),this.currentAnimation&&this.currentAnimation.render({x:0,y:0,width:this.width,height:this.height,context:this.context}),this.color&&(this.context.fillStyle=this.color,this.context.fillRect(0,0,this.width,this.height))}}function u(){return new g(...arguments)}let x=new WeakMap,y={},w={},m={0:"left",1:"middle",2:"right"};function _(t=o()){return x.get(t)}function b(t,e){let{x:i,y:s,width:h,height:n}=function(t){let{x:e=0,y:i=0,width:s,height:h}=t.world||t;return t.mapwidth&&(s=t.mapwidth,h=t.mapheight),t.anchor&&(e-=s*t.anchor.x,i-=h*t.anchor.y),s<0&&(e+=s,s*=-1),h<0&&(i+=h,h*=-1),{x:e,y:i,width:s,height:h}}(t);do{i-=t.sx||0,s-=t.sy||0}while(t=t.parent);let a=e.x-Math.max(i,Math.min(e.x,i+h)),o=e.y-Math.max(s,Math.min(e.y,s+n));return a*a+o*o<e.radius*e.radius}function v(t,e){return parseFloat(t.getPropertyValue(e))||0}function S(t){let e=null!=t.button?m[t.button]:"left";w[e]=!0,P(t,"onDown")}function M(t){let e=null!=t.button?m[t.button]:"left";w[e]=!1,P(t,"onUp")}function T(t){P(t,"onOver")}function k(t){x.get(t.target)._oo=null,w={}}function A(t,e,i){let s=function(t){let e=t._lf.length?t._lf:t._cf;for(let i=e.length-1;i>=0;i--){let s=e[i];if(s.collidesWithPointer?s.collidesWithPointer(t):b(s,t))return s}}(t);s&&s[e]&&s[e](i),y[e]&&y[e](i,s),"onOver"==e&&(s!=t._oo&&t._oo&&t._oo.onOut&&t._oo.onOut(i),t._oo=s)}function P(t,e){t.preventDefault();let i=t.target,s=x.get(i),{scaleX:h,scaleY:a,offsetX:o,offsetY:l}=function(t){let{canvas:e,_s:i}=t,s=e.getBoundingClientRect(),h="none"!=i.transform?i.transform.replace("matrix(","").split(","):[1,1,1,1],n=parseFloat(h[0]),a=parseFloat(h[3]),o=(v(i,"border-left-width")+v(i,"border-right-width"))*n,l=(v(i,"border-top-width")+v(i,"border-bottom-width"))*a,r=(v(i,"padding-left")+v(i,"padding-right"))*n,c=(v(i,"padding-top")+v(i,"padding-bottom"))*a;return{scaleX:(s.width-o-r)/e.width,scaleY:(s.height-l-c)/e.height,offsetX:s.left+(v(i,"border-left-width")+v(i,"padding-left"))*n,offsetY:s.top+(v(i,"border-top-width")+v(i,"padding-top"))*a}}(s);t.type.includes("touch")?(Array.from(t.touches).map((({clientX:t,clientY:e,identifier:i})=>{let n=s.touches[i];n||(n=s.touches[i]={start:{x:(t-o)/h,y:(e-l)/a}},s.touches.length++),n.changed=!1})),Array.from(t.changedTouches).map((({clientX:i,clientY:r,identifier:c})=>{let d=s.touches[c];d.changed=!0,d.x=s.x=(i-o)/h,d.y=s.y=(r-l)/a,A(s,e,t),n("touchChanged",t,s.touches),"onUp"==e&&(delete s.touches[c],s.touches.length--,s.touches.length||n("touchEnd"))}))):(s.x=(t.clientX-o)/h,s.y=(t.clientY-l)/a,A(s,e,t))}function E({radius:t=5,canvas:e=o()}={}){let i=x.get(e);if(!i){let s=window.getComputedStyle(e);i={x:0,y:0,radius:t,touches:{length:0},canvas:e,_cf:[],_lf:[],_o:[],_oo:null,_s:s},x.set(e,i)}return e.addEventListener("mousedown",S),e.addEventListener("touchstart",S),e.addEventListener("mouseup",M),e.addEventListener("touchend",M),e.addEventListener("touchcancel",M),e.addEventListener("blur",k),e.addEventListener("mousemove",T),e.addEventListener("touchmove",T),i._t||(i._t=!0,n=()=>{i._lf.length=0,i._cf.map((t=>{i._lf.push(t)})),i._cf.length=0},h[s="tick"]=h[s]||[],h[s].push(n)),i;var s,n}function I(t){let e=t.canvas;t.clearRect(0,0,e.width,e.height)}class C{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t())||!(i.update&&i.init&&i.isAlive&&i.render))throw Error("Must provide create() function which returns an object with init(), update(), render(), and isAlive() functions");this._c=t,this.objects=[t()],this.size=0,this.maxSize=e}get(t={}){if(this.size==this.objects.length){if(this.size==this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.push(this._c())}let e=this.objects[this.size];return this.size++,e.init(t),e}getAliveObjects(){return this.objects.slice(0,this.size)}clear(){this.size=this.objects.length=0,this.objects.push(this._c())}update(t){let e,i=!1;for(let s=this.size;s--;)e=this.objects[s],e.update(t),e.isAlive()||(i=!0,this.size--);i&&this.objects.sort(((t,e)=>e.isAlive()-t.isAlive()))}render(){for(let t=this.size;t--;)this.objects[t].render()}}function D(){return new C(...arguments)}const Y="#DD6C03",X="#FDA418",z="#3A82EB",R="#060911",j="#333333",W="Gray",O="Silver",L="#F5F5F5",U=[16,,960,10208,10208,9248,9824,9824,8192,12158,1858,28762,1882,11354,1090,1084],$=[16,,960,1056,2016,1440,2016,960,6168,16188,1632,9444,12300,14316,1056,1056],F=[16,,17344,26592,10256,27600,18832,19408,22936,23612,4088,26594,24582,1952,18400,17440],H=[16,,,128,256,896,448,960,2016,1888,3824,3936,1648,3696,2016,384],N=[16,,8322,3632,20020,3584,208,25798,24582,1648,5744,114,16896,6172,6428,28],q=[16,,,2052,8190,8190,,8238,32756,32758,,496,96,112,,,],G=[16,,,,,,32752,32760,8444,3758,30,6,,,,,],B=[16,,,,,8640,32766,32706,3570,4046,3168,3168,3072,,,,];function K(t,e="#fff"){const[i,...s]=t,h=document.createElement("canvas");h.width=i,h.height=s.length;const n=h.getContext("2d");n.fillStyle=e;for(let t=0;t<s.length;t++)for(let e=0;e<i;e++)s[t]&1<<e&&n.fillRect(e,t,1,1);return h}var Q=i(279);class V{constructor(){this.sounds={},this.volume=1,this.add("shoot",5,[[1,,.299,.271,.28,.336,.067,-.487,,,,,,.062,.176,,.052,-.041,1,,,.264,,.2],[1,,.299,.271,.28,.336,.067,-.4,,,,,,.062,.176,,.052,-.041,1,,,.264,,.2]]),this.add("hit",3,[[,,.232,.236,.299,.326,.019,-.595,,,,,,.402,.078,,,,1,,,.163,,.5]]),this.add("explosion",3,[[3,,.106,.613,.304,.143,,-.306,,,,-.632,.801,,,,,,1,,,,,.5]]),this.add("coin",3,[[1,,.095,.451,.26,.645,,,,,,.299,.665,,,,,,1,,,,,.5]]),this.add("pickup",3,[[,,.355,,.618,.263,,.491,,.191,.278,,.095,.372,,.56,,,1,,,,,.4]]),this.add("death",1,[[3,,.173,.291,.491,.03,,.105,,.134,.217,.131,,,,,.531,-.21,1,.227,,,,.6]]),this.add("enter_spectral",3,[[,,.141,,.425,.262,,.377,,,,,,.197,,.463,,,1,,,,,.5]]),this.add("respawn",1,[[,,.294,,.434,.241,,.167,,,,,,.104,,,,,1,,,,,.4]]),this.add("game_over",1,[[1,.154,.561,.114,.557,.248,,-.042,-.046,.441,.292,.705,.643,.076,-.082,.312,-.264,.032,.237,-.087,.253,.33,-.593,.3]]),this.add("test",3,[[,,.355,,.618,.263,,.491,,.191,.278,,.095,.372,,.56,,,1,,,,,.5]])}add(t,e,i){this.sounds[t]=[],i.forEach(((i,s)=>{this.sounds[t].push({tick:0,count:e,pool:[]});for(var h=0;h<e;h++){var n=new Audio;n.src=(0,Q.v)(i),this.sounds[t][s].pool.push(n)}}))}play(t,e=this.volume){var i=this.sounds[t],s=i.length>1?i[Math.random()*i.length|0]:i[0];s.pool[s.tick].volume=e,s.pool[s.tick].play().catch((t=>{})),s.tick=(s.tick+1)%s.count}}window.onload=async function e(){const i=1e3;let s=0,h=0,a=0,o=0,d=1,f=0,p=0,g=0,x=parseInt(localStorage.getItem("dicksonmd.spectralShooter.hiScore")??0),y=0,m=10,b=1,v=0,S=5,M=0,T=10,k=-1,A=0,P=1,C=1,Q=0,Z=0,J=0,tt=0,et=0,it=[0,0,0],st=[0,0,0],ht=0,nt=0;const at=await async function(){return{basicEnemyPhysical:K(U,j),basicEnemySpectral:K(U,W),basicEnemyOrange:K(U,Y),shooterEnemyPhysical:K(F,j),shooterEnemySpectral:K(F,W),ghostFirePhysical:K(H,O),ghostFireSpectral:K(H,z),playerPhysical:K($,j),playerSpectral:K($,O),playerSpectralDash:K($,z),dualPistolOrange:K(q,X),machineGunOrange:K(B,X),shotgunOrange:K(G,X),floorTile1:K(N,O)}}(),ot=["","Dual pistols","Submachine gun","Shotgun"],lt=["",at.dualPistolOrange,at.machineGunOrange,at.shotgunOrange],rt=new V,ct=()=>focus(),dt=document.querySelector("#b"),ft=dt.getContext("2d");let{canvas:pt,context:gt}=r("a");pt.addEventListener("pointerenter",ct),gt.imageSmoothingEnabled=!1,ft.imageSmoothingEnabled=!1,E();const ut=[[10,2e3,5,3,Mt],[30,3e3,20,3,Mt,Mt,kt],[20,3e3,25,3,Mt,kt],[20,3e3,30,3,Mt,kt],[20,3e3,50,3,Mt,kt],[30,3e3,30,5,Mt,kt,kt,Tt],[30,2e3,100,3,Mt,kt,kt,kt,Tt,Tt]];let xt=0,yt=0,wt=[],mt=D({create:u}),_t=D({create:u}),bt=D({create:u}),vt=u({x:pt.width/2,y:pt.height/2+50,image:at.playerPhysical,anchor:{x:.5,y:.5},team:0,images:[at.playerPhysical,at.playerSpectral],speed:1.5,nextCanShoot:s,dimension:0,frontRotation:0});function St(){const t=2*Math.random()*Math.PI;return{x:Math.cos(t),y:Math.sin(t)}}function Mt(){const t=u({x:this.x,y:this.y,image:at.basicEnemyPhysical,anchor:{x:.5,y:.5},eType:0,hp:5,images:[at.basicEnemyPhysical,at.basicEnemySpectral],dimension:0,b:"dw<.",strafe:0,onDeathSpawn(){At.call(this,St(),Mt)},targetX:this.x,targetY:this.y,speed:.7,aiNextTick:s,hitEffectUntil:s,team:1,render(){gt.globalAlpha=this.hitEffectUntil>s?.5:1,this.image&&gt.drawImage(this.image,0,0,this.image.width,this.image.height),gt.globalAlpha=1}});wt.push(t)}function Tt(){const t=u({x:this.x,y:this.y,image:at.basicEnemyPhysical,anchor:{x:.5,y:.5},eType:2,hp:15,size:32,images:[at.basicEnemyPhysical,at.basicEnemySpectral],dimension:0,b:"dw<.",strafe:0,onDeathSpawn(){At.call(this,St(),Mt)},targetX:this.x,targetY:this.y,speed:.5,aiNextTick:s,hitEffectUntil:s,team:1,render(){gt.globalAlpha=this.hitEffectUntil>s?.5:1,this.image&&gt.drawImage(this.image,(this.image.width-this.size)/2,(this.image.width-this.size)/2,this.size,this.size),gt.globalAlpha=1}});wt.push(t)}function kt(){const t=u({x:this.x,y:this.y,image:at.shooterEnemyPhysical,anchor:{x:.5,y:.5},eType:1,hp:3,team:1,images:[at.shooterEnemyPhysical,at.shooterEnemySpectral],dimension:0,b:"dw<.s",strafe:150,onDeathSpawn(){At.call(this,St(),kt)},targetX:this.x,targetY:this.y,speed:1,aiNextTick:s,hitEffectUntil:s,team:1,nextCanShoot:s+1500,render(){gt.globalAlpha=this.hitEffectUntil>s?.5:1,this.image&&gt.drawImage(this.image,0,0,this.image.width,this.image.height),gt.globalAlpha=1}});wt.push(t)}function At(t,e){const i=u({x:this.x,y:this.y,image:at.ghostFirePhysical,anchor:{x:.5,y:.5},render(){let t=0,e=1*Math.sin(s%500/500*2*Math.PI);this.image&&(this.returnHp-this.hp>180?0==f&&(gt.globalAlpha=.3+this.hp/this.returnHp*.7):t=1*Math.sign(s%100-50),gt.drawImage(this.image,t,e,this.image.width,this.image.height),gt.globalAlpha=1),this.color&&(gt.fillStyle=this.color,gt.fillRect(0,0,this.width,this.height))},eType:e.eType,team:1,images:[at.ghostFirePhysical,at.ghostFireSpectral],dimension:1,hp:1,b:"w>.",knockDx:3*t?.x,knockDy:3*t?.y,speed:.2,targetX:this.x,targetY:this.y,aiNextTick:s+1e3,returnHp:1500,spawnEntity:e});return wt.push(i),i}function Pt(t,e,i,s,h,n){mt.get({x:e.x+(2!=t?0:Math.cos(i)*s),y:e.y+(2!=t?0:Math.sin(i)*s),dx:Math.cos(i)*(s/n)*(2!=t?1:-1),dy:Math.sin(i)*(s/n)*(2!=t?1:-1),image:h,anchor:{x:.5,y:.5},ttl:n,ttl2:n,render(){this.image&&(gt.globalAlpha=this.ttl/this.ttl2*.7,gt.drawImage(this.image,0,0,this.image.width,this.image.height),gt.globalAlpha=1),this.color&&(gt.fillStyle=this.color,gt.fillRect(0,0,this.width,this.height))}})}function Et(t,e,i,s,h,n,a){mt.get({x:e.x,y:e.y,dx:t<3?0:Math.cos(i)*s/a,dy:t<3?0:Math.sin(i)*s/a,anchor:{x:0,y:0},ttl:a,ttl2:a,render(){t<3?(gt.strokeStyle=h,gt.lineWidth=1,gt.globalAlpha=1,1==t&&(gt.globalAlpha=this.ttl/this.ttl2),gt.beginPath(),1==t&&gt.arc(0,0,(1-this.ttl/this.ttl2)*s,0,2*Math.PI),2==t&&gt.arc(0,0,this.ttl/this.ttl2*s,0,2*Math.PI),gt.stroke()):(ft.font="16px sans-serif",ft.fillStyle=h,ft.textAlign="center",ft.fillText(n,2*this.x,2*this.y))}})}function It(){for(let t=0;t<100;t++){const t={x:Math.random()*(pt.width-100)+50,y:Math.random()*(pt.height-100)+50},e=64;if(!wt.some((i=>i.position.distance(t)<(i.size??i.width)/2+e/2)))return t}}function Ct(t){this.advance(t);const e=wt.filter((t=>t.hp&&t.team!==this.team&&t.dimension===this.dimension)).find((t=>t.position.distance(this)<(t.size??t.width)/2+this.width/2));if(e){if(e.hp-=1,e.hitEffectUntil=s+60,e.hp<=0){const t=10*(m/T|0);y+=t,e.ttl=0,v++,m++,e.onDeathSpawn?.(),it[e.eType]++,rt.play("explosion");let i=Math.random()*Math.PI;i+=Math.PI/2,Pt(1,e.position,i,60,e.image,10),i+=Math.PI/2,Pt(1,e.position,i,60,e.image,10),i+=Math.PI/2,Pt(1,e.position,i,60,e.image,10),i+=Math.PI/2,Pt(1,e.position,i,60,e.image,10),Et(3,e,-Math.PI/2,20,L,"+"+t,60)}rt.play("hit"),this.ttl=0}0==f&&vt.position.distance(this)<vt.width/2+this.width/2&&(bt.getAliveObjects().forEach((t=>t.ttl=0)),f=2,vt.dimension=f,g=0,p=s+500,vt.dx=0,vt.dy=0,v=0,m=T,b=1,M=s+14e3,wt.filter((t=>1==t.box)).forEach((t=>t.ttl=0)),rt.play("death"),nt++,0==Z&&(Z=1,d=1))}wt.push(vt),Mt.eType=0,Tt.eType=2,kt.eType=1,At.eType=-1;const Dt={u:0,d:0,l:0,r:0,a:0,c1:0,c2:0},Yt=t=>{const i=t.keyCode,h=t.type,n={87:"u",90:"u",38:"u",83:"d",40:"d",65:"l",81:"l",37:"l",68:"r",39:"r",32:"s",8:"b",13:"en",9:"tb",77:"m"};n[i]&&(Dt[n[i]]=+(h[3]<"u"),Dt.m&&"m"==n[i]&&(rt.volume=!rt.volume,Dt.m=0),Dt.s&&"s"==n[i]&&(a&&(Xt.stop(),window.removeEventListener("keydown",Yt),window.removeEventListener("keyup",Yt),pt.removeEventListener("pointerenter",ct),e()),d&&(d=!1),0==Q||1==Q?(Q++,d=!0):2==Q&&(Q++,k=s+500,yt=s+1e3*ut[xt][0]),J&&(J=-1),Z&&(Z=-1),Dt.s=0),Dt.tb&&"tb"==n[i]&&!a&&(o=!o,Dt.tb=0),t.preventDefault(),t.stopPropagation())};window.addEventListener("keydown",Yt),window.addEventListener("keyup",Yt);let Xt=function({fps:e=60,clearCanvas:i=!0,update:s=t,render:h,context:a=l(),blur:o=!1}={}){if(!h)throw Error("You must provide a render() function");let r,c,d,f,p,g=0,u=1e3/e,x=1/e,y=i?I:t,w=!0;function m(){if(c=requestAnimationFrame(m),w&&(d=performance.now(),f=d-r,r=d,!(f>1e3))){for(n("tick"),g+=f;g>=u;)p.update(x),g-=u;y(a),p.render()}}return o||(window.addEventListener("focus",(()=>{w=!0})),window.addEventListener("blur",(()=>{w=!1}))),p={update:s,render:h,isStopped:!0,start(){r=performance.now(),this.isStopped=!1,requestAnimationFrame(m)},stop(){this.isStopped=!0,cancelAnimationFrame(c)},_frame:m,set _last(t){r=t}},p}({update(){if(!a&&!o&&!d){if(s+=16,1==f&&(h+=16),(m/T|0)>et&&(tt=0,et=m/T|0),(m/T|0)==et&&(tt+=16),[mt,...wt,_t,bt].forEach((t=>{if(t.image=t.images?.[f]??t.image,t.knockDx&&(t.x+=t.knockDx,t.knockDx*=.85),t.knockDy&&(t.y+=t.knockDy,t.knockDy*=.85),null!=t.targetX){const e=vt.position.distance(t);if(t.b?.includes("<")&&s>t.aiNextTick&&t.dimension==vt.dimension){const e=c(vt,t)-Math.PI/2+Math.random()-.5;t.targetX=vt.x+Math.cos(e)*t.strafe,t.targetY=vt.y+Math.sin(e)*t.strafe,t.s=1*t.speed,t.strafe>0&&(t.aiNextTick=s+3e3)}else if(t.b?.includes(">")&&t.dimension==vt.dimension){if(e<100)t.targetX=t.x+(t.x-vt.x)/e*100,t.targetY=t.y+(t.y-vt.y)/e*100,t.s=.5*t.speed,t.aiNextTick=s+2e3;else if(s>t.aiNextTick){const e=St(),i=32*Math.random()+16;t.targetX=t.x+e.x*i,t.targetY=t.y+e.y*i,t.s=.5*t.speed,t.aiNextTick=s+2e3}}else if(t.b?.includes(".")&&s>t.aiNextTick){const e=St(),i=32*Math.random()+16;t.targetX=t.x+e.x*i,t.targetY=t.y+e.y*i,t.s=.5*t.speed,t.aiNextTick=s+2e3}if(0==t.eType&&t.dimension==f&&0==f&&Pt(1,t,2*Math.random()*Math.PI,6,at.basicEnemyOrange,10),t.b?.includes("s")&&f==t.dimension&&e<250&&s>=t.nextCanShoot){const e=c(t,vt)-Math.PI/2,i=1.2;bt.get({x:t.x+12*Math.cos(e),y:t.y+12*Math.sin(e),width:5,height:5,dx:Math.cos(e)*i,dy:Math.sin(e)*i,render(){gt.fillStyle=X,gt.beginPath(),gt.ellipse(this.width/2,this.height/2,5,3,2*Math.PI*(s%1e3)/1e3,0,2*Math.PI),gt.fill()},ttl:3e3,anchor:{x:.5,y:.5},update:Ct,seed:Math.random(),dimension:vt.dimension,bulletSpeed:i,team:1}),t.nextCanShoot=s+2e3}const i=Math.hypot(t.x-t.targetX,t.y-t.targetY);i<(t.s??t.speed)?(t.x=t.targetX,t.y=t.targetY):(t.x+=(t.targetX-t.x)/i*(t.s??t.speed),t.y+=(t.targetY-t.y)/i*(t.s??t.speed))}t.returnHp&&(t.hp++,t.hp>=t.returnHp&&(t.spawnEntity(),t.ttl=0,Et(1,t,0,16,O,0,15))),t.update();const e=wt.filter((e=>e!=t&&e.position.distance(t)<3*(e.size??e.width)/8+3*(t.size??t.width)/8)),i=e.some((t=>t==vt));if(i&&0==f&&0==t.dimension&&(f=2,vt.dimension=f,g=0,p=s+500,vt.dx=0,vt.dy=0,v=0,m=T,b=1,M=s+13e3,wt.filter((t=>1==t.box)).forEach((t=>t.ttl=0)),rt.play("death"),nt++,0==Z&&(Z=1,d=1)),i&&1==f&&0==t.dimension&&(rt.play("hit"),t.hp-=5,t.hp<=0&&(y+=10*(m/T|0),m++,rt.play("explosion"),t.ttl=0,t.onDeathSpawn?.(),it[t.eType]++),vt.knockDx=(vt.x-t.x)/vt.position.distance(t)*12,vt.knockDy=(vt.y-t.y)/vt.position.distance(t)*12),t!=vt&&e.length){const i=e[0],s=i.position.distance(t);s>.01&&(t.x+=(t.x-i.x)/s*.2,t.y+=(t.y-i.y)/s*.2)}1==f&&t.returnHp&&vt.position.distance(t)<20&&(rt.play("coin"),v++,A--,t.ttl=0,st[t.eType]++,Et(3,t,-Math.PI/2,20,L,v+"/"+S,60)),t.x-t.width/2<0&&(t.x=t.width/2),t.x+t.width/2>pt.width&&(t.x=pt.width-t.width/2),t.y-t.height/2<0&&(t.y=t.height/2),t.y+t.height/2>pt.height&&(t.y=pt.height-t.height/2)})),wt=wt.filter((t=>t.ttl>0)),0==f||1==f){const t=_(),e=c(vt,t)-Math.PI/2;if(vt.dy=Dt.u?-vt.speed:Dt.d?+vt.speed:0,vt.dx=Dt.l?-vt.speed:Dt.r?+vt.speed:0,1==f&&(vt.dy*=2,vt.dx*=2,Pt(1,vt,vt.frontRotation+Math.PI,4,at.playerSpectralDash,(M-s)/1e3*4|0)),w["left"]&&s>=vt.nextCanShoot){if(0==f&&1==P){const t=20;_t.get({x:vt.x+12*Math.cos(e+.4*C),y:vt.y+12*Math.sin(e+.4*C),color:L,width:8,height:2,dx:Math.cos(e)*t,dy:Math.sin(e)*t,rotation:e,ttl:3e3,anchor:{x:.5,y:.5},update:Ct,dimension:vt.dimension,bulletSpeed:t,team:0}),C=-C,vt.nextCanShoot=s+200,rt.play("shoot")}if(0==f&&2==P){const t=20,i=e+.2*Math.random()-.1;_t.get({x:vt.x+12*Math.cos(e+.4),y:vt.y+12*Math.sin(e+.4),color:L,width:8,height:2,dx:Math.cos(i)*t,dy:Math.sin(i)*t,rotation:i,ttl:3e3,anchor:{x:.5,y:.5},update:Ct,dimension:vt.dimension,bulletSpeed:t,team:0}),vt.nextCanShoot=s+100,rt.play("shoot")}if(0==f&&3==P){const t=20;for(let i=0;i<15;i++){const s=e+.8*Math.random()-.4;_t.get({x:vt.x+12*Math.cos(e+.4),y:vt.y+12*Math.sin(e+.4),color:L,width:8,height:2,dx:Math.cos(s)*t,dy:Math.sin(s)*t,rotation:s,ttl:10,anchor:{x:.5,y:.5},update:Ct,dimension:vt.dimension,bulletSpeed:t,team:0}),setTimeout((()=>{rt.play("shoot")}),10*i)}vt.nextCanShoot=s+800}}}if(function(){if(-1==k||k>s)return;const[t,e,i,h,...n]=ut[xt]??ut[ut.length-1];for(let t=0;n.length>0&&t<(A>i?1:h);t++){const t=It();t&&(At.call(t,{x:0,y:0},n[Math.random()*n.length|0]).hp=1250,A++)}s>=yt&&(xt++,console.log("Wave up!",xt),yt=s+1e3*(ut[xt]??ut[--xt])[0]),k=s+e+2e3*Math.random()}(),m=Math.min(10*T,m),0==f&&wt.filter((t=>1==t.box)).length<(m/T|0)-b){const t=Math.min(lt.length-1,P+1),e=It();e&&function(t,e,i){Et(2,{x:t,y:e},0,500,X,0,60);const h=u({x:t,y:e,box:1,mainWeapon:i,image:at.dualPistolOrange,update(){vt.position.distance(this)<this.width/2+vt.width/2&&(this.mainWeapon&&(P=this.mainWeapon),rt.play("pickup"),ht++,v=0,b=m/T|0,T=5+5*Math.pow(P,1.3)|0,console.log("levelUpEnergyGoal",T),this.ttl=0,wt.filter((t=>1==t.box&&t.ttl>0)).forEach((t=>{const e=100*(m/T|0);y+=e,Et(3,t,-Math.PI/2,20,L,"+"+e,60),t.ttl=0})),Et(3,this,-Math.PI/2,20,L,ot[P],60),Et(1,this,0,500,X,0,60),f=1,vt.dimension=f,M=s+11e3,wt.filter((t=>t!=vt&&vt.position.distance(t)<100)).forEach((t=>{t.knockDx=(t.x-vt.x)/vt.position.distance(t)*12,t.knockDy=(t.y-vt.y)/vt.position.distance(t)*12})),0==J&&(J=1,d=1))},render(){const t=-this.image.width/2,e=-this.image.height/2;gt.globalAlpha=1,gt.strokeStyle=Y,gt.beginPath(),gt.ellipse(0,0,6,12,s%2e3/2e3*2*Math.PI,0,2*Math.PI),gt.stroke(),gt.strokeStyle=z,gt.beginPath(),gt.ellipse(0,0,6,10,-s%3e3/3e3*2*Math.PI,0,2*Math.PI),gt.stroke(),this.mainWeapon&&gt.drawImage(lt[this.mainWeapon],t,e,lt[this.mainWeapon].width,lt[this.mainWeapon].height)}});wt.push(h)}(e.x,e.y,t)}1==f&&s>=M&&(v<S?(a++,y>x&&localStorage.setItem("dicksonmd.spectralShooter.hiScore",y),rt.play("game_over")):(v>=2*S&&(m+=T,Et(3,vt,-Math.PI/2,20,L,"Souls bonus (Heat +1)",60)),f=0,vt.dimension=f,v=0,S=Math.ceil(1.2*S),rt.play("respawn"),wt.filter((t=>t!=vt&&vt.position.distance(t)<100)).forEach((t=>{t.knockDx=(t.x-vt.x)/vt.position.distance(t)*12,t.knockDy=(t.y-vt.y)/vt.position.distance(t)*12})),wt.filter((t=>t.b?.includes("s"))).forEach((t=>{t.nextCanShoot=s+1e3+1e3*Math.random()})))),2==f&&s>=p?(f=3,p=s+1e3,vt.dimension=f):3==f&&s>=p?(f=4,p=s+i,vt.dimension=f,rt.play("enter_spectral")):4==f&&s>=p&&(f=1,vt.dimension=f)}},render(){ft.clearRect(0,0,dt.width,dt.height),gt.save(),gt.fillStyle="#777777",gt.fillRect(0,0,pt.width,pt.height);const t=gt.createRadialGradient(pt.width/2,pt.height/2,30,pt.width/2,pt.height/2,300);t.addColorStop(0,"#120656"),t.addColorStop(1,R),1==f||0==f?g=f:4==f&&p-s<i&&(g=1-(p-s)/i),1==f&&(gt.fillStyle=t,gt.globalAlpha=g,gt.fillRect(0,0,pt.width,pt.height)),Q<3?(gt.fillStyle=t,gt.globalAlpha=1,gt.fillRect(0,0,pt.width,pt.height)):(gt.globalAlpha=.4,[[80,96],[80,112],[96,112],[112,112],[96,128],[240,48],[272,144],[288,144],[304,144],[288,160],[304,160],[320,160],[400,32],[400,48],[400,64],[400,80],[400,96],[416,48],[416,64],[416,80],[416,96],[416,112],[160,208],[176,208],[192,208],[208,224],[208,240],[224,224]].forEach((([t,e])=>gt.drawImage(at.floorTile1,t,e))),gt.globalAlpha=1);const e=gt.createRadialGradient(vt.x,vt.y,0,vt.x,vt.y,20);if(e.addColorStop(0,"#ffffff55"),e.addColorStop(.7,"#ffffff11"),e.addColorStop(1,"#ffffff00"),gt.beginPath(),gt.arc(vt.x,vt.y,100,0,2*Math.PI),gt.fillStyle=e,gt.fill(),[mt,...wt,_t,bt].forEach((t=>{t==vt&&0!=f&&1!=f||t.render(),t.returnHp-t.hp<180&&(gt.fillStyle=O,gt.globalAlpha=.3,gt.fillRect(t.x-t.width/2|0,t.y+12|0,t.width,2),gt.globalAlpha=1,gt.fillRect(t.x-t.width/2|0,t.y+12|0,t.width*(180-t.returnHp+t.hp)/180,2))})),2==f){let t=1-(p-s)/500;t*=t;const e=vt.image.width+1e4*t,i=vt.image.height*(1-t);gt.drawImage(vt.image,vt.x-e/2,vt.y-i/2,e,i)}else if(4==f){let t=(p-s)/i;t*=t;const e=vt.image.width+1e4*t,h=vt.image.height*(1-t);gt.drawImage(vt.image,vt.x-e/2,vt.y-h/2,e,h)}else{const t=_(),e=vt.x,i=vt.y,s=t.x-e,h=t.y-i;gt.save(),gt.strokeStyle=f?z:X,gt.lineWidth=1,gt.globalAlpha=.3,gt.beginPath(),gt.moveTo(e,i),gt.lineTo(e+100*s,i+100*h),gt.stroke(),gt.restore()}if(Q>=3){ft.textAlign="left",ft.fillStyle=L,ft.font="16px sans-serif",ft.fillText("Score:",24,44),ft.font="28px sans-serif",ft.fillText(y,72,44),m>10&&(ft.font="16px sans-serif",ft.fillText("Heat:",24,94),ft.textAlign="center",ft.fillText((m/T|0)+"x",98,94),ft.strokeStyle=L,ft.lineWidth=4,ft.beginPath(),ft.arc(98,88,24,Math.PI,Math.PI+m%T/T*2*Math.PI),ft.stroke());const t=wt.filter((t=>null!=t.returnHp)).length>=S-v;ft.textAlign="right",ft.fillStyle=L,ft.font="16px sans-serif",ft.fillText("Collectable souls:",dt.width-24-56,44),ft.fillStyle=t?L:X,ft.font="28px sans-serif",ft.fillText(wt.filter((t=>null!=t.returnHp)).length,dt.width-24,44),ft.fillStyle=L,ft.beginPath(),ft.arc(44,dt.height-64+20,20,0,2*Math.PI),ft.fill(),lt[P]&&ft.drawImage(lt[P],28,dt.height-64+4,32,32),ft.font="16px sans-serif",ft.textAlign="left",ft.fillText(ot[P],72,dt.height-64+20+8)}if(!a){if(ft.font="120px sans-serif",ft.textAlign="center",ft.fillStyle=L,1==f&&M-s<1e4&&(ft.globalAlpha=.8,ft.fillText((M-s)/1e3|0,dt.width/2,dt.height/2)),0==Q&&(ft.font="72px sans-serif",ft.fillText("Spectral-Shooter",dt.width/2,dt.height/2-80),ft.font="16px sans-serif",ft.textAlign="center",ft.fillStyle=L,ft.globalAlpha=1,ft.fillText("A js13k game By Dickson",dt.width/2,dt.height/2-40),ft.fillText("Press <Space> to start game",dt.width/2,500)),ft.font="16px sans-serif",ft.textAlign="center",ft.fillStyle=L,ft.globalAlpha=1,1==Q&&d){let t=200;ft.fillText("Undeads don't actually die. ",dt.width/2,t+=20),ft.fillText("They go into the spectral world, and respawn after some time.",dt.width/2,t+=20),t+=20,ft.fillText("You are an undead hunter, gifted with the ability to move ",dt.width/2,t+=20),ft.fillText("between the physical world, and the spectral world.",dt.width/2,t+=20),t+=20,t+=20,ft.fillText("Dive into the spectral world to kill them for good.",dt.width/2,t+=20),ft.fillText("Press <Space> to proceed",dt.width/2,500)}if(2==Q&&d){let t=260;ft.fillText("If you ever find yourself dead, ",dt.width/2,t+=20),ft.fillText("just collect some souls from the spectral world to revive.",dt.width/2,t+=20),ft.fillText("Press <Space> to proceed",dt.width/2,500)}if(3==Q&&y<50&&0==f){let t=460;ft.fillText("Move around using WASD, ZQSD, or ← ↓ ↑ →",dt.width/2,t+=40),ft.fillText("Aim with mouse and shoot by holding left click.",dt.width/2,t+=40)}else if(3==Q&&!J&&y<250&&0==f){let t=460;ft.fillText("Monsters can revive from the dead, but so can you.",dt.width/2,t+=40),ft.fillText("Collect an upgrade to enter the spectral world without dying!",dt.width/2,t+=40)}if(1==f&&S>v?ft.fillText(`Collect ${v}/${S} souls to revive.`,dt.width/2,360):1==f&&ft.fillText("Reviving shortly...",dt.width/2,360),1==Z&&d){ft.globalAlpha=.8,ft.fillStyle=R,ft.fillRect(dt.width/2-300,dt.height/2-180,600,360),ft.fillStyle=L,ft.globalAlpha=1,ft.font="28px sans-serif",ft.fillText("Spectral Revive",dt.width/2,220),ft.font="16px sans-serif";let t=280;ft.fillText("You have died, for now.",dt.width/2,t+=20),ft.fillText(`Collect ${S} souls to return to the physical world.`,dt.width/2,t+=20),ft.fillText("You can also collide into enemies to knock their soul out!",dt.width/2,t+=20),ft.fillText("Press <Space> to proceed",dt.width/2,440)}if(1==J&&d){ft.globalAlpha=.8,ft.fillStyle=R,ft.fillRect(dt.width/2-300,dt.height/2-180,600,360),ft.fillStyle=L,ft.globalAlpha=1,ft.font="28px sans-serif",ft.fillText("Spectral Dash",dt.width/2,220),ft.font="16px sans-serif";let t=280;ft.fillText("You have entered the spectral world through collecting an upgrade.",dt.width/2,t+=20),ft.fillText(`Collect ${S} souls to return to the physical world with your new gun!`,dt.width/2,t+=20),t+=20,ft.fillText("While you are at it, collect more souls to reduce the clutter.",dt.width/2,t+=20),ft.fillText("You can also collide into enemies to knock their soul out!",dt.width/2,t+=20),ft.fillText("Press <Space> to proceed",dt.width/2,440)}ft.textAlign="right",ft.fillText("Press <Tab> to pause",936,584),rt.volume?ft.fillText("Press <M> to Mute",936,604):ft.fillText("Press <M> to Unmute",936,604)}if(a){a++,ft.fillStyle=R,ft.globalAlpha=.7*Math.min(1,a/5/60),ft.fillRect(0,0,dt.width,dt.height),ft.globalAlpha=1;let t=180;ft.fillStyle=L,ft.textAlign="center",ft.font="72px sans-serif",ft.fillText("Game Over",dt.width/2,t+=20),t+=20,t+=20;let e=t;ft.font="16px sans-serif",ft.textAlign="right",ft.fillText("Score: ",dt.width/2,t+=20),ft.fillText("Hi-Score: ",dt.width/2,t+=20),t+=20,ft.fillText("Time: ",dt.width/2,t+=20),ft.fillText("Highest heat: ",dt.width/2,t+=20),ft.fillText("Kills: ",dt.width/2,t+=20),ft.fillText("Souls collected: ",dt.width/2,t+=20),ft.fillText("Upgrades collected: ",dt.width/2,t+=20),ft.fillText("Misses: ",dt.width/2,t+=20),ft.textAlign="left",ft.font="28px sans-serif",ft.fillText(y,dt.width/2,e+=20),ft.font="16px sans-serif",y<x?ft.fillText(x,dt.width/2,e+=20):ft.fillText(`${x} → ${y}`,dt.width/2,e+=20),e+=20,ft.fillText(`${s/6e4|0}m${(s/1e3|0)%60}s (${h/1e3|0}s in spectral world)`,dt.width/2,e+=20),ft.fillText(`${et}x (${(tt/100|0)/10}s)`,dt.width/2,e+=20),ft.fillText(`${it.reduce(((t,e)=>t+e),0)} (${it.join(", ")})`,dt.width/2,e+=20),ft.fillText(`${st.reduce(((t,e)=>t+e),0)} (${st.join(", ")})`,dt.width/2,e+=20),ft.fillText(ht,dt.width/2,e+=20),ft.fillText(nt,dt.width/2,e+=20),ft.textAlign="center",ft.fillText(`Collect ${v}/${S} souls to revive.`,dt.width/2,560),ft.fillStyle=Date.now()%500>250?X:L,ft.fillText("Press <Space> to restart",dt.width/2,500)}o&&(ft.fillStyle=Date.now()%500>250?X:L,ft.textAlign="center",ft.font="16px sans-serif",ft.fillText("Game Paused",dt.width/2,dt.height/2)),ft.strokeStyle=L,ft.lineWidth=1.5,ft.strokeRect(10,10,dt.width-20,dt.height-20),gt.restore()}});Xt.start()}})()})();</script><style type="text/css">body,html{font-family:sans-serif;height:100%;margin:0;padding:0;width:100%}body{background:#fff}.container{box-sizing:content-box;margin:0 auto 64px;padding:1em;width:960px}#game{position:relative}#a,#game{height:640px;width:960px}#a{background:#f5f5f5;image-rendering:pixelated}#a,#b{position:absolute}#b{height:640px;pointer-events:none;width:960px}</style></head><body><div class="container"><div id="game"><canvas id="a" width="480" height="320"></canvas><canvas id="b" width="960" height="640"></canvas></div><h3>Spectral-Shooter-13k</h3><p>By Dickson Chui (vicksonzero)<br>- Use WASD, ZQSD, or Arrow keys to move.<br>- Use mouse to aim, left click to shoot.<br></p><p><a href="https://github.com/vicksonzero/spectral-shooter">Source code here</a> | <a href="https://vicksonzero.itch.io/spectral-shooter">Comment here</a></p></div></body></html>