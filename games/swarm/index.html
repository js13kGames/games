<!doctype html><title>Swarm - js13kGames 2012</title><canvas id=canvas height=300 width=600 style=border:solid></canvas><br><progress id=progress value=50 max=100></progress><br><span id=level></span><br><ul><li>Use the arrow keys to move.<li>Avoid red rectangles.<li>Gather green rectangles for a health bonus.<li>Hit the space bar to pause.</ul>Cross all 10 levels if you can!<style>progress,progress::-webkit-progress-bar{appearance:none;-moz-appearance:none;-webkit-appearance:none;border:none;background-size:auto;width:600px;height:10px}</style><script>function t(t){var l,d,s,c,M,m,f,u=0,v=0*Math.PI/180,g=1;this.stopped=!1,t?(l=300,d=200,M=10,this.health=255,m=0,f=50*Math.pow(o,2)):(l=Math.random()*(a.width+100)-100,d=Math.random()*(a.height+100)-100,0<l&&l<a.width&&0<d&&d<a.height&&(.5<Math.random()?l=.5<Math.random()?-50*Math.random():a.width+50*Math.random():d=.5<Math.random()?-50*Math.random():a.height+50*Math.random()),M=2+5*Math.random()),this.anim=function(){var p=Math.atan(.5);Math.sqrt(500),Math.cos((90-180*v/Math.PI)*Math.PI/180),Math.sin((90-180*v/Math.PI)*Math.PI/180),Math.cos(v+p),Math.sin(v+p),Math.cos(v),Math.sin(v),t?(0<u&&(i[39]&&(v+=10*Math.PI/180),i[37])&&(v-=10*Math.PI/180),i[38]?u+=g=1:!0===this.stopped&&(u-=g)<=0&&(u=0,this.stopped=!1)):(u=M,v=Math.atan2(r.y-d,r.x-l)),s=(u=M<u?M:u)*Math.cos(v),c=u*Math.sin(v),d+=c,l=(l+=s)>a.width?0:l<0?a.width:l,d=d>a.height?0:d<0?a.height:d,t?(this.x=l,this.y=d,m+=h/30,n.value=m,f<m&&(o++,document.getElementById("level").textContent=o,m=0,w(20*o),f=50*Math.pow(o,2),n.max=f),r.health<=0&&(w(20*o),m=0)):Math.sqrt(Math.pow(r.x-l,2)+Math.pow(r.y-d,2))<20&&(this.anim=function(){},r.health-=0===t?-80:10,0!==t)&&h--,e.save(),e.translate(l,d),e.rotate(v),e.fillStyle=t?"black":0===t?"green":"maroon",e.strokeStyle="white",e.fillRect(0,0,20,10),e.strokeRect(0,0,20,10),e.restore()}}var h,a=document.getElementById("canvas"),e=a.getContext("2d"),n=document.getElementById("progress"),i={},o=1,l=!1,r=new t(!0);window.addEventListener("keydown",function(t){i[t.which]=!0,32===t.which&&(l=!0===l?(M=window.setInterval(function(){e.fillStyle="rgb(255,"+r.health+","+r.health+")",e.fillRect(0,0,a.width,a.height),e.fill(),c(),10<o&&window.clearInterval(M)},100/3),!1):(window.clearInterval(M),!0))},!1),window.addEventListener("keyup",function(t){delete i[t.which],38===t.which&&(r.stopped=!0)},!1);var d,s=[],w=function(a){d=[],s.forEach(function(t){window.clearInterval(t)}),s=[],h=a,r.health=255;for(var e=5,n=1;n<=a;n++)(function(h){s.push(setTimeout(function(){d.push(new t(h))},1e3*Math.random()*e))})(0==n%30&&0),0==n%10&&(e+=5)},c=function(){r.anim();for(var t=d.length-1;0<=t;t--)d[t].anim()},M=(w(20*o),window.setInterval(function(){e.fillStyle="rgb(255,"+r.health+","+r.health+")",e.fillRect(0,0,a.width,a.height),e.fill(),c(),10<o&&window.clearInterval(M)},100/3))</script>