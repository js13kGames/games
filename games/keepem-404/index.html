<html><head><meta name="monetization" content="$coil.xrptipbot.com/B6BW9YpKR22WWbQOJ4GsPg"><title>Keep'em 404</title><script src=/2020/webxr/aframe.js></script><script>AFRAME.registerComponent("block-entity",{init(){var t=new THREE.BoxBufferGeometry(1,1,1);const e=createPixelMaterial(3);this.pixelMaterial=createPixelMaterial(9,"#ffffff",6);var i=[e,e,e,e,this.pixelMaterial,e],s=new THREE.Mesh(t,i);this.el.setObject3D("mesh",s),this.q=0,this.t=0},tick(t,e){this.t+=e,this.t>200&&(this.q=(this.q+1)%5,this.pixelMaterial.uniforms.lookupShift.value=this.q,this.t=0)}}),AFRAME.registerComponent("bullet",{schema:{speed:{default:.1},target:{type:"selector"},damage:{default:1},special:{default:5},specialDamage:{default:5}},init(){this.dir=new THREE.Vector3,this.data.target&&(this.enemy=this.data.target.components.enemy)},update(t){},tick(t,e){if(!this.data.target||0==this.data.target.object3D.position.y&&0==this.data.target.object3D.position.z&&0==this.data.target.object3D.position.x)this.el.remove();else if(this.el.object3D.position.distanceTo(this.data.target.object3D.position)>1)this.dir.subVectors(this.data.target.object3D.position,this.el.object3D.position).normalize(),this.dir.multiplyScalar(this.data.speed),this.el.object3D.position.add(this.dir);else{const t=this.enemy.data.type===this.data.special?this.data.specialDamage:this.data.damage;this.enemy.hit(t),createExplosion(this.el,this.el.object3D.position,"#ff0000",.05,10,6e3,2),this.el.remove()}}}),AFRAME.registerComponent("click-handler",{schema:{type:"int"},init(){this.el.addEventListener("click",()=>{this.el.sceneEl.components.game.clicked(this,this.data)})}}),AFRAME.registerComponent("disable-menu",{schema:{type:"number"},init(){this.enabled=!0,this.isSelected=!1,this.oldPos=this.el.object3D.position.z,this.el.sceneEl.addEventListener("update-score",t=>{let e=this.el.sceneEl.components.game.placable[this.data];e&&t.detail<e[1]?(this.el.object3D.scale.set(.5,.5,.5),this.el.object3D.position.z=this.oldPos,this.el.classList.remove("clickable"),this.enabled=!1):(this.el.object3D.scale.set(1,1,1),this.el.classList.add("clickable"),this.enabled=!0)}),this.el.sceneEl.addEventListener("item-selected",t=>{t.detail===this.data?(this.el.object3D.position.z=this.oldPos+.75,this.isSelected=!0):(this.el.object3D.position.z=this.oldPos,this.enabled?this.el.object3D.scale.set(1,1,1):this.el.object3D.scale.set(.5,.5,.5),this.isSelected=!1)})}});const COLORS=["#601114","#11601c","#2b2b49","#2a3b4e","#eb8931"],SPRITE_INDICES=[15,16,17,18,19];function closestEnemy(t,e=5){const i=document.querySelectorAll("[enemy]");let s,a=e;return i.forEach(i=>{if(i.components.enemy.immune>0)return{found:!1};if(Math.abs(i.object3D.position.x-t.x)>e||Math.abs(i.object3D.position.y-t.y)>e||Math.abs(i.object3D.position.z-t.z)>e)return{found:!1};const o=t.distanceTo(i.object3D.position);a>o&&(s=i,a=o)}),{found:s,distance:a}}function createExplosion(t,e,i,s=.1,a=32,o=2e3,n=5,r=500){if(t.parentElement){let l=document.createElement("a-entity");l.setAttribute("explosion",{color:i,size:s,velocityStart:a,outward:o,burst:n,lifetime:r}),l.setAttribute("position",e),t.parentElement.append(l)}}AFRAME.registerComponent("enemy",{schema:{speed:{default:5},health:{default:80},value:{default:1},type:{default:1},spawner:{default:-1}},init(){this.immune=1e3,this.game=this.el.sceneEl.components.game,this.alive=!0,this.el.sceneEl.addEventListener("gameOver",this.gameOver.bind(this)),this.targetIndex=0,this.target=new THREE.Vector3(...this.game.nextTarget(this.targetIndex,this.data.spawner)),this.direction=this.target.clone().sub(this.el.object3D.position).normalize(),this.distance=this.el.object3D.position.distanceTo(this.target),this.fakedist=this.distance,this.auxVector=new THREE.Vector3,this.bob=0;const t=new THREE.BoxBufferGeometry(1,1,1),e=createPixelMaterial(SPRITE_INDICES[this.data.type]),i=new THREE.MeshStandardMaterial;var s=[e,e,i,i,i,i];const a=new THREE.Mesh(t,s);this.el.setObject3D("mesh",a)},tick(t,e){if(!this.alive)return;this.immune>0&&(this.immune-=e),this.auxVector.copy(this.direction),this.bob+=e/100;const i=e/1e3*this.data.speed;if(this.el.object3D.position.add(this.auxVector.multiplyScalar(i)),this.el.object3D.position.y+=Math.sin(this.bob)/100,this.fakedist-=i,.01>this.fakedist){this.targetIndex++;const t=this.game.nextTarget(this.targetIndex,this.data.spawner);t?(this.el.object3D.position=this.target,this.target=new THREE.Vector3(...t),null!==this.target&&(this.direction=this.target.clone().sub(this.el.object3D.position).normalize(),this.el.setAttribute("rotation",{y:0!=Math.round(this.direction.z)?rotate=90:0}),this.fakedist=this.el.object3D.position.distanceTo(this.target))):(this.game.gameOver(),this.alive=!1)}},hit(t){if(this.data.health-=t,0>=this.data.health&&this.el)try{this.die(),sound.play(1,this.el.object3D),this.game.kill(this.data.value)}catch{}},die(){createExplosion(this.el,this.el.object3D.position,COLORS[this.data.type]),this.el&&this.el.parentNode&&this.el.remove()},gameOver(){this.data.alive=!1,setTimeout(this.die.bind(this),1e3*Math.random())}}),AFRAME.registerComponent("explosion",{schema:{color:{type:"color"},size:{default:.25},velocityStart:{default:32},outward:{default:2e3},burst:{default:5},lifetime:{default:500}},init(){this.tick=AFRAME.utils.throttleTick(this.tick,1/30,this),this.particleCount=75,this.particles=new THREE.BufferGeometry,this.velocities=[];let t=[];this.material=new THREE.PointsMaterial({size:this.data.size,color:new THREE.Color(this.data.color)});for(var e=0;e<this.particleCount;e++){let e=new THREE.Vector3((Math.random()-.5)*this.data.velocityStart,(Math.random()-.5)*this.data.velocityStart,(Math.random()-.5)*this.data.velocityStart);t.push(Math.random()*this.data.burst-this.data.burst/2,Math.random()*this.data.burst-this.data.burst/2,Math.random()*this.data.burst-this.data.burst/2),this.velocities.push(e)}this.particles.setAttribute("position",new THREE.Float32BufferAttribute(t,3)),this.particleSystem=new THREE.Points(this.particles,this.material),this.el.setObject3D("particle-system",this.particleSystem),this.el.setAttribute("selfdestruct",{timer:this.data.lifetime})},tick(t,e){this.material.size=Math.max(this.material.size-e/4e3,0);var i=this.particleSystem.geometry.attributes.position;for(let t=0;t<i.count;t++){var s=i.getX(t),a=i.getY(t),o=i.getZ(t);const n=e/this.data.outward;i.setXYZ(t,s+this.velocities[t].x*n,a+this.velocities[t].y*n,o+this.velocities[t].z*n),this.velocities[t].y-=64*e/1500}i.needsUpdate=!0}});const forwardVector=new THREE.Vector3(0,0,1),zeroVector=new THREE.Vector3(0,0,0);function SfxrParams(){this.setSettings=function(t){for(var e=0;24>e;e++)this[String.fromCharCode(97+e)]=t[e]||0;.01>this.c&&(this.c=.01);var i=this.b+this.c+this.e;if(.18>i){var s=.18/i;this.b*=s,this.c*=s,this.e*=s}}}function SfxrSynth(){var t,e,i,s,a,o,n,r,l,h,d,c;this._params=new SfxrParams,this.reset=function(){var t=this._params;s=100/(t.f*t.f+.001),a=100/(t.g*t.g+.001),o=1-t.h*t.h*t.h*.01,n=-t.i*t.i*t.i*1e-6,t.a||(d=.5-t.n/2,c=5e-5*-t.o),r=1+t.l*t.l*(t.l>0?-.9:10),l=0,h=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var s=this._params;return t=s.b*s.b*1e5,e=s.c*s.c*1e5,i=s.e*s.e*1e5+12,3*((t+e+i)/3|0)},this.synthWave=function(u,p){var m=this._params,f=1!=m.s||m.v,b=m.v*m.v*.1,v=1+3e-4*m.w,g=m.s*m.s*m.s*.1,x=1+1e-4*m.t,y=1!=m.s,E=m.x*m.x,A=m.g,w=m.q||m.r,S=m.r*m.r*m.r*.2,R=m.q*m.q*(0>m.q?-1020:1020),k=m.p?32+((1-m.p)*(1-m.p)*2e4|0):0,M=m.d,T=m.j/2,C=m.k*m.k*.01,D=m.a,j=t,I=1/t,z=1/e,H=1/i,V=5/(1+m.u*m.u*20)*(.01+g);V>.8&&(V=.8),V=1-V;for(var B,F,P,L,q,N,O=!1,X=0,Q=0,G=0,U=0,Z=0,J=0,K=0,Y=0,W=0,$=0,_=Array(1024),tt=Array(32),et=_.length;et--;)_[et]=0;for(et=tt.length;et--;)tt[et]=2*Math.random()-1;for(et=0;p>et;et++){if(O)return et;if(k&&(++W<k||(W=0,this.reset())),h&&(++l<h||(h=0,s*=r)),(s*=o+=n)>a&&(s=a,A>0&&(O=!0)),F=s,T>0&&(F*=1+Math.sin($+=C)*T),8>(F|=0)&&(F=8),D||(0>(d+=c)?d=0:d>.5&&(d=.5)),++Q>j)switch(Q=0,++X){case 1:j=e;break;case 2:j=i}switch(X){case 0:G=Q*I;break;case 1:G=1+2*(1-Q*z)*M;break;case 2:G=1-Q*H;break;case 3:G=0,O=!0}w&&(0>(P=0|(R+=S))?P=-P:P>1023&&(P=1023)),f&&v&&(1e-5>(b*=v)?b=1e-5:b>.1&&(b=.1)),N=0;for(var it=8;it--;){if(++K>=F&&(K%=F,3==D))for(var st=tt.length;st--;)tt[st]=2*Math.random()-1;switch(D){case 0:q=d>K/F?.5:-.5;break;case 1:q=1-K/F*2;break;case 2:q=.225*((0>(q=1.27323954*(L=6.28318531*((L=K/F)>.5?L-1:L))+.405284735*L*L*(0>L?1:-1))?-1:1)*q*q-q)+q;break;case 3:q=tt[Math.abs(32*K/F|0)]}f&&(B=J,0>(g*=x)?g=0:g>.1&&(g=.1),y?(Z+=(q-J)*g,Z*=V):(J=q,Z=0),U+=(J+=Z)-B,q=U*=1-b),w&&(_[Y%1024]=q,q+=_[(Y-P+1024)%1024],Y++),N+=q}N*=.125*G*E,u[et]=1>N?N>-1?32767*N|0:-32768:32767}return p}}AFRAME.registerComponent("game",{init(){this.s=level.start,this.el.addEventListener("kill",this.kill.bind(this)),this.currentlyPlacing=0,this.placable=[[0,1,7,1,50,25,50,9,13,2,5,100,200,3,4,3,6],[1,3,7,2,60,50,100,9,13,4,10,120,250,1,6,8,12],[2,5,7,3,70,75,150,9,13,6,15,160,300,4,9,14,20],[3,8,7,3,80,100,200,9,13,8,20,200,400,2,11,16,25],[4,10,7,3,90,150,300,9,13,10,25,250,500,0,13,18,40]],this.el.sceneEl.addEventListener("enter-vr",this.enterVr.bind(this)),this.el.sceneEl.addEventListener("exit-vr",this.exitVr.bind(this)),this.updateScore(25),this.menu=document.getElementById("menu"),this.titlescreen=document.getElementById("titlescreen"),this.gameoverscreen=document.getElementById("gameoverscreen"),this.camera=document.getElementById("camera"),this.leftHand=document.getElementById("left-hand-menu"),this.cursor=document.getElementById("cursor"),this.rightHand=document.getElementById("right-hand"),this.towerTarget=document.getElementById("defense"),this.container=document.getElementById("world"),this.mode=0,this.isVR=!1,this.messages=document.querySelectorAll(".message"),this.setMessage(""),this.state=0,this.processState(),this.rightHand.setAttribute("visible","false")},tick(){if(audioContext){const t=this.el.camera.getWorldPosition(zeroVector);audioContext.listener.positionX.value=t.x,audioContext.listener.positionY.value=t.y,audioContext.listener.positionZ.value=t.z;const e=this.el.sceneEl.camera.getWorldDirection(forwardVector);audioContext.listener.forwardX.value=e.x,audioContext.listener.forwardY.value=e.y,audioContext.listener.forwardZ.value=e.z}},kill(t){this.updateScore(this.score+t)},enterVr(){this.isVR=!0,this.menu.remove(),this.leftHand.setAttribute("visible","true"),this.rightHand.setAttribute("visible","true"),this.cursor.setAttribute("raycaster",{enabled:!1}),this.setRaycaster(".clickable, .upgradable")},exitVr(){this.isVR=!1,this.menu.setAttribute("visible","true"),this.leftHand.setAttribute("visible","false"),this.rightHand.setAttribute("visible","false"),this.rightHand.setAttribute("raycaster",{enabled:!1}),this.setRaycaster(".clickable, .upgradable")},clicked(t,e){if(1===this.state)switch(e){case 5:this.mode=2,sound.play(3,this.el.camera),this.setRaycaster(".clickable, .upgradable"),this.el.emit("item-selected",5);break;case 7:if(1===this.mode){if(0>this.score-this.placable[this.currentlyPlacing][1]){this.el.emit("item-selected");break}this.setRaycaster(".clickable"),this.updateScore(this.score-this.placable[this.currentlyPlacing][1]),t.el.remove();const e=document.createElement("a-entity");e.setAttribute("mixin","template-defense"),e.classList.add("upgradable"),e.setAttribute("position",t.el.object3D.position),sound.play(6,t.el.object3D),e.setAttribute("tower",{type:this.placable[this.currentlyPlacing][0],data:this.placable[this.currentlyPlacing],rot:t.el.components["placeholder-entity"].data.rot}),this.towerTarget.append(e)}if(2===this.mode){var i=t.el.components.tower;if(!i||2==i.data.level)break;if(0==i.data.level){if(0>this.score-i.data.data[5])return void this.setMessage(`Not enough money to upgrade ($${i.data.data[5]}0K)`);this.updateScore(this.score-i.data.data[5])}else{if(0>this.score-i.data.data[6])return void this.setMessage(`Not enough money to upgrade ($${i.data.data[6]}0K)`);this.updateScore(this.score-i.data.data[6])}sound.play(5,i.el.object3D),t.el.setAttribute("tower",{level:i.data.level+1,animated:1===i.data.level}),this.setRaycaster(".clickable"),this.el.emit("item-selected")}break;case 42:break;default:this.mode=1,this.setRaycaster(".clickable, .placable"),sound.play(3,this.el.camera),this.currentlyPlacing=e,this.el.emit("item-selected",e)}else 42===e&&(this.state=1,this.processState())},processState(){switch(this.state){case 0:document.querySelectorAll(".screen").forEach(t=>t.classList.add("clickable")),this.gameoverscreen.setAttribute("visible","false"),this.titlescreen.setAttribute("visible","true"),this.menu.setAttribute("visible","false"),this.leftHand.setAttribute("visible","false");break;case 1:document.querySelectorAll(".screen").forEach(t=>t.classList.remove("clickable")),InitAudio(),this.createLevel(),this.updateScore(25),this.el.emit("startGame"),this.gameoverscreen.setAttribute("visible","false"),this.menu.setAttribute("visible",this.isVR?"false":"true"),this.leftHand.setAttribute("visible",this.isVR?"true":"false"),this.titlescreen.setAttribute("visible","false");break;case 2:document.querySelectorAll(".screen").forEach(t=>t.classList.add("clickable")),this.gameoverscreen.setAttribute("visible","true"),this.menu.setAttribute("visible","false"),this.leftHand.setAttribute("visible","false")}},createLevel(){document.getElementById("defense").innerHTML="",document.getElementById("world").innerHTML="",level.targets.forEach((t,e)=>{const i=document.createElement("a-entity");i.setAttribute("mixin","template-spawner"),i.innerHTML='<a-entity block-entity position="0 0 -.9"></a-entity>';const s=new THREE.Vector3(...t[0]);i.setAttribute("position",s);const a=new THREE.Vector3(...t[1]).sub(s).normalize();let o=0>Math.round(a.x)?270:90;0>Math.round(a.z)?o=180:Math.round(a.z)>0&&(o=0),i.setAttribute("rotation",{y:o}),i.setAttribute("spawner",{id:e}),this.container.append(i)}),this.page=document.createElement("a-entity"),this.page.setAttribute("mixin","template-page"),this.page.setAttribute("position",new THREE.Vector3(...level.end)),this.container.append(this.page),level.placeholders.forEach(t=>{this.placePlaceholder(t)}),level.box.forEach((t,e)=>{const i=document.createElement("a-box");i.setAttribute("position",new THREE.Vector3(...t[0])),i.setAttribute("scale",new THREE.Vector3(t[1],t[1],t[1])),i.setAttribute("pixelshader-material",`index:12;repeat:${t[1]} ${t[1]};lookup:${t[2]}`),this.container.append(i)})},nextTarget:(t,e)=>t>=0&&t<level.targets[e].length?level.targets[e][t]:null,gameOver(){2!=this.state&&(this.state=2,sound.play(2,this.el.camera),this.el.emit("gameOver"),createExplosion(this.container,this.page.object3D.position,"#ffffff",.3,32,4e3,8,1500),this.page.remove(),this.processState())},updateScore(t){this.score=t,this.el.emit("update-score",t)},placePlaceholder(t){const e=document.createElement("a-entity");e.setAttribute("mixin","template-placeholder"),e.setAttribute("click-handler","7"),e.setAttribute("position",new THREE.Vector3(...t.slice(0,3))),e.setAttribute("rotation",{x:0===t[3]?90:0,y:2===t[3]?90:0,z:1===t[3]?90:0}),e.setAttribute("placeholder-entity",{rot:t[3]}),e.classList.add("clickable"),this.container.append(e)},setRaycaster(t){this.isVR?(this.rightHand.setAttribute("raycaster",{objects:t,enabled:!0,far:40}),this.rightHand.components.raycaster.refreshObjects()):this.cursor.setAttribute("raycaster",{objects:t,enabled:!0,far:40})},setMessage(t){this.messages.forEach(e=>e.setAttribute("text",{value:t})),t||setTimeout(()=>this.setMessage(""),7e3)}});var synth=new SfxrSynth;const jsfxr=t=>{synth._params.setSettings(t);var e=synth.totalReset(),i=new Uint8Array(4*((e+1)/2|0)+44),s=2*synth.synthWave(new Uint16Array(i.buffer,44),e),a=new Uint32Array(i.buffer,0,44);a[0]=1179011410,a[1]=s+36,a[2]=1163280727,a[3]=544501094,a[4]=16,a[5]=65537,a[6]=44049,a[7]=88200,a[8]=1048578,a[9]=1635017060,a[10]=s,s+=44;for(var o=0,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",r="data:audio/wav;base64,";s>o;o+=3){var l=i[o]<<16|i[o+1]<<8|i[o+2];r+=n[l>>18]+n[l>>12&63]+n[l>>6&63]+n[63&l]}return r};var level={targets:[[[-19,3,8],[-19,3,-6],[-16,-1,-6],[-6,-1,-6],[-6,-1,-12],[6,-1,-12],[6,-1,-6],[20,-1,-6],[20,2,-2],[20,2,9],[-12,2,9],[-12,8,0],[-12,8,-26],[0,5,-26],[0,5,-10]],[[19,10,8],[19,10,-13],[13,1,-13],[13,1,3],[13,4,3],[-10,4,3],[-10,4,-18],[-10,-2,-18],[7,-2,-18],[7,-2,-23],[7,5,-23],[0,5,-23],[0,5,-10]]],placeholders:[[23,-1,-6,2],[-22,5,4,2],[-22,5,-1,2],[-18,-1,-12,1],[-6,1,0,0],[0,1,-6,0],[6,1,0,0],[0,1,6,0],[20,0,3,0],[12,9,-2,0],[22,8,4,2],[22,8,-1,2],[-13,-4,-2,0],[-13,11,-2,0],[-13,11,-17,0],[-13,11,-27,0],[-10,2,-21,1],[-7,2,-24,2],[-12,-1,-18,2],[7,5,-26,1],[10,3,-23,2],[10,2,-18,2],[13,2,-15,1],[9,10,-25,0],[9,10,-17,0],[7,-4,6,0],[-5,10,-30,1]],box:[[[-33,4,-30],8,7],[[-19,-2,0],8,8],[[0,3,-10],3,4],[[12,12,-2],4,2],[[-25,5,-1],4,3],[[-19,-2,8],8,8],[[-19,-6,-8],8,8],[[0,-4,0],8,7],[[0,-2,-6],4,7],[[-14,-3,-6],2,8],[[-6,-5,-6],6,8],[[0,-2,6],4,7],[[6,-2,0],4,7],[[-6,-2,0],4,7],[[-12,-3,-6],2,8],[[-10,-3,-6],2,8],[[6,-5,-6],6,8],[[10,-3,-6],2,8],[[12,-3,-6],2,8],[[14,-3,-6],2,8],[[-2,-3,-12],2,8],[[0,-3,-12],2,8],[[2,-3,-12],2,8],[[-6,-3,-10],2,8],[[-4,-3,-12],2,8],[[-6,-3,-12],2,8],[[4,-3,-12],2,8],[[6,-3,-12],2,8],[[6,-3,-10],2,8],[[-25,5,4],4,3],[[-25,5,9],4,3],[[-18,-1,-15],4,3],[[0,3,-17],2,8],[[20,-3,3],4,2],[[26,-1,-6],4,2],[[16,-3,-6],1,8],[[18,-3,-6],1,8],[[20,-3,-6],1,8],[[20,-2,-4],1,8],[[20,-1,-2],1,8],[[20,0,0],1,8],[[20,0,9],1,8],[[15,0,9],1,8],[[10,0,9],1,8],[[5,0,9],1,8],[[0,0,9],1,8],[[-5,0,9],1,8],[[-10,0,9],1,8],[[19,15,8],8,1],[[19,15,0],8,1],[[19,15,-8],8,1],[[-2,4,-10],1,4],[[2,4,-10],1,4],[[25,8,-1],4,2],[[25,8,4],4,2],[[25,8,9],4,2],[[-14,15,30],5,7],[[11,23,59],2,7],[[11,0,-41],2,7],[[20,2,-50],2,7],[[0,3,-21],2,8],[[0,2,-26],4,8],[[-12,2,7],1,8],[[-12,7,-1],1,8],[[-12,7,-6],1,8],[[-12,7,-11],1,8],[[-12,7,-16],1,8],[[-12,7,-21],1,8],[[-12,7,-26],1,8],[[0,3,-23],2,1],[[0,3,-19],2,1],[[0,2,-14],4,1],[[-2,-3,-18],1,1],[[0,-3,-18],1,1],[[2,-3,-18],1,1],[[-9,6,-26],1,8],[[-5,5,-26],1,8],[[-10,-5,-18],4,1],[[-6,-5,-18],4,1],[[7,-5,-18],4,1],[[4,-3,-18],1,1],[[7,-5,-22],4,1],[[3,-1,-22],4,1],[[7,-1,-26],4,1],[[4,12,-37],4,7],[[-8,21,-37],4,7],[[-13,-7,-2],4,3],[[-13,14,-2],4,3],[[-13,14,-17],4,3],[[-13,14,-27],4,3],[[-10,2,-24],4,3],[[24,1,-24],4,7],[[21,7,-18],6,7],[[26,-3,-28],2,7],[[13,-2,-13],4,1],[[13,-1,-10],2,1],[[13,-1,-2],2,1],[[13,-2,3],4,1],[[13,-1,0],2,1],[[13,-1,-8],2,1],[[13,-1,-4],2,1],[[10,-1,3],2,1],[[-10,-1,3],2,1],[[-15,-1,-18],4,3],[[-17,2,-17],2,3],[[23,8,-12],4,1],[[5,0,35],2,7],[[20,0,45],2,7],[[7,5,-29],4,2],[[13,3,-23],4,2],[[13,2,-18],4,2],[[9,13,-25],4,2],[[9,13,-17],4,2],[[7,-7,6],4,2],[[13,6,-24],2,2],[[-10,5,5],1,1],[[-5,10,-33],4,3],[[12,-13,49],5,7],[[-6,-23,40],5,7],[[-14,23,24],2,3],[[-7,-13,34],2,3],[[11,-9,30],2,7],[[-4,-16,19],2,7],[[-48,10,-7],8,7],[[-43,-10,20],8,7],[[37,14,23],8,7],[[46,9,-6],8,7],[[57,-10,-40],8,7],[[-25,-13,52],2,3],[[41,-1,-41],2,2],[[18,11,-58],2,2],[[-60,21,-50],4,7],[[-75,-2,-25],4,7],[[51,21,-54],4,7],[[43,21,-25],4,7]],end:[0,5,-10]};AFRAME.registerComponent("neon-text",{schema:{text:{type:"string",default:"Neon text"},fontsize:{type:"number",default:150},font:{type:"string",default:"Serif"},color:{type:"color",default:"#2963ff"}},init(){this.update()},update(){let t=document.createElement("canvas");t.width=t.height=1024;let e=t.getContext("2d");for(e.fillStyle="white",e.font=`${this.data.fontsize}px ${this.data.font}`,e.textAlign="center";e.measureText(this.data.text).width>t.width&&this.data.fontsize>1;)this.data.fontsize--,e.font=`${this.data.fontsize}px ${this.data.font}`;e.fillText(this.data.text,512,123),e.strokeStyle=this.data.color,e.lineWidth=this.data.fontsize/75,e.strokeText(this.data.text,512,123),e.fillStyle=this.data.color,e.shadowColor=this.data.color,e.shadowBlur=15,e.fillText(this.data.text,512+this.data.fontsize/50,123+this.data.fontsize/50),this.el.setAttribute("material",{transparent:!0,src:t,depthTest:!1})}});const texture=new THREE.ImageUtils.loadTexture("data:image/webp;base64,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"),textureLookup=new THREE.ImageUtils.loadTexture("data:image/webp;base64,UklGRiQBAABXRUJQVlA4TBgBAAAvBMACENfhxLa1pfpwd3dPVEbAAJgticoi0qjwPJGe+zjc1ratRBd3d4g0I6INMmqhPgog95zIZiI3x7Vtq8mNu7u7J52mhlTAlH4YO8ycRSBpY/Px5A8AIH/if/whLOH1InCMTQRgws2PhzMAYLBYlvG+eYewAQAasBAKgMtEBgDBRE6r4csunn+e+CVMdA3rKYphOPmxnn5qfxwq13g641IC+bjbHZIRQESM9XfW4S/aDz51DpzbSsUOhsm81dKRIF1eiChSXx/EVrd2R4AVNKSm6unOjlFsPrGnuu2BQQCAZaPTbdu2GdH/OKpS5tpd1+hzXRT+zQqJBX3XRA70UDilichcpqFSwvb4QX7/ljuP8LNxPcQE");function createPixelMaterial(t,e="#ffffff",i=-1,s=1,a=1,o=!1,n=!1){texture.minFilter=texture.magFilter=1003,textureLookup.minFilter=textureLookup.magFilter=1003;var r=new THREE.ShaderMaterial({extensions:{derivatives:!0},uniforms:{time:{value:0},index:{value:t},DiffuseTexture:{value:texture},Lookup:{value:textureLookup},lookupIndex:{value:i},lookupShift:{value:0},color:{value:new THREE.Color(e)},spriteDimensions:{value:{x:22,y:1}},repeat:{value:{x:s,y:a}},tint:{value:new THREE.Color(255,255,255)},tintAmount:{value:0}},vertexShader:vertShader,fragmentShader:fragShader});return r.transparent=o,n&&(r.side=THREE.DoubleSide),r.needsUpdate=!0,r}AFRAME.registerComponent("pixelshader-material",{schema:{index:{type:"int",default:0},color:{default:"#ffffff"},lookup:{type:"int",default:-1},animationSpeed:{default:0},repeat:{type:"vec2",default:{x:1,y:1}},transparent:{default:!1},twosided:{default:!1}},init(){},update(){this.material=createPixelMaterial(this.data.index,this.data.color,this.data.lookup,this.data.repeat.x,this.data.repeat.y,this.data.transparent,this.data.twosided),this.el.getObject3D("mesh").depthWrite=!1,this.el.getObject3D("mesh").material=this.material}}),AFRAME.registerComponent("placeholder-entity",{schema:{rot:{default:0}},init(){var t=new THREE.PlaneGeometry;this.pixelMaterial=createPixelMaterial(11,"#ffffff",5),this.pixelMaterial.transparent=!0,this.pixelMaterial.side=THREE.DoubleSide;var e=new THREE.Mesh(t,this.pixelMaterial);this.el.setObject3D("mesh",e),this.q=0,this.t=0},tick(t,e){this.el.object3D.rotateZ(.01),this.t+=e,this.t>100&&(this.q=(this.q+1)%5,this.pixelMaterial.uniforms.lookupShift.value=this.q,this.t=0)}}),AFRAME.registerComponent("score",{init(){document.querySelector("[game]").addEventListener("update-score",this.scoreUpdate.bind(this))},scoreUpdate({detail:t}){let e=0;t>0&&100>t?e=10*t+"K":100>t||(e=10*t/1e3+"M"),this.el.setAttribute("text","value:$"+e)}}),AFRAME.registerComponent("selfdestruct",{schema:{timer:{default:5e3}},update(){this.countdown=this.data.timer},tick(t,e){this.countdown-=e,0>this.countdown&&this.el.remove()}}),AFRAME.registerComponent("shoot-controls",{schema:{hand:{default:"left"}},init(){this.game=document.querySelector("[game]")},update(){var t=this.el,e={hand:this.data.hand,model:!1};t.setAttribute("keyboardcontrols",{}),t.setAttribute("vive-controls",e),t.setAttribute("oculus-touch-controls",e),t.setAttribute("windows-motion-controls",e),"right"===this.data.hand&&t.setAttribute("laser-controls",e)}}),AFRAME.registerComponent("keyboardcontrols",{init(){let t=!1;document.body.addEventListener("keydown",e=>{32!==e.keyCode||t||(t=!0,this.el.sceneEl.components.game.clicked(this,42))}),document.body.addEventListener("keyup",e=>{32===e.keyCode&&(t=!1)})}});let audioContext,audiopool=[],pannerNodes=[];function InitAudio(){(audioContext=new AudioContext).listener.upY.value=1,audioContext.sampleRate=11025;let t=audioContext.createGain();t.connect(audioContext.destination);for(let e=0;25>e;e++){const e=new Audio;audiopool.push(e);const i=audioContext.createMediaElementSource(e),s=new PannerNode(audioContext,{panningModel:"HRTF",distanceModel:"exponential"});i.connect(s),s.connect(t),pannerNodes.push(s)}}let currentSfxIndex=0,soundfx=[jsfxr([1,.0119,.13,.1713,.11,.531,.0692,-.56,-.0392,.0925,,-.48,.7,.4932,.0138,,-.1301,-.0553,.9552,-.0111,.0242,.258,-.1164,.3]),jsfxr([3,,.58,.35,.0547,.16,,-.18,,,,-.3774,.6619,,,,.598,-.1327,1,,,,,.6]),jsfxr([3,.09,.67,.35,.93,.2,,-.12,,,,-.3774,.62,,,,.1399,-.3,1,,,,,.5]),jsfxr([1,,.1628,,.1462,.473,,,,,,,,,,,,,1,,,.1,,1]),jsfxr([0,,.1207,.0763,.2221,.5849,.2,-.2737,,,,,,.401,.0781,,,,1,,,,,1]),jsfxr([0,,.1797,,.4004,.3195,,.2962,,,,,,.5604,,.4313,,,1,,,,,1]),jsfxr([0,,.0343,,.2762,.533,,-.4588,,,,,,.2202,,,,,1,,,,,1])];const sound={play(t,e){let i=e.getWorldPosition(zeroVector);pannerNodes[currentSfxIndex].positionX.value=i.x,pannerNodes[currentSfxIndex].positionY.value=i.y,pannerNodes[currentSfxIndex].positionZ.value=i.z,audiopool[currentSfxIndex].src=soundfx[t],audiopool[currentSfxIndex].play(),currentSfxIndex=(currentSfxIndex+1)%25}};AFRAME.registerComponent("space",{schema:{},init(){var t=document.createElement("canvas");t.width=3e3,t.height=3e3;var e=t.getContext("2d");e.fillStyle="#FF00FF",e.fillRect(0,0,t.width,t.height);for(var i=e.createImageData(t.width,t.height),s=i.data,a=0;a<t.width;a++)for(var o=0;o<t.height;o++){var n=noise2d(2*a/t.width,4*o/t.height),r=noise2d(1*a/t.width,1*o/t.height);s[0+(l=4*(o*t.width+a))]=255*n,s[l+1]=128*n+128*r,s[l+2]=32+128*r,s[l+3]=255}for(let e=0;1e4>e;e++){let e=~~(Math.random()*t.width);var l=4*(~~(Math.random()*t.height)*t.width+e);const i=~~(255*Math.random());s[l+0]=i/2+128,s[l+1]=i/2,s[l+2]=0,s[l+3]=255}e.putImageData(i,0,0),this.el.setAttribute("material",{shader:"flat",color:"white",src:t}),this.el.setAttribute("rotation","0 -90 0")}});for(var noiseMask=255,noiseSize=noiseMask+1,noiseValues=new Int16Array(2*noiseSize),i=0;noiseSize>i;i++){var angle=Math.random()*Math.PI*2;x=Math.sin(angle),y=Math.cos(angle),noiseValues[i]=x,noiseValues[i+1]=y}function noise2d(t,e){function i(t,e,i){return e+t*(i-e)}function s(t){return t*t*t*(t*(6*t-15)+10)}function a(t,e,i){return(0==(2&t)?e:-e)+(0==(1&t)?i:-i)}var o=(0|t)&noiseMask,n=(0|e)&noiseMask,r=t-(0|t),l=e-(0|e),h=noiseValues[o]+n,d=noiseValues[o+1]+n,c=s(r),u=s(l),p=a(noiseValues[h],r,l),m=a(noiseValues[d],r-1,l),f=a(noiseValues[h+1],r,l-1),b=a(noiseValues[d+1],r-1,l-1);return i(u,i(c,p,m),i(c,f,b))}const waves=[[{s:7e3,n:5,e:[3]},{s:3e3,n:5,e:[3]},{s:3e3,n:10,e:[3]},{s:3e3,n:15,e:[1,3]},{s:2e4,n:1,e:[4]},{s:3e3,n:10,e:[1,3]},{s:2800,n:25,e:[1,3,4,1,3]},{s:2800,n:10,e:[4,3,1]},{s:1e4,n:2,e:[2]},{s:2500,n:10,e:[4,3,1]},{s:2500,n:10,e:[2,4]},{s:2500,n:20,e:[2,3,1,4,3,1]},{s:1e4,n:3,e:[0]},{s:2500,n:20,e:[2,3,1,4,3,1]},{s:2e3,n:30,e:[3,0,2]},{s:1500,n:100,e:[3,1,4,2,0]},{s:1e3,n:99999,e:[3,1,4,2,0]}],[{s:5e4,n:1,e:[3]},{s:3e3,n:10,e:[3]},{s:3e3,n:15,e:[1,3]},{s:2e4,n:1,e:[4]},{s:3e3,n:10,e:[1,3]},{s:2800,n:25,e:[1,3,4,1,3]},{s:2800,n:10,e:[4,3,1]},{s:1e4,n:2,e:[2]},{s:2500,n:10,e:[4,3,1]},{s:2500,n:10,e:[2,4]},{s:2500,n:20,e:[2,3,1,4,3,1]},{s:1e4,n:3,e:[0]},{s:2500,n:20,e:[2,3,1,4,3,1]},{s:2e3,n:30,e:[3,0,2]},{s:1500,n:100,e:[3,1,4,2,0]},{s:1e3,n:99999,e:[3,1,4,2,0]}]];AFRAME.registerComponent("spawner",{schema:{speed:{default:300},container:{type:"selector"},enemy:{type:"selector"},id:{default:-1}},init(){this.spawning=!1,this.game=this.el.sceneEl.components.game,this.e=[[13,1],[26,2],[39,3],[52,4],[66,5]],this.wavestep=0,this.waveindex=0,this.wavecount=0,~this.data.id&&(this.countdown=waves[this.data.id][this.wavestep].s)},tick(t,e){if(1===this.game.state&&(this.countdown-=e,this.countdown<0-300*Math.random())){sound.play(4,this.el.object3D);const t=waves[this.data.id][this.wavestep];this.countdown=t.s;const e=document.createElement("a-entity");e.setAttribute("mixin","enemy"),this.wavecount++,this.waveindex=(this.waveindex+1)%t.e.length,this.wavecount<t.n||(this.wavestep=Math.min(this.wavestep+1,waves[this.data.id].length-1),this.wavecount=0,this.waveindex=0,this.countdown=waves[this.data.id][this.wavestep].s);const i=t.e[this.waveindex];e.setAttribute("enemy",{type:i,speed:1,health:this.e[i][0],value:this.e[i][1],spawner:this.data.id}),e.setAttribute("position",this.el.object3D.position),this.data.container.append(e)}}}),AFRAME.registerComponent("target-entity",{schema:{},init(){var t=new THREE.BoxBufferGeometry(.1,1,1);const e=createPixelMaterial(5+~~(3*Math.random())),i=new THREE.MeshStandardMaterial({color:16777215});var s=[e,e,i,i,i,i],a=new THREE.Mesh(t,s);this.el.setObject3D("mesh",a)}}),AFRAME.registerComponent("title-screen",{schema:{text:{default:"KEEP'EM 404"},fontsize:{type:"number",default:150},font:{type:"string",default:'"Arial Black", Gadget, sans-serif'}},init(){let t=document.createElement("canvas");t.width=t.height=1024;let e=t.getContext("2d"),i=e.createLinearGradient(0,8,0,120);for(i.addColorStop(.1,"#fff901"),i.addColorStop(.3,"#ff4400"),i.addColorStop(.5,"#c40001"),i.addColorStop(.9,"#640000"),i.addColorStop(1,"#050000"),e.shadowColor="#131a9b",e.shadowBlur=15,e.textAlign="center",e.fillStyle=i,e.font=`${this.data.fontsize}px ${this.data.font}`;e.measureText(this.data.text).width>t.width&&this.data.fontsize>1;)this.data.fontsize--,e.font=`${this.data.fontsize}px ${this.data.font}`;e.fillText(this.data.text,512,123);let s=e.createLinearGradient(0,5,0,140);s.addColorStop(0,"#ff2929"),s.addColorStop(.9,"#be0000"),e.shadowColor="#7b257c",e.shadowBlur=1,e.strokeStyle="white",e.lineWidth=5,e.strokeText(this.data.text,512,123),e.strokeStyle=s,e.lineWidth=4,e.strokeText(this.data.text,512,123),this.el.setAttribute("material",{transparent:!0,src:t,depthTest:!1})}});const TOWER_SPRITE_INDICES=[4,14,13,10,20];AFRAME.registerComponent("tower",{schema:{speed:{default:500},level:{default:0},type:{default:0},animated:{default:!1},data:{type:"array"},rot:{default:0}},init(){const t=this.data.data;this.type=t[0],this.reach=[t[2],t[7],t[8]],this.damage=[t[3],t[9],t[10]],this.life=[t[4],t[11],t[12]],this.specialEnemy=t[13],this.seDamage=[t[14],t[15],t[16]];var e=new THREE.BoxBufferGeometry(1,1,1);this.game=this.el.sceneEl.components.game,this.pixelMaterial2=createPixelMaterial(TOWER_SPRITE_INDICES[this.data.type]);var i=new THREE.Mesh(e,this.pixelMaterial2);this.el.setObject3D("mesh",i),this.q=0,this.t=0,this.bulletContainer=document.getElementById("bullets"),this.countdown=this.data.speed},update(){this.bullets=this.life[this.data.level],this.pixelMaterial2.uniforms.lookupIndex.value=this.data.level+9},tick(t,e){if(this.countdown-=e,0>this.countdown){this.countdown=this.data.speed;let{found:t,distance:e}=closestEnemy(this.el.object3D.position,this.reach[this.data.level]);if(t&&e<this.reach[this.data.level]){sound.play(0,this.el.object3D);const e=document.createElement("a-entity");if(e.setAttribute("mixin","template-bullet"),e.setAttribute("bullet",{target:t,damage:this.damage[this.data.level],special:this.specialEnemy,specialDamage:this.seDamage[this.data.level]}),e.setAttribute("pixelshader-material",{lookup:this.data.level+9}),e.setAttribute("position",this.el.object3D.position),this.bulletContainer.append(e),this.bullets-=1,0>=this.bullets){sound.play(1,this.el.object3D),createExplosion(this.el.parentElement,this.el.object3D.position,"#00FFFF"),this.el.remove();const t=this.el.object3D.position;this.game.placePlaceholder([t.x,t.y,t.z,this.data.rot])}}}this.data.animated&&(this.t+=e,this.t>100&&(this.q=(this.q+1)%5,this.pixelMaterial2.uniforms.lookupShift.value=this.q,this.t=0))}}),window.fragShader="precision highp float;\n#define GLSLIFY 1\nuniform sampler2D DiffuseTexture;\nuniform float index;\nuniform sampler2D Lookup;\nuniform float lookupIndex;\nuniform float lookupShift;\nuniform vec2 spriteDimensions;\nuniform vec3 tint;\nuniform float tintAmount;\nuniform float alphatest;\nvarying vec2 FragTexcoord;\nuniform vec2 vUv;\nvoid main()\n{\n    float u=clamp(floor(mod(FragTexcoord.x,1.)*16.)/16.,0.,1.)/spriteDimensions.x+(index*1./spriteDimensions.x);//+1.0/128.0;\n    float v=clamp(floor(mod(FragTexcoord.y,1.)*16.)/16.,0.,1.)/spriteDimensions.y;\n    vec2 UV=vec2(u,v);\n    \n    vec4 texturedColor=texture2D(DiffuseTexture,vec2(UV.x+0.0015,UV.y));  \n  \n    if( lookupIndex >= 0.0 && texturedColor.a > 0.0 && \n                            texturedColor.r == texturedColor.g && \n                            texturedColor.r == texturedColor.b){\n        float ind = mod(texturedColor.r+(lookupShift/5.),1.);        \n        float y = 1.-(lookupIndex*(1./12.)-(1./24.));        \n\t\ttexturedColor = texture2D(Lookup,vec2(ind, y));  \n\t}\n    if(texturedColor.a<alphatest)discard;      \n    gl_FragColor=texturedColor;\n}\n\n",window.vertShader="\nprecision highp float;\n#define GLSLIFY 1\n\nvarying vec2 FragTexcoord;\nvarying float fogDepth;\n\nuniform vec2 repeat;\n\nvoid main(){\n    FragTexcoord=vec2(uv.x*repeat.x,uv.y*repeat.y);\n    gl_Position=projectionMatrix*modelViewMatrix*vec4(position,1.);\n    \n    float fogDistance=length(gl_Position.xyz);\n    fogDepth=-(modelViewMatrix*vec4(position,1.)).z;\n}\n";</script></head><body><a-scene background="color:#000" game><a-assets><a-mixin id="enemy" class="enemy" scale=".05 1 1"></a-mixin><a-mixin id="template-defense" click-handler="7" tower></a-mixin><a-mixin id="template-bullet" geometry="primitive: box" bullet pixelshader-material="index:1;repeat:0.5 0.5;lookup:9;animationSpeed:1000" scale=".5 .5 .5"></a-mixin><a-mixin id="template-page" scale="1.2 1.2 1.2" target-entity animation="property: rotation; to: 0 -360 0; dur: 4000; easing: linear; loop: true"></a-mixin><a-mixin id="template-spawner" spawner="enemy:.enemy;container:#enemies;speed:2000"></a-mixin><a-mixin id="template-placeholder" geometry="primitive: plane" placeholder-entity rotation="-90 0 0" position="0 -.5 0"></a-mixin></a-assets><a-entity id="game" scale=".3 .3 .3"><a-entity id="level"><a-entity id="defense"></a-entity><a-entity id="enemies"></a-entity><a-entity id="bullets"></a-entity></a-entity><a-entity id="world"></a-entity></a-entity><a-sky space animation="property: rotation; to: -360 -360 0; dur: 800000; easing: linear; loop: true"></a-sky><a-entity id="left-hand" shoot-controls><a-entity id="left-hand-menu" visible="false" scale="0.05 0.05 0.05" rotation="-80 0 0" position="0 0 0.1"><a-entity class="message" text="value: Not enough money to upgrade.; align: center; color: #fdeb77" scale="8 8 0.00001" position="0 2.2 0.4"></a-entity><a-plane pixelshader-material="index:0" click-handler="0" color="red" position="-1.2 0 0.25"><a-entity score text="value:$50k;align:center;color:#000" scale="6 6 6"></a-entity></a-plane><a-plane disable-menu="5" class="clickable" pixelshader-material="index:2" click-handler="5" position="1.2 0 0.25"></a-plane><a-plane disable-menu="0" class="clickable" pixelshader-material="index:4" click-handler="0" position="-2.4 1.2 0 "></a-plane><a-plane disable-menu="1" class="clickable" pixelshader-material="index:14" click-handler="1" position="-1.2 1.2 0"></a-plane><a-plane disable-menu="2" class="clickable" pixelshader-material="index:13" click-handler="2" position="0 1.2 0"></a-plane><a-plane disable-menu="3" class="clickable" pixelshader-material="index:10" click-handler="3" position="1.2 1.2 0"></a-plane><a-plane disable-menu="4" class="clickable" pixelshader-material="index:20" click-handler="4" position="2.4 1.2 0"></a-plane></a-entity></a-entity><a-entity id="right-hand" shoot-controls="hand:right" raycaster="objects:.clickable"><a-plane pixelshader-material="index:21;transparent:true;twosided:true" rotation="-45 -90 90" scale=".2 .2 .2"></a-plane></a-entity><a-entity id="titlescreen" position="0 0 -.85" class="screen clickable" click-handler="42"><a-plane title-screen position="0 -.2 -2" class="screen clickable" scale="10 10 10" rotation="-14.5 0 0"></a-plane><a-plane neon-text="text:click to start" class="screen clickable" position="0 1.5 -1.9" scale="3.5 3.5 3.5"></a-plane><a-entity id="info" position="0 2 -0.5"><a-entity scale="1.4 1.4 1.4 " text="align: center; value:  Keep the browser at 404.\n Place towers to prevent the evil pages to reach the browser. "></a-entity><a-entity scale="0.2 0.2 0.2" position="0 -0.3 0"><a-plane pixelshader-material="index: 4" position="-1 0 0"></a-plane><a-entity text="value: vs.; align: center" scale="10 10 10"></a-entity><a-plane pixelshader-material="index: 18" position="1 0 0"></a-plane></a-entity><a-entity scale="0.2 0.2 0.2" position="0 -0.5 0"><a-plane pixelshader-material="index: 14" position="-1 0 0"></a-plane><a-entity text="value: vs.; align: center" scale="10 10 10"></a-entity><a-plane pixelshader-material="index: 16" position="1 0 0"></a-plane></a-entity><a-entity scale="0.2 0.2 0.2" position="0 -0.7 0"><a-plane pixelshader-material="index: 13" position="-1 0 0"></a-plane><a-entity text="value: vs.; align: center" scale="10 10 10"></a-entity><a-plane pixelshader-material="index: 19" position="1 0 0"></a-plane></a-entity><a-entity scale="0.2 0.2 0.2" position="0 -0.9 0"><a-plane pixelshader-material="index: 10" position="-1 0 0"></a-plane><a-entity text="value: vs.; align: center" scale="10 10 10"></a-entity><a-plane pixelshader-material="index: 17" position="1 0 0"></a-plane></a-entity><a-entity scale="0.2 0.2 0.2" position="0 -1.1 0"><a-plane pixelshader-material="index: 20" position="-1 0 0"></a-plane><a-entity text="value: vs.; align: center" scale="10 10 10"></a-entity><a-plane pixelshader-material="index: 15" position="1 0 0"></a-plane></a-entity></a-entity></a-entity><a-entity id="gameoverscreen" position="0 0 -.85" click-handler="42" class="screen clickable" position="0 -2 0" visible="false"><a-plane title-screen="text:GAME OVER" class="screen clickable" position="0 0 -2" scale="4 4 4" rotation="-14.5 0 0"></a-plane><a-plane neon-text="text:Click here to restart" class="screen clickable" position="0 .64 -1.9" scale="2 2 2"></a-plane></a-entity><a-entity id="camera" wasd-controls="acceleration:180" camera look-controls="pointerLockEnabled:false;touchEnabled:true" position="0 1.7 0" rotation="90 0 0"><a-entity id="menu" scale="0.05 0.05 0.05" position="0 -0.25 -0.4" rotation="-25 0 0"><a-entity class="message" text="value: Not enough money to upgrade.; align: center; color: #fdeb77" scale="8 8 0.00001" position="0 2.2 0.4"></a-entity><a-plane pixelshader-material="index:0" click-handler="0" color="red" position="-1.2 0 0.25"><a-entity score text="value:$50k;align:center;color:#000" scale="6 6 6"></a-entity></a-plane><a-plane disable-menu="5" class="clickable" pixelshader-material="index:2" click-handler="5" position="1.2 0 0.25"></a-plane><a-plane disable-menu="0" class="clickable" pixelshader-material="index:4" click-handler="0" position="-2.4 1.2 0 "></a-plane><a-plane disable-menu="1" class="clickable" pixelshader-material="index:14" click-handler="1" position="-1.2 1.2 0"></a-plane><a-plane disable-menu="2" class="clickable" pixelshader-material="index:13" click-handler="2" position="0 1.2 0"></a-plane><a-plane disable-menu="3" class="clickable" pixelshader-material="index:10" click-handler="3" position="1.2 1.2 0"></a-plane><a-plane disable-menu="4" class="clickable" pixelshader-material="index:20" click-handler="4" position="2.4 1.2 0"></a-plane></a-entity><a-entity id="cursor" cursor="rayOrigin: mouse" raycaster="objects:.clickable"></a-entity></a-entity></a-scene></body></html>