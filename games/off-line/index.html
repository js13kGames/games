<!doctype html><title>Off Line - js13kGames 2018</title><meta content="width=device-width" name=viewport><style>canvas{position:absolute;top:0;bottom:0;left:0;right:0;margin:auto}</style><body><script>var r,i,o,t,s,l,d,n,c,u,h,f,p=p||{};p.VERSION="0.0.1",p.plugins=void 0,p.custom=void 0,p.create=function(e,t,n,a,r){var i,u={};if(u.canvas=document.createElement("canvas"),u.canvas.setAttribute("width",+e),u.canvas.setAttribute("height",+t),u.canvas.style.backgroundColor="black",document.body.appendChild(u.canvas),u.canvas.ctx=u.canvas.getContext("2d"),u.stage=(l(e={}),e.stage=!0,e.width=u.canvas.width,e.height=u.canvas.height,e.x=0,e.y=0,e.parent=void 0,e),u.pointer=(i={_x:0,_y:0},Object.defineProperties(i,{x:{get:function(){return i._x/u.scale},enumerable:!0,configurable:!0},y:{get:function(){return i._y/u.scale},enumerable:!0,configurable:!0},centerX:{get:function(){return i.x},enumerable:!0,configurable:!0},centerY:{get:function(){return i.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:i.x,y:i.y}},enumerable:!0,configurable:!0}}),i.isDown=!1,i.isUp=!0,i.tapped=!1,i.downTime=0,i.elapsedTime=0,i.press=void 0,i.release=void 0,i.tap=void 0,i.dragSprite=null,i.dragOffsetX=0,i.dragOffsetY=0,i.moveHandler=function(e){i._x=e.pageX-e.target.offsetLeft,i._y=e.pageY-e.target.offsetTop,e.preventDefault()},i.touchmoveHandler=function(e){i._x=e.targetTouches[0].pageX-u.canvas.offsetLeft,i._y=e.targetTouches[0].pageY-u.canvas.offsetTop,e.preventDefault()},i.downHandler=function(e){i._x=e.pageX-e.target.offsetLeft,i._y=e.pageY-e.target.offsetTop,i.isDown=!0,i.isUp=!1,i.tapped=!1,i.downTime=Date.now(),i.press&&i.press(),e.preventDefault()},i.touchstartHandler=function(e){i._x=e.targetTouches[0].pageX-u.canvas.offsetLeft,i._y=e.targetTouches[0].pageY-u.canvas.offsetTop,i.isDown=!0,i.isUp=!1,i.tapped=!1,i.downTime=Date.now(),i.press&&i.press(),e.preventDefault()},i.upHandler=function(e){i.elapsedTime=Math.abs(i.downTime-Date.now()),i.elapsedTime<=200&&(i.tapped=!0,i.tap)&&i.tap(),i.isUp=!0,i.isDown=!1,i.release&&i.release(),e.preventDefault()},u.canvas.addEventListener("mousemove",i.moveHandler.bind(i),!1),u.canvas.addEventListener("mousedown",i.downHandler.bind(i),!1),window.addEventListener("mouseup",i.upHandler.bind(i),!1),u.canvas.addEventListener("touchmove",i.touchmoveHandler.bind(i),!1),u.canvas.addEventListener("touchstart",i.touchstartHandler.bind(i),!1),window.addEventListener("touchend",i.upHandler.bind(i),!1),u.canvas.style.touchAction="none",i.hitTestSprite=function(e){var t,n;return e.circular?(t=i.x-(e.gx+e.halfWidth),n=i.y-(e.gy+e.halfHeight),Math.sqrt(t*t+n*n)<e.radius):i.x>e.gx&&i.x<e.gx+e.width&&i.y>e.gy&&i.y<e.gy+e.height},i.updateDragAndDrop=function(){if(i.isDown)if(null===i.dragSprite)for(var e=u.draggableSprites.length-1;-1<e;e--){var t=u.draggableSprites[e];if(t.draggable&&i.hitTestSprite(t)){i.dragOffsetX=i.x-t.gx,i.dragOffsetY=i.y-t.gy;var n=(i.dragSprite=t).parent.children;n.splice(n.indexOf(t),1),n.push(t),u.draggableSprites.splice(u.draggableSprites.indexOf(t),1),u.draggableSprites.push(t);break}}else i.dragSprite.x=i.x-i.dragOffsetX,i.dragSprite.y=i.y-i.dragOffsetY;i.isUp&&(i.dragSprite=null),u.draggableSprites.some(function(e){return e.draggable&&i.hitTestSprite(e)?(u.canvas.style.cursor="pointer",!0):!(u.canvas.style.cursor="auto")})},i),u.key=((t={}).leftArrow=h(37),t.upArrow=h(38),t.rightArrow=h(39),t.downArrow=h(40),t.space=h(32),t),u.buttons=[],u.dragAndDrop=!1,u.draggableSprites=[],u.tweens=[],u.state=void 0,u.load=r||void 0,u.setup=n||void 0,void 0===u.setup)throw new Error("Please supply the setup function in the constructor");function o(){if(requestAnimationFrame(o,u.canvas),void 0===u._fps)s(),u.render(u.canvas,0);else{var e=Date.now(),t=e-u._startTime;for(1e3<t&&(t=u._frameDuration),u._startTime=e,u._lag+=t;u._lag>=u._frameDuration;)u.stage.children.forEach(function(e){!function t(e){e._previousX=e.x,e._previousY=e.y,e.children&&0<e.children.length&&e.children.forEach(function(e){t(e)})}(e)}),s(),u._lag-=u._frameDuration;e=u._lag/u._frameDuration,u.render(u.canvas,e)}}function s(){if(0<u.buttons.length){u.canvas.style.cursor="auto";for(var e=u.buttons.length-1;0<=e;e--){var t=u.buttons[e];t.update(u.pointer,u.canvas),"over"!==t.state&&"down"!==t.state||t.stage||(u.canvas.style.cursor="pointer")}}if(u.dragAndDrop&&u.pointer.updateDragAndDrop(),u.state&&!u.paused&&u.state(),0!==u.updateFunctions.length)for(var n=0;n<u.updateFunctions.length;n++)(0,u.updateFunctions[n])()}function l(r){r.x=0,r.y=0,r.vx=0,r.vy=0,r.width=0,r.height=0,r.scaleX=1,r.scaleY=1,r.pivotX=.5,r.pivotY=.5,r.rotation=0,r.visible=!0,r.parent=void 0,r.stage=!1,r.shadow=!1,r.shadowColor="rgba(100, 100, 100, 0.5)",r.shadowOffsetX=3,r.shadowOffsetY=3,r.shadowBlur=3,r.blendMode=void 0,r._alpha=1,r._draggable=void 0,r._layer=0,r._circular=!1,r._interactive=!1,r._previousX=void 0,r._previousY=void 0,r.children=[],r.addChild=function(e){e.parent&&e.parent.removeChild(e),(e.parent=r).children.push(e)},r.removeChild=function(e){if(e.parent!==r)throw new Error(e+"is not a child of "+r);r.children.splice(r.children.indexOf(e),1)},r.swapChildren=function(e,t){var n=r.children.indexOf(e),a=r.children.indexOf(t);if(-1===n||-1===a)throw new Error(child+" Both objects must be a child of the caller "+r);e.childIndex=a,t.childIndex=n,r.children[n]=t,r.children[a]=e},r.add=function(e){var t=Array.prototype.slice.call(arguments);1<t.length?t.forEach(function(e){r.addChild(e)}):r.addChild(t[0])},r.remove=function(e){var t=Array.prototype.slice.call(arguments);1<t.length?t.forEach(function(e){r.removeChild(e)}):r.removeChild(t[0])},r.setPosition=function(e,t){r.x=e,r.y=t};var a=r;r.putCenter=function(e,t,n){n=n||0,e.x=a.x+a.halfWidth-e.halfWidth+(t=t||0),e.y=a.y+a.halfHeight-e.halfHeight+n,r.compensateForParentPosition(a,e)},r.putTop=function(e,t,n){n=n||0,e.x=a.x+a.halfWidth-e.halfWidth+(t=t||0),e.y=a.y-e.height+n,r.compensateForParentPosition(a,e)},r.putRight=function(e,t,n){n=n||0,e.x=a.x+a.width+(t=t||0),e.y=a.y+a.halfHeight-e.halfHeight+n,r.compensateForParentPosition(a,e)},r.putBottom=function(e,t,n){n=n||0,e.x=a.x+a.halfWidth-e.halfWidth+(t=t||0),e.y=a.y+a.height+n,r.compensateForParentPosition(a,e)},r.putLeft=function(e,t,n){n=n||0,e.x=a.x-e.width+(t=t||0),e.y=a.y+a.halfHeight-e.halfHeight+n,r.compensateForParentPosition(a,e)},r.compensateForParentPosition=function(e,t){0===t.parent.gx&&0===t.parent.gy||(t.x-=e.gx,t.y-=e.gy)},Object.defineProperties(r,{gx:{get:function(){return this.parent?this.x+this.parent.gx:this.x},enumerable:!0,configurable:!0},gy:{get:function(){return this.parent?this.y+this.parent.gy:this.y},enumerable:!0,configurable:!0},position:{get:function(){return{x:r.x,y:r.y}},enumerable:!0,configurable:!0},alpha:{get:function(){return r.parent._alpha*r._alpha},set:function(e){r._alpha=e},enumerable:!0,configurable:!0},halfWidth:{get:function(){return r.width/2},enumerable:!0,configurable:!0},halfHeight:{get:function(){return r.height/2},enumerable:!0,configurable:!0},centerX:{get:function(){return r.x+r.halfWidth},enumerable:!0,configurable:!0},centerY:{get:function(){return r.y+r.halfHeight},enumerable:!0,configurable:!0},layer:{get:function(){return r._layer},set:function(e){r._layer=e,r.parent.children.sort(f)},enumerable:!0,configurable:!0},circular:{get:function(){return r._circular},set:function(e){!0===e&&!1===r._circular&&(d(r),r._circular=!0),!1===e&&!0===r._circular&&(delete r.diameter,delete r.radius,r._circular=!1)},enumerable:!0,configurable:!0},draggable:{get:function(){return r._draggable},set:function(e){!0===e&&(u.draggableSprites.push(r),!(r._draggable=!0)===u.dragAndDrop)&&(u.dragAndDrop=!0),!1===e&&u.draggableSprites.splice(u.draggableSprites.indexOf(r),1)},enumerable:!0,configurable:!0},interactive:{get:function(){return r._interactive},set:function(e){!0===e&&(c(r),r._interactive=!0),!1===e&&(u.buttons.splice(u.buttons.indexOf(r),1),r._interactive=!1)},enumerable:!0,configurable:!0},localBounds:{get:function(){return{x:0,y:0,width:r.width,height:r.height}},enumerable:!0,configurable:!0},globalBounds:{get:function(){return rectangle={x:r.gx,y:r.gy,width:r.gx+r.width,height:r.gy+r.height}},enumerable:!0,configurable:!0},empty:{get:function(){return 0===r.children.length},enumerable:!0,configurable:!0}})}function d(t){Object.defineProperties(t,{diameter:{get:function(){return t.width},set:function(e){t.width=e,t.height=e},enumerable:!0,configurable:!0},radius:{get:function(){return t.width/2},set:function(e){t.width=2*e,t.height=2*e},enumerable:!0,configurable:!0}})}function c(a){a.press=a.press||void 0,a.release=a.release||void 0,a.over=a.over||void 0,a.out=a.out||void 0,a.tap=a.tap||void 0,a.state="up",a.action="",a.pressed=!1,a.enabled=!0,a.hoverOver=!1,u.buttons.push(a),a.update=function(e,t){var n;a.enabled&&(n=u.pointer.hitTestSprite(a),e.isUp&&(a.state="up","button"===a.subtype)&&a.show(0),n&&(a.state="over",a.frames&&3===a.frames.length&&"button"===a.subtype&&a.show(1),e.isDown)&&(a.state="down","button"===a.subtype)&&(3===a.frames.length?a.show(2):a.show(1)),"down"!==a.state||a.pressed||(a.press&&a.press(),a.pressed=!0,a.action="pressed"),"over"===a.state&&(a.pressed&&(a.release&&a.release(),a.pressed=!1,a.action="released",u.pointer.tapped)&&a.tap&&a.tap(),a.hoverOver||(a.over&&a.over(),a.hoverOver=!0)),"up"===a.state)&&(a.pressed&&(a.release&&a.release(),a.pressed=!1,a.action="released"),a.hoverOver)&&(a.out&&a.out(),a.hoverOver=!1)}}function h(e){var t={};return t.code=e,t.isDown=!1,t.isUp=!0,t.press=void 0,t.release=void 0,t.downHandler=function(e){e.keyCode===t.code&&(t.isUp&&t.press&&t.press(),t.isDown=!0,t.isUp=!1),e.preventDefault()},t.upHandler=function(e){e.keyCode===t.code&&(t.isDown&&t.release&&t.release(),t.isDown=!1,t.isUp=!0),e.preventDefault()},window.addEventListener("keydown",t.downHandler.bind(t),!1),window.addEventListener("keyup",t.upHandler.bind(t),!1),t}function f(e,t){return e.layer<t.layer?-1:1}return u.assetFilePaths=a||void 0,u.paused=!1,u._fps=60,u._startTime=Date.now(),u._frameDuration=1e3/u._fps,u._lag=0,u.interpolate=!0,u.updateFunctions=[],u.scale=1,u.start=function(){u.assetFilePaths?(u.assets.whenLoaded=function(){u.state=void 0,u.setup()},u.assets.load(u.assetFilePaths),u.load&&(u.state=u.load)):u.setup(),o()},u.pause=function(){u.paused=!0},u.resume=function(){u.paused=!1},u.hidePointer=function(){u.canvas.style.cursor="none"},u.showPointer=function(){u.canvas.style.cursor="auto"},Object.defineProperties(u,{fps:{get:function(){return u._fps},set:function(e){u._fps=e,u._startTime=Date.now(),u._frameDuration=1e3/u._fps},enumerable:!0,configurable:!0},backgroundColor:{set:function(e){u.canvas.style.backgroundColor=e},enumerable:!0,configurable:!0}}),u.remove=function(e){var t=Array.prototype.slice.call(arguments);if(t[0]instanceof Array){var n=t[0];if(0<n.length)for(var a=n.length-1;0<=a;a--){var r=n[a];r.parent.removeChild(r),n.splice(n.indexOf(r),1)}}else 1<t.length?t.forEach(function(e){e.parent.removeChild(e)}):t[0].parent.removeChild(t[0])},u.group=function(e){var t={};return l(t),t.addChild=function(e){e.parent&&e.parent.removeChild(e),(e.parent=t).children.push(e),t.calculateSize()},t.removeChild=function(e){if(e.parent!==t)throw new Error(e+"is not a child of "+t);t.children.splice(t.children.indexOf(e),1),t.calculateSize()},t.calculateSize=function(){0<t.children.length&&(t._newWidth=0,t._newHeight=0,t.children.forEach(function(e){e.x+e.width>t._newWidth&&(t._newWidth=e.x+e.width),e.y+e.height>t._newHeight&&(t._newHeight=e.y+e.height)}),t.width=t._newWidth,t.height=t._newHeight)},u.stage.addChild(t),e&&Array.prototype.slice.call(arguments).forEach(function(e){t.addChild(e)}),t},u.rectangle=function(e,t,n,a,r,i,o){var s={};return l(s),s.mask=!1,s.width=e||32,s.height=t||32,s.fillStyle=n||"red",s.strokeStyle=a||"none",s.lineWidth=r||0,s.x=i||0,s.y=o||0,u.stage.addChild(s),s.render=function(e){e.strokeStyle=s.strokeStyle,e.lineWidth=s.lineWidth,e.fillStyle=s.fillStyle,e.beginPath(),e.rect(-s.width*s.pivotX,-s.height*s.pivotY,s.width,s.height),!0===s.mask?e.clip():("none"!==s.strokeStyle&&e.stroke(),"none"!==s.fillStyle&&e.fill())},s},u.circle=function(e,t,n,a,r,i){var o={};return l(o),o.mask=!1,o.width=e||32,o.height=e||32,o.fillStyle=t||"red",o.strokeStyle=n||"none",o.lineWidth=a||"none",o.x=r||0,o.y=i||0,u.stage.addChild(o),d(o),o.render=function(e){e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.fillStyle=o.fillStyle,e.beginPath(),e.arc(o.radius+-o.diameter*o.pivotX,o.radius+-o.diameter*o.pivotY,o.radius,0,2*Math.PI,!1),!0===o.mask?e.clip():("none"!==o.strokeStyle&&e.stroke(),"none"!==o.fillStyle&&e.fill())},o},u.line=function(e,t,n,a,r,i){var o={};return l(o),a||0===a||(a=0),r||0===r||(r=32),i||0===i||(i=32),o.ax=n=n||0===n?n:0,o.ay=a,o.bx=r,o.by=i,o.strokeStyle=e||"red",o.lineWidth=t||1,o.lineJoin="round",u.stage.addChild(o),o.render=function(e){e.strokeStyle=o.strokeStyle,e.lineWidth=o.lineWidth,e.lineJoin=o.lineJoin,e.beginPath(),e.moveTo(o.ax,o.ay),e.lineTo(o.bx,o.by),"none"!==o.strokeStyle&&e.stroke(),"none"!==o.fillStyle&&e.fill()},o},u.text=function(e,t,n,a,r){var i={};return l(i),i.content=e||"Hello!",i.font=t||"12px sans-serif",i.fillStyle=n||"red",i.textBaseline="top",Object.defineProperties(i,{width:{get:function(){return u.canvas.ctx.measureText(i.content).width},enumerable:!0,configurable:!0},height:{get:function(){return u.canvas.ctx.measureText("M").width},enumerable:!0,configurable:!0}}),u.stage.addChild(i),i.x=a||0,i.y=r||0,i.render=function(e){e.strokeStyle=i.strokeStyle,e.lineWidth=i.lineWidth,e.fillStyle=i.fillStyle,0===i.width&&(i.width=e.measureText(i.content).width),0===i.height&&(i.height=e.measureText("M").width),e.translate(-i.width*i.pivotX,-i.height*i.pivotY),e.font=i.font,e.textBaseline=i.textBaseline,e.fillText(i.content,0,0)},i},u.frame=function(e,t,n,a,r){var i={};return i.image=e,i.x=t,i.y=n,i.width=a,i.height=r,i},u.frames=function(e,t,n,a){var r={};return r.image=e,r.data=t,r.width=n,r.height=a,r},u.filmstrip=function(e,t,n,a){for(var r=u.assets[e].source,i=[],o=r.width/t,s=r.height/n*o,l=0;l<s;l++){var d=l%o*t,c=Math.floor(l/o)*n;a&&0<a&&(d+=a+a*l%o,c+=a+a*Math.floor(l/o)),i.push([d,c])}return u.frames(e,i,t,n)},u.sprite=function(e){var t={};if(void 0===e)throw new Error("Sprites require a source");return l(t),t.frames=[],t.loop=!0,t._currentFrame=0,t.setTexture=function(e){if(e.image)if(e.data)e.image&&e.data&&(t.source=u.assets[e.image].source,t.frames=e.data,t.sourceX=t.frames[0][0],t.sourceY=t.frames[0][1],t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height);else{if(!(u.assets[e.image].source instanceof Image))throw new Error(e.image+" is not an image file");t.source=u.assets[e.image].source,t.sourceX=e.x,t.sourceY=e.y,t.width=e.width,t.height=e.height,t.sourceWidth=e.width,t.sourceHeight=e.height}else e instanceof Array?(t.frames=e,t.source=u.assets[e[0]].source,t.sourceX=u.assets[e[0]].frame.x,t.sourceY=u.assets[e[0]].frame.y,t.width=u.assets[e[0]].frame.w,t.height=u.assets[e[0]].frame.h,t.sourceWidth=u.assets[e[0]].frame.w,t.sourceHeight=u.assets[e[0]].frame.h):(t.tilesetFrame=u.assets[e],t.source=t.tilesetFrame.source,t.sourceX=t.tilesetFrame.frame.x,t.sourceY=t.tilesetFrame.frame.y,t.width=t.tilesetFrame.frame.w,t.height=t.tilesetFrame.frame.h,t.sourceWidth=t.tilesetFrame.frame.w,t.sourceHeight=t.tilesetFrame.frame.h)},t.setTexture(e),t.gotoAndStop=function(e){if(!(0<t.frames.length))throw new Error("Frame number "+e+"doesn't exist");t.frames[0]instanceof Array?(t.sourceX=t.frames[e][0],t.sourceY=t.frames[e][1]):u.assets[t.frames[e]].frame&&(t.source=u.assets[t.frames[e]].source,t.sourceX=u.assets[t.frames[e]].frame.x,t.sourceY=u.assets[t.frames[e]].frame.y,t.sourceWidth=u.assets[t.frames[e]].frame.w,t.sourceHeight=u.assets[t.frames[e]].frame.h,t.width=u.assets[t.frames[e]].frame.w,t.height=u.assets[t.frames[e]].frame.h),t._currentFrame=e},t.x=0,(t.y=0)<t.frames.length&&(u.addStatePlayer(t),Object.defineProperty(t,"currentFrame",{get:function(){return t._currentFrame},enumerable:!1,configurable:!1})),u.stage.addChild(t),t.render=function(e){e.drawImage(t.source,t.sourceX,t.sourceY,t.sourceWidth,t.sourceHeight,-t.width*t.pivotX,-t.height*t.pivotY,t.width,t.height)},t},u.button=function(e){return(e=u.sprite(e)).subtype="button",c(e),e},u.image=function(e){return u.assets[e]},u.json=function(e){return u.assets[e]},u.addStatePlayer=function(t){var n=0,a=0,r=0,i=void 0,o=!1;function e(e){s(),r=e[0],a=e[1]-r,0===r&&(a+=1,n+=1),1===a&&(a=2,n+=1),t.fps||(t.fps=12),e=1e3/t.fps,t.gotoAndStop(r),o||(i=setInterval(function(){n<a?(t.gotoAndStop(t.currentFrame+1),n+=1):t.loop&&(t.gotoAndStop(r),n=1)}.bind(this),e),o=!0)}function s(){void 0!==i&&!0===o&&(o=!1,a=r=n=0,clearInterval(i))}t.show=function(e){s(),"string"!=typeof e?t.gotoAndStop(e):t.gotoAndStop(t.frames.indexOf(e))},t.play=function(){e([0,t.frames.length-1])},t.stop=function(){s(),t.gotoAndStop(t.currentFrame)},t.playing=o,t.playSequence=e},u.render=function(a,r){var i=a.ctx;i.clearRect(0,0,a.width,a.height);for(var e=0;e<u.stage.children.length;e++)!function e(t){if(t.visible&&t.gx<a.width+t.width&&-t.width<=t.gx+t.width&&t.gy<a.height+t.height&&-t.height<=t.gy+t.height){if(i.save(),u.interpolate?(void 0!==t._previousX?t.renderX=(t.x-t._previousX)*r+t._previousX:t.renderX=t.x,t.renderY=void 0!==t._previousY?(t.y-t._previousY)*r+t._previousY:t.y):(t.renderX=t.x,t.renderY=t.y),i.translate(t.renderX+t.width*t.pivotX,t.renderY+t.height*t.pivotY),i.globalAlpha=t.alpha,i.rotate(t.rotation),i.scale(t.scaleX,t.scaleY),t.shadow&&(i.shadowColor=t.shadowColor,i.shadowOffsetX=t.shadowOffsetX,i.shadowOffsetY=t.shadowOffsetY,i.shadowBlur=t.shadowBlur),t.blendMode&&(i.globalCompositeOperation=t.blendMode),t.render&&t.render(i),t.children&&0<t.children.length){i.translate(-t.width*t.pivotX,-t.height*t.pivotY);for(var n=0;n<t.children.length;n++)e(t.children[n])}i.restore()}}(u.stage.children[e])},u.assets={toLoad:0,loaded:0,imageExtensions:["png","jpg","gif","webp"],fontExtensions:["ttf","otf","ttc","woff"],audioExtensions:["mp3","ogg","wav","webm"],jsonExtensions:["json"],whenLoaded:void 0,load:function(e){var s=this;s.toLoad=e.length,e.forEach(function(e){var t,n,a,r,i,o=e.split(".").pop();-1!==s.imageExtensions.indexOf(o)?((t=new Image).addEventListener("load",function(){t.name=e,s[t.name]={source:t,frame:{x:0,y:0,w:t.width,h:t.height}},s.loadHandler()},!1),t.src=e):-1!==s.fontExtensions.indexOf(o)?(a=e.split("/").pop().split(".")[0],(n=document.createElement("style")).appendChild(document.createTextNode("@font-face {font-family: '"+a+"'; src: url('"+e+"');}")),document.head.appendChild(n),s.loadHandler()):-1!==s.audioExtensions.indexOf(o)?((a=u.makeSound(e,s.loadHandler.bind(s))).name=e,s[a.name]=a):-1!==s.jsonExtensions.indexOf(o)&&(r=new XMLHttpRequest,i={},r.open("GET",e,!0),r.addEventListener("readystatechange",function(){200===r.status&&4===r.readyState&&((i=JSON.parse(r.responseText)).name=e,(s[i.name]=i).frames?s.createTilesetFrames(i,e):s.loadHandler())}),r.send())})},createTilesetFrames:function(t,e){var n=this,a=e.replace(/[^\/]*$/,""),r=new Image;r.addEventListener("load",function(){n[a+t.meta.image]={source:r,frame:{x:0,y:0,w:r.width,h:r.height}},Object.keys(t.frames).forEach(function(e){n[e]=t.frames[e],n[e].source=r}),n.loadHandler()},!1),r.src=a+t.meta.image},loadHandler:function(){this.loaded+=1,this.toLoad===this.loaded&&(this.toLoad=0,this.loaded=0,this.whenLoaded())}},u.keyboard=h,u.makeDisplayObject=l,void 0!==p.plugins&&p.plugins(u),void 0!==p.custom&&p.custom(u),u},window.ga=p.create,(p=p||{}).plugins=function(T){function n(e){e.x+=0|e.vx,e.y+=0|e.vy}T.move=function(e){if(e instanceof Array==0)n(e);else for(var t=0;t<e.length;t++)n(e[t])},T.randomInt=function(e,t){return Math.floor(Math.random()*(t-e+1))+e},T.wait=function(e,t){return setTimeout(t,e)},T.tweens=[],T.updateTweens=function(){if(0<T.tweens.length)for(var e=T.tweens.length-1;0<=e;e--){var t=T.tweens[e];t&&t.update()}},T.updateFunctions.push(T.updateTweens),T.cubicBezier=function(e,t,n,a,r){var i=e*e;return t+(3*-t+e*(3*t-t*e))*e+(3*n+e*(-6*n+3*n*e))*e+(3*a-3*a*e)*i+r*(i*e)};var c={linear:function(e){return e},smoothstep:function(e){return e*e*(3-2*e)},smoothstepSquared:function(e){return Math.pow(e*e*(3-2*e),2)},smoothstepCubed:function(e){return Math.pow(e*e*(3-2*e),3)},acceleration:function(e){return e*e},accelerationCubed:function(e){return Math.pow(e*e,3)},deceleration:function(e){return 1-Math.pow(1-e,2)},decelerationCubed:function(e){return 1-Math.pow(1-e,3)},sine:function(e){return Math.sin(e*Math.PI/2)},sineSquared:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},sineCubed:function(e){return Math.pow(Math.sin(e*Math.PI/2),2)},inverseSine:function(e){return 1-Math.sin((1-e)*Math.PI/2)},inverseSineSquared:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),2)},inverseSineCubed:function(e){return 1-Math.pow(Math.sin((1-e)*Math.PI/2),3)},spline:function(e,t,n,a,r){return.5*(2*n+(-t+a)*e+(2*t-5*n+4*a-r)*e*e+(3*n-t-3*a+r)*e*e*e)}};T.tweenProperty=function(t,n,e,a,r,i,o,s){void 0===r&&(r=60),void 0===o&&(o=!1),void 0===s&&(s=0);var l={},d=(i=void 0===i?"smoothstep":i).split(" ");return"bounce"===d[0]&&(l.startMagnitude=parseInt(d[1]),l.endMagnitude=parseInt(d[2])),l.start=function(e,t){l.startValue=JSON.parse(JSON.stringify(e)),l.endValue=JSON.parse(JSON.stringify(t)),l.playing=!0,l.totalFrames=r,l.frameCounter=0,T.tweens.push(l)},l.start(e,a),l.update=function(){var e;l.playing&&(l.frameCounter<l.totalFrames?(e=l.frameCounter/l.totalFrames,e="bounce"!==d[0]?c[i](e):c.spline(e,l.startMagnitude,0,1,l.endMagnitude),t[n]=l.endValue*e+l.startValue*(1-e),l.frameCounter+=1):l.end())},l.end=function(){l.playing=!1,l.onComplete&&l.onComplete(),T.tweens.splice(T.tweens.indexOf(l),1),o&&T.wait(s,function(){l.start(l.endValue,l.startValue)})},l.play=function(){l.playing=!0},l.pause=function(){l.playing=!1},l},T.makeTween=function(e){var t={tweens:[]},n=(e.forEach(function(e){e=T.tweenProperty(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),t.tweens.push(e)}),0);return t.completed=function(){(n+=1)===t.tweens.length&&(t.onComplete&&t.onComplete(),n=0)},t.tweens.forEach(function(e){e.onComplete=function(){t.completed()}}),t.pause=function(){t.tweens.forEach(function(e){e.playing=!1})},t.play=function(){t.tweens.forEach(function(e){e.playing=!0})},t},T.wobble=function(e,t,n,a,r,i,o,s,l,d,c){return void 0===l&&(l=.98),(t=T.makeTween([[e,"scaleX",e.scaleX,t=void 0===t?1.2:t,a=void 0===a?10:a,"bounce "+(r=void 0===r?10:r)+" "+(i=void 0===i?10:i),d=void 0===d||d,c=void 0===c?0:c],[e,"scaleY",e.scaleY,n=void 0===n?1.2:n,a,"bounce "+(o=void 0===o?-10:o)+" "+(s=void 0===s?-10:s),d,c]])).tweens.forEach(function(e){e.onComplete=function(){1<e.endValue&&(e.endValue*=l,e.endValue<=1)&&(e.endValue=1,T.removeTween(e))}}),t},T.removeTween=function(e){e.tweens?(e.pause(),e.tweens.forEach(function(e){T.tweens.splice(T.tweens.indexOf(e),1)})):(e.pause(),T.tweens.splice(T.tweens.indexOf(e),1))},T.particles=[],T.particleEffect=function(r,i,o,e,s,t,n,a,l,d,c,u,h,f,p,g,v,m){function w(e,t){return e+Math.random()*(t-e)}void 0===r&&(r=0),void 0===i&&(i=0),void 0===o&&(o=function(){return T.circle(10,"red")}),void 0===s&&(s=0),void 0===t&&(t=!0),void 0===l&&(l=4),void 0===d&&(d=16),void 0===c&&(c=.1),void 0===u&&(u=1),void 0===h&&(h=.01),void 0===f&&(f=.05),void 0===p&&(p=.02),void 0===g&&(g=.02),void 0===v&&(v=.01),void 0===m&&(m=.03);for(var y,x=[],b=((a=void 0===a?6.28:a)-(n=void 0===n?0:n))/((e=void 0===e?10:e)-1),S=0;S<e;S++)t?(y=w(n,a),x.push(y)):(void 0===y&&(y=n),x.push(y),y+=b);x.forEach(function(e){var t,n,a;(t=o()).x=r-t.halfWidth,t.y=i-t.halfHeight,a=l,n=d,n=Math.floor(Math.random()*(n-a+1))+a,t.width=n,t.height=n,t.scaleSpeed=w(h,f),t.alphaSpeed=w(p,g),t.rotationSpeed=w(v,m),a=w(c,u),t.vx=a*Math.cos(e),t.vy=a*Math.sin(e),t.updateParticle=function(){t.vy+=s,t.x+=t.vx,t.y+=t.vy,0<t.scaleX-t.scaleSpeed&&(t.scaleX-=t.scaleSpeed),0<t.scaleY-t.scaleSpeed&&(t.scaleY-=t.scaleSpeed),t.rotation+=t.rotationSpeed,t.alpha-=t.alphaSpeed,t.alpha<=0&&(T.remove(t),T.particles.splice(T.particles.indexOf(t),1))},T.particles.push(t)})},T.updateParticles=function(){if(0<T.particles.length)for(var e=T.particles.length-1;0<=e;e--)T.particles[e].updateParticle()},T.updateFunctions.push(T.updateParticles),T.emitter=function(e,t){var n={},a=void 0;return n.playing=!1,n.play=function(){n.playing||(t(),a=setInterval(function(){t()}.bind(this),e),n.playing=!0)},n.stop=function(){n.playing&&(clearInterval(a),n.playing=!1)},n},T.contain=function(e,t,n,a){var r,i=t.x,o=t.y,s=t.width;return t=t.height,n=n||!1,e.x<i&&(n&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=i,r="left"),e.y<o&&(n&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=o,r="top"),s<e.x+e.width&&(n&&(e.vx*=-1),e.mass&&(e.vx/=e.mass),e.x=s-e.width,r="right"),t<e.y+e.height&&(n&&(e.vy*=-1),e.mass&&(e.vy/=e.mass),e.y=t-e.height,r="bottom"),r&&a&&a(r),r},T.hitTestRectangle=function(e,t,n){n=(n=void 0!==n&&n)?(a=e.gx+e.halfWidth-(t.gx+t.halfWidth),e.gy+e.halfHeight-(t.gy+t.halfHeight)):(a=e.centerX-t.centerX,e.centerY-t.centerY);var a,r=e.halfWidth+t.halfWidth;return e=e.halfHeight+t.halfHeight,Math.abs(a)<r&&Math.abs(n)<e},T.fourKeyController=function(e,t,n,a,r,i){e.direction="",leftArrow=T.keyboard(i),upArrow=T.keyboard(n),rightArrow=T.keyboard(a),downArrow=T.keyboard(r),leftArrow.press=function(){e.vx=-t,e.vy=0,e.direction="left"},leftArrow.release=function(){rightArrow.isDown||0!==e.vy||(e.vx=0)},upArrow.press=function(){e.vy=-t,e.vx=0,e.direction="up"},upArrow.release=function(){downArrow.isDown||0!==e.vx||(e.vy=0)},rightArrow.press=function(){e.vx=t,e.vy=0,e.direction="right"},rightArrow.release=function(){leftArrow.isDown||0!==e.vy||(e.vx=0)},downArrow.press=function(){e.vy=t,e.vx=0,e.direction="down"},downArrow.release=function(){upArrow.isDown||0!==e.vx||(e.vy=0)}},T.actx=new AudioContext,T.soundEffect=function(e,n,a,t,r,i,o,s,l,d,c,u,h){void 0===e&&(e=200),void 0===n&&(n=0),void 0===a&&(a=1),void 0===t&&(t="sine"),void 0===r&&(r=1),void 0===i&&(i=0),void 0===o&&(o=0),void 0===s&&(s=0),void 0===l&&(l=!1),void 0===d&&(d=0),void 0===c&&(c=0),void 0===u&&(u=void 0),void 0===h&&(h=void 0);var f,p,g,v=T.actx;function m(e){var t=v.createConvolver();t.buffer=T.impulseResponse(h[0],h[1],h[2],v),e.connect(t),t.connect(p)}function w(e){var t=v.createGain(),n=v.createDelay(),a=v.createBiquadFilter();n.delayTime.value=u[0],t.gain.value=u[1],u[2]&&(a.frequency.value=u[2]),n.connect(t),(u[2]?(t.connect(a),a):t).connect(n),e.connect(n),n.connect(p)}function y(e){e.gain.value=0,e.gain.linearRampToValueAtTime(0,v.currentTime+o),e.gain.linearRampToValueAtTime(r,v.currentTime+o+n)}function x(e){e.gain.linearRampToValueAtTime(r,v.currentTime+n+o),e.gain.linearRampToValueAtTime(0,v.currentTime+o+n+a)}function b(e){var t=e.frequency.value;l?(e.frequency.linearRampToValueAtTime(t,v.currentTime+o),e.frequency.linearRampToValueAtTime(t+s,v.currentTime+o+n+a)):(e.frequency.linearRampToValueAtTime(t,v.currentTime+o),e.frequency.linearRampToValueAtTime(t-s,v.currentTime+o+n+a))}function S(e){e.start(v.currentTime+o)}f=v.createOscillator(),g=v.createGain(),p=v.createStereoPanner?v.createStereoPanner():v.createPanner(),f.connect(g),g.connect(p),p.connect(v.destination),g.gain.value=r,v.createStereoPanner?p.pan.value=i:p.setPosition(i,0,1-Math.abs(i)),f.type=t,d=0<d?(i=e-d/2,t=e+d/2,Math.floor(Math.random()*(t-i+1))+i):e,f.frequency.value=d,0<n&&y(g),x(g),0<s&&b(f),u&&w(g),h&&m(g),0<c&&(t=v.createOscillator(),i=v.createOscillator(),e=v.createGain(),g=v.createGain(),e.gain.value=r,g.gain.value=r,t.connect(e),e.connect(v.destination),i.connect(g),g.connect(v.destination),t.type="sawtooth",i.type="sawtooth",t.frequency.value=d+c,i.frequency.value=d-c,0<n&&(y(e),y(g)),0<a&&(x(e),x(g)),0<s&&(b(t),b(i)),u&&(w(e),w(g)),h&&(m(e),m(g)),S(t),S(i)),S(f)},T.impulseResponse=function(e,t,n,a){for(var r=a.sampleRate*e,i=(e=a.createBuffer(2,r,a.sampleRate)).getChannelData(0),o=e.getChannelData(1),s=0;s<r;s++){var l=n?r-s:s;i[s]=(2*Math.random()-1)*Math.pow(1-l/r,t),o[s]=(2*Math.random()-1)*Math.pow(1-l/r,t)}return e}};const g=512;var v=4,e=0,m=ga(g,g,function(){i=m.group(),(r=m.group()).visible=!1,u=localStorage.getItem("highScore")||0;var e=m.text("OFF LINE","bold 96px Arial","dodgerblue",20,20);m.canvas.ctx.font=e.font,e.width=m.canvas.ctx.measureText(e.content).width,e.x=(g-e.width)/2,i.addChild(e),e=m.text("press space to start","bold 32px Arial","dodgerblue",20,20),m.canvas.ctx.font=e.font,e.width=m.canvas.ctx.measureText(e.content).width,e.x=(g-e.width)/2,e.y=128,i.addChild(e),h=m.text("Score: 0","32px Arial","dodgerblue",20,20),m.canvas.ctx.font=h.font,h.width=m.canvas.ctx.measureText(h.content).width,h.x=(g-h.width)/2,h.y=176,i.addChild(h),f=m.text("Highscore: "+u,"32px Arial","dodgerblue",20,20),m.canvas.ctx.font=f.font,f.width=m.canvas.ctx.measureText(f.content).width,f.x=(g-f.width)/2,f.y=208,i.addChild(f),i.addChild(m.text("Move around with WASD","16px Arial Black, Arial","slateblue",20,352)),i.addChild(m.text("Your score is the amount of time you spend on the line","16px Arial Black, Arial","slateblue",20,384)),i.addChild(m.text("Stay on the green line or else your health will drain","16px Arial Black, Arial","green",20,416)),i.addChild(m.text("Avoid the orange squares or else your health will drain very quickly","16px Arial","orangered",20,480)),i.addChild(m.text("Pick up the blue squares to increase your health","16px Arial Black, Arial","dodgerblue",20,448)),m.backgroundColor="navajowhite",(d=m.rectangle(5,m.canvas.height,"yellowgreen")).x=253.5,d.y=0,r.addChild(d),s=[];for(let e=0;e<5;e++){var t=m.rectangle(m.randomInt(16,32),m.randomInt(16,32),"orange");t.y=m.randomInt(20*-t.halfHeight,-t.halfHeight),t.x=m.randomInt(204.8,307.2),t.vy=v,r.addChild(t),s.push(t)}l=[];for(let e=0;e<2;e++){var n=m.rectangle(16,16,"dodgerblue");n.y=m.randomInt(20*-n.halfHeight,-n.halfHeight),n.x=m.randomInt(128,384),n.vy=v,r.addChild(n),l.push(n)}var e=m.rectangle(32,32,"black"),a=m.rectangle(32,32,"dodgerblue");(o=m.group(e,a)).outer=e,o.inner=a,o.x=m.canvas.width/2-o.width/2,o.y=m.canvas.height-2*o.height,m.fourKeyController(o,v,38,39,40,37),r.addChild(o),c=m.text("0","bolder 32px Arial","dodgerblue",20,20),r.addChild(c),m.key.space.press=function(){i.visible=!1,r.visible=!0,m.state=w}});function w(){v*=1.0001,m.move(o),m.contain(o,m.stage.localBounds),s.forEach(e=>{e.y>m.canvas.height+e.height&&(e.x=m.randomInt(128,384),e.y=m.randomInt(20*-e.halfHeight,-e.halfHeight)),m.move(e),m.hitTestRectangle(o,e)&&(t=!0),e.vy=v}),l.forEach(e=>{var t=m.canvas.width;e.y>m.canvas.height+e.height&&(e.x=m.randomInt(t/4,t-t/4),e.y=m.randomInt(20*-e.halfHeight,-e.halfHeight)),m.move(e),m.hitTestRectangle(o,e)&&(n&&(m.tweens=[],n.tweens=[],o.scaleX=1,o.scaleY=1),n=m.wobble(o,1.2,1.2,10,10,10,-10,-10,.9,!0),x(e,"dodgerblue",20),m.soundEffect(0,.05,.05,"sine",1,0,0,1e3,!0,1e3),m.soundEffect(250,.05,.05,"sine",1,0,.05,1e3,!0,1e3),m.soundEffect(500,.05,.05,"sine",1,0,.1,1e3,!0,500),o.inner.height+8<=32?(o.inner.y-=8,o.inner.height+=8):(o.inner.y=0,o.inner.height=32),e.x=m.randomInt(t/4,t-t/4),e.y=m.randomInt(20*-e.halfHeight,-e.halfHeight)),e.vy=v}),t?(o.inner.fillStyle="slateblue",o.inner.y+=1,--o.inner.height,x(o,"orange",5)):o.inner.fillStyle="dodgerblue",t=!1,m.hitTestRectangle(o,d)?(d.fillStyle="yellowgreen",e++,c.content=Math.floor(e/10)):(o.inner.y+=.2,o.inner.height-=.2,o.inner.fillStyle="slateblue",d.fillStyle="slateblue"),o.inner.height<=0&&(o.outer.fillStyle="tomato",x(o,"tomato",20),Math.floor(e/10)>Number(u)&&(u=Math.floor(e/10),localStorage.setItem("highScore",u)),m.state=a)}function a(){r.visible=!1,h.content="Score: "+Math.floor(e/10),f.content="Highscore: "+u,i.visible=!0,m.key.space.press=function(){m.state=y,m.key.space.press=void 0}}function y(){e=0,v=4,s.forEach(e=>{e.x=m.randomInt(128,384),e.y=m.randomInt(20*-e.halfHeight,-e.halfHeight)}),l.forEach(e=>{e.x=m.randomInt(128,384),e.y=m.randomInt(20*-e.halfHeight,-e.halfHeight)}),o.x=m.canvas.width/2-o.width/2,o.y=m.canvas.height-2*o.height,o.inner.y=0,o.inner.height=32,o.outer.fillStyle="black",o.inner.fillStyle="dodgerblue",i.visible=!1,r.visible=!0,m.state=w}function x(e,t,n){m.particleEffect(e.x+16,e.y+16,function(){return m.rectangle(8,8,t)},n,.1,!0,0,6.28,4,8,1,2,.005,.01,.005,.01,.05,.1)}m.start()</script>