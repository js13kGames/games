<head><title>Six and Seven - js13kGames 2024</title><style>html{margin:0;padding:0}section{width:100%;height:100%;display:flex;justify-content:center;align-items:center}canvas{display:block;image-rendering:pixelated;image-rendering:crisp-edges;background-color:#000}</style><section id=game></section><script>function i(t,i){return Math.floor(Math.random()*(i+1-t)+t)}function s(t,i){return Math.random()*(i-t)+t}function h(t){return t[i(0,t.length-1)]}function e(t,i,s){return t+(i-t)*s}function a(t,i=0){return 0<t.x-view.x+i&&0<t.y-view.y+i&&t.x-view.x-i<screenWidth&&t.y-view.y-i<screenHeight}function n(t){let i=!1;return()=>{i||(i=!0,t())}}function o(t){return(t.x-view.x)/screenWidth*2-1}function l(t){return t*Math.PI/180}function y(t,i,s,h=[0,1,2,3]){r.t=r.PAGE7,r.s=r.i=!0,r.h(t,i,s,h),r.t=r.SCREEN,r.s=r.i=!1}function x(t,i){return!!(0===t.o(i.x,i.y)|0===t.o(i.x+i.width,i.y)|0===t.o(i.x,i.y-i.height)|0===t.o(i.x+i.width,i.y-i.height))}function d(t,i=1,s=0,h=.5,e=!1){var r=window.audioCtx.createBufferSource(),a=window.audioCtx.createGain(),n=window.audioCtx.createStereoPanner();return r.buffer=t,r.connect(n),n.connect(a),a.connect(audioMaster),r.playbackRate.value=i,r.loop=e,a.gain.value=h,n.pan.value=s,r.start(),{volume:a,l:r}}function c(t,i,s){let h=i/s,e=Math.floor(window.innerWidth/i)*i,r=e/h;r>window.innerHeight&&(r=Math.floor(window.innerHeight/s)*s,e=r*h),t.style.width=e+"px",t.style.height=r+"px"}class f{constructor(t){this.seed=t,this.u=2**31-1,this.M=48271,this.m=0,this.state=t}next(){return this.state=(this.M*this.state+this.m)%this.u,this.state/this.u}p(t,i){return Math.floor(this.next()*(i-t+1))+t}A(t,i){return this.next()*(i-t)+t}P(){return.5<this.next()}g(t){return t[this.p(0,t.length-1)]}}class u{constructor(t,i,s,h){this.v=t,this.T=i,this.S=this.v*this.T,this.C=h,this.O=s,this.R=new f(3735928559),this.i=!1,this.s=!1,this.SCREEN=0;for(let t=1;this.C>=t;t++)this["PAGE"+t]=this.S*t;this.L=!1,this.I=this.U,this.D=0,this.N=this.O.slice(0,64),this.F=this.O.slice(512,4608),this.G=Array.from({length:64},(t,i)=>i),this.c=document.createElement("canvas"),this.c.width=this.v,this.c.height=this.T,this.k=this.c.getContext("2d"),this.t=0,this.B=this.S,this.H="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_!@#.'\"?/<()",this.j="/H8Y+j6PvwhB/JRj78OQ/+HIQ/C8fxj+MfkIT/xCl6MuSjCEIfjusYxzWcXRjF3oy5B0Yyf6PoxfBwffIQhIxjF0YxUSMa1dFRFRiohCfERHyMIRzoiJ/wTB9KXxC/DwfPh6LvhEQjoui50Xhc6MYuAAAPkIQBPxvW6vq+oAAAIYRAA2mQAOiYBAiIiAiIIIRCEE";var e=atob(this.j);this.W=new Uint8Array(8*e.length);for(let i=0;e.length>i;i++){var r=e.charCodeAt(i);for(let t=0;t<8;t++)this.W[8*i+t]=r>>7-t&1}this.q=Array.from({length:64},(t,i)=>i),this.J=[65535,65527,65015,65013,62965,62901,58805,58789,42405,42401,42145,42144,41120,40992,32800,32768,0,23130],this.Y=65535,this.k.Z=!1,this.X=this.k.getImageData(0,0,this.v,this.T),this.K=new ArrayBuffer(this.X.data.length),this.V=new Uint8Array(this.K),this.data=new Uint32Array(this.K),this.$=new Uint8Array(this.v*this.T*this.C),this._=new Uint8Array(25),this.tt=[];for(let i=0;i<6;i++)for(let t=0;t<64;t++)this.tt[64*i+t]=this.N.indexOf(this.O[64*i+t]);for(let i=0;i<128;i++)for(let t=0;t<144;t++)this.$[this.PAGE1+i+480*t]=this.N.indexOf(this.F[(i>>1)+64*(t>>1)])}clear(t,i){this.$.fill(t,i,i+this.S)}it(t,i,s,h=64){var e,r;(t|=0)<0||t>this.v-1||(i|=0)<0||i>this.T-1||(e=this.t+i*this.v+t,r=this.$[e],s<65||70<s?s%=64:s=this.tt[64*(s-65)+r],h<65||70<h?h%=64:h=this.tt[64*(h-65)+r],this.s&&(s=s<r?s:r,h=h<r?h:r),0==(r=this.Y&1<<i%4*4+t%4?s:h)&&!this.i)||(this.$[e]=r)}st(t,i,s=0){return this.$[s+(t|=0)+(i|=0)*this.v]}line(t,i,s,h,e,r=64){var a=(h|=0)-(i|=0),n=(s|=0)-(t|=0),o=a<0?(a=-a,-1):1,l=n<0?(n=-n,-1):1;if(a<<=1,n<<=1,this.it(t,i,e,r),a<n)for(var y=a-(n>>1);t!=s;)y<0||(i+=o,y-=n),y+=a,this.it(t+=l,i,e,r);else for(y=n-(a>>1);i!=h;)y<0||(t+=l,y-=a),y+=n,this.it(t,i+=o,e,r)}ht(e,r,a,n,o,l,y=64){if(!(n<3)){let i=2*Math.PI/n,s=e+a*Math.cos(o),h=r+a*Math.sin(o);for(let t=0;n>=t;t++){const n=t*i,x=e+a*Math.cos(n+o),d=r+a*Math.sin(n+o);this.line(s,h,x,d,l,y),s=x,h=d}}}et(t,i,s,h,e=64){t|=0,i|=0,h|=0;for(var r=-(s|=0),a=0,n=2-2*s;this.it(t-r,i+a,h,e),this.it(t-a,i-r,h,e),this.it(t+r,i-a,h,e),this.it(t+a,i+r,h,e),(s=n)>a||(n+=2*++a+1),(r<s||a<n)&&(n+=2*++r+1),r<0;);}rt(s,h,t,e,r=64){if(0<=t)for(let i=-t;t>i;i++){var a=Math.sqrt(t*t-i*i);for(let t=-a;a>t;t++)this.it(s+i,h+t,e,r)}}nt(t,i){i=16*(i=Math.max(0,Math.min(1,i)))*(t.length-1);var s=Math.floor(i/16);return{ot:t[s],lt:t[s+1]||t[s],ct:Math.floor(i%16)}}h(s,h,e,r){for(let i=-e;e>=i;i++)for(let t=-e;e>=t;t++){var a,n,o=Math.sqrt(t*t+i*i);o<=e&&({ot:o,lt:a,ct:n}=this.nt(r,o/e),this.Y=this.J[n],this.it(s+t,h+i,o,a))}this.Y=this.J[0]}span(i,s,h,e,r=64){for(let t=i;s>=t;t++)this.it(t,h,e,r)}ut(t,i,s,h,e,r=64){var a=0|t,n=0|i;t=t+s|0,s=i+h|0,this.line(a,n,t,n,e,r),this.line(t,n,t,s,e,r),this.line(a,s,t,s,e,r),this.line(a,n,a,s,e,r)}dt(t,i,s,h,e,r=64,a=0){var n=0|t,o=0|i,l=(t+s|0)-1,y=(t=(i+h|0)-1,this.Y=this.J[a],Math.abs(t-o));if(this.span(n,l,o,e,r),0<y)for(;--y;)this.span(n,l,o+y,e,r);this.span(n,l,t,e,r),this.Y=this.J[0]}ft(t=0,i=0,s=16,h=16,e=0,r=0,a=32,n=32,o=!1,l=!1){for(var y=s/a,x=h/n,d=0;d<n;d++)for(var c=0;c<a;c++){var f=c*y|0,u=d*x|0,f=this.st((t=o?s-f-c:t)+f,(i=l?h-u-d:i)+u,this.B);0!=(f=this.q[f])&&this.it(e+c,r+d,f)}}Mt(s=0,h=0,e=8,t=8,r=0,a=0){for(let i=0;t>i;i++)for(let t=0;e>t;t++){const e=this.st(s+t,h+i,this.B),n=this.q[e];0!=n&&this.it(r+t,a+i,n)}}wt(t,i,s,h,e=64,r=16){this.q[0]=h,this.q[22]=e,h=t%r*r,e=Math.floor(t/r)*r,this.B=this.PAGE1,this.Mt(h,e,r,r,i,s),this.q[0]=this.G[0],this.q[22]=this.G[22]}pt(s,h,t){var e,{width:r,height:a,data:n}=t;for(let i=0;a>i;i++)for(let t=0;r>t;t++)s+16*t<-16||s+16*t>this.v||(e=3*(i*r+t),this.wt(n[e],s+16*t,h+16*i,n[2+e],n[1+e]))}At(t,i){var s=document.createElement("canvas");s.width=this.v,s.height=this.T,(s=s.getContext("2d")).drawImage(t,0,0),t=s.getImageData(0,0,this.v,this.T);for(var h=new Uint32Array(t.data.buffer),e=0;h.length>e;e++)this.$[i+e]=this.N.indexOf(h[e])}Pt(){for(var t=this.S+1;t--;)0<t&&(this.data[t-1]=this.N[this.q[this.$[t-1]]]);this.X.data.set(this.V),this.k.putImageData(this.X,0,0)}gt(t,i){var s=25*this.H.indexOf(t);for(let t=0;t<25;t++)i[t]=this.W[s+t];return i}yt(t,i,s,h,e,r,a,n,o,l=64){for(var y=t.length,x=0;x<y;x++)for(var d=this.gt(t.charAt(x),this._),c=0;c<5;c++)for(var f=0;f<5;f++)1==d[5*c+f]&&(1==n?this.it(i+f*n+(5*n+h)*x,s+c*n,o,l):this.dt(i+f*n+(5*n+h)*x,s+c*n,n,n,o,l))}text(t,i,s,h,e,r,a,n,o){var l=5*n,y=t.split("\n"),x=(t=y.slice(0),y.length),d=x*l+(x-1)*e,c=i,f=s,u=i+(t=(t=t.sort((t,i)=>i.length-t.length)[0]).length*l+(t.length-1)*h),w=s+d;"center"==(r=r||"left")?(c=i-t/2,u=i+t/2):"right"==r&&(c=i-t,u=i),"center"==(a=a||"bottom")?(f=s-d/2,w=s+d/2):"bottom"==a&&(f=s-d,w=s);for(var g=c+t/2,m=f+d/2,p=0;p<x;p++){var M=y[p],v=M.length*l+(M.length-1)*h,A=i,E=s+(l+e)*p;"center"==r?A=i-v/2:"right"==r&&(A=i-v),"center"==a?E=s-d/2:"bottom"==a&&(E=s-d),this.yt(M,A,E,h,e,r,a,n,o)}return{xt:c,vt:f,cx:g,cy:m,Et:u,Tt:w,width:t,height:d}}}var g=function(){var G,U,B,L,F,k=t=>Math.sin(6.283184*t),H=t=>.003959503758*2**((t-128)/12),q=[k,t=>t%1<.5?1:-1,t=>t%1*2-1,t=>(t=t%1*4)<2?t-1:3-t];this.init=t=>{B=0,L=(G=t).Ct*t.Ot*((U=t.Rt)+1)*2,F=new Int32Array(L)},this.Lt=()=>{for(var t,i,s,h,e,r,a,n=new Int32Array(L),o=G.It[B],P=G.Ct,l=G.Ot,y=0,x=0,d=!1,c=[],f=0;f<=U;++f)for(s=o.zt[f],t=0;t<l;++t){for(var u=s?o.c[s-1].f[t]:0,w=(u&&(o.St[u-1]=o.c[s-1].f[t+l]||0,u<17)&&(c=[]),q[o.St[16]]),g=o.St[17]/512,m=2**(o.St[18]-9)/P,p=o.St[19],M=o.St[20],v=135.82764118168*o.St[21]/44100,A=1-o.St[22]/255,E=1e-5*o.St[23],S=o.St[24]/32,C=o.St[25]/512,z=6.283184*2**(o.St[26]-9)/P,O=o.St[27]/255,T=o.St[28]*P&-2,R=(f*l+t)*P,I=0;I<4;++I)if(i=s?o.c[s-1].n[t+I*l]:0){c[i]||(c[i]=((t,i)=>{for(var s,h,e,r,a=q[t.St[0]],n=t.St[1],o=t.St[3]/32,l=q[t.St[4]],y=t.St[5],x=t.St[8]/32,d=t.St[9],c=t.St[10]*t.St[10]*4,f=t.St[11]*t.St[11]*4,u=t.St[12]*t.St[12]*4,w=1/u,g=-t.St[13]/16,m=t.St[14],p=P*2**(2-t.St[15]),M=new Int32Array(c+f+u),v=0,A=0,E=0,S=0;E<c+f+u;E++,S++)S<0||(S-=p,e=H(i+(15&(m=m>>8|(255&m)<<4))+t.St[2]-128),r=H(i+(15&m)+t.St[6]-128)*(1+8e-4*t.St[7])),s=1,E<c?s=E/c:E<c+f||(s=(1-(s=(E-c-f)*w))*3**(g*s)),h=a(v+=e*s**o)*n,h+=l(A+=r*s**x)*y,d&&(h+=(2*Math.random()-1)*d),M[E]=80*h*s|0;return M})(o,i));for(var N=c[i],b=0,D=2*R;N.length>b;b++,D+=2)n[D]+=N[b]}for(b=0;b<P;b++)(e=n[h=2*(R+b)])||d?(r=v,p&&(r*=w(m*h)*g+.5),x+=(r=1.5*Math.sin(r))*(r=A*(e-x)-(y+=r*x)),e=3==M?x:1==M?r:y,E&&(e=(e*=E)<1?-1<e?k(.25*e):-1:1,e/=E),d=1e-5<(e*=S)*e,a=e*(1-(r=Math.sin(z*h)*C+.5)),e*=r):a=0,h<T||(a+=n[h-T+1]*O,e+=n[h-T]*O),n[h]=0|a,n[1+h]=0|e,F[h]+=0|a,F[1+h]+=0|e}return++B/G.Ut},this.bt=t=>{for(var i=t.createBuffer(2,L/2,44100),s=0;s<2;s++)for(var h=i.getChannelData(s),e=s;e<L;e+=2)h[e>>1]=F[e]/65536;return i},this.Dt=()=>{var t=44+2*L-8,i=t-36,s=new Uint8Array(44+2*L);s.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&i,i>>8&255,i>>16&255,i>>24&255]);for(var h=0,e=44;h<L;++h){var r=F[h];s[e++]=255&(r=r<-32767?-32767:32767<r?32767:r),s[e++]=r>>8&255}return s},this.getData=(t,i)=>{for(var s=2*Math.floor(44100*t),h=Array(i),e=0;e<2*i;e+=1){var r=s+e;h[e]=0<t&&F.length>r?F[r]/32768:0}return h}};const w={pressed:{},Nt:{},Ft:37,Gt:38,kt:39,Bt:40,Ht:32,ONE:49,jt:50,Wt:51,qt:52,Jt:53,Yt:27,a:65,b:66,n:78,c:67,w:87,Zt:83,d:68,z:90,x:88,f:70,zt:80,r:82,Xt:77,Kt:72,Qt:86,Vt(t){return this.pressed[t]},$t(t){return this.Nt[t]},_t(t){this.pressed[t.keyCode]=!0},ti(t){this.Nt[t.keyCode]=!0,delete this.pressed[t.keyCode]},update(){for(var t in this.Nt)delete this.Nt[t]}};class m{constructor(t,i,s,h){this.x=t,this.y=i,this.width=s,this.height=h}ii(t){return t.x+t.width>this.x&&this.x+this.width>t.x&&t.y+t.height>this.y&&this.y+this.height>t.y}contains(t,i){return!(this.x>t||t>this.x+this.width||this.y>i||i>this.y+this.height)}}const p=potBreak={It:[{St:[0,0,140,0,0,0,140,0,0,81,4,10,47,55,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],zt:[1],c:[{n:[159,147,147,,147,,147,,,147,,,,,,,,,,,,147,,,,,,,,,,,147],f:[]}]},{St:[0,0,128,0,0,0,128,0,0,125,0,1,59,0,0,0,0,0,0,0,2,193,171,0,29,39,3,88,3],zt:[2],c:[{n:[],f:[]},{n:[147],f:[]}]},{St:[3,116,128,0,0,154,140,59,0,127,2,2,47,61,0,0,0,96,3,1,3,94,79,0,32,84,2,48,4],zt:[3],c:[{n:[],f:[]},{n:[],f:[]},{n:[167,167,,164,,,,163,,,,,,,,,,,,,,,,,,,,,,,,,157,,159,,150,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,159,147],f:[]}]},{St:[0,255,116,64,0,255,120,0,64,127,4,6,35,0,0,0,0,0,0,0,2,14,0,3,72,0,0,25,3],zt:[4],c:[{n:[],f:[]},{n:[],f:[]},{n:[],f:[]},{n:[135,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,148],f:[]}]}],Ct:2205,Ot:32,Rt:0,Ut:4},M=torch={It:[{St:[0,0,140,0,0,0,140,0,0,81,4,11,9,1,0,0,0,187,5,0,2,47,135,0,32,108,5,16,4],zt:[1],c:[{n:[135,147,,135],f:[]}]},{St:[0,101,140,0,0,0,140,0,0,255,0,19,119,89,0,0,0,51,2,1,2,21,239,0,32,88,1,157,2],zt:[2],c:[{n:[],f:[]},{n:[99],f:[]}]},{St:[0,0,140,0,0,0,140,0,0,81,23,10,47,55,0,0,0,187,5,0,2,69,135,0,32,108,5,16,0],zt:[2],c:[{n:[],f:[]},{n:[99],f:[]}]}],Ct:3308,Ot:32,Rt:0,Ut:3},v=spawn={It:[{St:[0,160,128,37,0,160,128,38,64,210,23,7,52,85,0,0,0,20,3,1,2,69,0,0,13,61,5,76,2],zt:[1],c:[{n:[147],f:[]}]}],Ct:5513,Ot:32,Rt:0,Ut:1},A=gremlinHurt={It:[{St:[2,100,128,135,3,201,128,0,101,0,5,6,58,0,0,0,0,195,6,1,2,49,168,18,32,147,6,107,1],zt:[1],c:[{n:[142],f:[]}]}],Ct:5513,Ot:32,Rt:0,Ut:1},E=playerHurt={It:[{St:[2,100,128,219,3,201,128,0,183,0,5,6,58,0,0,0,0,195,6,0,2,49,168,18,21,147,6,33,2],zt:[1],c:[{n:[168,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,159,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,160],f:[]}]}],Ct:5513,Ot:32,Rt:0,Ut:1},S=pickup={It:[{St:[2,100,128,0,3,201,128,0,0,0,5,6,28,0,0,0,0,195,6,1,2,135,0,0,12,135,6,115,1],zt:[1],c:[{n:[157,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,159],f:[]}]}],Ct:5513,Ot:32,Rt:0,Ut:1},C=gamemusic={It:[{St:[2,48,128,0,2,51,140,18,0,0,158,40,136,0,0,0,0,0,0,0,2,5,0,0,32,0,0,24,8],zt:[1,2,3,4,1,2,3,4,5,6,1,2,3,4,1,2,3,4,5,6],c:[{n:[102],f:[]},{n:[99],f:[]},{n:[101],f:[]},{n:[104],f:[]},{n:[106],f:[]},{n:[110],f:[]}]},{St:[0,138,116,0,0,138,128,4,0,0,47,48,162,63,124,3,0,139,4,1,3,64,160,3,32,147,4,121,5],zt:[,,,,1,1],c:[{n:[123,126],f:[]}]},{St:[0,255,116,79,0,255,116,0,83,0,4,6,69,52,0,0,0,0,0,0,2,14,0,0,9,0,0,0,0],zt:[,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[135,,,,,,,,135,,,,,,,,135,,,,,,,,135],f:[]}]},{St:[0,160,128,64,0,160,128,0,64,210,4,7,52,85,0,0,0,60,4,1,2,255,0,0,9,61,5,32,6],zt:[,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,,,,,,,147,,,,,,,,,,,,,,,,147],f:[]}]},{St:[0,0,140,0,0,0,140,0,0,81,4,10,47,55,0,0,0,187,5,0,1,239,135,0,8,108,5,16,4],zt:[,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,147,147,147,,,,,,135,,,,,,,,135,135,135],f:[]}]},{St:[0,192,104,64,0,80,99,0,0,0,4,0,66,0,0,0,3,0,0,0,1,0,1,2,7,37,4,0,0],zt:[,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,150,,,150,,,150,,,,,,,,,,,,,,,147],f:[]}]},{St:[0,43,128,0,0,47,128,12,0,0,12,0,51,0,0,0,0,0,0,0,2,255,0,0,16,83,3,19,2],zt:[,,,,,,,,,,1,1,3,2,1,1,3,2],c:[{n:[138,135,138,,,,138,135,138,,,,,,,,138,135,138,,,,138,135,138],f:[]},{n:[140,138,137,,,,140,138,137,,,,,,,,140,138,137,,,,140,138,137],f:[]},{n:[137,138,140,142,140,138,137,135,137,,,,,,,,140,138,137,135,134],f:[]}]}],Ct:5513,Ot:32,Rt:19,Ut:7},O=playerDeath={It:[{St:[2,100,128,219,3,201,128,0,183,0,5,6,58,0,0,0,0,195,6,0,2,49,168,18,21,147,6,175,2],zt:[1],c:[{n:[168,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,159,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,160,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,135],f:[]}]}],Ct:3675,Ot:32,Rt:0,Ut:1},T=playerAttack={It:[{St:[0,214,104,255,3,204,104,0,255,229,13,19,57,212,0,0,0,134,6,1,3,59,15,47,68,128,4,57,2],zt:[1],c:[{n:[147],f:[]}]}],Ct:5513,Ot:32,Rt:0,Ut:1},R=altarDone={It:[{St:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,0,195,6,1,2,135,0,0,12,135,6,80,2],zt:[1],c:[{n:[147,154],f:[]}]}],Ct:5513,Ot:32,Rt:0,Ut:1},I=gremlinAttack={It:[{St:[2,138,116,0,2,138,128,4,0,0,0,41,16,63,124,5,0,139,4,1,2,64,160,3,80,147,4,60,5],zt:[1],c:[{n:[123,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,140],f:[]}]}],Ct:2544,Ot:32,Rt:0,Ut:1};class z{constructor(t,i,s,h,e={}){this.si=s,this.hi=h,this.color=e.color||22,this.ei=e.ei||!1,this.life=e.life||100,this.ri=this.life,this.ai=e.ai||0,this.ni=e.ni||0,this.oi=e.oi||null,this.x=t,this.y=i,this.li=this.x,this.ci=this.y,this.ui=!0,Array.isArray(this.color)?(this.di=this.color,this.color=this.di[0]):this.di=null}update(){this.li=this.x,this.ci=this.y,a({x:this.x,y:this.y})||this.fi(),this.x+=this.si,this.y+=this.hi,this.oi&&this.oi(this),this.life--,this.di&&(this.color=this.di[Math.floor((1-this.life/this.ri)*(this.di.length-1))]),a({x:this.x,y:this.y})||this.fi(),0<this.life||this.fi()}Mi(t,i){t.line(this.x-i.x,this.y-i.y,this.li-i.x,this.ci-i.y,this.color),this.ei&&y(this.x-i.x,this.y-i.y,10*this.life/this.ri,[2,3,4])}fi(){this.ui=!1}}class N{constructor(t,i,s){this.x=t,this.y=i,this.angle=s,this.wi=Math.min(P.mi/10+5,10),this.speed=5,this.pi=Math.min(P.mi/5,5),this.width=2*this.pi,this.height=2*this.pi,this.Ai=new m(this.x,this.y,this.width,this.height),this.ui=!0,this.life=1e3}Mi(t,i){t.et(this.x-i.x,this.y-i.y,this.pi+2,20),t.rt(this.x-i.x,this.y-i.y,this.pi,1),y(this.x-i.x,this.y-i.y,this.pi+5)}update(){13==currentFloor&&(this.wi=40,this.pi=6),0!=map.o(this.x,this.y)?(this.x+=Math.cos(this.angle)*this.speed,this.y+=Math.sin(this.angle)*this.speed,this.Ai.x=this.x,this.Ai.y=this.y,this.life--,0<this.life||(this.ui=!1)):this.fi()}fi(){this.ui=!1,y(this.x,this.y,50);for(let t=0;t<100;t++){var i=Math.random()*Math.PI*2;entitiesArray.push(new z(this.x+6*Math.cos(i),this.y+6*Math.sin(i),Math.cos(i)*Math.random()*2,Math.sin(i)*Math.random()*2,{color:[22,9,10,11,12,13,14,15],life:20,oi(t){t.hi+=.1*Math.random(),t.si+=.1*Math.random()}}))}}}class b{constructor(t,i){this.width=4,this.height=4,this.Pi=t,this.gi=i,this.x=t,this.y=i,this.angle=0,this.ui=!0,this.yi={x:0,y:0},this.acceleration={x:0,y:0},this.xi=.8,this.speed=.6,this.vi=.9,this.Ei=!1,this.mi=0,this.Ti=200,this.Si=null,this.Ci=200,this.Oi=200,this.Ri=[],this.Li=0,this.Ai=new m(this.x,this.y,this.width,this.height),this.Ii=22,this.zi=8,this.Ui=10,this.bi=5,this.Di=0,this.Ni=30,this.Fi=0,this.Gi=60,this.ki=180,this.Bi=new m(this.x,this.y,0,0)}update(){this.mi=Math.min(this.mi,this.Ti),this.angle=Math.atan2(mouse.y-(this.y-view.y),mouse.x-(this.x-view.x)),0<this.Ci||(gameOver=!0,d(sounds.playerDeath)),this.Pi=this.x,this.gi=this.y,this.yi.x+=this.acceleration.x,this.yi.x*=this.xi,this.x+=this.yi.x,x(map,this)&&(this.x=this.Pi),this.yi.y+=this.acceleration.y,this.yi.y*=this.xi,this.y+=this.yi.y,x(map,this)&&(this.y=this.gi),this.x===this.Pi&&this.y===this.gi||this.Li++,0<this.Di&&this.Di--,0<this.Fi&&this.Fi--,0<this.Hi?(this.Hi--,this.Ei=!0):this.Ei=!1,this.acceleration.x=0,this.acceleration.y=0,this.Ai.x=this.x,this.Ai.y=this.y}Mi(t,i){var s,h;this.Li%16<8?(t.line(this.x-i.x,this.y-i.y+4,this.x-i.x,this.y-i.y+8,this.Ii),t.line(this.x-i.x+3,this.y-i.y+4,this.x-i.x+3,this.y-i.y+8,this.Ii)):(t.line(this.x-i.x,this.y-i.y+4,this.x-i.x+3,this.y-i.y+8,this.Ii),t.line(this.x-i.x+3,this.y-i.y+4,this.x-i.x,this.y-i.y+8,this.Ii)),t.dt(this.x-i.x,this.y-i.y-4,this.width,8,this.Ii),t.ft(16,0,16,16,this.x-2-i.x,this.y-i.y-8,8,8,0,0),y(this.x-i.x+2,this.y-i.y+2,50,[0,1,2,3,4]),13<=this.ji()&&(s=portalLocation.x*tileSize-this.x,h=portalLocation.y*tileSize-this.y,h=Math.atan2(h,s),t.ht(this.x+20*Math.cos(h)-i.x,this.y+20*Math.sin(h)-i.y,5,3,h,11,11)),this.angle&&t.ht(this.x+20*Math.cos(this.angle)-i.x,this.y+20*Math.sin(this.angle)-i.y,3,3,this.angle,4,4)}Wi(t){t.Vt(t.Ft)||t.Vt(t.a)||t.Vt(t.qi)?this.acceleration.x=-this.speed:(t.Vt(t.kt)||t.Vt(t.d))&&(this.acceleration.x=this.speed),t.Vt(t.Gt)||t.Vt(t.w)||t.Vt(t.z)?this.acceleration.y=-this.speed:(t.Vt(t.Bt)||t.Vt(t.Zt))&&(this.acceleration.y=this.speed),t.Vt(t.n)&&this.Di<=0&&(this.Hi=this.Ji,this.Di=this.bi),t.Vt(t.x)&&this.Di<=0&&(this.Hi=this.Ji,this.Di=this.bi),(t.$t(t.c)||t.$t(t.Xt))&&10<this.mi&&this.Yi(),t.$t(t.ONE)&&(this.Ci+=100,this.Ri=[6,7]),t.$t(t.Jt)&&(currentFloor=12),mouse.Zi&&this.Di<=0&&(this.Di=this.bi,this.Xi())}Ki(t){var i=t.axes[0],s=t.axes[1];.2<Math.abs(i)&&(this.acceleration.x=i*this.speed),.2<Math.abs(s)&&(this.acceleration.y=s*this.speed),(t.buttons[1].pressed||t.buttons[5].pressed||t.buttons[7].pressed||t.buttons[1].pressed)&&this.Fi<=0&&10<this.mi&&(this.Fi=this.Ni,this.Yi()),i=t.axes[2],s=t.axes[3],!(.2<Math.abs(i)||.2<Math.abs(s))||0<this.Di||(this.angle=Math.atan2(s,i),this.Di=this.bi,this.Xi())}Qi(t){3==t.which&&this.Fi<=0&&10<this.mi&&(this.Fi=this.Ni,this.Yi()),1==t.which&&this.Xi()}Vi(){mouse.Zi&&this.Di<=0&&(this.Di=this.bi,this.Xi())}Xi(){d(sounds.playerHurt,1.5,0,.1,!1),bulletsArray.push(new N(this.x,this.y,this.angle))}Yi(){gremlinsArray.forEach(t=>{var i=t.x-this.x,s=t.y-this.y;Math.sqrt(i*i+s*s)<150&&t.$i(30)});for(let t=0;t<400;t++){var h=Math.random()*Math.PI*2,e=this.x+Math.cos(h)*i(0,150),h=this.y+Math.sin(h)*i(0,150);entitiesArray.push(new z(e,h,s(-.3,.3),-.75,{color:[22,9,10,11,12,13,14,15],life:100,oi(t){t.hi+=s(-.5,.5),t.si+=s(-.5,.5)}})),y(e,h,10)}this.mi-=10,d(sounds.playerAttack,.5,0,.7),d(sounds.playerDeath,.5,0,.7)}ji(){return this.Ri.reduce((t,i)=>t+i,0)}}class D{constructor(t,i,s,h){this.x=t,this.y=i,this.width=s,this.height=h,this._i=null,this.ts=null,this.complete=!1,this.fill=2,this.ss=7}hs(t,i){return t.x/i>this.x&&this.x+this.width>t.x/i&&t.y/i>this.y&&this.y+this.height>t.y/i}Mi(t,i){t.dt(this.x-i.x,this.y-i.y,this.width,this.height,this.fill)}es(t,i){this.ts&&this.ts.Mi(t,i),this._i&&this._i.Mi(t,i)}update(t){var i=this.hs(t,tileSize);t.Si=i?this:t.Si,this.ts&&this.ts.update(t),this.complete=this.ts&&this.ts.rs,this._i&&this._i.update(t),this.fill=i?4:2,this.fill=this.complete?5:this.fill}}class U{constructor(t,i){this.type="torch",this.x=t,this.y=i,this.size=3,this.Ci=0,this.Oi=70,this.as=20,this.ns=!1,this.os=!1,this.rs=!1,this.fill=2}Mi(t,i){t.t=t.SCREEN,t.rt(this.x-i.x,this.y-i.y,this.size,this.fill),this.ns&&y(this.x-i.x,this.y-i.y,25,[0,1,2,3,4])}update(){this.fill=this.ns?6:63,this.fill=this.rs?10:this.fill;var t=this.rs?[10,11,12,13,14,15]:[22,8,7,6,5,4,3,2,1],h=(this.ns&&entitiesArray.push(new z(this.x+i(-2,2),this.y,s(-.05,.05),-.25,{color:t,life:70})),t=P.x-this.x,P.y-this.y);Math.sqrt(t*t+h*h)>=this.as||this.ns||this.os||(this.Ci=this.Oi,this.ns=!0,this.os=!0),0<this.Ci||(this.ns=!1),this.os&&(d(sounds.torch),this.os=!1)}}class G{constructor(t,i,h=3){this.x=t*tileSize,this.y=i*tileSize,this.pi=40,this.ls=h,this.cs=[],this.ns=!1,this.rs=!1,this.fill=16,this.ss=10,this.us(),this.ds=20,this.fs=20,this.Ms=n(()=>{d(sounds.altarDone),P.Ri.push(this.ls);for(let t=0;t<300;t++){var i=Math.random()*Math.PI*2;entitiesArray.push(new z(this.x+6*Math.cos(i),this.y+6*Math.sin(i),s(-2,2),s(-2,2),{color:[22,9,10,11,12,13,14,15],life:100,oi(t){t.hi+=s(-.5,.5),t.si+=s(-.5,.5)}}))}}),this.ws=n(()=>{})}update(){if(this.cs.forEach(t=>t.update()),this.ns=this.cs.filter(t=>t.ns).length===this.ls,this.rs=this.ns&&this.ds<=0,this.rs){this.fill=this.ss;for(let t=0;t<4;t++){var i=Math.random()*Math.PI*2;entitiesArray.push(new z(this.x+6*Math.cos(i),this.y+6*Math.sin(i),s(-.05,.05),s(-.1,-.3),{color:[14,13,12,11,10],life:30}))}this.ns=!0,this.cs.forEach(t=>{t.Ci=25,t.rs=!0}),this.Ms()}this.fill=this.rs?this.ss:12,this.ns&&0<this.ds&&a({x:this.x,y:this.y})&&(this.ds-=.05,P,P)}Mi(i,h){if(a({x:this.x,y:this.y},40)){for(let t=0;this.ls>t;t++){var e=this.cs[t],r=this.cs[(t+1)%this.ls];i.line(e.x-h.x,e.y-h.y,r.x-h.x,r.y-h.y,e.ns&&r.ns?22:1)}for(let t=0;this.ls>t;t++){var n=this.cs[t];i.line(this.x-h.x,this.y-h.y,n.x-h.x,n.y-h.y,n.ns?22:2)}i.rt(this.x-h.x,this.y-h.y,8,this.fill);for(let t=0;this.ls>t;t++)this.cs[t].Mi(i,h);if(y(this.x-h.x,this.y-h.y,100,[2,3,4]),0<this.ds&&(i.text(""+this.ds.toFixed(2),this.x-h.x,this.y-h.y+8,1,1,"center","top",1,22),this.fs>this.ds)&&this.ns)for(let t=this.fs;0<t;t--){var o=this.x+Math.cos(t/this.fs*Math.PI*2)*this.pi,l=this.y+Math.sin(t/this.fs*Math.PI*2)*this.pi;t>this.ds&&entitiesArray.push(new z(o,l,s(-.05,.05),s(-.1,-.3),{color:[22,9,8,7,6,5,4,3,2,1],life:30}))}}}us(){let i=0,s=2*Math.PI/this.ls;for(let t=0;this.ls>t;t++)this.cs.push(new U(this.x+Math.cos(i)*this.pi,this.y+Math.sin(i)*this.pi)),i+=s}}class L{constructor(t,i){this.x=t*tileSize,this.y=i*tileSize,this.size=40,this.fill=16,this.active=!1,this.ms=n(()=>{window.ms()})}Mi(e,r){e.t=e.SCREEN,e.rt(this.x-r.x,this.y-r.y,this.size,this.fill),y(this.x-r.x,this.y-r.y,this.size+10,[0,1,2,3]),P.Ri.forEach((i,s)=>{var h=P.ji()<13?0:t/900;e.ht(this.x-r.x,this.y-r.y,15+2*i,i,i%2==0?h:-h+l(s*(360/13)),22,22)});for(let t=0;t<10;t++){var i=Math.random()*Math.PI*2;entitiesArray.push(new z(this.x+Math.cos(i)*this.size,this.y+Math.sin(i)*this.size,-.2*Math.cos(i),-.2*Math.sin(i),{color:this.active?[22,9,10,11,12,13,14,15]:4,life:50,oi(t){t.hi+=.1*Math.random()-.05,t.si+=.1*Math.random()-.05}}))}}update(i){var s=i.x-this.x,h=i.y-this.y,s=Math.sqrt(s*s+h*h);this.active=13<=i.ji(),s<10&&this.active&&(floorCompleteTime=t,this.ms())}}class B{constructor(t,i,h){this.types={HEALTH:{life:500,color:5,effect(t){t.Ci=Math.min(t.Ci+10,t.Oi)}},GREMLINBLOOD:{life:500,color:11,effect(t){t.mi+=1}}},this.x=i,this.y=h,this.Pi=i,this.gi=h,this.ui=!0,this.type=this.types[t],this.life=this.type.life,this.ps=this.type.life,this.color=this.type.color,this.effect=this.type.effect,this.yi={x:s(-1,1),y:s(-1,1)}}update(){this.Pi=this.x,this.gi=this.y,this.yi.x*=.8,this.yi.y*=.8,this.x+=this.yi.x,x(map,this)&&(this.yi.x*=-1),this.y+=this.yi.y,x(map,this)&&(this.yi.y*=-1),this.ui&&(this.life--,0<this.life||(this.ui=!1),Math.hypot(this.x-P.x,this.y-P.y)<8)&&(this.effect(P),this.ui=!1,d(sounds.pickup))}Mi(t,i){t.t=t.SCREEN,t.dt(this.x-i.x,this.y-i.y,4,4,this.color),y(this.x-i.x,this.y-i.y,9)}}class k{constructor(t,i){this.type="pot",this.x=t*tileSize,this.y=i*tileSize,this.Ai=new m(this.x,this.y,8,8),this.size=3,this.As=!1,this.ui=!0}Mi(t,i){t.t=t.SCREEN,t.dt(this.x-i.x,this.y-i.y,6,1,43),t.dt(this.x-i.x+1,this.y-i.y+1,4,4,43),t.dt(this.x-i.x,this.y-i.y+5,6,1,43),t.dt(this.x-i.x-1,this.y-i.y+6,8,6,43),y(this.x-i.x,this.y-i.y,25,[0,1,2,3,4])}update(){var t,s;if(P.Ei&&!this.As&&(t=P.x-this.x,s=P.y-this.y,Math.sqrt(t*t+s*s)<20)&&(this.As=!0),this.As){for(let t=0;t<10;t++)entitiesArray.push(new B("HEALTH",this.x+i(-15,15),this.y+i(-15,15)));d(sounds.potBreak),this.ui=!1}}$i(t){this.As=!0}}class F{constructor(t,i,s,h,e){this.width=t,this.height=i,this.Ps=s,this.gs=h,this.ys=e,this.xs=2e4,this.vs=[],this.Es=[],this.Ts=1,this.Ss=.1,this.Cs={width:12,height:12},this.Os=10,this.Rs()}Rs(){this.Ls(),this.Is(),this.Es=this.zs(this.Cs),this.Us(this.Es);var t=this.bs(this.Es);this.Ds=this.Ns(t);const i=this.Fs(this.Ds);this.vs=this.vs.filter(t=>i.has(t)),this.vs.sort((t,i)=>t.width*t.height-i.width*i.height);let s=this.Os;this.Es.length<5&&0<s?(this.Rs(),s--):this.Gs(this.vs),0===s&&console.log("Failed to generate floor")}Ls(){for(let t=0;this.ys>t;t++){var i=Math.floor(this.ks(2,this.Ps,this.Ts,this.Ss)),s=Math.floor(this.ks(2,this.gs,this.Ts,this.Ss)),h=Math.floor(this.width/2)-Math.floor(i/2)+Math.floor(i*Math.random()),e=Math.floor(this.height/2)-Math.floor(s/2)+Math.floor(s*Math.random());this.vs.push(new D(h,e,i,s))}}Is(){for(let t=0;this.xs>t;t++){let s=!1;for(let i=0;this.vs.length>i;i++)for(let t=i+1;this.vs.length>t;t++)this.Bs(this.vs[i],this.vs[t])&&(this.Hs(this.vs[i],this.vs[t]),s=!0);if(!s)break}}Bs(t,i){return!!(t.x+t.width>i.x&&t.x<i.x+i.width&&i.y<t.y+t.height&&t.y<i.y+i.height)}Hs(t,i){var s=t.x+t.width/2-(i.x+i.width/2),h=t.y+t.height/2-(i.y+i.height/2),e=2*Math.random()-1;Math.abs(s)>Math.abs(h)?0<s?(t.x+=e,i.x-=e):(i.x+=e,t.x-=e):0<h?(t.y+=e,i.y-=e):(i.y+=e,t.y-=e)}zs(i){return this.vs.filter(t=>t.width>i.width&&i.height<t.height)}Us(t){let e=!1,r=!1,a=!1;t.forEach(t=>{var i=t.x+Math.floor(t.width/2),s=t.y+Math.floor(t.height/2),h=Math.round(2*Math.random())+3;e?r?a?t.ts=new G(i,s,h):(t.ts=new G(i,s,7),a=!0):(t.ts=new G(i,s,6),r=!0):(t._i=new L(i,s),portalLocation={x:i,y:s},e=!0)})}Gs(t){t.forEach(t=>{var i=Math.floor(t.width/2)+t.x;t=Math.floor(t.height/2)+t.y,Math.random()<.01&&entitiesArray.push(new k(i,t))})}bs(s){var h=[];for(let i=0;s.length>i;i++)for(let t=i+1;s.length>t;t++){var e=s[i],r=s[t],a=this.js(e,r);h.push({Ws:e,qs:r,Js:a})}return h}js(t,i){var s=t.y+t.height/2,h=i.y+i.height/2;return Math.sqrt(Math.pow(t.x+t.width/2-(i.x+i.width/2),2)+Math.pow(s-h,2))}Ys(t){t.sort((t,i)=>t.Js-i.Js);const h=[],e=new Map;return t.forEach(t=>{var i=this.find(e,t.Ws),s=this.find(e,t.qs);i!==s&&(h.push(t),e.set(s,i))}),h}Ns(i){const s=this.Ys(i),h=i.filter(t=>!s.includes(t)),e=Math.floor(.05*h.length);for(let t=0;e>t;t++){const i=h[Math.floor(Math.random()*h.length)];s.push(i),h.splice(h.indexOf(i),1)}return s}find(t,i){return t.has(i)||t.set(i,i),t.get(i)!==i&&t.set(i,this.find(t,t.get(i))),t.get(i)}Fs(t){const i=new Set;return t.forEach(t=>{i.add(t.Ws),i.add(t.qs),this.Zs(t.Ws,t.qs,i)}),i}Zs(h,t,e){let r=h.x+Math.floor(h.width/2),a=h.y+Math.floor(h.height/2);for(var n=t.x+Math.floor(t.width/2),o=t.y+Math.floor(t.height/2);r!==n||a!==o;){const h=o>a?1:-1;var l=r!==n?r+(n>r?1:-1)+Math.floor(3*Math.random()):r,y=a!==o?a+h+Math.floor(3*Math.random()):a,l=Math.min(Math.max(l,Math.min(r,n)),Math.max(r,n)),y=Math.min(Math.max(y,Math.min(a,o)),Math.max(a,o));let t=Math.floor(5*Math.random())+1,i=Math.floor(5*Math.random())+1,s=new D(Math.min(r,l),Math.min(a,y),Math.abs(l-r)+t,Math.abs(y-a)+i);this.vs.push(s),e.add(s),this.vs.forEach(t=>{this.Bs(s,t)&&e.add(t)}),r=l,a=y}}Xs(i,t){let s=!1;return t.forEach(t=>{this.Bs(i,t)&&(s=!0)}),s}Ks(t,i,s){return this.Qs(i.x+i.width/2,i.y+i.height/2,s.x+s.width/2,s.y+s.height/2,t.x,t.y,t.x+t.width,t.y+t.height)}Qs(t,i,s,h,e,r,a,n){return this.Vs(t,i,s,h,e,r,a,r)||this.Vs(t,i,s,h,a,r,a,n)||this.Vs(t,i,s,h,a,n,e,n)||this.Vs(t,i,s,h,e,n,e,r)||e<t&&t<a&&r<i&&i<n}Vs(t,i,s,h,e,r,a,n){var o=(a-e)*(h-i)-(n-r)*(s-t);return 0!=o&&(s=((s-t)*(i-r)-(h-i)*(t-e))/o,!((h=((a-e)*(i-r)-(n-r)*(t-e))/o)<0||1<h||s<0||1<s))}$s(t,i){var s,h;t.x!==i.x&&(s=Math.min(t.x,i.x),h=Math.abs(t.x-i.x),this.vs.push(new D(s,t.y+Math.floor(t.height/2)-1,h,2))),t.y!==i.y&&(s=Math.min(t.y,i.y),h=Math.abs(t.y-i.y),this.vs.push(new D(i.x+Math.floor(i.width/2)-1,s,2,h)))}ks(t,i,s,h){return(i=Math.random()*(i-t)+t)*(1-(t=Math.random()*h))+s*t}Mi(i,s){this.vs.forEach(t=>t.Mi(i,s))}}class H{constructor(t,i,s,h){this.width=t,this.height=i,this._s=s,this.th=h,this.ih=new Uint8Array(t*i),this.sh=new Uint8Array(t*i),this.hh=new Uint8Array(t*i),this.eh=new Uint8Array(t*i),this.vs=[],this.cs=[],this.rh=null,this.ah=[[43,44],[34,35],[27,28]],this.nh(),this.Lt(),this.oh=0,this.lh=0,this.uh=0,this.dh=0}nh(){}Lt(){r.R.state=3735928559,r.t=r.PAGE3,r.clear(0,r.PAGE3),rooms.forEach(t=>{t.Mi(r,{x:0,y:0})}),r.t=r.SCREEN;for(let i=0;this.height>i;i++)for(let t=0;this.width>t;t++){var s=r.$[this.th+i*this.width+t],h=0===s?r.R.g([1,2,3,4]):r.R.g([1,2]),e=0==s?[50,51]:this.ah[currentFloor%3];this.ih[i*this.width+t]=s,this.sh[i*this.width+t]=h,this.hh[i*this.width+t]=e[0],this.eh[i*this.width+t]=e[1]}for(let i=0;this.height>i;i++)for(let t=0;this.width>t;t++){var a=i*this.width+t,n=a+1,o=a-this.width,l=a+this.width;0===this.ih[a]&&(0!==this.ih[a-1]&&(this.sh[a]=1,this.hh[a]=40,this.eh[a]=38),0!==this.ih[n]&&(this.sh[a]=1,this.hh[a]=40,this.eh[a]=38),0!==this.ih[o]&&(this.sh[a]=1,this.hh[a]=40,this.eh[a]=38),0!==this.ih[l])&&(this.sh[a]=1,this.hh[a]=40,this.eh[a]=38)}}update(){this.Lt()}Mi(s,h){for(let i=0;this.height>i;i++)for(let t=0;this.width>t;t++)a({x:t*this._s,y:i*this._s},this._s)&&(s.t=s.SCREEN,s.wt(this.sh[i*this.width+t],t*this._s-h.x,i*this._s-h.y,this.hh[i*this.width+t],this.eh[i*this.width+t]))}o(t,i){return this.ih[Math.floor(i/this._s)*this.width+Math.floor(t/this._s)]}}class q{constructor(t,i,s,h){this.x=t,this.y=i,this.ps=s,this.life=s,this.ui=!0,this.color=h}update(){this.ui&&(0<this.life?--this.life:this.ui=!1)}Mi(i,s){i.Y=i.J[15-Math.floor(this.life/this.ps*15)];for(let t=Math.floor(this.life/10);0<t;t--)i.et(this.x-s.x,this.y-s.y,this.ps-this.life-t,this.color,0),y(this.x-s.x,this.y-s.y,this.ps-this.life-t,[3,3,0]);i.et(this.x-s.x,this.y-s.y,this.ps-this.life,this.color,0),i.Y=i.J[0]}}class j{constructor(t,i,s=!1){this.fh=s,this.x=t,this.y=i,this.width=8,this.height=10,this.Pi=t,this.gi=i,this.ui=!0,this.Ci=30,this.Oi=30,this.yi={x:0,y:0},this.acceleration={x:0,y:0},this.Mh=16,this.xi=.8,this.speed=.25,this.vi=.3,this.wh=60,this.mh=700,this.ph=950,this.Ah=!1,this.Bi=new m(0,0,0,0),this.Ph=0,this.gh=0,this.wi=10,this.Ei=!1,this.Si=null,this.yh=0,this.xh=0,this.Li=0,this.vh=0,s&&(this.width=20,this.height=12,this.speed=.1,this.vi=.2,this.Ci=50,this.Oi=50,this.wi=20,this.wh=60,this.mh=1e3,this.ph=500),13==currentFloor&&(this.Ci=10,gremlinSpawnRate=700),this.Ai=new m(this.x,this.y-5,this.width,this.height+5),this.Eh={rh:1,Th:2},this.target={type:this.Eh.rh,x:P.x,y:P.y}}Mi(i,s){if(this.ui){this.Ah&&i.line(this.x-s.x,this.y-s.y,this.target.x-s.x,this.target.y-s.y,h([10,11,12,13])),this.Oi>this.Ci&&(i.dt(this.x-s.x-2,this.y-s.y-16,this.width+4,2,22),i.dt(this.x-s.x-2,this.y-s.y-16,(this.width+4)*(this.Ci/this.Oi),2,10)),i.dt(this.x-s.x,this.y-s.y,this.width,this.height,this.Mh,this.Mh),i.rt(this.x+this.width/2-s.x,this.y-s.y,this.width/2,this.Mh);for(let t=0;t<3;t++){var e=2*Math.PI/3*t+Date.now()/300;i.rt(this.x+this.width/2+Math.cos(e)*(this.fh?8:4)-s.x,this.y+this.height+3*Math.sin(e)-s.y,this.fh?6:3,this.Mh)}y(this.x-s.x,this.y-s.y,30,[2,4]);var t=this.Ah?h([10,11,12,13]):this.Mh,r=this.fh?4:2,a=this.fh?6:4;i.dt(this.x-s.x-2,this.y-s.y-2,r,a,t),i.dt(this.x-s.x+this.width-2,this.y-s.y-2,r,a,t),this.fh&&(i.dt(this.x-s.x+2,this.y-s.y+2,2,2,22),i.dt(this.x-s.x+this.width-4,this.y-s.y+2,2,2,22)),13!=P.ji()&&13!=currentFloor||(this.Mh=6,this.speed=.5,this.vi=.6)}}update(){var t;this.ui&&(this.yh=Math.atan2(P.y-this.y,P.x-this.x),this.xh=Math.hypot(P.x-this.x,P.y-this.y),this.Si!==P.Si&&(this.target.type===this.Eh.Th&&(this.target.type=this.Eh.rh),this.Si=P.Si),0<this.Ci||this.fi(),t=Date.now(),this.Ah&&(this.target.type===this.Eh.rh&&P.isDashing&&(P.Ci+=5),0<this.ph-(t-this.gh)||this.Sh()),this.Pi=this.x,this.gi=this.y,this.Ch(),this.Oh(),Math.hypot(this.target.x-this.x,this.target.y-this.y)>this.wh||this.mh>t-this.Ph||this.Ah?this.Rh():this.Lh(),this.Ih(),this.zh(),this.Uh())}$i(t){this.Ci-=t,this.yi.x=4*-Math.cos(this.yh),this.yi.y=4*-Math.sin(this.yh),d(sounds.gremlinHurt,s(.9,1.1),o(this),.2)}Ih(){this.Ai.ii(P.Ai)&&(--P.Ci,P.acceleration.x+=4*Math.cos(this.yh),P.acceleration.y+=4*Math.sin(this.yh))}zh(){P.Ei&&this.Ai.ii(P.Bi)&&(this.Ci-=P.Ui,this.yi.x=24*-Math.cos(this.yh),this.yi.y=24*-Math.sin(this.yh),d(sounds.gremlinHurt,s(.9,1.1),o(this),.2))}bh(t,i,s,h,e){let r=Math.abs(s-t),a=Math.abs(h-i),n=t<s?1:-1,o=i<h?1:-1,l=r-a;for(;;){if(x(e,{x:t,y:i,width:1,height:1}))return!0;if(t===s&&i===h)break;var y=2*l;-a<y&&(l-=a,t+=n),y<r&&(l+=r,i+=o)}return!1}Oh(){var t=this.target.x-this.x,i=this.target.y-this.y,s=Math.hypot(t,i);0<s&&(this.acceleration.x=t/s*this.speed,this.acceleration.y=i/s*this.speed),this.bh(this.x,this.y,this.target.x,this.target.y,map)&&(s=Math.atan2(i,t)-.1,this.bh(this.x,this.y,this.x+Math.cos(s)*this.speed,this.y+Math.sin(s)*this.speed,map)?(i=Math.atan2(i,t)+.1,this.bh(this.x,this.y,this.x+Math.cos(i)*this.speed,this.y+Math.sin(i)*this.speed,map)||(this.acceleration.x=Math.cos(i)*this.speed,this.acceleration.y=Math.sin(i)*this.speed)):(this.acceleration.x=Math.cos(s)*this.speed,this.acceleration.y=Math.sin(s)*this.speed))}Ch(){if(this.wh>this.xh)this.target.type=this.Eh.rh,this.target.x=P.x,this.target.y=P.y;else{if(P.Si.ts&&!P.Si.ts.rs){let t=null,i=1/0;for(const h of P.Si.ts.cs){var s;h.ns&&i>(s=Math.hypot(h.x-this.x,h.y-this.y))&&0<h.Ci&&(t=h,i=s)}if(t)return this.target.type=this.Eh.Th,this.target.x=t.x,this.target.y=t.y,h=this.target.x-this.x,e=this.target.y-this.y,void(0<(r=Math.hypot(h,e))&&(this.acceleration.x=h/r*this.speed,this.acceleration.y=e/r*this.speed))}this.target.type=this.Eh.rh,this.target.x=P.x,this.target.y=P.y;var h=this.target.x-this.x,e=this.target.y-this.y,r=Math.hypot(h,e);0<r&&(this.acceleration.x=h/r*this.speed,this.acceleration.y=e/r*this.speed)}}Rh(){Math.random()<.1&&(this.acceleration.x=(Math.random()-.5)*this.speed,this.acceleration.y=(Math.random()-.5)*this.speed)}Lh(){this.Ah||d(sounds.gremlinAttack,s(.9,1.1),o(this),.1),this.Ah=!0,this.gh=Date.now(),this.acceleration.x=0,this.acceleration.y=0}Sh(){if(this.Ah=!1,this.Ph=Date.now(),this.target.type!==this.Eh.rh||P.Ei){if(P.Ei&&this.target.type===this.Eh.rh)this.$i(P.Ui),P.Ci+=10;else if(this.target.type===this.Eh.Th)for(const i of P.Si.ts.cs)i.x===this.target.x&&i.y===this.target.y&&(i.Ci-=20)}else if(Math.hypot(P.x-this.x,P.y-this.y)<=this.wh){P.Ci-=this.wi,P.acceleration.x+=6*Math.cos(this.yh),P.acceleration.y+=6*Math.sin(this.yh),d(sounds.playerHurt);let t=100;for(;t--;){var i=P.x-this.x,h=P.y-this.y,h=this.y+h*t/100;entitiesArray.push(new z(this.x+i*t/100+s(-2,2),h+s(-2,2),s(-.5,.5),s(-.5,.5),{color:[22,8,7,6,5,4,3,2,1],life:40,oi(t){t.si+=.3*(Math.random()-.5),t.hi+=.3*(Math.random()-.5)}}))}}}Dh(t,i,s){let h={x:0,y:0},e=0;for(var r of i){var a=Math.sqrt((t.x-r.x)*(t.x-r.x)+(t.y-r.y)*(t.y-r.y));0<a&&a<s&&((r={x:t.x-r.x,y:t.y-r.y}).x/=a,r.y/=a,h.x+=r.x,h.y+=r.y,e++)}return 0<e&&(h.x/=e,h.y/=e,0<(i=Math.sqrt(h.x*h.x+h.y*h.y))&&(h.x/=i,h.y/=i,h.x*=t.vi,h.y*=t.vi),h.x-=t.yi.x,h.y-=t.yi.y),h}Uh(){this.Nh=this.Dh(this,gremlinsArray,20),this.acceleration.x+=this.Nh.x,this.acceleration.y+=this.Nh.y,this.yi.x+=this.acceleration.x,this.yi.y+=this.acceleration.y,this.yi.x*=this.xi,this.yi.y*=this.xi,this.x+=this.yi.x,x(map,this)&&(this.x=this.Pi,this.yi.x=0),this.y+=this.yi.y,x(map,this)&&(this.y=this.gi,this.yi.y=0),this.Ai.x=this.x,this.Ai.y=this.y-5}fi(){this.ui=!1,entitiesArray.push(new q(this.x,this.y,50,5));let t=i(2,5);for(;t--;)entitiesArray.push(new z(this.x,this.y,s(-.1,.1),s(-.1,.1),{color:[16,15,14,13,12,11],life:50})),entitiesArray.push(new B("GREMLINBLOOD",this.x+s(-10,10),this.y+s(-10,10)));i(0,1)&&entitiesArray.push(new B("HEALTH",this.x+s(-10,10),this.y+s(-10,10)))}}(()=>{function y(){entitiesArray=[],gremlinsArray=[],(floors=[]).push(new F(480,270,18,18,90)),thirteenthFloor=((t=JSON.parse(JSON.stringify(floors[0]))).vs=[],t.Es=[],s=new D(227,129,28,14),t.vs.push(s),(i=new G(241,136,13)).pi=90,i.ds=40,i.cs=[],i.us(),t.Es.push(s),s.ts=i,i=new L(241,136),s._i=i,t),rooms=floors[0].vs;var t,i,s=(window.vs=rooms)[Math.floor(Math.random()*rooms.length)];P=new b((s.x+s.width/2)*tileSize,(s.y+s.height/2)*tileSize),map=new H(480,270,tileSize,r.PAGE3),gameInitialized=!0}function s(t,i){t=t.gamepad,i?gamepads[t.index]=t:delete gamepads[t.index]}function x(i){for(let t=0;i.length>t;t++)i[t].ui||i.splice(t,1)}function f(i,s){for(let t=0;i.length>t;t++){var h=i[t];for(let t=0;s.length>t;t++){var e=s[t];null!=h.Ai&&h.Ai.ii(e.Ai)&&(h.$i(e.wi),e.fi())}}}function m(){var s,a,n=performance.now(),o=n-lastFrameTime;switch(frameCount++,n-lastFrameTime<1e3/60||(fps=1e3*frameCount/(n-lastFrameTime),lastFrameTime=n,frameCount=0),gamestate){case 0:r.clear(64,r.SCREEN),r.t=r.SCREEN,r.text(audioTxt,238,130,1,2,"center","top",1,22),audioTxt=started?"RETICULATING SPLINES":"CLICK TO BEGIN GENERATION",soundsReady==totalSounds&&1==gameInitialized&&(audioTxt="ALL ASSETS CREATED.\nPRESS UP/W/Z TO CONTINUE"),(w.$t(w.Gt)||w.$t(w.w)||w.$t(w.z))&&(startGameMusic(),gamestate=2),r.Pt();break;case 1:s=o,(w.$t(w.Yt)||w.$t(w.zt))&&(paused=!paused),w.$t(w.r)&&(gremlinSpawnRate=2e3,currentFloor=1,gameOver=!1,gameState=2,y()),(gamepads=navigator.getGamepads())[0]?P.Ki(gamepads[0]):P.Wi(w),paused?audioMaster.gain.value=.03:(audioMaster.gain.value=1,gameOver||14!=currentFloor&&(t+=s,rooms.forEach(t=>{t.update(P)}),entitiesArray.forEach(t=>t.update()),gremlinsArray.forEach(t=>t.update()),bulletsArray.forEach(t=>t.update()),f(entitiesArray,bulletsArray),f(gremlinsArray,bulletsArray),P.update(),13!=P.ji()&&13!=currentFloor||(gremlinSpawnRate=1100),t%gremlinSpawnRate<s&&(s=P.Si).ts&&(a=h([(s={x1:s.x+1,y1:s.y+1,x2:s.x+s.width-2,y2:s.y+s.height-2}).x1,s.x2]),s=h([s.y1,s.y2]),gremlinsArray.push(new j(a*tileSize,s*tileSize,0==i(0,1))),d(sounds.spawn)),map.update(),deadzone={x:200,y:100},P.x-view.x>480-deadzone.x&&(view.target.x=P.x-480+deadzone.x),P.x-view.x<deadzone.x&&(view.target.x=P.x-deadzone.x),270-deadzone.y<P.y-view.y&&(view.target.y=P.y-270+deadzone.y),P.y-view.y<deadzone.y&&(view.target.y=P.y-deadzone.y),view.x=e(view.x,view.target.x,.1),view.y=e(view.y,view.target.y,.1))),r.clear(1,r.SCREEN),r.t=r.PAGE7,r.clear(0,r.PAGE7),r.dt(0,0,480,270,4,5,8),r.t=r.SCREEN,r.Y=65535,map.Mi(r,view),rooms.forEach(t=>{t.es(r,view)}),U(entitiesArray),U(gremlinsArray),U(bulletsArray),P.Mi(r,view),generatingNewFloor&&(floorCompleteTime,r.dt(0,0,480,270,3),text="LOADING THE NEXT FLOOR",r.text(text,240,151,1,1,"center","middle",1,22)),r.q=[65,66,67,68,69,70],r.B=r.PAGE7,r.t=r.SCREEN,r.Mt(0,0,480,270,0,0),r.q=r.G.slice(),r.B=r.PAGE1,paused&&(r.dt(0,0,480,270,66,67,8),text="PAUSED",r.text(text,240,10,1,1,"center","middle",1,22),N()),gameOver&&(r.dt(0,0,480,270,66,67,8),text="GAME OVER",r.text(text,240,135,1,1,"center","middle",3,22),text="PRESS R TO RESTART",r.text(text,240,155,1,1,"center","middle",1,22)),14==currentFloor&&(r.clear(64,r.SCREEN),text="CONGRATULATIONS",r.text(text,240,135,1,1,"center","middle",3,22),text="YOU HAVE ESCAPED THE DUNGEON",r.text(text,240,155,1,1,"center","middle",1,22),text="THANK YOU FOR PLAYING!",r.text(text,240,175,1,1,"center","middle",1,22)),r.dt(10,5,100,5,1),r.dt(10,5,P.Ci,5,4),text="HEALTH",r.text(text,10,12,1,1,"left","top",1,22),r.dt(10,18,100,5,1),r.dt(10,18,P.mi,5,11),text="GREMLIN MANA",r.text(text,10,25,1,1,"left","top",1,22),debugText=""+P.Ci.toFixed(2)+`\nGB: ${P.mi}\nAP: `+P.sumCompleted,r.text(debugText,P.x-view.x,P.y-view.y-28,1,1,"center","top",1,22),debugText="LEVEL: "+currentFloor,r.text(debugText,10,260,1,1,"left","top",1,22),debugText=""+P.ji(),r.text(debugText,449,25,1,1,"center","top",2,22),P.Ri.forEach((s,h)=>{var e=P.ji()<13?0:t/900,a=0<e?22:4;0<e&&entitiesArray.push(new z(449+i(-5,5),25,i(-.05,.05),i(-.1,-.3),{color:[10,11,12,13,14,15],life:30})),r.ht(450,30,15+2*s,s,s%2==0?e:-e+l(h*(360/13)),a,a)}),13!=currentFloor&&N(!0),r.Pt();break;case 2:r.clear(64,r.SCREEN),U(entitiesArray),text="SIX AND SEVEN",r.text(text,240,100,4,1,"center","top",4,22),text="CLICK TO START",r.text(text,240,125,1,1,"center","top",1,22),gamepads=navigator.getGamepads(),text=gamepads[0]?"GAMEPAD CONNECTED":"THIS GAME SUPPORTS GAMEPADS, NOT DETECTED",r.text(text,240,150,1,1,"center","top",1,22),text="WASD OR ZQSD TO MOVE, MOUSE TO AIM AND SHOOT\nRIGHT CLICK TO BOMB GREMLINS\nCOMPLETE ALTARS TO PROGRESS",r.text(text,240,170,1,2,"center","top",1,22),r.Pt()}w.update(),x(entitiesArray),x(gremlinsArray),x(bulletsArray),requestAnimationFrame(m)}function N(t=!1){var i;r.B=r.PAGE3,r.t=r.SCREEN,t?(t=P.x/tileSize-720/tileSize,i=P.y/tileSize-720/tileSize,r.Mt(t,i,1440/tileSize,1440/tileSize,380,170)):(r.Mt(0,0,480,270,0,0),r.dt(P.x/tileSize-1,P.y/tileSize-1,2,2,22),r.dt(portalLocation.x-1,portalLocation.y-1,3,3,7))}function U(i){for(let t=0;i.length>t;t++){var s=i[t];a(s,tileSize)&&s.Mi(r,view)}}document.body.style="margin:0; background-color:black; overflow:hidden",window.screenWidth=480,window.screenHeight=270,(new Image).src="data:image/webp;base64,UklGRuwBAABXRUJQVlA4TOABAAAvP8ADAP/hOABAo3rZriNPXc21mq8BGsH8xtVaw5EEAISytu3dbPPa9IO+23TtAebZrpNzHAAAoZxt276MFRq2ifq5frab//j//wmcRHM08cf6CC84ZIG9Pw0AgRvrxUp+9pqowbgdCb963C3kqYYecUJ+BQzvLrxyRD6HjMIWjlXs0B5OqqT9EjZ/mo5Tt84BEE5QzKEjhDWMqxBdiWzwg5HsL/rasgYTXEnBGdyqua0L+QWaBKr1ZWSeklUC/GPS+mGen53Vr8OhRWzbrOxE/jhgjwUsbDgzFxE15gB/t2ni2J/a9U6KbhsgNpKkSNqtOWaG5/9jZib/zfrt6mUDIvrPwG3bOI7U3ZuB/cLGdDZf9PrX2/3xHAzH5vX3+/NmfX9dDvtdNpmY5JfHz3azXilmUrnt6txpNWrlUan63v04rTeFtA2khOuVNURbC4KdCuRYIJNOpkSPBCA0WQCEmJxC+Pf1MkYgYYOZz8ckU2cpDmICEGqvJACBpGA6nc5mxjgqKjtSU0ySSEynL1XNjNOOKnQJrlOkEi4k4TIuFQwAir9JwgP4G52ox1ZjqQnew/KsoaP7qEZ+erg0JX1F1aVefsJHAUP3UVM/8T4IPz7+S/gHuqJO0FtCWOLTwwI=";{const t=new Image;t.src="data:image/webp;base64,UklGRuwBAABXRUJQVlA4TOABAAAvP8ADAP/hOABAo3rZriNPXc21mq8BGsH8xtVaw5EEAISytu3dbPPa9IO+23TtAebZrpNzHAAAoZxt276MFRq2ifq5frab//j//wmcRHM08cf6CC84ZIG9Pw0AgRvrxUp+9pqowbgdCb963C3kqYYecUJ+BQzvLrxyRD6HjMIWjlXs0B5OqqT9EjZ/mo5Tt84BEE5QzKEjhDWMqxBdiWzwg5HsL/rasgYTXEnBGdyqua0L+QWaBKr1ZWSeklUC/GPS+mGen53Vr8OhRWzbrOxE/jhgjwUsbDgzFxE15gB/t2ni2J/a9U6KbhsgNpKkSNqtOWaG5/9jZib/zfrt6mUDIvrPwG3bOI7U3ZuB/cLGdDZf9PrX2/3xHAzH5vX3+/NmfX9dDvtdNpmY5JfHz3azXilmUrnt6txpNWrlUan63v04rTeFtA2khOuVNURbC4KdCuRYIJNOpkSPBCA0WQCEmJxC+Pf1MkYgYYOZz8ckU2cpDmICEGqvJACBpGA6nc5mxjgqKjtSU0ySSEynL1XNjNOOKnQJrlOkEi4k4TIuFQwAir9JwgP4G52ox1ZjqQnew/KsoaP7qEZ+erg0JX1F1aVefsJHAUP3UVM/8T4IPz7+S/gHuqJO0FtCWOLTwwI=",t.onload=()=>{(i=document.createElement("canvas")).width=64,i.height=32,(i=i.getContext("2d")).drawImage(t,0,0);var i=new Uint32Array(i.getImageData(0,0,64,32).data.buffer),i=new u(480,270,i,10);window.r=i,window.LIGHTS=i.PAGE7,document.getElementById("game").appendChild(i.c),document.getElementById("game").style.background="none",(gamebox=document.getElementById("game")).appendChild(r.c),createEventListeners(),m(),c(i.c,480,270)}}window.t=0,audioMaster=null,text="",gamepads=[],window.mouse={x:0,y:0,Zi:!(window.pauseGame=()=>{paused=!paused}),e:null},window.rh=null,sounds={},soundsReady=0,totalSounds=4,audioTxt="",debugText="",TITLESCREEN=2,GAMESCREEN=1,gamestate=0,started=!1,entitiesArray=[],gremlinsArray=[],bulletsArray=[],portalLocation={x:0,y:0},gameInitialized=!1,generatingNewFloor=!1,floorCompleteTime=0,currentFloor=1,gremlinSpawnRate=2500,window.ms=()=>{P.Ri=[],gremlinsArray=[],gremlinSpawnRate=2e3,generatingNewFloor=!0,setTimeout(()=>{var t,i;13==++currentFloor?(i=(floors[0]=thirteenthFloor).vs[0],rooms=thirteenthFloor.vs,t=i.y+i.height/2,P.x=(i.x+i.width/2)*tileSize,P.y=t*tileSize,portalLocation={x:i._i.x,y:i._i.y},gremlinsArray=[]):(entitiesArray=[],floors[0]=new F(480,270,40,25,10),i=(t=(rooms=floors[floors.length-1].vs)[Math.floor(Math.random()*rooms.length)]).y+t.height/2,P.x=(t.x+t.width/2)*tileSize,P.y=i*tileSize),generatingNewFloor=!1},500)},startGameMusic=n(()=>{d(sounds.gamemusic,1,0,.5,!0)}),floors=[],thirteenthFloor=null,rooms=[],map=null,fps=0,lastFrameTime=0,frameCount=0,paused=!1,gameOver=!1,tileSize=16,view={x:0,y:0,target:{x:0,y:0},w:480,Kt:270},createEventListeners=()=>{window.addEventListener("keyup",t=>{w.ti(t)},!1),window.addEventListener("keydown",t=>{w._t(t)},!1),window.addEventListener("blur",()=>{paused=!0},!1),window.addEventListener("focus",()=>{paused=!1},!1),window.addEventListener("resize",()=>{c(r.c,480,270)},!1)},window.addEventListener("gamepadconnected",t=>{s(t,!0)},!1),window.addEventListener("gamepaddisconnected",t=>{s(t,!1)},!1),onmousemove=t=>{var i=r.c.getBoundingClientRect(),s=r.c.width/i.width,h=r.c.height/i.height;mouse={x:(t.clientX-i.left)*s,y:(t.clientY-i.top)*h}},oncontextmenu=t=>(P.Qi(t),t.preventDefault(),!1),onclick=t=>{switch(r.c.getBoundingClientRect(),r,r,paused=!1,gamestate){case 0:0!=soundsReady||started||(started=!0,setTimeout(()=>{audioCtx=new AudioContext,audioMaster=audioCtx.createGain(),(compressor=audioCtx.createDynamicsCompressor()).threshold.setValueAtTime(-60,audioCtx.currentTime),compressor.knee.setValueAtTime(40,audioCtx.currentTime),compressor.ratio.setValueAtTime(12,audioCtx.currentTime),compressor.attack.setValueAtTime(0,audioCtx.currentTime),compressor.release.setValueAtTime(.25,audioCtx.currentTime),audioMaster.connect(compressor),compressor.connect(audioCtx.destination),sndData=[{name:"potBreak",data:p},{name:"torch",data:M},{name:"spawn",data:v},{name:"gremlinHurt",data:A},{name:"playerHurt",data:E},{name:"pickup",data:S},{name:"gamemusic",data:C},{name:"playerDeath",data:O},{name:"playerAttack",data:T},{name:"altarDone",data:R},{name:"gremlinAttack",data:I}],totalSounds=sndData.length,soundsReady=0,sndData.forEach(i=>{var s=new g,h=(s.init(i.data),!1);setInterval(()=>{var t;!h&&(h=1==s.Lt(),soundsReady+=h,h)&&(t=s.Dt().buffer,audioCtx.decodeAudioData(t,t=>{sounds[i.name]=t}))},0)}),y()},100));break;case 1:t.preventDefault(),P.Qi(t);break;case 2:gamestate=1}},onmousedown=()=>{mouse.Zi=!0},onmouseup=()=>{mouse.Zi=!1}})()</script></head>