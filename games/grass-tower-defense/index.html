<!DOCTYPE html> <html lang="ko"> <head> <meta charset="UTF-8" /> <title>Grass Tower Defense</title> <style>body{margin:0;background:#f6f8fa;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;display:flex;flex-direction:column;align-items:center;min-height:100vh}#loginScreen{width:100%;max-width:300px;margin:100px auto;text-align:center}#loginScreen input{width:100%;padding:10px;margin:12px 0;font-size:1rem}#loginScreen button{padding:10px 20px;font-size:1rem;background-color:#2ea44f;color:#fff;border:0;border-radius:6px;cursor:pointer}#loginScreen button:hover{background-color:#24943c}#container{max-width:1280px;width:100%;margin-top:40px;background:#fff;border-radius:12px;border:1px solid #e1e4e8;box-shadow:0 0 12px #00000012;padding:24px;display:none}#header{display:flex;align-items:center;margin-bottom:20px}#avatar{width:60px;height:60px;border-radius:50%;margin-right:20px}#nickname{font-weight:700;font-size:1.5rem;color:#24292e}#activity-label{font-weight:600;font-size:1.1rem;margin-bottom:16px;color:#24292e;display:flex;align-items:center;gap:8px}#activity-label svg{width:24px;height:24px;fill:#24292e}#commitBarContainer{width:100%;background:#dce4e8;border-radius:8px;height:32px;margin-bottom:18px}#commitBar{background:#2ea44f;width:0;height:32px;border-radius:8px;text-align:center;color:#fff;line-height:32px;font-weight:700}#activityOverview{display:flex;gap:24px;background:#fafbfc;border:1px solid #e1e4e8;border-radius:12px;padding:24px;align-items:center;margin-bottom:36px;position:relative}#dev-image{position:relative}#dev-image img{width:140px;border-radius:20px;filter:drop-shadow(0 2px 6px #00000040);animation:subtleMove 3s ease-in-out infinite;user-select:none}@keyframes subtleMove{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}@keyframes steam{0%,100%{opacity:1;transform:translateY(0)}50%{opacity:.6;transform:translateY(-6px)}}#controls{flex-grow:1;display:flex;flex-direction:column;gap:18px;position:relative}#controls button{background:#2ea44f;border:0;padding:10px 18px;border-radius:7px;color:#fff;font-weight:600;cursor:pointer;width:fit-content;transition:background-color .2s ease}#controls button:hover{background:#24943c}#info{font-size:1.1rem;font-weight:600;color:#2c2e35}#statusBars label{font-size:.9rem;color:#555;margin-top:10px;font-weight:500}progress{width:100%;height:14px;margin-top:4px;border-radius:8px;overflow:hidden;-webkit-appearance:none;appearance:none}progress::-webkit-progress-bar{background-color:#e0e0e0;border-radius:8px}progress::-webkit-progress-value{background-color:#2ea44f;border-radius:8px}#dayClock{position:absolute;top:0;right:0;width:80px;height:80px;border:1.4px solid #2ea44f;border-radius:50%;background:#fff}#gameCanvas{border-radius:12px;background:#fff;box-shadow:0 0 12px #0000001a;display:block;margin:0 auto 36px;width:100%;max-width:1280px;height:220px;user-select:none}@media(max-width:720px){#activityOverview{flex-direction:column;align-items:center}#dev-image img{width:120px}#controls{width:100%}}progress#levelStat::-webkit-progress-value{background-color:#28a745}progress#expStat::-webkit-progress-value{background-color:#218838}progress#monsterStat::-webkit-progress-value{background-color:#17a2b8}.pixel-vm{width:260px;background:#0d192769;border:4px solid #767778;border-radius:12px;box-shadow:3px 3px 0 #87a7c7;padding:14px 16px 16px;font-family:'Courier New',monospace}.slot{display:flex;align-items:center;justify-content:center;padding:6px 2px;margin:8px 0;border-radius:10px;min-height:58px;width:100%;border:2px solid #767778;box-shadow:1px 1.5px 0 #87a7c7;background:0;transition:background .15s,box-shadow .15s;font-size:1rem}.slot-inner{display:flex;flex-direction:row;align-items:center;justify-content:space-between}.slot-inner>.slot-info-col{display:flex;flex-direction:column;width:calc(100% - 50px)}.coffee{background:#9c7a6b;color:#fff}.energy{background:#0b0054;color:#fff}.choco{background:#6d4c2f;color:#fff}.slot:active,.slot:focus,.slot:hover{outline:2px solid #fff83d;box-shadow:0 0 0 3px #fffac233;filter:brightness(1.13)}.buttons{display:flex;justify-content:flex-start;gap:7px;margin:11px 0 3px} .price{font-weight:700;color:#fde293}  .effect{font-weight:500;color:#a9e34b}  .slot{flex-direction:column;padding:8px 10px 14px}  .icon-pixel{width:50px;height:50px;min-width:48px;min-height:48px;image-rendering:pixelated;border-radius:8px;margin:0 2px}  .slot-info-col{display:flex;flex-direction:column;justify-content:center;gap:0;min-width:0}  .slot-label{font-weight:700;font-size:1.1em;margin-bottom:2px;color:#fff}  .price,.effect{font-size:.9em;display:inline-block;width:auto}  .price-effect-wrapper{gap:12px}  #gameIntro h3,#gameIntro h4{margin-bottom:8px;font-weight:700}  #gameIntro ul{list-style-type:disc;padding-left:20px;margin:0}  #loginScreen button{margin-top:12px}  #commitColors span{margin-top:4px;color:#555}  #avatar img{width:48px;height:48px;border-radius:50%;border:2px solid #e1e4e8;box-shadow:0 0 4px #0000001a;object-fit:cover;display:block}  button{background-color:#2ea44f;border:2px solid #238636;color:#fff;font-weight:700;font-size:1rem;padding:8px 18px;border-radius:8px;cursor:pointer;box-shadow:0 5px #1f792e;transition:background-color .2s,box-shadow .1s;user-select:none}  button:hover{background-color:#36c95c}  button:active{box-shadow:0 2px #1f792e;transform:translateY(3px)}  button:disabled{background-color:#94d3a2;border-color:#7bb174;cursor:not-allowed;box-shadow:none;color:#e6f4ea}</style> <script src="asset/ZzFXMicro.js"></script> <script src="asset/zzfxm.min.js"></script> </head> <body> <div id="loginScreen"> <img id="catLogo" alt="Cat Logo" style="width:48px;height:48px;border-radius:50%" src=""> <h2>Grass Tower Defense</h2> <input type="text" id="gitNickname" placeholder="Enter your GitHub username" title="username"/> <button id="loginBtn">Start Game</button> <p style="margin-top:12px;font-size:.9rem;color:#555"> New to this game? <a href="#" id="gameIntroLink" style="color:#2ea44f;text-decoration:none;cursor:pointer">Learn more</a> </p> <p style="margin-top:12px;font-size:.9rem;color:#555"> Sound: <a href="#" id="muteBtnLogin" style="color:#2ea44f;text-decoration:none;cursor:pointer">BGM Mute </a> / <a href="#" id="effectMuteBtnLogin" style="color:#2ea44f;text-decoration:none;cursor:pointer"> Effect Mute</a> </p> </div> <div id="gameIntroModal" style="display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,0.6);justify-content:center;align-items:center;z-index:1000"> <div style="background:white;padding:24px;border-radius:8px;max-width:450px;max-height:80vh;overflow-y:auto;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif"> <h2>Game Introduction</h2> <p>The game is about a developer who tries every day to stop enemies (black cats inspired by GitHub's mascot Mona) from overwhelming the field.</p> <h3>How to play</h3> <ul> <li>Enter your GitHub username and start playing. (it doesn't matter if it doesn't exist)</li> <li>Click “Work” to gain contribution points and build towers.</li> <li>If you have caffeinee, your work will proceed automatically, though at a slower pace.</li> <li>Enemies are black cats inspired by Mona, GitHub’s mascot.</li> <li>If too many black cats (30) overwhelm the field, it’s game over.</li> <li>You cannot plant grass for previous days.</li> </ul> <div id="commitColors" style="margin-top:16px;font-family:monospace;font-size:14px"> <div style="display:flex;gap:16px;align-items:center"> <div style="display:flex;flex-direction:column;align-items:center"> <div style="width:20px;height:20px;background:#ebedf0;border:1px solid #ccc"></div> <span>0 commits</span> </div> <div style="display:flex;flex-direction:column;align-items:center"> <div style="width:20px;height:20px;background:#c6e48b;border:1px solid #ccc"></div> <span>1-3 commits</span> </div> <div style="display:flex;flex-direction:column;align-items:center"> <div style="width:20px;height:20px;background:#7bc96f;border:1px solid #ccc"></div> <span>4-6 commits</span> </div> <div style="display:flex;flex-direction:column;align-items:center"> <div style="width:20px;height:20px;background:#239a3b;border:1px solid #ccc"></div> <span>7-9 commits</span> </div> <div style="display:flex;flex-direction:column;align-items:center"> <div style="width:20px;height:20px;background:#196127;border:1px solid #ccc"></div> <span>10+ commits</span> </div> </div> </div> <button id="closeGameIntro" style="margin-top:16px;background:#2ea44f;color:white;border:0;padding:8px 12px;border-radius:5px;cursor:pointer">Close</button> </div> </div> <div id="container"> <div id="header"> <div id="avatar"> <img id="profileImg" src="" alt="profile Img" /></div> <div id="nickname">black-kitty-dev</div> </div> <canvas id="gameCanvas" width="1280" height="220"></canvas> <div id="activity-label"> <span>Contribution Activity</span> <svg viewBox="0 0 24 24" aria-hidden="true"><path d="M20 5H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 11H4V8h16v8zM7 10h2v2H7v-2zm3 0h2v2h-2v-2zM5 14h14v2H5v-2z"/></svg> </div> <div id="commitBarContainer"> <div id="commitBar">0%</div> </div> <div id="activityOverview"> <div id="dev-image"> <div id="avatar-container" style="width:128px;height:128px;overflow:hidden"> <canvas id="avatar-canvas" width="128" height="128"></canvas> </div> <div id="stats-bar" style="justify-content:center;gap:30px;margin-bottom:16px;user-select:none"> <div class="stat-cell" style="text-align:center"> <div> <span style="font-size:12px;font-weight:700;color:#57606a">Level</span> <span id="levelVal" style="font-size:14px;font-weight:600;color:#1b1f23">1</span> </div> <progress id="levelStat" value="1" max="100" style="width:120px;height:12px;border-radius:6px"></progress> </div> <div class="stat-cell" style="text-align:center"> <div> <span style="font-size:12px;font-weight:700;color:#57606a">Exp</span> <span id="expVal" style="font-size:14px;font-weight:600;color:#1b1f23">0/10</span> </div> <progress id="expStat" value="0" max="20" style="width:120px;height:12px;border-radius:6px"></progress> </div> <div class="stat-cell" style="text-align:center"> <div> <span style="font-size:12px;font-weight:700;color:#57606a">Black Cat</span> <span id="monsterVal" style="font-size:14px;font-weight:600;color:#1b1f23">3/10</span> </div> <progress id="monsterStat" value="1" max="30" style="width:120px;height:12px;border-radius:6px"></progress> </div> </div> </div> <div id="controls"> <button id="workBtn">Work +<span id="workRateCount">0</span>%</button> <div id="info"> COIN: <span id="coinCount">0</span> </div> <canvas id="dayClock" width="80" height="80"></canvas> <div class="stat-cell" style="text-align:center"> <div style="font-size:16px;font-weight:700;color:#57606a;text-align:right">Day</div> <div id="dateVal" style="font-size:20px;font-weight:600;color:#1b1f23;text-align:right">1</div> </div> <div id="statusBars"> <label for="fatigue">HP : <span id="hpText"></span></label> <progress id="fatigue" value="30" max="100"></progress> <label for="caffeinee">caffeinee : <span id="caffeineeText"></span></label> <progress id="caffeinee" value="70" max="100"></progress> </div> </div> <div class="pixel-vm"> <button class="slot choco" id="vmBuyChocoBar"> <div class="slot-inner"> <div class="slot-info-col"> <span class="slot-label">CHOCOLATE BAR</span> <div class="price-effect-wrapper"> <div class="price">150 Coin</div> <div class="effect">Hp +30</div> </div> </div> <canvas class="icon-pixel" data-sprite-index="2" width="50" height="50"></canvas> </div> </button> <button class="slot coffee" id="vmBuyCoffee"> <div class="slot-inner"> <div class="slot-info-col"> <div class="slot-label">COFFEE</div> <div class="price-effect-wrapper"> <div class="price">50 Coin</div> <div class="effect">caffeinee +50</div> </div> </div> <canvas class="icon-pixel" data-sprite-index="1" width="50" height="50"></canvas> </div> </button> <button class="slot energy" id="vmBuyEnergy"> <div class="slot-inner"> <div class="slot-info-col"> <span class="slot-label">ENERGY DRINK</span> <div class="price-effect-wrapper"> <div class="price">80 Coin</div> <div class="effect">caffeinee +90</div> </div> </div> <canvas class="icon-pixel" data-sprite-index="0" width="50" height="50"></canvas> </div> </button> <div class="buttons"> <button id="muteBtn" style="width:100px;margin-left:20px;padding:6px 12px;font-size:.9rem;cursor:pointer">BGM<br>Mute</button> <button id="effectMuteBtn" style="width:100px;margin-left:20px;padding:6px 12px;font-size:.9rem;cursor:pointer">Effect<br>Mute</button> </div> </div> </div> </div><script>(()=>{let e=[[[1.3,0,70,,.03,.15,2,1.7,,,,,.03,3.8,-.05,,.25],[1,0,30,,,.2,3,4,,,3,.9,.04],[.9,0,740,,.05,.1,2,.35,-.1,-.18,9,.02,,.1,.12,,.06],[1.6,0,12,,.02,.08,2,2.2,,,,,.02,2.5,.1,,.2]],[[[0,-1,13,16,18,20,18,16,13,,,,,,,,,,,,,,,,,,,13,16,18,20,18,16,13,20,22,25,22,20,18,16,13,,,13,16,18,16,13,,],[2,-1,13,0,11,,,,,,,,,,13,,25,25,11,11,23,11,,11,23,11,11,11,23,22,18,,30,,18,18,30,18,,18,30,18,18,18,30,22,13,,25,,13,13,25,13,,13,25,13,13,13,25,,],[3,0,13,,,,,13,,,,,,,,,,,,,,,,,,,,13,,,,,13,,13,13,,,,,13,,13,,,,,13,,],[2,0,,,,20,,,,,,25,,,,,,20,25,,,,18,20,,,,25,,,,]],[[0,-1,20,22,25,22,20,18,16,18,20,22,,,,,,,,,,,,,,,,,,,20,18,16,13,18,20,22,20,18,16,13,13,16,18,20,18,16,13,,],[2,-1,13,0,11,,,,,,,,,,13,,25,25,11,11,23,11,,11,23,11,11,11,23,22,18,,30,,18,18,30,18,,18,30,18,18,18,30,22,13,,25,,13,13,25,13,,13,25,13,13,13,25,,],[3,0,13,,,,,13,13,,13,,,,,13,13,,13,,,,,13,13,,],[2,0,,,,25,,,,20,,,,,,,,,,,,,,,,,,,,,,25,,,,20,,18,,,22,,,,,,,,,,,,,,,,,,,,20,,,25,,,]]],[0,0,1,1,0,1,0,1]],t=null,i=!1,n=!1;function a(){t&&t.stop(),(t=zzfxP(...zzfxM(...e))).loop=!0,t.volume=n?0:1}let l=document.getElementById("muteBtn"),s=document.getElementById("muteBtnLogin"),_=document.getElementById("effectMuteBtn"),o=document.getElementById("effectMuteBtnLogin");function $(){n=!n,l.innerHTML=n?"BGM<br>Unmute":"BGM<br>Mute",s.textContent=n?"BGM Unmute":"BGM Mute",n?t&&t.stop():a()}function h(){i=!i,_.innerHTML=i?"Effect<br>Unmute":"Effect<br>Mute",o.textContent=i?"Effect Unmute":"Effect Mute"}l.addEventListener("click",$),s.addEventListener("click",$),_.addEventListener("click",h),o.addEventListener("click",h);let r=new Image;r.src="asset/item_border.png";let c=document.querySelectorAll(".icon-pixel"),d=document.getElementById("loginScreen"),f=document.getElementById("loginBtn"),m=document.getElementById("gitNickname"),g=document.getElementById("container"),y=document.getElementById("nickname"),p=document.getElementById("profileImg"),u=document.getElementById("coinCount"),x=document.getElementById("workRateCount"),E=document.getElementById("fatigue"),k=document.getElementById("hpText"),B=document.getElementById("caffeineeText"),I=document.getElementById("caffeinee"),w=document.getElementById("dayClock"),v=w.getContext("2d"),b=document.getElementById("gameCanvas"),C=b.getContext("2d"),T=(b.width-1162)/2,P=(b.height-150)/2,M=!1,S=100,H=3,D=1,L=1,R=0,W=10,A={coffee:0,notebook:0,caffeinee:0,hp:100,maxHp:100,healHp:1};E.value=A.hp,E.max=A.maxHp,k.innerText=A.hp,I.value=A.caffeinee,B.innerText=A.caffeinee;let F,G,U=Array(371).fill(0),V=Array(371).fill(!0),z=0,O=1,X=0,Y=0,j=0,q=!1,N=!1,J=new Image;J.src="asset/avatar.png";let K=document.getElementById("avatar-canvas").getContext("2d"),Q=!1,Z=[{id:"healBoost",title:"Speed up your physical recovery",description:"HP recovery increased by 1",apply(){A.healHp+=1}},{id:"manualBoost",title:"Increasing manual workload",description:"Increase the amount of increase when clicking the Work button",apply(){O+=1}},{id:"autoBoost",title:"Auto workload increase (caffeine)",description:"Auto workload increase (caffeine)",apply(){X+=.5}},{id:"maxHpBoost",title:"Maximum HP growth",description:"Up to Hp+10",apply(){A.maxHp+=10,A.hp=Math.min(A.hp+10,A.maxHp)}}];function ee(){let e;u.textContent=S,x.textContent=O,E.value=A.hp,E.max=A.maxHp,k.innerText=`${A.hp}/${A.maxHp}`,I.value=A.caffeinee,B.innerText=A.caffeinee,document.getElementById("levelStat").value=L,document.getElementById("levelVal").textContent=L+"",document.getElementById("expStat").value=R,document.getElementById("expStat").max=W,document.getElementById("expVal").textContent=`${R}/${W}`,document.getElementById("dateVal").textContent=D,e=eo.length,document.getElementById("monsterStat").value=e,document.getElementById("monsterStat").max=eh,document.getElementById("monsterVal").textContent=`${e}/${eh}`}function et(e){for(z+=e;z>=100;)z-=100,ey();ei()}function ei(){let e=document.getElementById("commitBar"),t=Math.min(100,Math.floor(z));e.style.width=t+"%",e.textContent=t+"%"}f.addEventListener("click",()=>{let e=m.value.trim();e?(p.src=`https://github.com/${e}.png?size=48`,p.onerror=()=>{p.src=e6},y.textContent=e,d.style.display="none",g.style.display="block",M=!0,clearInterval(F),ee(),eb(),ev(0),e3(),c.forEach(e=>{let t=e.getContext("2d"),i=parseInt(e.dataset.spriteIndex);t.clearRect(0,0,50,50),t.imageSmoothingEnabled=!1,t.drawImage(r,32*i,0,32,32,0,0,50,50)}),M&&(window.nextDayInterval&&clearInterval(window.nextDayInterval),window.nextDayInterval=setInterval(e1,e7),requestAnimationFrame(e2))):alert("Please enter your nickname.")});let en=[];function ea(e){let t=T+22*Math.floor(e/7)+9,i=P+22*(e%7)+9;return en.find(e=>1>Math.abs(e.x-t)&&1>Math.abs(e.y-i))}class el{constructor(e,t,i){this.x=e,this.y=t,this.level=i,this.range=120+10*(i-1),this.damage=5+3*i,this.cooldown=0,this.cooldownMax=30,this.isAttacking=!1,this.attackEffectFrame=0,this.effectMaxFrames=6,this.effectTargetPos=null,this.selected=!1}update(){if(this.cooldown>0)return this.cooldown--,this.attackEffectFrame++,void(this.attackEffectFrame>this.effectMaxFrames&&(this.attackEffectFrame=0,this.isAttacking=!1,this.effectTargetPos=null));let e=eo.filter(e=>!e.isDead&&Math.hypot(e.x-this.x,e.y-this.y)<=this.range);if(0===e.length)return;e.sort((e,t)=>Math.hypot(e.x-this.x,e.y-this.y)-Math.hypot(t.x-this.x,t.y-this.y));let t=e[0];t.takeDamage(this.damage),this.cooldown=this.cooldownMax,this.isAttacking=!0,i||zzfx(1,.05,120,.01,.07,.1,1,3.4,8,40,0,0,0,0,0,0,0,.97,.09,0,-1415),this.attackEffectFrame=0,this.effectTargetPos={x:t.x,y:t.y}}draw(){C.beginPath();let e=["#69c739","#389431","#0a641d","#196127"],t=Math.min(this.level-1,e.length-1);C.fillStyle=e[t]||"#eee",C.fillRect(this.x-9,this.y-9,18,18),this.isAttacking?(C.strokeStyle=["#88cc55","#55aa33","#339900","#227700"][t]||"#88cc55",C.lineWidth=3+this.level,C.shadowColor="rgba(255,255,153,0.7)",C.shadowBlur=8,C.strokeRect(this.x-9,this.y-9,18,18),C.shadowBlur=0,this.effectTargetPos&&(C.beginPath(),C.lineWidth=C.lineWidth+1,C.moveTo(this.x,this.y),C.lineTo(this.effectTargetPos.x,this.effectTargetPos.y),C.stroke())):(C.lineWidth=1,C.strokeStyle="#bccbb9",C.strokeRect(this.x-9,this.y-9,18,18)),this.selected&&(C.beginPath(),C.strokeStyle="rgba(40,150,40,0.5)",C.lineWidth=3,C.arc(this.x,this.y,this.range,0,2*Math.PI),C.stroke())}updateProperties(e){this.level=e,this.damage=5+3*e,this.range=120+10*(e-1),this.cooldown=0,this.update()}}let es=new Image;es.src="asset/cat.png";class e_{constructor(){this.left=T,this.top=P,this.right=T+1162,this.bottom=P+150,this.speed=e0,this.side=0,this.x=this.left,this.y=this.top,this.hp=ed,this.radius=ef,this.scale=this.radius/10,this.frameCount=4,this.frameIndex=0,this.frameDelay=10,this.frameTicker=0,this.width=32,this.height=32,this.isDead=!1}update(){if(!this.isDead)switch(this.frameTicker++,this.frameTicker>=this.frameDelay&&(this.frameTicker=0,this.frameIndex=(this.frameIndex+1)%this.frameCount),this.side){case 0:this.x+=this.speed,this.x>=this.right&&(this.x=this.right,this.side=1);break;case 1:this.y+=this.speed,this.y>=this.bottom&&(this.y=this.bottom,this.side=2);break;case 2:this.x-=this.speed,this.x<=this.left&&(this.x=this.left,this.side=3);break;case 3:this.y-=this.speed,this.y<=this.top&&(this.y=this.top,this.side=0)}}draw(){if(this.isDead)return;let e=this.width*this.scale,t=this.height*this.scale;C.drawImage(es,this.frameIndex*this.width,0,this.width,this.height,this.x-e/2,this.y-t/2,e,t)}takeDamage(e){this.hp-=e,this.hp<=0&&!this.isDead&&(this.isDead=!0,S+=10,i||zzfx(...[,,925,.04,.3,.6,1,.3,,6.27,-184,.09,.17]),++R>=W&&(R=0,L++,function(){let e=document.createElement("div");e.style="position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.7);z-index:999;";let t=document.createElement("div");t.style="background:#fff;padding:20px;border-radius:10px;display:flex;gap:16px;";let i=[];for(;i.length<3;){let n=Z[Math.floor(Math.random()*Z.length)];i.includes(n)||i.push(n)}i.forEach(i=>{let n=document.createElement("div");n.style="cursor:pointer;padding:12px;border:1px solid #ccc;border-radius:8px;width:130px;text-align:center;",n.innerHTML=`<h3>${i.title}</h3><p style="font-size:12px">${i.description}</p>`,n.onclick=()=>{i.apply(),L++,ee(),document.body.removeChild(e)},t.appendChild(n)}),e.appendChild(t),document.body.appendChild(e)}(),W+=5),ee())}}let eo=[];function e$(){eo.forEach(e=>{e.update(),e.draw()}),(eo=eo.filter(e=>!e.isDead)).length>=eh&&(alert("Too many black cats came! Game over!"),S=0,D=1,eo=[],en=[],U=Array(371).fill(0),V=Array(371).fill(!0),Y=0,j=0,z=0,O=1,X=0,A.hp=100,A.caffeinee=0,ed=30,ef=10,e0=2,ee(),M=!1,g.style.display="none",d.style.display="block")}let eh=30,er=0,ec=1,ed=30,ef=10,e0=2,em=2,eg=2;function ey(){var e;j++,z=0,ei(),Y>=U.length&&(Y=0);let t=(e=j)>=10?4:e>=5?3:e>=3?2:e>=1?1:0;if(0===U[Y]){U[Y]=t;let i=Math.floor(Y/7),n=P+22*(Y%7)+9;ea(Y)||en.push(new el(T+22*i+9,n,t))}else U[Y]<t&&(U[Y]=t,ea(Y)?.updateProperties(t));eI()}function e1(){D++,j=0,S+=Math.ceil(1.5*H),D%7==1&&(ed=Math.floor(ed*em),ef+=eg),function(){for(let e=0;e<U.length;e++)U[e]>0&&(V[e]=!1)}(),er=0,ee(),function(e=1,t=1500){let i=0,n=setInterval(()=>{if(i>=e||eo.length>=eh)return void clearInterval(n);let t=function(){let e,t=0;do{let i=T+1162*Math.random(),n=P+150*Math.random();if(!eo.some(e=>40>Math.hypot(e.x-i,e.y-n))){e={x:i,y:n};break}t++}while(t<20);return e||{x:T,y:P}}(),a=new e_;a.x=t.x,a.y=t.y,eo.push(a),i++},t)}(ec,1e3),Y=(Y+1)%U.length,ec=Math.min(ec+1,5)}let ep=0;function eu(){ep=A.hp<=0||N?3:ek()?2:(ep+1)%2}function ex(){K.clearRect(0,0,128,128),K.imageSmoothingEnabled=!1,K.drawImage(J,64*ep,0,64,64,0,0,128,128)}function e3(){F=setInterval(()=>{ek()||N||(eu(),ex())},500)}function eE(){clearInterval(F),clearTimeout(G),q=!0,eu(),ex(),G=setTimeout(()=>{q=!1,eu(),ex(),e3()},2e3)}function ek(){return q}let e6="",eB=new Image;function eI(){C.clearRect(0,0,b.width,b.height),function(){for(let e=0;e<53;e++)for(let t=0;t<7;t++){let i=7*e+t,n=U[i],a=T+22*e,l=P+22*t,s=["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"];C.fillStyle=s[n],C.shadowColor="rgba(0,0,0,0.12)",C.shadowBlur=2,C.shadowOffsetX=0,C.shadowOffsetY=1,C.fillRect(a,l,18,18),C.shadowColor="transparent",C.strokeStyle="#bcf2a4",C.lineWidth=1,C.strokeRect(a,l,18,18),i===Y&&(C.strokeStyle="#2ea44f",C.lineWidth=4,C.shadowColor="#2ea44f",C.shadowBlur=8,C.strokeRect(a-2,l-2,22,22),C.shadowColor="transparent")}}(),en.forEach(e=>e.update()),e$(),en.forEach(e=>e.draw())}eB.src="asset/cat.png",eB.onload=()=>{e6=function(e=0,t=32,i=32){let n=document.createElement("canvas");return n.width=t,n.height=i,n.getContext("2d").drawImage(eB,e*t,0,t,i,0,0,t,i),n.toDataURL()}(0,32,32),p.src=e6,document.getElementById("catLogo").src=e6},b.addEventListener("click",e=>{let t=b.getBoundingClientRect(),i=e.clientX-t.left,n=e.clientY-t.top,a=null;for(let l of en)if(i>=l.x-9&&i<=l.x+9&&n>=l.y-9&&n<=l.y+9){a=l;break}en.forEach(e=>e.selected=!1),a&&(a.selected=!0)});let ew=Date.now();function ev(e){A.caffeinee=Math.min(A.caffeinee+e,100),Q=!0,X=1,ee(),window.caffeineeTimer&&clearInterval(window.caffeineeTimer),window.caffeineeTimer=setInterval(()=>{A.caffeinee>0&&(A.caffeinee--,ee()),A.caffeinee<=0&&(X=0,Q=!1,clearInterval(window.caffeineeTimer))},1e3)}function eb(){M&&(eI(),H=O+X,Q&&X>0&&et(.01*X)),requestAnimationFrame(eb)}document.getElementById("workBtn").onclick=()=>{!M||A.hp<=0||(et(O),ew=Date.now(),A.hp=Math.max(0,A.hp-1),N=!1,q=!1,i||zzfx(...[,,537,.02,.02,.22,1,1.59,-6.98,4.97]),ee())},setInterval(()=>{let e=Date.now();M&&e-ew>1e4&&A.hp<A.maxHp&&(A.hp+=A.healHp,N=!0,q=!1,ee())},1e3),document.getElementById("vmBuyCoffee").onclick=()=>{S>=50&&(S-=50,ev(50),ee(),i||zzfx(...[,,150,.2,.05,.2,2,1.5,2,2.5,,,,.5,.1,.05]),eE())},document.getElementById("vmBuyEnergy").onclick=()=>{S>=80&&(S-=80,ev(90),ee(),i||zzfx(...[,,300,.15,.05,.25,2,1.8,6,4.5,,,,1.5,.2,.07]),eE())},document.getElementById("vmBuyChocoBar").onclick=()=>{S>=150&&(S-=150,A.hp=Math.min(A.hp+30,A.maxHp),ee(),i||zzfx(...[,,90,.08,.01,.1,3.5,2.5,,,,,,.2,.3,.02,.12]),eE())};let e7=14e3;function e2(e){var t;e2.last||(e2.last=e);let i=e-e2.last,n,a;e2.last=e,(er+=i/e7)>1&&(er=1),t=er,n=w.width/2,v.clearRect(0,0,w.width,w.height),v.translate(n,n),v.fillStyle="#fff",v.beginPath(),v.arc(0,0,n-5,0,2*Math.PI),v.fill(),v.strokeStyle="#2ea44f",v.lineWidth=6,v.beginPath(),v.arc(0,0,n-7,0,2*Math.PI),v.stroke(),a=2*t*Math.PI-Math.PI/2,v.strokeStyle="#2ea44f",v.lineWidth=6,v.beginPath(),v.moveTo(0,0),v.lineTo(n*Math.cos(a),n*Math.sin(a)),v.stroke(),v.resetTransform(),requestAnimationFrame(e2)}document.getElementById("gameIntroLink").addEventListener("click",e=>{e.preventDefault(),document.getElementById("gameIntroModal").style.display="flex"}),document.getElementById("closeGameIntro").addEventListener("click",()=>{document.getElementById("gameIntroModal").style.display="none"}),a()})();</script></body></html>
