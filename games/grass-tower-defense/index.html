<!doctype html><title>Grass Tower Defense - js13kGames 2025</title><style>body{margin:0;background:#f6f8fa;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;display:flex;flex-direction:column;align-items:center;min-height:100vh}#loginScreen{width:100%;max-width:300px;margin:100px auto;text-align:center}#loginScreen input{width:100%;padding:10px;margin:12px 0;font-size:1rem}#loginScreen button{padding:10px 20px;font-size:1rem;background-color:#2ea44f;color:#fff;border:0;border-radius:6px;cursor:pointer}#loginScreen button:hover{background-color:#24943c}#container{max-width:1280px;width:100%;margin-top:40px;background:#fff;border-radius:12px;border:1px solid #e1e4e8;box-shadow:0 0 12px #00000012;padding:24px;display:none}#header{display:flex;align-items:center;margin-bottom:20px}#avatar{width:60px;height:60px;border-radius:50%;margin-right:20px}#nickname{font-weight:700;font-size:1.5rem;color:#24292e}#activity-label{font-weight:600;font-size:1.1rem;margin-bottom:16px;color:#24292e;display:flex;align-items:center;gap:8px}#activity-label svg{width:24px;height:24px;fill:#24292e}#commitBarContainer{width:100%;background:#dce4e8;border-radius:8px;height:32px;margin-bottom:18px}#commitBar{background:#2ea44f;width:0;height:32px;border-radius:8px;text-align:center;color:#fff;line-height:32px;font-weight:700}#activityOverview{display:flex;gap:24px;background:#fafbfc;border:1px solid #e1e4e8;border-radius:12px;padding:24px;align-items:center;margin-bottom:36px;position:relative}#dev-image{position:relative}#dev-image img{width:140px;border-radius:20px;filter:drop-shadow(0 2px 6px #00000040);animation:subtleMove 3s ease-in-out infinite;user-select:none}@keyframes subtleMove{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}@keyframes steam{0%,100%{opacity:1;transform:translateY(0)}50%{opacity:.6;transform:translateY(-6px)}}#controls{flex-grow:1;display:flex;flex-direction:column;gap:18px;position:relative}#controls button{background:#2ea44f;border:0;padding:10px 18px;border-radius:7px;color:#fff;font-weight:600;cursor:pointer;width:fit-content;transition:background-color .2s ease}#controls button:hover{background:#24943c}#info{font-size:1.1rem;font-weight:600;color:#2c2e35}#statusBars label{font-size:.9rem;color:#555;margin-top:10px;font-weight:500}progress{width:100%;height:14px;margin-top:4px;border-radius:8px;overflow:hidden;-webkit-appearance:none;appearance:none}progress::-webkit-progress-bar{background-color:#e0e0e0;border-radius:8px}progress::-webkit-progress-value{background-color:#2ea44f;border-radius:8px}#dayClock{position:absolute;top:0;right:0;width:80px;height:80px;border:1.4px solid #2ea44f;border-radius:50%;background:#fff}#gameCanvas{border-radius:12px;background:#fff;box-shadow:0 0 12px #0000001a;display:block;margin:0 auto 36px;width:100%;max-width:1280px;height:220px;user-select:none}@media(max-width:720px){#activityOverview{flex-direction:column;align-items:center}#dev-image img{width:120px}#controls{width:100%}}progress#levelStat::-webkit-progress-value{background-color:#28a745}progress#expStat::-webkit-progress-value{background-color:#218838}progress#monsterStat::-webkit-progress-value{background-color:#17a2b8}.pixel-vm{width:260px;background:#0d192769;border:4px solid #767778;border-radius:12px;box-shadow:3px 3px 0 #87a7c7;padding:14px 16px 16px;font-family:'Courier New',monospace}.slot{display:flex;align-items:center;justify-content:center;padding:6px 2px;margin:8px 0;border-radius:10px;min-height:58px;width:100%;border:2px solid #767778;box-shadow:1px 1.5px 0 #87a7c7;background:0;transition:background .15s,box-shadow .15s;font-size:1rem}.slot-inner{display:flex;flex-direction:row;align-items:center;justify-content:space-between}.slot-inner>.slot-info-col{display:flex;flex-direction:column;width:calc(100% - 50px)}.coffee{background:#9c7a6b;color:#fff}.energy{background:#0b0054;color:#fff}.choco{background:#6d4c2f;color:#fff}.slot:active,.slot:focus,.slot:hover{outline:2px solid #fff83d;box-shadow:0 0 0 3px #fffac233;filter:brightness(1.13)}.buttons{display:flex;justify-content:flex-start;gap:7px;margin:11px 0 3px}.price{font-weight:700;color:#fde293}.effect{font-weight:500;color:#a9e34b}.slot{flex-direction:column;padding:8px 10px 14px}.icon-pixel{width:50px;height:50px;min-width:48px;min-height:48px;image-rendering:pixelated;border-radius:8px;margin:0 2px}.slot-info-col{display:flex;flex-direction:column;justify-content:center;gap:0;min-width:0}.slot-label{font-weight:700;font-size:1.1em;margin-bottom:2px;color:#fff}.effect,.price{font-size:.9em;display:inline-block;width:auto}.price-effect-wrapper{gap:12px}#gameIntro h3,#gameIntro h4{margin-bottom:8px;font-weight:700}#gameIntro ul{list-style-type:disc;padding-left:20px;margin:0}#loginScreen button{margin-top:12px}#commitColors span{margin-top:4px;color:#555}#avatar img{width:48px;height:48px;border-radius:50%;border:2px solid #e1e4e8;box-shadow:0 0 4px #0000001a;object-fit:cover;display:block}button{background-color:#2ea44f;border:2px solid #238636;color:#fff;font-weight:700;font-size:1rem;padding:8px 18px;border-radius:8px;cursor:pointer;box-shadow:0 5px #1f792e;transition:background-color .2s,box-shadow .1s;user-select:none}button:hover{background-color:#36c95c}button:active{box-shadow:0 2px #1f792e;transform:translateY(3px)}button:disabled{background-color:#94d3a2;border-color:#7bb174;cursor:not-allowed;box-shadow:none;color:#e6f4ea}</style><div id=loginScreen><img id=catLogo alt="Cat Logo" style=width:48px;height:48px;border-radius:50% src=""><h2>Grass Tower Defense</h2><input id=gitNickname placeholder="Enter your GitHub username" title=username> <button id=loginBtn>Start Game</button><p style=margin-top:12px;font-size:.9rem;color:#555>New to this game? <a href=# id=gameIntroLink style=color:#2ea44f;text-decoration:none;cursor:pointer>Learn more</a><p style=margin-top:12px;font-size:.9rem;color:#555>Sound: <a href=# id=muteBtnLogin style=color:#2ea44f;text-decoration:none;cursor:pointer>BGM Mute </a>/ <a href=# id=effectMuteBtnLogin style=color:#2ea44f;text-decoration:none;cursor:pointer>Effect Mute</a></div><div id=gameIntroModal style=display:none;position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(0,0,0,.6);justify-content:center;align-items:center;z-index:1000><div style="background:#fff;padding:24px;border-radius:8px;max-width:450px;max-height:80vh;overflow-y:auto;font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif"><h2>Game Introduction</h2><p>The game is about a developer who tries every day to stop enemies (black cats inspired by GitHub's mascot Mona) from overwhelming the field.<h3>How to play</h3><ul><li>Enter your GitHub username and start playing. (it doesn't matter if it doesn't exist)<li>Click “Work” to gain contribution points and build towers.<li>If you have caffeinee, your work will proceed automatically, though at a slower pace.<li>Enemies are black cats inspired by Mona, GitHub’s mascot.<li>If too many black cats (30) overwhelm the field, it’s game over.<li>You cannot plant grass for previous days.</ul><div id=commitColors style=margin-top:16px;font-family:monospace;font-size:14px><div style=display:flex;gap:16px;align-items:center><div style=display:flex;flex-direction:column;align-items:center><div style="width:20px;height:20px;background:#ebedf0;border:1px solid #ccc"></div><span>0 commits</span></div><div style=display:flex;flex-direction:column;align-items:center><div style="width:20px;height:20px;background:#c6e48b;border:1px solid #ccc"></div><span>1-3 commits</span></div><div style=display:flex;flex-direction:column;align-items:center><div style="width:20px;height:20px;background:#7bc96f;border:1px solid #ccc"></div><span>4-6 commits</span></div><div style=display:flex;flex-direction:column;align-items:center><div style="width:20px;height:20px;background:#239a3b;border:1px solid #ccc"></div><span>7-9 commits</span></div><div style=display:flex;flex-direction:column;align-items:center><div style="width:20px;height:20px;background:#196127;border:1px solid #ccc"></div><span>10+ commits</span></div></div></div><button id=closeGameIntro style="margin-top:16px;background:#2ea44f;color:#fff;border:0;padding:8px 12px;border-radius:5px;cursor:pointer">Close</button></div></div><div id=container><div id=header><div id=avatar><img id=profileImg src="" alt="profile Img"></div><div id=nickname>black-kitty-dev</div></div><canvas id=gameCanvas width=1280 height=220></canvas><div id=activity-label><span>Contribution Activity</span> <svg viewBox="0 0 24 24" aria-hidden=true><path d="M20 5H4c-1.1 0-2 .9-2 2v10c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V7c0-1.1-.9-2-2-2zm0 11H4V8h16v8zM7 10h2v2H7v-2zm3 0h2v2h-2v-2zM5 14h14v2H5v-2z"/></svg></div><div id=commitBarContainer><div id=commitBar>0%</div></div><div id=activityOverview><div id=dev-image><div id=avatar-container style=width:128px;height:128px;overflow:hidden><canvas id=avatar-canvas width=128 height=128></canvas></div><div id=stats-bar style=justify-content:center;gap:30px;margin-bottom:16px;user-select:none><div class=stat-cell style=text-align:center><div><span style=font-size:12px;font-weight:700;color:#57606a>Level</span> <span id=levelVal style=font-size:14px;font-weight:600;color:#1b1f23>1</span></div><progress id=levelStat value=1 max=100 style=width:120px;height:12px;border-radius:6px></progress></div><div class=stat-cell style=text-align:center><div><span style=font-size:12px;font-weight:700;color:#57606a>Exp</span> <span id=expVal style=font-size:14px;font-weight:600;color:#1b1f23>0/10</span></div><progress id=expStat value=0 max=20 style=width:120px;height:12px;border-radius:6px></progress></div><div class=stat-cell style=text-align:center><div><span style=font-size:12px;font-weight:700;color:#57606a>Black Cat</span> <span id=monsterVal style=font-size:14px;font-weight:600;color:#1b1f23>3/10</span></div><progress id=monsterStat value=1 max=30 style=width:120px;height:12px;border-radius:6px></progress></div></div></div><div id=controls><button id=workBtn>Work +<span id=workRateCount>0</span>%</button><div id=info>COIN: <span id=coinCount>0</span></div><canvas id=dayClock width=80 height=80></canvas><div class=stat-cell style=text-align:center><div style=font-size:16px;font-weight:700;color:#57606a;text-align:right>Day</div><div id=dateVal style=font-size:20px;font-weight:600;color:#1b1f23;text-align:right>1</div></div><div id=statusBars><label for=fatigue>HP : <span id=hpText></span></label><progress id=fatigue value=30 max=100></progress><label for=caffeinee>caffeinee : <span id=caffeineeText></span></label><progress id=caffeinee value=70 max=100></progress></div></div><div class=pixel-vm><button class="slot choco" id=vmBuyChocoBar><div class=slot-inner><div class=slot-info-col><span class=slot-label>CHOCOLATE BAR</span><div class=price-effect-wrapper><div class=price>150 Coin</div><div class=effect>Hp +30</div></div></div><canvas class=icon-pixel data-sprite-index=2 width=50 height=50></canvas></div></button> <button class="slot coffee" id=vmBuyCoffee><div class=slot-inner><div class=slot-info-col><div class=slot-label>COFFEE</div><div class=price-effect-wrapper><div class=price>50 Coin</div><div class=effect>caffeinee +50</div></div></div><canvas class=icon-pixel data-sprite-index=1 width=50 height=50></canvas></div></button> <button class="slot energy" id=vmBuyEnergy><div class=slot-inner><div class=slot-info-col><span class=slot-label>ENERGY DRINK</span><div class=price-effect-wrapper><div class=price>80 Coin</div><div class=effect>caffeinee +90</div></div></div><canvas class=icon-pixel data-sprite-index=0 width=50 height=50></canvas></div></button><div class=buttons><button id=muteBtn style="width:100px;margin-left:20px;padding:6px 12px;font-size:.9rem;cursor:pointer">BGM<br>Mute</button> <button id=effectMuteBtn style="width:100px;margin-left:20px;padding:6px 12px;font-size:.9rem;cursor:pointer">Effect<br>Mute</button></div></div></div></div><script>zzfxM=(e,n,i,o=125)=>{let l,s,h,r,c,d,m,f,u,g,y,p,x,I,w,E=0,M=[],k=[],B=[],v=0,b=0,C=1,T={},P=t/o*60>>2;for(;C;v++)M=[C=f=y=x=0],i.map((t,o)=>{for(m=n[t][v]||[0,0,0],C|=!!n[t][v],w=x+(n[t][0].length-2-!f)*P,I=o==i.length-1,s=2,r=x;s<m.length+I;f=++s){for(c=m[s],u=s==m.length+I-1&&I||g!=(m[0]||0)|c|0,h=0;h<P&&f;h++>P-99&&u?p+=(p<1)/99:0)d=(1-p)*M[E++]/2||0,k[r]=(k[r]||0)-d*b+d,B[r]=(B[r++]||0)+d*b+d;c&&(p=c%1,b=m[1]||0,(c|=0)&&(M=T[[g=m[E=0]||0,c]]=T[[g,c]]||(l=[...e[g]],l[2]*=2**((c-12)/12),c>0?a(...l):[])))}x=w});return[k,B]};const e=(...e)=>i(a(...e)),t=44100,n=new AudioContext,i=(...e)=>{let t=n.createBuffer(e.length,e[0].length,44100),i=n.createBufferSource();return e.map((e,n)=>t.getChannelData(n).set(e)),i.buffer=t,i.connect(n.destination),i.start(),i},a=(e=1,t=.05,n=220,i=0,a=0,o=.1,l=0,s=1,h=0,r=0,c=0,d=0,m=0,f=0,u=0,g=0,y=0,p=1,x=0,I=0,w=0)=>{let E,M,k=2*Math.PI,B=e=>e<0?-1:1,v=h*=500*k/44100/44100,b=n*=(1+2*t*Math.random()-t)*k/44100,C=[],T=0,P=0,S=0,D=1,H=0,L=0,A=0,R=k*Math.abs(w)*2/44100,F=Math.cos(R),W=Math.sin(R)/2/2,$=1+W,z=-2*F/$,G=(1-W)/$,U=(1+B(w)*F)/2/$,q=-(B(w)+F)/$,V=U,O=0,X=0,Y=0,j=0;for(r*=500*k/85766121e6,u*=k/44100,c*=k/44100,d*=44100,m=44100*m|0,e*=.3,M=(i=44100*i+9)+(x*=44100)+(a*=44100)+(o*=44100)+(y*=44100)|0;S<M;C[S++]=A*e)!(++L%(100*g|0))&&(A=(m?1-I+I*Math.sin(k*S/m):1)*B(A=l?l>1?l>2?l>3?Math.sin(T**3):Math.max(Math.min(Math.tan(T),1),-1):1-(2*T/k%2+2)%2:1-4*Math.abs(Math.round(T/k)-T/k):Math.sin(T))*Math.abs(A)**s*(S<i?S/i:S<i+x?1-(S-i)/x*(1-p):S<i+x+a?p:S<M-y?(M-S-y)/o*p:0),A=y?A/2+(y>S?0:(S<M-y?1:(M-S)/y)*C[S-y|0]/2/e):A,w&&(A=j=V*O+q*(O=X)+U*(X=A)-G*Y-z*(Y=j))),T+=(E=(n+=h+=r)*Math.cos(u*P++))+E*f*Math.sin(S**5),D&&++D>d&&(n+=c,b+=c,D=0),m&&!(++H%m)&&(n=b,h=v,D=D||1);return C};let o=[[[1.3,0,70,,.03,.15,2,1.7,,,,,.03,3.8,-.05,,.25],[1,0,30,,,.2,3,4,,,3,.9,.04],[.9,0,740,,.05,.1,2,.35,-.1,-.18,9,.02,,.1,.12,,.06],[1.6,0,12,,.02,.08,2,2.2,,,,,.02,2.5,.1,,.2]],[[[0,-1,13,16,18,20,18,16,13,,,,,,,,,,,,,,,,,,,13,16,18,20,18,16,13,20,22,25,22,20,18,16,13,,,13,16,18,16,13,,],[2,-1,13,0,11,,,,,,,,,,13,,25,25,11,11,23,11,,11,23,11,11,11,23,22,18,,30,,18,18,30,18,,18,30,18,18,18,30,22,13,,25,,13,13,25,13,,13,25,13,13,13,25,,],[3,0,13,,,,,13,,,,,,,,,,,,,,,,,,,,13,,,,,13,,13,13,,,,,13,,13,,,,,13,,],[2,0,,,,20,,,,,,25,,,,,,20,25,,,,18,20,,,,25,,,,]],[[0,-1,20,22,25,22,20,18,16,18,20,22,,,,,,,,,,,,,,,,,,,20,18,16,13,18,20,22,20,18,16,13,13,16,18,20,18,16,13,,],[2,-1,13,0,11,,,,,,,,,,13,,25,25,11,11,23,11,,11,23,11,11,11,23,22,18,,30,,18,18,30,18,,18,30,18,18,18,30,22,13,,25,,13,13,25,13,,13,25,13,13,13,25,,],[3,0,13,,,,,13,13,,13,,,,,13,13,,13,,,,,13,13,,],[2,0,,,,25,,,,20,,,,,,,,,,,,,,,,,,,,,,25,,,,20,,18,,,22,,,,,,,,,,,,,,,,,,,,20,,,25,,,]]],[0,0,1,1,0,1,0,1]],l=null,s=!1,h=!1;function r(){l&&l.stop(),(l=i(...zzfxM(...o))).loop=!0,l.volume=h?0:1}let c=document.getElementById("muteBtn"),d=document.getElementById("muteBtnLogin"),m=document.getElementById("effectMuteBtn"),f=document.getElementById("effectMuteBtnLogin");function u(){h=!h,c.innerHTML=h?"BGM<br>Unmute":"BGM<br>Mute",d.textContent=h?"BGM Unmute":"BGM Mute",h?l&&l.stop():r()}function g(){s=!s,m.innerHTML=s?"Effect<br>Unmute":"Effect<br>Mute",f.textContent=s?"Effect Unmute":"Effect Mute"}c.addEventListener("click",u),d.addEventListener("click",u),m.addEventListener("click",g),f.addEventListener("click",g);let y=new Image;y.src="item_border.png";let p=document.querySelectorAll(".icon-pixel"),x=document.getElementById("loginScreen"),I=document.getElementById("loginBtn"),w=document.getElementById("gitNickname"),E=document.getElementById("container"),M=document.getElementById("nickname"),k=document.getElementById("profileImg"),B=document.getElementById("coinCount"),v=document.getElementById("workRateCount"),b=document.getElementById("fatigue"),C=document.getElementById("hpText"),T=document.getElementById("caffeineeText"),P=document.getElementById("caffeinee"),S=document.getElementById("dayClock"),D=S.getContext("2d"),H=document.getElementById("gameCanvas"),L=H.getContext("2d"),A=(H.width-1162)/2,R=(H.height-150)/2,F=!1,W=100,$=3,z=1,G=1,U=0,q=10,V={coffee:0,notebook:0,caffeinee:0,hp:100,maxHp:100,healHp:1};b.value=V.hp,b.max=V.maxHp,C.innerText=V.hp,P.value=V.caffeinee,T.innerText=V.caffeinee;let O,X,Y=Array(371).fill(0),j=Array(371).fill(!0),N=0,_=1,J=0,K=0,Q=0,Z=!1,ee=!1,te=new Image;te.src="avatar.png";let ne=document.getElementById("avatar-canvas").getContext("2d"),ie=!1,ae=[{id:"healBoost",title:"Speed up your physical recovery",description:"HP recovery increased by 1",apply(){V.healHp+=1}},{id:"manualBoost",title:"Increasing manual workload",description:"Increase the amount of increase when clicking the Work button",apply(){_+=1}},{id:"autoBoost",title:"Auto workload increase (caffeine)",description:"Auto workload increase (caffeine)",apply(){J+=.5}},{id:"maxHpBoost",title:"Maximum HP growth",description:"Up to Hp+10",apply(){V.maxHp+=10,V.hp=Math.min(V.hp+10,V.maxHp)}}];function oe(){let e;B.textContent=W,v.textContent=_,b.value=V.hp,b.max=V.maxHp,C.innerText=`${V.hp}/${V.maxHp}`,P.value=V.caffeinee,T.innerText=V.caffeinee,document.getElementById("levelStat").value=G,document.getElementById("levelVal").textContent=G+"",document.getElementById("expStat").value=U,document.getElementById("expStat").max=q,document.getElementById("expVal").textContent=`${U}/${q}`,document.getElementById("dateVal").textContent=z,e=fe.length,document.getElementById("monsterStat").value=e,document.getElementById("monsterStat").max=ue,document.getElementById("monsterVal").textContent=`${e}/${ue}`}function le(e){for(N+=e;N>=100;)N-=100,Me();se()}function se(){let e=document.getElementById("commitBar"),t=Math.min(100,Math.floor(N));e.style.width=t+"%",e.textContent=t+"%"}I.addEventListener("click",()=>{let e=w.value.trim();e?(k.src=`https://github.com/${e}.png?size=48`,k.onerror=()=>{k.src=Se},M.textContent=e,x.style.display="none",E.style.display="block",F=!0,clearInterval(O),oe(),Re(),Ae(0),Ce(),p.forEach(e=>{let t=e.getContext("2d"),n=parseInt(e.dataset.spriteIndex);t.clearRect(0,0,50,50),t.imageSmoothingEnabled=!1,t.drawImage(y,32*n,0,32,32,0,0,50,50)}),F&&(window.nextDayInterval&&clearInterval(window.nextDayInterval),window.nextDayInterval=setInterval(ke,Fe),requestAnimationFrame(We))):alert("Please enter your nickname.")});let he=[];function re(e){let t=A+22*Math.floor(e/7)+9,n=R+e%7*22+9;return he.find(e=>1>Math.abs(e.x-t)&&1>Math.abs(e.y-n))}class ce{constructor(e,t,n){this.x=e,this.y=t,this.level=n,this.range=120+10*(n-1),this.damage=5+3*n,this.cooldown=0,this.cooldownMax=30,this.isAttacking=!1,this.attackEffectFrame=0,this.effectMaxFrames=6,this.effectTargetPos=null,this.selected=!1}update(){if(this.cooldown>0)return this.cooldown--,this.attackEffectFrame++,void(this.attackEffectFrame>this.effectMaxFrames&&(this.attackEffectFrame=0,this.isAttacking=!1,this.effectTargetPos=null));let t=fe.filter(e=>!e.isDead&&Math.hypot(e.x-this.x,e.y-this.y)<=this.range);if(0===t.length)return;t.sort((e,t)=>Math.hypot(e.x-this.x,e.y-this.y)-Math.hypot(t.x-this.x,t.y-this.y));let n=t[0];n.takeDamage(this.damage),this.cooldown=this.cooldownMax,this.isAttacking=!0,s||e(1,.05,120,.01,.07,.1,1,3.4,8,40,0,0,0,0,0,0,0,.97,.09,0,-1415),this.attackEffectFrame=0,this.effectTargetPos={x:n.x,y:n.y}}draw(){L.beginPath();let e=["#69c739","#389431","#0a641d","#196127"],t=Math.min(this.level-1,e.length-1);L.fillStyle=e[t]||"#eee",L.fillRect(this.x-9,this.y-9,18,18),this.isAttacking?(L.strokeStyle=["#88cc55","#55aa33","#339900","#227700"][t]||"#88cc55",L.lineWidth=3+this.level,L.shadowColor="rgba(255,255,153,0.7)",L.shadowBlur=8,L.strokeRect(this.x-9,this.y-9,18,18),L.shadowBlur=0,this.effectTargetPos&&(L.beginPath(),L.lineWidth=L.lineWidth+1,L.moveTo(this.x,this.y),L.lineTo(this.effectTargetPos.x,this.effectTargetPos.y),L.stroke())):(L.lineWidth=1,L.strokeStyle="#bccbb9",L.strokeRect(this.x-9,this.y-9,18,18)),this.selected&&(L.beginPath(),L.strokeStyle="rgba(40,150,40,0.5)",L.lineWidth=3,L.arc(this.x,this.y,this.range,0,2*Math.PI),L.stroke())}updateProperties(e){this.level=e,this.damage=5+3*e,this.range=120+10*(e-1),this.cooldown=0,this.update()}}let de=new Image;de.src="cat.png";class me{constructor(){this.left=A,this.top=R,this.right=A+1162,this.bottom=R+150,this.speed=Ie,this.side=0,this.x=this.left,this.y=this.top,this.hp=pe,this.radius=xe,this.scale=this.radius/10,this.frameCount=4,this.frameIndex=0,this.frameDelay=10,this.frameTicker=0,this.width=32,this.height=32,this.isDead=!1}update(){if(!this.isDead)switch(this.frameTicker++,this.frameTicker>=this.frameDelay&&(this.frameTicker=0,this.frameIndex=(this.frameIndex+1)%this.frameCount),this.side){case 0:this.x+=this.speed,this.x>=this.right&&(this.x=this.right,this.side=1);break;case 1:this.y+=this.speed,this.y>=this.bottom&&(this.y=this.bottom,this.side=2);break;case 2:this.x-=this.speed,this.x<=this.left&&(this.x=this.left,this.side=3);break;case 3:this.y-=this.speed,this.y<=this.top&&(this.y=this.top,this.side=0)}}draw(){if(this.isDead)return;let e=this.width*this.scale,t=this.height*this.scale;L.drawImage(de,this.frameIndex*this.width,0,this.width,this.height,this.x-e/2,this.y-t/2,e,t)}takeDamage(t){this.hp-=t,this.hp<=0&&!this.isDead&&(this.isDead=!0,W+=10,s||e(...[,,925,.04,.3,.6,1,.3,,6.27,-184,.09,.17]),++U>=q&&(U=0,G++,function(){let e=document.createElement("div");e.style="position:fixed;top:0;left:0;width:100vw;height:100vh;display:flex;justify-content:center;align-items:center;background:rgba(0,0,0,0.7);z-index:999;";let t=document.createElement("div");t.style="background:#fff;padding:20px;border-radius:10px;display:flex;gap:16px;";let n=[];for(;n.length<3;){let e=ae[Math.floor(Math.random()*ae.length)];n.includes(e)||n.push(e)}n.forEach(n=>{let i=document.createElement("div");i.style="cursor:pointer;padding:12px;border:1px solid #ccc;border-radius:8px;width:130px;text-align:center;",i.innerHTML=`<h3>${n.title}</h3><p style="font-size:12px">${n.description}</p>`,i.onclick=()=>{n.apply(),G++,oe(),document.body.removeChild(e)},t.appendChild(i)}),e.appendChild(t),document.body.appendChild(e)}(),q+=5),oe())}}let fe=[],ue=30,ge=0,ye=1,pe=30,xe=10,Ie=2,we=2,Ee=2;function Me(){var e;Q++,N=0,se(),K>=Y.length&&(K=0);let t=(e=Q)>=10?4:e>=5?3:e>=3?2:e>=1?1:0;if(0===Y[K]){Y[K]=t;let e=Math.floor(K/7),n=R+K%7*22+9;re(K)||he.push(new ce(A+22*e+9,n,t))}else Y[K]<t&&(Y[K]=t,re(K)?.updateProperties(t));He()}function ke(){z++,Q=0,W+=Math.ceil(1.5*$),z%7==1&&(pe=Math.floor(pe*we),xe+=Ee),function(){for(let e=0;e<Y.length;e++)Y[e]>0&&(j[e]=!1)}(),ge=0,oe(),function(e=1,t=1500){let n=0,i=setInterval(()=>{if(n>=e||fe.length>=ue)return void clearInterval(i);let t=function(){let e,t=0;do{let n=A+1162*Math.random(),i=R+150*Math.random();if(!fe.some(e=>40>Math.hypot(e.x-n,e.y-i))){e={x:n,y:i};break}t++}while(t<20);return e||{x:A,y:R}}(),a=new me;a.x=t.x,a.y=t.y,fe.push(a),n++},t)}(ye,1e3),K=(K+1)%Y.length,ye=Math.min(ye+1,5)}let Be=0;function ve(){Be=V.hp<=0||ee?3:Pe()?2:(Be+1)%2}function be(){ne.clearRect(0,0,128,128),ne.imageSmoothingEnabled=!1,ne.drawImage(te,64*Be,0,64,64,0,0,128,128)}function Ce(){O=setInterval(()=>{Pe()||ee||(ve(),be())},500)}function Te(){clearInterval(O),clearTimeout(X),Z=!0,ve(),be(),X=setTimeout(()=>{Z=!1,ve(),be(),Ce()},2e3)}function Pe(){return Z}let Se="",De=new Image;function He(){L.clearRect(0,0,H.width,H.height),function(){for(let e=0;e<53;e++)for(let t=0;t<7;t++){let n=7*e+t,i=Y[n],a=A+22*e,o=R+22*t,l=["#ebedf0","#c6e48b","#7bc96f","#239a3b","#196127"];L.fillStyle=l[i],L.shadowColor="rgba(0,0,0,0.12)",L.shadowBlur=2,L.shadowOffsetX=0,L.shadowOffsetY=1,L.fillRect(a,o,18,18),L.shadowColor="transparent",L.strokeStyle="#bcf2a4",L.lineWidth=1,L.strokeRect(a,o,18,18),n===K&&(L.strokeStyle="#2ea44f",L.lineWidth=4,L.shadowColor="#2ea44f",L.shadowBlur=8,L.strokeRect(a-2,o-2,22,22),L.shadowColor="transparent")}}(),he.forEach(e=>e.update()),fe.forEach(e=>{e.update(),e.draw()}),(fe=fe.filter(e=>!e.isDead)).length>=ue&&(alert("Too many black cats came! Game over!"),W=0,z=1,fe=[],he=[],Y=Array(371).fill(0),j=Array(371).fill(!0),K=0,Q=0,N=0,_=1,J=0,V.hp=100,V.caffeinee=0,pe=30,xe=10,Ie=2,oe(),F=!1,E.style.display="none",x.style.display="block"),he.forEach(e=>e.draw())}De.src="cat.png",De.onload=()=>{Se=function(e=0,t=32,n=32){let i=document.createElement("canvas");return i.width=t,i.height=n,i.getContext("2d").drawImage(De,e*t,0,t,n,0,0,t,n),i.toDataURL()}(0,32,32),k.src=Se,document.getElementById("catLogo").src=Se},H.addEventListener("click",e=>{let t=H.getBoundingClientRect(),n=e.clientX-t.left,i=e.clientY-t.top,a=null;for(let e of he)if(n>=e.x-9&&n<=e.x+9&&i>=e.y-9&&i<=e.y+9){a=e;break}he.forEach(e=>e.selected=!1),a&&(a.selected=!0)});let Le=Date.now();function Ae(e){V.caffeinee=Math.min(V.caffeinee+e,100),ie=!0,J=1,oe(),window.caffeineeTimer&&clearInterval(window.caffeineeTimer),window.caffeineeTimer=setInterval(()=>{V.caffeinee>0&&(V.caffeinee--,oe()),V.caffeinee<=0&&(J=0,ie=!1,clearInterval(window.caffeineeTimer))},1e3)}function Re(){F&&(He(),$=_+J,ie&&J>0&&le(.01*J)),requestAnimationFrame(Re)}document.getElementById("workBtn").onclick=()=>{!F||V.hp<=0||(le(_),Le=Date.now(),V.hp=Math.max(0,V.hp-1),ee=!1,Z=!1,s||e(...[,,537,.02,.02,.22,1,1.59,-6.98,4.97]),oe())},setInterval(()=>{let e=Date.now();F&&e-Le>1e4&&V.hp<V.maxHp&&(V.hp+=V.healHp,ee=!0,Z=!1,oe())},1e3),document.getElementById("vmBuyCoffee").onclick=()=>{W>=50&&(W-=50,Ae(50),oe(),s||e(...[,,150,.2,.05,.2,2,1.5,2,2.5,,,,.5,.1,.05]),Te())},document.getElementById("vmBuyEnergy").onclick=()=>{W>=80&&(W-=80,Ae(90),oe(),s||e(...[,,300,.15,.05,.25,2,1.8,6,4.5,,,,1.5,.2,.07]),Te())},document.getElementById("vmBuyChocoBar").onclick=()=>{W>=150&&(W-=150,V.hp=Math.min(V.hp+30,V.maxHp),oe(),s||e(...[,,90,.08,.01,.1,3.5,2.5,,,,,,.2,.3,.02,.12]),Te())};let Fe=14e3;function We(e){var t;We.last||(We.last=e);let n,i,a=e-We.last;We.last=e,(ge+=a/Fe)>1&&(ge=1),t=ge,n=S.width/2,D.clearRect(0,0,S.width,S.height),D.translate(n,n),D.fillStyle="#fff",D.beginPath(),D.arc(0,0,n-5,0,2*Math.PI),D.fill(),D.strokeStyle="#2ea44f",D.lineWidth=6,D.beginPath(),D.arc(0,0,n-7,0,2*Math.PI),D.stroke(),i=2*t*Math.PI-Math.PI/2,D.strokeStyle="#2ea44f",D.lineWidth=6,D.beginPath(),D.moveTo(0,0),D.lineTo(n*Math.cos(i),n*Math.sin(i)),D.stroke(),D.resetTransform(),requestAnimationFrame(We)}document.getElementById("gameIntroLink").addEventListener("click",e=>{e.preventDefault(),document.getElementById("gameIntroModal").style.display="flex"}),document.getElementById("closeGameIntro").addEventListener("click",()=>{document.getElementById("gameIntroModal").style.display="none"}),r()</script>