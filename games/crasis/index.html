<!doctype html><script>!function(t,e){"function"==typeof define&&define.amd?define([],e):t.Game=e()}(this,(function(){function t(){var t,e,i,s=arguments,o=s.length;for(i=0;o>i;i++)if(e=s[i])for(t in e)e.hasOwnProperty(t)&&(this[t]=e[t]);return this}function e(){function i(){var t=this instanceof i?this:Object.create(i.prototype);return t.construct.apply(t,arguments)||t}return i.prototype="function"==typeof this?Object.create(this.prototype):{},t.apply(i.prototype,arguments),i.subclass=e,i}function i(t){return"number"==typeof t}function s(t){return Math.round(t)+.5}function o(t){if(!0===isNaN(t))throw new Error("NaN in Vect");if(!1===isFinite(t))throw new Error("Infinity in Vect");return Math.round(1e6*t)/1e6}function n(t){var e=t.r,i=t.type,s=e+8,o=e+8;return n[e+i]||(n[e+i]=(new x).size(2*s,2*o).draw((function(n){n.beginPath(),n.arc(s,o,e,0,g,!1),n.fillStyle=w.gradient(n,i,s,o,e),n.fill(),n.closePath(),n.lineWidth=2,n.strokeStyle=t.color,n.stroke(),n.lineJoin="round",n.beginPath(),t.mask&(u|d)&&(n.moveTo(s,o-8),n.lineTo(s-8*y/2,o+4),n.lineTo(s+8*y/2,o+4),n.lineTo(s,o-8),n.closePath()),t.mask&(p|f)&&(n.moveTo(s,o+8),n.lineTo(s-8*y/2,o-4),n.lineTo(s+8*y/2,o-4),n.lineTo(s,o+8),n.closePath()),t.mask&(f|d)&&(n.moveTo(s-8*y/2,o),n.lineTo(s+8*y/2,o),n.closePath()),n.lineWidth=5,n.strokeStyle="#000",n.stroke(),n.lineWidth=2,n.strokeStyle=t.color,n.stroke()}))),n[e+i].elem}function r(t){var e=t.r,i=t.type,s=e+12,o=e+12;return r[e+i]||(r[e+i]=(new x).size(2*s,2*o).set({lineWidth:2,strokeStyle:t.color,shadowOffsetX:0,shadowOffsetY:0,shadowBlur:12,shadowColor:t.color}).path().circ(e,s,o).stroke()),r[e+i].elem}var a={start:function(){M.init(),m.resize(),w.init(),a.bindEvents(),a.load(localStorage.getItem("level")||0),M.play()},lvl:0,level:null,paused:!0,pause:function(){a.paused?(a.paused=!1,a.ticked=0,h(a.loop)):a.paused=!0},step:function(t){w.fg.clear(),w.fx.fill(),m.motion(t)},loop:function(t){return a.level.solved?void w.message("COMPLETE","click to continue"):a.paused?void w.message("PAUSED","click to resume"):(a.ticked&&(delta=t-a.ticked,a.step(delta)),a.ticked=t,void h(a.loop))},load:function(t){m.reset(),w.fg.clear(),t=a.lvl=t||++a.lvl,b[t]||(t=a.lvl=1),a.level=b[t],localStorage.setItem("level",t);for(var e,i,s,o=m.h,n=m.w-1,r=m.unit(2)/y,h=0;o>h&&(n+=h%2?1:-1,e=m.unit(h%2?.5:1),i=r/2+3*r/4*h,a.level.field[h]);h++)for(var l=0;n>l;l++)(s=a.level.field[h][l])&&new v(s,e+m.unit(l),i,m.r-1,!0);for(var c=[u,d,p,f],g=0;g<c.length;g++)new v(c[g],m.unit(g+5)+1,m.height+m.unitH(.75)-1,m.r-1);a.step(0),w.message("READY","flick to combine","reload to retry")},solution:function(t){w.status();var e=!0;return a.level.solve.fire>t[u]&&(e=!1),a.level.solve.air>t[d]&&(e=!1),a.level.solve.water>t[p]&&(e=!1),a.level.solve.earth>t[f]&&(e=!1),!0===e?(a.paused=!0,void(a.level.solved=!0)):void 0},bindEvents:function(){window.onblur=function(){a.paused=!0},a.dragStartMouse=new l(0,0),a.dragStartPos=new l(0,0),a.dragLastPos=new l(0,0),w.fg.elem.addEventListener("mousedown",(function(t){a.level.solved&&a.load();var e,i,s,o=0,n=m.bodies.length;if(t.pageY>m.height)for(;n>o;++o)if((e=m.bodies[o])&&!e.active&&(i=t.pageX-m.left-e.pos.x)*i+(s=t.pageY-m.top-e.pos.y)*s<=e.r*e.r)return e.launching=!1,a.dragging=e,a.dragLastTime=Date.now(),a.dragCurrTime=Date.now(),a.dragStartMouse.set(t.pageX-m.left,t.pageY-m.top),a.dragStartPos.set(e.pos.x,e.pos.y),a.dragLastPos.set(e.pos.x,e.pos.y),e.vel.x=e.vel.y=0,void(a.paused&&a.pause());a.dragging=!1,a.pause()}),!1),window.addEventListener("mousemove",(function(t){var e,i,s;(e=a.dragging)&&(Date.now()-a.dragTime,i=t.pageX-m.left-a.dragStartMouse.x,s=t.pageY-m.top-a.dragStartMouse.y,a.dragLastTime=a.dragCurrTime,a.dragCurrTime=Date.now(),a.dragLastPos.set(e.pos.x,e.pos.y),e.pos.set(Math.max(e.r,Math.min(m.width-e.r,a.dragStartPos.x+i)),Math.min(m.height+m.unitH(1.5)-e.r,a.dragStartPos.y+s)),e.pos.y<m.height&&a.release())}),!1),window.addEventListener("mouseup",a.release,!1)},release:function(){var t,e,i,s=Date.now(),o=a.dragging,n=1;a.dragging&&(a.dragging=null,o.launching=!0,s-a.dragCurrTime>50||(t=a.dragCurrTime-a.dragLastTime,e=o.pos.x-a.dragLastPos.x,i=o.pos.y-a.dragLastPos.y,o.vel.set(e/t||0,i/t||0),Math.abs(o.vel.x)>3?n=3/Math.abs(o.vel.x):Math.abs(o.vel.y)>1&&(n=3/Math.abs(o.vel.y)),o.vel.mult(n)))}},h=window.requestAnimationFrame||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame||window.oRequestAnimationFrame,l=e({x:0,y:0,construct:function(t,e){this.set(t,e)},set:function(t,e){return i(t)&&(this.x=o(t)),i(e)&&(this.y=o(e)),this},min:function(t){this.set(Math.abs(this.x)<=t?0:this.x,Math.abs(this.y)<=t?0:this.y)},max:function(t){this.set(Math.abs(this.x)>=t?0:this.x,Math.abs(this.y)>=t?0:this.y)},add:function(t){return this.set(this.x+t.x,this.y+t.y)},sub:function(t){return this.set(this.x-t.x,this.y-t.y)},mult:function(t){return this.set(this.x*t,this.y*t)},div:function(t){return this.set(this.x/t,this.y/t)},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},norm:function(){var t=this.length();return t?this.set(this.x/t,this.y/t):this},rotate:function(){return this.set(-this.y,this.x)},dot:function(t){return t=t||this,this.x*t.x+this.y*t.y},clone:function(){return new l(this.x,this.y)}}),c={},u=1,d=2,p=4,f=8,m={r:30,w:13,h:8,margin:10,border:2,unit:function(t){return 2*m.r*(t||1)},unitH:function(t){return m.unit(2)/y*(t||1)},unit2:function(t){var e=m.r-1;return e*e*Math.PI*(t||1)},resize:function(){m.width=m.unit(m.w),m.top=m.unitH(.75)+m.margin+m.border,m.height=m.unitH(m.h),m.left=m.margin+m.border},reset:function(){m.bodies=[]},bodies:[],matter:{},motion:function(t){m.matter[u]=0,m.matter[d]=0,m.matter[p]=0,m.matter[f]=0;var e,i,s,o,n=m.bodies.length;for(e=0;n>e;e++)if(null!=m.bodies[e]){for(s=m.bodies[e],i=e+1;n>i;i++)null!=m.bodies[i]&&(o=m.bodies[i],m.overlap(s,o)&&m.impulse(s,o));s.worlds_collide(),s.step(t),s.draw(w.fg.ctx),s.active&&(m.matter[s.mask]+=s.area())}a.solution(m.matter)},overlap:function(t,e){if(!t.active||!e.active)return!1;var i=t.r+e.r,s=t.pos.x-e.pos.x,o=t.pos.y-e.pos.y;return i*i>s*s+o*o},impulse:function(t,e){var i=t.pos.clone().sub(e.pos).norm(),s=i.dot(t.vel.clone().sub(e.vel)),o=Math.sqrt(s*s*t.mass*e.mass);switch(o=Math.min(Math.max(Math.PI*o,1234),t.area(),e.area()),t.mask|e.mask){case u|p:case d|f:M.collide(!0),t.area(-o),e.area(-o);break;case u|d:M.collide(),t.area(t.mask&u?+o:-o),e.area(e.mask&u?+o:-o);break;case f|u:M.collide(),t.area(t.mask&f?+o:-o),e.area(e.mask&f?+o:-o);break;case p|f:M.collide(),t.area(t.mask&p?+o:-o),e.area(e.mask&p?+o:-o);break;case d|p:M.collide(),t.area(t.mask&d?+o:-o),e.area(e.mask&d?+o:-o)}if(!(s>0)){var n=-(1+(t.rest+e.rest)/2)*s/(t.inv_mass+e.inv_mass);impulse=i.clone().mult(n),t.vel.add(impulse.clone().mult(t.inv_mass)),e.vel.sub(impulse.clone().mult(e.inv_mass));var r=t.r+e.r-t.pos.clone().sub(e.pos).length(),a=Math.max(r-1,1);a/=t.inv_mass+e.inv_mass,a=i.mult(.5*a),t.force.add(a.clone().mult(t.inv_mass)),e.force.sub(a.clone().mult(e.inv_mass))}}};c[u]={type:"fire",color:"#F73"},c[d]={type:"air",color:"#EEF"},c[p]={type:"water",color:"#1AF"},c[f]={type:"earth",color:"#3F8"};var v=e({mask:0,type:null,r:38,min:16,pos:{x:0,y:0},vel:{x:0,y:0},force:{x:0,y:0},dens:.6,rest:.9,fric:0,mass:null,construct:function(t,e,i,s,o){this.mask|=t,this.r=s||this.r,this.set(c[t]),this.pos=new l(e,i),this.vel=new l(0,0),this.acc=new l(0,0),this.force=new l(0,0),this.init.apply(this,arguments),this.index=m.bodies.push(this)-1,this.active=o||!1,this.launching=!1},set:function(e){t.call(this,e),this.r>this.min&&(this.mass=this.area()*this.dens,this.inv_mass=1/this.mass)},init:function(){},step:function(t){this.r<this.min&&this.destruct(),this.vel.dot()>0&&this.pos.add(this.vel.clone().mult(t)),this.launching&&this.pos.y<m.height-this.r&&(this.active=!0,this.launching=!1),this.pos.add(this.force),this.force.x=0,this.force.y=0},worlds_collide:function(){if(this.active||this.launching){this.pos.y<this.r&&(this.vel.y=Math.abs(this.vel.y),this.force.y=this.r-this.pos.y);var t=this.launching?m.height+m.unitH():m.height;this.pos.y>t-this.r&&(this.vel.y=-Math.abs(this.vel.y),this.force.y=t-this.r-this.pos.y),this.pos.x>m.width-this.r&&(this.vel.x=-Math.abs(this.vel.x),this.force.x=m.width-this.r-this.pos.x),this.pos.x<this.r&&(this.vel.x=Math.abs(this.vel.x),this.force.x=this.r-this.pos.x)}},area:function(t){var e=Math.PI*this.r*this.r;return i(t)&&(e=Math.max(this.min,e+t),this.set({r:Math.sqrt(e/Math.PI)})),e},draw:function(t){this.r<this.min||(t.drawImage(n(this),this.pos.x-this.r-8,this.pos.y-this.r-8),w.fx.ctx.drawImage(r(this),this.pos.x-this.r-12,this.pos.y-this.r-12))},destruct:function(){delete m.bodies[this.index]}}),y=Math.sqrt(3),g=2*Math.PI,w={init:function(){document.body.style.background="#000000",w.fx=new x(document.body).size(m.width,m.height).css({position:"absolute",top:m.top+"px",left:m.left+"px",zIndex:1,border:m.border+"px solid rgba(128,128,255,.75)",marginBottom:m.margin+"px",background:"url("+w.hexgrid(m.r).url()+") repeat"}).draw((function(t){t.fillStyle=t.createPattern(w.hexgrid(m.r).elem,"repeat")})).path().rect(),w.fg=new x(document.body).size(m.width,m.height+m.unitH(1.5)).css({position:"absolute",top:m.top+"px",left:m.left+"px",zIndex:3,border:m.border+"px solid rgba(128,128,255,0)"}),w.header=new x(document.body).size(m.width,m.unitH()).css({position:"fixed",top:m.margin+"px",left:m.left+"px",zIndex:4})},status:function(){w.header.clear().draw((function(t){t.font=m.unit(.75)+"px monospace",t.textAlign="left",t.textBaseline="top",t.fillStyle="rgba(128,128,255,.75)",t.lineWidth=1.5,t.strokeStyle="rgba(128,128,255,1)";var e="CRASIS/"+a.lvl,i=0,s="LEVEL"+a.lvl;m.width,t.measureText(s).width,t.fillText(e,0,i),t.strokeText(e,0,i);i=26;var o=2,n=240,r=m.width-n,h=m.unit2(28);t.fillStyle=c[u].color,l=a.level.solve.fire/h*r,t.fillRect(n,i,l,o),n+=l,t.fillStyle=c[d].color,l=a.level.solve.air/h*r,t.fillRect(n,i,l,o),n+=l,t.fillStyle=c[p].color,l=a.level.solve.water/h*r,t.fillRect(n,i,l,o),n+=l,t.fillStyle=c[f].color,l=a.level.solve.earth/h*r,t.fillRect(n,i,l,o);var l;i=32,o=6,n=240,r=m.width-n;t.fillStyle=c[u].color,l=m.matter[u]/h*r,t.fillRect(n,i,l,o),n+=l,t.fillStyle=c[d].color,l=m.matter[d]/h*r,t.fillRect(n,i,l,o),n+=l,t.fillStyle=c[p].color,l=m.matter[p]/h*r,t.fillRect(n,i,l,o),n+=l,t.fillStyle=c[f].color,l=m.matter[f]/h*r,t.fillRect(n,i,l,o)}))},message:function(t,e,i){w.fg.draw((function(s){var o=m.width/2,n=m.height/2,r=m.width,a=m.height;s.fillStyle="rgba(8,0,16,.75)",s.fillRect(o-r/2,n-a/2,r,a),s.font=m.unit(.75)+"px monospace",s.textAlign="center",s.textBaseline="middle",s.fillStyle="rgba(128,128,255,.75)",s.fillText(t,o,n),s.lineWidth=2,s.strokeStyle="rgba(128,128,255,1)",s.strokeText(t,o,n),s.font=m.unit(.375)+"px monospace",s.fillText(e||"",o,n+m.unit(.75)),s.font=m.unit(.375)+"px monospace",s.fillText(i||"",o,n+m.unit(5/4))}))},gradient:function(t,e,i,s,o){var n=t.createRadialGradient(i,s,1,i,s,o);return n.addColorStop(1,"rgba(0,0,0,1)"),n.addColorStop(.5,"rgba(54,54,54,.5)"),n},hexgrid:function(t){var e=2*t,i=2*e/y,o=s(0),n=s(.5*e),r=s(e),a=s(-1),h=s(.25*i),l=s(.5*i),c=s(.75*i),u=s(i);return(new x).size(Math.floor(e),Math.floor(i)).set({globalAlpha:.2,fillStyle:"rgba(0,0,0,1)"}).rect().fill().set({lineWidth:1,lineCap:"square",strokeStyle:"rgba(128,128,255,.25)",fillStyle:"rgba(128,128,255,.25)"}).path().move(o,a).line(o,u).line(r,l).line(o,a).move(n,a).line(n,u).move(r,a).line(o,l).line(r,u).stroke().path().move(o,a).circ(1).move(o,l).circ(1).move(o,u).circ(1).move(n,h).circ(1).move(n,c).circ(1).move(r,a).circ(1).move(r,l).circ(1).move(r,u).circ(1).fill()},starfield:function(){this.path().set({fillStyle:"#FFF"});for(var t=0,e=Math.sqrt(this.w*this.h);e>t;t++)this.move(Math.random()*this.w,Math.random()*this.h).circ(2*Math.random());this.fill()},colors:{fire:"#F73",air:"#EEF",water:"#1AF",earth:"#3F8"}},x=e({construct:function(t){this.x=this.y=this.w=this.h=0,this.elem=document.createElement("canvas"),this.ctx=this.elem.getContext("2d"),t&&t.appendChild(this.elem)},size:function(t,e){return this.w=this.elem.width=t,this.h=this.elem.height=e,this},css:function(e){return t.call(this.elem.style,e||{}),this},draw:function(t){return t.call(this,this.ctx),this},clear:function(){return this.ctx.clearRect(0,0,this.w,this.h),this},circ:function(t,e,i){return this.ctx.arc(e||this.x,i||this.y,t,0,g,!1),this},rect:function(t,e,i,s){return this.ctx.rect(t||this.x,e||this.y,i||this.w,s||this.h),this},move:function(t,e){return this.ctx.moveTo(this.x=t,this.y=e),this},line:function(t,e){return this.ctx.lineTo(this.x=t,this.y=e),this},set:function(e){return t.call(this.ctx,e||{}),this},path:function(){return this.ctx.closePath(),this.ctx.beginPath(),this},fill:function(){return this.ctx.fill(),this},stroke:function(){return this.ctx.stroke(),this},url:function(){return this.elem.toDataURL()}}),b=[];b[1]={field:[[],[0,0,0,0,0,0,u],[0,0,0,0,0,u,u],[0,0,0,0,0,u,0,u],[0,0,0,0,u,0,0,u],[0,0,0,0,u,0,0,0,u],[0,0,0,u,0,0,0,0,u],[0,0,0,u,u,u,u,u,u,u]],solve:{fire:0,air:0,water:0,earth:m.unit2(18)}},b[2]={field:[[],[0,0,0,0,0,0,d],[0,0,0,0,0,d,d],[0,0,0,0,0,d,0,d],[0,0,0,0,d,0,0,d],[0,0,0,d,d,d,d,d,d,d],[0,0,0,d,0,0,0,0,d],[0,0,0,d,d,d,d,d,d,d]],solve:{fire:m.unit2(23),air:0,water:0,earth:0}},b[3]={field:[[],[0,0,0,p,p,p,p,p,p,p],[0,0,0,p,0,0,0,0,p],[0,0,0,0,p,0,0,0,p],[0,0,0,0,p,0,0,p],[0,0,0,0,0,p,0,p],[0,0,0,0,0,p,p],[0,0,0,0,0,0,p]],solve:{fire:m.unit2(20),air:0,water:0,earth:0}},b[4]={field:[[],[0,0,0,f,f,f,f,f,f,f],[0,0,0,f,0,0,0,0,f],[0,0,0,f,f,f,f,f,f,f],[0,0,0,0,f,0,0,f],[0,0,0,0,0,f,0,f],[0,0,0,0,0,f,f],[0,0,0,0,0,0,f]],solve:{fire:0,air:0,water:m.unit2(19),earth:0}},b[5]={field:[[0,0,0,0,f,0,0,f],[0,0,0,0,f,p,p,f],[0,0,0,0,f,0,0,f],[0,0,0,0,f,0,0,f],[0,0,0,0,f,0,0,f],[0,0,0,0,f,0,0,f],[0,0,0,0,f,0,0,f],[0,0,0,0,f,0,0,f]],solve:{fire:m.unit2(18),air:0,water:m.unit2(1),earth:0}},function(t){function e(t){var i=t.split(n);this.frequency=e.getFrequency(i[0])||0,this.duration=e.getDuration(i[1])||0}function i(t,e,i){t&&(this.ac=t,this.createFxNodes(),this.tempo=e||120,this.loop=!0,this.smoothing=0,this.staccato=0,this.notes=[],this.push.apply(this,i||[]))}var s=440*Math.pow(Math.pow(2,1/12),-9),o=/^[0-9.]+$/,n=/\s+/,r=/(\d+)/,a={};"B#-C|C#-Db|D|D#-Eb|E-Fb|E#-F|F#-Gb|G|G#-Ab|A|A#-Bb|B-Cb".split("|").forEach((function(t,e){t.split("-").forEach((function(t){a[t]=e}))})),e.getFrequency=function(t){var e=t.split(r),i=a[e[0]],o=(e[1]||4)-4;return s*Math.pow(Math.pow(2,1/12),i)*Math.pow(2,o)},e.getDuration=function(t){return o.test(t)?parseFloat(t):t.toLowerCase().split("").reduce((function(t,e){return t+("w"===e?4:"h"===e?2:"q"===e?1:"e"===e?.5:"s"===e?.25:0)}),0)},"undefined"!=typeof module&&(module.exports=e),i.prototype.createFxNodes=function(){var t=this.gain=this.ac.createGain();return this.wet=this.ac.createGain(),this.dry=this.ac.createGain(),[["bass",100],["mid",1e3],["treble",2500]].forEach(function(e,i){(i=this[e[0]]=this.ac.createBiquadFilter()).type="peaking",i.frequency.value=e[1],t.connect(t=i)}.bind(this)),t.connect(this.wet),t.connect(this.dry),this},i.prototype.push=function(){return Array.prototype.forEach.call(arguments,function(t){this.notes.push(t instanceof e?t:new e(t))}.bind(this)),this},i.prototype.createOscillator=function(){return this.stop(),this.osc=this.ac.createOscillator(),this.osc.type=this.waveType||"square",this.osc.connect(this.gain),this},i.prototype.scheduleNote=function(t,e){var i=60/this.tempo*this.notes[t].duration,s=i*(1-(this.staccato||1e-11));return this.setFrequency(this.notes[t].frequency,e),this.smoothing&&this.notes[t].frequency&&this.slide(t,e,s),this.setFrequency(0,e+s),e+i},i.prototype.getNextNote=function(t){return this.notes[t<this.notes.length-1?t+1:0]},i.prototype.getSlideStartDelay=function(t){return t-Math.min(t,60/this.tempo*this.smoothing)},i.prototype.slide=function(t,e,i){var s=this.getNextNote(t),o=this.getSlideStartDelay(i);return this.setFrequency(this.notes[t].frequency,e+o),this.rampFrequency(s.frequency,e+i),this},i.prototype.setFrequency=function(t,e){return this.osc.frequency.setValueAtTime(t,e),this},i.prototype.rampFrequency=function(t,e){return this.osc.frequency.linearRampToValueAtTime(t,e),this},i.prototype.play=function(t){return t="number"==typeof t?t:this.ac.currentTime,this.createOscillator(),this.osc.start(t),this.notes.forEach(function(e,i){t=this.scheduleNote(i,t)}.bind(this)),this.osc.stop(t),this.osc.onended=this.loop?this.play.bind(this,t):null,this},i.prototype.stop=function(){return this.osc&&(this.osc.onended=null,this.osc.stop(0),this.osc.frequency.cancelScheduledValues(0),this.osc=null),this},"undefined"!=typeof module&&(module.exports=i),t.Note=e,t.Sequence=i}("undefined"!=typeof window?window:this);var k,S=128;(window.AudioContext||window.webkitAudioContext)&&(k=new(window.AudioContext||window.webkitAudioContext));var M={init:function(){k&&(this.ac=k,this.osc=this.ac.createOscillator(),this.compressor=this.ac.createDynamicsCompressor(),this.output=this.ac.createGain(),this.output.connect(this.ac.destination),this.output.gain.value=.5,this.reverb=this.ac.createConvolver(),this.reverb.buffer=this.createReverb(2),this.reverb.connect(this.compressor),this.collision1.dry.connect(this.output),this.collision1.gain.gain.value=.4,this.collision1.loop=!1,this.collision2.dry.connect(this.output),this.collision2.gain.gain.value=.4,this.collision2.loop=!1,this.osc.frequency.value=0,this.osc.connect(this.compressor),this.osc.start(),this.kick.wet.connect(this.reverb),this.bass.wet.connect(this.reverb),this.lead.wet.connect(this.reverb),this.counterpoint.wet.connect(this.reverb),this.pad1.wet.connect(this.reverb),this.pad2.wet.connect(this.reverb),this.kick.dry.connect(this.compressor),this.bass.dry.connect(this.compressor),this.lead.dry.connect(this.compressor),this.counterpoint.dry.connect(this.compressor),this.pad1.dry.connect(this.compressor),this.pad2.dry.connect(this.compressor),this.compressor.ratio.value=4,this.compressor.threshold.value=-12,this.compressor.connect(this.output),this.bass.staccato=.25,this.bass.waveType="sawtooth",this.bass.treble.type="lowpass",this.bass.treble.frequency.value=2500,this.bass.mid.gain.value=-2,this.lead.smoothing=.06,this.lead.gain.gain.value=.35,this.lead.wet.gain.value=1.5,this.counterpoint.smoothing=.06,this.counterpoint.gain.gain.value=.22,this.pad1.gain.gain.value=.25,this.pad1.wet.gain.value=3,this.pad1.waveType="sawtooth",this.pad2.gain.gain.value=.2,this.pad2.wet.gain.value=3,this.pad2.waveType="sawtooth",this.kick.waveType="sine",this.kick.smoothing=.8,this.kick.gain.gain.value=2,this.kick.bass.frequency.value=60,this.kick.bass.gain.value=10,this.kick.mid.frequency.value=100,this.kick.mid.gain.value=5,this.kick.wet.gain.value=.3)},play:function(){var t,e;this.ac&&(e=(t=this.ac.currentTime)+7.5,this.lead.play(t),this.counterpoint.play(e),this.bass.play(e),this.kick.play(e),this.pad1.play(e),this.pad2.play(e))},stop:function(){this.ac&&(this.lead.stop(),this.counterpoint.stop(),this.bass.stop(),this.kick.stop(),this.pad1.stop(),this.pad2.stop())},mute:function(){this.ac&&(this.muted?(this.muted=!1,this.output.gain.value=.5):(this.muted=!0,this.output.gain.value=0))},collide:function(t){this.ac&&(this.collision1.stop(),this.collision2.stop(),t?this.collision2.play():this.collision1.play())},createReverb:function(t,e){var i=k.sampleRate,s=i*t,o=this.ac.createBuffer(2,s,i),n=o.getChannelData(0),r=o.getChannelData(1),a=0;for(e||(e=2);s>a;++a)n[a]=(2*Math.random()-1)*Math.pow(1-a/s,e),r[a]=(2*Math.random()-1)*Math.pow(1-a/s,e);return o},bass:new Sequence(k,S,["C2  e","C2  e","C2  e","C2  e","C2  e","C2  e","C2  e","G2  e","G2  e","G2  e","G2  e","G2  e","G2  e","G2  e","G2  e","E2  e","E2  e","E2  e","E2  e","E2  e","E2  e","E2  e","E2  e","G2  e","G2  e","G2  e","G2  e","D2  e","D2  e","D2  e","D2  e","C2  e"]),lead:new Sequence(k,S,["_  e","G4 e","G5 e","G4 e","D5 e","C5 e","B4 e","C5 e","_  e","G4 e","D5 e","E5 e","D5 e","C5 e","B4 e","A4 e","_  e","G4 e","G5 e","G4 e","D5 e","C5 e","B4 e","C5 e","_  e","G4 e","D5 e","E5 e","D5 e","B4 e","A4 e","G4 e"]),counterpoint:new Sequence(k,S,["E4 3","F#4 e","D4 3.5","B3 e","G4 3.5","E4 e","B4 h","A4 q","G4  e","F#4 e","E4 e"]),kick:new Sequence(k,S,["G2 0.01","C2 0.19","-  0.80"]),pad1:new Sequence(k,S,["G3 3.5","G3 4","G3 4","G3 4","G3 0.5"]),pad2:new Sequence(k,S,["C4 3.5","B3 4","E4 4","B3 2","D4 2","C4 0.5"]),collision1:new Sequence(k,220,["G3 s","D4 s","G4 s"]),collision2:new Sequence(k,220,["G4 s","D4 s","G3 s"])};return a.start(),a}))</script>