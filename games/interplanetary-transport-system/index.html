<meta name=monetization content=$ilp.uphold.com/g64DLNdpidDy><meta name=viewport content="width=device-width,maximum-scale=1,user-scalable=0"><title>InterPlanetary Transport System</title><style>*{margin:0;padding:0}body,html{height:100%;width:100%}body{align-items:center;background:#000;bottom:0;display:flex;justify-content:center;left:0;max-height:100vh;max-width:100vw;overflow:hidden;position:fixed;right:0;top:0}body,canvas{touch-action:none}canvas{display:block;font-family:sans-serif;height:100%;image-rendering:-webkit-optimize-contrast;image-rendering:-moz-crisp-edges;image-rendering:-webkit-crisp-edges;image-rendering:pixelated;image-rendering:crisp-edges;object-fit:contain;position:relative;width:100%}</style><canvas id=g></canvas><script>var t,s;(t=self.document)&&!t.getElementById("livereloadscript")&&((s=t.createElement("script")).async=1,s.src="//"+(self.location.host||"localhost").split(":")[0]+":35729/livereload.js?snipver=1",s.id="livereloadscript",t.getElementsByTagName("head")[0].appendChild(s)),function(){function t(t,s,i){return t+i*(s-t)}function s(t,s,i){let h;return i=i??1e-5,t===s?1:(h=Math.abs(t-s),0===t||0===s||K>h?i*K>h:i>h/(Math.abs(t)+Math.abs(s)))}function i(t,s){if(s)return t[0]=s[0],t[1]=s[1],t}function h(t,s,i){return t[0]=s[0]+i[0],t[1]=s[1]+i[1],t}function e(t,s,i){return t[0]=s[0]-i[0],t[1]=s[1]-i[1],t}function n(t,s,i){return t[0]=s[0]*i,t[1]=s[1]*i,t}function r(t,s){const i=s[0],h=s[1];let e=i*i+h*h;return e>0&&(e=1/Math.sqrt(e)),t[0]=s[0]*e,t[1]=s[1]*e,t}function o(t,s){return t[0]*s[0]+t[1]*s[1]}function a(t,s){return Math.hypot(s[0]-t[0],s[1]-t[1])}function c(t,s){const i=s[0]-t[0],h=s[1]-t[1];return i*i+h*h}function l(t,s,i=1){return t[0]=s[1],t[1]=s[0],i?t[1]=-t[1]:t[0]=-t[0],r(t,t)}function u(t){const s=t.t;let i=[0,0];const o=t.i(s),a=h([0,0],o,n(i,r(i,e(i,o,t.position)),J.h)),c=l([0,0],e(i,o,a));n(c,c,J.o);const u=h([0,0],a,c),f=new Y(o,u);return new D(f.l,[J.h/2,J.o/2],s)}function f(t,s){let i=Math.sin(s),h=Math.cos(s);return t[0]=h,t[1]=i,t[2]=-i,t[3]=h,t[4]=0,t[5]=0,t}function d(t,s,i){let h=s[0],e=s[1];return t[0]=i[0]*h+i[2]*e+i[4],t[1]=i[1]*h+i[3]*e+i[5],t}function w(t,s){const i=c(t.position,s.position),h=t.u+s.u;return h*h>i}function p(t,s){const[i,h]=t.position,[e,n]=s.position,[r,o]=s.size;let a=i,c=h;e>i?a=e:i>e+r&&(a=e+r),n>h?c=n:h>n+o&&(c=n+o);let l=new Y([i,h],[a,c]);return t.u*t.u>=l.p}function m(t,s,a){if(t===s)return 0;if(!t.m)return 0;if(w(t,s)){if(a)return 1;let c=[0,0];const l=r([0,0],e(c,t.position,s.position));i(t.position,h([0,0],s.position,n(c,l,t.u+s.u)));const u=o(l,e([0,0],s.m??[0,0],t.m));if(u>=0){const e=n([0,0],l,2*u/(t.M=s.M));i(t.m,n([0,0],h(c,t.m,n(c,e,s.M)),s.g))}return 1}return 0}function x(t,s){return t.S?0:((t,s)=>{const i=e([0,0],t.position,s.position),r=[1,0,0,1,0,0];return f(r,-s.orientation),d(i,i,r),p(new H(h([0,0],i,s.T),t.u),new j([0,0],n([0,0],s.T,2)))})(t,s)?(t.m=[0,0],1):0}function M(t,s){const i=c(t.position,s.position);return 0!==i?J.P*(s.M/i):0}function g(t,s){let i,h,e;for(h of t){let t=-1/0;for(e of s.R){if(h===e)continue;let s=M(h,e);t>s||(t=s,i=e)}h.A&&void 0!==h.L||(h.L=i)}}function v(t,s){if(!t.L||!t.acceleration)return;const o=[0,0];i(t._,t.position),n(t.acceleration,r(o,e(o,t.L.position,t.position)),M(t,t.L)),t.m||(t.m=[0,0]),h(t.m,t.m,n(o,t.acceleration,s)),h(t.position,t.position,n(o,t.m,s))}function S(t,s){let i=t.clone();return n(i.k.position,i.k.position,s),n(i.k.acceleration,i.k.acceleration,s),n(i.k.m,i.k.m,s),i}function b(t){return[(16711680&t)>>16,(65280&t)>>8,255&t]}function T(t,s,i){[t[i],t[s]]=[t[s],t[i]]}function P(t){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(s=>{let i=16*t.random()|0;return("x"==s?i:3&i|8).toString(16)}))}function R(t,s){return`rgba(${t[0]}, ${t[1]}, ${t[2]}, ${s})`}function A(t,s,i,h){t.save(),t.translate(s.position[0],s.position[1]),t.rotate(h),t.translate(-s.position[0],-s.position[1]),t.beginPath(),t.arc(s.position[0],s.position[1],s.u,0,F),t.closePath(),t.fillStyle=i,t.fill(),t.restore()}function L(t,s,i,h=1){t.fillStyle=R(i,h),t.beginPath(),t.arc(s.position[0],s.position[1],s.u,0,F),t.closePath(),t.fill()}function y(t,s,i,h=1){t.lineWidth=h,t.lineCap="round",t.strokeStyle=R(i,1),t.beginPath(),t.moveTo(s.start[0],s.start[1]),t.lineTo(s.end[0],s.end[1]),t.closePath(),t.stroke()}function _(t,s,i,o,a){if(0===J.h)return;y(t,i,a);let c=[0,0];t.save(),t.font="bold 16px sans-serif",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle";const u=t.measureText(s=`  ${s}  `);t.restore(),i.I(-J.o);let f=i.l,d=l([0,0],r(c,e(c,i.start,i.end))),w=h([0,0],f,n(c,d,J.o/1.5+u.width)),p=h([0,0],i.start,n(c,d,u.width)),m=h([0,0],i.end,n(c,d,u.width));t.fillStyle=R(b(W[1]),1),t.beginPath(),t.moveTo(i.start[0],i.start[1]),t.lineTo(p[0],p[1]),t.lineTo(w[0],w[1]),t.lineTo(m[0],m[1]),t.lineTo(i.end[0],i.end[1]),t.closePath(),t.fill(),t.save();const x=new Y(f,new Y(p,m).l).l;t.translate(x[0],x[1]),t.rotate(.5*Math.PI+o),t.translate(-x[0],-x[1]),t.font="bold 18px sans-serif",t.fillStyle="black",t.textAlign="center",t.textBaseline="middle",t.fillText(s,x[0],x[1]),t.restore()}function k(t,s,i,h,{C:e,background:n,text:r}){t.font="normal 12px sans-serif",t.fillStyle=R(n,1),t.fillRect(h[0],h[1],100,20),t.fillStyle=R(e,1),t.fillRect(h[0],h[1],s,20),t.fillStyle=R(r,1),t.strokeStyle="black",t.lineWidth=2,t.strokeText(i,h[0]+108,h[1]+14),t.fillText(i,h[0]+108,h[1]+14)}function E(t){let s=t.G(55,100),i=t.G(3,tt.length),h=[];const e=[...tt];t.O(e);for(let t=0;i>t;t++)h.push(e[t]);return{id:P(t),position:[0,0],u:s,N:h,rotation:t.$(),B:[],F:0,K:0,g:.8}}function I(t,s,i){const o=E(t);o.u=t.H(20,35),o.K=1,o.N=[W[2],W[4]].map((t=>b(t)));const a=r([0,0],e([0,0],o.position,i.position));return n(a,a,i.u+6*o.u),o.position=h([0,0],a,i.position),o}function C(t,s){let i=s.filter((s=>s.id!==t.id));return((t,s)=>{const i=new H(t.position,t.u);for(let t of s)if(w(i,new H(t.position,t.u)))return 1;return 0})(t,i)||((t,s)=>{let i=3*t.u;for(let h of s)if(i>a(t.position,h.position)-h.u)return 1;return 0})(t,i)}function G(t,s,i){s.position=[t.H(i.position[0],i.size[0]),t.H(i.position[1],i.size[1])]}function O(t,s,i,h){const e=a(t.position,s.position)+2*t.u,n=new H(s.position,e);for(let t of i)if(w(new H(t.position,t.u),n))return{U:0};const r=[];for(let t of h)w(new H(t.position,t.u),n)||r.push(t);return{U:1,J:r}}function z(t,s){const i=s[s.length-1],o=new H(i.position,i.u);i.t=t.$();const a=o.i(i.t);return h([0,0],a,n([0,0],r([0,0],e([0,0],a,i.position)),J.h)),i}function N(s,i,o,a,c){let l=`${J.seed}-${i}`;s.q(l);const u=J.D,{Y:f,j:d,bodies:w}=((s,i,e,r,o,a)=>{const c=((t,s,i)=>{if(void 0!==i)return{id:P(t),N:[...i.N],rotation:i.rotation,position:[2*i.u,i.position[1]],u:i.u,B:[],F:0,K:0};const h=E(t),e=t.H(0,h.u),n=t.H(0,h.u);return h.position=[2*h.u+e,2*h.u+n],h})(s,0,a),l=((t,s,i)=>{const h=E(t),e=h.u+J.h;return h.position=[t.H(i[0]-2*e,i[0]-e),t.H(e,i[1]-e)],h})(s,0,i);let u=c.position[0]+2*c.u,f=[];do{let h,n;do{h=E(s);const t=new j([u,2*h.u],[Math.min(u+4*h.u,l.position[0]-l.u),i[1]-2*h.u]);G(s,h,t)}while(C(h,[c,...f,l]));if(s.random()<t(t(.15,.4,o/20),.4,Math.min(e,50)/50)){n=I(s,0,h);let t=O(n,h,[c,l],f.filter((t=>t.id===h.id)));t.U?(f=t.J,h.B=[n.id]):n=void 0}else o=Math.min(20,++o);n?(o=0,u=h.position[0]+Math.abs(h.position[0]-n.position[0])+2*n.u,f.push(h,n)):(u=h.position[0]+2*h.u,f.push(h))}while(l.position[0]>u);if(s.random()<t(t(.1,.5,r/10),.5,Math.min(e,100)/100)){r=0;let t=((t,s)=>{const i=t.H(105,175),e=n([0,0],s,.5);return h(e,e,[t.H(0,i),t.H(0,i)]),{id:P(t),position:e,rotation:t.$(),u:i,B:[],N:[W[2],W[1],W[0]].map((t=>b(t))),F:1,K:0}})(s,i),e=((t,s,i)=>{const h={U:0};if(C(t,s))return h;let e=[];for(let s of i)!C(t,[s])&&e.push(s);return 0===e.length?h:{U:1,J:e}})(t,[c,l],f);if(e.U)return{j:o,Y:r,bodies:[c,...e.J,t,l]}}return{j:o,Y:r=Math.min(10,++r),bodies:[c,...f,l]}})(s,u,i,o,a,c),{spawnPlanet:p,V:m}=((t,s,i)=>{const o=s[0],a=new H(o.position,o.u);let c;const l=i??t.$();return c=a.i(l),h(c,c,n([0,0],r([0,0],e([0,0],c,o.position)),J.W)),{spawnPlanet:o,V:c}})(s,w,c?.t);return{number:i,X:l,Y:f,j:d,size:u,spawn:m,bodies:w,spawnPlanet:p,goalPlanet:z(s,w)}}function $(){st&&!J.muted&&st(...[.6,,438,,.04,.4,2,1.78,,6.8,,,,.3,-6.2,.5,.04,.8,.05])}class B extends class{constructor(){this.Z=[],this.tt=[]}st(t){return this.Z.push(t),{it:()=>this.ht(t)}}once(t){this.tt.push(t)}ht(t){var s=this.Z.indexOf(t);s>-1&&this.Z.splice(s,1)}et(t){if(this.Z.forEach((s=>s(t))),this.tt.length>0){const s=this.tt;this.tt=[],s.forEach((s=>s(t)))}}nt(t){return this.st((s=>t.et(s)))}}{constructor(t){super(),this.rt=0,this.ot=t,window.addEventListener("pointerdown",this.ct.bind(this)),window.addEventListener("pointermove",this.ct.bind(this)),window.addEventListener("pointerup",this.ct.bind(this)),window.addEventListener("blur",this.lt.bind(this))}lt(){this.rt=0}ct(t){this.position=this.ut(this.ot,[t.clientX,t.clientY]),this.rt=!!t.buttons,this.et(this.rt)}ut(t,s){let i=t.getBoundingClientRect();return[t.width/i.width*(s[0]-i.left),t.height/i.height*(s[1]-i.top)]}ft(){return this.rt}}const F=2*Math.PI,K=Math.pow(2,-1022);class H{constructor(t,s){this.position=t,this.u=s}i(t){return[this.position[0]+this.u*Math.cos(t),this.position[1]+this.u*Math.sin(t)]}}class U extends H{constructor(t,s,h=0,e,n,r,o,a){super(t,s),this._=[0,0],i(this._,this.position),this.M=h,this.m=e,this.acceleration=n,this.g=r??.8,this.dt=o??0,this.A=a??0}clone(){return new U(i([0,0],this.position),this.u,this.M,i([0,0],this.m),i([0,0],this.acceleration),this.g,this.dt,this.A)}}const J={D:[1920,1080],wt:164,xt:"g",seed:"HAR-INK-IPTS",Mt:3e3,P:.8,gt:2e3,W:5,vt:0,St:1300,bt:1,h:45,o:18,Tt:50,Pt:125,Rt:1e3,At:[200,25,1334,725],Lt:"HAR-INK-IPTS-",muted:0,yt:2};class q extends U{constructor(t,s,i,h,e,n,r,o,a,c,l,u){super(t,s,s*s*Math.PI*J.Mt,n,r,o,l,u),this.id=i,this.t=a,this.B=c??[],this.F=l??0,this.K=u??0,this.N=h,this.rotation=e}_t(t,s){let h=[0,0];const r=l([0,0],(o=h,c=e(h,t.position,this.position),o[0]=Math.abs(c[0]),o[1]=Math.abs(c[1]),o),s);var o,c;t.L=this,t.acceleration=[0,0],t.m=[0,0],i(t.m,n(h,r,Math.sqrt(J.P*this.M/a(t.position,this.position))))}clone(){let t=new q(i([0,0],this.position),this.u,this.id,[...this.N],this.rotation,this.m,this.acceleration,this.g,this.t,[...this.B],this.F);return t.L=this.L,t}}class D{constructor(t,s,i){this.position=t??[0,0],this.T=s??[1,1],this.orientation=i??0}}class Y{constructor(t,s){this.start=t,this.end=s}I(t){let s=this.end[0]-this.start[0],i=this.end[1]-this.start[1],h=Math.sqrt(s*s+i*i);return h>0&&(s/=h,i/=h),s*=h+t,i*=h+t,this.start[0]=this.start[0]+s,this.start[1]=this.start[1]+i,this}get l(){return[(this.start[0]+this.end[0])/2,(this.start[1]+this.end[1])/2]}get length(){return a(this.start,this.end)}get p(){return c(this.start,this.end)}}class j{constructor(t,s){this.position=t,this.size=s}static kt(t,s){return new j(t,e([0,0],s,t))}get min(){const t=this.position,s=h([0,0],this.position,this.size);return[Math.min(t[0],s[0]),Math.min(t[1],s[1])]}get max(){const t=this.position,s=h([0,0],this.position,this.size);return[Math.max(t[0],s[0]),Math.max(t[1],s[1])]}}class V{constructor({size:t,k:s,R:i,Et:h,spawnPlanet:e,goalPlanet:n}){this.It=[],this.Ct=0,this.size=t,this.k=s,this.R=i,this.Et=h??1,this.spawnPlanet=e,this.goalPlanet=n}static Gt(t){return new q(i([0,0],t.position),t.u,t.id,t.N,t.rotation,i([0,0],t.m),i([0,0],t.acceleration),t.g,t.t,t.B,t.F,t.K)}Ot(){const t=this.goalPlanet.i(this.goalPlanet.t);return h(t,t,n([0,0],r([0,0],e([0,0],t,this.goalPlanet.position)),J.h))}static zt(t,s){i(s.position,t.spawn);const h=new V({Et:t.number,size:t.size,k:s,R:t.bodies.map(V.Gt),spawnPlanet:V.Gt(t.spawnPlanet??t.bodies[0]),goalPlanet:V.Gt(t.goalPlanet??t.bodies[t.bodies.length-1])});for(let t of h.R)try{for(let s of t.B){const i=h.R.find((t=>t.id===s));i&&t._t(i)}}catch{}return h}step(t){this.k.step(),((t,s)=>{g([s.k,...s.R],s),v(s.k,t*J.bt);for(let i of s.R)v(i,t*J.bt)})(t,this);const s=(t=>{let s=0,i=0,h=0,e=t.k,n=t.R;for(let t of n)m(e,t,t.F)&&(s=1,t.F&&(h=1));let r=t.R.filter((t=>void 0!==t.t));for(let h of r)i=x(t.k,u(h)),i&&(s=1);return{Nt:s,$t:i,Bt:h}})(this);return this.k.Ft(),this.It=((t,s)=>{if(!t.k.Kt)return[];let i=t.k.clone();i.Ht();let h=[];for(let e=0;J.Pt>e&&(g([i],t),v(i,s),!m(i,i.L,i.L.dt)||!i.L.dt);e++)h.push([i.position[0],i.position[1]]);return h})(this,t),s}clone(){let t=new V({size:i([0,0],this.size),k:this.k.clone(),R:this.R.map((t=>t.clone())),Et:this.Et,spawnPlanet:this.spawnPlanet.clone(),goalPlanet:this.goalPlanet.clone()});return t.It=[...this.It.map((t=>i([0,0],t)))],t.Ct=this.Ct,t}}const W=[16512495,15913899,13016997,9137564,4803966,2565956];class Q{constructor(t,s){this.ot=t,this.Ut=document.createElement("canvas").getContext("2d"),this.Jt(),this.qt=this.ot.getContext("2d"),this.Dt=s,this.Yt=((t,s,i,h)=>{const e=document.createElement("canvas");e.id="bg",e.width=t,e.height=s;const n=e.getContext("2d"),r=[];for(;h>0;h--)r.push([i.random()*t,i.random()*s,1.2*i.random()]);n.fillStyle=R(b(W[5]),1),n.fillRect(0,0,t,s);for(let t of r??[])n.beginPath(),n.arc(t[0],t[1],t[2],0,360),n.fillStyle=R(b(W[0]),.8),n.fill();return e})(J.D[0],J.D[1],this.Dt,J.gt)}Jt(){this.ot.width=J.D[0],this.ot.height=J.D[1],this.Ut.canvas.width=J.D[0],this.Ut.canvas.height=J.D[1]}jt(t,s){let i=[0,0];t.save();for(let o of s.R??[]){let a;if(o.F)a=t.createRadialGradient(o.position[0],o.position[1],o.u,o.position[0],o.position[1],0),a.addColorStop(0,R(o.N[0],1)),a.addColorStop(.4,R(o.N[1],1)),a.addColorStop(.8,R(o.N[2],1));else{a=t.createLinearGradient(o.position[0]-o.u,o.position[1]-o.u,o.position[0]+o.u,o.position[1]+o.u);for(let t=0;o.N.length>t;t++)a.addColorStop(t/o.N.length,R(o.N[t],1))}if(A(t,o,a,o.rotation),void 0!==o.t){const a=o.i(o.t),c=h([0,0],a,n(i,r(i,e(i,a,o.position)),J.h));_(t,""+s.Et,new Y(a,c),o.t,b(W[2]))}t.restore()}}Vt(t,s){t.save();for(let i=s.k.Wt.length-1;i>0;i--){const h=i/(s.k.Wt.length-1);L(t,new H(s.k.Wt[i],s.k.u),s.k.color,h)}if(s.k.Qt&&s.k.Kt&&s.k.Xt&&s.k.Zt){let i=[0,0];const o=s.k.Zt,a=h(i,o,n(i,s.k.Kt,200*s.k.Xt));((t,s,i)=>{L(t,new H(s.start,3),i);const o=r([0,0],e([0,0],s.end,s.start)),a=f([1,0,0,1,0,0],2.356194490192345),c=f([1,0,0,1,0,0],-2.356194490192345),l=d([0,0],o,a),u=d([0,0],o,c);n(l,l,10),n(u,u,10);const w=new Y(s.end,h([0,0],s.end,l)),p=new Y(s.end,h([0,0],s.end,u));y(t,s,i,3),y(t,w,i,3),y(t,p,i,3)})(t,new Y(o,a),b(W[0])),this.ts(t,s)}t.restore()}ts(t,s){t.save();for(let i of s.It)L(t,new H(i,1),b(W[0]));t.restore()}ss(t,s){t.save();const i=b(W[0]),h={C:b(W[1]),background:b(W[3]),text:i};let e;t.font="normal 32px sans-serif",t.fillStyle=R(i,1),t.strokeStyle="black",t.lineWidth=4,t.textAlign="center",t.textBaseline="middle";let n=J.D[0]/2,r=24;const o=""+s.k.totalLaunches;if(e=t.measureText(o),t.strokeText(o,n,r),t.fillText(o,n,r),n+=e.width+24,s.k.holeLaunches>0){const i=`${s.k.holeLaunches>0?"+":""}${s.k.holeLaunches}`;t.strokeText(i,n,r),t.fillText(i,n,r)}t.restore(),t.save(),n=8,r=J.D[1]-28,k(t,s.k.hs,"slo-mo",[n,r],h),r-=26,k(t,100-s.k.es/s.k.ns*100,"launches",[n,r],h),r-=26;const a=~~(100-s.k.rs/J.Rt*100);100>a&&k(t,a,"respawn",[n,r],h),t.restore()}os(t,s){t.save(),t.restore()}cs(t,s){const i=n([0,0],J.D,.5);t.save();const h=t.createLinearGradient(i[0]-200,i[1]-200,i[0]+200,i[1]+200);h.addColorStop(0,R(b(W[0]),1)),h.addColorStop(.25,R(b(W[1]),1)),h.addColorStop(.65,R(b(W[2]),1)),h.addColorStop(1,R(b(W[3]),1)),A(t,new H(i,400),h,F),t.translate(.5,.5),t.font="bold 38px sans-serif",t.fillStyle=R(b(W[5]),1),t.strokeStyle="black",t.lineWidth=4,t.textAlign="center",t.textBaseline="middle";let e=i[0],r=i[1]-74;t.fillText("INTERPLANETARY TRANSPORT SYSTEM",e,r),r+=44,t.font="italic 32px sans-serif",t.fillText("A JS13K GAME BY",e,r),r+=44,t.font="bold 32px sans-serif",t.fillText("RIK HARINK",e,r),r+=88,t.fillText("CONTROLS MOUSE/TOUCH",e,r),r+=24,t.font="bold 16px sans-serif",t.fillText("M TO MUTE, R TO RESET CURRENT HOLE",e,r),r+=44,t.font="italic 24px sans-serif",t.fillText("CLICK TO START",e,r),t.fillStyle=R(s.k.color,1),t.font="bold 24px sans-serif",t.fillText("https://github.com/rikharink/js13k-2021-space/",e,J.D[1]-24),t.restore()}ls(t,s){const i=this.qt;i.save(),i.drawImage(this.Yt,0,0),s?this.cs(i,t):(this.jt(i,t),this.Vt(i,t),this.ss(i,t),this.os(i,t)),i.restore()}}class X{constructor(t){this.q(t)}q(t){this.us=this.fs(t),this.random()}fs(t){for(var s=0,i=2166136261;t.length>s;s++)i=Math.imul(i^t.charCodeAt(s),16777619);return i+=i<<13,i^=i>>>7,i+=i<<3,i^=i>>>17,(i+=i<<5)>>>0}random(){return this||console.trace(),this.us=Math.imul(48271,this.us),(2**31-1&this.us)/2**31}get ds(){return this.us}set ds(t){this.us=t}H(t,s){return this.random()*(s-t+1)+t}G(t,s){return Math.floor(this.H(Math.ceil(t),Math.floor(s)))}ws(t){return()=>this.G(1,t)}O(t){for(let s=0;t.length-2>s;s++)T(t,s,this.G(s,t.length-1))}ps(t){return t[this.G(0,t.length)]}xs(){return(t=>{let[s,i,h]=t,e=s;return e=(e<<8)+i,e=(e<<8)+h,e})([this.G(0,255),this.G(0,255),this.G(0,255)])}$(){return this.H(0,F)}}class Z{constructor(){this.Ms=0,document.monetization&&("started"!==document.monetization.state&&"stopped"!==document.monetization.state?document.monetization.addEventListener("monetizationstart",this.gs.bind(this)):(this.Ms="started"===document.monetization.state,this.Ms&&this.vs()))}gs(){this.Ms=1,this.vs()}vs(){console.debug("monetization enabled")}}const tt=[W[2],W[3],W[4]].map((t=>b(t)));let st,it,ht;it=.6;class et extends U{constructor(t,s){super([10,10],J.W,J.vt,[0,0],[0,0]),this.color=b(W[0]),this.Ss=0,this.es=0,this.totalLaunches=0,this.holeLaunches=0,this.ns=3,this.bs=4*J.wt,this.Ts=4*J.wt,this.Ps=0,this.Wt=[],this.rs=0,this.Rs=0,this.As=0,this.S=0,this.Ls=0,this.ys=0,this._s=0,this.id=s,this.ks=t}Es(){this.Is()}step(){if(this.Cs&&this.Ls++,this.Ls>30&&(this.Ls=0,this.ys=0,this.es=0,this.Gs=i([0,0],this.position),this.As=0,this.Ts=this.bs),this.es===this.ns&&this.ys++,this.ys>3*J.wt&&(this.es=Math.min(0,this.es-1),this.ys=0),this.Ps?(this.Ts>0||(this.Ps=0,J.bt=1),this.Ts--):(J.bt=1,this.bs>this.Ts&&(this.Ts+=.1)),this.L&&!p(this,new j([0,0],J.D))){this.Rs=1;const t=r([0,0],e([0,0],this.position,this.L.position));o(r([0,0],this.m),t)>0?this.rs++:this.rs=0}else this.rs=0,this.Rs=0;this.rs>J.Rt&&(this.rs=0,$(),i(this.position,this.Gs),this.m=[0,0])}Os(){this.totalLaunches+=this.holeLaunches,this.holeLaunches=0}get hs(){return~~(this.Ts/this.bs*100)}get Cs(){return!(!s((t=this.position)[0],(i=this._)[0],h)||!s(t[1],i[1],h));var t,i,h}get Qt(){return this.ns>this.es}Ft(t){t??1?(this.Wt.push(i([0,0],this.position)),this.Wt.length>J.Tt&&this.Wt.shift()):this.Wt=[i([0,0],this.position),i([0,0],this.position)]}Is(){if(!this._s)return;if(!this.Qt)return void(J.bt=1);const t=this.ks.ft();var s,h,n;!this.Ss&&t?(this.Kt=[0,0],this.Zt=i([0,0],this.ks.position),1>this.es||(J.bt=.1,this.Ps=1)):this.Ss&&!t?(this.Ht(),st&&!J.muted&&st(...[.8,,250,.01,,.01,,.2,-.2,-4,-50,-.32,.01,,,,.09,.98,.04,.06])):this.ks.position&&this.Zt&&(h=this.Kt,n=r(this.Kt,e(this.Kt,this.ks.position,this.Zt)),h[0]=-n[0],h[1]=-n[1],this.Xt=(s=a(this.Zt,this.ks.position),Math.max(0,Math.min(100,s))/100)),this.Ss=t}Ht(){n(this.m,this.Kt,J.St*this.Xt*(this.Ps?.5:1)),this.Zt=void 0,this.Kt=void 0,this.Xt=void 0,this.es++,this.holeLaunches++,this.Ps=0,this.As=1}clone(){let t=new et(this.ks,this.id);return t.L=this.L?.clone(),t.position=i([0,0],this.position),t._=i([0,0],this._),t.m=i([0,0],this.m),t.acceleration=i([0,0],this.acceleration),t.Ss=this.Ss,t.Kt=i([0,0],this.Kt),t.Xt=this.Xt,t.totalLaunches=this.totalLaunches,t.holeLaunches=this.holeLaunches,t.es=this.es,t.Zt=i([0,0],this.Zt),t.ns=this.ns,t.Ts=this.Ts,t.Wt=this.Wt.map((t=>i([0,0],t))),t.Rs=this.Rs,t.rs=this.rs,t._s=this._s,t.As=this.As,t.S=this.S,t}}let nt=new class{constructor(){this.zs=60,this.isActive=0,this.Ns=0,this.$s=0,this.Bs=0,this.Fs=0,this.Ks=1,this.Hs=void 0,this.Us=void 0,this.Js=0,this.qs=0,this.Ct=0,this.Ds=1,this.Ys=document.getElementById(J.xt),this.js=new B(this.Ys),this.Vs=new Z,this.Dt=new X(J.seed),this.Ws=new Q(this.Ys,this.Dt),window.addEventListener("focus",this.start.bind(this)),window.addEventListener("blur",this.stop.bind(this)),this.Qs()||this.Xs(N(this.Dt,this.Ks,0,0)),this.currentState.k._s=!this.Ds,document.addEventListener("pointerup",this.Zs.bind(this))}Zs(){this.Ds=0,this.currentState.k._s=1,this.ti(),st||(ht=new(window.AudioContext||webkitAudioContext),st=(t=1,s=.05,i=220,h=0,e=0,n=.1,r=0,o=1,a=0,c=0,l=0,u=0,f=0,d=0,w=0,p=0,m=0,x=1,M=0,g=0)=>{let v,S,b=Math,T=44100,P=2*b.PI,R=a*=500*P/T/T,A=i*=(1-s+2*s*b.random(s=[]))*P/T,L=0,y=0,_=0,k=1,E=0,I=0,C=0;for(c*=500*P/T**3,w*=P/T,l*=P/T,u*=T,f=T*f|0,S=(h=T*h+9)+(M*=T)+(e*=T)+(n*=T)+(m*=T)|0;S>_;s[_++]=C)++I%(100*p|0)||(C=r?r>1?r>2?r>3?b.sin((L%P)**3):b.max(b.min(b.tan(L),1),-1):1-(2*L/P%2+2)%2:1-4*b.abs(b.round(L/P)-L/P):b.sin(L),C=(f?1-g+g*b.sin(P*_/f):1)*(C>0?1:-1)*b.abs(C)**o*t*.6*(h>_?_/h:h+M>_?1-(_-h)/M*(1-x):h+M+e>_?x:S-m>_?(S-_-m)/n*x:0),C=m?C/2+(m>_?0:(S-m>_?1:(S-_)/m)*s[_-m|0]/2):C),v=(i+=a+=c)*b.cos(w*y++),L+=v-v*d*(1-1e9*(b.sin(_)+1)%2),k&&++k>u&&(i+=l,A+=l,k=0),!f||++E%f||(i=A,a=R,k=k||1);return(t=ht.createBuffer(1,S,T)).getChannelData(0).set(s),(i=ht.createBufferSource()).buffer=t,i.connect(ht.destination),i.start(),i})}reset(){localStorage.removeItem(J.Lt+"STATE"),this.currentState=void 0,this.Ds=1,this.Dt=new X(J.seed),this.Ks=1,this.Xs(N(this.Dt,this.Ks,0,0))}Xs(t){this.Dt.q(t.X),this.Ks=t.number,this.si=t;const s=this.currentState?.k??new et(this.js,P(this.Dt));this.currentState=V.zt(t,s),this.ii=this.currentState}hi(){this.currentState.k.m=[0,0],this.currentState.k.acceleration=[0,0],i(this.currentState.k.position,this.currentState.k.Gs)}Qs(){try{const t=localStorage.getItem(J.Lt+"STATE");if(t){const s=JSON.parse(t);if(s)return s.v!==J.yt?0:(this.Ds=s.Ds,this.Xs(s.level),this.currentState.k.totalLaunches=s.totalLaunches,this.currentState.k.holeLaunches=s.holeLaunches,s.position&&(this.currentState.k.position=s.position),this.currentState.k._s=!s.Ds,1)}}catch(t){console.error(t)}return 0}ti(){localStorage.setItem(J.Lt+"STATE",JSON.stringify({v:J.yt,level:this.si,holeLaunches:this.currentState.k.holeLaunches,totalLaunches:this.currentState.k.totalLaunches,position:this.currentState.k.Gs,Ds:this.Ds}))}start(){void 0===this.ei&&(this.ei=requestAnimationFrame(this.ni.bind(this)),this.isActive=1)}stop(){this.ei&&cancelAnimationFrame(this.ei),this.ei=void 0,this.isActive=0,this.Ds=1}ri(t){let s=.001*t;return this.Ns=s-this.Bs,this.Bs=s,this.$s+=this.Ns,this.zs=.9*this.zs+1/this.Ns*(1-.9),1>this.$s||(this.$s=0),s}oi(){this.Us=N(this.Dt,++this.Ks,this.si.Y,this.si.j,this.si.goalPlanet),this.Hs=(t=>{this.Js=0,this.qs=0,this.Hs=void 0,this.Us=void 0,this.currentState.k.Os(),this.currentState.k.position=i([0,0],t.spawn),this.currentState.k._s=1,J.h=45,this.Xs(t)}).bind(this)}ai(){console.debug(JSON.stringify(this.si))}ci(){this.currentState.k.S=1,this.currentState.step(1/J.wt),this.Js=this.currentState.k.Cs}li(){J.h--,J.h>0||(this.qs=1)}ui(){this.currentState.R[this.currentState.R.length-1].position[0]>this.Us.spawnPlanet.position[0]?(this.currentState.k.position[0]=this.currentState.k.position[0]-3,this.currentState.k.Ft(0),this.currentState.R.forEach((t=>t.position[0]=~~(t.position[0]-3)))):this.Hs(this.Us)}ni(t){if(this.ei=requestAnimationFrame(this.ni.bind(this)),t=this.ri(t),1>=this.Ns){if(!this.Ds)for(this.currentState.k.Es(),this.Fs+=this.Ns,this.Fs+=this.Ns;this.Fs>=1/J.wt;){if(this.ii=this.currentState.clone(),this.Hs&&this.Us)this.Js?this.qs?this.ui():(this.currentState.k.S=0,this.li()):this.ci();else{const{$t:s,Bt:h,Nt:e}=this.currentState.step(1/J.wt);if(s)st&&!J.muted&&st(...[.8,,158,,.2,.55,1,1.53,.7,3,-104,.08,.09,,,.1,,.77,.09,.19]),this.currentState.k._s=0,i(this.currentState.k.m,[0,0]),this.ti(),this.oi();else if(h)$(),this.hi();else if(e){const s=t-this.Ct;this.currentState.k.As&&s>.05&&(this.Ct=t,st&&!J.muted&&st(...[,.15,261.6256,.03,,.08,,1.2,-.2,-.1,-50,,-.01,-.2,,,,1.1,,.17]))}}this.Fs-=1/J.wt,t+=this.Ns}this.Ws.ls((s=this.ii,((t,s)=>{let i=s.clone();return h(i.k.position,t.k.position,s.k.position),h(i.k.acceleration,t.k.acceleration,s.k.acceleration),h(i.k.m,t.k.m,s.k.m),i})(S(this.currentState,e=this.Fs/this.Ns),S(s,1-e))),this.Ds)}var s,e}};nt.start(),setInterval((()=>{nt.ti()}),1e4),window.addEventListener("unload",(()=>{nt.ti()})),window.addEventListener("keypress",(t=>{"r"===t.key?nt.hi():"m"===t.key?J.muted=!J.muted:"n"===t.key?nt.oi():"k"===t.key&&nt.reset()}))}()</script>