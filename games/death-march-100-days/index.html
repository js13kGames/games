<!doctype html><title>Death March 100 days</title><script>function getRandom(t,e){return t+Math.floor(Math.random()*(e-t+1))}var Timer=function(t,e,i){var n,o=function(){t(i),--i>=0?n=setTimeout(o,1e3):e()};this.start=o,this.stop=function(){clearTimeout(n)},this.pause=function(t){this.stop(),setTimeout(o,1e3*t)},this.stopWithDelay=function(t){i=t}},Timer2=function(t,e,i){var n=function(){t()?setTimeout(n,i):e()};this.start=n},Cascade=function(t){var e=0,i=t[e].f,n=t[e].i,o=function(){if(i())setTimeout(o,n);else{if(e==t.length-1)return!1;e++,i=t[e].f,n=t[e].i}};this.start=o},bitmap0=[[1,1,1],[1,0,1],[1,0,1],[1,0,1],[1,1,1]],bitmap1=[[0,1,0],[0,1,0],[0,1,0],[0,1,0],[0,1,0]],bitmap2=[[1,1,1],[0,0,1],[1,1,1],[1,0,0],[1,1,1]],bitmap3=[[1,1,1],[0,0,1],[1,1,1],[0,0,1],[1,1,1]],bitmap4=[[1,0,1],[1,0,1],[1,1,1],[0,0,1],[0,0,1]],bitmap5=[[1,1,1],[1,0,0],[1,1,1],[0,0,1],[1,1,1]],bitmap6=[[1,1,1],[1,0,0],[1,1,1],[1,0,1],[1,1,1]],bitmap7=[[1,1,1],[1,0,1],[1,0,1],[0,0,1],[0,0,1]],bitmap8=[[1,1,1],[1,0,1],[1,1,1],[1,0,1],[1,1,1]],bitmap9=[[1,1,1],[1,0,1],[1,1,1],[0,0,1],[1,1,1]],screen_w=1200;screen_h=600;var canvas,ctx,timer,block_h=30,bitmaps=[bitmap0,bitmap1,bitmap2,bitmap3,bitmap4,bitmap5,bitmap6,bitmap7,bitmap8,bitmap9],interval=10,blocks=[],Block=function(t,e,i,n,o,a){var c,s=o;this.vx=a,this.x=t,this.y=e,this.w=i,this.h=n;var r=0;this.draw=function(){if(!(this.x-mainchar.x>screen_w||mainchar.x-this.x>screen_w))if(r<s?(r++,this.x=this.x+this.vx):(this.vx=-this.vx,r=0),c){var t=this.x-mainchar.x+offset_x,e=(canvas.width,this.y-mainchar.y+offset_y);canvas.height,screen_h;ctx.putImageData(c,t,e)}else ctx.fillStyle="#000",ctx.fillRect(this.x-mainchar.x,this.y-mainchar.y,this.w,this.h),ctx.fillStyle="#fff",ctx.fillText(0==this.x?"kick off":"task",this.x-mainchar.x+10,this.y-mainchar.y+20)},this.moveX=function(t){this.x=this.x+t},this.moveY=function(t){this.y=this.y+t},this.setImg=function(t){c=t},this.checkTouch=function(t,e){return!(t.x+t.w<this.x||this.x+this.w<t.x)&&(t.y+t.h<=this.y&&t.y+t.h+e>=this.y?(t.y=this.y-t.h,!0):(t.y>this.y+this.h&&(t.y,this.y,this.h),!1))}},vo=0,x=0;t=0;var v=0;vh=0;var partner,bed_block,flying=!1,muststop=!1,loop=function(){flying||(1==kCode[39]&&(v=10),1==kCode[37]&&(v=-10),0==kCode[39]&&0==kCode[37]&&(v=0),1==kCode[38]&&(flying=!0,t=0,vo=-15)),draw(),muststop||(timer=setTimeout(loop,interval))},i=0,j=0,test_str=0,bed_set=!1,timers=[],lines=[],line=function(t){var e=50*t;return function(){e-mainchar.x>1200||mainchar.x-e>1200||(ctx.beginPath(),ctx.lineWidth=1,ctx.strokeStyle="#000",ctx.moveTo(e-mainchar.x,-offset_y),ctx.lineTo(e-mainchar.x,screen_h-offset_y),ctx.stroke(),ctx.fillStyle="#000",ctx.font="italic bold 20px Times New Roman",ctx.fillText("day ",e-mainchar.x+8,30-offset_y),ctx.fillText(t,e-mainchar.x+12,50-offset_y))}},deadline=function(t,e,i,n,o){var a="dead line",c="#f00";n&&(a=n),o&&(c=o);var s=new Timer((function(){i--}),(function(){for(var e=0,i=animations.length;e<i;e++)if(animations[e]==r){animations.splice(e,1);break}mainchar.x<t&&(console.log("over..."),stop("You missed the deadline!"))}),i);timers.push(s),s.start();var r=function(){t-mainchar.x>1200||(ctx.fillStyle=c,ctx.beginPath(),ctx.arc(t-mainchar.x,30-offset_y,30,0,2*Math.PI,!1),ctx.fill(),ctx.fillStyle="#fff",ctx.font="italic bold 55px Times New Roman",ctx.fillText(i,t-mainchar.x-(i>=10?27:17),50-offset_y),ctx.fillStyle=c,ctx.font="italic bold 20px Times New Roman",ctx.fillText(a,t-mainchar.x+30,70-offset_y),ctx.beginPath(),ctx.lineWidth=4,ctx.strokeStyle=c,ctx.moveTo(t-mainchar.x,60-offset_y),ctx.lineTo(t-mainchar.x,screen_h-offset_y),ctx.stroke())};return r};function drawHorizon(){ctx.beginPath(),ctx.lineWidth=4,ctx.strokeStyle="#000",ctx.moveTo(-offset_x,2100-mainchar.y),ctx.lineTo(screen_w-offset_x,2100-mainchar.y),ctx.stroke()}var h,m,s,mainchar,offset_x,offset_y,bed,sleeping,animations=[];function draw(){if(getTime(),ctx.clearRect(-offset_x,-offset_y,screen_w,screen_h),lines.forEach((function(t){t()})),animations.forEach((function(t){t()})),blocks.forEach((function(t){t.draw()})),!bed_set&&mainchar.y>=1500){var e=-(i=vo+1*t)+Math.sqrt(i*i+1e3);(bed_block=new Block(mainchar.x+v*e-100,2e3,200,100,0,0)).setImg(bed),blocks.push(bed_block),drawHorizon(),bed_set=!0}if(partner&&partner==bed_block)return drawHorizon(),ctx.clearRect(0,0,40,80),ctx.putImageData(sleeping,offset_x-120,offset_y+80),void stop("You dropped out!");if(partner&&mainchar.moveX(partner.vx),mainchar.moveX(v),mainchar.x>=5e3)stop("Project Complete!");else if(flying){var i=vo+1*t;t+=.5,mainchar.moveY(i);for(var n=0;n<blocks.length;n++)if(mainchar!=blocks[n]&&blocks[n].checkTouch(mainchar,i)){flying=!1,partner=blocks[n];break}}else(mainchar.x+mainchar.w<partner.x||partner.x+partner.w<mainchar.x)&&(partner=null),partner||(flying=!0,vo=0,t=0)}function stop(t){muststop=!0,animations=[],clearTimeout(timer),console.log("game over"),blocks=[],timers.forEach((function(t){t.stop()})),timers=[],ctx.setTransform(1,0,0,1,0,0),ctx.fillStyle="#000",ctx.fillRect(200,50,650,240),ctx.fillStyle="#fff",ctx.font="italic bold 40px Times New Roman",ctx.fillText(t,270,120),buttons.push(new Button("replay",300,220,jumpTo(game,temp_level))),buttons.push(new Button("menu",600,220,(function(){window.location.reload()}))),buttons.forEach((function(t){t.draw()}))}function start(){loop(),$("#btn_start").attr("disabled",!0),$("#btn_stop").attr("disabled",!1)}function getTime(){var t=new Date;h=t.getHours(),m=t.getMinutes(),s=t.getSeconds()}function drawNum(t){ctx.fillStyle="rgb(0, 0, 0)";for(var e=bitmaps[t],i=0;i<5;i++)for(var n=0;n<3;n++)1==e[i][n]&&ctx.fillRect(10*n,10*i,10,10)}var buttons=[],Button=function(t,e,i,n){this.padding=20,this.height=45,ctx.font="italic bold 55px Times New Roman",this.width=ctx.measureText(t).width,this.txt=t,this.draw=function(){ctx.fillStyle="rgb(200, 0, 0)",ctx.fillRect(e-this.padding,i-this.height-this.padding,this.width+2*this.padding,this.height+2*this.padding),ctx.fillStyle="#fff",ctx.fillText(t,e,i)},this.include=function(t,n){return t=screen_w*t/canvas.width,n=screen_h*n/canvas.height,t>=e-this.padding&&t<=e+this.width+this.padding&&n>=i-this.height-this.padding&&n<=i+this.padding},this.click=n};window.onload=function(){if(!(canvas=document.getElementById("canvas"))||!canvas.getContext)return!1;ctx=canvas.getContext("2d"),canvas.width=1200,canvas.height=600,canvas.onmousemove=function(t){t.hasOwnProperty("offsetX")||(t.offsetX=t.layerX-t.currentTarget.offsetLeft,t.offsetY=t.layerY-t.currentTarget.offsetTop);for(var e=0;e<buttons.length;e++)if(buttons[e].include(t.offsetX,t.offsetY))return void(document.body.style.cursor="pointer");document.body.style.cursor="default"},canvas.onmousedown=function(t){t.hasOwnProperty("offsetX")||(t.offsetX=t.layerX-t.currentTarget.offsetLeft,t.offsetY=t.layerY-t.currentTarget.offsetTop);for(var e=0;e<buttons.length;e++)if(buttons[e].include(t.offsetX,t.offsetY))return void buttons[e].click()},menu()};var fadeout=function(){for(var t=50,e=screen_w/t,i=screen_h/t,n=e*i,o=[],a=1;a<=n;a++)o.push(a);return function(){var i=getRandom(1,o.length)-1,n=o[i],a=n%e,c=parseInt(n/e);return ctx.fillStyle="#fff",ctx.fillRect(t*a,t*c,t,t),o.splice(i,1),o.length>0}}();function jumpTo(t,e){return function(){buttons=[],new Timer2(fadeout,(function(){t(e)}),10).start()}}var temp_level,menu=function(){ctx.fillStyle="#000",ctx.font="italic bold 30px Times New Roman",ctx.fillText("<Operations>",400,50),ctx.fillText("up         cursor : jump",400,80),ctx.fillText("left/right cursor : move to left/right",400,110),buttons.push(new Button("Assistant Level",430,250,jumpTo(game,1))),buttons.push(new Button("Member Level",430,380,jumpTo(game,2))),buttons.push(new Button("Manager Level",430,510,jumpTo(game,3))),buttons.forEach((function(t){t.draw()}))},game=function(t){temp_level=t,muststop=!1,bed_set=!1,flying=!1,ctx.clearRect(0,0,1200,600),partner=new Block(0,200,300,30,0,0),blocks.push(partner),lines=[];for(var e=0;e<100;e++)lines.push(line(e));var i=partner;do{var n=getRandom(50,400),o=i.x+i.w+getRandom(50,100),a=1==getRandom(0,1)?-1:1,c=i.y+a*getRandom(block_h,200),s=getRandom(180,400);i=new Block(o,c,n,block_h,s*t,1),blocks.push(i)}while(i.x+i.w<5e3);ctx.fillStyle="rgb(30, 40, 50)",ctx.strokeStyle="#000",ctx.lineWidth=1,ctx.beginPath(),ctx.arc(20,20,20,0,2*Math.PI,!1),ctx.stroke(),ctx.beginPath(),ctx.moveTo(20,40),ctx.lineTo(20,60),ctx.moveTo(20,60),ctx.lineTo(0,80),ctx.moveTo(20,60),ctx.lineTo(40,80),ctx.moveTo(0,50),ctx.lineTo(40,50),ctx.stroke();var r=ctx.getImageData(0,0,40*canvas.width/screen_w,80*canvas.height/screen_h);ctx.clearRect(0,0,200,100),ctx.fillStyle="#000",ctx.fillRect(0,50,180,50),ctx.clearRect(20,70,160,30),ctx.fillRect(180,0,20,100),bed=ctx.getImageData(0,0,200,100),ctx.clearRect(0,0,180,40),ctx.beginPath(),ctx.arc(160,20,20,0,2*Math.PI,!1),ctx.stroke(),ctx.beginPath(),ctx.moveTo(140,20),ctx.lineTo(70,20),ctx.lineTo(35,0),ctx.lineTo(0,40),ctx.moveTo(70,20),ctx.lineTo(70,0),ctx.lineTo(0,20),ctx.moveTo(130,40),ctx.lineTo(90,40),ctx.lineTo(130,20),ctx.lineTo(90,0),ctx.stroke(),sleeping=ctx.getImageData(0,0,180,40),(mainchar=new Block(0,200-r.height,r.width,r.height,0,0)).setImg(r),blocks.push(mainchar),offset_x=screen_w/2-r.width/2,offset_y=screen_h/2-r.height/2,ctx.translate(offset_x,offset_y);for(e=1;e<=9;e++)animations.push(deadline(500*e,10,10*e));animations.push(deadline(5e3,10,100,"goal!","#000")),loop()};for(kCode=new Array(256),i=0;i<256;i++)kCode[i]=0;function getKeyCode(t){return document.all?t.keyCode:document.getElementById?t.keyCode?t.keyCode:t.charCode:document.layers?t.which:void 0}document.onkeydown=function(t){kCode[getKeyCode(t)]=1},document.onkeyup=function(t){kCode[getKeyCode(t)]=0}</script><div style="text-align:center;font:italic bold 60px Times New Roman"><b>Death March 100 days</b></div><div style="width:1200px;height:600px;text-align:center;margin-left:auto;margin-right:auto;border:solid thick #000"><canvas id=canvas></canvas></div>