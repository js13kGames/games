<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta name="viewport" content="width=650,user-scalable=no"><meta name="theme-color" content="#333"><title>SnAkE</title><style>body{background:#333;margin:0}html.mobile{overflow-x:hidden;overflow-y:scroll}.mobile body{min-height:1100px;overflow:hidden}.screen-wrapper{width:650px;margin:0 auto;overflow:hidden}.screen{width:600px;height:600px;margin:50px auto;position:relative;border-radius:65px;background:#9c3}#c,.glare{position:absolute;top:0}.tron .screen{background:#003}.screen:after,.screen:before{content:'';overflow:hidden;position:absolute;left:0;top:0;width:100%;height:100%;background:radial-gradient(farthest-corner at -300px -300px,rgba(255,255,255,0) 0,rgba(255,255,255,.05) 76%,rgba(0,0,0,.05) 76%,rgba(0,0,0,0) 100%);background-color:inherit;border-radius:100%;-webkit-transform:scaleX(4) scaleY(1.02);transform:scaleX(4) scaleY(1.02);clip:rect(0,360px,650px,240px);z-index:-1}.glare,canvas{border-radius:65px}.screen:after{-webkit-transform:scaleY(4) scaleX(1.02) rotate(-90deg);transform:scaleY(4) scaleX(1.02) rotate(-90deg)}canvas{width:600px;height:600px;display:block;margin:0 auto}.glare{width:100%;height:100%;z-index:1;background:radial-gradient(farthest-corner at -300px -300px,rgba(255,255,255,0) 0,rgba(255,255,255,.05) 76%,rgba(0,0,0,.05) 76%,rgba(0,0,0,0) 100%)}.controls{width:600px;margin:0 auto;position:relative;top:-300px;z-index:2;display:none}.controls.mini{position:relative;top:-700px}.mobile .controls{display:block}.controls button{background:rgba(255,255,255,.1);border:none;display:block;width:300px;height:300px;position:absolute;z-index:2;border-radius:100%}.mini button{width:100px;height:100px}.controls button:focus{outline:0}.controls button.active,.controls button.on,.controls.hint button{background-color:rgba(255,255,255,.2);outline:0}.controls button[data-action=up]{top:0;left:150px}.controls button[data-action=down]{top:350px;left:150px}.controls button[data-action=left]{top:175px;left:-100px}.controls button[data-action=right]{top:175px;left:400px}.controls button[data-action=mute]{right:0;background-position:50% 50%;background-size:70px 80px;background-repeat:no-repeat;background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMDAgNDAwIiBzdHJva2U9IiMwMDAiIGZpbGwtb3BhY2l0eT0iMC43IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGNvbG9yLWludGVycG9sYXRpb249ImF1dG8iIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiIGZvbnQtZmFtaWx5PSInRGlhbG9nJyIgZm9udC1zaXplPSIxMiI+PHBhdGggc3Ryb2tlPSJub25lIiBkPSJNMjY2LjggMTk4LjdxMCA2NC44LTQ0IDEyMC41bC0xMC4yLThxNDEuMi01MSA0MS4yLTExMi41IDAtNjAuMi00MS0xMTIuNGwxMC4yLThxNDMuOCA1NS42IDQzLjggMTIwLjR6bS0zMSAwcTAgNTQtMzYuMyAxMDEuM2wtMTAuMi03LjhxMzMuNi00NCAzMy42LTkzLjUgMC00OS40LTM0LTkzLjRsMTAuMi03LjdxMzYuMyA0Ni41IDM2LjMgMTAxem0tMzEgMHEwIDQyLjYtMjguNyA4MmwtMTAtNy43cTI2LTM1IDI2LTc0IDAtMzguNC0yNi4yLTc0LjRMMTc2IDExN3EyOSAzOS41IDI5IDgyek0xMzYuMiAzMDFsLTY2LTYxSDI4di04Mi41aDQybDY2LTYxVjMwMXoiLz48L3N2Zz4=)}.controls button[data-action=mute].on{background-image:url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCAzMDAgNDAwIiBzdHJva2U9IiMwMDAiIGZpbGwtb3BhY2l0eT0iMC43IiBzdHJva2UtbWl0ZXJsaW1pdD0iMTAiIGNvbG9yLWludGVycG9sYXRpb249ImF1dG8iIHN0cm9rZS1saW5lY2FwPSJzcXVhcmUiIGZvbnQtZmFtaWx5PSInRGlhbG9nJyIgZm9udC1zaXplPSIxMiI+PHBhdGggc3Ryb2tlPSJub25lIiBkPSJNMjQ3LjYgMzA1LjdsLTExLjggMTEuOC02NS42LTY1LjZ2NDlMMTA0IDI0MEg2MnYtODIuNWgxNGwtNzYtNzYgMTEuOC0xMS44IDg3LjggODcuOGg0LjVsNjYuMy02MXYxMzEuN2w3Ny40IDc3LjV6Ii8+PC9zdmc+);background-position:20px 50%}</style></head><body><div class="screen-wrapper"><div id="s" class="screen"><canvas id="bg"></canvas><canvas id="c"></canvas><div class="glare"></div></div></div><div class="controls" id="buttons"><button data-action="up"></button> <button data-action="down"></button> <button data-action="left"></button> <button data-action="right"></button></div><div class="controls mini"><button data-action="mute"></button></div><script>function SfxrParams(){this.setSettings=function(t){for(var e=0;e<24;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(i<.18){var a=.18/i;this.b*=a,this.c*=a,this.e*=a}}}function SfxrSynth(){this._params=new SfxrParams;var t,e,i,a,s,n,o,h,r,l,d,c;this.reset=function(){var t=this._params;a=100/(t.f*t.f+.001),s=100/(t.g*t.g+.001),n=1-t.h*t.h*t.h*.01,o=-t.i*t.i*t.i*1e-6,t.a||(d=.5-t.n/2,c=5e-5*-t.o),h=1+t.l*t.l*(t.l>0?-.9:10),r=0,l=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var a=this._params;return t=a.b*a.b*1e5,e=a.c*a.c*1e5,i=a.e*a.e*1e5+12,3*((t+e+i)/3|0)},this.synthWave=function(u,f){var g=this._params,k=1!=g.s||g.v,p=g.v*g.v*.1,b=1+3e-4*g.w,m=g.s*g.s*g.s*.1,S=1+1e-4*g.t,v=1!=g.s,y=g.x*g.x,x=g.g,B=g.q||g.r,L=g.r*g.r*g.r*.2,w=g.q*g.q*(g.q<0?-1020:1020),H=g.p?((1-g.p)*(1-g.p)*2e4|0)+32:0,C=g.d,G=g.j/2,E=g.k*g.k*.01,I=g.a,T=t,W=1/t,_=1/e,R=1/i,j=5/(1+g.u*g.u*20)*(.01+m);j>.8&&(j=.8),j=1-j;for(var M,F,P,O,U,A,z=!1,V=0,N=0,D=0,q=0,K=0,J=0,Q=0,X=0,Y=0,Z=0,$=new Array(1024),tt=new Array(32),et=$.length;et--;)$[et]=0;for(var et=tt.length;et--;)tt[et]=2*Math.random()-1;for(var et=0;et<f;et++){if(z)return et;if(H&&++Y>=H&&(Y=0,this.reset()),l&&++r>=l&&(l=0,a*=h),n+=o,a*=n,a>s&&(a=s,x>0&&(z=!0)),F=a,G>0&&(Z+=E,F*=1+Math.sin(Z)*G),F|=0,F<8&&(F=8),I||(d+=c,d<0?d=0:d>.5&&(d=.5)),++N>T)switch(N=0,++V){case 1:T=e;break;case 2:T=i}switch(V){case 0:D=N*W;break;case 1:D=1+2*(1-N*_)*C;break;case 2:D=1-N*R;break;case 3:D=0,z=!0}B&&(w+=L,P=0|w,P<0?P=-P:P>1023&&(P=1023)),k&&b&&(p*=b,p<1e-5?p=1e-5:p>.1&&(p=.1)),A=0;for(var it=8;it--;){if(Q++,Q>=F&&(Q%=F,3==I))for(var at=tt.length;at--;)tt[at]=2*Math.random()-1;switch(I){case 0:U=Q/F<d?.5:-.5;break;case 1:U=1-Q/F*2;break;case 2:O=Q/F,O=6.28318531*(O>.5?O-1:O),U=1.27323954*O+.405284735*O*O*(O<0?1:-1),U=.225*((U<0?-1:1)*U*U-U)+U;break;case 3:U=tt[Math.abs(32*Q/F|0)]}k&&(M=J,m*=S,m<0?m=0:m>.1&&(m=.1),v?(K+=(U-J)*m,K*=j):(J=U,K=0),J+=K,q+=J-M,q*=1-p,U=q),B&&($[X%1024]=U,U+=$[(X-P+1024)%1024],X++),A+=U}A*=.125*D*y,u[et]=A>=1?32767:A<=-1?-32768:32767*A|0}return f}}var synth=new SfxrSynth;window.jsfxr=function(t){synth._params.setSettings(t);var e=synth.totalReset(),i=new Uint8Array(4*((e+1)/2|0)+44),a=2*synth.synthWave(new Uint16Array(i.buffer,44),e),s=new Uint32Array(i.buffer,0,44);s[0]=1179011410,s[1]=a+36,s[2]=1163280727,s[3]=544501094,s[4]=16,s[5]=65537,s[6]=44100,s[7]=88200,s[8]=1048578,s[9]=1635017060,s[10]=a,a+=44;for(var n=0,o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="data:audio/wav;base64,";n<a;n+=3){var r=i[n]<<16|i[n+1]<<8|i[n+2];h+=o[r>>18]+o[r>>12&63]+o[r>>6&63]+o[63&r]}return h};var Snake=Snake||{};Snake.Sound={isMuted:!1},Snake.Sound.sounds={snakeEatFood:[jsfxr([1,,.1114,,.1243,.4982,,,,,,,,,,,,,1,,,.1,,.5]),jsfxr([0,,.1173,,.1651,.4355,,,,,,,,.0803,,,,,1,,,.1,,.5]),jsfxr([1,,.1414,,.1505,.4521,,,,,,,,,,,,,1,,,.1,,.5]),jsfxr([0,,.1663,,.1741,.5703,,,,,,,,.0332,,,,,1,,,.1,,.5]),jsfxr([1,,.1717,,.0341,.48,,,,,,,,,,,,,1,,,.1,,.5])],tronEatFood:[jsfxr([0,,.1142,,.1895,.2463,,,,,,,,.4806,,,,,1,,,.1,,.5]),jsfxr([1,,.1594,,.1926,.2107,,,,,,,,,,,,,1,,,.1,,.5]),jsfxr([1,,.1112,,.158,.2041,,,,,,,,,,,,,1,,,.1,,.5]),jsfxr([0,,.1896,,.1158,.22,,,,,,,,.4539,,,,,1,,,.1,,.5]),jsfxr([0,,.1823,,.0669,.3637,,,,,,,,.0958,,,,,1,,,.1,,.5])],enterTronMode:[jsfxr([0,,.0864,,.4458,.2053,,.3603,,,,,,.2349,,.4484,,,1,,,,,.5]),jsfxr([0,,.2012,,.4803,.2939,,.326,,,,,,.525,,.6112,,,1,,,,,.5]),jsfxr([0,,.2424,,.2184,.2631,,.2023,,,,,,.2315,,,,,1,,,,,.5]),jsfxr([0,,.0429,,.4426,.5,,.2284,,,,,,.1798,,,,,1,,,,,.5]),jsfxr([1,,.2311,,.2188,.2821,,.0801,,,,,,,,,,,1,,,,,.5])],snakeDie:[jsfxr([0,,.01,,.2869,.5177,,-.4476,,,,,,.11,,,,,1,,,,,.5]),jsfxr([0,,.0351,,.2305,.6125,,-.6412,,,,,,.4387,,,,,1,,,,,.5]),jsfxr([1,,.0177,,.2814,.6055,,-.5082,,,,,,,,,,,1,,,.0859,,.5]),jsfxr([1,,.0483,,.1775,.3365,,-.3196,,,,,,,,,,,1,,,,,.5]),jsfxr([1,,.049,,.1309,.3715,,-.3916,,,,,,,,,,,1,,,.0678,,.5])],tronDie:[jsfxr([3,,.371,.5449,.4937,.2121,,.0796,,,,,,,,.7837,,,1,,,,,.5]),jsfxr([3,,.2394,.4801,.1741,.3551,,-.3345,,,,.1722,.6674,,,,,,1,,,,,.5]),jsfxr([3,,.2165,.4098,.2652,.0386,,-.0559,,,,,,,,.4027,,,1,,,,,.5]),jsfxr([3,,.3649,.7376,.436,.1946,,-.3909,,,,,,,,.3619,,,1,,,,,.5]),jsfxr([3,,.242,.4038,.1806,.08,,-.0453,,,,,,,,,,,1,,,,,.5])],tronMove:[jsfxr([0,,.2585,,.2304,.7746,.2757,-.241,,,,,,.6346,-.4449,,,,1,,,.2477,,.5]),jsfxr([1,,.1187,.2882,.3815,.5199,.2,-.222,,,,,,.7643,-.3786,,,,1,,,,,.5]),jsfxr([0,,.2714,,.1939,.7659,.5204,-.1711,,,,,,.7968,-.1646,,.1522,-.0163,1,,,.0453,,.5]),jsfxr([1,,.1708,,.3431,.5202,.2,-.2127,,,,,,.6461,-.553,,,,1,,,.2716,,.5]),jsfxr([0,,.2135,.1768,.1713,.7404,.2,-.2497,,,,,,.525,-.0116,,,,1,,,,,.5])],glitchedWall:[jsfxr([0,,.3467,,.126,.4379,,.2274,,,,,,.1401,,,,,1,,,,,.5]),jsfxr([0,,.3012,,.1961,.4809,,.1517,,,,,,.548,,,,,1,,,,,.5]),jsfxr([0,,.3456,,.2811,.3238,,.145,,,,,,.2244,,,,,.4066,,,.0392,,.5]),jsfxr([0,,.3237,,.2572,.3594,,.1178,,,,,,.4703,,,,,1,,,.2011,,.5]),jsfxr([0,,.3525,,.1996,.3101,,.2567,,,,,,.3032,,,,,1,,,,,.5])],hiScore:[jsfxr([0,,.0401,.379,.4666,.5605,,,,,,.44,.5241,,,,,,1,,,,,.5]),jsfxr([0,,.0612,.5269,.4113,.4149,,,,,,.3262,.6716,,,,,,1,,,,,.5]),jsfxr([0,,.085,.5219,.2917,.4561,,,,,,.4629,.5089,,,,,,1,,,,,.5]),jsfxr([0,,.0122,.3796,.4865,.823,,,,,,.482,.5611,,,,,,1,,,,,.5]),jsfxr([0,,.089,.4769,.4621,.6073,,,,,,.4516,.5814,,,,,,1,,,,,.5])]},Snake.Sound.init=function(){Snake.MOBILE?(document.addEventListener("touchstart",function(t){t&&t.currentTarget.removeEventListener(t.type,arguments.callee),Snake.Sound.initAudio()}),this.toggleMute()):Snake.Sound.initAudio()},Snake.Sound.initAudio=function(){var t=navigator.userAgent.match(/iPhone|iPod|iPad/i);Object.keys(this.sounds).forEach(function(e){var i=this.sounds[e];t&&"tronMove"!==e&&(i=[i[Snake.Game.random(0,i.length-1)]]),i=i.map(function(t){var e=new Audio;e.src=t;var i=e.play();return i&&i["catch"]&&i["catch"](function(){}),e.pause(),e}),this.sounds[e]=i}.bind(this))},Snake.Sound.play=function(t){var e=Snake.Game.random(0,this.sounds[t].length-1);this.player.src=this.sounds[t][e];var i=this.player.play();i&&i["catch"]&&i["catch"](function(){})},Snake.Sound.play=function(t){if(!this.isMuted){var e=Snake.Game.random(0,this.sounds[t].length-1);Snake.MOBILE&&(this.sounds[t][e].currentTime=0),this.sounds[t][e].play();var i=this.sounds[t][e].play();i&&i["catch"]&&i["catch"](function(){})}},Snake.Sound.playEatFood=function(t){this.play("tron"===t?"tronEatFood":"snakeEatFood")},Snake.Sound.playEatBuggyBug=function(){this.play("tronEatFood")},Snake.Sound.playEnterTronMode=function(){this.play("enterTronMode")},Snake.Sound.playDie=function(t){this.play("tron"===t?"tronDie":"snakeDie")},Snake.Sound.playMove=function(t){"tron"===t&&this.play("tronMove")},Snake.Sound.playGlitchedWall=function(){this.play("glitchedWall")},Snake.Sound.playHiScore=function(){this.play("hiScore")},Snake.Sound.toggleMute=function(){this.isMuted=!this.isMuted,this.playEatFood(),document.querySelector("[data-action=mute]").classList.toggle("on")};var Snake=Snake||{};Snake.Font={characterPixelsWidth:3,font:{0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[,1],[1,1],[,1],[,1],[,1]],2:[[1,1,1],[,,1],[1,1,1],[1],[1,1,1]],3:[[1,1,1],[,,1],[,1,1],[,,1],[1,1,1]],4:[[1,,1],[1,,1],[1,1,1],[,,1],[,,1]],5:[[1,1,1],[1,,],[1,1,1],[,,1],[1,1,1]],6:[[1,1,1],[1,,],[1,1,1],[1,,1],[1,1,1]],7:[[1,1,1],[,,1],[,,1],[,,1],[,,1]],8:[[1,1,1],[1,,1],[1,1,1],[1,,1],[1,1,1]],9:[[1,1,1],[1,,1],[1,1,1],[,,1],[1,1,1]]," ":[[]],A:[[,1],[1,,1],[1,1,1],[1,,1],[1,,1]],B:[[1,1],[1,,1],[1,1],[1,,1],[1,1]],C:[[,1,1],[1],[1],[1],[,1,1]],D:[[1,1],[1,,1],[1,,1],[1,,1],[1,1]],E:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],F:[[1,1,1],[1],[1,1,1],[1],[1]],G:[[,1,1],[1],[1,,1],[1,,1],[,1,1]],H:[[1,,1],[1,,1],[1,1,1],[1,,1],[1,,1]],I:[[1,1,1],[,1],[,1],[,1],[1,1,1]],J:[[,,1],[,,1],[,,1],[1,,1],[,1]],K:[[1,,1],[1,,1],[1,1],[1,,1],[1,,1]],L:[[1,,],[1,,],[1,,],[1,,],[1,1,1]],M:[[1,,1],[1,1,1],[1,1,1],[1,,1],[1,,1]],N:[[1,,1],[1,1,1],[1,1,1],[1,1,1],[1,,1]],O:[[,1],[1,,1],[1,,1],[1,,1],[,1]],P:[[1,1],[1,,1],[1,1],[1],[1]],Q:[[,1],[1,,1],[1,,1],[1,,1],[,1,1]],R:[[1,1],[1,,1],[1,1,1],[1,1],[1,,1]],S:[[,1,1],[1],[,1],[,,1],[1,1]],T:[[1,1,1],[,1],[,1],[,1],[,1]],U:[[1,,1],[1,,1],[1,,1],[1,,1],[,1,1]],V:[[1,,1],[1,,1],[1,,1],[,1],[,1]],W:[[1,,1],[1,,1],[1,1,1],[1,1,1],[1,,1]],X:[[1,,1],[1,,1],[,1],[1,,1],[1,,1]],Y:[[1,,1],[1,,1],[,1],[,1],[,1]],Z:[[1,1,1],[,,1],[,1],[1],[1,1,1]],a:[[],[1,1],[,1,1],[1,,1],[1,1,1]],b:[[1],[1,1],[1,,1],[1,,1],[1,1]],c:[[],[,1,1],[1],[1],[,1,1]],d:[[,,1],[,1,1],[1,,1],[1,,1],[,1,1]],e:[[],[,1,1],[1,,1],[1,1],[,1,1]],f:[[,,1],[,1],[1,1,1],[,1],[,1]],g:[[],[,1,1],[1,,1],[1,1,1],[,,1],[,1]],h:[[1],[1,1],[1,,1],[1,,1],[1,,1]],i:[[,1],[],[1,1],[,1],[,1]],j:[[,,1],[],[,,1],[,,1],[1,,1],[,1]],k:[[1],[1,,1],[1,1],[1,1],[1,,1]],l:[[1,1],[,1],[,1],[,1],[1,1,1]],m:[[],[1,,1],[1,1,1],[1,1,1],[1,,1]],n:[[],[1,1],[1,,1],[1,,1],[1,,1]],o:[[],[,1],[1,,1],[1,,1],[,1]],p:[[],[1,1],[1,,1],[1,,1],[1,1],[1]],q:[[],[,1,1],[1,,1],[1,,1],[,1,1],[,,1]],r:[[],[,1,1],[1],[1],[1]],s:[[],[,1,1],[1,1],[,1,1],[1,1]],t:[[,1],[1,1,1],[,1],[,1],[,1,1]],u:[[],[1,,1],[1,,1],[1,,1],[,1,1]],v:[[],[1,,1],[1,,1],[1,1,1],[,1]],w:[[],[1,,1],[1,1,1],[1,1,1],[1,1,1]],x:[[],[1,,1],[,1],[,1],[1,,1]],y:[[],[1,,1],[1,,1],[,1,1],[,,1],[,1]],z:[[],[1,1,1],[,1,1],[1,1],[1,1,1]],"[":[[1,1],[1],[1],[1],[1,1]],"]":[[,1,1],[,,1],[,,1],[,,1],[,1,1]]}};var Snake=Snake||{};Snake.Controls={},Snake.Controls.addListeners=function(t){document.addEventListener("keydown",function(e){var i=e.keyCode;if(!(e.shiftKey||e.metaKey||e.altKey||e.ctrlKey))switch(e.preventDefault(),i){case 37:case 65:t("left");break;case 38:case 87:t("up");break;case 39:case 68:t("right");break;case 40:case 83:t("down");break;case 77:t("mute");break;case 80:t("pause");break;default:t("start")}}),Snake.MOBILE&&document.getElementById("s").addEventListener("touchstart",function(){t("pause")},!1),document.addEventListener("visibilitychange",function(){document.hidden&&t("pause")}),document.ontouchstart=function(e){var i=e.target.dataset.action;i&&(e.target.classList.add("active"),window.navigator.vibrate&&window.navigator.vibrate(50),t(i),e.preventDefault())},document.ontouchend=function(t){t.target.classList.remove("active")}};var Snake=Snake||{};Snake.UI={canvas:document.getElementById("c"),ctx:document.getElementById("c").getContext("2d"),bgCanvas:document.getElementById("bg"),bgCtx:document.getElementById("bg").getContext("2d"),buttons:document.getElementById("buttons"),body:document.body,cellSize:20,iconLink:null,icons:{},pixels:[],pixelsPerCell:4,cells:{full:[[1,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],food:[[],[,,1],[,1,,1],[,,1]],bug1Left:[[,1,1],[,1,1],[,,1,1],[,,,]],bug1Right:[[,1],[1,1,1],[1,1,1,1],[1,,1]],bug2Left:[[,,,],[,1,,],[,1,,1],[,,1,1]],bug2Right:[[,1,1],[1,1,,1],[1,1,1,1],[1,1,1,1]],bug3Left:[[],[,1],[,1,1,1],[,,1]],bug3Right:[[],[],[1,1,1,1],[1,,1]],bug4Left:[[,,,1],[,1,1,1],[,1,,1],[,1,,1]],bug4Right:[[1,1],[1,1,1,1],[1,1,,1],[,1,,1]],bug5Left:[[,,1],[,1,,1],[,1,1,1],[,,,1]],bug5Right:[[1],[1,1],[1,1,1,1],[,1]],snakeHeadRight:[[],[1,1,1],[1,1,1],[1,1,1]],snakeHeadLeft:[[],[,1,1,1],[,1,1,1],[,1,1,1]],snakeHeadTop:[[,1,1,1],[,1,1,1],[,1,1,1],[,,,]],snakeVertical:[[,1,1,1],[,1,1,1],[,1,1,1],[,1,1,1]],snakeHorizontal:[[],[1,1,1,1],[1,1,1,1],[1,1,1,1]],snakeTopLeft:[[,1,1,1],[1,1,1,1],[1,1,1,1],[1,1,1,1]],snakeBottomRight:[[],[,1,1,1],[,1,1,1],[,1,1,1]]},color:{snake:{bg:"#9c3",boardCell:"rgba(0,0,255,0.05)",wall:"rgba(0,0,0,0.7)",food:"rgba(0,0,0,0.7)",bug:"rgba(0,0,0,0.7)",snake:"rgba(0,0,0,0.7)"},tron:{bg:"#003",wall:"#FF0",food:"#F00",bug:"#FFF",snake:"#0FF"}}},Snake.UI.init=function(t){this.canvas.width=t.boardWidth*this.cellSize,this.canvas.height=t.boardHeight*this.cellSize,this.bgCanvas.width=t.boardWidth*this.cellSize,this.bgCanvas.height=t.boardHeight*this.cellSize,this.initFavicons(t.mode),this.initPixels(t),this.initSnakeCells(),this.initWallCells(),this.paintBG(t),this.font=Snake.Font,this.color.sticky=this.color.snake},Snake.UI.initPixels=function(t){this.pixels=[];for(var e=0;e<t.boardWidth*this.pixelsPerCell;e++)this.pixels.push(new Array(t.boardHeight*this.pixelsPerCell))},Snake.UI.initSnakeCells=function(){this.cells.snake={__:this.cells.snakeHeadLeft,_T:this.cells.snakeHeadTop,_B:this.cells.snakeBottomRight,T_:this.cells.snakeHeadTop,B_:this.cells.snakeBottomRight,_L:this.cells.snakeHeadRight,_R:this.cells.snakeBottomRight,L_:this.cells.snakeHeadRight,R_:this.cells.snakeBottomRight,BT:this.cells.snakeVertical,TB:this.cells.snakeVertical,LR:this.cells.snakeHorizontal,RL:this.cells.snakeHorizontal,TT:this.cells.snakeVertical,BB:this.cells.snakeVertical,RR:this.cells.snakeHorizontal,LL:this.cells.snakeHorizontal,TR:this.cells.snakeVertical,RT:this.cells.snakeVertical,LB:this.cells.snakeHorizontal,BL:this.cells.snakeHorizontal,TL:this.cells.snakeTopLeft,LT:this.cells.snakeTopLeft,BR:this.cells.snakeBottomRight,RB:this.cells.snakeBottomRight}},Snake.UI.initWallCells=function(){this.cells.wall={__LR:this.cells.snakeHorizontal,__L_:this.cells.snakeHorizontal,___R:this.cells.snakeHeadLeft,____:this.cells.snakeHeadLeft,TB__:this.cells.snakeVertical,T___:this.cells.snakeVertical,_B__:this.cells.snakeHeadLeft,_B_R:this.cells.snakeHeadLeft,_BL_:this.cells.snakeHorizontal,T_L_:this.cells.snakeTopLeft,T__R:this.cells.snakeVertical}},Snake.UI.showMainMenu=function(t){var e=this.color[t.mode].wall;this.paintString(60,60,"SnAkE",e),t.showHint&&this.paintString(Snake.MOBILE?29:35,70,Snake.MOBILE?"touch any button":"press any key",e),this.paintString(9,113,"js13k 2016 intuitio bartaz",e)},Snake.UI.paintScore=function(t){var e=this.addPad(t.score,"0000"),i=Snake.Game.findBuggyBugOnBoard();if(this.paintString(9,7,e,this.color[t.mode].snake),e=this.addPad(t.hiscore,"0000"),this.paintString(47,7,"HI "+e,this.color[t.mode].snake),2===i.length&&(this.paintCell(24,2,this.color[t.mode].bug,this.cells[i[0].body]),this.paintCell(25,2,this.color[t.mode].bug,this.cells[i[1].body])),t.buggyBugTimeLeft>=0){var a=this.addPad(t.buggyBugTimeLeft,"00");this.paintString(105,7,""+a,this.color[t.mode].wall)}"tron"===t.mode&&this.paintString(97,7,"TRON",this.color[t.mode].wall),this.paintLine(9,13,(t.boardWidth-(t.borderOffset.left+t.borderOffset.right))*this.pixelsPerCell-1,this.color[t.mode].snake)},Snake.UI.addPad=function(t,e){var i=""+t;return e.substring(0,e.length-i.length)+i},Snake.UI.showEndGame=function(t){this.paintString(11,60,"        GAME OVER         ",this.color[t.mode].wall),t.showHint&&this.paintString(Snake.MOBILE?29:35,70,Snake.MOBILE?"touch any button":"press any key",this.color[t.mode].wall)},Snake.UI.showPause=function(t){this.paintString(11,60,"          PAUSE           ",this.color[t.mode].wall)},Snake.UI.paintBG=function(t){for(var e=(this.cellSize-this.pixelsPerCell)/this.pixelsPerCell,i=1,a=this.bgCtx,s=0;s<t.boardWidth*this.pixelsPerCell;s++)for(var n=0;n<t.boardHeight*this.pixelsPerCell;n++)a.fillStyle=this.color.snake.boardCell,a.fillRect(s*(e+i),n*(e+i),e,e)},Snake.UI.paint=function(t){this.updateFavicon(t.mode),this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.initPixels(t),this.paintScore(t),this.body.className!==t.mode&&(this.body.className=t.mode),Snake.MOBILE&&t.showHint!==this.buttons.classList.contains("hint")&&this.buttons.classList[t.showHint?"add":"remove"]("hint");for(var e=0;e<t.snake.length;e++){var i=t.snake[e];n=this.cells.snake[this.getSnakeCellType(e,t.snake)],this.paintCell(i.x,i.y,this.color[t.mode].snake,n,i.isGlitched)}for(var a=0;a<t.boardWidth;a++)for(var s=0;s<t.boardHeight;s++)if(i=t.board[a][s],"wall"===i.type){var n=this.cells.wall[this.getWallCellType(a,s,t.board)];this.paintCell(a,s,this.color[t.mode].wall,n,i.isGlitched)}else"food"===i.type?this.paintCell(a,s,this.color[t.mode].food,this.cells.food):"buggybug"===i.type&&this.paintCell(a,s,this.color[t.mode].bug,this.cells[i.body]);"menu"===t.state?this.showMainMenu(t):"pause"===t.state?this.showPause(t):"end"===t.state&&this.showEndGame(t),this.glitchPixels(),this.paintPixels()},Snake.UI.getSnakeCellType=function(t,e){function i(t,e){var i="";return i=e?e.x===t.x?e.y===t.y-1?"T":"B":e.x===t.x-1?"L":"R":"_"}var a=e[t],s=e[t-1],n=e[t+1],o="";return o+=i(a,s),o+=i(a,n)},Snake.UI.getWallCellType=function(t,e,i){var a=i[t]&&i[t][e-1]&&"wall"===i[t][e-1].type,s=i[t]&&i[t][e+1]&&"wall"===i[t][e+1].type,n=i[t-1]&&i[t-1][e]&&"wall"===i[t-1][e].type,o=i[t+1]&&i[t+1][e]&&"wall"===i[t+1][e].type;return(a?"T":"_")+(s?"B":"_")+(n?"L":"_")+(o?"R":"_")},Snake.UI.paintCell=function(t,e,i,a,s){s&&"number"!=typeof s&&(s=.9);for(var n=0;n<this.pixelsPerCell;n++)for(var o=0;o<this.pixelsPerCell;o++)a[o][n]&&(!s||Math.random()<s)&&(this.pixels[t*this.pixelsPerCell+n][e*this.pixelsPerCell+o]=i)},Snake.UI.paintLine=function(t,e,i,a){for(var s=0;s<i;s++)this.pixels[t+s][e]=a},Snake.UI.paintCharacter=function(t,e,i,a){var s=this.font.font[i]||this.font.font[0];if(s)for(var n=0;n<s.length;n++)for(var o=0;o<s[n].length;o++)s[n][o]&&(this.pixels[t+o][e+n]=a)},Snake.UI.paintString=function(t,e,i,a){for(var s=0;s<i.length;s++)this.paintCharacter(t+(this.font.characterPixelsWidth+1)*s,e,i.charAt(s),a)},Snake.UI.glitchPixels=function(){for(var t=Snake.Game.state,e=0;e<t.level-1;e++){for(var i=Snake.Game.random(0,t.level-1),a=Snake.Game.random(1,t.boardWidth*this.pixelsPerCell/2),s=Math.random(),n=Snake.Game.random(0,t.boardWidth*this.pixelsPerCell-1-a),o=0;o<a;o++)for(var h=n+o,r=0;r<i;r++)if(s<.01){var l=this.pixels[h].shift();this.pixels[h].push(l)}else s>.99&&(l=this.pixels[h][t.boardHeight*this.pixelsPerCell-1],this.pixels[h].unshift(l));i=Snake.Game.random(0,t.level-1),a=Snake.Game.random(1,t.boardHeight*this.pixelsPerCell/2),s=Math.random();var d=Snake.Game.random(0,t.boardHeight*this.pixelsPerCell-1-a);for(o=0;o<a;o++){var c=d+o;for(r=0;r<i;r++)if(s<.01){for(l=this.pixels[0][c],h=0;h<this.pixels.length-1;h++)this.pixels[h][c]=this.pixels[h+1][c];this.pixels[this.pixels.length-1][c]=l}else if(s>.99){for(l=this.pixels[this.pixels.length-1][c],h=this.pixels.length-1;h>0;h--)this.pixels[h][c]=this.pixels[h-1][c];this.pixels[0][c]=l}}}},Snake.UI.paintPixels=function(){var t=(this.cellSize-this.pixelsPerCell)/this.pixelsPerCell,e=1;"tron"===Snake.Game.state.mode&&(t+=1,e=0);var i=this.ctx;this.pixels.forEach(function(a,s){a.forEach(function(a,n){a&&(i.fillStyle=a,i.fillRect(s*(t+e),n*(t+e),t,t))})})},Snake.UI.initFavicons=function(t){this.icons={},this.icons.snake=this.getFavicon("snake"),this.icons.sticky=this.icons.snake,this.icons.tron=this.getFavicon("tron");var e=document.createElement("link");e.type="image/x-icon",e.id="canvas-favicon",e.rel="shortcut icon",document.getElementsByTagName("head")[0].appendChild(e),this.iconLink=e,this.updateFavicon(t)},Snake.UI.updateFavicon=function(t){this.iconLink.dataset.mode!==t&&(this.iconLink.href=this.icons[t],this.iconLink.dataset.mode=t)},Snake.UI.getFavicon=function(t){var e=32,i=document.createElement("canvas");i.width=e,i.height=e;var a=i.getContext("2d");return a.fillStyle=this.color[t].bg,a.fillRect(0,0,e,e),a.fillStyle=this.color[t].food,this.paintFaviconFood(a,e,this.cells.food),a.fillStyle=this.color[t].wall,this.paintFaviconWall(a,28),i.toDataURL("image/x-icon")},Snake.UI.paintFaviconFood=function(t,e,i){for(var a=4,s=0;s<a;s++)for(var n=0;n<a;n++)i[n][s]&&t.fillRect(n*a*1.6,s*a*1.6,1.5*a,1.5*a)},Snake.UI.paintFaviconWall=function(t,e){for(var i,a=2,s=i=e/a,n=0;n<i;n++)for(var o=0;o<s;o++)0!==n&&0!==o&&n!==s-1&&o!==s-1||t.fillRect(o*a+2,n*a+2,a,a)};var Snake=Snake||{};Snake.Board={},Snake.Board.initBoard=function(t){for(var e=t.borderOffset,i=0;i<t.boardWidth;i++){t.board[i]=new Array(t.boardWidth);for(var a=0;a<t.boardHeight;a++)t.board[i][a]={type:null,isGlitched:!1}}for(i=e.left;i<t.boardWidth-e.right;i++)t.board[i][e.top].type="wall",t.board[i][t.boardHeight-e.bottom-1].type="wall";for(a=e.top;a<t.boardHeight-e.bottom;a++)t.board[e.left][a].type="wall",t.board[t.boardWidth-e.right-1][a].type="wall"},Snake.Board.glitchOppositeWall=function(t,e,i){var a=this.getOppositeWallCoords(t,e,i);a&&this.glitchSingleWall(a.x,a.y,i)},Snake.Board.getOppositeWallCoords=function(t,e,i){var a,s=i.borderOffset;return e===s.top?a={x:t,y:i.boardHeight-s.bottom-1}:e===i.boardHeight-s.bottom-1?a={x:t,y:s.top}:t===s.left?a={x:i.boardWidth-s.right-1,y:e}:t===i.boardWidth-s.right-1&&(a={x:s.left,y:e}),a},Snake.Board.glitchSingleWall=function(t,e,i){"wall"===i.board[t][e].type&&(i.board[t][e].isGlitched=!0)};var Snake=Snake||{};Snake.MOBILE="ontouchstart"in document,Snake.MOBILE&&(document.documentElement.className="mobile"),Snake.Game={},Snake.Game.initStateValues=function(){this.state={state:"menu",snake:[],direction:"right",inputBuffer:[],board:[],boardWidth:30,boardHeight:30,borderOffset:{top:4,bottom:2,left:2,right:2},holeInTheWall:!1,score:0,hiscore:this.readHiScore(),level:1,mode:"snake",prevLength:null,glitchedLength:0,foodEaten:0,buggyBugTimeLeft:-1,showHint:!1}},Snake.Game.vars={then:null,animationId:null},Snake.Game.init=function(){this.sound=Snake.Sound,this.sound.init(),this.ui=this.ui||Snake.UI,this.controls=this.controls||Snake.Controls,this.board=this.board||Snake.Board,this.initNewGame(),this.ui.init(this.state),this.controls.addListeners(this.onInput.bind(this)),this.ui.paint(this.state)},Snake.Game.initNewGame=function(){this.initStateValues(),this.delayHint(),this.board.initBoard(this.state),this.initSnake(),this.initFood(),this.vars.then=performance.now(),window.cancelAnimationFrame(this.vars.animationId),this.loop()},Snake.Game.play=function(){this.state.state="play",this.clearHint()},Snake.Game.loop=function(){this.vars.animationId=window.requestAnimationFrame(this.loop.bind(this));var t=performance.now(),e=t-this.vars.then,i=20;"play"===this.state.state&&(i=this.state.level+4,"tron"===this.state.mode&&(i+=3));var a=1e3/i;e>a&&(this.vars.then=t-e%a,this.tick())},Snake.Game.initSnake=function(){for(var t=0;t<5;t++)this.state.snake.push({x:~~(this.state.boardWidth/2)+t-5,y:~~(this.state.boardHeight/2)})},Snake.Game.random=function(t,e){return Math.floor(Math.random()*(e-t+1)+t)},Snake.Game.delayHint=function(t){this.clearHint(),t=t||5e3,this.hintTimeout=setTimeout(function(t){t.showHint=!0},5e3,this.state)},Snake.Game.clearHint=function(){clearTimeout(this.hintTimeout),this.state.showHint=!1},Snake.Game.initFood=function(){this.initEdible("food")},Snake.Game.initBuggyBug=function(){this.initEdible("buggybug")},Snake.Game.initEdible=function(t){var e,i,a,s,n=0,o=this.state.borderOffset.top,h=this.state.boardHeight-this.state.borderOffset.bottom-1,r=this.state.borderOffset.left,l=this.state.boardWidth-this.state.borderOffset.right-1;1===this.state.level&&(n=1),this.state.holeInTheWall?(e=a=0,i=this.state.boardWidth-1,s=this.state.boardHeight-1):(e=r+n,i=l-n,a=o+n,s=h-n),"buggybug"===t&&(i-=1);do var d=this.random(e,i),c=this.random(a,s);while("food"===this.state.board[d][c].type||"buggybug"===this.state.board[d][c].type||this.ifCollidedWithSnake(d,c)||"buggybug"===t&&this.ifCollidedWithSnake(d+1,c)||d===e&&c===a||d===e&&c===s||d===i&&c===a||d===i&&c===s||d===l&&c===o||d===r&&c===o||c===h&&d===l||c===h&&d===r);if("wall"===this.state.board[d][c].type&&(this.board.glitchOppositeWall(d,c,this.state),this.state.holeInTheWall=!0,"buggybug"!==t||c!==o&&c!==h||this.board.glitchOppositeWall(d+1,c,this.state)),this.state.board[d][c]={type:t},"buggybug"===t){"wall"===this.state.board[d+1][c].type&&(this.board.glitchOppositeWall(d+1,c,this.state),this.state.holeInTheWall=!0);var u=this.random(1,5);this.state.board[d][c].body="bug"+u+"Left",this.state.board[d+1][c]={type:t,body:"bug"+u+"Right"};var f=this.getDistanceFromHead(d,c)+10;f=f-f%10+10,this.state.buggyBugTimeLeft=f}},Snake.Game.getDistanceFromHead=function(t,e){var i=this.state.snake[this.state.snake.length-1];return Math.abs(i.x-t)+Math.abs(i.y-e)},Snake.Game.tick=function(){var t=this.state;"play"===t.state&&this.update(),"end"===t.state&&this.gameOverUpdate(),this.ui.paint(this.state)},Snake.Game.update=function(){var t=this.state.snake[this.state.snake.length-1].x,e=this.state.snake[this.state.snake.length-1].y,i=this.findBuggyBugOnBoard();if(this.state.inputBuffer.length){do var a=this.state.inputBuffer.shift();while("right"===a&&"left"===this.state.direction||"left"===a&&"right"===this.state.direction||"up"===a&&"down"===this.state.direction||"down"===a&&"up"===this.state.direction);a&&(this.sound.playMove(this.state.mode),this.state.direction=a)}switch(this.state.direction){case"right":t++;break;case"left":t--;break;case"up":e--;break;case"down":e++}switch(t===-1?t=this.state.boardWidth-1:t===this.state.boardWidth?t=0:e===-1?e=this.state.boardHeight-1:e===this.state.boardWidth&&(e=0),this.state.board[t][e].type){case"food":this.consumeFood(t,e);break;case"buggybug":this.consumeBuggyBug(t,e);break;default:"snake"===this.state.mode?(this.state.snake.shift(),this.state.prevLength&&this.state.snake.length>this.state.prevLength?this.glitchSnakeTail(10,this.state.snake.length-this.state.prevLength):this.state.prevLength&&this.state.snake.length===this.state.prevLength&&(this.state.prevLength=null,this.state.glitchedLength=0)):"tron"===this.state.mode&&(this.state.score+=1)}"sticky"===this.state.mode&&this.state.buggyBugTimeLeft--<0&&(this.state.mode="tron",this.sound.playEnterTronMode()),this.checkCollision(t,e),"wall"===this.state.board[t][e].type&&this.state.board[t][e].isGlitched&&(this.sound.playGlitchedWall(),this.state.board[t][e].isGlitched=!1),this.state.snake.push({x:t,y:e}),2===i.length&&(1===this.state.buggyBugTimeLeft?(this.removeBuggyBug(i[0].x,i[0].y),this.state.buggyBugTimeLeft=-1):this.state.buggyBugTimeLeft--)},Snake.Game.glitchSnakeTail=function(t,e){var i=this.state,a=i.snake,s=1/(t+1);(i.glitchedLength===t||i.glitchedLength>=a.length)&&a.shift();for(var n=0;n<=i.glitchedLength;n++)i.snake[n]&&(!e||n<e)&&(i.snake[n].isGlitched=s*(n+1));i.glitchedLength<t&&i.glitchedLength++},Snake.Game.consumeFood=function(t,e){this.sound.playEatFood(this.state.mode),this.state.score+=4+this.state.level,this.state.foodEaten+=1,this.state.foodEaten%5===0&&(this.state.level+=1),this.state.mode="snake",this.addEdible(),this.state.board[t][e].type="",this.state.prevLength&&(this.state.prevLength+=1)},Snake.Game.consumeBuggyBug=function(t,e){this.sound.playEatBuggyBug(),this.state.mode="sticky",this.state.score+=this.state.buggyBugTimeLeft+this.state.level,this.state.prevLength||(this.state.prevLength=this.state.snake.length),this.removeBuggyBug(t,e)},Snake.Game.removeBuggyBug=function(t,e){this.state.board[t][e].type="",this.state.board[t-1]&&"buggybug"===this.state.board[t-1][e].type?this.state.board[t-1][e].type="":this.state.board[t+1]&&"buggybug"===this.state.board[t+1][e].type&&(this.state.board[t+1][e].type="")},Snake.Game.findBuggyBugOnBoard=function(){var t=[];return this.state.board.forEach(function(e,i){e.forEach(function(e,a){"buggybug"===e.type&&t.push({x:i,y:a,body:e.body})})}),t},Snake.Game.addEdible=function(){this.state.level>2&&Math.random()<.3&&!this.findBuggyBugOnBoard().length&&this.initBuggyBug(),this.initFood()},Snake.Game.checkCollision=function(t,e){(this.ifCollidedWithSnake(t,e)||"wall"===this.state.board[t][e].type&&!this.state.board[t][e].isGlitched)&&this.gameOver()},Snake.Game.gameOver=function(){this.sound.playDie(this.state.mode),window.navigator.vibrate&&window.navigator.vibrate(400),this.state.state="end",this.state.pauseInput=!0,setTimeout(function(t){t.pauseInput=!1},500,this.state),this.delayHint(),this.state.score>this.state.hiscore&&this.saveHiScore(this.state.score)},Snake.Game.gameOverUpdate=function(){var t=this.state,e=t.snake;t.score>t.hiscore&&(this.state.hiscore++,t.hiscore%10===0&&this.sound.playHiScore()),e.length&&this.glitchSnakeTail(20)},Snake.Game.ifCollidedWithSnake=function(t,e){return this.state.snake.filter(function(i){return i.x===t&&i.y===e&&!i.isGlitched}).length},Snake.Game.onInput=function(t){if(!this.state.pauseInput)if("mute"===t)this.sound.toggleMute();else if("pause"===t)"play"===this.state.state&&(this.state.state="pause");else switch(this.state.state){case"end":this.state.level=50,setTimeout(function(){this.initNewGame(),this.ui.paint(this.state)}.bind(this),500);break;case"pause":this.state.state="play";case"menu":this.play();case"play":default:"start"!==t&&this.state.inputBuffer.push(t)}},Snake.Game.readHiScore=function(){var t,e=0;return localStorage&&(t=localStorage.getItem("SNAKE_HISCORE"),t=+t,!isNaN(t)&&t>0&&(e=t)),e},Snake.Game.saveHiScore=function(t){localStorage&&localStorage.setItem("SNAKE_HISCORE",t)},Snake.Game.init();</script></body></html>