<!doctype html><script src=/2019/webxr/aframe.js></script><title>Back2Space</title><script>!function(t){var e={};function i(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,i),o.l=!0,o.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)i.d(n,o,function(e){return t[e]}.bind(null,o));return n},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";function n(){this.setSettings=function(t){for(var e=0;e<24;e++)this[String.fromCharCode(97+e)]=t[e]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(i<.18){var n=.18/i;this.b*=n,this.c*=n,this.e*=n}}}i.r(e);var o=new function(){var t,e,i,o,r,a,s,l,d,c,h,f;this._params=new n,this.reset=function(){var t=this._params;o=100/(t.f*t.f+.001),r=100/(t.g*t.g+.001),a=1-t.h*t.h*t.h*.01,s=-t.i*t.i*t.i*1e-6,t.a||(h=.5-t.n/2,f=5e-5*-t.o),l=1+t.l*t.l*(t.l>0?-.9:10),d=0,c=1==t.m?0:(1-t.m)*(1-t.m)*2e4+32},this.totalReset=function(){this.reset();var n=this._params;return t=n.b*n.b*1e5,e=n.c*n.c*1e5,i=n.e*n.e*1e5+12,3*((t+e+i)/3|0)},this.synthWave=function(n,u){var p=this._params,m=1!=p.s||p.v,v=p.v*p.v*.1,g=1+3e-4*p.w,y=p.s*p.s*p.s*.1,b=1+1e-4*p.t,w=1!=p.s,E=p.x*p.x,C=p.g,A=p.q||p.r,S=p.r*p.r*p.r*.2,x=p.q*p.q*(p.q<0?-1020:1020),M=p.p?32+((1-p.p)*(1-p.p)*2e4|0):0,k=p.d,F=p.j/2,R=p.k*p.k*.01,T=p.a,z=t,B=1/t,L=1/e,I=1/i,D=5/(1+p.u*p.u*20)*(.01+y);D>.8&&(D=.8),D=1-D;for(var j,q,H,O,P,W,G=!1,U=0,_=0,V=0,X=0,$=0,Y=0,Z=0,N=0,K=0,Q=0,J=new Array(1024),tt=new Array(32),et=J.length;et--;)J[et]=0;for(et=tt.length;et--;)tt[et]=2*Math.random()-1;for(et=0;et<u;et++){if(G)return et;if(M&&++K>=M&&(K=0,this.reset()),c&&++d>=c&&(c=0,o*=l),(o*=a+=s)>r&&(o=r,C>0&&(G=!0)),q=o,F>0&&(Q+=R,q*=1+Math.sin(Q)*F),(q|=0)<8&&(q=8),T||((h+=f)<0?h=0:h>.5&&(h=.5)),++_>z)switch(_=0,++U){case 1:z=e;break;case 2:z=i}switch(U){case 0:V=_*B;break;case 1:V=1+2*(1-_*L)*k;break;case 2:V=1-_*I;break;case 3:V=0,G=!0}A&&((H=0|(x+=S))<0?H=-H:H>1023&&(H=1023)),m&&g&&((v*=g)<1e-5?v=1e-5:v>.1&&(v=.1)),W=0;for(var it=8;it--;){if(++Z>=q&&(Z%=q,3==T))for(var nt=tt.length;nt--;)tt[nt]=2*Math.random()-1;switch(T){case 0:P=Z/q<h?.5:-.5;break;case 1:P=1-Z/q*2;break;case 2:P=.225*(((P=1.27323954*(O=6.28318531*((O=Z/q)>.5?O-1:O))+.405284735*O*O*(O<0?1:-1))<0?-1:1)*P*P-P)+P;break;case 3:P=tt[Math.abs(32*Z/q|0)]}m&&(j=Y,(y*=b)<0?y=0:y>.1&&(y=.1),w?($+=(P-Y)*y,$*=D):(Y=P,$=0),X+=(Y+=$)-j,P=X*=1-v),A&&(J[N%1024]=P,P+=J[(N-H+1024)%1024],N++),W+=P}W*=.125*V*E,n[et]=W>=1?32767:W<=-1?-32768:32767*W|0}return u}};const r=function(t){o._params.setSettings(t);var e=o.totalReset(),i=new Uint8Array(4*((e+1)/2|0)+44),n=2*o.synthWave(new Uint16Array(i.buffer,44),e),r=new Uint32Array(i.buffer,0,44);r[0]=1179011410,r[1]=n+36,r[2]=1163280727,r[3]=544501094,r[4]=16,r[5]=65537,r[6]=44100,r[7]=88200,r[8]=1048578,r[9]=1635017060,r[10]=n,n+=44;for(var a=0,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",l="data:audio/wav;base64,";a<n;a+=3){var d=i[a]<<16|i[a+1]<<8|i[a+2];l+=s[d>>18]+s[d>>12&63]+s[d>>6&63]+s[63&d]}return l};let a=[];for(let t=0;t<50;t++)a.push(new Audio);let s=0,l=[r([0,,.33,.0853,.1802,.5299,.2,-.2399,-.0599,,,-1,,.8922,-.5931,,.0246,-.0455,1,,,.0036,,.28]),r([3,,.58,.35,.0547,.16,,-.18,,,,-.3774,.6619,,,,.598,-.1327,1,,,,,.28]),r([3,.09,.67,.35,.93,.2,,-.12,,,,-.3774,.62,,,,.1399,-.3,1,,,,,.28])];const d=function(t){a[s].src=l[t],a[s].play(),s=(s+1)%50},c=[[[1,1,0,1,1,0,1,1,0,1,1],[2,2,2,2,2,0,2,2,2,2,2],[3,3,3,3,3,0,3,3,3,3,3],[0,4,4,4,0,0,0,4,4,4,0],[0,4,0,4,0,0,0,4,0,4,0]],[[0,2,0,0,0,3,0,0,0,2,0],[0,4,0,0,0,1,0,0,0,4,0],[4,6,4,0,1,7,1,0,4,6,4],[2,4,2,0,3,1,3,0,2,4,2],[4,2,4,0,1,3,1,0,4,2,4]],[[0,0,0,3,2,1,2,3,0,0,0],[0,0,3,2,1,1,1,2,3,0,0],[0,3,2,1,1,4,1,1,2,3,0],[0,0,3,2,1,1,1,2,3,0,0],[0,0,0,3,2,1,2,3,0,0,0]],[[1,2,3,4,5,8,5,4,3,2,1],[0,1,2,3,4,5,4,3,2,1,0],[0,0,1,2,3,4,3,2,1,0,0],[0,0,0,1,2,3,2,1,0,0,0],[0,0,0,0,1,1,1,0,0,0,0]],[[0,1,0,1,0,1,0,1,0,1,0],[4,0,4,0,4,0,4,0,4,0,4],[0,3,0,3,0,3,0,3,0,3,0],[6,0,6,0,6,0,6,0,6,0,6],[0,7,0,7,0,7,0,7,0,7,0]],[[0,0,0,8,0,0,0,8,0,0,0],[0,0,8,6,8,0,8,6,8,0,0],[0,8,6,4,6,8,6,4,6,8,0],[8,6,4,2,4,6,4,2,4,6,8],[6,4,2,0,2,4,2,0,2,4,6]]];AFRAME.registerComponent("game",{schema:{currentwave:{default:0}},init:function(){this.gameover=!1,this.currentspeed=5,this.score=0,this.gameState=0,this.invadergroup=document.getElementById("invaders"),this.missilegroup=document.getElementById("missiles"),this.el.sceneEl.addEventListener("enter-vr",(()=>{document.querySelector("[gun]").setAttribute("visible",!0)})),this.el.sceneEl.addEventListener("exit-vr",(()=>{document.querySelector("[gun]").setAttribute("visible",!1)})),this.el.addEventListener("fire",(t=>{switch(this.gameState){case 0:this.score=0,document.getElementById("titlescreen").setAttribute("visible","false"),this.gameState=1,this.invadersLeftInWave=this.spawnInvaderWave();break;case 1:d(0),this.spawnMissile(t.detail.direction,t.detail.position);break;case 3:document.querySelectorAll("[invader], [missile]").forEach((t=>t.remove())),document.getElementById("gameoverscreen").setAttribute("visible","false"),this.gameover=!1,this.gameState=1,this.score=0,this.currentspeed=5,this.data.currentwave=0,this.invincible=!0,setTimeout((()=>{this.invincible=!1}),5e3),this.invadersLeftInWave=this.spawnInvaderWave()}})),this.el.addEventListener("collision",(t=>{d(1);let e=t.detail.invader.getAttribute("position"),i=document.createElement("a-entity");i.setAttribute("position",e),i.setAttribute("explosion",{color:t.detail.invader.components.invader.getColor()}),this.missilegroup.appendChild(i),t.detail.missile.remove(),t.detail.invader.remove(),this.invadersLeftInWave-=1,this.score++,0==this.invadersLeftInWave&&setTimeout((()=>{this.data.currentwave=(this.data.currentwave+1)%c.length,this.currentspeed++,this.invadersLeftInWave=this.spawnInvaderWave()}),1500)})),this.el.addEventListener("game-over",(()=>{~document.location.href.indexOf("godmode")||this.invincible||(d(2),document.getElementById("score").setAttribute("neontext",{text:`${this.score} invaders shot`,fontsize:60,color:"#1b90e2"}),document.getElementById("gameoverscreen").setAttribute("visible","true"),this.gameState=2,setTimeout((()=>{this.gameState=3}),5e3),this.gameover=!0)}))},spawnInvaderWave(){let t=0;for(let e=0;e<5;e++)for(let i=0;i<11;i++)c[this.data.currentwave][e][i]>0&&(t++,this.spawnInvader(i,e,c[this.data.currentwave][e][i]));return t},spawnInvader:function(t,e,i){let n=document.createElement("a-entity"),o=25*-e+150,r=((t+.5)/11-.5)*(Math.PI/1.5);n.setAttribute("invader",{direction:r,type:i,speed:this.currentspeed}),n.setAttribute("appear","");const a={x:250*Math.sin(r),y:o,z:-150*Math.cos(r)};n.setAttribute("position",a),this.invadergroup.appendChild(n)},spawnMissile:function(t,e){let i=document.createElement("a-entity");i.setAttribute("missile",{direction:t,position:e}),this.missilegroup.appendChild(i)}});for(var h=new Uint8Array(512),f=0;f<256;f++)h[f]=h[256+f]=0|255*Math.random();var u=function(t,e,i){return e+t*(i-e)},p=function(t){return t*t*t*(t*(6*t-15)+10)},m=function(t,e,i){return(0==(2&t)?e:-e)+(0==(1&t)?i:-i)};const v=function(t,e){var i=255&(0|t),n=255&(0|e),o=t-(0|t),r=e-(0|e),a=h[i]+n,s=h[i+1]+n,l=p(o),d=p(r),c=m(h[a],o,r),f=m(h[s],o-1,r),v=m(h[a+1],o,r-1),g=m(h[s+1],o-1,r-1);return u(d,u(l,c,f),u(l,v,g))};function g(t,e=!1){const i=(t.getIndex()||t.getAttribute("position")).count/3,n=[];for(let t=0;t<i;t++){const i=e?1:0;t%2==0?n.push(0,0,1,0,1,0,1,0,i):n.push(0,1,0,0,0,1,1,0,i)}const o=new Float32Array(n),r=new THREE.BufferAttribute(o,3);t.addAttribute("barycentric",r)}function y(t){const e=t.getIndex();if(!e)return;const i=e.array,n=i.length/3,o=t.attributes,r=Object.keys(o).map((e=>({array:[],attribute:t.getAttribute(e)})));for(let t=0;t<n;t++){const e=[i[3*t+0],i[3*t+1],i[3*t+2]];r.forEach((t=>{const i=t.attribute,n=i.itemSize;for(let o=0;o<e.length;o++){const r=e[o];for(let e=0;e<n;e++){const o=i.array[r*n+e];t.array.push(o)}}}))}e.array=null,t.setIndex(null),r.forEach((t=>{const e=new t.attribute.array.constructor(t.array);t.attribute.setArray(e)}))}function b(t,e,i=!1){var n=new THREE.Geometry;for(let e=0;e<t.length;e+=3)n.vertices.push(new THREE.Vector3(t[e],t[e+1],t[e+2]));for(let t=0;t<e.length;t+=3)n.faces.push(new THREE.Face3(e[t+2],e[t+1],e[t]));let o=(new THREE.BufferGeometry).fromGeometry(n);return y(o),g(o,i),new THREE.Mesh(o)}AFRAME.registerComponent("space",{schema:{},init:function(){var t=document.createElement("canvas");t.width=2048,t.height=2048;var e=t.getContext("2d");e.fillStyle="#FF00FF",e.fillRect(0,0,t.width,t.height);for(var i=e.createImageData(t.width,t.height),n=i.data,o=0;o<t.width;o++)for(var r=0;r<t.height;r++){var a=v(5*o/t.width,5*r/t.height);n[0+(s=4*(r*t.width+o))]=-25*a+41,n[s+1]=7*a+10,n[s+2]=-8*a+59,n[s+3]=255}for(let e=0;e<1e4;e++){let e=~~(Math.random()*t.width);var s=4*(~~(Math.random()*t.height)*t.width+e);const i=~~(255*Math.random());n[s+0]=i/2+128,n[s+1]=i,n[s+2]=i/2+128,n[s+3]=255}e.putImageData(i,0,0),this.el.setAttribute("material",{shader:"flat",color:"white",src:t}),this.el.setAttribute("rotation","0 -90 0")}});const w=["#00FF00","#0000FF","#00FFFF","#FF0000","#FF00FF","#FF00FF","#FFFF00","#FFFF00"],E=["#001100","#000011","#001111","#110000","#110011","#110011","#111100","#111100"],C=[[-1,3,1.65,-1,3,-1.34,-1,4,-1.34,-3.01,-1,-.34,-3,1,-.34,-3,1,-1.34,-1,-3,-.34,-1,-3,-1.34,-1,2,-.34,-2,-2,-.34,-2,-2,-1.34,-2,2,-.34,-2,2,-1.34,-2,3,1.66,-2,3,-1.34,-2,4,-1.34,-1,2,-1.34,0,2,-1.34,-4,1,-.34,-4,0,-1.34,-4,-2,.66,-2,-4,1.66,-3.99,2,-1.34,-3.99,0,-3.34,-3.99,-4,.66,-3,2,-1.35,-3.01,0,-3.34,-3.01,-4,.66,-3.01,-2,.66,-3.01,0,-1.34,0,-3,-1.34,0,-3,-.34,0,-1,1.64,0,2,-.34,1,4,-1.34,1,3,-1.34,1,3,1.65,3,1,-.34,3,1,-1.34,2,2,-.34,2,2,-1.34,2,3,1.66,2,3,-1.34,2,4,-1.34,1,-3,-.34,1,2,-.34,1,2,-1.34,4,1,-.34,3.99,2,-1.34,3.01,2,-1.34,4,-2,.66,4,0,-1.34,3.01,0,-1.34,3.01,-2,.66,3.99,0,-3.34,3.99,-4,.66,3.01,0,-3.34,3.01,-4,.66,2,-4,1.66,3,-1,-.34,1,-3,-1.34,2,-2,-.34,2,-2,-1.34],[3.15,1.97,1.16,1.57,.39,-.98,3.15,1.97,2.47,1.57,.39,.06,3.15,1.97,3.1,1.57,.39,3.1,.79,-1.18,-2.03,.79,-1.85,2.47,.79,-1.97,3.1,4.72,-1.18,2.38,2.36,-.39,.09,3.15,1.97,1.16,4.72,-1.18,2.47,2.36,-.39,2.47,3.94,1.18,2.47,4.72,-1.18,3.1,2.36,-.39,3.1,3.94,1.18,3.1,0,.39,3.1,0,1.97,3.1,2.85,1.85,2.97,1.52,.52,2.97,.12,.52,2.97,.12,1.85,2.97,4.34,-.79,2.98,2.82,-.29,2.98,3.83,.73,2.98,.12,-.91,2.97,.59,-1.85,2.97,.12,-1.85,2.97,0,.39,-3.1,0,.39,-.66,0,-1.97,2.47,0,-1.97,-3.1,0,-.39,3.1,0,-.39,.35,0,-1.97,3.1,0,3.14,-.18,0,1.97,-3.1,-1.57,.39,.06,-3.15,1.97,2.47,-3.15,1.97,1.16,-1.57,.39,3.1,-3.15,1.97,3.1,-.79,-1.85,2.47,-.79,-1.97,3.1,-2.36,-.39,2.47,-4.72,-1.18,2.47,-4.72,-1.18,2.38,-2.36,-.39,.09,-3.94,1.18,2.47,-3.15,1.97,1.16,-2.36,-.39,3.1,-4.72,-1.18,3.1,-3.94,1.18,3.1,-3.83,.73,2.98,-4.34,-.79,2.98,-2.82,-.29,2.98,-.12,1.85,2.97,-2.85,1.85,2.97,-1.52,.52,2.97,-.12,.52,2.97,-.12,-.91,2.97,-.59,-1.85,2.97,-.12,-1.85,2.97,-1.57,.39,-.98,-.79,-1.18,-2.03]],A=[[2,1,0,4,5,11,11,5,12,13,14,15,13,2,0,15,2,13,30,6,31,8,33,32,31,6,32,12,16,8,8,11,12,14,13,8,8,16,14,18,22,25,18,25,4,20,19,29,20,29,28,19,18,4,19,4,29,23,20,24,23,19,20,22,19,23,22,18,19,26,27,28,26,28,29,25,26,29,27,24,21,24,20,21,20,28,21,28,27,21,3,29,4,6,7,9,7,10,9,10,3,9,5,4,25,7,6,30,4,11,32,3,4,32,9,3,32,11,8,32,6,9,32,13,0,33,33,8,13,1,17,33,33,0,1,35,34,36,38,37,39,38,39,40,42,41,43,34,41,36,34,43,41,44,30,31,33,45,32,44,31,32,46,40,45,39,45,40,41,42,45,46,45,42,48,47,49,49,47,37,51,50,52,52,50,53,47,51,37,37,51,52,50,54,55,51,54,50,51,48,54,47,48,51,57,56,53,53,56,52,56,49,52,55,57,58,50,55,58,53,50,58,57,53,58,52,59,37,60,44,61,62,60,61,59,62,61,37,38,49,44,60,30,39,37,32,37,59,32,59,61,32,45,39,32,61,44,32,36,41,33,45,33,41,17,35,33,36,33,35,54,55,57,56,54,57,26,27,24,26,24,23],[3,2,0,5,4,2,2,3,5,31,18,5,33,32,7,8,34,35,32,36,8,13,12,9,9,10,13,14,13,10,12,14,11,11,9,12,16,15,12,12,13,16,17,16,13,13,14,17,15,17,14,14,12,15,11,10,9,26,24,25,37,38,0,2,4,19,23,20,21,21,22,23,27,28,29,11,3,14,10,3,14,4,5,21,21,20,4,5,18,22,22,21,5,18,19,23,23,22,18,19,4,20,20,23,19,15,16,25,25,24,15,16,17,26,26,25,16,17,15,24,24,26,17,29,28,8,36,34,27,35,31,3,3,1,30,5,3,31,7,6,33,35,7,8,8,7,32,0,2,37,19,37,2,34,8,28,28,27,34,8,36,29,27,29,36,7,35,6,6,35,3,6,3,30,40,39,41,43,42,40,39,40,42,18,31,42,32,33,44,34,45,35,36,32,45,47,46,48,49,48,46,46,50,49,50,47,51,48,51,47,53,52,47,46,47,52,52,54,46,50,46,54,54,53,50,47,50,53,49,51,48,56,55,57,38,37,41,43,40,19,59,58,60,61,60,58,63,62,64,39,51,50,39,49,50,42,43,60,59,60,43,18,42,61,60,61,42,19,18,58,61,58,18,43,19,59,58,59,19,52,53,57,56,57,53,54,52,55,57,55,52,53,54,56,55,56,54,63,64,45,34,36,62,31,35,39,65,39,30,39,42,31,66,44,33,44,35,45,44,45,32,40,41,37,37,19,40,45,34,63,62,63,34,36,45,64,64,62,36,35,44,66,35,66,39,39,66,30]];let S,x;function M(){let t=document.querySelector("a-entity[camera]").object3D,e=new THREE.Vector3(0,0,1);e.applyQuaternion(t.quaternion),document.querySelector("[game]").emit("fire",{direction:{x:e.x,y:e.y,z:e.z},position:{x:0,y:0,z:0}})}function k(t,e,i){return!(0===t.y&&0===e.y&&0===i.y)}AFRAME.registerComponent("invader",{schema:{direction:{default:0},type:{default:1},speed:{default:5},frequency:{default:2},breakChange:{default:100},amp:{default:1}},init:function(){this.tick=AFRAME.utils.throttleTick(this.tick,1/30,this),S=S||document.querySelector("[game]"),this.movement=0,this.broken=!1;const t=(this.data.type-1)%2;let e=b(C[t],A[t]);this.el.setObject3D("mesh",e),this.el.setAttribute("wireframe-material",{fillcolor:E[this.data.type-1],color:w[this.data.type-1],thickness:.05}),this.el.setAttribute("scale","1.5 1.5 1.5");let i=this.el.getAttribute("position"),n=Math.sqrt(i.x*i.x+i.y*i.y+i.z*i.z);this.startDist=n,this.dir={x:i.x/n,y:i.y/n,z:i.z/n},this.deltaFreq=this.data.frequency*Math.PI*2/n,this.orgX=i.x,this.el.getObject3D("mesh").lookAt(new THREE.Vector3(0,0,0))},tick:function(t,e){if(S.components.game.gameover)return;let i=e/1e3*this.data.speed,n=this.el.object3D.position;this.orgX-=this.dir.x*i,n.y-=this.dir.y*i,n.z-=this.dir.z*i;let o=Math.sqrt(this.orgX*this.orgX+n.y*n.y+n.z*n.z);n.x=Math.sin(this.startDist*this.deltaFreq-this.deltaFreq*o)*o/10*this.data.amp+this.orgX,this.el.getObject3D("mesh").lookAt(0,0,0),o<10&&(this.gameover=!0,S.emit("game-over")),o>10&&!this.broken&&1e6*Math.random()<=this.data.breakChange&&(this.broken=!0,this.data.speed*=2,this.data.frequency*=4,this.data.amp*=5)},getColor:function(){return w[this.data.type-1]}}),AFRAME.registerComponent("keyboardcontrols",{init:function(){let t=!1;document.body.addEventListener("keydown",(e=>{32!==e.keyCode||t||(t=!0,M())})),document.body.addEventListener("keyup",(e=>{32===e.keyCode&&(t=!1)}))}}),AFRAME.registerComponent("touchcontrols",{init:function(){let t=!1;document.body.addEventListener("touchstart",(e=>{t||(t=!0,M())})),document.body.addEventListener("touchstart",(e=>{t=!1}))}}),AFRAME.registerComponent("missile",{schema:{speed:{default:133},lifetime:{default:250},collisionDistance:{default:5},direction:{type:"vec3"},position:{type:"vec3"},yCorrection:{default:-.1}},init:function(){this.tick=AFRAME.utils.throttleTick(this.tick,1/30,this),this.collision=!1;let t=b([-.08,.06,-.54,-.01,.06,-.54,-.15,0,.32,.05,0,.32,-.12,.02,.46,.03,.02,.46,-.08,.14,-.54,-.01,.14,-.54,-.15,.2,.32,.05,.2,.32,-.12,.18,.46,.03,.18,.46,-.15,0,.17,.05,0,.17,-.15,.2,.17,.05,.2,.17,-.11,.03,.29,.02,.03,.29,-.11,.17,.29,.02,.17,.29,-.18,-.03,.23,.09,-.03,.23,-.18,.23,.23,.09,.23,.23],[0,12,13,13,1,0,2,4,5,5,3,2,6,7,15,15,14,6,8,9,11,11,10,8,0,1,7,7,6,0,1,13,15,15,7,1,3,5,11,11,9,3,5,4,10,10,11,5,4,2,8,8,10,4,12,0,6,6,14,12,20,16,21,17,21,16,18,22,19,23,19,22,21,17,23,19,23,17,16,20,18,22,18,20,13,12,20,20,21,13,2,3,17,17,16,2,14,15,23,23,22,14,9,8,18,18,19,9,15,13,21,21,23,15,3,9,19,19,17,3,8,2,16,16,18,8,12,14,22,22,20,12]);document.querySelector("a-entity[camera]").getAttribute("rotation"),this.el.setObject3D("mesh",t),t.lookAt(this.data.direction.x,this.data.direction.y,this.data.direction.z),this.el.setAttribute("scale","2 2 2"),this.el.setAttribute("wireframe-material",{fillcolor:"#222200",color:"#FFFF00",thickness:.1}),this.el.setAttribute("position",this.data.position)},tick:function(t,e){if(this.collision)return;let i=this.el.object3D.position;i.x-=this.data.direction.x*this.data.speed*(e/1e3),i.y-=(this.data.direction.y+this.data.yCorrection)*this.data.speed*(e/1e3),i.z-=this.data.direction.z*this.data.speed*(e/1e3),i.z<-this.data.lifetime&&this.el.parentEl.removeChild(this.el);let n=document.querySelectorAll("[invader]"),o=new THREE.Vector3(i.x,i.y,i.z);for(let t=0;t<n.length;t++){let e=n[t].object3D.position,i=new THREE.Vector3(e.x,e.y,e.z),r=new THREE.Vector3;r.subVectors(o,i),Math.sqrt(r.x*r.x+r.y*r.y+r.z*r.z)<this.data.collisionDistance&&!this.collision&&(this.collision=!0,document.querySelector("[game]").emit("collision",{missile:this.el,invader:n[t]}))}}}),function(){let t=document.createElement("canvas");t.width=t.height=128;let e=t.getContext("2d"),i=e.createRadialGradient(64,64,0,64,64,64);i.addColorStop(0,"#ffffffff"),i.addColorStop(1,"#ffffff00"),e.fillStyle=i,e.beginPath(),e.arc(64,64,100,0,2*Math.PI),e.fill(),x=new THREE.CanvasTexture(e.canvas)}(),AFRAME.registerComponent("explosion",{schema:{color:{type:"color"}},init:function(){this.tick=AFRAME.utils.throttleTick(this.tick,1/30,this),this.particleCount=100,this.particles=new THREE.BufferGeometry,this.velocities=[];let t=[];this.material=new THREE.PointsMaterial({size:4,map:x,transparent:!0,color:new THREE.Color(this.data.color)});for(var e=0;e<this.particleCount;e++){let e=new THREE.Vector3(64*(Math.random()-.5),64*(Math.random()-.5),64*(Math.random()-.5));t.push(5*Math.random()-2.5,5*Math.random()-2.5,5*Math.random()-2.5),this.velocities.push(e)}this.particles.addAttribute("position",new THREE.Float32BufferAttribute(t,3)),this.particleSystem=new THREE.Points(this.particles,this.material),this.el.setObject3D("particle-system",this.particleSystem),this.el.setAttribute("selfdestruct",{timer:1640})},tick:function(t,e){this.material.size=Math.max(this.material.size-e/500,0);var i=this.particleSystem.geometry.attributes.position;for(let t=0;t<i.count;t++){var n=i.getX(t),o=i.getY(t),r=i.getZ(t);i.setXYZ(t,n+this.velocities[t].x*e/1e3,o+this.velocities[t].y*e/1e3,r+this.velocities[t].z*e/1e3),this.velocities[t].y-=64*e/1e3}i.needsUpdate=!0}}),AFRAME.registerComponent("selfdestruct",{schema:{timer:{default:5e3}},tick:function(t,e){this.data.timer-=e,this.data.timer<0&&this.el.remove()}}),AFRAME.registerComponent("ground",{schema:{},init:function(){var t=new THREE.PlaneBufferGeometry(500,500,500,500);y(t),g(t,!0);var e=new THREE.Mesh(t);this.el.setObject3D("mesh",e),this.el.setAttribute("rotation",{x:-90,y:0,z:0})}}),AFRAME.registerComponent("shoot-controls",{schema:{hand:{default:"left"}},init:function(){var t=this;this.onButtonChanged=this.onButtonChanged.bind(this),this.onButtonDown=function(e){t.onButtonEvent(e.detail.id,"down")},this.onButtonUp=function(e){t.onButtonEvent(e.detail.id,"up")}},play:function(){var t=this.el;t.addEventListener("buttonchanged",this.onButtonChanged),t.addEventListener("buttondown",this.onButtonDown),t.addEventListener("buttonup",this.onButtonUp)},pause:function(){var t=this.el;t.removeEventListener("buttonchanged",this.onButtonChanged),t.removeEventListener("buttondown",this.onButtonDown),t.removeEventListener("buttonup",this.onButtonUp)},mapping:{axis0:"trackpad",axis1:"trackpad",button0:"trackpad",button1:"trigger",button2:"grip",button3:"menu",button4:"system"},onButtonChanged:function(t){this.mapping["button"+t.detail.id]},onButtonEvent:function(t,e){if(this.mapping["button"+t],"down"===e){let t=new THREE.Euler(this.el.object3D.rotation.x,this.el.object3D.rotation.y,this.el.object3D.rotation.z,"XYZ"),e=new THREE.Vector3(0,0,1);e.applyEuler(t),document.querySelector("[game]").emit("fire",{direction:{x:e.x,y:e.y,z:e.z},position:{x:this.el.object3D.position.x,y:this.el.object3D.position.y,z:this.el.object3D.position.z}})}},update:function(){var t=this.data,e=this.el;e.setAttribute("keyboardcontrols",{}),e.setAttribute("touchcontrols",{}),e.setAttribute("vive-controls",{hand:t.hand,model:!1}),e.setAttribute("oculus-touch-controls",{hand:t.hand,model:!1}),e.setAttribute("windows-motion-controls",{hand:t.hand,model:!1}),"right"===t.hand&&(e.setAttribute("daydream-controls",{hand:t.hand,model:!1}),e.setAttribute("gearvr-controls",{hand:t.hand,model:!1}))}}),AFRAME.registerComponent("titlescreen",{schema:{text:{default:"BACK TO SPACE"},fontsize:{type:"number",default:150},font:{type:"string",default:"Fantasy"}},init:function(){let t=document.createElement("canvas");t.width=t.height=1024;let e=t.getContext("2d"),i=e.createLinearGradient(0,8,0,120);for(i.addColorStop(0,"#1f1f75"),i.addColorStop(.25,"#52a5e7"),i.addColorStop(.5,"#e1e0f2"),i.addColorStop(.51,"#10100e"),i.addColorStop(.75,"#7b257c"),i.addColorStop(.95,"#f3abd0"),i.addColorStop(1,"#e3f3f2"),e.shadowColor="#131a9b",e.shadowBlur=15,e.textAlign="center",e.fillStyle=i,e.font=`${this.data.fontsize}px ${this.data.font}`;e.measureText(this.data.text).width>t.width&&this.data.fontsize>1;)this.data.fontsize--,e.font=`${this.data.fontsize}px ${this.data.font}`;e.fillText(this.data.text,512,123);let n=e.createLinearGradient(0,5,0,140);n.addColorStop(0,"#e3f3f2"),n.addColorStop(.1,"#131a9b"),n.addColorStop(.2,"#e3f3f2"),n.addColorStop(.3,"#1f1f75"),n.addColorStop(.4,"#01000a"),n.addColorStop(.5,"#1f1f75"),n.addColorStop(.6,"#aa1885"),n.addColorStop(.7,"#1f1f75"),n.addColorStop(.8,"#aa1885"),n.addColorStop(.9,"#e3f3f2"),e.shadowColor="#7b257c",e.shadowBlur=1,e.strokeStyle="white",e.lineWidth=5,e.strokeText(this.data.text,512,123),e.strokeStyle=n,e.lineWidth=4,e.strokeText(this.data.text,512,123),this.el.setAttribute("material",{transparent:!0,src:t})}}),AFRAME.registerComponent("neontext",{schema:{text:{type:"string",default:"Neon text"},fontsize:{type:"number",default:150},font:{type:"string",default:"Serif"},color:{type:"color",default:"#e21b90"}},init:function(){this.update()},update:function(){let t=document.createElement("canvas");t.width=t.height=1024;let e=t.getContext("2d");for(e.fillStyle="white",e.font=`${this.data.fontsize}px ${this.data.font}`,e.textAlign="center";e.measureText(this.data.text).width>t.width&&this.data.fontsize>1;)this.data.fontsize--,e.font=`${this.data.fontsize}px ${this.data.font}`;e.fillText(this.data.text,512,123),e.strokeStyle=this.data.color,e.lineWidth=this.data.fontsize/75,e.strokeText(this.data.text,512,123),e.fillStyle=this.data.color,e.shadowColor=this.data.color,e.shadowBlur=15,e.fillText(this.data.text,512+this.data.fontsize/50,123+this.data.fontsize/50),this.el.setAttribute("material",{transparent:!0,src:t})}}),AFRAME.registerComponent("sun",{init:function(){let t=document.createElement("canvas");t.width=t.height=1024;let e=t.getContext("2d"),i=document.createElement("canvas");i.width=i.height=1024;let n=i.getContext("2d"),o=n.createLinearGradient(0,100,0,t.height-100);o.addColorStop(0,"#fbf120ff"),o.addColorStop(.355,"#fd8227ff"),o.addColorStop(.356,"#fd822700"),o.addColorStop(.364,"#fd822700"),o.addColorStop(.365,"#fd8227ff"),o.addColorStop(.42,"#fe6828ff"),o.addColorStop(.421,"#fe682800"),o.addColorStop(.434,"#fe682800"),o.addColorStop(.435,"#fe6828ff"),o.addColorStop(.49,"#fe5430ff"),o.addColorStop(.491,"#fe543000"),o.addColorStop(.509,"#fe543000"),o.addColorStop(.51,"#fe5430ff"),o.addColorStop(.562,"#fe4b38ff"),o.addColorStop(.563,"#fe4b3800"),o.addColorStop(.582,"#fe4b3800"),o.addColorStop(.584,"#fe4b38ff"),o.addColorStop(.63,"#fe3446ff"),o.addColorStop(.631,"#fe344600"),o.addColorStop(.657,"#fe344600"),o.addColorStop(.658,"#fe3446ff"),o.addColorStop(.71,"#fe2558ff"),o.addColorStop(.711,"#fe255800"),o.addColorStop(.739,"#fe255800"),o.addColorStop(.74,"#fe2558ff"),o.addColorStop(.785,"#fe1f5fff"),o.addColorStop(.786,"#fe1f5f00"),o.addColorStop(.825,"#fe1f5f00"),o.addColorStop(.826,"#fe1f5fff"),o.addColorStop(.86,"#fe1967ff"),o.addColorStop(.861,"#fe196700"),o.addColorStop(.905,"#fe196700"),o.addColorStop(.906,"#fe1967ff"),o.addColorStop(.94,"#ff1270ff"),o.addColorStop(.941,"#ff127000"),n.fillStyle=o,n.beginPath(),n.arc(t.height/2,t.height/2,412,0,2*Math.PI),n.fill(),e.shadowColor="#ff0d77ff",e.shadowBlur=100,e.drawImage(i,0,0),this.el.setAttribute("material",{transparent:!0,src:t})}}),AFRAME.registerComponent("mountains",{init:function(){let t=document.createElement("canvas");t.width=t.height=100;let e=t.getContext("2d"),i=e.createRadialGradient(50,50,20,50,50,80);i.addColorStop(0,"#ffffff00"),i.addColorStop(.2,"#ffffffff"),i.addColorStop(.4,"#ffffff00"),e.fillStyle=i,e.beginPath(),e.arc(t.height/2,t.height/2,412,0,2*Math.PI),e.fill();let n=e.getImageData(0,0,t.width,t.height),o=n.data;for(let e=0;e<t.width;e++)for(let i=0;i<t.height;i++){let n=v(20*e/t.width,20*i/t.height),r=4*(i*t.width+e);o[r+0]=Math.min(n*o[r+0]+o[r+0]/8,255),o[r+1]=0,o[r+2]=0,o[r+3]=255}e.putImageData(n,0,0);let r=e.getImageData(0,0,t.width,t.height).data,a=new THREE.Geometry;for(let e=0;e<t.width;e++)for(let i=0;i<t.height;i++){let n=4*(i*t.width+e);void 0!==r[n]&&a.vertices.push(new THREE.Vector3(10*(e-t.width/2),r[n]/5,10*(i-t.height/2)))}let s=[];for(let e=0;e<t.width-1;e++)for(let i=0;i<t.height-1;i++){let n=i*t.width+e,o=i*t.width+e+1,r=(i+1)*t.width+e,l=(i+1)*t.width+e+1;a.vertices[n]&&a.vertices[o]&&a.vertices[r]&&a.vertices[l]&&(k(a.vertices[n],a.vertices[o],a.vertices[r])&&(a.faces.push(new THREE.Face3(n,o,r)),s[n]=s[o]=s[r]=!0),k(a.vertices[o],a.vertices[l],a.vertices[r])&&(a.faces.push(new THREE.Face3(o,l,r)),s[o]=s[l]=s[r]=!0))}let l=(new THREE.BufferGeometry).fromGeometry(a);y(l),g(l,!1);let d=new THREE.Mesh(l);this.el.setObject3D("mesh",d)}}),AFRAME.registerComponent("wireframe-material",{schema:{color:{type:"color",default:"white"},fillcolor:{type:"color",default:"#000000"},thickness:{type:"number",default:.05}},init:function(){this.update()},update:function(){var t=new THREE.ShaderMaterial({extensions:{derivatives:!0},uniforms:{time:{value:0},fill:{value:new THREE.Color(this.data.fillcolor)},stroke:{value:new THREE.Color(this.data.color)},noiseA:{value:!1},noiseB:{value:!1},dualStroke:{value:!1},seeThrough:{value:!1},insideAltColor:{value:!0},thickness:{value:this.data.thickness},secondThickness:{value:.05},dashEnabled:{value:!1},dashRepeats:{value:2},dashOverlap:{value:!1},dashLength:{value:.55},dashAnimate:{value:!1},squeeze:{value:!1},squeezeMin:{value:.1},squeezeMax:{value:1}},vertexShader:"#define GLSLIFY 1\nattribute vec3 barycentric;\nattribute float even;\n\nvarying vec3 vBarycentric;\n\nvarying vec3 vPosition;\nvarying float vEven;\nvarying vec2 vUv;\n\nvoid main () {\n  gl_Position = projectionMatrix * modelViewMatrix * vec4(position.xyz, 1.0);\n  vBarycentric = barycentric;\n  vPosition = position.xyz;\n  vEven = even;\n  vUv = uv;\n}",fragmentShader:"#define GLSLIFY 1\nvarying vec3 vBarycentric;\nvarying float vEven;\nvarying vec2 vUv;\nvarying vec3 vPosition;\n\nuniform float time;\nuniform float thickness;\nuniform float secondThickness;\n\nuniform float dashRepeats;\nuniform float dashLength;\nuniform bool dashOverlap;\nuniform bool dashEnabled;\nuniform bool dashAnimate;\n\nuniform bool seeThrough;\nuniform bool insideAltColor;\nuniform bool dualStroke;\nuniform bool noiseA;\nuniform bool noiseB;\n\nuniform bool squeeze;\nuniform float squeezeMin;\nuniform float squeezeMax;\n\nuniform vec3 stroke;\nuniform vec3 fill;\n\nfloat aastep (float threshold, float dist) {\n  float afwidth = fwidth(dist) * 0.5;\n  return smoothstep(threshold - afwidth, threshold + afwidth, dist);\n}\n\nfloat computeScreenSpaceWireframe (vec3 barycentric, float lineWidth) {\n  vec3 dist = fwidth(barycentric);\n  vec3 smoothed = smoothstep(dist * ((lineWidth * 0.5) - 0.5), dist * ((lineWidth * 0.5) + 0.5), barycentric);\n  return 1.0 - min(min(smoothed.x, smoothed.y), smoothed.z);\n}\nvec4 getStyledWireframe (vec3 barycentric) {\n  float d = min(min(barycentric.x, barycentric.y), barycentric.z);\n  float positionAlong = max(barycentric.x, barycentric.y);\n  if (barycentric.y < barycentric.x && barycentric.y < barycentric.z) {\n    positionAlong = 1.0 - positionAlong;\n  }\n  float computedThickness = thickness;\n  float edge = 1.0 - aastep(computedThickness, d);\n  vec4 outColor = vec4(0.0);\n  if (seeThrough) {\n    outColor = vec4(stroke, edge);\n    if (insideAltColor && !gl_FrontFacing) {\n      outColor.rgb = fill;\n    }\n  } else {\n    vec3 mainStroke = mix(fill, stroke, edge);\n    outColor.a = 1.0;\n    if (dualStroke) {\n      float inner = 1.0 - aastep(secondThickness, d);\n      vec3 wireColor = mix(fill, stroke, abs(inner - edge));\n      outColor.rgb = wireColor;\n    } else {\n      outColor.rgb = mainStroke;\n    }\n  }\n\n  return outColor;\n}\n\nvoid main () {\n  gl_FragColor = getStyledWireframe(vBarycentric);\n}\n"});t.needsUpdate=!0,this.el.getObject3D("mesh").material=t}});const F=function(){var t,e,i,n,o,r=function(t){return Math.sin(6.283184*t)},a=function(t){return.003959503758*Math.pow(2,(t-128)/12)},s=function(t,e,i){var n,o,r,s,d,c,h,f=l[t.i[0]],u=t.i[1],p=t.i[3],m=l[t.i[4]],v=t.i[5],g=t.i[8],y=t.i[9],b=t.i[10]*t.i[10]*4,w=t.i[11]*t.i[11]*4,E=t.i[12]*t.i[12]*4,C=1/E,A=t.i[13],S=i*Math.pow(2,2-t.i[14]),x=new Int32Array(b+w+E),M=0,k=0;for(n=0,o=0;n<b+w+E;n++,o++)o>=0&&(o-=S,c=a(e+(15&(A=A>>8|(255&A)<<4))+t.i[2]-128),h=a(e+(15&A)+t.i[6]-128)*(1+8e-4*t.i[7])),r=1,n<b?r=n/b:n>=b+w&&(r-=(n-b-w)*C),s=c,p&&(s*=r*r),d=f(M+=s)*u,s=h,g&&(s*=r*r),d+=m(k+=s)*v,y&&(d+=(2*Math.random()-1)*y),x[n]=80*d*r|0;return x},l=[r,function(t){return t%1<.5?1:-1},function(t){return t%1*2-1},function(t){var e=t%1*4;return e<2?e-1:3-e}];this.init=function(r){t=r,e=r.endPattern,i=0,n=r.rowLen*r.patternLen*(e+1)*2,o=new Int32Array(n)},this.generate=function(){var a,d,c,h,f,u,p,m,v,g,y,b,w,E,C=new Int32Array(n),A=t.songData[i],S=t.rowLen,x=t.patternLen,M=0,k=0,F=!1,R=[];for(c=0;c<=e;++c)for(p=A.p[c],h=0;h<x;++h){var T=p?A.c[p-1].f[h]:0;T&&(A.i[T-1]=A.c[p-1].f[h+x]||0,T<16&&(R=[]));var z=l[A.i[15]],B=A.i[16]/512,L=Math.pow(2,A.i[17]-9)/S,I=A.i[18],D=A.i[19],j=43.23529*A.i[20]*3.141592/44100,q=1-A.i[21]/255,H=1e-5*A.i[22],O=A.i[23]/32,P=A.i[24]/512,W=6.283184*Math.pow(2,A.i[25]-9)/S,G=A.i[26]/255,U=A.i[27]*S&-2;for(y=(c*x+h)*S,f=0;f<4;++f)if(u=p?A.c[p-1].n[h+f*x]:0){R[u]||(R[u]=s(A,u,S));var _=R[u];for(d=0,a=2*y;d<_.length;d++,a+=2)C[a]+=_[d]}for(d=0;d<S;d++)(g=C[m=2*(y+d)])||F?(b=j,I&&(b*=z(L*m)*B+.5),k+=(b=1.5*Math.sin(b))*(w=q*(g-k)-(M+=b*k)),g=3==D?k:1==D?w:M,H&&(g=(g*=H)<1?g>-1?r(.25*g):-1:1,g/=H),F=(g*=O)*g>1e-5,E=g*(1-(v=Math.sin(W*m)*P+.5)),g*=v):E=0,m>=U&&(E+=C[m-U+1]*G,g+=C[m-U]*G),C[m]=0|E,C[m+1]=0|g,o[m]+=0|E,o[m+1]+=0|g}return++i/t.numChannels},this.createWave=function(){var t=44+2*n-8,e=t-36,i=new Uint8Array(44+2*n);i.set([82,73,70,70,255&t,t>>8&255,t>>16&255,t>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255]);for(var r=0,a=44;r<n;++r){var s=o[r];s=s<-32767?-32767:s>32767?32767:s,i[a++]=255&s,i[a++]=s>>8&255}return i},this.getData=function(t,e){for(var i=2*Math.floor(44100*t),n=new Array(e),r=0;r<2*e;r+=1){var a=i+r;n[r]=t>0&&a<o.length?o[a]/32768:0}return n}},R={songData:[{i:[2,151,128,0,1,147,116,9,0,5,12,22,34,0,0,0,69,3,1,1,23,167,1,27,113,7,97,6],p:[,,1,2,1,3,1,2,1,2,1,2,1,2,,,,,,,,,,,,,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[154,,,,154,,,,156,,,,157,,,156,,,149,,,,,,,,,,149,,,,142,,,,142,,,,144,,,,145,,,144,,,137,,,,,,,,,,137],f:[]},{n:[154,,,,154,,,,156,,,,157,,,161,,,159,,,156,,,154,,,,149,,,,142,,,,142,,,,144,,,,145,,,149,,,147,,,144,,,142,,,,137],f:[]},{n:[154,,,,154,,,,156,,,,157,,,161,,,159,,,156,,,154,,,,,,,,142,,,,142,,,,144,,,,145,,,149,,,146,,,144,,,142],f:[]}]},{i:[2,109,128,0,3,117,128,0,0,5,0,6,28,0,0,2,255,2,1,1,14,168,25,100,147,6,32,6],p:[1,1,1,1,1,2,1,1,1,1,1,1,1,1,,,1,1,1,1,1,1,,,,,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[118,118,118,,,,118,118,118,,,,118,118,118,,,,118,118,118,,118,118,,118,118,,118,118,118],f:[21,17,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,6]},{n:[118,118,118,,,,118,118,118,,,,118,118,118,,,,118,118,118,,118,118,,118,118,,118,118,118],f:[17,21,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,255,14]}]},{i:[3,136,128,0,1,117,140,0,0,0,76,119,164,0,0,0,0,0,0,2,5,0,0,32,0,0,24,8],p:[3,3,3,3,3,3,1,2,1,2,1,2,1,2,,,,,1,2,1,2,,,,,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[130,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,137,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,133,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142],f:[]},{n:[128,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,135,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,133,,,,,,,,,,,,,,,,132,,,,,,,,,,,,,,,,142],f:[]},{n:[142],f:[]}]},{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[,,,,,,,,,,1,2,1,2,1,2,1,2,,,,,,,,,,,,,1,2,1,2,1,2,1,2],c:[{n:[130,,133,,137,,142,,142,,137,,133,,130,,130,,133,,137,,142,,142,,137,,133,,130,,,137,,142,,145,,149,,145,,142,,137,,125,,137,,142,,145,,149,,145,,142,,137,,125],f:[]},{n:[128,,133,,135,,142,,142,,135,,133,,128,,128,,132,,135,,142,,142,,135,,132,,128,,,135,,142,,145,,147,,145,,142,,135,,123,,135,,142,,144,,147,,144,,142,,135,,123],f:[]}]},{i:[1,192,128,0,2,191,128,1,0,48,6,22,45,0,0,3,152,2,1,2,99,132,2,32,77,6,25,6],p:[,,,,,,,,,,,,,,1,2,1,2,1,2,1,2,,,,,,,,,,,,,3,4,3,4],c:[{n:[142,,,142,,,,,142,,,,,,,,142,,,142,,,,,142,,,,,,,,149,,,149,,,,,149,,,,,,,,149,,,149,,,,,149,,,,,,,,145,,,145,,,,,145,,,,,,,,145,,,145,,,,,145,,,,,,,,154,,,154,,,,,154,,,,,,,,154,,,154,,,,,154],f:[]},{n:[140,,,140,,,,,140,,,,,,,,140,,,140,,,,,140,,,,,,,,147,,,147,,,,,147,,,,,,,,147,,,147,,,,,147,,,,,,,,145,,,145,,,,,145,,,,,,,,144,,,144,,,,,144,,,,,,,,154,,,154,,,,,154,,,,,,,,154,,,154,,,,,154],f:[]},{n:[154,,,,154,,,,156,,,,157,,,156,,,149,,,,,,,,,,149,,,,142,,,,142,,,,144,,,,145,,,144,,,137,,,,,,,,,,137],f:[]},{n:[154,,,,154,,,,156,,,,157,,,161,,,159,,,156,,,154,,,,149,,,,142,,,,142,,,,144,,,,145,,,149,,,147,,,144,,,142,,,,137],f:[]}]},{i:[3,255,152,0,0,255,152,12,0,0,2,0,31,0,0,0,0,0,0,2,157,0,0,32,47,3,157,2],p:[,,,,,,,,,,,,,,,,,,,,,,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[142,,,137,,,142,,,137,,,142,,137,,142,,,137,,,142,,,137,,,142,,137,,133,,,133,,,133,,,133,,,133,,133,,133,,,133,,,133,,,133,,,133,,133],f:[]},{n:[140,,,135,,,140,,,135,,,140,,135,,140,,,135,,,140,,,135,,,140,,135,,133,,,133,,,133,,,133,,,133,,133,,132,,,132,,,132,,,132,,,132,,132],f:[]}]},{i:[2,100,128,0,3,201,128,0,0,0,5,6,58,0,0,0,195,6,1,2,135,0,0,32,147,6,121,6],p:[],c:[]},{i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,0,0,2,14,0,1,39,76,5,0,0],p:[,,,,,,1,2,1,2,1,2,1,2,1,1,1,1,1,1,1,1,3,3,1,2,1,2,1,2,1,2,1,2,1,2,1,2,3],c:[{n:[147,,,,,,147,,,,147,,,,,,147,,,,,,147,,,147,147,,,,147],f:[]},{n:[147,,,,,,147,,,,147,,,,,,147,,,,,,147,,,147,147,,147,,147,147],f:[]},{n:[147],f:[]}]},{i:[0,221,128,1,0,210,128,0,1,255,4,6,62,0,0,0,64,7,1,3,255,15,0,32,20,0,8,6],p:[,,,,,,1,1,1,1,1,1,1,1,,,1,1,1,1,1,2,,,1,2,1,2,1,2,1,1,1,1,1,1,1,1],c:[{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,147],f:[]},{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,147,147,,147],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,60,4,10,34,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,,,,,,1,1,1,1,1,1,1,1,,,,,,,1,1,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[147,,147,147,147,,147,,147,,147,147,147,,147,,147,,147,147,147,,147,,147,,147,147,147,,147,147],f:[]}]},{i:[0,0,92,0,0,0,128,0,0,128,0,1,99,0,0,0,0,0,0,1,143,55,0,51,117,3,61,6],p:[,,,,,,1,,,,1,,,,1,,1,,1,,1,,1,1,1,,1,,1,,1,,1,,,,,,1],c:[{n:[135],f:[]}]},{i:[3,255,128,0,0,255,140,0,0,127,2,2,23,0,0,0,96,3,1,3,94,79,0,32,84,2,61,4],p:[2,2,2,2,2,3,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,,,,,142,,,,,142,,,142,,,,,,,,142,,,,,142,,,142,142],f:[]},{n:[130,,,,,,142,,130,,,142,,,142,,130,,,,,,142,,130,,,142,,,142,142],f:[]},{n:[130,,,,,,142,,130,,,142,,,142,,130,,,,,,142,,130],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,255,93,128,0,0,0,2,255,4,1,2,34,239,0,32,88,1,157,2],p:[,,,,,1,2,,,,,,,1,2,,,,,,,1,2,,2,1,2,,2,,,,,,,1,,1],c:[{n:[123,,,,,,,,,,,,,,,,135,,,,,,,,,,,,,,,,123,,,,,,,,,,,,,,,,123,,,,,,,,,,,,,,,,123,,,,,,,,,,,,,,,,118],f:[10,,,,,,,,,,,,,,,,10,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,255]},{n:[123,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123],f:[10]}]},{i:[3,192,104,1,0,0,92,0,0,0,4,0,67,0,0,3,0,0,0,1,14,98,2,49,37,4,16,2],p:[,,,,,,,,,,,,,,,,,,,,,,1,2],c:[{n:[154,,,,,,,,,,,,,,,,,,,,,,,,,,166,166,161,,154],f:[]},{n:[154,,,,,,,,166,,,166,,,166,,,,166,166,166,,,,,,166,166,161,,154],f:[]}]}],rowLen:5088,patternLen:32,endPattern:38,numChannels:14};AFRAME.registerElement("a-asset-song",{prototype:Object.create(AFRAME.ANode.prototype,{createdCallback:{value:function(){this.isAssetItem=!0}},attachedCallback:{value:function(){var t=new F;t.init(R);for(var e=!1;!e;)if(e=t.generate()>=1){var i=t.createWave(),n=document.createElement("audio");n.volume=.2,n.addEventListener("ended",(function(){this.currentTime=0,this.play()}),!1),n.src=URL.createObjectURL(new Blob([i],{type:"audio/wav"})),document.querySelector("a-scene").setAttribute("visible","true"),n.play()}}}})}),AFRAME.registerComponent("bunker",{schema:{position:{type:"vec3"}},init:function(){let t=b([0,1,0,-.5,0,-.5,.5,0,-.5,.5,0,.5,-.5,0,.5],[0,1,2,0,2,3,0,3,4,0,4,1]);this.el.setObject3D("mesh",t)}}),AFRAME.registerComponent("gun",{init:function(){let t=b([-.05,.03,-.44,-.06,.02,-.42,-.05,.04,-.41,-.05,.02,-.05,-.05,.02,.05,-.03,.09,.2,-.05,.1,-.44,-.06,.12,-.42,-.02,.14,-.05,-.05,.15,.05,-.03,.15,.2,.05,.03,-.44,.06,.02,-.42,.05,.04,-.41,.05,.02,-.05,.05,.02,.05,.03,.09,.2,.06,.12,-.42,.05,.09,-.41,.05,.15,-.03,.05,.15,.05,.03,.15,.2,-.04,-.04,-.05,-.04,-.03,.05,.03,-.04,-.05,.03,-.03,.05,-.04,-.13,-.05,.03,-.13,-.05,-.04,-.03,-.14,.03,-.03,-.14,-.04,-.1,-.15,.03,-.1,-.15,-.02,.12,-.41,-.05,.09,-.41,-.05,.15,-.03,-.05,.11,-.05,.02,.12,-.41,.02,.14,-.05,.05,.11,-.05,-.05,.03,-.47,-.03,.12,-.47,.05,.03,-.47,.05,.1,-.47,-.03,.12,-.44,.03,.12,-.44,.05,.1,-.44,-.05,.1,-.47,.03,.12,-.47],[7,1,0,33,2,1,2,33,35,35,3,2,3,34,9,9,4,3,4,9,10,10,5,4,11,12,17,17,45,11,12,13,18,13,14,38,38,18,13,14,15,20,20,38,14,15,16,21,21,20,15,0,1,12,12,11,0,1,2,13,13,12,1,2,3,14,14,13,2,4,5,16,16,15,4,5,10,21,21,16,5,10,9,20,20,21,10,9,8,37,19,20,9,8,32,36,36,37,8,17,36,32,7,43,44,46,39,41,41,47,40,3,4,23,23,22,3,15,14,24,24,25,15,14,3,22,22,24,14,4,15,25,25,23,4,22,23,26,23,25,27,27,26,23,25,24,27,29,28,30,30,31,29,26,27,31,31,30,26,24,22,28,28,29,24,22,26,30,30,28,22,27,24,29,29,31,27,7,32,33,8,34,35,18,36,17,19,37,38,3,35,34,20,19,38,9,34,8,1,7,33,33,32,35,8,35,32,12,18,17,36,18,37,38,37,18,9,37,19,17,32,7,6,0,39,39,46,6,11,45,42,42,41,11,0,11,41,41,39,0,44,43,40,40,47,44,6,43,7,17,44,45,0,6,7,41,42,47,7,44,17,41,40,46,43,6,40,46,40,6,45,44,42,47,42,44]);this.el.setObject3D("mesh",t)}}),AFRAME.registerComponent("appear",{schema:{},init:function(){this.el.setAttribute("scale","0 0 0"),this.scale=0,this.delay=1e3*Math.random()},tick:function(t,e){this.delay>0?this.delay-=e:(this.scale+=.015*e,this.el.object3D.scale.setScalar(this.scale),this.scale>1.5&&this.el.removeAttribute("appear"))}})}])</script><body><a-scene visible=false><a-assets><a-asset-song></a-asset-song></a-assets><a-entity><a-plane position="0 100 -430" scale="230 230 230" sun></a-plane></a-entity><a-entity id=titlescreen><a-plane position="0 0 -2" scale="4 4 4" rotation="-14.5 0 0" titlescreen></a-plane><a-plane position="0 .64 -1.9" scale="2 2 2" neontext="text:Press fire to start"></a-plane></a-entity><a-entity id=gameoverscreen visible=false><a-plane position="0 -.25 -2" scale="5 5 5" rotation="-14.5 0 0" titlescreen="text:Game Over"></a-plane><a-plane position="0 .30 -1.9" scale="3 3 3" neontext="text:Press fire to restart;fontsize:125"></a-plane><a-plane position="0 .05 -1.6" scale="3 3 3" neontext="text:312 invaders shot;fontsize:60;color:#1b90e2" id=score></a-plane></a-entity><a-entity game><a-entity id=invaders></a-entity><a-entity id=missiles></a-entity><a-entity id=bunkers><a-entity scale="2 2 2" scale="1 1 1" bunker position="-5 0 -3" wireframe-material=color:#df497c;thickness:0.005;fillcolor:#170608></a-entity><a-entity scale="2 2 2" scale="1 1 1" bunker position="5 0 -3" wireframe-material=color:#df497c;thickness:0.005;fillcolor:#170608></a-entity><a-entity scale="2 2 2" scale="1 1 1" bunker position="-5 0 3" wireframe-material=color:#df497c;thickness:0.005;fillcolor:#170608></a-entity><a-entity scale="2 2 2" scale="1 1 1" bunker position="5 0 3" wireframe-material=color:#df497c;thickness:0.005;fillcolor:#170608></a-entity></a-entity><a-entity mountains position="0 -1 0" wireframe-material=color:#497cdf></a-entity><a-entity ground wireframe-material=color:#FF00FF;thickness:0.005></a-entity></a-entity><a-sky space></a-sky><a-entity shoot-controls=hand:right><a-entity visible=false gun wireframe-material=color:#FF0></a-entity></a-entity><a-entity camera look-controls=pointerLockEnabled:true position="0 1.6 0" rotation="0 0 0"><a-entity id=missile-spawner></a-entity></a-entity></a-scene>