<style>*{margin:0}body{align-items:center;background:#000;display:flex;justify-content:center}canvas{background:#fff;image-rendering:pixelated}main{filter:brightness(0);transition:5s filter}main.loaded{filter:brightness(1)}.scanlines{position:relative;overflow:hidden}.scanlines:after,.scanlines:before{display:block;pointer-events:none;content:"";position:absolute}.scanlines:before{width:100%;height:2px;z-index:2147483649;background:rgba(57,255,20,.12);opacity:.75;animation:scanline 6s linear infinite}.scanlines:after{top:0;right:0;bottom:0;left:0;z-index:2147483648;background:linear-gradient(to bottom,transparent 50%,rgba(57,255,20,.12) 51%);background-size:100% 4px;animation:scanlines 1s steps(60) infinite}@keyframes scanline{0%{transform:translate3d(0,200000%,0)}}@keyframes scanlines{0%{background-position:0 50%}}</style><main class=scanlines><canvas id=c width=640 height=480></canvas></main><script>!function(e){var t={};function i(s){if(t[s])return t[s].exports;var a=t[s]={i:s,l:!1,exports:{}};return e[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=e,i.c=t,i.d=function(e,t,s){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:s})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(s,a,function(t){return e[t]}.bind(null,a));return s},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=4)}([function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",(function(){return Sound}));var jsfxr__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(1),jsfxr__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(jsfxr__WEBPACK_IMPORTED_MODULE_0__);class Sound{constructor(){this.state={engine:!1}}engineOn(){}engineOff(){}playSound(url){let soundUrl=jsfxr__WEBPACK_IMPORTED_MODULE_0___default()(eval(url)),player=new Audio;player.src=soundUrl,player.play()}mainLaser(){this.playSound("[2,,0.1749,,0.3063,0.713,0.2,-0.2645,,,,,,0.0543,0.1546,,,,1,,,,,0.5]")}secondaryLaser(){this.playSound("[2,,0.1426,,0.2251,0.7799,0.2555,-0.2285,,,,,,0.7631,-0.4501,,,,1,,,0.0846,,0.5]")}missile(){this.playSound("[3,,0.0937,0.571,0.3803,0.7495,,,,,,,,,,,,,1,,,,,0.5]")}projectileHit(){this.playSound("[3,,0.0867,,0.2283,0.2711,,-0.6853,,,,,,,,,,,1,,,,,0.5]")}enemyLaser(){this.playSound("[0,,0.2934,0.1381,0.2143,0.6919,0.3422,-0.2379,,,,,,0.4281,-0.6711,,,,1,,,0.194,,0.5]")}}},function(e,t,i){function s(){this.setSettings=function(e){for(var t=0;t<24;t++)this[String.fromCharCode(97+t)]=e[t]||0;this.c<.01&&(this.c=.01);var i=this.b+this.c+this.e;if(i<.18){var s=.18/i;this.b*=s,this.c*=s,this.e*=s}}}var a=new function(){var e,t,i,a,r,o,n,h,l,d,c,m;this._params=new s,this.reset=function(){var e=this._params;a=100/(e.f*e.f+.001),r=100/(e.g*e.g+.001),o=1-e.h*e.h*e.h*.01,n=-e.i*e.i*e.i*1e-6,e.a||(c=.5-e.n/2,m=5e-5*-e.o),h=1+e.l*e.l*(e.l>0?-.9:10),l=0,d=1==e.m?0:(1-e.m)*(1-e.m)*2e4+32},this.totalReset=function(){this.reset();var s=this._params;return e=s.b*s.b*1e5,t=s.c*s.c*1e5,i=s.e*s.e*1e5+12,3*((e+t+i)/3|0)},this.synthWave=function(s,f){var p=this._params,u=1!=p.s||p.v,y=p.v*p.v*.1,w=1+3e-4*p.w,x=p.s*p.s*p.s*.1,g=1+1e-4*p.t,M=1!=p.s,C=p.x*p.x,b=p.g,v=p.q||p.r,S=p.r*p.r*p.r*.2,k=p.q*p.q*(p.q<0?-1020:1020),L=p.p?32+((1-p.p)*(1-p.p)*2e4|0):0,j=p.d,_=p.j/2,z=p.k*p.k*.01,E=p.a,P=e,O=1/e,A=1/t,F=1/i,D=5/(1+p.u*p.u*20)*(.01+x);D>.8&&(D=.8),D=1-D;for(var B,T,H,I,W,R,q=!1,U=0,Y=0,Q=0,X=0,K=0,N=0,G=0,$=0,J=0,Z=0,V=new Array(1024),ee=new Array(32),te=V.length;te--;)V[te]=0;for(te=ee.length;te--;)ee[te]=2*Math.random()-1;for(te=0;te<f;te++){if(q)return te;if(L&&++J>=L&&(J=0,this.reset()),d&&++l>=d&&(d=0,a*=h),(a*=o+=n)>r&&(a=r,b>0&&(q=!0)),T=a,_>0&&(Z+=z,T*=1+Math.sin(Z)*_),(T|=0)<8&&(T=8),E||((c+=m)<0?c=0:c>.5&&(c=.5)),++Y>P)switch(Y=0,++U){case 1:P=t;break;case 2:P=i}switch(U){case 0:Q=Y*O;break;case 1:Q=1+2*(1-Y*A)*j;break;case 2:Q=1-Y*F;break;case 3:Q=0,q=!0}v&&((H=0|(k+=S))<0?H=-H:H>1023&&(H=1023)),u&&w&&((y*=w)<1e-5?y=1e-5:y>.1&&(y=.1)),R=0;for(var ie=8;ie--;){if(++G>=T&&(G%=T,3==E))for(var se=ee.length;se--;)ee[se]=2*Math.random()-1;switch(E){case 0:W=G/T<c?.5:-.5;break;case 1:W=1-G/T*2;break;case 2:W=.225*(((W=1.27323954*(I=6.28318531*((I=G/T)>.5?I-1:I))+.405284735*I*I*(I<0?1:-1))<0?-1:1)*W*W-W)+W;break;case 3:W=ee[Math.abs(32*G/T|0)]}u&&(B=N,(x*=g)<0?x=0:x>.1&&(x=.1),M?(K+=(W-N)*x,K*=D):(N=W,K=0),X+=(N+=K)-B,W=X*=1-y),v&&(V[$%1024]=W,W+=V[($-H+1024)%1024],$++),R+=W}R*=.125*Q*C,s[te]=R>=1?32767:R<=-1?-32768:32767*R|0}return f}};e.exports=function(e){a._params.setSettings(e);var t=a.totalReset(),i=new Uint8Array(4*((t+1)/2|0)+44),s=2*a.synthWave(new Uint16Array(i.buffer,44),t),r=new Uint32Array(i.buffer,0,44);r[0]=1179011410,r[1]=s+36,r[2]=1163280727,r[3]=544501094,r[4]=16,r[5]=65537,r[6]=44100,r[7]=88200,r[8]=1048578,r[9]=1635017060,r[10]=s,s+=44;for(var o=0,n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h="data:audio/wav;base64,";o<s;o+=3){var l=i[o]<<16|i[o+1]<<8|i[o+2];h+=n[l>>18]+n[l>>12&63]+n[l>>6&63]+n[63&l]}return h}},function(e,t,i){e.exports=function(){return i(3)('!function(n){var t={};function e(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return n[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}e.m=n,e.c=t,e.d=function(n,t,r){e.o(n,t)||Object.defineProperty(n,t,{enumerable:!0,get:r})},e.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})},e.t=function(n,t){if(1&t&&(n=e(n)),8&t)return n;if(4&t&&"object"==typeof n&&n&&n.__esModule)return n;var r=Object.create(null);if(e.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&t&&"string"!=typeof n)for(var i in n)e.d(r,i,function(t){return n[t]}.bind(null,i));return r},e.n=function(n){var t=n&&n.__esModule?function(){return n.default}:function(){return n};return e.d(t,"a",t),t},e.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},e.p="",e(e.s=0)}([function(n,t,e){"use strict";var r={songData:[{i:[0,100,128,0,1,201,128,0,0,0,0,8,28,0,0,0,194,4,1,3,25,191,115,244,147,6,43,4],p:[5,1,2,2,1,1,1,1,3,4,1,2,1,2,1,2,,,7,7,7,7,7,7,7,7],c:[{n:[132,132,134,134,135,135,132,132,137,137,135,135,134,134,135,135,139,139,137,137,135,135,137,137,134,,133,,132,,131],f:[21,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,48]},{n:[132,132,134,134,135,135,132,132,137,137,135,135,134,134,135,135,139,139,137,137,135,135,137,137,139,139,135,135,134,134,130,130],f:[,,,,,,,,,,,,,,,,,,,,,,,,,,,11,13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,31]},{n:[],f:[]},{n:[159,,,,,,,,158,,,,,,,,157,,,,,,,,156,155,154,153,152,151,150,149],f:[13,,,,,,,,,,,,,,,,,,,,,,,,13,,13,,13,,13,11,29,,,,,,,,,,,,,,,,,,,,,,,,32,,41,,29,,25,15]},{n:[132,132,134,134,135,135,132,132,137,137,135,135,134,134,135,135,139,139,137,137,135,135,137,137,139,139,135,135,134,134,130,130],f:[13,11,21,17,,,,,,,,,,,,,,,,,,,,,,,,,,,,17,29,,25,113,,,,,,,,,,,,,,,,,,,,,,,,,,,,194]},{n:[120,,,,,,,,132,,,,,,,,120,,,,,,,,108],f:[]},{n:[132,144,134,146,132,144,135,147,132,144,137,149,132,144,139,151,140,152,139,151,137,149,139,151,138,150,137,149,135,147,134,146],f:[]}]},{i:[0,255,117,1,0,255,110,0,1,0,4,6,35,0,0,0,0,0,0,2,14,1,1,39,76,5,0,0],p:[,,1,3,1,3,1,3,2,,,,1,3,1,3,1,3,,,1,3,1,3,1,3],c:[{n:[147,,,,,,147,,,,147,,,,,,147,,,,,,147,,,,147,,,,147],f:[]},{n:[147],f:[]},{n:[147,,,,,,147,,,,147,,,,147,,147,,,,,,147,,,,147,,,,147,147],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,60,4,10,68,0,0,0,187,5,0,1,239,135,0,32,108,5,16,4],p:[,,1,1,2,3,2,3,4,,,,2,3,2,3,2,3,,,5,5,5,5,5,5],c:[{n:[,,,,147,,,,,,,,148,,,,,,,,147,,,,,,,,147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[,,,,147,,,147,,,,,148,,,,,,,,147,,,147,,,147,,,,147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[,,,,147,,,147,,,,,148,,,,,,,,147,,,147,,,147,,,147,147,147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]},{n:[147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,68]},{n:[147,,,147,,,147,,147,,,147,,147,,147,147,,,147,,,147,,147,,,147,,147,,147],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,35]}]},{i:[2,192,128,0,2,192,140,18,0,0,107,115,138,0,0,0,136,5,1,2,8,93,22,56,148,5,85,8],p:[3,,2,1,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2],c:[{n:[120],f:[]},{n:[120],f:[]},{n:[120],f:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,56]}]},{i:[3,0,127,0,3,68,127,0,1,218,11,0,40,0,0,1,55,4,1,2,67,115,124,190,67,6,39,1],p:[,,,2,1,2,1,2,3,,,,1,2,1,2,1,2,,,1,4,1,4,1,4],c:[{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,147],f:[]},{n:[,,,,147,,,,,,147,,147,,,,,,,,147,,,,,,,,147],f:[]},{n:[147],f:[]},{n:[,,,,147,,,,,,,,147,,,,,,,,147,,,,,,,,147,,,147],f:[]}]},{i:[3,91,128,0,0,95,128,12,0,0,12,0,67,0,0,0,0,0,0,2,255,15,0,32,83,3,51,4],p:[,,,,1,2,1,2,1,2,,,1,2,3,2,1,2,,,,,5,4,5,4],c:[{n:[156,,,164,,,163,,161,,,,,,,,,,158,,159,,161,,159,,158,,159,,154,,159],f:[5,13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,67]},{n:[144,,,147,,,149,,151,,,,,,,,,,149,,151,,152,,151,,151,,147,,147,,139],f:[]},{n:[156,,,156,,,156,,154,,,154,,,154,,152,,,152,,,152,,151,,,147,,,146,,,,151,,,151,,151,,,146,,,146,,146,,,144,,,144,,144,,,142,,,139,,137],f:[5,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,3]},{n:[163,,164,,166,,163,,163,,164,,166,,163,,163,,164,,166,,163,,163,,164,,166,,163],f:[13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,25]},{n:[168,,170,,171,,168,,168,,170,,171,,168,,159,,159,,158,,158,,157,,157,,156,,156],f:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,13,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,67]}]},{i:[0,146,140,0,1,224,128,3,0,0,61,0,63,0,0,3,179,5,1,3,37,162,0,67,150,3,37,2],p:[,1,,,,,,,,,1,2,3,,1,2,1,2,3,,4,5],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,122,,121,,120,,119],f:[]},{n:[,,,,,,,,,,,,110,109,,,,,,,,,,,,,,,132,144,120,108],f:[11,,,,,,,,,,,,,,,,,,,,,,,,,,,,11,,,,95,,,,,,,,,,,,,,,,,,,,,,,,,,,,29]},{n:[123],f:[24,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,24,52,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,67]},{n:[120,,,,,,120,,120,,,,,,,,,,,,,,,,,,,,,,,,123,,,,,,123,,123,,,,,,,,,,,,,,,,,,,,,,,,125,,,,,,125,,125],f:[11,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,95]},{n:[120,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,123,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,125],f:[]}]},{i:[2,138,116,0,2,138,128,4,0,0,47,48,107,124,3,0,139,4,1,3,64,160,3,32,147,4,121,5],p:[,,,,,,,,1,,,,,,,,,,1],c:[{n:[156,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,168],f:[]}]}],rowLen:5513,patternLen:32,endPattern:25,numChannels:8};let i=new function(){var n,t,e,r,i,f=function(n){return Math.sin(6.283184*n)},o=function(n){return.003959503758*Math.pow(2,(n-128)/12)},a=function(n,t,e){var r,i,f,a,c,l,p,s=u[n.i[0]],v=n.i[1],d=n.i[3],h=u[n.i[4]],y=n.i[5],g=n.i[8],w=n.i[9],M=n.i[10]*n.i[10]*4,b=n.i[11]*n.i[11]*4,m=n.i[12]*n.i[12]*4,j=1/m,O=n.i[13],P=e*Math.pow(2,2-n.i[14]),L=new Int32Array(M+b+m),_=0,x=0;for(r=0,i=0;r<M+b+m;r++,i++)i>=0&&(i-=P,l=o(t+(15&(O=O>>8|(255&O)<<4))+n.i[2]-128),p=o(t+(15&O)+n.i[6]-128)*(1+8e-4*n.i[7])),f=1,r<M?f=r/M:r>=M+b&&(f-=(r-M-b)*j),a=l,d&&(a*=f*f),c=s(_+=a)*v,a=p,g&&(a*=f*f),c+=h(x+=a)*y,w&&(c+=(2*Math.random()-1)*w),L[r]=80*c*f|0;return L},u=[f,function(n){return n%1<.5?1:-1},function(n){return n%1*2-1},function(n){var t=n%1*4;return t<2?t-1:3-t}];this.init=function(f){n=f,t=f.endPattern,e=0,r=f.rowLen*f.patternLen*(t+1)*2,i=new Int32Array(r)},this.generate=function(){var o,c,l,p,s,v,d,h,y,g,w,M,b,m,j=new Int32Array(r),O=n.songData[e],P=n.rowLen,L=n.patternLen,_=0,x=0,A=!1,S=[];for(l=0;l<=t;++l)for(d=O.p[l],p=0;p<L;++p){var I=d?O.c[d-1].f[p]:0;I&&(O.i[I-1]=O.c[d-1].f[p+L]||0,I<16&&(S=[]));var D=u[O.i[15]],C=O.i[16]/512,T=Math.pow(2,O.i[17]-9)/P,W=O.i[18],U=O.i[19],k=43.23529*O.i[20]*3.141592/44100,q=1-O.i[21]/255,z=1e-5*O.i[22],B=O.i[23]/32,E=O.i[24]/512,F=6.283184*Math.pow(2,O.i[25]-9)/P,G=O.i[26]/255,H=O.i[27]*P&-2;for(w=(l*L+p)*P,s=0;s<4;++s)if(v=d?O.c[d-1].n[p+s*L]:0){S[v]||(S[v]=a(O,v,P));var J=S[v];for(c=0,o=2*w;c<J.length;c++,o+=2)j[o]+=J[c]}for(c=0;c<P;c++)(g=j[h=2*(w+c)])||A?(M=k,W&&(M*=D(T*h)*C+.5),x+=(M=1.5*Math.sin(M))*(b=q*(g-x)-(_+=M*x)),g=3==U?x:1==U?b:_,z&&(g=(g*=z)<1?g>-1?f(.25*g):-1:1,g/=z),A=(g*=B)*g>1e-5,m=g*(1-(y=Math.sin(F*h)*E+.5)),g*=y):m=0,h>=H&&(m+=j[h-H+1]*G,g+=j[h-H]*G),j[h]=0|m,j[h+1]=0|g,i[h]+=0|m,i[h+1]+=0|g}return++e/n.numChannels},this.createWave=function(){var n=44+2*r-8,t=n-36,e=new Uint8Array(44+2*r);e.set([82,73,70,70,255&n,n>>8&255,n>>16&255,n>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&t,t>>8&255,t>>16&255,t>>24&255]);for(var f=0,o=44;f<r;++f){var a=i[f];a=a<-32767?-32767:a>32767?32767:a,e[o++]=255&a,e[o++]=a>>8&255}return e},this.getData=function(n,t){for(var e=2*Math.floor(44100*n),r=new Array(t),f=0;f<2*t;f+=1){var o=e+f;r[f]=n>0&&o<i.length?i[o]/32768:0}return r}};i.init(r),i.init(r);let f=!1;setInterval((function(){if(!f&&(f=i.generate()>=1)){let n=i.createWave();postMessage(n)}}),10)}]);',null)}},function(e,t,i){"use strict";var s=window.URL||window.webkitURL;e.exports=function(e,t){try{try{var i;try{(i=new(window.BlobBuilder||window.WebKitBlobBuilder||window.MozBlobBuilder||window.MSBlobBuilder)).append(e),i=i.getBlob()}catch(t){i=new Blob([e])}return new Worker(s.createObjectURL(i))}catch(t){return new Worker("data:application/javascript,"+encodeURIComponent(e))}}catch(e){if(!t)throw Error("Inline worker is not supported");return new Worker(t)}}},function(e,t,i){"use strict";i.r(t);let s=null;class a{constructor(e){this.canvas=e,s=this.canvas.getContext("2d"),this.camera={x:0,y:0}}cameraAdjustX(e){return e-this.camera.x+this.canvas.width/2}cameraAdjustY(e){return e-this.camera.y+this.canvas.height/2}draw(e){s.save(),e(),s.restore()}clearBackground(){s.clearRect(0,0,this.canvas.width,this.canvas.height)}drawBackground(e){s.fillStyle=e,s.fillRect(0,0,this.canvas.width,this.canvas.height)}rect({rect:e,fillColor:t,strokeColor:i,shadowBlur:a,shadowColor:r,lineWidth:o=1,adjusted:n=!0,rotation:h,size:l}){n&&(e[0]=this.cameraAdjustX(e[0]),e[1]=this.cameraAdjustY(e[1])),h&&(s.translate(e[0]+l/2,e[1]+l/2),s.rotate(h),s.translate(-1*e[0]-l/2,-1*e[1]-l/2)),s.shadowBlur=a,s.shadowColor=r,t&&(s.fillStyle=t,s.fillRect(e[0],e[1],...e.slice(2))),i&&(s.strokeStyle=i,s.lineWidth=o,s.strokeRect(e[0],e[1],...e.slice(2)))}arc({arc:e,fillColor:t,strokeColor:i,shadowBlur:a,shadowColor:r}){s.beginPath(),s.arc(this.cameraAdjustX(e[0]),this.cameraAdjustY(e[1]),...e.slice(2)),s.shadowBlur=a,s.shadowColor=r,t&&(s.fillStyle=t,s.fill()),i&&(s.strokeStyle=i,s.stroke())}text({text:e,x:t,y:i,size:a="14px",font:r="Courier",letterSpacing:o=!1,adjusted:n=!0,filter:h,fillColor:l}){n&&(t=this.cameraAdjustX(t),i=this.cameraAdjustY(i)),h&&(s.filter=h),s.font=a+" "+r,e=o?e.split("").join(" "):e,s.fillStyle=l||"#fff",s.fillText(e,t,i)}lines({lines:e,shadowBlur:t=0,shadowColor:i,rotation:a,x:r,y:o,fillColor:n,strokeColor:h}){a&&(s.translate(this.cameraAdjustX(r),this.cameraAdjustY(o)),s.rotate(a),s.translate(-1*this.cameraAdjustX(r),-1*this.cameraAdjustY(o))),s.beginPath(),s.moveTo(this.cameraAdjustX(e[0][0]),this.cameraAdjustY(e[0][1])),e.slice(1).map((e=>s.lineTo(this.cameraAdjustX(e[0]),this.cameraAdjustY(e[1])))),s.closePath(),s.shadowBlur=t,s.shadowColor=i,h&&(s.strokeStyle=h,s.stroke()),n&&(s.fillStyle=n,s.fill())}fill({path:e,x:t,y:i,fillColor:a,strokeColor:r,rotation:o,adjusted:n=!0,centered:h=!0,size:l}){n&&(t=this.cameraAdjustX(t),i=this.cameraAdjustY(i)),o&&(s.translate(t,i),s.rotate(o),s.translate(-1*t,-1*i)),s.translate(t,i),h||s.translate(-l/2,-l/2+.5),a&&(s.fillStyle=a,s.fill(e)),r&&(s.strokeStyle=r,s.fillStyle=a||"#131",s.fill(e),s.stroke(e))}hitbox({x:e,y:t,size:i}){this.rect({rect:[e-i/2,t-i/2,i,i],color:"#f00"})}}let r=document.getElementById("c");class o{constructor(){this.canvas=r}initialize(){let e=document.querySelector("body"),t=t=>{e.clientWidth/e.clientHeight>640/480?(r.style.height="100vh")&&(r.style.width="auto"):(r.style.height="auto")&&(r.style.width="100vw")};t(),e.onresize=t}}var n=i(0),h=i(2),l=i.n(h);class d{constructor(){(new l.a).onmessage=function(e){let t=e.data,i=document.createElement("audio");i.src=URL.createObjectURL(new Blob([t],{type:"audio/wav"})),i.volume=.5,i.loop=!0,function e(t){t.then((e=>{})).catch((t=>{setTimeout((()=>{let t=i.play();e(t)}),1e3)}))}(i.play())}}}class c{handle(e,t){return!e.exploding&&!t.exploding&&e.x<t.x+t.size/2&&e.x+e.size>t.x-t.size/2&&e.y<t.y+t.size/2&&e.y+e.size>t.y-t.size/2&&(e.destroy(),t.takeDamage(e),!0)}}let m=[],f=[];function p(e,t){return(e%t+t)%t}class u{constructor({cw:e,ch:t}){for(let i=0;i<100;i++)m.push([Math.random()*e,Math.random()*t,Math.random()]);for(let i=0;i<100;i++)f.push([Math.random()*e,Math.random()*t,Math.random()])}draw(e){e.draw((()=>{e.drawBackground("#111"),m.map((t=>e.rect({rect:[p(t[0]-e.camera.x/(3+3*t[2]),e.canvas.width),p(t[1]-e.camera.y/(3+3*t[2]),e.canvas.height),1,1],fillColor:"rgba(255, 255, 255, 0.6)",adjusted:!1}))),f.map((t=>e.rect({rect:[p(t[0]-e.camera.x/(7+3*t[2]),e.canvas.width),p(t[1]-e.camera.y/(7+3*t[2]),e.canvas.height),1,1],fillColor:"rgba(255, 255, 255, 0.3)",adjusted:!1}))),e.text({text:"back to earth",x:-145,y:-95,size:"36px",font:"serif",letterSpacing:!0}),e.text({text:"Arrow keys to move. SPACE to shoot.",x:-145,y:105}),e.text({text:"ENTER to land back on earth.",x:-115,y:130}),e.text({text:"Shoot things. Collect ore. Upgrade weapons.",x:-178,y:155})}))}}let y=new Path2D("m 6 0 l -6 5 l 6 5 z");class w{constructor(){this.compasses=[{x:0,y:0,theta:0,color:"#fff",visible:!1}],this.timer=0,this.worlds=[],this.finalEncounter=!0,this.finalEncounterStarted=!1}createWorld(){let e=Math.random()*Math.PI*2,t=2e3*Math.sin(e),i=2e3*Math.cos(e);this.worlds.push({x:t,y:i,color:"red"}),this.compasses.push({x:t,y:i,theta:0,color:"red",visible:!1})}distanceToWorld(e,t){return Math.sqrt(Math.pow(e.getX()-t.x,2)+Math.pow(e.getY()-t.y,2))}tick(e,t,i){this.timer+=1,this.compasses=this.compasses.map((t=>(t.visible=this.distanceToWorld(e,t)>300,t.theta=Math.atan2(e.getY()-t.y,e.getX()-t.x),t))),this.compasses[1]&&this.distanceToWorld(e,this.compasses[1])<400&&this.finalEncounter&&(this.finalEncounter=!1,t.makeEncounter(e,i),this.finalEncounterStarted=!0),this.finalEncounterStarted&&0===i.enemies.length&&(e.finalHalo=[this.compasses[1].x,this.compasses[1].y])}draw(e){this.worlds.forEach((t=>e.draw((()=>{e.arc({arc:[t.x,t.y,200,0,2*Math.PI],fillColor:"#ff8",shadowBlur:10,shadowColor:"#ff0"})})))),this.compasses.forEach((t=>t.visible&&e.draw((()=>{e.fill({path:y,x:Math.cos(t.theta)*(5*Math.sin(this.timer/10)-200)+320,y:Math.sin(t.theta)*(5*Math.sin(this.timer/10)-200)+240,rotation:t.theta,fillColor:t.color,adjusted:!1})}))))}}class x{constructor(){this.timeout=15}tick(e,t,i,s,a,r){if(e.isDown(e.ENTER)&&this.timeout<0&&(this.timeout=15,t.landed=!1,t.timeout=15,t.setDx(0),t.setDy(0),i.initializeAsteroids(),t.heal(),t.healed=!1),this.timeout-=1,e.isDown(e.SPACE)&&this.timeout<0){if(this.timeout=15,t.level>=t.shipLevels.length-1)return;let e=t.shipLevels[t.level+1].cost;t.ore>=e&&(t.ore-=e,t.setLevel(t.level+1),t.level>=9&&r.createWorld(),a.makeEncounter(t,s))}}draw(e,t){let i=t=>e.text({text:t[2],x:t[0],y:t[1],adjusted:!1,fillColor:t[3]||"#fff"});e.draw((()=>{e.rect({rect:[0,0,640,480],fillColor:"rgba(0, 0, 0, 0.6)",adjusted:!1}),e.rect({rect:[150,90,340,300],fillColor:"#fff",adjusted:!1}),e.rect({rect:[151,91,338,298],fillColor:"#000",shadowBlur:2,shadowColor:"#fff",adjusted:!1})})),e.draw((()=>{if(e.text({text:"Welcome to Earth",x:210,y:120,size:"20px",font:"serif",letterSpacing:!0,adjusted:!1}),t.healed&&i([207,142,"Your ship has been repaired","#9f9"]),t.level>=t.shipLevels.length-1)i([212,210,"You have all ship upgrades"]);else{let e=t.shipLevels[t.level+1];i([230,165,"Next ship improvements"]),e.descriptions.forEach((e=>i(e))),i([252,270,`Cost:     ${e.cost} ore`,"#ffa"]),i([218,300,`You have:     ${t.ore} ore`]),i([230,335,"SPACE to upgrade ship"])}i([235,360,"ENTER to leave Earth"])}))}}class g{draw(e){e.draw((()=>{e.text({text:"🌎",x:-65,y:35,size:"100px",color:"blue",filter:"contrast(75%) brightness(60%) saturate(40%) hue-rotate(-10deg)"})}))}}class M{constructor(){this.timeout=1800}makeEnemy(e){let t=Math.random()*Math.PI*2;return[(500+100*Math.random())*Math.sin(t)+e.getX(),(500+100*Math.random())*Math.cos(t)+e.getY(),e.level]}makeEncounter(e,t){let i=t.enemies.length;if(e.level>=1)for(let s=0;s<e.level-i;s++)t.addEnemy(...this.makeEnemy(e));this.timeout=60*(10*Math.random()+10+e.level)}tick(e,t){this.timeout-=1,this.timeout<=0&&e.level<9&&(this.makeEncounter(e,t),this.timeout=60*(10*Math.random()+30))}}class C{constructor({x:e,y:t,color:i="#fff"}){this.x=e,this.y=t,this.color=i,this.dx=4*Math.random()-2,this.dy=4*Math.random()-2,this.shouldDie=!1,this.exploding=!1}tick(){this.x+=this.dx,this.y+=this.dy}draw(e){e.draw((()=>{e.rect({rect:[this.x,this.y,2,2],fillColor:this.color,shadowBlur:2,shadowColor:this.color})}))}}let b={"main-laser":{color:"#3ff",shadowColor:"#0ff",speed:4,lifeSpan:4},"enemy-laser":{color:"#f00",shadowColor:"#f00",speed:4,lifeSpan:4},"secondary-laser":{color:"#f6f",shadowColor:"#f0f",speed:10,lifeSpan:1,line:8},"enemy-secondary-laser":{color:"#f00",shadowColor:"#f00",speed:10,lifeSpan:1,line:8},missile:{type:"missile",color:"#ff0",shadowColor:"#ff0",speed:.8,lifeSpan:10,maxSpeed:5,arc:2,largeExplosion:!0},"enemy-missile":{type:"missile",color:"#f60",shadowColor:"#f60",speed:.8,lifeSpan:10,maxSpeed:5,arc:2,largeExplosion:!0},beam:{type:"beam",color:"#3ff",shadowColor:"#0ff",speed:100,lifeSpan:.06},"enemy-beam":{type:"beam",color:"#f66",shadowColor:"#f66",speed:100,lifeSpan:.06}};class v{constructor({x:e,y:t,yaw:i,damage:s,type:a,owner:r,target:o}){this.type=b[a],this.x=e,this.y=t,this.yaw=i,this.owner=r,this.lifeSpan=1e3*this.type.lifeSpan/60,this.size=1,this.shouldDie=!1,this.damage=s,this.exploding=!1,this.dx=Math.sin(this.yaw)*this.type.speed,this.dy=-Math.cos(this.yaw)*this.type.speed,this.target=o}tick(){if(this.lifeSpan-=1,this.lifeSpan<=0&&(this.shouldDie=!0),!this.exploding){if("missile"===this.type.type){let e,t;if(this.target&&!this.target.exploding&&this.lifeSpan<1e3*(this.type.lifeSpan-.5)/60){e=this.x-this.target.x,t=this.y-this.target.y;let i=Math.sqrt(e*e+t*t);e=e/i*this.type.speed,t=t/i*this.type.speed}else e=this.dx*-this.type.speed,t=this.dy*-this.type.speed;this.dx-=e,this.dy-=t;let i=Math.sqrt(this.dx*this.dx+this.dy*this.dy);i>this.type.maxSpeed&&(this.dx=this.dx/i*this.type.maxSpeed,this.dy=this.dy/i*this.type.maxSpeed)}"beam"===this.type.type?this.target.takeDamage({damage:this.damage,dx:0,dy:0,owner:this.owner}):(this.x+=this.dx,this.y+=this.dy)}}destroy(){this.exploding=!0,this.lifeSpan=2}draw(e){e.draw((()=>{if(this.exploding)e.arc({arc:[this.x,this.y,4/this.lifeSpan*(this.type.largeExplosion?2:1),0,2*Math.PI],fillColor:"#ff8",shadowBlur:10,shadowColor:"#ff0"});else if(this.type.line)e.rect({rect:[this.x,this.y,1,this.type.line],fillColor:this.type.color,shadowBlur:2,shadowColor:this.type.shadowColor,rotation:this.yaw,size:1});else if(this.type.arc)e.arc({arc:[this.x,this.y,this.type.arc,0,2*Math.PI],fillColor:this.type.color,shadowBlur:1,shadowColor:this.type.color});else if("beam"===this.type.type){let t=Math.sqrt(Math.pow(this.owner.x-this.target.x,2)+Math.pow(this.owner.y-this.target.y,2)),i=Math.atan2(this.owner.x-this.target.x,-this.owner.y+this.target.y);e.rect({rect:[this.owner.x,this.owner.y,1,t],fillColor:this.type.color,shadowBlur:2,shadowColor:this.type.shadowColor,rotation:i,size:1})}else e.rect({rect:[this.x,this.y,2,2],fillColor:this.type.color,shadowBlur:2,shadowColor:this.type.shadowColor})}))}}function S({canFire:e,cooldown:t,x:i,y:s,yaw:a,type:r,owner:o,sound:n}){e&&(o.projectiles.push(new v({x:i,y:s,yaw:a,damage:1,type:r,owner:o})),o.mainLaserCanFire=!1,window.setTimeout((()=>o.mainLaserCanFire=!0),1e3*t),n())}function k({canFire:e,cooldown:t,x:i,y:s,yaw:a,type:r,owner:o,sound:n}){e&&(o.projectiles.push(new v({x:i,y:s,yaw:a,damage:1,type:r,owner:o})),o.secondaryLaserPosition*=-1,o.secondaryLaserCanFire=!1,window.setTimeout((()=>o.secondaryLaserCanFire=!0),1e3*t),n())}function L({canFire:e,cooldown:t,x:i,y:s,yaw:a,type:r,owner:o,target:n,sound:h}){e&&(o.projectiles.push(new v({x:i,y:s,yaw:a,damage:1,type:r,owner:o,target:n})),o.missilePosition*=-1,o.missileCanFire=!1,window.setTimeout((()=>o.missileCanFire=!0),1e3*t),h())}function j({canFire:e,cooldown:t,x:i,y:s,yaw:a,type:r,owner:o,target:n,sound:h}){e&&(o.projectiles.push(new v({x:i,y:s,yaw:a,damage:.03,type:r,owner:o,target:n})),h())}var _=[[],[{speed:"slow",size:"medium",health:"medium",weapons:["main"]}],[{speed:"slow",size:"medium",health:"medium",weapons:["main","secondary"]},{speed:"medium",size:"medium",health:"medium",weapons:["main"]}],[{speed:"medium",size:"small",health:"weak",weapons:["main"]},{speed:"slow",size:"medium",health:"medium",weapons:["main"]},{speed:"slow",size:"medium",health:"medium",weapons:["main","secondary"]}],[{speed:"medium",size:"medium",health:"weak",weapons:["missile"]},{speed:"medium",size:"small",health:"weak",weapons:["main"]},{speed:"slow",size:"medium",health:"medium",weapons:["main","secondary"]}],[{speed:"fast",size:"small",health:"medium",weapons:["main"]},{speed:"medium",size:"medium",health:"weak",weapons:["main","missile"]},{speed:"medium",size:"medium",health:"medium",weapons:["main","secondary"]}],[{speed:"fast",size:"small",health:"medium",weapons:["beam"]},{speed:"medium",size:"medium",health:"medium",weapons:["main","missile"]},{speed:"medium",size:"medium",health:"medium",weapons:["main","secondary"]}],[{speed:"slow",size:"large",health:"strong",weapons:["main","secondary"]},{speed:"medium",size:"medium",health:"strong",weapons:["main","secondary"]},{speed:"fast",size:"small",health:"medium",weapons:["beam"]}],[{speed:"medium",size:"large",health:"strong",weapons:["main","secondary"]},{speed:"medium",size:"medium",health:"strong",weapons:["main","secondary"]},{speed:"fast",size:"small",health:"medium",weapons:["beam"]}],[{speed:"fast",size:"large",health:"strong",weapons:["main","secondary","missile"]},{speed:"fast",size:"medium",health:"strong",weapons:["main","secondary"]},{speed:"fast",size:"small",health:"strong",weapons:["beam","secondary"]}]],z="M 2 16 Q 0 8 4 8 C 8 6 6 8 8 4 L 10 2 L 12 4 C 14 8 12 6 16 8 Q 20 8 18 16 L 14 14 Q 10 16 6 14 L 2 16 ",E={small:"M 1 7 Q 0 6 2 4 C 3 5 4 5 4 2 L 5 1 L 6 2 C 6 5 7 5 8 4 Q 10 6 9 7 L 7 7 C 6 8 4 8 3 7 L 1 7 ",medium:"M 2 14 Q 0 12 4 8 C 6 10 8 10 8 4 L 10 2 L 12 4 C 12 10 14 10 16 8 Q 20 12 18 14 L 14 14 C 12 16 8 16 6 14 L 2 14 ",large:"M4 40 L8 32 L14 32 L20 36 L26 32 L32 32 L36 40 Q40 30 40 20 Q40 12 36 6 Q36 10 30 20 L26 20 Q22 14 24 10 L20 0 L16 10 Q18 14 14 20 L10 20 Q4 12 4 6 Q0 10 0 20 Q0 28 4 40 Z"},P={speed:{slow:{acceleration:.01,turnSpeed:.05,maxSpeed:1},medium:{acceleration:.05,turnSpeed:.1,maxSpeed:1.5},fast:{acceleration:.07,turnSpeed:.12,maxSpeed:2}},size:{small:{path:E.small,size:10},medium:{path:E.medium,size:20},large:{path:E.large,size:40}},health:{weak:{health:3},medium:{health:5},strong:{health:20}},weapons:{main:{weapon:"enemy-laser",mainLaserCooldown:.5},secondary:{weapon:"enemy-secondary-laser",secondaryLaserCooldown:.2},missile:{weapon:"enemy-missile",missileCooldown:.2},beam:{weapon:"enemy-beam"}},range:{short:{},medium:{},long:{}}};class O{constructor(e,t,i,s){this.x=t,this.y=i,this.dx=0,this.dy=0,this.yaw=0,this.shouldDie=!1,this.exploding=!1,this.level=s,this.type=e,this.projectiles=[],this.size=e.size,this.acceleration=e.acceleration,this.maxSpeed=e.maxSpeed,this.turnSpeed=e.turnSpeed,this.health=e.health,this.bounty=e.bounty,this.engineOn=!0,this.mainLaserCanFire=e.weapons.includes("enemy-laser"),this.mainLaserCooldown=e.mainLaserCooldown,this.secondaryLaserCanFire=e.weapons.includes("enemy-secondary-laser"),this.secondaryLaserCooldown=e.secondaryLaserCooldown,this.secondaryLaserPosition=1,this.missileCanFire=e.weapons.includes("enemy-missile"),this.missileCooldown=e.missileCooldown,this.missilePosition=1,this.beamCanFire=e.weapons.includes("enemy-beam")}takeDamage({damage:e,dx:t,dy:i,owner:s}){t&&(this.dx+=t/30),i&&(this.dy+=i/30);let a=this.health;this.health-=e,this.health<=0&&a>0&&(this.exploding=!0,this.debris=Array(40).fill().map((e=>new C({x:this.x,y:this.y,color:"#aa3"}))),this.lifeSpan=80,s.ore+=10*Math.pow(2,this.level))}weaponsTick(e,t,i){S({canFire:this.mainLaserCanFire,cooldown:this.mainLaserCooldown,x:this.x,y:this.y,size:this.size,yaw:this.yaw,type:"enemy-laser",owner:this,sound:()=>e.enemyLaser()}),k({canFire:this.secondaryLaserCanFire,cooldown:this.secondaryLaserCooldown,x:this.secondaryLaserPosition*Math.cos(this.yaw)*(this.size/2)+this.x,y:this.secondaryLaserPosition*Math.sin(this.yaw)*(this.size/2)+this.y,size:this.size,yaw:this.yaw,type:"enemy-secondary-laser",owner:this,sound:()=>e.secondaryLaser()}),L({canFire:this.missileCanFire,cooldown:this.missileCooldown,x:this.missilePosition*Math.cos(this.yaw)*(this.size/2)+this.x,y:this.missilePosition*Math.sin(this.yaw)*(this.size/2)+this.y,yaw:this.yaw+Math.PI/2*this.missilePosition,type:"enemy-missile",owner:this,target:t,sound:()=>e.missile()}),i<150&&j({canFire:this.beamCanFire,x:this.x+Math.sin(this.yaw)*this.size/2,y:this.y-Math.cos(this.yaw)*this.size/2,type:"enemy-beam",owner:this,target:t,sound:()=>{}})}tick(e,t){if(this.projectiles.map((e=>e.tick())),this.projectiles=this.projectiles.filter((e=>!e.shouldDie)),this.exploding)this.lifeSpan-=1,this.debris.map((e=>e.tick())),this.lifeSpan<=0&&(this.shouldDie=!0);else{let i=Math.atan2(t.getX()-this.x,-t.getY()+this.y);if(this.yaw+=this.yaw-i>0?-this.turnSpeed:this.turnSpeed,this.yaw%=2*Math.PI,this.engineOn=!0,this.engineOn){this.dx+=Math.sin(this.yaw)*this.acceleration,this.dy+=Math.cos(this.yaw)*-this.acceleration;let e=Math.sqrt(this.dx*this.dx+this.dy*this.dy);e>this.maxSpeed&&(this.dx=this.dx/e*this.maxSpeed,this.dy=this.dy/e*this.maxSpeed)}let s=Math.sqrt((this.x-t.x)*(this.x-t.x)+(this.y-t.y)*(this.y-t.y));!t.exploding&&s<320&&this.weaponsTick(e,t,s)}this.x+=this.dx,this.y+=this.dy}draw(e){this.projectiles.map((t=>t.draw(e))),this.exploding?(this.debris.map((t=>t.draw(e))),e.draw((()=>{e.arc({arc:[this.x+20*Math.random()-10,this.y+20*Math.random()-10,2+6*Math.random(),0,2*Math.PI],strokeColor:"rgb(255,"+Math.floor(155*Math.random()+100)+","+Math.floor(50*Math.random())+")",shadowBlur:10,shadowColor:"#f00"})}))):e.draw((()=>{e.fill({path:new Path2D(this.type.path),x:this.x,y:this.y,rotation:this.yaw,fillColor:"#700",strokeColor:"#a44",centered:!1,size:this.size})}))}}class A{constructor(){this.enemies=[]}createEnemy(e){let t={},i=P.speed[e.speed],s=P.size[e.size],a=P.health[e.health],r=e.weapons.reduce(((e,t)=>Object.assign(e,P.weapons[t])),{}),o=e.weapons.map((e=>P.weapons[e].weapon));return Object.assign(t,i),Object.assign(t,s),Object.assign(t,a),Object.assign(t,r),t.weapons=o,t}addEnemy(e,t,i){let s=_[i],a=0===this.enemies.length?0:Math.floor(Math.random()*s.length),r=this.createEnemy(s[a]);this.enemies.push(new O(r,e,t,i))}tick(e,t){this.enemies.forEach((i=>i.tick(e,t))),this.enemies=this.enemies.filter((e=>!e.shouldDie))}draw(e){this.enemies.forEach((t=>t.draw(e)))}}class F{tick(){}draw(e){e.draw((()=>{e.drawBackground("rgba(0,0,0,0.85)"),e.text({text:"game over",x:170,y:200,size:"48px",font:"serif",adjusted:!1,letterSpacing:!0})}))}}class D{constructor(){this.ore=0}tick(e){this.health=e.health,this.maxHealth=e.maxHealth,this.ore=e.ore}draw(e){e.draw((()=>{e.rect({rect:["270","10",100,5],strokeColor:"#fff",adjusted:!1})})),e.draw((()=>{let t=this.health/this.maxHealth;if(e.rect({rect:["270","10",100*t,5],fillColor:`rgb(${200-255*t}, ${200*t}, 0)`,adjusted:!1}),this.ore>-10){let t=`ore: ${this.ore}`;e.text({text:t,x:"299"-3.5*(t.length-6),y:"30",size:"11px",adjusted:!1})}}))}}let B=[0,50,100,200,500,1200,4e3,1e4,2e4,5e4],T=[.05,.06,.06,.06,.07,.07,.07,.07,.08,.08],H=[1,1.5,1.5,1.5,2,2,2,2,3,3],I=[.01,.03,.03,.03,.05,.05,.05,.05,.1,.1],W=[.3,.3,.3,.3,.3,.3,.3,.3,.3,.3],R=[!0,!0,!0,!0,!0,!0,!0,!0,!0,!0],q=[!1,!1,!1,.2,.2,.2,.2,.2,.2,.2],U=[!1,!1,!1,!0,!0,!0,!0,!0,!0,!0],Y=[!1,!1,!1,!1,!1,!1,!1,!0,!0,!0],Q=[!1,!1,!1,!1,!1,.2,.2,.2,.2,.2],X=[!1,!1,!1,!1,!1,!0,!0,!0,!0,!0],K=[10,10,60,60,100,100,150,150,600,600],N=[[],[[262,215,"Speed upgrade","#ffa"]],[[255,215,"Shields upgrade","#ffa"]],[[245,215,"Dual-blaster lasers","#ffa"]],[[262,200,"Speed upgrade","#ffa"],[255,225,"Shields upgrade","#ffa"]],[[227,215,"Auto-targeting missiles","#ffa"]],[[262,200,"Shields upgrade","#ffa"],[223,225,"Weapon fire rate upgrade","#ffa"]],[[280,215,"Beam laser","#ffa"]],[[262,195,"Speed upgrade","#ffa"],[255,215,"Shields upgrade","#ffa"],[223,235,"Weapon fire rate upgrade","#ffa"]],[[222,215,"Compass to another world","#ffa"]]],G=[];for(let e=0;e<10;e++)G.push({cost:B[e],turnSpeed:T[e],maxSpeed:H[e],acceleration:I[e],mainLaserCooldown:W[e],mainLaserCanFire:R[e],secondaryLaserCooldown:q[e],secondaryLaserCanFire:U[e],beamCanFire:Y[e],missileCooldown:Q[e],missileCanFire:X[e],maxHealth:K[e],descriptions:N[e]});var $=G;let J=3.4,Z=.05,V=1,ee=.01,te=20,ie=.3,se=.2,ae=.2,re={engineOn:!1},oe=0;class ne{constructor(){this.x=85,this.y=-400,this.dx=-.1,this.dy=.5,this.projectiles=[],this.landed=!1,this.ore=0,this.timeout=0,this.level=0,this.shipLevels=$,this.maxHealth=10,this.health=10,this.healed=!1,this.exploding=!1,this.size=te,this.mainLaserCanFire=!0,this.secondaryLaserCanFire=!1,this.secondaryLaserPosition=1,this.missileCanFire=!1,this.missilePosition=1,this.beamCanFire=!1,this.finalHalo=!1,this.credits=!1}getX(){return this.x}getY(){return this.y}setDx(e){this.dx=e}setDy(e){this.dy=e}takeDamage({damage:e}){this.health-=e,this.health<=0&&(this.exploding=!0,this.debris=Array(100).fill().map((e=>new C({x:this.x,y:this.y,color:"#aa3"}))).concat(Array(100).fill().map((e=>new C({x:this.x,y:this.y,color:"#a33"})))),this.lifeSpan=80)}heal(){this.health=$[this.level].maxHealth}setLevel(e){({turnSpeed:Z,maxSpeed:V,acceleration:ee,mainLaserCooldown:ie,secondaryLaserCooldown:se,missileCooldown:ae}=$[e]),this.mainLaserCanFire=$[e].mainLaserCanFire,this.secondaryLaserCanFire=$[e].secondaryLaserCanFire,this.missileCanFire=$[e].missileCanFire,this.beamCanFire=$[e].beamCanFire,this.maxHealth=$[e].maxHealth,this.level=e}weaponsTick(e,t,i){if(e.isDown(e.SPACE)){let e=function(e,t,i,s){let a=null,r=99999999;return i.forEach((i=>{if(i.exploding)return;let s=i.x-e,o=i.y-t,n=Math.sqrt(s*s+o*o);n>260||n<r&&(a=i,r=n)})),a}(this.x,this.y,i);S({canFire:this.mainLaserCanFire,cooldown:ie,x:this.x+Math.sin(J)*te/2,y:this.y-Math.cos(J)*te/2,yaw:J,type:"main-laser",owner:this,sound:()=>t.mainLaser()}),k({canFire:this.secondaryLaserCanFire,cooldown:se,x:this.secondaryLaserPosition*Math.cos(J)*10+this.x,y:this.secondaryLaserPosition*Math.sin(J)*10+this.y,size:te,yaw:J,type:"secondary-laser",owner:this,sound:()=>t.secondaryLaser()}),L({canFire:this.missileCanFire,cooldown:ae,x:this.missilePosition*Math.cos(J)*10+this.x,y:this.missilePosition*Math.sin(J)*10+this.y,yaw:J+Math.PI/2*this.missilePosition,type:"missile",owner:this,target:e,sound:()=>t.missile()}),e&&j({canFire:this.beamCanFire,x:this.x+Math.sin(J)*te/2,y:this.y-Math.cos(J)*te/2,type:"beam",owner:this,target:e,sound:()=>{}})}}tick(e,t,i,s){if(this.projectiles.map((e=>e.tick())),this.projectiles=this.projectiles.filter((e=>!e.shouldDie)),this.exploding)this.lifeSpan-=1,this.debris.map((e=>e.tick())),this.lifeSpan<=0&&(this.death=!0);else{let a=Math.sqrt(this.x*this.x+this.y*this.y);if(this.timeout<0&&e.isDown(e.ENTER)&&a<50&&(this.landed=!0,this.health<this.maxHealth&&(this.healed=!0)),this.finalHalo){let t=Math.pow(this.x-this.finalHalo[0],2)+Math.pow(this.y-this.finalHalo[1],2);this.timeout<0&&e.isDown(e.ENTER)&&this.finalHalo&&t<4e4&&(this.credits=!0)}if(this.timeout-=1,oe+=1,e.isDown(e.LEFT)&&(J-=Z),e.isDown(e.RIGHT)&&(J+=Z),re.engineOn=e.isDown(e.UP),re.engineOn){this.dx+=Math.sin(J)*ee,this.dy+=Math.cos(J)*-ee;let e=Math.sqrt(this.dx*this.dx+this.dy*this.dy);e>V&&(this.dx=this.dx/e*V,this.dy=this.dy/e*V),t.engineOn()}else t.engineOff();this.weaponsTick(e,t,s),this.x+=this.dx,this.y+=this.dy,i.camera.x=this.x,i.camera.y=this.y}}draw(e){if(this.projectiles.map((t=>t.draw(e))),this.exploding)this.debris.map((t=>t.draw(e))),e.draw((()=>{e.arc({arc:[this.x+20*Math.random()-10,this.y+20*Math.random()-10,2+6*Math.random(),0,2*Math.PI],strokeColor:"rgb(255,"+Math.floor(155*Math.random()+100)+","+Math.floor(50*Math.random())+")",shadowBlur:10,shadowColor:"#f00"})}));else{re.engineOn&&this.drawEngine(e);let t=this.x*this.x+this.y*this.y;if(t<3600&&this.drawHalo(e,t),this.finalHalo){let t=Math.pow(this.x-this.finalHalo[0],2)+Math.pow(this.y-this.finalHalo[1],2);t<4e4&&this.drawHalo(e,t,"#f00",.15)}e.draw((()=>{e.fill({path:new Path2D(z),x:this.x,y:this.y,rotation:J,strokeColor:"#070",centered:!1,size:te})}))}}drawEngine(e){e.draw((()=>{e.lines({x:this.x,y:this.y,lines:[[this.x+-5,this.y+5],[this.x+5,this.y+5],[this.x,this.y+5+5*Math.random()],[this.x+-5,this.y+5]],rotation:J,fillColor:"orange"})}))}drawHalo(e,t,i,s=1){e.draw((()=>{e.arc({arc:[this.x,this.y,t*s*4/60+Math.sin(oe/8)+10,0,2*Math.PI],strokeColor:i||`rgba(255, 255, 255, ${1-t/3600})`})}))}}let he=[[[-6,-10],[2,-10],[10,-7],[10,-5],[2,0],[10,3],[4,10],[1,8],[-6,10],[-10,2],[-10,-5],[-5,-5]],[[-5,-10],[0,-7],[5,-10],[10,-3],[5,0],[9,5],[4,10],[-3,7],[-7,9],[-10,5],[-7,0],[-9,-6]]];class le{constructor({x:e,y:t}){this.x=e,this.y=t,this.dx=0,this.dy=0,this.asteroidStyle=Math.floor(Math.random()*he.length),this.rotation=Math.random()*Math.PI,this.turnSpeed=.03*Math.random(),this.size=20,this.health=3,this.shouldDie=!1,this.exploding=!1}takeDamage({damage:e,dx:t,dy:i,owner:s}){this.dx+=t/30,this.dy+=i/30,this.health-=e,this.health<=0&&(this.exploding=!0,this.debris=Array(20).fill().map((e=>new C({x:this.x,y:this.y}))),this.lifeSpan=50,s.ore+=10)}tick(){this.exploding&&(this.lifeSpan-=1,this.debris.map((e=>e.tick())),this.lifeSpan<=0&&(this.shouldDie=!0)),this.x+=this.dx,this.y+=this.dy,this.rotation+=this.turnSpeed}draw(e){e.draw((()=>{this.exploding?this.debris.map((t=>t.draw(e))):e.lines({lines:he[this.asteroidStyle].map((e=>[this.x+e[0],this.y+e[1]])),strokeColor:"#fff",shadowBlur:8,shadowColor:"#fff",rotation:this.rotation,x:this.x,y:this.y})}))}}class de{constructor(){this.initializeAsteroids()}initializeAsteroids(){this.asteroids=[];for(let e=0;e<40;e++){let e=Math.random()*Math.PI*2,t=Math.sin(e)*(210+400*Math.random()),i=Math.cos(e)*(210+400*Math.random());this.asteroids.push(new le({x:t,y:i}))}}tick(){this.asteroids.forEach((e=>e.tick())),this.asteroids=this.asteroids.filter((e=>!e.shouldDie))}draw(e){this.asteroids.map((t=>t.draw(e)))}}class ce{draw(e){let t=t=>e.text({text:t[2],x:t[0],y:t[1],adjusted:!1,fillColor:t[3]||"#fff"});e.draw((()=>{e.rect({rect:[0,0,640,480],fillColor:"rgba(0, 0, 0, 0.6)",adjusted:!1}),e.rect({rect:[150,90,340,300],fillColor:"#fff",adjusted:!1}),e.rect({rect:[151,91,338,298],fillColor:"#000",shadowBlur:2,shadowColor:"#fff",adjusted:!1})})),e.draw((()=>{e.text({text:"Thanks for playing",x:200,y:150,size:"20px",font:"serif",letterSpacing:!0,adjusted:!1}),t([270,200,"- Credits -","#9f9"]),t([217,230,"Matt Diamant: Everything","#fff"])}))}}window.onload=()=>{let e=new o,t=new a(e.canvas),i=new class{constructor(){document.addEventListener("keyup",(e=>this.onKeyup(e))),document.addEventListener("keydown",(e=>this.onKeydown(e))),this._pressed={},this.ENTER=13,this.SPACE=32,this.LEFT=37,this.UP=38,this.RIGHT=39,this.DOWN=40}isDown(e){return this._pressed[e]}onKeydown(e){this._pressed[e.keyCode]=!0}onKeyup(e){delete this._pressed[e.keyCode]}},s=new n.a,r=new c;e.initialize();let h=(new Date).getTime(),l=0,m=0,f=()=>{p(),y(),C()},p=()=>{P.credits||(P.landed?j.tick(i,P,O,z,k,S):(L.tick(P),S.tick(P,k,z),k.tick(P,z),z.tick(s,P),P.tick(i,s,t,O.asteroids.concat(z.enemies)),O.tick()))},y=()=>{P.projectiles.forEach((e=>{O.asteroids.forEach((t=>{r.handle(e,t)&&s.projectileHit()})),z.enemies.forEach((t=>{r.handle(e,t)&&s.projectileHit()}))})),z.enemies.forEach((e=>{e.projectiles.forEach((e=>{r.handle(e,P)&&s.projectileHit(),O.asteroids.forEach((t=>{r.handle(e,t)&&s.projectileHit()}))}))}))},C=()=>{window.requestAnimationFrame(f),l=(new Date).getTime(),(m=l-h)>1e3/60&&(t.clearBackground(),b().map((e=>e.draw(t))),P.landed&&j.draw(t,P),P.death&&E.draw(t),P.credits&&B.draw(t),h=l-m%(1e3/60))},b=()=>[v,_,O,S,z,P,L],v=new u({cw:e.canvas.width,ch:e.canvas.height}),S=new w,k=new M,L=new D,j=new x,_=new g,z=new A,E=new F,P=(new d,new ne),O=new de,B=new ce;document.querySelector("main").className+=" loaded",f()}}])</script>