<!doctype html><meta name=viewport content="width=device-width,maximum-scale=1,user-scalable=0"><meta name=theme-color content=#111><meta name=apple-mobile-web-app-capable content=yes><meta name=apple-mobile-web-app-status-bar-style content=black><meta name=msapplication-navbutton-color content=#111><title>Humwin & Darbold</title><style>body,html{margin:0;padding:0;background:#111;color:#fff;font:min(min(4vw,3vh),110%) sans-serif;overflow:hidden;-webkit-tap-highlight-color:transparent;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;-ms-touch-action:none;user-select:none}canvas{position:fixed;width:100%;height:100%}#G{display:none}#W{position:fixed;left:0;right:0;top:40%;text-align:center;pointer-events:none}#M{display:none;background:rgba(0,0,0,.3);border-radius:.5em;padding:.7em}#I{position:fixed;left:0;right:0;display:none;background:rgba(0,0,0,.3);border-radius:.5em;padding:min(1vw,1vh);margin:min(1vw,1vh);bottom:0}.Itm{width:max(5vw,5vh)}</style><canvas id=C>Sorry,this browser cannot render this content.</canvas><svg id=G><g><ellipse style=fill-opacity:0.2 cy=92 rx=22 ry=4 cx=50 /><path style=fill:#f5f5f5 d="M33 71 C 30 71 30 75 33 75 L37 83 C 35 83 35 87 37 87 L30 91 C 29 93 39 95 39 93 L42 87 C 43 87 43 83 42 83 L38 75 C 41 75 41 71 38 71 L43 61 C 45 59 37 57 37 59 L33 71 Z"/><path style=fill:#f5f5f5 d="M67 71 C 70 71 70 75 67 75 L63 83 C 65 83 65 87 63 87 L70 91 C 71 93 61 95 61 93 L58 87 C 57 87 57 83 58 83 L62 75 C 59 75 59 71 62 71 L57 61 C 55 59 63 57 63 59 L67 71 Z"/><path style=fill:#f5f5f5 d="M74 38 C 74 49 74 63 50 63 C 27 63 26 49 26 38 C 26 27 26 18 50 18 C 74 18 74 27 74 38 Z"/><path style=fill:#2c385f d="M70 38 C 70 48 70 56 50 56 C 30 56 30 48 30 38 C 30 29 30 21 50 21 C 70 21 70 29 70 38 Z"/><circle style=fill:#7598ff cx=41 cy=34 r=4 /><circle style=fill:#7598ff cx=58 cy=34 r=4 /><path style=fill:none;stroke:#7598ff;stroke-width:3px d="M41 45 C 41 49 59 49 59 45"/></g><g><ellipse style=fill-opacity:0.2 cy=92 rx=22 ry=4 cx=50 /><path style=fill:#f5f5f5 d="M39 66 C 36 67 38 70 41 69 L48 74 C 47 75 49 78 50 77 L46 84 C 47 87 56 83 55 81 L55 75 C 56 74 54 71 53 71 L45 66 C 48 65 46 61 43 63 L43 52 C 43 49 35 51 36 53 L39 66 Z"/><path style=fill:#f5f5f5 d="M64 73 C 67 74 66 78 63 77 L57 84 C 59 84 58 88 56 87 L62 93 C 62 95 52 95 52 93 L51 86 C 50 86 51 82 52 82 L58 76 C 55 75 57 71 59 72 L57 61 C 56 58 64 59 64 61 L64 73 Z"/><path style=fill:#f5f5f5 d="M78 41 C 75 52 72 65 48 59 C 26 54 29 40 31 29 C 34 18 36 10 60 16 C 83 22 81 30 78 41 Z"/><path style=fill:#2c385f d="M73 40 C 71 50 69 57 50 52 C 30 47 32 40 35 30 C 37 21 39 14 58 19 C 78 24 76 31 73 40 Z"/><circle style=fill:#7598ff cx=47 cy=29 r=4 /><circle style=fill:#7598ff cx=63 cy=33 r=4 /><path style=fill:none;stroke:#7598ff;stroke-width:3px d="M45 40 C 44 44 61 48 62 44"/></g><g><ellipse style=fill-opacity:0.2 cy=92 rx=22 ry=4 cx=50 /><path style=fill:#f5f5f5 d="M35 73 C 32 73 33 77 36 77 L41 84 C 39 84 40 88 42 88 L36 93 C 36 95 46 95 45 93 L47 87 C 48 86 47 83 46 83 L41 76 C 44 75 43 71 40 72 L43 61 C 44 59 36 58 36 60 L35 73 Z"/><path style=fill:#f5f5f5 d="M75 62 C 78 61 79 65 76 66 L76 75 C 77 74 79 78 77 78 L85 79 C 87 81 78 87 77 85 L72 80 C 72 81 70 77 71 76 L72 68 C 69 69 67 65 70 64 L62 56 C 59 55 66 50 67 52 L75 62 Z"/><path style=fill:#f5f5f5 d="M71 32 C 73 43 77 56 54 62 C 31 68 27 55 24 44 C 21 34 19 25 42 19 C 66 13 68 21 71 32 Z"/><path style=fill:#2c385f d="M66 33 C 69 43 71 50 51 55 C 32 60 30 53 28 43 C 25 34 23 27 43 22 C 62 17 64 24 66 33 Z"/><circle style=fill:#7598ff cx=38 cy=36 r=4 /><circle style=fill:#7598ff cx=54 cy=32 r=4 /><path style=fill:none;stroke:#7598ff;stroke-width:3px d="M41 47 C 42 51 59 47 58 43"/></g><g><ellipse style=fill-opacity:0.2 cy=92 rx=22 ry=4 cx=50 /><path style=fill:#f5f5f5 d="M68 69 C 71 70 71 74 68 74 L64 82 C 66 81 66 86 64 85 L72 89 C 72 91 63 94 62 92 L59 86 C 58 86 58 82 59 82 L63 74 C 60 74 60 70 63 70 L57 60 C 56 57 63 56 64 58 L68 69 Z"/><path style=fill:#f5f5f5 d="M78 41 C 75 52 72 65 48 59 C 26 54 29 40 31 29 C 34 18 36 10 60 16 C 83 22 81 30 78 41 Z"/><path style=fill:#f5f5f5 d="M26 62 C 23 61 22 65 25 66 L25 75 C 24 74 22 78 24 78 L16 79 C 14 81 23 87 24 85 L29 80 C 29 81 31 77 30 76 L29 68 C 32 69 34 65 31 64 L39 56 C 42 55 35 50 34 52 L26 62 Z"/><path style=fill:#2c385f d="M73 40 C 71 50 69 57 50 52 C 30 47 32 40 35 30 C 37 21 39 14 58 19 C 78 24 76 31 73 40 Z"/><circle style=fill:#7598ff cx=47 cy=29 r=5 /><circle style=fill:#7598ff cx=63 cy=33 r=4 /><path style=fill:none;stroke:#7598ff;stroke-width:3px d="M44 42 C 51 35 60 43 60 46"/></g><g><ellipse style=fill-opacity:0.2 cx=51 cy=89 rx=22 ry=6 /><path style=fill:#8ec1a5 d="M26 94 L31 87 C 34 84 37 68 36 59 C 22 -6 78 -4 65 58 C 63 69 69 87 71 88 L76 94 L66 90 C 67 86 57 64 59 64 C 57 64 57 88 60 89 L62 95 L54 89 C 56 89 52 68 50 68 C 49 68 46 88 48 89 L41 94 L42 89 C 45 89 43 64 42 64 C 43 64 35 86 36 89 L26 94 Z"/><circle style=fill:#dfffeb cx=50 cy=26 r=8 /><path d="M56 26 C 56 29 53 32 50 32 C 47 32 44 29 44 26 C 44 23 47 20 50 20 C 51 20 52 20 53 21 C 54 21 50 25 50 26 C 51 26 55 23 55 23 C 56 24 56 25 56 26 Z"/><path style=fill:#dfffeb d="M39 43 L42 53 L43 46 L45 51 L48 45 L50 52 L53 45 L56 52 L57 44 L60 52 L62 42 C 62 38 39 39 39 43 Z"/></g><g><ellipse style=fill-opacity:0.2 cx=51 cy=89 rx=28 ry=6 /><path style=fill:#8ec1a5 d="M26 94 L31 87 C 34 84 37 68 36 59 C 15 -6 74 -5 65 58 C 63 69 74 83 76 84 L81 90 L71 86 C 72 82 58 68 60 68 C 58 68 55 88 58 89 L60 95 L52 89 C 54 89 54 66 52 66 C 51 66 46 88 48 89 L41 94 L42 89 C 45 89 43 64 42 64 C 43 64 35 86 36 89 L26 94 Z"/><circle style=fill:#dfffeb cx=49 cy=26 r=8 /><path d="M55 26 C 55 29 52 32 49 32 C 46 32 43 29 43 26 C 43 23 46 20 49 20 C 50 20 51 20 52 21 C 53 21 49 25 49 26 C 50 26 54 23 54 23 C 55 24 55 25 55 26 Z"/><path style=fill:#dfffeb d="M39 43 L42 53 L43 46 L45 51 L48 45 L50 52 L53 45 L56 52 L57 44 L60 52 L62 42 C 62 38 39 39 39 43 Z"/></g><g><ellipse style=fill-opacity:0.2 cx=51 cy=89 rx=28 ry=6 /><path style=fill:#8ec1a5 d="M32 92 L37 85 C 40 82 37 68 36 59 C 11 -5 73 -5 65 58 C 63 69 66 83 68 84 L73 90 L63 86 C 64 82 57 64 59 64 C 57 64 69 77 72 78 L74 84 L66 80 C 68 80 54 66 52 66 C 51 66 47 87 49 88 L42 93 L43 88 C 46 88 43 64 42 64 C 43 64 41 84 42 87 L32 92 Z"/><circle style=fill:#dfffeb cx=48 cy=26 r=8 /><path d="M54 26 C 54 29 51 32 48 32 C 45 32 42 29 42 26 C 42 23 45 20 48 20 C 49 20 50 20 51 21 C 52 21 48 25 48 26 C 49 26 53 23 53 23 C 54 24 54 25 54 26 Z"/><path style=fill:#dfffeb d="M39 43 L42 53 L43 46 L45 51 L48 45 L50 52 L53 45 L56 52 L57 44 L60 52 L62 42 C 62 38 39 39 39 43 Z"/></g><g><ellipse style=fill-opacity:0.2 cx=51 cy=89 rx=28 ry=6 /><path style=fill:#8ec1a5 d="M20 77 L18 68 C 21 65 37 68 36 59 C 1 -4 100 -3 65 58 C 59 68 82 64 84 65 L79 75 L77 70 C 78 66 59 66 61 66 C 59 66 64 88 67 89 L69 95 L61 89 C 63 89 55 68 50 68 C 46 68 39 85 41 86 L34 91 L35 86 C 38 86 41 66 40 66 C 41 66 21 68 22 71 L20 77 Z"/><circle style=fill:#dfffeb cx=50 cy=22 r=8 /><path d="M56 22 C 56 24 53 26 50 26 C 47 26 44 24 44 22 C 44 20 47 16 50 16 C 51 16 52 16 53 17 C 54 17 50 21 50 22 C 51 22 55 20 55 20 C 56 20 56 21 56 22 Z"/><path style=fill:#567664 d="M37 36 L38 52 L42 59 L44 54 L46 60 L50 53 L53 58 L56 54 L59 58 L63 50 L64 34 C 64 30 37 31 37 36 Z"/><path style=fill:#dfffeb d="M37 36 L41 47 L42 39 L44 45 L48 38 L50 46 L53 38 L57 46 L58 37 L62 46 L64 34 C 64 30 37 31 37 36 Z"/></g><g><ellipse style=fill-opacity:0.2 cx=51 cy=89 rx=28 ry=6 /><path style=fill:#8ec1a5 d="M23 85 L21 76 C 24 73 37 68 36 59 C 2 3 99 3 65 58 C 59 68 79 72 81 73 L77 83 L74 76 C 75 72 59 66 61 66 C 59 66 63 81 66 82 L69 87 L61 85 C 63 85 55 68 50 68 C 46 68 39 87 41 88 L34 93 L35 88 C 38 88 41 66 40 66 C 41 66 24 76 25 79 L23 85 Z"/><circle style=fill:#dfffeb cx=50 cy=27 r=8 /><path d="M56 27 C 56 29 53 31 50 31 C 47 31 44 29 44 27 C 44 25 47 21 50 21 C 51 21 52 21 53 22 C 54 22 50 26 50 27 C 51 27 55 25 55 25 C 56 25 56 26 56 27 Z"/><path style=fill:#567664 d="M37 40 L38 49 L42 56 L44 51 L46 57 L50 50 L53 55 L56 51 L59 55 L64 49 L64 38 C 64 34 37 35 37 40 Z"/><path style=fill:#dfffeb d="M37 40 L41 51 L42 43 L44 49 L48 42 L50 50 L53 42 L57 50 L58 41 L62 50 L64 38 C 64 34 37 35 37 40 Z"/></g><g>x200<ellipse style=fill-opacity:0.2 cx=50 rx=31 ry=5 cy=190 /><path style=fill:#903ab2 d="M40 187 C 22 115 62 97 47 41 C 70 88 17 145 61 187 C 62 193 41 195 40 187 Z"/><path style=fill:#af46d8 d="M41 132 C 22 132 26 113 11 111 C 23 104 44 118 41 132 Z"/><path style=fill:#af46d8 d="M49 98 C 60 102 63 90 73 93 C 67 86 50 88 49 98 Z"/><path style=fill:#af46d8 d="M46 173 C 57 169 51 158 60 153 C 51 152 40 165 46 173 Z"/><path style=fill:#af46d8 d="M51 39 C 33 41 34 28 18 29 C 29 20 52 23 51 39 Z"/><path style=fill:#af46d8 d="M47 39 C 62 49 71 32 86 40 C 79 27 53 24 47 39 Z"/><path style=fill:#af46d8 d="M47 39 C 44 58 64 59 62 77 C 71 65 63 38 47 39 Z"/><path style=fill:#af46d8 d="M51 39 C 47 56 28 50 23 66 C 19 52 37 32 51 39 Z"/></g><g>x200<ellipse style=fill-opacity:0.2 cx=56 rx=31 ry=5 cy=190 /><path style=fill:#903ab2 d="M50 186 C 62 125 -6 89 55 25 C 11 89 46 83 71 186 C 71 194 50 194 50 186 Z"/><path style=fill:#af46d8 d="M53 153 C 40 161 35 146 24 150 C 29 141 49 143 53 153 Z"/><path style=fill:#af46d8 d="M54 143 C 66 146 68 133 78 136 C 72 129 54 132 54 143 Z"/><path style=fill:#af46d8 d="M55 22 C 52 39 23 33 18 49 C 11 34 33 15 55 22 Z"/><path style=fill:#af46d8 d="M55 22 C 73 13 44 2 24 12 C 35 11 33 24 55 22 Z"/><path style=fill:#af46d8 d="M55 22 C 64 40 78 25 94 42 C 94 20 60 6 55 22 Z"/><path style=fill:#af46d8 d="M55 22 C 32 32 74 59 56 68 C 76 67 69 32 55 22 Z"/></g><g><rect style=fill:#59246e width=100 height=100 /><path style=fill:#491d5b d="M5 23 C 20 47 37 54 63 90 C 44 69 22 59 5 23 Z"/><circle style=fill:#491d5b cx=70 cy=20 r=2 /></g><g><rect style=fill:#59246e width=100 height=100 /><path style=fill:#491d5b d="M14 29 C 34 48 53 49 86 79 C 63 63 39 60 14 29 Z"/><circle style=fill:#491d5b cx=20 cy=70 r=2 /></g><g><rect style=fill:#59246e width=100 height=100 /><circle style=fill:#491d5b cx=72 cy=60 r=3 /><path style=fill:#491d5b d="M25 10 C 43 22 69 23 96 47 C 77 35 52 28 25 10 Z"/></g><g id=Egg><ellipse style=fill-opacity:0.2 cx=49 cy=93 rx=23 ry=3 /><ellipse style=fill:#dfffeb cx=49 cy=76 rx=10 ry=15 /><path style=fill:none;stroke:#c0dccb d="M39 76 C 40 69 23 59 29 48"/><path style=fill:#af46d8 d="M48 94 C 29 93 34 74 19 71 C 32 65 52 80 48 94 Z"/><path style=fill:#c0dccb d="M55 68 C 56 71 56 73 55 74 C 53 75 51 73 50 71 C 49 68 49 66 50 65 C 52 64 54 66 55 68 Z"/><path style=fill:#903ab2 d="M48 94 C 46 79 73 67 79 77 C 65 75 66 94 48 94 Z"/><path style=fill:#dfffeb d="M52 34 C 54 33 57 38 57 41 C 55 38 50 36 52 34 Z"/><path style=fill:#dfffeb d="M52 34 C 51 32 45 35 44 37 C 47 37 53 36 52 34 Z"/><path style=fill:#dfffeb d="M52 34 C 54 33 50 29 46 29 C 50 31 50 35 52 34 Z"/><path style=fill:#dfffeb d="M52 34 C 52 31 58 31 61 33 C 57 33 53 36 52 34 Z"/></g><g id=Flower><ellipse style=fill-opacity:0.2 cx=50 cy=93 rx=25 ry=3 /><path style=fill:#903ab2 d="M48 91 C 48 84 49 67 43 48 C 48 55 50 63 51 69 C 54 65 59 62 65 63 C 58 67 61 74 52 74 C 52 80 49 92 48 91 Z"/><path style=fill:#903ab2 d="M49 94 C 68 93 62 78 77 75 C 64 69 45 80 49 94 Z"/><path style=fill:#af46d8 d="M50 94 C 52 79 32 66 19 77 C 33 75 32 94 50 94 Z"/><path style=fill:#dfffeb d="M41 47 C 38 40 29 43 27 50 C 34 46 43 53 41 47 Z"/><path style=fill:#dfffeb d="M45 47 C 45 40 60 41 60 50 C 51 46 45 55 45 47 Z"/><path style=fill:#dfffeb d="M43 48 C 34 48 36 57 39 61 C 46 57 52 48 43 48 Z"/><path style=fill:#dfffeb d="M42 45 C 35 45 43 36 50 40 C 53 42 49 45 42 45 Z"/><ellipse style=fill:#c0dccb cx=44 cy=46 rx=5 ry=3 /></g><g><path style=fill:#351542 d="M25 93 C 41 89 49 80 75 81 C 58 86 47 96 25 93 Z"/><path style=fill:#351542 d="M21 84 C 40 87 56 83 79 90 C 60 89 48 96 21 84 Z"/><path style=fill:#ff3a68 d="M57 86 C 57 90 43 90 43 86 C 43 82 46 79 50 79 C 54 79 57 82 57 86 Z"/></g><g>200x<path style=fill:#351542 d="M85 67 C 103 75 117 71 123 93 C 110 85 86 84 85 67 Z"/><path style=fill:#351542 d="M73 88 C 93 83 103 71 135 72 C 114 79 100 91 73 88 Z"/><path style=fill:#351542 d="M68 76 C 91 80 112 75 140 84 C 117 83 101 91 68 76 Z"/><path style=fill:#351542 d="M100 95 C 93 83 105 80 103 65 C 107 75 119 83 100 95 Z"/><path style=fill:#ff3a68 d="M111 80 C 110 50 109 48 102 32 C 84 -7 4 1 27 40 C 28 42 55 25 64 40 C 73 55 36 50 38 51 C 54 62 90 45 93 80 C 95 84 113 84 111 80 Z"/></g><g>200x<path style=fill:#351542 d="M85 67 C 103 75 117 71 123 93 C 110 85 86 84 85 67 Z"/><path style=fill:#351542 d="M73 88 C 93 83 103 71 135 72 C 114 79 100 91 73 88 Z"/><path style=fill:#351542 d="M68 76 C 91 80 112 75 140 84 C 117 83 101 91 68 76 Z"/><path style=fill:#351542 d="M100 95 C 93 83 105 80 103 65 C 107 75 119 83 100 95 Z"/><path style=fill:#ff3a68 d="M111 80 C 110 50 109 48 102 32 C 84 -7 7 13 30 52 C 31 54 49 41 63 46 C 77 51 40 52 42 53 C 58 64 90 45 93 80 C 95 84 113 84 111 80 Z"/></g><g><rect style=fill:#ff3a68 width=100 height=100 /><path style=fill:#ec3660 d="M15 21 C 41 45 69 32 86 74 C 65 42 39 49 15 21 Z"/></g><g><path style=fill:#8ec1a5 d="M32 84 C 25 76 50 85 49 87 C 49 90 32 91 32 84 Z"/><path style=fill:#8ec1a5 d="M68 78 C 73 69 51 84 53 86 C 54 89 71 85 68 78 Z"/><path style=fill:#567664 d="M53 93 C 48 89 45 81 48 80 C 51 79 55 87 53 93 Z"/></g><g><path style=fill:#8ec1a5 d="M32 88 C 23 83 49 84 49 86 C 50 89 34 95 32 88 Z"/><path style=fill:#8ec1a5 d="M69 82 C 76 75 51 83 52 85 C 52 88 69 90 69 82 Z"/><path style=fill:#567664 d="M53 93 C 48 89 45 81 48 80 C 51 79 55 87 53 93 Z"/></g><g><ellipse style=fill-opacity:0.2 cy=92 rx=22 ry=4 cx=50 /><path style=fill:#903ab2 d="M33 71 C 30 71 30 75 33 75 L37 83 C 35 83 35 87 37 87 L30 91 C 29 93 39 95 39 93 L42 87 C 43 87 43 83 42 83 L38 75 C 41 75 41 71 38 71 L43 61 C 45 59 37 57 37 59 L33 71 Z"/><path style=fill:#903ab2 d="M67 71 C 70 71 70 75 67 75 L63 83 C 65 83 65 87 63 87 L70 91 C 71 93 61 95 61 93 L58 87 C 57 87 57 83 58 83 L62 75 C 59 75 59 71 62 71 L57 61 C 55 59 63 57 63 59 L67 71 Z"/><path style=fill:#903ab2 d="M74 38 C 74 49 74 63 50 63 C 27 63 26 49 26 38 C 26 27 26 18 50 18 C 74 18 74 27 74 38 Z"/><path style=fill:#dfffeb d="M70 38 C 70 48 70 56 50 56 C 30 56 30 48 30 38 C 30 29 30 21 50 21 C 70 21 70 29 70 38 Z"/><circle style=fill:#749e87 cx=41 cy=32 r=2 /><circle style=fill:#749e87 cx=58 cy=34 r=2 /><path style=fill:none;stroke:#749e87;stroke-width:3px d="M38 44 C 43 49 54 51 62 43"/></g></svg><div id=W><div id=M></div></div><div id=I></div><script id=VertexShader type=x-shader/x-vertex>#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
attribute vec3 vertex;attribute vec2 uv;uniform mat4 projMat;uniform mat4 modelViewMat;varying vec2 st;void main(){gl_Position = projMat * modelViewMat * vec4(vertex,1.);st = uv;}</script><script id=FragmentShader type=x-shader/x-fragment>#ifdef GL_FRAGMENT_PRECISION_HIGH
precision highp float;
#else
precision mediump float;
#endif
uniform sampler2D texture;varying vec2 st;void main(){gl_FragColor = texture2D(texture,st);}</script><script>"use strict";const horizon=100,camPos=[0,12,9],idMat=new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]),projMat=new Float32Array(16),viewMat=new Float32Array(16),modelViewMat=new Float32Array(16),spriteMat=new Float32Array(16),groundMat=new Float32Array(16),cacheMat=new Float32Array(16),mapSize=128,mapRadius=mapSize>>1,map=new Uint8Array(mapSize*mapSize),groundSize=35,groundRadius=groundSize>>1,dns=[],tiles=[],spriteSizes=[],screen=[],pointerSpot=[0,0,0],pointersX=[],pointersY=[],compareDist=(t,e)=>e.dist-t.dist,camera={x:0,z:0},objects=[{sprite:0,x:0,y:0,z:0,tx:0,tz:0,last:0,frame:0,update:updatePlayer,tries:0,getEaten:function(){this.update=function(){this.sprite=3,this.dir=this.frame%2?-1:1},items.length=0,updateInventory();const t=["Ouch!"],e=["Damn, these things are hungry!","Not nice.","I wonder if Darbold was eaten, too.","He certainly wasn't in there!","No, not here either.","Maybe it's not running around anymore.","If I only knew what makes them vomit.","What a bad breath!","My bytes got bitten!"];t.push(e[this.tries++%e.length]),say(t)},resurrect:function(){this.update=null,setTimeout((function(){say(["Got printed anew!","It's good to be robot!"]),egg.reset(),player.x=player.z=player.tx=player.tz=player.killed=pointers=0,player.update=updatePlayer}),2e3)}},{sprite:22,x:1e5,y:0,z:0}],player=objects[0],darbold=objects[1];let bubble,inventory,gl,spriteModelBuffer,spriteUvBuffer,groundModelBuffer,groundUvBuffer,groundUvs,groundLength,atlasCoords,vertexLoc,uvLoc,projMatLoc,modelViewMatLoc,camX,camA,camY,camB,camZ,camC,lookX,lookZ,pointers,egg,now,won,seed=1,pickables=[],items=[];function say(t,e){clearTimeout(bubble.tid),Array.isArray(t)||(t=[t]);const a=t.shift();bubble.style.display="inline-block",bubble.innerHTML=a,bubble.last=now,bubble.next=function(){now-bubble.last<300||(bubble.last=now,clearTimeout(bubble.tid),t.length?say(t,e):(bubble.style.display="none",bubble.next=null,e&&e()))},bubble.tid=setTimeout(bubble.next,1e3+200*a.split(" ").length)}function moveToTarget(t,e,a,r){const n=e-t.x,o=a-t.z,i=Math.sqrt(n*n+o*o),s=Math.min(1,r/i),l=t.x+n*s,c=t.z+o*s;if(t!=camera){const e=mapRadius+l/2,a=mapRadius+c/2,r=Math.round(e),n=Math.round(a),o=map[n*mapSize+r],i=3*(e-r+.5)|0,s=3*(a-n+.5)|0;let d;if(128&o&&(!(d=dns[127&o])||!d[3*s+i]))return t.tx=t.x,t.tz=t.z,1}return t.x=l,t.z=c,1==s}function pickSprite(t,e,a){t.sprite=e+t.frame%a}function pickDirSprite(t,e,a,r,n){const o=(t.z-camZ)*(r-t.x)+(camX-t.x)*(n-t.z);if(0==o)return t.sprite=e,void(t.dir=1);t.sprite=e+1+t.frame%a,t.dir=o<0?-1:1}function dropItem(){const t=player.dropAngle;this.x=player.x+Math.cos(t)/2,this.z=player.z+Math.sin(t)/2,this.tasty=1,player.dropAngle=t+1,pickables.push(this),items=items.filter((t=>t!=this)),updateInventory()}function updateInventory(){0!=items.length?(inventory.style.display="block",inventory.innerHTML="",items.forEach((t=>{const e=document.createElement("span");e.onclick=function(){t.use()},e.innerHTML=`<svg viewBox="0 0 100 100" class="Itm">${t.icon.innerHTML}</svg>`,inventory.appendChild(e)}))):inventory.style.display="none"}function updatePlayer(){!won&&pointers>0&&(moveToPointer(),this.dropAngle=0),pickDirSprite(this,0,2,this.tx,this.tz),moveToTarget(this,this.tx,this.tz,.09);for(let t=0,e=pickables.length;t<e;++t){const e=pickables[t],a=e.x-this.x,r=e.z-this.z;if(a*a+r*r<.2){e.x=1e5,items.push(e),updateInventory(),pickables=pickables.filter((t=>e!=t));const t=[`Picked up a ${e.name}`];"Egg"==e.name&&(t.push("Hm, maybe that makes one"),t.push("of them vomit…")),say(t);break}}const t=lookX-this.x,e=lookZ-this.z,a=t*t+e*e;if(a>0){const t=Math.sqrt(a)-2;moveToTarget(camera,this.tx,this.tz,t>.01?t:.06),lookAt(camera.x,camera.z)}}function eat(t,e){e.eaten?now-e.killed>1e3&&(pickables=pickables.filter((t=>t!=e)),e.x=1e5,e.eaten=0,e.resurrect&&e.resurrect(),t.hasDarbold&&"Egg"==e.name&&(t.vomit=now+1e3,t.hasDarbold=0,darbold.x=t.x+.5,darbold.z=t.z,objects.forEach((t=>t.sight=0)),player.tx=darbold.x-1,player.tz=darbold.z,won=1,say(["Burp!","Darbold! There you are!","Finally I found you!","Now, let's get off this planet","and watch some Spaceflix!","It's a long flight home…"],(function(){player.update=darbold.update=function(){this.y+=.2}})))):(e.eaten=1,e.killed=now,e.getEaten&&e.getEaten())}function hunt(t,e,a){if(a<.2)return pickSprite(t,7,2),void eat(t,e);a<t.sight&&t.ignore<1?(pickDirSprite(t,4,2,e.x,e.z),moveToTarget(t,e.x,e.z,t.speed)):(pickDirSprite(t,4,2,t.tx,t.tz),moveToTarget(t,t.tx,t.tz,t.speed)&&t.waypoint(),--t.ignore),t.x==t.lx&&t.z==t.lz&&++t.stuck>3&&(t.tx=t.x+4*random()-2,t.tz=t.z+4*random()-2,t.ignore=10,t.stuck=0),t.lx=t.x,t.lz=t.z}function updatePredator(){if(this.vomit>now)return void pickSprite(this,7,2);let t,e=1e5,a=this.sight;for(let r=0,n=pickables.length;r<n;++r){const n=pickables[r];if(!n.tasty)continue;const o=n.x-this.x,i=n.z-this.z,s=o*o+i*i;if(s<a){e=s,t=n;break}}if(this.hasDarbold){if(!t||"Egg"!=t.name)return void(this.sprite=4)}else{const r=player.x-this.x,n=player.z-this.z,o=r*r+n*n;o<a&&o<e&&(t=player,e=o)}hunt(this,t,e)}function run(){requestAnimationFrame(run),now=Date.now(),gl.bindBuffer(gl.ARRAY_BUFFER,groundModelBuffer),gl.vertexAttribPointer(vertexLoc,3,gl.FLOAT,0,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,groundUvBuffer),gl.vertexAttribPointer(uvLoc,2,gl.FLOAT,0,0,0);const t=lookX>>1,e=lookZ>>1;updateGroundUvs(t,e),gl.bufferData(gl.ARRAY_BUFFER,groundUvs,gl.DYNAMIC_DRAW),cacheMat.set(idMat),cacheMat[12]=t<<1,cacheMat[14]=e<<1,multiply(modelViewMat,viewMat,cacheMat),gl.uniformMatrix4fv(modelViewMatLoc,0,modelViewMat),gl.drawArrays(gl.TRIANGLES,0,groundLength),gl.bindBuffer(gl.ARRAY_BUFFER,spriteModelBuffer),gl.vertexAttribPointer(vertexLoc,3,gl.FLOAT,0,0,0),gl.bindBuffer(gl.ARRAY_BUFFER,spriteUvBuffer),objects.forEach((t=>{t.update&&(now-t.last>200&&(++t.frame,t.last=now),t.update())})),objects.forEach((t=>{const e=camX-t.x,a=camY-t.y,r=camZ-t.z,n=camA*e+camB*a+camC*r,o=camA*n,i=camB*n,s=camC*n;t.dist=o*o+i*i+s*s})),objects.sort(compareDist).forEach((t=>{const e=t.sprite,a=spriteSizes[e];scale(cacheMat,spriteMat,a[0]*t.dir,a[1],1),cacheMat[12]=t.x,cacheMat[13]=t.y,cacheMat[14]=t.z,gl.vertexAttribPointer(uvLoc,2,gl.FLOAT,0,0,e<<5),multiply(modelViewMat,viewMat,cacheMat),gl.uniformMatrix4fv(modelViewMatLoc,0,modelViewMat),gl.drawArrays(gl.TRIANGLE_STRIP,0,4)}))}function rayGround(t,e,a,r,n,o,i){const s=-1*o;if(s>1e-4){const l=-1*-a/s;return t[0]=e+n*l,t[1]=a+o*l,t[2]=r+i*l,l>=0}return 0}function getGroundSpot(t,e,a){invert(cacheMat,projMat);const r=cacheMat[0]*e+cacheMat[4]*a-cacheMat[8]+cacheMat[12],n=cacheMat[1]*e+cacheMat[5]*a-cacheMat[9]+cacheMat[13];invert(cacheMat,viewMat);let o=cacheMat[0]*r+cacheMat[4]*n-cacheMat[8],i=cacheMat[1]*r+cacheMat[5]*n-cacheMat[9],s=cacheMat[2]*r+cacheMat[6]*n-cacheMat[10],l=o*o+i*i+s*s;return l>0&&(l=1/Math.sqrt(l)),o*=l,i*=l,s*=l,rayGround(t,cacheMat[12],cacheMat[13],cacheMat[14],o,i,s)}function moveToPointer(){!player.killed&&getGroundSpot(pointerSpot,pointersX[0],pointersY[0])&&(player.tx=pointerSpot[0],player.tz=pointerSpot[2])}function setPointer(t,e){const a=t.touches;if(a){pointers=a.length;for(let t=pointers;t--;){const e=a[t];pointersX[t]=e.pageX,pointersY[t]=e.pageY}}else e?(pointers=1,pointersX[0]=t.pageX,pointersY[0]=t.pageY):pointers=0;for(let t=pointers;t--;)pointersX[t]=2*pointersX[t]/screen[0]-1,pointersY[t]=1-2*pointersY[t]/screen[1];t.stopPropagation()}function pointerCancel(t){setPointer(t,0)}function pointerUp(t){setPointer(t,0),bubble.next&&bubble.next()}function pointerMove(t){setPointer(t,pointers)}function pointerDown(t){setPointer(t,1)}function lookAt(t,e){lookX=t,lookZ=e,translate(viewMat,idMat,t,0,e),rotate(viewMat,viewMat,.2,0,1,0),translate(viewMat,viewMat,camPos[0],camPos[1],camPos[2]),rotate(viewMat,viewMat,-.9,1,0,0),camA=viewMat[8],camB=viewMat[9],camC=viewMat[10],camX=viewMat[12],camY=viewMat[13],camZ=viewMat[14],spriteMat.set(viewMat),invert(viewMat,viewMat)}function resize(){gl.canvas.width=screen[0]=gl.canvas.clientWidth,gl.canvas.height=screen[1]=gl.canvas.clientHeight,gl.viewport(0,0,screen[0],screen[1]),setPerspective(projMat,.125*Math.PI,screen[0]/screen[1],.1,horizon),gl.uniformMatrix4fv(projMatLoc,gl.FALSE,projMat)}function compileShader(t,e){const a=gl.createShader(t);return gl.shaderSource(a,e),gl.compileShader(a),a}function createProgram(t,e){const a=gl.createProgram();if(gl.attachShader(a,compileShader(gl.VERTEX_SHADER,t)),gl.attachShader(a,compileShader(gl.FRAGMENT_SHADER,e)),gl.linkProgram(a),!gl.getProgramParameter(a,gl.LINK_STATUS))throw gl.getProgramInfoLog(a);return a}function updateGroundUvs(t,e){const a=mapSize-groundSize;for(let r=0,n=(mapRadius+e-groundRadius)*mapSize+(mapRadius+t-groundRadius),o=0;r<groundSize;++r,n+=a)for(let t=0;t<groundSize;++t,++n){const t=(127&map[n])<<3,e=atlasCoords[t],a=atlasCoords[t+1],r=atlasCoords[t+6],i=atlasCoords[t+7];groundUvs[o++]=e,groundUvs[o++]=a,groundUvs[o++]=r,groundUvs[o++]=a,groundUvs[o++]=e,groundUvs[o++]=i,groundUvs[o++]=e,groundUvs[o++]=i,groundUvs[o++]=r,groundUvs[o++]=a,groundUvs[o++]=r,groundUvs[o++]=i}}function createGroundModel(){const t=[];for(let e=-groundRadius;e<=groundRadius;++e)for(let a=-groundRadius;a<=groundRadius;++a){const r=2*a,n=2*e;t.push(r-1,0,n-1,r+1,0,n-1,r-1,0,n+1,r-1,0,n+1,r+1,0,n-1,r+1,0,n+1)}return t}function createBuffer(t,e){const a=gl.createBuffer();return gl.bindBuffer(gl.ARRAY_BUFFER,a),gl.bufferData(gl.ARRAY_BUFFER,new Float32Array(t),e||gl.STATIC_DRAW),a}function createTexture(t){const e=gl.createTexture();return gl.bindTexture(gl.TEXTURE_2D,e),gl.texImage2D(gl.TEXTURE_2D,0,gl.RGBA,gl.RGBA,gl.UNSIGNED_BYTE,t),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MIN_FILTER,gl.LINEAR),gl.texParameteri(gl.TEXTURE_2D,gl.TEXTURE_MAG_FILTER,gl.LINEAR),gl.generateMipmap(gl.TEXTURE_2D),e}function addFly(t,e,a){const r=random()*Math.PI*2,n={sprite:20,x:t+Math.cos(r)*a,y:0,z:e+Math.sin(r)*a,last:0,frame:0,update:function(){pickDirSprite(this,19,2,this.tx,this.tz),moveToTarget(this,this.tx,this.tz,.08)&&this.waypoint()},waypoint:function(){const a=random()*Math.PI*2,r=1+8*random();this.tx=t+Math.cos(a)*r,this.tz=e+Math.sin(a)*r}};n.waypoint(),objects.push(n)}function addFlies(t,e,a,r){for(let n=0;n<t;++n)addFly(e,a,r)}function addSnake(t,e){objects.push({sprite:16,x:t,y:0,z:e,last:0,frame:0,update:function(){const t=player.x-this.x,e=player.z-this.z;t*t+e*e<.7?(pickDirSprite(this,16,2,player.x,player.z),eat(this,player)):this.sprite=16}})}function addFlowers(t,e,a,r){for(let n=0;n<t;++n){const t=random()*Math.PI*2,n=random()*r,o={sprite:15,x:e+Math.cos(t)*n,y:0,z:a+Math.sin(t)*n,tasty:1,name:"Flower",use:dropItem};objects.push(o),pickables.push(o)}}function addSnakeCircle(t,e,a,r,n){for(let o=2*Math.PI,i=0;o>0;o-=r,i^=1)addSnake(t+Math.cos(o)*(a+i*n),e+Math.sin(o)*(a+i*n))}function addRandomPredator(t,e,a){const r=random()*Math.PI*2,n={sprite:4,x:t+Math.cos(r)*a,y:0,z:e+Math.sin(r)*a,lx:0,lz:0,stuck:0,ignore:0,last:0,frame:0,speed:.06,sight:16,update:updatePredator,waypoint:function(){const a=random()*Math.PI*2,r=1+8*random();this.tx=t+Math.cos(a)*r,this.tz=e+Math.sin(a)*r}};n.waypoint(),objects.push(n)}function addWanderingPredator(t,e,a,r){const n=Math.cos(r)*a,o=Math.sin(r)*a,i=t+n,s=e+o,l=t-n,c=e-o,d={sprite:4,x:i,y:0,z:s,lx:0,lz:0,stuck:0,ignore:0,last:0,frame:0,speed:.06,sight:16,update:updatePredator,waypoint:function(){this.x==i&&this.z==s?(this.tx=l,this.tz=c):(this.tx=i,this.tz=s)}};d.waypoint(),objects.push(d)}function addCirclingPredator(t,e,a,r,n){const o={sprite:4,y:0,lx:0,lz:0,stuck:0,ignore:0,last:0,frame:0,speed:.06,sight:16,a:n||0,update:updatePredator,waypoint:function(){this.tx=t+Math.cos(this.a)*a,this.tz=e+Math.sin(this.a)*a,this.a+=r}};o.waypoint(),o.x=o.tx,o.z=o.tz,objects.push(o)}function drawIsland(t,e,a){for(let r=-a;r<=a;++r)for(let n=-a;n<=a;++n){Math.atan2(r,n);n*n+r*r<a*a&&(map[(e+r)*mapSize+(t+n)]=11+3*random()|0)}}function createMap(){map.fill(147);for(let t,e=0,a=5,r=0,n=0,o=0;e<9;++e){drawIsland(mapRadius+r,mapRadius+n,a);const i=2*r,s=2*n,l=2*a;if(e<8)switch(e%6){default:case 0:addCirclingPredator(i,s,.8*l,.63),addRandomPredator(i,s,.8*l),0==e&&(objects[objects.length-1].hasDarbold=1);break;case 1:addSnakeCircle(i,s,.8*l,.05*l,1),addFlowers(1+4*random()|0,i,s,.8*l),addFlies(1+3*random()|0,i,s,.7*l);break;case 2:addWanderingPredator(i,s,.8*l,o+1.57);break;case 3:addSnakeCircle(i,s,.5*l,.05*l,2),addFlowers(1+3*random()|0,i,s,.8*l),addFlies(1+3*random()|0,i,s,.7*l);case 4:addRandomPredator(i,s,.8*l),addRandomPredator(i,s,.8*l);break;case 5:addSnakeCircle(i,s,.8*l,.05*l,1),addFlowers(1+4*random()|0,i,s,.4*l)}else addCirclingPredator(i,s,.8*l,.63),addCirclingPredator(i,s,.7*l,-.63,3),egg={sprite:14,x:i,y:0,z:s,name:"Egg",use:dropItem,reset:function(){this.x=i,this.z=s,this.tasty=0,pickables.filter((t=>t==egg)).length<1&&pickables.push(egg)}},objects.push(egg),pickables.push(egg);t=4+3*random()|0,9==e&&(o+=3.14),o+=.6,r+=Math.cos(o)*(a+.8*t)|0,n+=Math.sin(o)*(a+.8*t)|0,a=t}const t=new Uint8Array(mapSize*mapSize),e=t=>Math.max(0,Math.min(t,mapSize-1)),a=(t,a)=>e(a)*mapSize+e(t),r=(t,e)=>map[a(t,e)];for(let t=0;t<mapSize;++t)for(let e=0;e<mapSize;++e){const n=r(e,t);if(147==n){const o=r(e,t-1),i=r(e-1,t),s=r(e+1,t),l=r(e,t+1);(i!=n&&s!=n||o!=n&&l!=n)&&(map[a(e,t)]=11)}}for(let e=0;e<mapSize;++e)for(let n=0;n<mapSize;++n){const o=r(n,e),i=r(n-1,e-1),s=r(n,e-1),l=r(n+1,e-1),c=r(n-1,e),d=r(n+1,e),u=r(n-1,e+1),p=r(n,e+1),h=r(n+1,e+1);147==o&&(i!=o||s!=o||l!=o||c!=o||d!=o||u!=o||p!=s||h!=o)&&(t[a(n,e)]=i!=o|(s!=o)<<1|(l!=o)<<2|(c!=o)<<3|(d!=o)<<4|(u!=o)<<5|(p!=o)<<6|(h!=o)<<7)}for(let e=0;e<mapSize;++e)for(let r=0;r<mapSize;++r){const n=a(r,e),o=t[n],i=tiles[o];i&&(map[n]=128|i)}for(let t=270;t>0;){const e=random()*(mapSize-1),a=random()*(mapSize-1);e*e+a*a>2&&!(128&map[Math.round(a)*mapSize+Math.round(e)])&&(objects.push({sprite:9+2*random()|0,x:2*(e-mapRadius),y:0,z:2*(a-mapRadius)}),--t)}}function init(t){lookAt(0,0),createMap(),objects.forEach((t=>{t.name&&(t.icon=document.getElementById(t.name)),t.dir=1})),bubble=document.getElementById("M"),inventory=document.getElementById("I");const e=document.getElementById("C");gl=e.getContext("webgl"),gl.enable(gl.BLEND),gl.blendFunc(gl.ONE,gl.ONE_MINUS_SRC_ALPHA),gl.enable(gl.DEPTH_TEST),gl.depthFunc(gl.LEQUAL),gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL,1);const a=createTexture(t.canvas),r=createGroundModel();atlasCoords=t.coords,groundLength=r.length/3,groundModelBuffer=createBuffer(r),groundUvBuffer=gl.createBuffer(),groundUvs=new Float32Array(2*groundLength),spriteModelBuffer=createBuffer([-.5,1,0,-.5,0,0,.5,1,0,.5,0,0]),spriteUvBuffer=createBuffer(t.coords);const n=createProgram(document.getElementById("VertexShader").textContent,document.getElementById("FragmentShader").textContent),o=gl.getUniformLocation(n,"texture");gl.enableVertexAttribArray(vertexLoc=gl.getAttribLocation(n,"vertex")),gl.enableVertexAttribArray(uvLoc=gl.getAttribLocation(n,"uv")),projMatLoc=gl.getUniformLocation(n,"projMat"),modelViewMatLoc=gl.getUniformLocation(n,"modelViewMat"),gl.useProgram(n),gl.activeTexture(gl.TEXTURE0),gl.bindTexture(gl.TEXTURE_2D,a),gl.uniform1i(o,0),window.onresize=resize,resize(),e.onmousedown=pointerDown,e.onmousemove=pointerMove,e.onmouseup=pointerUp,e.onmouseout=pointerCancel,e.ontouchstart=pointerDown,e.ontouchmove=pointerMove,e.ontouchend=pointerUp,e.ontouchleave=pointerCancel,e.ontouchcancel=pointerCancel,document.addEventListener("gesturestart",(function(t){t.preventDefault()}),0),document.addEventListener("gesturechange",(function(t){t.preventDefault()}),0),document.addEventListener("gestureend",(function(t){t.preventDefault()}),0),run(),say(["Hello! I am Humwin,","your friendly space exploring robot.","I'm looking for my friend Darbold,","a sampling robot, that looks like me.","I was supposed to pick him up here,","but somehow I can't find him."])}function svgToImg(t,e,a,r,n){const o=new Image;return o.src=`data:image/svg+xml;base64,${btoa(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 ${e} ${a}" width="${r}" height="${n}">${t}</svg>`)}`,o}function atlasInsert(t,e,a){if(t.l)return atlasInsert(t.l,e,a)||atlasInsert(t.r,e,a);if(t.img)return;const r=t.rc,n=r.r-r.l,o=r.b-r.t;return n<e||o<a?void 0:(n==e&&o==a||(t.l={},t.r={},n-e>o-a?(t.l.rc={l:r.l+e,t:r.t,r:r.r,b:r.b},t.r.rc={l:r.l,t:r.t+a,r:r.l+e,b:r.b}):(t.l.rc={l:r.l+e,t:r.t,r:r.r,b:r.t+a},t.r.rc={l:r.l,t:r.t+a,r:r.r,b:r.b}),t.rc.r=r.l+e-1,t.rc.b=r.t+a-1),t)}function createAtlas(t){const e=1024,a=1/e,r=3*a,n={rc:{l:0,t:0,r:e,b:e}},o=[],i=document.createElement("canvas"),s=i.getContext("2d"),l=t.length;i.width=i.height=e,i.pending=l;for(let e=0;e<l;++e){const l=t[e],c=(l.split("<")[0].trim()+";").split(";"),d=c[0].split("x"),u=d[0]||100,p=d[1]||100,h=1.28*u|0,g=1.28*p|0,m=atlasInsert(n,h+2,g+2);if(!m)return;const f=m.rc,M=f.l*a,b=f.t*a,y=M+h*a,v=b+g*a;o.push(M+r,b+r,M+r,v-r,y-r,b+r,y-r,v-r),spriteSizes.push([h/128,g/128]),m.img=svgToImg(l,u,p,h,g).onload=function(){const t=c[1]*Math.PI/180,e=m.rc.l+1,a=m.rc.t+1,r=h>>1,n=g>>1;t>0?(s.save(),s.translate(e+r,a+n),s.rotate(t),s.drawImage(this,-r,-n),s.restore()):s.drawImage(this,e,a),--i.pending}}return{canvas:i,coords:o}}function waitForAtlas(t){t.canvas.pending>0?setTimeout((function(){waitForAtlas(t)}),100):init(t)}function random(){return(seed=(9301*seed+49297)%233280)/233280}function createTiles(t){const e=t=>{const e=[];for(let a=0;a<3;++a)for(let r=0;r<3;++r)e[3*a+r]=t[3*(2-r)+a];return e},a=(t,a)=>{for(let r=0;r<a;++r)t=e(t);return t},r=t=>t[0]|t[1]<<1|t[2]<<2|t[3]<<3|t[5]<<4|t[6]<<5|t[7]<<6|t[8]<<7,n=[1,1,1,1,0,0,1,0,0],o=[0,0,0,0,0,0,0,0,1],i=[0,0,0,0,0,0,1,1,1];for(let e,s,l=0,c=0;l<360;l+=90,++c)e=t.length,t.push(`;${l}<rect style="fill:#59246e" width="100" height="100"></rect><path style="fill:#ff3a68" d="M100 50 L100 100 L50 100 C50 ${50+Math.round(60*random()-30)} ${50+Math.round(60*random()-30)} 50 100 50Z"></path>`),s=a(n,c),dns[e]=s,tiles[r(s)]=e,s=n.slice(0),s[2]=0,tiles[r(a(s,c))]=e,s=n.slice(0),s[6]=0,tiles[r(a(s,c))]=e,s=n.slice(0),s[2]=0,s[6]=0,tiles[r(a(s,c))]=e,e=t.length,t.push(`;${l}<rect style="fill:#ff3a68" width="100" height="100"></rect><path style="fill:#59246e" d="M100 50 L100 100 L50 100 C50 ${50+Math.round(60*random()-30)} ${50+Math.round(60*random()-30)} 50 100 50Z"></path>`),s=a(o,c),dns[e]=s,tiles[r(s)]=e,e=t.length,t.push(`;${l}<rect style="fill:#ff3a68" width="100" height="100"></rect><path style="fill:#59246e" d="M100 100 L0 100 L0 50 L10 50 C35 ${50+Math.round(12*random()-6)} 65 ${50+Math.round(12*random()-6)} 90 50 L100 50 L100 100Z"></path>`),s=a(i,c),dns[e]=s,tiles[r(s)]=e,s=i.slice(0),s[6]=0,tiles[r(a(s,c))]=e,s=i.slice(0),s[8]=0,tiles[r(a(s,c))]=e,s=i.slice(0),s[6]=0,s[8]=0,tiles[r(a(s,c))]=e}function invert(t,e){const a=e[0],r=e[1],n=e[2],o=e[3],i=e[4],s=e[5],l=e[6],c=e[7],d=e[8],u=e[9],p=e[10],h=e[11],g=e[12],m=e[13],f=e[14],M=e[15],b=a*s-r*i,y=a*l-n*i,v=a*c-o*i,w=r*l-n*s,x=r*c-o*s,z=n*c-o*l,A=d*m-u*g,S=d*f-p*g,T=d*M-h*g,E=u*f-p*m,k=u*M-h*m,R=p*M-h*f;let L=b*R-y*k+v*E+w*T-x*S+z*A;L&&(L=1/L,t[0]=(s*R-l*k+c*E)*L,t[1]=(n*k-r*R-o*E)*L,t[2]=(m*z-f*x+M*w)*L,t[3]=(p*x-u*z-h*w)*L,t[4]=(l*T-i*R-c*S)*L,t[5]=(a*R-n*T+o*S)*L,t[6]=(f*v-g*z-M*y)*L,t[7]=(d*z-p*v+h*y)*L,t[8]=(i*k-s*T+c*A)*L,t[9]=(r*T-a*k-o*A)*L,t[10]=(g*x-m*v+M*b)*L,t[11]=(u*v-d*x-h*b)*L,t[12]=(s*S-i*E-l*A)*L,t[13]=(a*E-r*S+n*A)*L,t[14]=(m*y-g*w-f*b)*L,t[15]=(d*w-u*y+p*b)*L)}function multiply(t,e,a){let r=e[0],n=e[1],o=e[2],i=e[3],s=e[4],l=e[5],c=e[6],d=e[7],u=e[8],p=e[9],h=e[10],g=e[11],m=e[12],f=e[13],M=e[14],b=e[15],y=a[0],v=a[1],w=a[2],x=a[3];t[0]=y*r+v*s+w*u+x*m,t[1]=y*n+v*l+w*p+x*f,t[2]=y*o+v*c+w*h+x*M,t[3]=y*i+v*d+w*g+x*b,y=a[4],v=a[5],w=a[6],x=a[7],t[4]=y*r+v*s+w*u+x*m,t[5]=y*n+v*l+w*p+x*f,t[6]=y*o+v*c+w*h+x*M,t[7]=y*i+v*d+w*g+x*b,y=a[8],v=a[9],w=a[10],x=a[11],t[8]=y*r+v*s+w*u+x*m,t[9]=y*n+v*l+w*p+x*f,t[10]=y*o+v*c+w*h+x*M,t[11]=y*i+v*d+w*g+x*b,y=a[12],v=a[13],w=a[14],x=a[15],t[12]=y*r+v*s+w*u+x*m,t[13]=y*n+v*l+w*p+x*f,t[14]=y*o+v*c+w*h+x*M,t[15]=y*i+v*d+w*g+x*b}function rotate(t,e,a,r,n,o){let i,s,l,c,d,u,p,h,g,m,f,M,b,y,v,w,x,z,A,S,T,E,k,R,L=Math.sqrt(r*r+n*n+o*o);L<1e-6||(L=1/L,r*=L,n*=L,o*=L,i=Math.sin(a),s=Math.cos(a),l=1-s,c=e[0],d=e[1],u=e[2],p=e[3],h=e[4],g=e[5],m=e[6],f=e[7],M=e[8],b=e[9],y=e[10],v=e[11],w=r*r*l+s,x=n*r*l+o*i,z=o*r*l-n*i,A=r*n*l-o*i,S=n*n*l+s,T=o*n*l+r*i,E=r*o*l+n*i,k=n*o*l-r*i,R=o*o*l+s,t[0]=c*w+h*x+M*z,t[1]=d*w+g*x+b*z,t[2]=u*w+m*x+y*z,t[3]=p*w+f*x+v*z,t[4]=c*A+h*S+M*T,t[5]=d*A+g*S+b*T,t[6]=u*A+m*S+y*T,t[7]=p*A+f*S+v*T,t[8]=c*E+h*k+M*R,t[9]=d*E+g*k+b*R,t[10]=u*E+m*k+y*R,t[11]=p*E+f*k+v*R,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]))}function scale(t,e,a,r,n){t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a,t[3]=e[3]*a,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]}function translate(t,e,a,r,n){if(e===t)t[12]=e[0]*a+e[4]*r+e[8]*n+e[12],t[13]=e[1]*a+e[5]*r+e[9]*n+e[13],t[14]=e[2]*a+e[6]*r+e[10]*n+e[14],t[15]=e[3]*a+e[7]*r+e[11]*n+e[15];else{let o,i,s,l,c,d,u,p,h,g,m,f;o=e[0],i=e[1],s=e[2],l=e[3],c=e[4],d=e[5],u=e[6],p=e[7],h=e[8],g=e[9],m=e[10],f=e[11],t[0]=o,t[1]=i,t[2]=s,t[3]=l,t[4]=c,t[5]=d,t[6]=u,t[7]=p,t[8]=h,t[9]=g,t[10]=m,t[11]=f,t[12]=o*a+c*r+h*n+e[12],t[13]=i*a+d*r+g*n+e[13],t[14]=s*a+u*r+m*n+e[14],t[15]=l*a+p*r+f*n+e[15]}}function setPerspective(t,e,a,r,n){const o=1/Math.tan(e),i=r-n;t[0]=o/a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(n+r)/i,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*n*r/i,t[15]=0}window.onload=function(){const t=[],e=document.getElementsByTagName("g");for(let a=0,r=e.length;a<r;++a)t.push(e[a].innerHTML);createTiles(t),waitForAtlas(createAtlas(t))}</script>