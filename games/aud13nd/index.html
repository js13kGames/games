<!doctype html><html><head><meta charset="utf-8"><link rel="icon" href="data:image/x-icon;base64,AA"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no" /><style>html{min-height:100%}body{background-color:#000;color:#333;font:14px monospace;height:100vh;margin:0;overflow:hidden;width:100vw}input[type-text],select{font:12px monospace}input[type-button]{font:14px monospace;padding:2px 4px}canvas{background:linear-gradient(#2a2e33,#25262a)}</style></head><body><script>!function(){"use strict";const e=()=>Date.now(),t=(t,n)=>{let s=e();const o=n?e=>setTimeout(e,n):requestAnimationFrame,a=()=>{const n=e();!1!==t((n-s)/1e3)&&(o(a),s=n)};a()},n={STATE_CHANGE:"state_change",LOOP_START:"loop_start",LOOP_STOP:"loop_stop",LOOP_LOGIC:"loop_logic",LOOP_PAINT:"loop_paint",CLOCK_PAUSE:"clock_pause",CLOCK_RESUME:"clock_resume",CLOCK_RESET:"clock_reset",SCENE_ENTER:"scene_enter",SCENE_LEAVE:"scene_leave",VIEWPORT_RESIZE:"viewport_resize",WILDCARD:"*",TIMEWARP:"timewarp",PAUSED:"paused",STOPPED:"stopped",CLOCK:"clock",DEBUG:"debug",SCENE:"scene",VIEWPORT:"viewport"},{STATE_CHANGE:s,LOOP_START:o,LOOP_STOP:a,LOOP_LOGIC:l,LOOP_PAINT:i,CLOCK_PAUSE:r,CLOCK_RESUME:c,CLOCK_RESET:u,WILDCARD:h,TIMEWARP:d,PAUSED:p,STOPPED:f,CLOCK:m}=n;const{STATE_CHANGE:w,SCENE_LEAVE:g,SCENE_ENTER:y}=n,{SCENE:E}=n;const{VIEWPORT_RESIZE:v,STATE_CHANGE:x}=n,{VIEWPORT:C}=n;const k=/^\s*<.+>\s*$/s;function A(e,t){if(!(this instanceof A))return new A(e,t);switch(typeof e){case Array.isArray(e)&&"object":case e instanceof NodeList&&"object":return this.push(...e);case"object":return this.push(e);case"string":return k.test(e)?this.push(...function(e){let t=document.createElement("div");return t.innerHTML=e,[...t.children].map((e=>t.removeChild(e)))}(e)):this.find(e,t)}}A.prototype={push:function(...e){return[].push.apply(this,e),this},find:function(e,t){return t=t||this[0]||document||documentElement,this.push(...t.querySelectorAll(e))},forEach:function(e){return[].forEach.call(this,e),this},on:function(e,t){return this.forEach((n=>n.addEventListener(e,t)))},off:function(e,t){return this.forEach((n=>n.removeEventListener(e,t)))},attr:function(...e){const[t,n]=e;return this.length>0&&1===e.length?this[0][t]:(2===e.length&&this.forEach((e=>e[t]=n)),this)},html:function(...e){return this.attr("innerHTML",...e)},css:function(e,t){return"object"==typeof e?(Object.keys(e).forEach((t=>this.css(t,e[t]))),this):this.forEach((n=>n.style[e]=t))},show:function(){return this.css("display","block")},hide:function(){return this.css("display","none")},hasClass:function(...e){return this.forEach((t=>t.classList.contains(...e)))},addClass:function(...e){return this.forEach((t=>t.classList.add(...e)))},removeClass:function(...e){return this.forEach((t=>t.classList.remove(...e)))},toggleClass:function(...e){return this.forEach((t=>t.classList.toggle(...e)))},appendTo:function(e){return this.forEach((t=>e.appendChild(t)))},append:function(e){return this[0].appendChild(e),this},remove:function(){return this.forEach((e=>e.parentNode.removeChild(e)))}};const b=/^(?:[A-GR#b\-0-9]+)(?:\*(\d+))?(?:\/(\d+))?([\.•]*)$/,S=4,_=(e,t)=>e+(t?_(e/2,t-1):0),q=e=>parseInt(e,10);function T(e){const[t,...n]=b.exec(e)||[],[s=1,o=1,a=""]=n;if(!t)throw new Error(`InvalidAudioNote: ${JSON.stringify(e)}`);return _(q(s)*S/q(o),a.length)}const L=/^((?:[A-GR][#b]*(?:-1|[0-9])?)+)(?:\*\d+)?(?:\/\d+)?\.*$/,G=/(?:([A-GR][#b]*)(-1|[0-9])?)/g,R=440;function B(e){const[t,n]=L.exec(e)||[];if(!t)throw new Error(`InvalidAudioNote: ${JSON.stringify(e)}`);const s=n.split(G),o=[];for(let t=1;t<s.length;t+=3){const n=D[s[t]];if(null==n)throw new Error(`InvalidAudioNote: ${JSON.stringify(e)}`);const a=n+12*(parseInt(s[t+1]||4,10)+1),l=n<0?0:R*Math.pow(2,(a-69)/12);o.push(l)}return o}const D={R:-1};function N(e){return{input:e,tones:B(e),count:T(e)}}function O(e){return e.replace(/\|/g," ").replace(/\s+/g," ").trim().split(" ").map(N)}D["B#"]=D.Dbb=D.C=0,D["C#"]=D["B##"]=D.Db=1,D["C##"]=D.Ebb=D.D=2,D["D#"]=D.Fbb=D.Eb=3,D.Fb=D["D##"]=D.E=4,D["E#"]=D.Gbb=D.F=5,D["F#"]=D["E##"]=D.Gb=6,D["F##"]=D.Abb=D.G=7,D["G#"]=D.Ab=8,D["G##"]=D.Bbb=D.A=9,D["A#"]=D.Bb=10,D.Cb=D["A##"]=D.B=11;const F=new Map;const $={cmajor:"C3/4 D3/4 E3/4 F3/4 G3/4 A3/4 B3/4 C4/4",twinkle:"C3/4 C3/4 G3/4 G3/4 A3/4 A3/4 G3/2",mario:"\n    E4/16 E4/8 E4/16 R/16 C4/16 E4/8 G4/4 G3/4\n    C4/8 R/16 G3/16 R/8 E3/8 R/16 A3/16 R/16 B3/16 R/16 Bb3/16 A3/8\n    G3/8 E4/8 G4/8 A4/8 F4/16 G4/16 R/16 E4/16 R/16 C4/16 D4/16 B3/16 R/8\n  ",chords1:"Ab4C5Eb5/2 Bb4Db5F5/2 Eb4G4Bb4Db5/2 F4Ab4C5/2",chords2:"\n    C#3A#2F#2/2 G#3F#3C#3/2 F#3C#3B2/2 G#3F#3C#3/2\n    G#3C#3A#2F#2/2 G#3F#3C#3/2 F#3C#3B2/2 G#3F#3C#3/2\n  ",kick4s:"E3/4 E3D3/4 E3/4 E3D3/4 E3/4 E3D3/4 E3/4 E3D3/4",seven_nation:"\n    E3/4. E3/8 G3/6 E3/6 D3/6\n    C3/2 B2/2\n    E3/4. E3/8 G3/6 E3/6 D3/6\n    C3/6 D3/6 C3/6 B2/2\n  ",fur_elise:"\n    E4/8 D#4/8\n    E4/8 D#4/8 E4/8 B3/8 Db4/8 C4/8\n    A3/4 R/8 C3/8 E3/8 A3/8\n  ",karma_lead:"\n    R/8 C5/4 D5/4 C5/4 B4*3/8\n    R/8. B4/16 E5/8 B4/4 C5/4\n    A4/4 D5/4 C5/4 B4*3/8\n    R/8 R/16 A4/16 E5/16 D5/16 C5/8 B4/8 C5/8\n  ",karma_acc:"\n    A2/4 C4A3E3/4 D2/8 D2/8 C4A3F3/4\n    D2/4 B3G#3E3/8 F2/8 G2/4 B3G#3D3/4\n    A2/4 C4A3E3/4 C4A3G3F3/4 F4C4A3F3/4\n    E2/4 B3G#3E3/8 F2/8 G2/4 B3G#3D3/4\n  ",we_will_rock_bass:"F4/2 E4/2 | D4/2 C4/2 | D4/4 D4/4 R/2 | R/1",we_will_rock_kick:"R/1 | R/1 | R/1 | E3/4 E3/4 R/2",we_will_rock_snare:"R/1 | R/1 | R/1 | R/2 G2/4 R/4",lev10_bass:"C3/4 C3/4 C3/4 A2/4 A2/4 A2/4 B2/4 B2/4 B2/4 G2/4 G2/4 G2/4 E2/4 E2/4 E2/4 F2/4 F2/4 F2/4 ",lev10_hat:"C3/2 C3/2 C3/2 C3/2",lev11_kick:"E0/4 E1/4 E2/4 E3/4 E4/4 E5/4 E6/4 E7/4 E8/4 E9/4",lev11_bass:"C3/8 C3/8 C3/8 C3/8 C3/8",lev12_lead:"C6/16 B5/16 A#5/16 A5/16 G#5/16 G5/16 F#5/16 F5/16 E5/16 D#5/16 D5/16 C#5/16 C5/16 B4/16 A#4/16 A4/16 G#4/16 G4/16 F#4/16 F4/16 E4/16 D#4/16 D4/16 C#4/16 C4/16",lev12_snare:"G2/16 G2/16 G2/16 G2/16 G2/16 G2/16 G2/16 G2/16",lev13_bass:"C/32 C#/32 D/32 D#/32 E/32 F/32 F#/32 G/32 G#/32 A/32 A#/32 B/32 C5/32 B/32 A#/32 A/32 G#/32 G/32 F#/32 F/32 E/32 D#/32 D/32 C#/32 C/32",lev13_kick:"E3/8 R/8 E3/8 R/8",lev13_snare:"R/8 G2/8 R/8 G2/8"},P=new class{state={__proto__:null,[f]:!0,[p]:!1,[d]:1,[m]:0};listeners=new Map;constructor(){this.on(s,(({key:e,value:t})=>{e===p&&this.emit(t?r:c),e===f&&this.emit(t?a:o),e===m&&0===t&&this.emit(u)}))}plugin(e,t){const n=e.call(this,t||{});return n?.name&&(this[n.name]=n),this}logic(e){return e*=this.get(d),!1===this.get(p)&&(this.state[m]+=e),this.emit(l,{tick:e}),!1===this.get(f)}paint(e){return e*=this.get(d),this.emit(i,{tick:e}),!1===this.get(f)}step(e=1){this.logic(e),this.paint(e)}start(){!0===this.get(f)&&(this.set(m,0),this.set(p,!1),this.set(f,!1),t(this.logic.bind(this),5),t(this.paint.bind(this),null))}stop(){this.set(f,!0)}pause(){this.set(p,!0)}resume(){this.set(p,!1)}on(e,t,n=!1){this.listeners.has(e)||this.listeners.set(e,[]);const s=!0===n?"unshift":"push";return this.listeners.get(e)[s](t),()=>this.off(e,t)}off(e,t){if(this.listeners.has(e))if(null==t)this.listeners.delete(e);else{let n=this.listeners.get(e);n=n.filter((e=>e!==t)),this.listeners.set(e,n)}}emit(e,t){if(this.listeners.has(e)||this.listeners.has(h)){const n=n=>setTimeout((()=>{n.call(this,{...t,type:e})}),0);this.listeners.get(h)?.forEach(n),this.listeners.get(e)?.forEach(n)}}set(e,t){1===arguments.length&&Object.keys(e).forEach((t=>this.set(t,e[t]))),this.get(e)!==t&&(this.emit(s,{key:e,value:t,previous:this.state[e]}),this.state[e]=t)}get(e){return e?this.state[e]:{...this.state}}};P.plugin((function(e={}){const t=this,{name:n="Gloop",initial:s={},keys:o=[]}=e,a=new Set(["",...o]),l=(e,t)=>a.has(e)?t:void 0;try{t.set(JSON.parse(localStorage.getItem(n),l))}catch(e){console.log(e),t.set(s)}t.on("state_change",(()=>{localStorage.setItem(n,JSON.stringify(t.get(),l))}))}),{name:"AUD13ND",keys:["resume","highscore","totalscore","unlocked"],initial:{resume:"",highscore:0,totalscore:0,unlocked:!1}}),P.plugin((function(e){document.addEventListener("visibilitychange",(()=>{document.hidden&&this.pause()}))})),P.plugin((function(e){const t=new Map;return this.on(w,(({key:e,value:t,previous:n})=>{e===E&&(n&&this.emit(g,{name:n}),t&&this.emit(y,{name:t}))})),this.on(g,(({name:e})=>{const n=t.get(e)||{};n.teardown?.call(this)})),this.on(y,(({name:e})=>{const n=t.get(e)||{};n.teardown=n.setup?.call(this)})),{name:"scene",create:(e,n)=>{t.set(e,{setup:n})},set:e=>{this.set(E,e)}}})),P.plugin((function(e){this.on(x,(({key:e,value:t})=>{e===C&&this.emit(v,t)})),this.setViewport=(e,t)=>{this.set(C,{w:e,h:t})};const t=()=>{const{innerWidth:e,innerHeight:t}=window;this.setViewport(e,t)};window.addEventListener("orientationchange",t),window.addEventListener("resize",t),t()})),P.random=function e(t){e.n=e.n||1;let n=((e,t,n,s)=>()=>{let o=((e|=0)+(t|=0)|0)+(s|=0)|0;return s=s+1|0,e=t^t>>>9,t=(n|=0)+(n<<3)|0,n=(n=n<<21|n>>>11)+o|0,(o>>>0)/4294967296})(...(e=>{let t=1779033703,n=3144134277,s=1013904242,o=2773480762;for(let a,l=0;l<e.length;l++)a=e.charCodeAt(l),t=n^Math.imul(t^a,597399067),n=s^Math.imul(n^a,2869860233),s=o^Math.imul(s^a,951274213),o=t^Math.imul(o^a,2716044179);return t=Math.imul(s^t>>>18,597399067),n=Math.imul(o^n>>>22,2869860233),s=Math.imul(t^s>>>17,951274213),o=Math.imul(n^o>>>19,2716044179),t^=n^s^o,n^=t,s^=t,o^=t,[t>>>0,n>>>0,s>>>0,o>>>0]})(String(t||`${e.n++}/${Date.now()}`)));return function(e=1,t=0){const s=Math.min(e,t),o=Math.max(e,t);return n()*(o-s)+s}}(),P.plugin((function(){const e=this,t=new AudioContext;A(document.body).on("click",(()=>{"suspended"===t.state&&(console.log("ENABLED WEB AUDIO"),t.resume())}));const n=new AnalyserNode(t),s=new AnalyserNode(t),o=new AnalyserNode(t),a=new AnalyserNode(t),l=new AnalyserNode(t),i=new GainNode(t),r=new GainNode(t),c=new GainNode(t),u=new GainNode(t),h=new GainNode(t),d=new DynamicsCompressorNode(t,{ratio:20,knee:1,attack:0,release:.015}),p=new GainNode(t);i.connect(n).connect(d),r.connect(s).connect(d),c.connect(o).connect(d),u.connect(a).connect(d),h.connect(l).connect(d),d.connect(p).connect(t.destination);const f=(t,{x:n,y:s,w:o,h:a,s:l,hue:i,alpha:r=1})=>{const{ctx:c}=e.canvas;c.lineWidth=l,c.lineJoin="round",c.strokeStyle=`hsla(${i},100%,50%,${r})`,c.beginPath();const u=t.frequencyBinCount,h=new Uint8Array(u);t.getByteTimeDomainData(h);const d=1*o/u;for(let e=0,t=0;t<u;t++){const o=h[t]/128*a/2;c[0===t?"moveTo":"lineTo"](n+e,s+o),e+=d}c.lineTo(o+n,s+a/2),c.stroke(),c.closePath()},m=(e,n=440,s=.5,o={})=>{const{wave:a,attack:l,decay:r,sustain:c,release:u}=o,h=new OscillatorNode(t,{type:a,frequency:n}),d=new GainNode(t);d.gain.setValueAtTime(0,e),d.gain.exponentialRampToValueAtTime(1,e+l*s),d.gain.exponentialRampToValueAtTime(c,e+l*s+r*s),d.gain.exponentialRampToValueAtTime(1e-5,e+s+u*s),h.start(e),h.stop(e+s+u*s),h.onended=()=>{h.disconnect(),d.disconnect()},h.connect(d).connect(i)},w=(e,n=167.1,s=.5,o={})=>{const a=new OscillatorNode(t,{type:"sine",frequency:n}),l=new GainNode(t);a.frequency.setValueAtTime(n,e+.001),l.gain.linearRampToValueAtTime(1,e+.1),a.frequency.exponentialRampToValueAtTime(1,e+s),l.gain.exponentialRampToValueAtTime(.01,e+s),l.gain.linearRampToValueAtTime(0,e+s+.1),a.start(e),a.stop(e+s+.1),a.onended=()=>{a.disconnect(),l.disconnect()},a.connect(l).connect(c)},g=()=>{const n=t.sampleRate,s=new AudioBuffer({numberOfChannels:1,length:n,sampleRate:n}),o=s.getChannelData(0);for(let t=0;t<n;t++)o[t]=e.random(2,1);return new AudioBufferSourceNode(t,{buffer:s})},y=(e,n=130.81,s=1.5,o={})=>{const a=new GainNode(t);a.gain.setValueAtTime(1e-5,e),a.gain.exponentialRampToValueAtTime(1,e+.067*s),a.gain.exponentialRampToValueAtTime(.3,e+.1*s),a.gain.exponentialRampToValueAtTime(1e-5,e+s);const l=new BiquadFilterNode(t,{type:"bandpass",frequency:2e4,Q:.2}),i=new BiquadFilterNode(t,{type:"highpass",frequency:5e3});l.connect(i).connect(a).connect(h),[1,1.342,1.2312,1.6532,1.9523,2.1523].forEach((o=>{const a=new OscillatorNode(t,{type:"square",frequency:n*o});a.start(e),a.stop(e+s),a.onended=()=>{a.disconnect()},a.connect(l)}))};e.on("state_change",(({key:e,value:n,previous:s})=>{let o=null,a=null;switch(e){case"lead":o=i,a=n?.params?.gain;break;case"bass":o=r,a=n?.params?.gain;break;case"kick":o=c,a=n?.params?.gain;break;case"snare":o=u,a=n?.params?.gain;break;case"hat":o=h,a=n?.params?.gain;break;case"volume":o=p,a=n}null!=o&&null!=a&&((e,n)=>{n=0===n?1e-6:n,e.gain.exponentialRampToValueAtTime(n,t.currentTime)})(o,a)}));const E=(e="",n=m,s=120)=>{let o=t.currentTime;O(e).forEach((({count:e,tones:t})=>{const a=e*(60/s);t.forEach((e=>n(o,e,a))),o+=a}))};return e.on("foe_collision",(()=>{E("A4E7/2",w)})),e.on("foe_expire",(()=>{E("A7G3/4",y)})),{name:"audio",ctx:t,playLead:m,playBass:(e,n=440,s=.5,o={})=>{const{wave:a,attack:l,decay:i,sustain:c,release:u}=o,h=new OscillatorNode(t,{type:a,frequency:n}),d=new GainNode(t);d.gain.setValueAtTime(0,e),d.gain.exponentialRampToValueAtTime(1,e+l*s),d.gain.exponentialRampToValueAtTime(c,e+l*s+i*s),d.gain.exponentialRampToValueAtTime(1e-5,e+s+u*s),h.start(e),h.stop(e+s+u*s),h.onended=()=>{h.disconnect(),d.disconnect()},h.connect(d).connect(r)},playKick:w,playSnare:(e,n=100,s=.25,o={})=>{const a=g(),l=new BiquadFilterNode(t,{type:"highpass",frequency:1e3}),i=new GainNode(t);i.gain.setValueAtTime(1,e),i.gain.exponentialRampToValueAtTime(.01,e+s);const r=new GainNode(t),c=new OscillatorNode(t,{type:"triangle",frequency:n});r.gain.setValueAtTime(.7,e),r.gain.exponentialRampToValueAtTime(.01,e+s/2),a.start(e),a.stop(e+s),c.start(e),c.stop(e+s),c.onended=()=>{c.disconnect(),a.disconnect()},a.connect(l).connect(i).connect(u),c.connect(r).connect(u)},playHat:y,renderAnalyzers:e=>{f(l,{...e,hue:290}),f(a,{...e,hue:210}),f(o,{...e,hue:185}),f(s,{...e,hue:330}),f(n,{...e,hue:120})}}})),P.plugin((function(){const e=this,t=document.createElement("canvas"),n=A(t).appendTo(document.body),s=t.getContext("2d"),o={};n.on("mousedown",(t=>{const{offsetX:n,offsetY:s}=t,i="sequencer"===e.state.scene;l.forEach((e=>{const{x:t,y:o,w:a,h:l,onChange:i}=e;n>t&&n<t+a&&s>o&&s<o+l&&i()})),e.state.overlayVisible||(e.seq.cells.forEach((t=>{const{key:a,x:l,y:r,w:c,h:u,col:h,row:d,on:p}=t;if(n>l&&n<l+c&&s>r&&s<r+u){o.type=`cell/${a}`,o.target=t,o.from=[n,s];const l=i&&!0===p;e.seq.setSelected(a,d,h,l)}else;})),a.forEach((e=>{const{x:t,y:a,w:l,h:i}=e;if(n>t&&n<t+l&&s>a&&s<a+i)return o.type="slider",void(o.target=e)})))})),n.on("mousemove",(t=>{const{offsetX:n,offsetY:s}=t;if(0===o.type?.indexOf("cell")){const[t,a]=o.from,l=n-t,i=s-a;Math.sqrt(l*l+i*i)>5&&e.seq.cells.forEach((t=>{const{key:o,row:a,col:l,x:i,y:r,w:c,h:u}=t;n>i&&n<i+c&&s>r&&s<r+u&&e.seq.setSelected(o,a,l)}))}if("slider"===o.type){const{y:e,h:t,min:n,max:a,onChange:l}=o.target;l((1-Math.min(1,Math.max(0,(s-e)/t)))*(a-n)+n)}})),n.on("mouseup",(e=>{o.type=null,o.target=null,o.from=null})),e.on("viewport_resize",(({w:e,h:n})=>{t.width=e,t.height=n}));let a=[],l=[];const i=({value:e,x:t,y:n,w:o,f:a=9})=>{s.fillStyle="rgba(255,255,255,.75)",s.textBaseline="top",s.textAlign="center",s.font=`${a}px monospace`,s.letterSpacing="1px",s.textRendering="optimizeLegibility",s.fillText(e,t,n,o),s.letterSpacing="0px"},r=(e={})=>{let t,n,{x:o,y:a,w:l,h:i,p:r=2,r:c=4,s:u=1,hue:h=120,sat:d=100,lum:p=50,on:f,dead:m,curr:w}=e;!0===m?(t=`hsla(${h},0%,${p}%,.15)`,n=`hsla(${h},0%,${p}%,.3)`):!0===f?(t=`hsla(${h},${d}%,${p}%,.75)`,n=`hsla(${h},${d}%,${p}%,.9)`):!0===w?(t=`hsla(${h},${d}%,${p}%,.35)`,n=`hsla(${h},${d}%,${p}%,.5)`):(t=`hsla(${h},${d}%,${p}%,.15)`,n=`hsla(${h},${d}%,${p}%,.3)`),s.fillStyle=t,s.beginPath(),s.roundRect(o+r,a+r,l-r-r,i-r-r,c??4),s.fill(),s.lineWidth=u??1,s.strokeStyle=n,s.stroke()};return{name:"canvas",ctx:s,$canvas:n,clear:()=>{const{w:t,h:n}=e.state.viewport;s.clearRect(0,0,t,n),a=[],l=[]},drawContainer:({x:e,y:t,w:n,h:o,r:a=10,c1:l,c2:i,p:r=50})=>{e+=r,t+=r,n-=r+r,o-=r+r;const c=s.createLinearGradient(e+n/2,t,e+n/2,o);return c.addColorStop(0,l??"rgba(40,46,51,.95)"),c.addColorStop(1,i??"rgba(29,30,34,.95)"),s.fillStyle=c,s.lineWidth=1,s.strokeStyle="#494C52",s.beginPath(),s.roundRect(e,t,n,o,a),s.stroke(),s.fill(),s.shadowColor=null,s.shadowBlur=null,s.shadowOffsetX=0,s.shadowOffsetY=0,{x:e,y:t,w:n,h:o}},drawBox:r,drawLabel:i,drawSlider:(e={})=>{let{label:t,x:n,y:s,w:o,h:l,value:c,min:u,max:h,p:d,r:p,s:f,hue:m,sat:w,lum:g}=e;a.push(e),r({x:n,y:s,w:o,h:l,p:d,r:p,s:f,hue:m,sat:w,lum:g}),i({value:t,x:n+o/2,y:s+l+d,w:o}),l-=10,r({x:n,y:s+(l-l*((c-u)/(h-u))),w:o,h:10,p:d,r:1,s:f,hue:m,sat:w,lum:g,on:!0})},drawButton:(e={})=>{let{x:t,y:n,w:o,h:a,value:i,on:c,p:u,r:h,s:d,hue:p,sat:f,lum:m,f:w=8}=e;l.push(e),r({x:t,y:n,w:o,h:a,on:c,p:u,r:h,s:d,hue:p,sat:f,lum:m}),s.fillStyle=!0===c?"rgba(0,0,0,.75)":"rgba(255,255,255,.75)",s.textBaseline="middle",s.textAlign="center",s.font=`${w}px monospace`,s.fillText(i,t+o/2,n+2+a/2,o)}}})),P.plugin((function(){const e=this,t=["lead","bass","kick","snare","hat"],n=()=>{t.forEach((t=>{const n=e.state[t];n.time=e.audio.ctx.currentTime,n.next=-1}))},s=()=>{e.state.paused||(o(e.state.lead,e.audio.playLead),o(e.state.bass,e.audio.playBass),o(e.state.kick,e.audio.playKick),o(e.state.snare,e.audio.playSnare),o(e.state.hat,e.audio.playHat))},o=(t,n)=>{const{tempo:s}=e.state,{currentTime:o}=e.audio.ctx;let{rows:a,cols:l,notes:i,next:r,time:c,killed:u,params:h}=t;for(;c<=o+.05;){const e=r%l.length,t=r<0?.5:l[e]*(60/s),o=r<0?[0]:a[i[e]];r>-1&&!0!==u.has(e)&&o?.forEach((e=>{n(c,e,t,h)})),c+=t,r+=1}t.time=c,t.next=r};let a=[];const l={p:2,r:4,s:2,hue:105},i=()=>{const{clear:n,drawContainer:s}=e.canvas,{viewport:o}=e.state;n();const{padding:i=50}=p,c=s({x:0,y:0,w:o.w,h:o.h,p:i,r:25}),u=120+i+i,h=e.controls.render({x:c.x,y:c.y+c.h-u,w:c.w,h:u,p:i,props:l});a=e.seq.cells=[];let d=0,f=0;t.forEach((t=>{const{rows:n}=e.state[t];d+=n.length,f+=n.length?i:0}));const m=(c.h-h.h-f-i)/d;let w=c.y+i,g=0;t.forEach((t=>{g=m*e.state[t].rows.length,r(t,{x:c.x,y:w,w:c.w,h:g,p:i}),w+=g?g+i:0}))},r=(t,{x:n,y:s,w:o,h:i,p:r})=>{if(0===i)return;n+=r,o-=r+r;const{ctx:c,drawBox:u}=e.canvas,{rows:h,cols:d,duration:p,notes:f,next:m,killed:w}=e.state[t],g=o/p,y=i/h.length,E=d.length,v=m<1?0:(m-1)%E;for(let e=0,o=0;e<d.length;e++){let r=d[e]*g;v===e&&(c.fillStyle="rgba(255,255,255,.75)",c.fillRect(n+o,s+i+l.p,r,10));const p=f[e]??-1;for(let i=0;i<h.length;i++){const c={key:t,row:i,col:e,x:n+o,y:s+i*y,w:r,h:y,...l,on:!1,dead:w.has(e),curr:v===e};a.push(c),c.on=p===i&&!c.dead,u(c)}o+=r}return{x:n,y:s,w:o,h:i+r}},c=(t,n,s={})=>{let o=0,a=[],l=[],i={},r=[];n&&O(n).forEach((({count:e,tones:t,input:n})=>{a.push(e),o+=e;const s=n.replace(/(?:\*\d+)?(?:\/\d+)?\.*$/g,"");"R"!=s&&null==i[s]&&(i[s]=l.push(t)-1),r.push(i[s])})),e.set(t,{key:t,cols:a,duration:o,rows:l,notes:r,next:-1,time:0,killed:new Map,params:{...u[t],...s}})},u={lead:{gain:.5,wave:"sine",attack:.25,decay:.25,sustain:.8,release:.5},bass:{gain:.5,wave:"sawtooth",attack:.1,decay:.25,sustain:.8,release:.75},kick:{gain:.5},snare:{gain:.5},hat:{gain:.5}};e.set("volume",1),e.set("tempo",120);const h=({key:t,col:n})=>{e.state[t].killed.set(n,!0),0===d()&&(e.pause(),e.emit("level_failed"))},d=()=>{let n=0,s=0;return t.forEach((t=>{const{rows:o,cols:a,killed:l}=e.state[t];o.length>1&&(n+=a.length),s+=l.size}),0),n-s};let p={};return{name:"seq",setup:t=>{p={...t},e.on("loop_logic",s),e.on("clock_resume",n),e.on("loop_paint",i),e.on("foe_collision",h),c("lead",""),c("bass",""),c("kick",""),c("snare",""),c("hat","")},teardown:()=>{e.off("loop_logic",s),e.off("clock_resume",n),e.off("loop_paint",i),e.off("foe_collision",h)},setSelected:(t,n,s,o)=>{let{notes:a,rows:l}=e.state[t];null!==l[n]&&(a[s]=o?null:n)},setParams:(t,n)=>{const s=e.state[t];Object.assign(s.params,n),e.set(t,{...s})},cells:a,getRandomRow:()=>{const n=t.filter((t=>e.state[t]?.rows.length>1)),s=n[Math.floor(e.random(n.length))],{notes:o,killed:a}=e.state[s],{length:l}=o;for(let t=0;t<l;t++){const t=Math.floor(e.random(l));if(!0!==a.has(t))return{key:s,row:o[t]}}},countRemainingCols:d,loadSong:c}})),P.plugin((function(){const e=this;let t=[],n=[],s=null;const o=t=>{const{random:n}=e;return{w:n(2*t,t/2),h:n(t,t/2),tilt:n(Math.PI,-Math.PI),angle:n(Math.PI,-Math.PI),t:1,hue:n(240,420)}},a=({rx:t,index:n,d:s})=>{const{cells:o}=e.seq,a=(()=>{const{cells:t}=e.seq,n=t[0],s=t[t.length-1];return(s.x+s.w-n.x)/1e3})(),l=o[n],i=l.y+l.h/2;return{x:l.x+t*a,y:i,w:s,h:s}},l=t=>{const{ctx:n}=e.canvas,{x:s,y:o,w:l}=null==t.x?a(t):t;n.beginPath(),n.arc(s,o,l,0,2*Math.PI,!1);const r=n.createRadialGradient(s,o,0,s,o,l);r.addColorStop(0,"hsla(0,0%,0%,1)"),r.addColorStop(.75,"hsla(0,0%,0%,0)"),n.fillStyle=r,n.fill(),t.particles.forEach((e=>{e.x=s,e.y=o,i(e)}))},i=({x:t,y:n,w:s,h:o,tilt:a,angle:l,t:i,hue:r})=>{const{ctx:c}=e.canvas;c.lineWidth=2,c.strokeStyle=`hsla(${r},100%,50%,1)`,c.beginPath(),c.ellipse(t,n,s,o,a,l,l+i),c.stroke()},r=({tick:l})=>{if(t.forEach((e=>{e.particles.forEach((e=>{e.angle+=30*l,e.tilt-=3*l}))})),n=n.flatMap((e=>(e.angle+=30*l,e.tilt-=3*l,e.w*=1.2,e.h*=1.2,e.t-=l,e.t>0?e:[]))),!e.state.paused)if(e.state.countdown-=l,e.state.countdown<=0){e.pause();let s=e.state.levelscore;t.forEach((e=>{n.push(...e.particles),s+=100})),t=[],e.set("levelscore",s);const o="Level 13"===e.state.scene;e.emit(o?"sequencer_unlocked":"level_completed")}else t=t.flatMap((t=>{if((t=>{const{cells:n}=e.seq,s=a(t);for(let e=0;e<n.length;e++){const o=n[e];if(t.key!=o.key||!0!==o.on||o.row!=t.row)continue;const a=Math.max(o.x,s.x-s.w/2);Math.min(o.x+o.w,s.x+s.w/2)-a>0&&(t.collision={key:t.key,row:o.row,col:o.col,x:s.x,y:s.y})}})(t),t.collision)return e.emit("foe_collision",t.collision),n.push(...t.particles),[];if(t.hold>0?t.hold-=l:t.rx+=t.v*l,t.v>0?t.rx>1050:t.rx<-50){e.emit("foe_expire",t);let n=e.state.levelscore;return e.set("levelscore",n+100),[]}return t})),(n=>{if(t.length>=u.limit)return;if(s=s??u.intro,s>0)return void(s-=n);const{getRandomRow:a,cells:l}=e.seq,i=a();if(!i)return;const r=l.findIndex((e=>e.key===i.key&&e.row===i.row)),c=Math.round(e.random())?-1:1,h={...i,index:r,rx:c>0?-50:1050,d:20,v:u.speed*c,hold:u.hold,particles:[...Array(30).keys()].map((()=>o(20)))};null!=h.row&&h.index>=0&&(t.push(h),e.emit("foe_spawn",h),s=u.delay)})(l)},c=()=>{t.forEach(l),n.forEach(i),e.overlay.render()};let u={intro:5,delay:2,hold:2,limit:1,speed:200,countdown:60};return{name:"foes",setup:n=>{t=[],u={...u,...n},e.set("levelscore",0),e.set("countdown",u.countdown),e.on("loop_logic",r),e.on("loop_paint",c)},teardown:()=>{e.off("loop_logic",r),e.off("loop_paint",c)},drawFoe:l,makeParticle:o}})),P.plugin((function(){const e=this,t={p:2,r:3,s:1,hue:105};let n="W";const s={"-180":"W","-135":"NW","-90":"N","-45":"NE",0:"E",45:"SE",90:"S",135:"SW",180:"W"},o=t=>{const{viewport:o}=e.state,a=t.offsetX-o.w/2,l=t.offsetY-o.h/3,i=Math.atan2(l,a)*(180/Math.PI);n=s[45*Math.round(i/45)]};let a="x",l=null;const i=t=>{switch(t.code){case"ArrowUp":n="N";break;case"ArrowDown":n="S";break;case"ArrowLeft":n="W";break;case"ArrowRight":n="E"}clearTimeout(l),l=setTimeout((()=>a="x"),800),a+=t.keyCode,"x38384040373937396665"===a&&e.emit("sequencer_unlocked")},r={d:20,w:20,h:20,particles:[...Array(30).keys()].map((()=>e.foes.makeParticle(20)))};let c=0;const u=({tick:s})=>{c+=s;const{viewport:o,resume:a,highscore:l,unlocked:i}=e.state,{drawButton:u,drawLabel:h,clear:d}=e.canvas;d();const p=((e,t,n={})=>{const s=JSON.stringify([e,t,n]);if(!F.has(s)){const{w:o,h:a,x:l,y:i,fontSize:r=190,spacing:c,n:u,dir:h}=n,d=new OffscreenCanvas(o,a).getContext("2d");d.font=`bold ${r}px Monaco, monospace`,d.textBaseline="middle",d.textAlign="center",d.letterSpacing="14px",d.lineWidth=8,d.fillStyle="#000000",d.fillText(e,o/2,a/3,o),d.strokeStyle="#000000",d.strokeText(e,o/2,a/3,o),d.fillStyle="#FF0000",d.fillText(t,o/2,a/3,o),d.strokeStyle="#FF0000",d.strokeText(t,o/2,a/3,o);let p=[];const f=/W/.test(h)?c-u-1:/E/.test(h)?u:0,m=/N/.test(h)?c-u-1:/S/.test(h)?u:0,{data:w,width:g}=d.getImageData(0,0,o,a);for(let e=0,t=4*g;e<w.length;e+=4){const n=Math.floor(e%t/4),s=Math.floor(e/t);n%c===f&&s%c===m&&w[e+3]>0&&p.push({x:l+n,y:i+s,w:c,h:c,on:w[e+0]>0})}F.set(s,p)}return F.get(s)})("AUD  ND","   13  ",{x:50,y:50,w:o.w-100,h:o.h-100,spacing:14,n:Math.floor(10*c)%14,dir:n});p.forEach((n=>e.canvas.drawBox({...t,...n}))),r.particles.forEach((e=>{e.angle+=30*s,e.tilt-=3*s}));const f=p[p.length-1];e.foes.drawFoe({x:o.w/2,y:f.y+(o.h/2+100-f.y+f.h)/2,...r}),u({name:"Start",x:o.w/2-100,y:o.h/2+100,w:200,h:60,f:16,...t,value:"Start New Game",on:!1,onChange:()=>{e.set("resume",""),e.set("newgame",!0),e.set("totalscore",0),e.scene.set("Level 1")}}),a&&u({name:"Resume",x:o.w/2-100,y:o.h/2+160,w:200,h:60,f:16,...t,value:`Resume ${a}`,on:!1,onChange:()=>{e.scene.set("resume")}}),!0===i&&u({name:"Sequencer",x:o.w/2-100,y:o.h/2+220,w:200,h:60,f:16,...t,value:"Play Sequencer",on:!1,onChange:()=>{e.scene.set("sequencer")}}),l>0&&h({value:`Highscore ${l}`,x:o.w/2,y:o.h/2+300,w:200,f:16}),e.overlay.render()},h=()=>{e.off("loop_paint",u),e.canvas.$canvas.off("mousemove",o),A(window).off("keydown",i)};return{name:"menu",setup:()=>(e.on("loop_paint",u),e.canvas.$canvas.on("mousemove",o),A(window).on("keydown",i),h)}})),P.plugin((function(){const e=this;let t=null,n=[],s=null,o=null;const a={p:2,r:3,s:1,hue:105};return e.on("clock_resume",(()=>{e.set("overlayVisible",!1)})),e.on("scene_enter",(({name:a})=>{!0===e.get("newgame")?(e.set("overlayVisible",!0),t="How to Play",n=["Click or drag around the grid to select","a note (row) for each beat (column). Enjoy","the sounds and avoid obstacles to survive."],s="Let's Go!",o=()=>{e.set("newgame",!1),e.resume()}):/^Level/.test(a)&&(e.set("overlayVisible",!0),t=a,n=[],s="Begin",o=()=>e.resume())})),e.on("level_failed",(()=>{e.set("overlayVisible",!0),t="Level Failed",n=[],s="Try Again",o=()=>e.scene.set("resume")})),e.on("level_completed",(()=>{const{scene:a,nextLevel:l}=e.state;e.set("overlayVisible",!0);const{totalscore:i,levelscore:r,highscore:c}=e.state,u=50*e.seq.countRemainingCols(),h=i+r+u;e.set("totalscore",h),e.set("levelscore",0),t=`${a} Complete`,n=[`Level +${r}`,`Bonus +${u}`,`Total ${h}`],h>c&&(n.push("New High Score!"),e.set("highscore",h)),e.set("resume",l),s=`Next: ${l}`,o=()=>e.scene.set(l)})),e.on("sequencer_unlocked",(()=>{e.set("overlayVisible",!0),e.set("unlocked",!0),t="Amazing Work!",n=["You unlocked the sequencer!","Have fun making music..."],s="Play Sequencer",o=()=>{e.scene.set("sequencer")}})),{name:"overlay",render:()=>{if(!0===e.get("overlayVisible")){const{ctx:l,drawButton:i}=e.canvas,{viewport:r}=e.state,c=500,u=400,h=r.w/2-c/2,d=r.h/2-u/2;l.globalAlpha=1;const p=l.createLinearGradient(h,d,c,u);p.addColorStop(0,"rgba(21,23,27,.75)"),p.addColorStop(1,"rgba(29,30,34,.75)"),l.fillStyle=p,l.shadowColor="rgba(0,0,0,.75)",l.shadowBlur=25,l.shadowOffsetX=0,l.shadowOffsetY=12.5,l.beginPath(),l.roundRect(h,d,c,u,25),l.fill(),l.shadowColor=null,l.shadowBlur=null,l.shadowOffsetX=0,l.shadowOffsetY=0,l.fillStyle="rgba(255,255,255,.75)",l.textBaseline="middle",l.textAlign="center",l.font="24px monospace",l.fillText(t,h+c/2,d+u/4,c),l.font="14px monospace",n.forEach(((e,t)=>{l.fillText(e,h+c/2,d+u/2+20*t,c)})),i({x:h+c/2-100,y:d+3*u/4,w:200,h:60,f:16,...a,value:s,on:!1,onChange:o})}}}})),P.plugin((function(){const e=this,{drawSlider:t,drawButton:n,drawLabel:s}=e.canvas,{setParams:o}=e.seq,a=({x:t,y:n,w:s,h:o,p:a,props:i})=>{const{ctx:r}=e.canvas;e.audio.renderAnalyzers({x:t,y:n,w:s,h:o,...i}),r.fillStyle="rgba(255,255,255,.75)",r.textBaseline="top",r.textAlign="center",r.font="18px monospace",r.letterSpacing="1px",r.textRendering="optimizeLegibility";const{scene:c,totalscore:u,levelscore:h,countdown:d}=e.state,p=u+h,f=[c,`Time ${Math.round(d)}`,`Score ${p}`];r.fillText(f.join(" • "),t+s/2,n,s),l({x:t,y:n,w:s,h:o})},l=({x:t,y:n,w:s,h:o})=>{const{ctx:a}=e.canvas;a.textBaseline="bottom",a.textAlign="center",a.font="36px monospace",a.letterSpacing="12px",a.textRendering="optimizeLegibility",a.fillStyle="hsla(120,100%,50%,.3)",a.fillText("AUD  ND",t+s/2,n+o+7,s),a.fillStyle="hsla(120,100%,50%,.6)",a.fillText("   13  ",t+s/2,n+o+7,s),a.letterSpacing="0px"},i=({x:a,y:i,w:r,h:c,p:u,props:h})=>{const{volume:d,tempo:p}=e.state;let f=0;const m=40;let w=0;let g=0;["lead","bass"].forEach((l=>{["attack","decay","sustain","release"].forEach((n=>{t({label:n.substring(0,3).toUpperCase(),x:a+f,y:i,w:m,h:c,...h,value:e.state[l].params[n],min:1e-5,max:1,onChange:e=>o(l,{[n]:parseFloat(e)})}),f+=m})),w=0;const{wave:r}=e.state[l].params;["sawtooth","sine","square","triangle"].forEach((e=>{n({x:a+f,y:i+w,w:m,h:30,...h,value:e.substring(0,3).toUpperCase(),on:r==e,onChange:()=>o(l,{wave:e})}),w+=30})),s({value:"WAVE",x:a+f+20,y:i+w+h.p,w:m}),f+=60})),g+=120,n({x:a+r-g,y:i,w:120,h:120,f:16,...h,value:e.state.paused?"PLAY":"PAUSE",on:!e.state.paused,onChange:()=>{e.state.paused?e.resume():e.pause()}}),g+=60,t({label:"VOLUME",x:a+r-g,y:i,w:60,h:c,...h,value:d,min:1e-5,max:2,onChange:t=>e.set("volume",parseFloat(t))}),g+=m,w=0,[240,180,120,60].forEach((t=>{n({x:a+r-g,y:i+w,w:m,h:30,...h,value:t,on:p==t,onChange:()=>e.set("tempo",t)}),w+=30})),s({value:"BPM",x:a+r-g+20,y:i+w+h.p,w:m}),g+=20,["lead","bass","kick","snare","hat"].reverse().forEach((n=>{g+=m,t({label:n.toUpperCase(),x:a+r-g,y:i,w:m,h:c,...h,value:e.state[n].params.gain,min:1e-5,max:1,onChange:e=>o(n,{gain:parseFloat(e)})})})),e.audio.renderAnalyzers({x:a+f,y:i,w:r-f-g-20,h:c,...h,alpha:1}),l({x:a,y:i,w:r,h:c})};return{name:"controls",render:({x:t,y:n,w:s,h:o,p:l,props:r})=>{t+=l,n+=l,s-=l+l,o-=l+l;const c="sequencer"===e.state.scene?"jam":"game";return"jam"===c&&i({x:t,y:n,w:s,h:o,p:l,props:r}),"game"===c&&a({x:t,y:n,w:s,h:o,p:l,props:r}),{x:t,y:n,w:s,h:o+l}}}})),P.scene.create("mainmenu",P.menu.setup),P.scene.create("sequencer",(()=>(P.seq.setup({controls:!0,stats:!1}),P.seq.loadSong("lead","C5/4 D5/4 E5/4 F5/4 G5/4 A5/4 B5/4 C6/4"),P.seq.loadSong("bass","C4/4 B3/4 A3/4 G3/4 F3/4 E3/4 D3/4 C3/4"),P.seq.loadSong("kick","E3/4 E3/4 E3/4 E3/4 E3/4 E3/4 E3/4 E3/4"),P.seq.loadSong("snare","G2/8 G2/8 G2/8 G2/8 G2/8 G2/8 G2/8 G2/8"),P.seq.loadSong("hat","C3/2 C3/2 C3/2 C3/2"),()=>{P.seq.teardown()}))),P.scene.create("resume",(()=>{P.scene.set(P.get("resume")||"mainmenu")})),P.scene.create("Level 1",(()=>(P.seq.setup(),P.foes.setup({limit:1,speed:110,countdown:10}),P.set("tempo",120),P.seq.loadSong("lead",$.chords1),P.set("nextLevel","Level 2"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 2",(()=>(P.seq.setup(),P.foes.setup({limit:1,speed:120,countdown:20}),P.set("tempo",120),P.seq.loadSong("lead",$.twinkle,{wave:"sine",attack:.1,decay:.1,sustain:.9,release:.25}),P.set("nextLevel","Level 3"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 3",(()=>(P.seq.setup(),P.foes.setup({limit:2,speed:120,countdown:30}),P.set("tempo",120),P.seq.loadSong("lead",$.cmajor,{wave:"square",attack:.1,decay:.1,sustain:.9,release:.25}),P.set("nextLevel","Level 4"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 4",(()=>(P.seq.setup(),P.foes.setup({limit:2,speed:130,countdown:40}),P.set("tempo",120),P.seq.loadSong("lead",$.fur_elise),P.set("nextLevel","Level 5"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 5",(()=>(P.seq.setup(),P.foes.setup({limit:2,speed:140,countdown:50}),P.set("tempo",120),P.seq.loadSong("lead",$.chords2),P.seq.loadSong("kick",$.kick4s),P.set("nextLevel","Level 6"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 6",(()=>(P.seq.setup(),P.foes.setup({limit:3,speed:140,countdown:60}),P.set("tempo",120),P.seq.loadSong("lead",$.we_will_rock_bass),P.seq.loadSong("kick",$.we_will_rock_kick),P.seq.loadSong("snare",$.we_will_rock_snare),P.set("nextLevel","Level 7"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 7",(()=>(P.seq.setup(),P.foes.setup({limit:3,speed:150,countdown:70}),P.set("tempo",120),P.seq.loadSong("bass",$.seven_nation),P.seq.loadSong("kick",$.kick4s),P.set("nextLevel","Level 8"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 8",(()=>(P.seq.setup(),P.foes.setup({limit:4,speed:150,countdown:80}),P.set("tempo",120),P.seq.loadSong("lead",$.mario,{wave:"square",attack:.1,decay:.1,sustain:.9,release:.25}),P.set("nextLevel","Level 9"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 9",(()=>(P.seq.setup(),P.foes.setup({limit:4,speed:150,countdown:90}),P.set("tempo",80),P.seq.loadSong("lead",$.karma_lead,{wave:"sine",release:.9,decay:.5,gain:.5}),P.seq.loadSong("bass",$.karma_acc,{wave:"sine",release:.8,decay:.4,gain:.5}),P.set("nextLevel","Level 10"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 10",(()=>(P.seq.setup(),P.foes.setup({limit:4,speed:160,countdown:100}),P.set("tempo",160),P.seq.loadSong("bass",$.lev10_bass,{wave:"sine",attack:.1,decay:.75,sustain:.9,release:.95,gain:.5}),P.seq.loadSong("hat",$.lev10_hat,{gain:1}),P.set("nextLevel","Level 11"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 11",(()=>(P.seq.setup(),P.foes.setup({limit:5,speed:160,countdown:110}),P.set("tempo",120),P.seq.loadSong("bass",$.lev11_bass),P.seq.loadSong("kick",$.lev11_kick),P.set("nextLevel","Level 12"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 12",(()=>(P.seq.setup(),P.foes.setup({limit:5,speed:160,countdown:120}),P.set("tempo",120),P.seq.loadSong("lead",$.lev12_lead,{}),P.seq.loadSong("snare",$.lev12_snare,{}),P.set("nextLevel","Level 13"),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.create("Level 13",(()=>(P.seq.setup(),P.foes.setup({limit:5,speed:600,countdown:130}),P.set("tempo",160),P.seq.loadSong("bass",$.lev13_bass),P.seq.loadSong("kick",$.lev13_kick),P.seq.loadSong("snare",$.lev13_snare),P.seq.loadSong("hat",$.lev13_hat),()=>{P.seq.teardown(),P.foes.teardown()}))),P.scene.set("mainmenu"),P.start(),P.pause()}();
</script></body></html>