<!DOCTYPE html><meta charset="utf-8"><title>Mewnbeam&rsquo;s Adventure</title><style>html{font-size:min(.075vw,.1vh);display:flex;align-items:center;justify-content:center;background:#000;image-rendering:pixelated;overflow:hidden}body{background:#150e1d;font-family:"Iowan Old Style","Palatino Linotype",P052,serif;width:1333rem;height:1000rem;overflow:hidden;font-size:21rem;margin:0;position:relative;color:#ddd;user-select:none;overflow:hidden;text-align:center}i{color:#8bd}b,.t{color:#f0a}h1{font-size:60rem;text-align:center}*{box-sizing:border-box}.as,.b,.y,.ag{position:absolute;inset:0}.y{z-index:0;top:auto;transition:inset .75s ease-in-out}.ag{z-index:1;inset:0 0 auto 0;display:flex;justify-content:space-between;height:170rem;padding:0 65rem}.ag .al{width:auto}.as{pointer-events:none;z-index:9}.b{z-index:50;background:#0004;backdrop-filter:blur(20rem)}.s{background:#0008;z-index:80}.s .av{justify-content:flex-start}.s .ae:first-child{position:absolute;inset:100rem 100rem auto auto;z-index:60}.af{padding:115rem 80rem;max-height:100%;overflow:auto;display:flex;flex-direction:column;align-items:stretch}.m{padding:50rem;background:#150e1d;border:5rem solid #301b45;position:absolute;inset:120rem 200rem}.av{margin-top:50rem;flex-grow:1;display:flex;flex-direction:row;flex-wrap:wrap;gap:50rem;justify-content:center;align-content:center;align-items:center}.f .al{flex:0 0 250rem;width:250rem;align-self:center}.at{display:flex;gap:100rem;align-items:center;justify-content:space-between;text-align:left}.k{display:flex;flex-direction:row-reverse;padding-right:80rem}.k>div{margin-right:-80rem}.x,.ad{display:flex;flex-direction:column;position:absolute;margin:0;transition:inset .4s ease-in-out,transform .4s ease-in-out,opacity .4s linear,margin .15s linear}.x.v{outline:4rem solid #fff;transition:transform .4s ease-out,opacity .4s linear}.al{width:100%;aspect-ratio:4/3;display:inline-block}.am{aspect-ratio:4/6}.x{width:190rem;height:285rem;border:5rem solid #3338;background-origin:border-box !important;backdrop-filter:blur(10rem)}.x:hover:not(.a),.x.v{transform:rotate(0deg) !important;z-index:24 !important}.x.aj{filter:grayscale(50%);border-color:#666}.x .ab{position:absolute;top:-2rem;left:-2rem;z-index:1}.x .ab+.ab{top:38rem}.o,.u:before{background:repeating-linear-gradient(45deg, #113 0 10rem, #226 10rem 20rem)}.u:before{content:"";position:absolute;inset:0;z-index:2}.o,.u{border:5rem solid #337}.u .c,.u .ak{display:none}.ac{padding:5rem;color:#fff;background:linear-gradient(45deg, #261e2e 5%, #0000 5%),linear-gradient(315deg, #261e2e 5%, #0000 5%)}.ar{display:flex;flex-direction:column;gap:2rem;padding:0 5rem;flex:1 1 auto;font-size:18rem;justify-content:center;text-wrap:balance;background:#261e2e;min-height:0}.o{position:absolute;width:80rem;height:120rem;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:40rem;cursor:pointer;z-index:7}.o:hover{outline:4rem solid #8bd}.l{font-size:15rem}.c,.ak{width:35rem;height:35rem;font-weight:bold;padding:2rem;position:relative}.c:before,.ak:before{content:"";position:absolute;z-index:-1}.c:before{inset:0;background:#a08;outline:2rem solid #804;transform:rotate(45deg)}.ak:before{inset:-3rem;background:#08a;outline:2rem solid #048;border-radius:50%}.ad{align-items:center;gap:5rem;z-index:5;padding:10rem;border-radius:40rem}.w{outline:5rem dotted #fff4;cursor:pointer}.w:hover{outline:5rem solid #fff8}.ad .al{border-radius:.1px;outline:20rem solid #150e1d}.p{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start;max-width:91rem;width:max-content}.p.n{max-width:181rem}.h,.aq,.q,.z,.an,.ai{width:18rem;height:18rem;clip-path:polygon(50% -25%, 125% 50%, 50% 125%, -25% 50%)}.h{background:#ef2641}.aq{background:linear-gradient(#ef2641 30%, #4a0912 30% 70%, #ef2641 70%)}.ao .aq{background:#1c0}.z{background:#ddd}.q{background:#52304f;transition:background .4s}.ai{background:#4c8ac0}.an{background:linear-gradient(90deg, #4c8ac0 30%, #fff 30% 70%, #4c8ac0 70%)}.aa{font-size:26rem}.ao .aa{display:none}.ae{padding:7rem 14rem;background:#113;border:5rem solid #449}.ae:not(.g),.d .x:not(.aj),.i{outline:4rem solid #8bd;cursor:pointer}.ae:not(.g):hover,.d .x:not(.aj):hover,.i:hover{outline:4rem solid #e8f}.r{position:absolute;right:20rem;bottom:310rem;z-index:8}.ap{position:absolute;left:27rem;bottom:310rem;z-index:7}.j,.ah{margin-top:15rem;display:flex;flex-direction:row;height:35rem}.j>div:before,.ah>div:before{box-shadow:0 0 0 6rem #fffa}.aw{display:flex;flex-direction:column-reverse;align-items:center;position:absolute;inset:40rem 40rem auto auto;font-family:monospace;white-space:pre;font-size:15rem;color:#aaa;z-index:55;gap:1rem}.au{opacity:.5}.e{border:1px solid #da7d14;border-radius:10rem;width:20rem;color:#da7d14}
</style><script>let n=(e,...t)=>s(e,"",{},...t),o=(e="",...t)=>r(e,{},...t),r=(e="",t={},...a)=>s("div",e,t,...a),s=(e="div",t="",a={},...i)=>{for(var s in(e=document.createElement(e)).className=t,a)e.style.setProperty(s,a[s]);return Object.assign(e.style,a),e.append(...i.flat().filter(e=>e)),e},j=(e,t)=>{a(e,0),e.append(...t)},l=t=>{for(let e=t.length-1;0<e;e--){var a=Math.floor(Math.random()*(e+1));[t[e],t[a]]=[t[a],t[e]]}return t},c=t=>new Promise(e=>setTimeout(e,1e3*t)),a=(e,t,a)=>{for(var i=e.children;i.length>t;)e.lastChild.remove();for(;i.length<t;)e.appendChild(a())};var z=["-",()=>0],W=["¬†",()=>0],t=t=>["üó°Ô∏è "+t,e=>{d(e),u(F,t)}],G=t=>["üß™ "+t,e=>{d(e),Z(F,t)}],K=t=>["üõ°Ô∏è "+t,e=>{d(e,-.5),e.t+=t,e.i()}],N=()=>["‚óÑüíñ 2‚ñ∫",(e,t)=>{d(e,-.5),t.map(e=>J(e,2))}],i=(e,a,i)=>["+"+e,async e=>{var t=T.o.indexOf(e);i&&T.o.length<6&&(await d(e,0,1),f(i),await Ne([i],t+1)),a&&T.o.length<6&&(await d(e,0,0),f(a),await Ne([a],t))}];function h(e,...t){e.l||(e.l=e.h(),document.body.appendChild(e.l)),e.i(...t)}async function O(e){e.l.style.opacity=0,e.l.style.pointerEvents="none",await c(.5)}class e{l=null;h(){return o()}i(){}u(){this.l?.remove(),this.l=null}}let w=(e,t,a)=>()=>r("al "+(a&&"am"),{background:`url(c.webp) ${.1+e%5*24.95}% ${.1+(a?11.088:9.98)*~~(e/5)}%/506% `+t});class L extends e{o;h(){return this.o=o("y",w(54,"#301b45")(),w(54,"#301b45")()),o("",this.o,o("ag",w(42,"#0000")(),w(43,"#0000")()))}}class E extends e{m=[0,...l([0,3,2]),0,...l([0,0,0,3,2]).slice(0,4),0,...l([0,3,2]).slice(0,2),0,l([0,3])[0],1];o=-1;h(){return o("aw")}i(){j(this.l,this.m.flatMap((e,t)=>14==t?o(t==this.o?"e":"","üëë"):[o(t==this.o?"e":0==t||t<=this.o?"t":"","#R?z"[e]),o("au "+(t<this.o&&"t"),"‚Üë")]))}}async function d(e,t=1,a){(e=e.l)&&(e.style.marginBottom=-20*t+"rem",e.style.marginLeft=20*a+"rem",await c(.15),e.style.marginBottom="",e.style.marginLeft="",await c(.15))}function u(e,t){var a;e.m?(e.m--,e.i()):(e.p??(e.p=e.C),a=0<t?Math.min(e.t,t):0,e.t-=a,e.C-=t-a,t-a&&0<e.C&&e.g(),e.i(),clearTimeout(e.v),e.v=setTimeout(()=>{e.p=void 0,e.i()},1e3))}function Z(e,t){e.m?e.m--:e.k+=t,e.i()}function J(e,t){e.C=Math.min(e.o,e.C+t),e.p=void 0,e.i()}function f(e){e.B=W,e.i()}function Y(e){return e.M??(e.M=function*(e){for(;;)yield*e.$()}(e)),e.B??(e.B=e.M.next().value),e.B}class m extends e{A="?";o;size;R=w(0,"#587");P=!1;C;t=0;k=0;m=0;D;I;S;h(){return this.C??(this.C=this.o),this.T=o("p "+(170<=this.size&&"n")),this.I=o("p "+(170<=this.size&&"n")),this.D=o("p "+(170<=this.size&&"n")),this.S=o("aa"),this.H=o("",this.A),r("ad",{width:this.size+"rem"},this.T,this.I,this.D,this.R(),this.H,this.S)}g(){}async F(){this.m=this.t=0,this.i(),0<this.k&&(u(this,this.k--),this.m=0,this.i(),await c(.3))}i(){if(this.l){this.S.innerText=Y(this)[0],a(this.D,this.o,()=>o());for(let e=0;e<this.o;e++)this.D.children[e].className=e<this.C-this.k?"h":e<this.C?"aq":e<this.p?"z":"q";a(this.I,this.t,()=>o("ai")),j(this.T,[...Array(this.m).keys()].map(()=>o("an")))}}*$(){yield z}M;B}function _(e,t,a){var i=new e.constructor;return e.j&&x(i),i.l=i.h(),i.i(!0),i.l.style.position="relative",t?i.l.classList.add("i"):i.l.style.outline="none",i.l.style.transform=`rotate(${4*Math.cbrt(Math.random()-.5)}deg)`,a&&i.l.classList.add("u"),i.l}function U(e,t){e.l.style.zIndex=26+t,e.l.style.transform="rotate(0deg)",e.l.style.left=536+80*Math.random()+"rem",e.l.style.bottom=280+80*Math.random()+"rem",e.l.classList.remove("v"),e.l.classList.remove("u"),e.l.classList.add("a")}class y extends e{W="?";R=w(0,"#f0a");G=0;K="#f00";N=0;O=0;j;H;h(){return r("x",{background:this.K},(0<this.N||0==this.O)&&o("c ab",""+this.N),0<this.O&&o("ak ab",""+this.O),this.R(),o("ac",this.W),this.H=o("ar"))}i(e){this.l.classList.toggle("aj",!(e??this.L())),j(this.H,this.Z(e).map(e=>o("",e)))}J=[150*Math.random()-75+1433,150*Math.random()-75-100];Y(){return!this.m&&(null!=this.o||null!=this._||null!=this.S||null!=this.$)}L(){return F.U>=this.O&&F._>=this.N}A;m=0;V;X;q;I=1;o;_;$;S;p;ee;M;D;U;k;Z(e){var t=[""," to all"," to the left enemy"][this.m];return[this.V&&"Cantrip",this.A,null!=this.o&&"Attack "+(this.o+(e?0:F.ee))+t,null!=this._&&"Splash Attack "+(this._+(e?0:F.ee)),null!=this.$&&"Bleed "+this.$+t,this.S&&"Stun"+t,null!=this.p&&`Gain ${this.p} Actions`,null!=this.ee&&`Gain ${this.ee} Mana`,null!=this.M&&"Heal "+this.M,null!=this.g&&"Damage self "+this.g,null!=this.D&&`Attacks do +${this.D} damage this fight`,null!=this.U&&"Draw "+this.U,this.k&&`Dodge ${this.k} this turn`,1!=this.I&&this.I+" Times",this.q&&"Pass",2==this.q&&"Retain Your Hand",this.X&&"Exhaust"].filter(e=>e)}async play(e){2===this.m&&(e=e.slice(0,1));for(var t of[...Array(this.I).keys()]){0<t&&await c(.2);for(let i of e)null!=this.o&&u(i,this.o+F.ee),null!=this._&&(await c(.2),T.o.map((e,t,a)=>{a[t-1]!=i&&a[t+1]!=i||u(e,this._+F.ee)})),null!=this.$&&Z(i,this.$),null!=this.S&&f(i);null!=this.p&&X(-this.p,0),null!=this.ee&&X(0,-this.ee),this.M&&J(F,this.M),this.g&&u(F,this.g),this.D&&(F.ee+=this.D,F.i(),R(H)),this.U&&await Te(this.U),this.k&&(F.m+=this.k,F.i())}}}class p extends y{G=0;K="#554396"}class C extends y{G=1;K="#8915a0"}class b extends y{G=2;K="#b66b17"}class g extends y{G=3;K="#923303"}class v extends y{G=4;K="linear-gradient(90deg, #b66b17, #923303, #8915a0)"}class V extends y{G=6;K="#289876"}let x=e=>(e.K="linear-gradient(135deg, #70a2a588 40%, #a7c4c6bb, #70a2a588 60%)",e.j=1,e.X=1,e.N=0,e.O=0,e);function X(e,t){var a=F;a._-=e,a.U-=t,a.i()}function q(){var e=F;F.U=1,F._=2,F.ee=0,F.k=0,F.m=0,e.i()}class Q extends m{A="Mewnbeam";size=230;o=40;R=w(38,"#000");_;U;ee;i(){super.i(),this.l.style.bottom="290rem",this.l.style.left="150rem",this.l.classList.add("ao"),this.H.innerText=""+this.A+(this.ee?` (+${this.ee})`:""),h(this.Z,this._,this.U)}u(){this.Z.u(),super.u()}Z=new class extends e{h(){return o("ap",o("j"),o("ah"))}i(e,t){a(this.l.querySelector(".j"),e,()=>o("c")),a(this.l.querySelector(".ah"),t,()=>o("ak"))}}}var k=class extends m{A="Rat";o=5;size=130;R=w(46,"#e11");*$(){yield*l([K(2),t(1),t(2)])}},ee=class extends m{A="Rat Wizard";o=3;size=130;R=w(41,"#07f");*$(){yield z,yield t(4)}},B=class extends m{A="Poison Rat";o=3;size=130;R=w(37,"#1e1");*$(){yield G(2)}},te=class extends m{A="Weasel üõë2";o=15;size=175;R=w(50,"#c76d24");*$(){yield*l([t(2),t(3),t(5)])}g(){this.m=2}},ae=class extends m{A="Rabbit";o=8;size=130;R=w(51,"#f20");constructor(e){super(),this.ee=!e}*$(){this.ee&&(yield i("üêá",0,new ae(!0))),this.ee=!0,yield t(2),yield t(1),Math.random()<.5&&(yield t(2))}},ie=class extends m{A="Beaver";o=17;size=175;R=w(52,"#a2512f");*$(){yield i("ü™µü™µ",new se,new se),yield t(4)}},se=class extends m{A="Dam üõ°Ô∏è";o=1;size=130;R=w(29,"#9d411a");P=!0;*$(){yield W}},M=class extends m{A="Rat Guard üõ°Ô∏è";o=8;size=175;R=w(47,"#e11");P=!0;*$(){yield*l([t(2),["‚óÑüõ°Ô∏è 2‚ñ∫",(e,t)=>{d(e,-.5),t.map(e=>{e.t+=2,e.i()})}],K(4)])}},$=class extends m{A="Mouse";o=5;size=130;R=w(45,"#e11");*$(){yield*l([N(),t(2)])}},ne=class extends m{A="Snake üêç";o=17;size=175;R=w(40,"#348100");m=1;async F(){await super.F(),this.m+=1,this.i()}*$(){for(let e=0;;e++)yield G(3),0==e&&(yield i("üêÅ",0,new $)),yield t(l([3,4])[0])}},re=class extends m{A="Rat King";o=30;size=175;R=w(48,"#e11",1);*$(){yield i("üêÄüêÄ",new k,new k);for(let e=0;;e++)yield t(5+2*e),yield N(),yield i("üêÄ",new k,0)}};let A=[class extends p{W="Claw";R=w(1,"#d0f");N=1;o=1},class extends p{W="Scratch";N=1;R=w(11,"#f00");$=2},class extends p{W="Swipe";R=w(2,"#f50");N=1;m=1;o=1;X=!0},class extends C{W="Stomp";R=w(20,"#e8961b");O=2;S=1},class extends V{W="Curse: Scream";R=w(26,"#289876");V=1},class extends g{W="Rabbit‚Äôs Foot";R=w(21,"#f02");O=1;A="Discard your hand";U=4;async play(e){await He(),await super.play(e)}},class extends v{W="Weasel Pelt";R=w(50,"#c76d24");O=1;k=5;X=1},class extends g{W="Dam";R=w(29,"#9d411a");O=1;k=1},class extends C{W="Tail Flick";R=w(35,"#0d915a");O=1;m=2;S=1},class extends b{W="Pounce";R=w(36,"#a65504");N=1;m=2;o=5},class extends g{W="Feather Toy on a String";R=w(0,"#a2f");U=1;ee=1},class extends p{W="Fireball";R=w(12,"#f61");O=2;o=4;_=2},class extends v{W="Spellbook";R=w(18,"#7d2300");O=1;U=7},class extends v{W="Ratsbane";R=w(32,"#53890b");N=2;o=9;X=1},class extends g{W="Toadstool";R=w(31,"#d42916");N=1;$=4;X=1},class extends g{W="Spellbookmark";R=w(19,"#1e44ae");V=1;o=3;m=2},class extends p{W="Sneak Attack";R=w(33,"#301b45");N=1;O=1;o=3;_=2;m=2},class extends C{W="Paw";R=w(4,"#ff32f1");o=0;I=2},class extends p{W="Maul";R=w(5,"#f80");N=2;o=2;$=3},class extends C{W="Boom Bop Bam";R=w(15,"#709a2b");N=2;o=1;I=3},class extends C{W="Spirit Scratch";R=w(2,"#ccf");m=1;V=1;$=1},class extends p{W="Meow";R=w(10,"#7fae10");N=0;U=2},class extends C{W="Bite";R=w(6,"#f00");N=1;o=1;M=1;X=1},class extends b{W="Tongue Bath";R=w(16,"#4d1c92");N=1;M=4;X=!0},class extends C{W="Boba Eyes";R=w(9,"#406");O=2;D=2},class extends C{W="Boop";R=w(22,"#71b6cb");O=1;m=1;A="Reverse enemy order";play=()=>T.o.reverse();X=1},class extends p{W="Swat";R=w(28,"#a18600");N=1;o=1;ee=1;A="Push to the right";play([e]){var t=T.o.indexOf(e);return T.o.splice(t,1),T.o.splice(t+1,0,e),super.play([e])}},class extends p{W="Prepare Spell";R=w(23,"#ca8f5f");N=1;A="Add a ghostly Fireball to your draw pile";play=()=>Fe(0,x(new me))},class extends v{W="Knapsack";R=w(24,"#923303");O=1;A="Make a random Trinket";play=()=>Fe(1,Xe()[0])},class extends b{W="Dark Bargain";R=w(25,"#f20");N=1;O=1;o=0;i(e){super.i(e)}async play(e){var t;await Fe(0,new we),this.o=2*(t=H).o.concat(t.pending,t.A,t.m).filter(e=>6==e.G).length,super.play(e)}Z=()=>["Make a Curse","Attack 2 per Curse in play"]},class extends b{W="Cat Opera";R=w(34,"#08f");O=4;m=1;o=5},class extends C{W="Blood Ritual";R=w(27,"#f02");N=1;O=1;g=1;D=3},class extends b{W="Convene with Spirits";R=w(7,"#0f7");O=1;A="Draw 2 cards of your choice";L(){return super.L()&&H.o.length}async play(){for(let e=0;e<2;e++){var t=H.o;if(t.length<1)break;-1==(t=await S(t,0,5,"Draw "+(2-e)))?e--:(H.A.push(...H.o.splice(t,1)),R(H))}l(H.o)}},class extends p{W="Channel";R=w(8,"#3bf");O=0;ee=2},class extends C{W="See Ghost";O=2;R=w(3,"#005f39");A="Make a ghostly copy of a discarded card";L(){return super.L()&&H.m.length}async play(){var e=H.m,t=await S(e,0,5);if(-1==t)return this.play();await Fe(1,x(new e[t].constructor))}},class extends v{W="Vampire Bat Extract";O=1;R=w(30,"#f20");X=1;A="Make 3 ghostly Bites";async play(){await Fe(1,x(new xe),x(new xe),x(new xe))}},class extends C{W="Zoomies";R=w(13,"#496fcf");O=1;k=1;p=2},class extends b{W="Witching Hour";R=w(14,"#353cfd");p=2;ee=2;X=1},class extends g{W="Yarn Ball";R=w(17,"#8453ff");O=0;ee=1;q=2},class extends V{W="Curse: Rat Pack";R=w(46,"#00ff86");V=1;A="Summon a Rat";X=1;async play(){var e;T.o.length<6&&(f(e=new k),await Ne([e],6))}}],oe=A[0],le=A[1],ce=A[2],he=A[3],we=A[4],de=A[5],ue=A[6],fe=A[7],me=A[11],ye=A[12],pe=A[13],Ce=A[14],be=A[15],ge=A[17],ve=A[20],xe=A[22],ke=A[28],Be=A[29],Me=A[32],$e=A[34],Ae=A[35],Re=A[36],Pe=A[39],De=e=>!!localStorage["mewnbeam_lZrc_"+e.W],Ie=e=>localStorage["mewnbeam_lZrc_"+e.W]=1,Se=()=>[new oe,new oe,new oe,new le,new ce,new he];function R(o){h(o.h),h(o.D,o.o.length),h(o.p,o.m.length),h(o.k,o.$.length),o.k.l.style.zIndex=60;let[e,t,l,c]=o.U;o.o.map(e=>{h(e),e.l.style.zIndex=25,e.l.style.transform="rotate(0deg)",e.l.style.left="-250rem",e.l.style.bottom="-100rem",e.l.classList.remove("v"),e.l.classList.add("u"),e.l.classList.add("a")}),o.pending.map(e=>{h(e)}),o.A.map((e,t)=>{h(e);var a,i,s,n,r=e===o.active;[t,r,e,a,i,s]=[e,t,o.A.length,r,...r&&!e.Y()?[l||0,c||0]:[0,0]],n=1==e?0:r/(e-1)*2-1,t.l.style.zIndex=a?25:10+r,t.l.style.transform=`rotate(${5*n||.8}deg)`,t.l.style.left=`calc(${e<=5?671+200*(r-e/2):171+800/(e-1)*r}rem + ${i}px)`,t.l.style.bottom=`calc(${(a?55:15)-20*n**2}rem - ${s}px)`,t.l.classList.toggle("v",a),t.l.classList.remove("u"),t.l.classList.remove("a")}),o.m.map(e=>{h(e);var[t,a]=e.J;e.l.style.zIndex=25,e.l.style.transform="rotate(0deg)",e.l.style.left=t+"rem",e.l.style.bottom=a+"rem",e.l.classList.remove("v"),e.l.classList.remove("u"),e.l.classList.remove("a")}),o.ee.map(e=>{h(e),O(e)}),o.active?.Y()?h(o._,o.active?.l,e,t):o._.u()}async function Te(t){var a=H;for(let e=0;e<t&&(0<a.o.length||0<a.m.length);e++)await(async e=>{if(0==e.o.length){if(0==e.m.length)return;e.o=[...e.o,...e.m],e.m=[],l(e.o),R(e),await c(.4)}var t=e.o.pop();(t.V?e.pending:e.A.length<7?e.A:e.m).unshift(t),R(e),t.V&&(U(t,e.pending.length),await c(.4),await t.play(T.o),Oe()),await c(.4)})(a)}async function He(){var e=H;e.m.push(...e.A),e.A=[],R(e),await c(.4)}async function Fe(e,...t){var a,i=H;t.map(Ie);for(a of t)h(a),U(a,-1);for(await c(.2),[i.o,i.A,i.m][e].push(...t);7<i.A.length;)i.m.push(i.A.pop());l(i.o),R(i),await c(.2)}async function je(){var i=H;let s=[];document.body.classList.add("d"),R(i);var[e,t]=await new Promise(a=>{for(let t of i.A)if(t.L()){let e=e=>a([t,e]);t.l.addEventListener("mousedown",e),s.push(()=>t.l.removeEventListener("mousedown",e))}let e=()=>a(["pass"]),t=(i.h.l.classList.remove("g"),i.h.l.addEventListener("click",e),e=>{" "==e.key&&a(["pass"])});addEventListener("keydown",t),s.push(()=>{i.h.l.classList.add("g"),i.h.l.removeEventListener("click",e),removeEventListener("keydown",t)})});return document.body.classList.remove("d"),s.map(e=>e()),"pass"!=e&&(i.active=e),R(i),[e,t]}function ze(t){var e=H;e.pending.push(t),e.A=e.A.filter(e=>e!=t),R(e)}function We(){var e=H;e.m.push(...e.pending.filter(e=>!e.X)),e.ee.push(...e.pending.filter(e=>e.X)),e.pending=[],R(e)}function Ge(){var e=H;e.U=[],e.active=null,R(e)}Se().map(Ie);class Ke extends e{constructor(e,t,a){super(),this.m=t,this.A=a,this.$=e}o;h(){var e=r("o",{inset:this.m},this.o=o(),o("l",this.$));return e.addEventListener("click",this.A),e}i(e){this.o.innerText=e}}async function Ne(e,t=100){var a=T;a.o.splice(t,0,...e),Le(a,e),await c(.05),Le(a),await c(.4)}async function Oe(){var e=T,t=e.o.filter(e=>e.C<=0);e.o=e.o.filter(e=>0<e.C),t.map(async e=>{await O(e),e.u()}),await c(.4),Le(e)}function Le(e,t=[]){let a=666-(e.o.map(e=>e.size).reduce((e,t)=>e+t,0)+60*(e.o.length-1))/2;for(var i of e.o)h(i),i.l.style.bottom=t.includes(i)?"1100rem":i.P?"575rem":"600rem",i.l.style.left=a+"rem",a+=i.size+60}function Ee(){let e=T,t=e.o.some(e=>e.P);return e.o.filter(e=>e.P==t)}function Ze(){return Ee().map(e=>[e.l,e])}function Je(){var e=T;e.o.map(e=>e.u()),e.o=[]}function Ye(){Ee().map(e=>e.l?.classList.add("w"))}function _e(){T.o.map(e=>e.l?.classList.remove("w"))}function P(s,t,n,...r){return new Promise(i=>{h(new class extends e{h(){let a=e=>{"Escape"==e.key&&(this.u(),removeEventListener("keydown",a),i(0))};!s||4&s||addEventListener("keydown",a);var e=r.map((e,t)=>0==t&&4&s?null:o((!s||0==t)&&"ae",e));return e.map((e,t)=>{0!=t&&2&s||e?.addEventListener("click",()=>{removeEventListener("keydown",a),this.u(),i(t)})}),o(s?"b s":"b",o(s?"af":"af m",o(n?"f at":"f",o("",t),n),o("av",e)))}})})}function D(e,...a){let i=e.flatMap((e,t)=>[...e.split(/( )/g).map(e=>s("span","",{},e)),s("span","",{},a[t])]);return i.map(async(e,t)=>{e.style.opacity=0,await c(.8*t/i.length),e.style.opacity=1}),n("span",i)}let Ue=w(44,"#f40",1);async function I(e,t,a){(e=await P(0,e,t,...(a=a.map(e=>[e].flat())).map(e=>o("k",e.map(e=>_(e)))),"Hiisss! (Pass)"))<a.length&&([...t]=[...a[e]],(a=H).$.push(...t),t.map(Ie),R(a))}async function S(e,t,a,i,s){return t=t?e.toSorted((e,t)=>e.G-t.G||e.W.localeCompare(t.W)):e,-1+await P(a,o("",i,e.length?0:" (Empty)",s?` (${e.filter(De).length} / ${e.length})`:"")," ","Back",...t.map(e=>_(e,!(2&a),s&&!De(e))))}let Ve=[async()=>{var e=new ye;await I([n("h2","The Library"),D`Short-Tongue loves her spell book, but maybe that ribbon is more my jam...`],e.R(),[[new Pe,e],new be])},async()=>{var e=new ke;await I([n("h2","The Woods"),D`How\u2019d I end up outside? Oh well, the Rat King isn't going anywhere.${n("br")}${n("br")}At least I remembered my knapsack!`],e.R(),[e])},async()=>{var e=[new we,new we,new Be];await I([n("h2","The Sunroom"),D`Who summons a demon in the sunroom??${n("br")}${n("br")}This room is clearly made for napping.`],e[2].R(),[e])},async()=>{var e=[[new Re,new $e],[new Me]];await I([n("h2","A Haunting"),D`Is someone there? Do you have treats?`],e[1][0].R(),e)},async()=>{var e=[[new ge,new ge],[new ve]];await I([n("h2","Closed Door"),D`How ${n("b","dare")} she!`],(new we).R(),e)},async()=>{var e=[[new pe],[new Ae],[new Ce]];await I([n("h2","Brewery"),D`So many things to knock on the floor, so little time.`],e[0][0].R(),e)}];let Xe=()=>l(A.map(e=>new e).filter(e=>e instanceof g)).slice(0,3),T=new class{o=[]},H=new class{$=[];o=[];A=[];pending=[];m=[];ee=[];_=new class extends e{h(){return s("canvas","as")}i(e,t,a){var i,s,n,r;e&&({width:n,height:i,left:r,top:s}=document.body.getBoundingClientRect(),this.l.width=n,this.l.height=i,e=(n=e.getBoundingClientRect()).left-r+n.width/2,n=n.top-s+n.height/2,(r=this.l.getContext("2d")).clearRect(0,0,1e6,1e6),r.lineCap="round",r.setLineDash([30]),r.beginPath(),r.moveTo(t,a),r.lineTo(e,n-.05*i),r.strokeStyle="#ddd",r.lineWidth=28,r.stroke(),r.strokeStyle="#a0f",r.lineWidth=20,r.stroke())}};h=new class extends e{h(){return o("r g ae","End Turn")}};k=new Ke("Deck","20rem auto auto 20rem",()=>S(this.$,0,3,"Deck"));D=new Ke("Draw","auto auto 20rem 20rem",()=>S(this.o,1,3,"Draw Pile"));p=new Ke("Discard","auto 20rem 20rem auto",()=>S(this.m,0,3,"Discard Pile"));active=null;U=[]},F=new Q,qe,Qe=()=>{F?.u(),qe?.u(),Je(),F=new Q,qe=new E};async function et(){return Qe(),0==await P(0,[n("h1","Mewnbeam‚Äôs Adventure"),w(39,"#000")()],0,"Start","Library")?await(async()=>{Qe(),h(qe),h(F);var t=H,a=(t.$=Se(),R(t),t=l([...Ve]),await P(0,D`Mewnbeam, would you be a dear and ${n("i","take care of")} that ${n("b","Rat King")} while I\u2019m out?${n("br")}${n("br")}He should be easy to find, he\u2019s been causing lots of trouble up in the attic.${n("br")}${n("br")}Shouldn\u2019t be a big deal, just remember: ${n("i","Mana")} carries over, but ${n("b","actions")} reset every round.`,Ue(),"Mrow?"),await I(D`Hmph. Alright, I do need to be off to the potion shop, but I suppose I could give you some help before I go.${n("br")}${n("br")}What\u2019ll it be?`," ",Xe()),(()=>{let i=function*(){for(;;)yield*l([...Array(5).keys()].map(e=>(e+Math.random())/5))}(),s=l([new k,new B,new ee,new $]),n=!1,r=l([[new M,new $],[new M,new B],[new k,new B,new B,new ee],[new M,new ee,new M],[new $,new $,new $]]),o=l([[new k,new M,new ee,new $,new B],[new ae,new ae,new $],[new k,new te,new $],[new ne]]);return e=>{let t=[[],[],[]];A.map(e=>new e).map(e=>t[e.G]?.push(e)),t.map(l);var a=l([i.next().value>.1+e/40?0:1,i.next().value>.3+e/40?0:1,i.next().value>.15+e/20?1:2]).map(e=>t[e].pop());return e<4?[[new k,s.pop()],a]:e<7&&!n?(n=!0,l([[[new te],[a[0],new ue,a[1]]],[[new ae],[a[0],new de,a[1]]],[[new ie],[a[0],new fe,a[1]]]])[0]):e<10?[r.pop(),a]:e<14?[o.pop(),a]:[[new M,new re,new $,new M],[]]}})());for(let e=0;e<15;e++){var i=await(async()=>{var e=qe;return e.o++,e.i(),e.m[e.o]})();if(await(async()=>{var e=tt;e.o.style.bottom="-1000rem",await c(.75),e.u(),h(e)})(),3==i)await async function t(){if(0==await P(0,[r("",{height:"60rem"}),w(39,"#000")(),r("",{height:"60rem"}),"This looks like a cozy spot..."],0,`Cat Nap (Heal 7: ${F.C} ‚Üí ${Math.min(F.o,F.C+7)})`,"Lick (Remove a Card)"))J(F,7);else{let e=await S(H.$,!1,1,"Remove a Card...");if(-1==e)return t();var a=H;a.$.splice(e,1),R(a)}}();else if(2==i)await t.pop()();else{var[i,s]=a(e);if(await(async e=>{Je();var t=H,a=t;[...a.$,...a.o,...a.A,...a.pending,...a.m,...a.ee].map(e=>e.u()),t.o=l([...t.$]),t.A=[],t.pending=[],t.m=[],t.ee=[],R(t),q(),await c(.1),await Ne(e),await(async()=>{let e=!1;for(;await Te(4),We(),Oe(),0!=T.o.length;){for(;;){Le(T);var t=await async function e(){let[r,o]=await je();if("pass"==r)return"pass";R(H);let s=()=>{};let t=await new Promise(n=>{function i(s){if(r.Y()){for(var[e,t]of Ze())if(e.contains(s.target))return n([r,t])}else{let{top:e,left:t,right:a,height:i}=document.body.getBoundingClientRect();if(s.clientX>=t&&s.clientX<=a&&s.clientY<=e+.7*i)return n([r,null])}n(null)}async function e(e){let[t,a]=[e.clientX-o.clientX,e.clientY-o.clientY];t**2+a**2<625?(await c(.05),addEventListener("click",i)):i(e)}function t(e){"Escape"===e.key&&n(null)}function a(e){let[t,a]=[e.clientX-o.clientX,e.clientY-o.clientY],{top:i,left:s}=document.body.getBoundingClientRect();H.U=[e.clientX-s,e.clientY-i,t,a],R(H)}r.Y()&&Ye(),addEventListener("mouseup",e,{once:!0}),addEventListener("mousemove",a),addEventListener("keydown",t),s=()=>{removeEventListener("mouseup",e),removeEventListener("click",i),removeEventListener("mousemove",a),removeEventListener("keydown",t),_e()}});t&&ze(r);Ge();s();return null==t?e():t}();if("pass"==t)break;var[a,i]=t;if(X(a.N,a.O),await Promise.all([a.play(i?[i]:T.o),c(.2)]),We(),Oe(),0==T.o.length||F.C<=0)return;if(a.q){e=2==a.q;break}}e||await He(),e=!1;for(var s of T.o)if(await s.F(),Oe(),0==T.o.length)return;for(var n of t=[...T.o])if(!(n.C<=0)&&(await Y(n)[1](n,T.o),Oe(),await c(.1),f(n),await c(.5),F.C<=0))return;if(0==T.o.length)break;if(F.F(),F.C<=0)break;F.U+=1,F._=2,F.i(),T.o.map(e=>{e.B=void 0,e.i()})}})(),0<F.C&&q(),await He()})(i),F.C<=0)return void await P(0,[n("h2","Defeat..."),D`Mewnbeam, I'm back! How was killing th--${n("br")}${n("br")}Oh. Oh dear.${n("br")}${n("br")}Let\u2019s see, where\u2019d I put that revivify potion...`],Ue(),"Try Again");e<14&&await I(n("h2","Choose..."),0,s)}}await P(0,[n("h1","Victory!"),r("",{textAlign:"left"},D`Mewnbeam, I'm back! How was killing the ${n("b","Rat King")}? Tasty?${n("br")}${n("br")}I got you a treat for all your hard work!`)],Ue(),"Continue")})():await S(A.map(e=>new e),!0,3,"Library",!0),et()}let tt=new L;addEventListener("load",async function(){h(tt),await et()});</script>