<!doctype html><title>Mewnbeam's Adventure - js13kGames 2025</title><style>html{font-size:min(.075vw,.1vh);display:flex;align-items:center;justify-content:center;background:#000;image-rendering:pixelated;overflow:hidden}body{background:#150e1d;font-family:"Iowan Old Style","Palatino Linotype",P052,serif;width:1333rem;height:1000rem;overflow:hidden;font-size:21rem;margin:0;position:relative;color:#ddd;user-select:none;overflow:hidden;text-align:center}i{color:#8bd}.t,b{color:#f0a}h1{font-size:60rem;text-align:center}*{box-sizing:border-box}.ag,.as,.b,.y{position:absolute;inset:0}.y{z-index:0;top:auto;transition:inset .75s ease-in-out}.ag{z-index:1;inset:0 0 auto 0;display:flex;justify-content:space-between;height:170rem;padding:0 65rem}.ag .al{width:auto}.as{pointer-events:none;z-index:9}.b{z-index:50;background:#0004;backdrop-filter:blur(20rem)}.s{background:#0008;z-index:80}.s .av{justify-content:flex-start}.s .ae:first-child{position:absolute;inset:100rem 100rem auto auto;z-index:60}.af{padding:115rem 80rem;max-height:100%;overflow:auto;display:flex;flex-direction:column;align-items:stretch}.m{padding:50rem;background:#150e1d;border:5rem solid #301b45;position:absolute;inset:120rem 200rem}.av{margin-top:50rem;flex-grow:1;display:flex;flex-direction:row;flex-wrap:wrap;gap:50rem;justify-content:center;align-content:center;align-items:center}.f .al{flex:0 0 250rem;width:250rem;align-self:center}.at{display:flex;gap:100rem;align-items:center;justify-content:space-between;text-align:left}.k{display:flex;flex-direction:row-reverse;padding-right:80rem}.k>div{margin-right:-80rem}.ad,.x{display:flex;flex-direction:column;position:absolute;margin:0;transition:inset .4s ease-in-out,transform .4s ease-in-out,opacity .4s linear,margin .15s linear}.x.v{outline:4rem solid #fff;transition:transform .4s ease-out,opacity .4s linear}.al{width:100%;aspect-ratio:4/3;display:inline-block}.am{aspect-ratio:4/6}.x{width:190rem;height:285rem;border:5rem solid #3338;background-origin:border-box!important;backdrop-filter:blur(10rem)}.x.v,.x:hover:not(.a){transform:rotate(0)!important;z-index:24!important}.x.aj{filter:grayscale(50%);border-color:#666}.x .ab{position:absolute;top:-2rem;left:-2rem;z-index:1}.x .ab+.ab{top:38rem}.o,.u:before{background:repeating-linear-gradient(45deg,#113 0 10rem,#226 10rem 20rem)}.u:before{content:"";position:absolute;inset:0;z-index:2}.o,.u{border:5rem solid #337}.u .ak,.u .c{display:none}.ac{padding:5rem;color:#fff;background:linear-gradient(45deg,#261e2e 5%,#0000 5%),linear-gradient(315deg,#261e2e 5%,#0000 5%)}.ar{display:flex;flex-direction:column;gap:2rem;padding:0 5rem;flex:1 1 auto;font-size:18rem;justify-content:center;text-wrap:balance;background:#261e2e;min-height:0}.o{position:absolute;width:80rem;height:120rem;display:flex;flex-direction:column;align-items:center;justify-content:center;font-size:40rem;cursor:pointer;z-index:7}.o:hover{outline:4rem solid #8bd}.l{font-size:15rem}.ak,.c{width:35rem;height:35rem;font-weight:700;padding:2rem;position:relative}.ak:before,.c:before{content:"";position:absolute;z-index:-1}.c:before{inset:0;background:#a08;outline:2rem solid #804;transform:rotate(45deg)}.ak:before{inset:-3rem;background:#08a;outline:2rem solid #048;border-radius:50%}.ad{align-items:center;gap:5rem;z-index:5;padding:10rem;border-radius:40rem}.w{outline:5rem dotted #fff4;cursor:pointer}.w:hover{outline:5rem solid #fff8}.ad .al{border-radius:.1px;outline:20rem solid #150e1d}.p{display:flex;flex-direction:row;flex-wrap:wrap;justify-content:flex-start;max-width:91rem;width:max-content}.p.n{max-width:181rem}.ai,.an,.aq,.h,.q,.z{width:18rem;height:18rem;clip-path:polygon(50% -25%,125% 50%,50% 125%,-25% 50%)}.h{background:#ef2641}.aq{background:linear-gradient(#ef2641 30%,#4a0912 30% 70%,#ef2641 70%)}.ao .aq{background:#1c0}.z{background:#ddd}.q{background:#52304f;transition:background .4s}.ai{background:#4c8ac0}.an{background:linear-gradient(90deg,#4c8ac0 30%,#fff 30% 70%,#4c8ac0 70%)}.aa{font-size:26rem}.ao .aa{display:none}.ae{padding:7rem 14rem;background:#113;border:5rem solid #449}.ae:not(.g),.d .x:not(.aj),.i{outline:4rem solid #8bd;cursor:pointer}.ae:not(.g):hover,.d .x:not(.aj):hover,.i:hover{outline:4rem solid #e8f}.r{position:absolute;right:20rem;bottom:310rem;z-index:8}.ap{position:absolute;left:27rem;bottom:310rem;z-index:7}.ah,.j{margin-top:15rem;display:flex;flex-direction:row;height:35rem}.ah>div:before,.j>div:before{box-shadow:0 0 0 6rem #fffa}.aw{display:flex;flex-direction:column-reverse;align-items:center;position:absolute;inset:40rem 40rem auto auto;font-family:monospace;white-space:pre;font-size:15rem;color:#aaa;z-index:55;gap:1rem}.au{opacity:.5}.e{border:1px solid #da7d14;border-radius:10rem;width:20rem;color:#da7d14}</style><script>let e=(e,...t)=>s(e,"",{},...t),t=(e="",...t)=>a(e,{},...t),a=(e="",t={},...a)=>s("div",e,t,...a),s=(e="div",t="",a={},...s)=>{for(var n in(e=document.createElement(e)).className=t,a)e.style.setProperty(n,a[n]);return Object.assign(e.style,a),e.append(...s.flat().filter(e=>e)),e},n=(e,t)=>{o(e,0),e.append(...t)},i=e=>{for(let a=e.length-1;0<a;a--){var t=Math.floor(Math.random()*(a+1));[e[a],e[t]]=[e[t],e[a]]}return e},l=e=>new Promise(t=>setTimeout(t,1e3*e)),o=(e,t,a)=>{for(var s=e.children;s.length>t;)e.lastChild.remove();for(;s.length<t;)e.appendChild(a())};var r=["-",()=>0],h=[" ",()=>0],c=e=>["🗡️ "+e,t=>{b(t),x(Fe,e)}],d=e=>["🧪 "+e,t=>{b(t),k(Fe,e)}],u=e=>["🛡️ "+e,t=>{b(t,-.5),t.t+=e,t.i()}],m=()=>["◄💖 2►",(e,t)=>{b(e,-.5),t.map(e=>R(e,2))}],w=(e,t,a)=>["+"+e,async e=>{var s=Ye.o.indexOf(e);a&&Ye.o.length<6&&(await b(e,0,1),$(a),await Ee([a],s+1)),t&&Ye.o.length<6&&(await b(e,0,0),$(t),await Ee([t],s))}];function p(e,...t){e.l||(e.l=e.h(),document.body.appendChild(e.l)),e.i(...t)}async function f(e){e.l.style.opacity=0,e.l.style.pointerEvents="none",await l(.5)}class y{l=null;h(){return t()}i(){}u(){this.l?.remove(),this.l=null}}let v=(e,t,s)=>()=>a("al "+(s&&"am"),{background:`url(c.webp) ${.1+e%5*24.95}% ${.1+(s?11.088:9.98)*~~(e/5)}%/506% `+t});class g extends y{m=[0,...i([0,3,2]),0,...i([0,0,0,3,2]).slice(0,4),0,...i([0,3,2]).slice(0,2),0,i([0,3])[0],1];o=-1;h(){return t("aw")}i(){n(this.l,this.m.flatMap((e,a)=>14==a?t(a==this.o?"e":"","👑"):[t(a==this.o?"e":0==a||a<=this.o?"t":"","#R?z"[e]),t("au "+(a<this.o&&"t"),"↑")]))}}async function b(e,t=1,a){(e=e.l)&&(e.style.marginBottom=-20*t+"rem",e.style.marginLeft=20*a+"rem",await l(.15),e.style.marginBottom="",e.style.marginLeft="",await l(.15))}function x(e,t){var a;e.m?(e.m--,e.i()):(e.p??(e.p=e.C),a=0<t?Math.min(e.t,t):0,e.t-=a,e.C-=t-a,t-a&&0<e.C&&e.g(),e.i(),clearTimeout(e.v),e.v=setTimeout(()=>{e.p=void 0,e.i()},1e3))}function k(e,t){e.m?e.m--:e.k+=t,e.i()}function R(e,t){e.C=Math.min(e.o,e.C+t),e.p=void 0,e.i()}function $(e){e.B=h,e.i()}function A(e){return e.M??(e.M=function*(e){for(;;)yield*e.$()}(e)),e.B??(e.B=e.M.next().value),e.B}class L extends y{A="?";o;size;R=v(0,"#587");P=!1;C;t=0;k=0;m=0;D;I;S;h(){return this.C??(this.C=this.o),this.T=t("p "+(170<=this.size&&"n")),this.I=t("p "+(170<=this.size&&"n")),this.D=t("p "+(170<=this.size&&"n")),this.S=t("aa"),this.H=t("",this.A),a("ad",{width:this.size+"rem"},this.T,this.I,this.D,this.R(),this.H,this.S)}g(){}async F(){this.m=this.t=0,this.i(),0<this.k&&(x(this,this.k--),this.m=0,this.i(),await l(.3))}i(){if(this.l){this.S.innerText=A(this)[0],o(this.D,this.o,()=>t());for(let e=0;e<this.o;e++)this.D.children[e].className=e<this.C-this.k?"h":e<this.C?"aq":e<this.p?"z":"q";o(this.I,this.t,()=>t("ai")),n(this.T,[...Array(this.m).keys()].map(()=>t("an")))}}*$(){yield r}M;B}function W(e,t,a){var s=new e.constructor;return e.j&&I(s),s.l=s.h(),s.i(!0),s.l.style.position="relative",t?s.l.classList.add("i"):s.l.style.outline="none",s.l.style.transform=`rotate(${4*Math.cbrt(Math.random()-.5)}deg)`,a&&s.l.classList.add("u"),s.l}function C(e,t){e.l.style.zIndex=26+t,e.l.style.transform="rotate(0deg)",e.l.style.left=536+80*Math.random()+"rem",e.l.style.bottom=280+80*Math.random()+"rem",e.l.classList.remove("v"),e.l.classList.remove("u"),e.l.classList.add("a")}class M extends y{W="?";R=v(0,"#f0a");G=0;K="#f00";N=0;O=0;j;H;h(){return a("x",{background:this.K},(0<this.N||0==this.O)&&t("c ab",""+this.N),0<this.O&&t("ak ab",""+this.O),this.R(),t("ac",this.W),this.H=t("ar"))}i(e){this.l.classList.toggle("aj",!(e??this.L())),n(this.H,this.Z(e).map(e=>t("",e)))}J=[150*Math.random()-75+1433,150*Math.random()-75-100];Y(){return!this.m&&(null!=this.o||null!=this._||null!=this.S||null!=this.$)}L(){return Fe.U>=this.O&&Fe._>=this.N}A;m=0;V;X;q;I=1;o;_;$;S;p;ee;M;D;U;k;Z(e){var t=[""," to all"," to the left enemy"][this.m];return[this.V&&"Cantrip",this.A,null!=this.o&&"Attack "+(this.o+(e?0:Fe.ee))+t,null!=this._&&"Splash Attack "+(this._+(e?0:Fe.ee)),null!=this.$&&"Bleed "+this.$+t,this.S&&"Stun"+t,null!=this.p&&`Gain ${this.p} Actions`,null!=this.ee&&`Gain ${this.ee} Mana`,null!=this.M&&"Heal "+this.M,null!=this.g&&"Damage self "+this.g,null!=this.D&&`Attacks do +${this.D} damage this fight`,null!=this.U&&"Draw "+this.U,this.k&&`Dodge ${this.k} this turn`,1!=this.I&&this.I+" Times",this.q&&"Pass",2==this.q&&"Retain Your Hand",this.X&&"Exhaust"].filter(e=>e)}async play(e){for(var t of(2===this.m&&(e=e.slice(0,1)),[...Array(this.I).keys()])){0<t&&await l(.2);for(let t of e)null!=this.o&&x(t,this.o+Fe.ee),null!=this._&&(await l(.2),Ye.o.map((e,a,s)=>{s[a-1]!=t&&s[a+1]!=t||x(e,this._+Fe.ee)})),null!=this.$&&k(t,this.$),null!=this.S&&$(t);null!=this.p&&T(-this.p,0),null!=this.ee&&T(0,-this.ee),this.M&&R(Fe,this.M),this.g&&x(Fe,this.g),this.D&&(Fe.ee+=this.D,Fe.i(),$e(qe)),this.U&&await Ae(this.U),this.k&&(Fe.m+=this.k,Fe.i())}}}class S extends M{G=0;K="#554396"}class O extends M{G=1;K="#8915a0"}class D extends M{G=2;K="#b66b17"}class E extends M{G=3;K="#923303"}class z extends M{G=4;K="linear-gradient(90deg, #b66b17, #923303, #8915a0)"}class B extends M{G=6;K="#289876"}let I=e=>(e.K="linear-gradient(135deg, #70a2a588 40%, #a7c4c6bb, #70a2a588 60%)",e.j=1,e.X=1,e.N=0,e.O=0,e);function T(e,t){var a=Fe;a._-=e,a.U-=t,a.i()}function N(){var e=Fe;Fe.U=1,Fe._=2,Fe.ee=0,Fe.k=0,Fe.m=0,e.i()}class P extends L{A="Mewnbeam";size=230;o=40;R=v(38,"#000");_;U;ee;i(){super.i(),this.l.style.bottom="290rem",this.l.style.left="150rem",this.l.classList.add("ao"),this.H.innerText=this.A+(this.ee?` (+${this.ee})`:""),p(this.Z,this._,this.U)}u(){this.Z.u(),super.u()}Z=new class extends y{h(){return t("ap",t("j"),t("ah"))}i(e,a){o(this.l.querySelector(".j"),e,()=>t("c")),o(this.l.querySelector(".ah"),a,()=>t("ak"))}}}var X=class extends L{A="Rat";o=5;size=130;R=v(46,"#e11");*$(){yield*i([u(2),c(1),c(2)])}},_=class extends L{A="Rat Wizard";o=3;size=130;R=v(41,"#07f");*$(){yield r,yield c(4)}},U=class extends L{A="Poison Rat";o=3;size=130;R=v(37,"#1e1");*$(){yield d(2)}},H=class extends L{A="Weasel 🛑2";o=15;size=175;R=v(50,"#c76d24");*$(){yield*i([c(2),c(3),c(5)])}g(){this.m=2}},G=class extends L{A="Rabbit";o=8;size=130;R=v(51,"#f20");constructor(e){super(),this.ee=!e}*$(){this.ee&&(yield w("🐇",0,new G(!0))),this.ee=!0,yield c(2),yield c(1),Math.random()<.5&&(yield c(2))}},K=class extends L{A="Beaver";o=17;size=175;R=v(52,"#a2512f");*$(){yield w("🪵🪵",new Y,new Y),yield c(4)}},Y=class extends L{A="Dam 🛡️";o=1;size=130;R=v(29,"#9d411a");P=!0;*$(){yield h}},q=class extends L{A="Rat Guard 🛡️";o=8;size=175;R=v(47,"#e11");P=!0;*$(){yield*i([c(2),["◄🛡️ 2►",(e,t)=>{b(e,-.5),t.map(e=>{e.t+=2,e.i()})}],u(4)])}},F=class extends L{A="Mouse";o=5;size=130;R=v(45,"#e11");*$(){yield*i([m(),c(2)])}},V=class extends L{A="Snake 🐍";o=17;size=175;R=v(40,"#348100");m=1;async F(){await super.F(),this.m+=1,this.i()}*$(){for(let e=0;;e++)yield d(3),0==e&&(yield w("🐁",0,new F)),yield c(i([3,4])[0])}},j=class extends L{A="Rat King";o=30;size=175;R=v(48,"#e11",1);*$(){yield w("🐀🐀",new X,new X);for(let e=0;;e++)yield c(5+2*e),yield m(),yield w("🐀",new X,0)}};let Z=[class extends S{W="Claw";R=v(1,"#d0f");N=1;o=1},class extends S{W="Scratch";N=1;R=v(11,"#f00");$=2},class extends S{W="Swipe";R=v(2,"#f50");N=1;m=1;o=1;X=!0},class extends O{W="Stomp";R=v(20,"#e8961b");O=2;S=1},class extends B{W="Curse: Scream";R=v(26,"#289876");V=1},class extends E{W="Rabbit’s Foot";R=v(21,"#f02");O=1;A="Discard your hand";U=4;async play(e){await Le(),await super.play(e)}},class extends z{W="Weasel Pelt";R=v(50,"#c76d24");O=1;k=5;X=1},class extends E{W="Dam";R=v(29,"#9d411a");O=1;k=1},class extends O{W="Tail Flick";R=v(35,"#0d915a");O=1;m=2;S=1},class extends D{W="Pounce";R=v(36,"#a65504");N=1;m=2;o=5},class extends E{W="Feather Toy on a String";R=v(0,"#a2f");U=1;ee=1},class extends S{W="Fireball";R=v(12,"#f61");O=2;o=4;_=2},class extends z{W="Spellbook";R=v(18,"#7d2300");O=1;U=7},class extends z{W="Ratsbane";R=v(32,"#53890b");N=2;o=9;X=1},class extends E{W="Toadstool";R=v(31,"#d42916");N=1;$=4;X=1},class extends E{W="Spellbookmark";R=v(19,"#1e44ae");V=1;o=3;m=2},class extends S{W="Sneak Attack";R=v(33,"#301b45");N=1;O=1;o=3;_=2;m=2},class extends O{W="Paw";R=v(4,"#ff32f1");o=0;I=2},class extends S{W="Maul";R=v(5,"#f80");N=2;o=2;$=3},class extends O{W="Boom Bop Bam";R=v(15,"#709a2b");N=2;o=1;I=3},class extends O{W="Spirit Scratch";R=v(2,"#ccf");m=1;V=1;$=1},class extends S{W="Meow";R=v(10,"#7fae10");N=0;U=2},class extends O{W="Bite";R=v(6,"#f00");N=1;o=1;M=1;X=1},class extends D{W="Tongue Bath";R=v(16,"#4d1c92");N=1;M=4;X=!0},class extends O{W="Boba Eyes";R=v(9,"#406");O=2;D=2},class extends O{W="Boop";R=v(22,"#71b6cb");O=1;m=1;A="Reverse enemy order";play=()=>Ye.o.reverse();X=1},class extends S{W="Swat";R=v(28,"#a18600");N=1;o=1;ee=1;A="Push to the right";play([e]){var t=Ye.o.indexOf(e);return Ye.o.splice(t,1),Ye.o.splice(t+1,0,e),super.play([e])}},class extends S{W="Prepare Spell";R=v(23,"#ca8f5f");N=1;A="Add a ghostly Fireball to your draw pile";play=()=>We(0,I(new le))},class extends z{W="Knapsack";R=v(24,"#923303");O=1;A="Make a random Trinket";play=()=>We(1,Ke()[0])},class extends D{W="Dark Bargain";R=v(25,"#f20");N=1;O=1;o=0;i(e){super.i(e)}async play(e){var t;await We(0,new ae),this.o=2*(t=qe).o.concat(t.pending,t.A,t.m).filter(e=>6==e.G).length,super.play(e)}Z=()=>["Make a Curse","Attack 2 per Curse in play"]},class extends D{W="Cat Opera";R=v(34,"#08f");O=4;m=1;o=5},class extends O{W="Blood Ritual";R=v(27,"#f02");N=1;O=1;g=1;D=3},class extends D{W="Convene with Spirits";R=v(7,"#0f7");O=1;A="Draw 2 cards of your choice";L(){return super.L()&&qe.o.length}async play(){for(let t=0;t<2;t++){var e=qe.o;if(e.length<1)break;-1==(e=await Ue(e,0,5,"Draw "+(2-t)))?t--:(qe.A.push(...qe.o.splice(e,1)),$e(qe))}i(qe.o)}},class extends S{W="Channel";R=v(8,"#3bf");O=0;ee=2},class extends O{W="See Ghost";O=2;R=v(3,"#005f39");A="Make a ghostly copy of a discarded card";L(){return super.L()&&qe.m.length}async play(){var e=qe.m,t=await Ue(e,0,5);if(-1==t)return this.play();await We(1,I(new e[t].constructor))}},class extends z{W="Vampire Bat Extract";O=1;R=v(30,"#f20");X=1;A="Make 3 ghostly Bites";async play(){await We(1,I(new me),I(new me),I(new me))}},class extends O{W="Zoomies";R=v(13,"#496fcf");O=1;k=1;p=2},class extends D{W="Witching Hour";R=v(14,"#353cfd");p=2;ee=2;X=1},class extends E{W="Yarn Ball";R=v(17,"#8453ff");O=0;ee=1;q=2},class extends B{W="Curse: Rat Pack";R=v(46,"#00ff86");V=1;A="Summon a Rat";X=1;async play(){var e;Ye.o.length<6&&($(e=new X),await Ee([e],6))}}],J=Z[0],Q=Z[1],ee=Z[2],te=Z[3],ae=Z[4],se=Z[5],ne=Z[6],ie=Z[7],le=Z[11],oe=Z[12],re=Z[13],he=Z[14],ce=Z[15],de=Z[17],ue=Z[20],me=Z[22],we=Z[28],pe=Z[29],fe=Z[32],ye=Z[34],ve=Z[35],ge=Z[36],be=Z[39],xe=e=>!!localStorage["mewnbeam_lZrc_"+e.W],ke=e=>localStorage["mewnbeam_lZrc_"+e.W]=1,Re=()=>[new J,new J,new J,new Q,new ee,new te];function $e(e){p(e.h),p(e.D,e.o.length),p(e.p,e.m.length),p(e.k,e.$.length),e.k.l.style.zIndex=60;let[t,a,s,n]=e.U;e.o.map(e=>{p(e),e.l.style.zIndex=25,e.l.style.transform="rotate(0deg)",e.l.style.left="-250rem",e.l.style.bottom="-100rem",e.l.classList.remove("v"),e.l.classList.add("u"),e.l.classList.add("a")}),e.pending.map(e=>{p(e)}),e.A.map((t,a)=>{p(t);var i,l,o,r,h=t===e.active;[a,h,t,i,l,o]=[t,a,e.A.length,h,...h&&!t.Y()?[s||0,n||0]:[0,0]],r=1==t?0:h/(t-1)*2-1,a.l.style.zIndex=i?25:10+h,a.l.style.transform=`rotate(${5*r||.8}deg)`,a.l.style.left=`calc(${t<=5?671+200*(h-t/2):171+800/(t-1)*h}rem + ${l}px)`,a.l.style.bottom=`calc(${(i?55:15)-20*r**2}rem - ${o}px)`,a.l.classList.toggle("v",i),a.l.classList.remove("u"),a.l.classList.remove("a")}),e.m.map(e=>{p(e);var[t,a]=e.J;e.l.style.zIndex=25,e.l.style.transform="rotate(0deg)",e.l.style.left=t+"rem",e.l.style.bottom=a+"rem",e.l.classList.remove("v"),e.l.classList.remove("u"),e.l.classList.remove("a")}),e.ee.map(e=>{p(e),f(e)}),e.active?.Y()?p(e._,e.active?.l,t,a):e._.u()}async function Ae(e){var t=qe;for(let a=0;a<e&&(0<t.o.length||0<t.m.length);a++)await(async e=>{if(0==e.o.length){if(0==e.m.length)return;e.o=[...e.o,...e.m],e.m=[],i(e.o),$e(e),await l(.4)}var t=e.o.pop();(t.V?e.pending:e.A.length<7?e.A:e.m).unshift(t),$e(e),t.V&&(C(t,e.pending.length),await l(.4),await t.play(Ye.o),ze()),await l(.4)})(t)}async function Le(){var e=qe;e.m.push(...e.A),e.A=[],$e(e),await l(.4)}async function We(e,...t){var a,s=qe;for(a of(t.map(ke),t))p(a),C(a,-1);for(await l(.2),[s.o,s.A,s.m][e].push(...t);7<s.A.length;)s.m.push(s.A.pop());i(s.o),$e(s),await l(.2)}async function Ce(){var e=qe;let t=[];document.body.classList.add("d"),$e(e);var[a,s]=await new Promise(a=>{for(let s of e.A)if(s.L()){let e=e=>a([s,e]);s.l.addEventListener("mousedown",e),t.push(()=>s.l.removeEventListener("mousedown",e))}let s=()=>a(["pass"]),n=(e.h.l.classList.remove("g"),e.h.l.addEventListener("click",s),e=>{" "==e.key&&a(["pass"])});addEventListener("keydown",n),t.push(()=>{e.h.l.classList.add("g"),e.h.l.removeEventListener("click",s),removeEventListener("keydown",n)})});return document.body.classList.remove("d"),t.map(e=>e()),"pass"!=a&&(e.active=a),$e(e),[a,s]}function Me(e){var t=qe;t.pending.push(e),t.A=t.A.filter(t=>t!=e),$e(t)}function Se(){var e=qe;e.m.push(...e.pending.filter(e=>!e.X)),e.ee.push(...e.pending.filter(e=>e.X)),e.pending=[],$e(e)}function Oe(){var e=qe;e.U=[],e.active=null,$e(e)}Re().map(ke);class De extends y{constructor(e,t,a){super(),this.m=t,this.A=a,this.$=e}o;h(){var e=a("o",{inset:this.m},this.o=t(),t("l",this.$));return e.addEventListener("click",this.A),e}i(e){this.o.innerText=e}}async function Ee(e,t=100){var a=Ye;a.o.splice(t,0,...e),Be(a,e),await l(.05),Be(a),await l(.4)}async function ze(){var e=Ye,t=e.o.filter(e=>e.C<=0);e.o=e.o.filter(e=>0<e.C),t.map(async e=>{await f(e),e.u()}),await l(.4),Be(e)}function Be(e,t=[]){let a=666-(e.o.map(e=>e.size).reduce((e,t)=>e+t,0)+60*(e.o.length-1))/2;for(var s of e.o)p(s),s.l.style.bottom=t.includes(s)?"1100rem":s.P?"575rem":"600rem",s.l.style.left=a+"rem",a+=s.size+60}function Ie(){let e=Ye,t=e.o.some(e=>e.P);return e.o.filter(e=>e.P==t)}function Te(){var e=Ye;e.o.map(e=>e.u()),e.o=[]}function Ne(e,a,s,...n){return new Promise(i=>{p(new class extends y{h(){let l=e=>{"Escape"==e.key&&(this.u(),removeEventListener("keydown",l),i(0))};!e||4&e||addEventListener("keydown",l);var o=n.map((a,s)=>0==s&&4&e?null:t((!e||0==s)&&"ae",a));return o.map((t,a)=>{0!=a&&2&e||t?.addEventListener("click",()=>{removeEventListener("keydown",l),this.u(),i(a)})}),t(e?"b s":"b",t(e?"af":"af m",t(s?"f at":"f",t("",a),s),t("av",o)))}})})}function Pe(t,...a){let n=t.flatMap((e,t)=>[...e.split(/( )/g).map(e=>s("span","",{},e)),s("span","",{},a[t])]);return n.map(async(e,t)=>{e.style.opacity=0,await l(.8*t/n.length),e.style.opacity=1}),e("span",n)}let Xe=v(44,"#f40",1);async function _e(e,a,s){(e=await Ne(0,e,a,...(s=s.map(e=>[e].flat())).map(e=>t("k",e.map(e=>W(e)))),"Hiisss! (Pass)"))<s.length&&([...a]=[...s[e]],(s=qe).$.push(...a),a.map(ke),$e(s))}async function Ue(e,a,s,n,i){return a=a?e.toSorted((e,t)=>e.G-t.G||e.W.localeCompare(t.W)):e,-1+await Ne(s,t("",n,e.length?0:" (Empty)",i?` (${e.filter(xe).length} / ${e.length})`:"")," ","Back",...a.map(e=>W(e,!(2&s),i&&!xe(e))))}let He,Ge=[async()=>{var t=new oe;await _e([e("h2","The Library"),Pe`Short-Tongue loves her spell book, but maybe that ribbon is more my jam...`],t.R(),[[new be,t],new ce])},async()=>{var t=new we;await _e([e("h2","The Woods"),Pe`How\u2019d I end up outside? Oh well, the Rat King isn't going anywhere.${e("br")}${e("br")}At least I remembered my knapsack!`],t.R(),[t])},async()=>{var t=[new ae,new ae,new pe];await _e([e("h2","The Sunroom"),Pe`Who summons a demon in the sunroom??${e("br")}${e("br")}This room is clearly made for napping.`],t[2].R(),[t])},async()=>{var t=[[new ge,new ye],[new fe]];await _e([e("h2","A Haunting"),Pe`Is someone there? Do you have treats?`],t[1][0].R(),t)},async()=>{var t=[[new de,new de],[new ue]];await _e([e("h2","Closed Door"),Pe`How ${e("b","dare")} she!`],(new ae).R(),t)},async()=>{var t=[[new re],[new ve],[new he]];await _e([e("h2","Brewery"),Pe`So many things to knock on the floor, so little time.`],t[0][0].R(),t)}],Ke=()=>i(Z.map(e=>new e).filter(e=>e instanceof E)).slice(0,3),Ye=new class{o=[]},qe=new class{$=[];o=[];A=[];pending=[];m=[];ee=[];_=new class extends y{h(){return s("canvas","as")}i(e,t,a){var s,n,i,l;e&&(({width:i,height:s,left:l,top:n}=document.body.getBoundingClientRect()),this.l.width=i,this.l.height=s,e=(i=e.getBoundingClientRect()).left-l+i.width/2,i=i.top-n+i.height/2,(l=this.l.getContext("2d")).clearRect(0,0,1e6,1e6),l.lineCap="round",l.setLineDash([30]),l.beginPath(),l.moveTo(t,a),l.lineTo(e,i-.05*s),l.strokeStyle="#ddd",l.lineWidth=28,l.stroke(),l.strokeStyle="#a0f",l.lineWidth=20,l.stroke())}};h=new class extends y{h(){return t("r g ae","End Turn")}};k=new De("Deck","20rem auto auto 20rem",()=>Ue(this.$,0,3,"Deck"));D=new De("Draw","auto auto 20rem 20rem",()=>Ue(this.o,1,3,"Draw Pile"));p=new De("Discard","auto 20rem 20rem auto",()=>Ue(this.m,0,3,"Discard Pile"));active=null;U=[]},Fe=new P,Ve=()=>{Fe?.u(),He?.u(),Te(),Fe=new P,He=new g};async function je(){return Ve(),0==await Ne(0,[e("h1","Mewnbeam’s Adventure"),v(39,"#000")()],0,"Start","Library")?await(async()=>{Ve(),p(He),p(Fe);var t=qe,s=(t.$=Re(),$e(t),t=i([...Ge]),await Ne(0,Pe`Mewnbeam, would you be a dear and ${e("i","take care of")} that ${e("b","Rat King")} while I\u2019m out?${e("br")}${e("br")}He should be easy to find, he\u2019s been causing lots of trouble up in the attic.${e("br")}${e("br")}Shouldn\u2019t be a big deal, just remember: ${e("i","Mana")} carries over, but ${e("b","actions")} reset every round.`,Xe(),"Mrow?"),await _e(Pe`Hmph. Alright, I do need to be off to the potion shop, but I suppose I could give you some help before I go.${e("br")}${e("br")}What\u2019ll it be?`," ",Ke()),(()=>{let e=function*(){for(;;)yield*i([...Array(5).keys()].map(e=>(e+Math.random())/5))}(),t=i([new X,new U,new _,new F]),a=!1,s=i([[new q,new F],[new q,new U],[new X,new U,new U,new _],[new q,new _,new q],[new F,new F,new F]]),n=i([[new X,new q,new _,new F,new U],[new G,new G,new F],[new X,new H,new F],[new V]]);return l=>{let o=[[],[],[]];Z.map(e=>new e).map(e=>o[e.G]?.push(e)),o.map(i);var r=i([e.next().value>.1+l/40?0:1,e.next().value>.3+l/40?0:1,e.next().value>.15+l/20?1:2]).map(e=>o[e].pop());return l<4?[[new X,t.pop()],r]:l<7&&!a?(a=!0,i([[[new H],[r[0],new ne,r[1]]],[[new G],[r[0],new se,r[1]]],[[new K],[r[0],new ie,r[1]]]])[0]):l<10?[s.pop(),r]:l<14?[n.pop(),r]:[[new q,new j,new F,new q],[]]}})());for(let r=0;r<15;r++){var n=await(async()=>{var e=He;return e.o++,e.i(),e.m[e.o]})();if(await(async()=>{var e=Ze;e.o.style.bottom="-1000rem",await l(.75),e.u(),p(e)})(),3==n)await async function e(){if(0==await Ne(0,[a("",{height:"60rem"}),v(39,"#000")(),a("",{height:"60rem"}),"This looks like a cozy spot..."],0,`Cat Nap (Heal 7: ${Fe.C} → ${Math.min(Fe.o,Fe.C+7)})`,"Lick (Remove a Card)"))R(Fe,7);else{let a=await Ue(qe.$,!1,1,"Remove a Card...");if(-1==a)return e();var t=qe;t.$.splice(a,1),$e(t)}}();else if(2==n)await t.pop()();else{var[n,o]=s(r);if(await(async e=>{Te();var t=qe,a=t;[...a.$,...a.o,...a.A,...a.pending,...a.m,...a.ee].map(e=>e.u()),t.o=i([...t.$]),t.A=[],t.pending=[],t.m=[],t.ee=[],$e(t),N(),await l(.1),await Ee(e),await(async()=>{let e=!1;for(;await Ae(4),Se(),ze(),0!=Ye.o.length;){for(;;){Be(Ye);var t=await async function e(){let[t,a]=await Ce();if("pass"==t)return"pass";$e(qe);let s=()=>{},n=await new Promise(e=>{function n(a){if(t.Y()){for(var[s,n]of Ie().map(e=>[e.l,e]))if(s.contains(a.target))return e([t,n])}else{let{top:s,left:n,right:i,height:l}=document.body.getBoundingClientRect();if(a.clientX>=n&&a.clientX<=i&&a.clientY<=s+.7*l)return e([t,null])}e(null)}async function i(e){let[t,s]=[e.clientX-a.clientX,e.clientY-a.clientY];t**2+s**2<625?(await l(.05),addEventListener("click",n)):n(e)}function o(t){"Escape"===t.key&&e(null)}function r(e){let[t,s]=[e.clientX-a.clientX,e.clientY-a.clientY],{top:n,left:i}=document.body.getBoundingClientRect();qe.U=[e.clientX-i,e.clientY-n,t,s],$e(qe)}t.Y()&&Ie().map(e=>e.l?.classList.add("w")),addEventListener("mouseup",i,{once:!0}),addEventListener("mousemove",r),addEventListener("keydown",o),s=()=>{removeEventListener("mouseup",i),removeEventListener("click",n),removeEventListener("mousemove",r),removeEventListener("keydown",o),Ye.o.map(e=>e.l?.classList.remove("w"))}});return n&&Me(t),Oe(),s(),null==n?e():n}();if("pass"==t)break;var[a,s]=t;if(T(a.N,a.O),await Promise.all([a.play(s?[s]:Ye.o),l(.2)]),Se(),ze(),0==Ye.o.length||Fe.C<=0)return;if(a.q){e=2==a.q;break}}for(var n of(e||await Le(),e=!1,Ye.o))if(await n.F(),ze(),0==Ye.o.length)return;for(var i of t=[...Ye.o])if(!(i.C<=0)&&(await A(i)[1](i,Ye.o),ze(),await l(.1),$(i),await l(.5),Fe.C<=0))return;if(0==Ye.o.length)break;if(Fe.F(),Fe.C<=0)break;Fe.U+=1,Fe._=2,Fe.i(),Ye.o.map(e=>{e.B=void 0,e.i()})}})(),0<Fe.C&&N(),await Le()})(n),Fe.C<=0)return void await Ne(0,[e("h2","Defeat..."),Pe`Mewnbeam, I'm back! How was killing th--${e("br")}${e("br")}Oh. Oh dear.${e("br")}${e("br")}Let\u2019s see, where\u2019d I put that revivify potion...`],Xe(),"Try Again");r<14&&await _e(e("h2","Choose..."),0,o)}}await Ne(0,[e("h1","Victory!"),a("",{textAlign:"left"},Pe`Mewnbeam, I'm back! How was killing the ${e("b","Rat King")}? Tasty?${e("br")}${e("br")}I got you a treat for all your hard work!`)],Xe(),"Continue")})():await Ue(Z.map(e=>new e),!0,3,"Library",!0),je()}let Ze=new class extends y{o;h(){return this.o=t("y",v(54,"#301b45")(),v(54,"#301b45")()),t("",this.o,t("ag",v(42,"#0000")(),v(43,"#0000")()))}};addEventListener("load",async function(){p(Ze),await je()})</script>