<!doctype html><meta name=viewport content="user-scalable=no,width=device-width"><title>Texas Hold'em</title><style>*{margin:0;padding:0}body{overflow:hidden;text-align:center;background:#000;overflow:hidden}canvas{margin:0 auto}#controls{position:absolute;left:0;right:0;bottom:0;padding:6px;background:rgba(0,0,0,.5);border-top:1px #000 solid;text-align:right;min-width:480px}.btn{box-shadow:inset 0 -24px 0 0 #c40000;background:-webkit-gradient(linear,left top,left bottom,color-stop(.05,#fe1a00),color-stop(1,#ce0100));background:-moz-linear-gradient(top,#fe1a00 5%,#ce0100 100%);background:-webkit-linear-gradient(top,#fe1a00 5%,#ce0100 100%);background:-o-linear-gradient(top,#fe1a00 5%,#ce0100 100%);background:-ms-linear-gradient(top,#fe1a00 5%,#ce0100 100%);background:linear-gradient(to bottom,#fe1a00 5%,#ce0100 100%);background-color:#fe1a00;border-radius:6px;border:1px solid #4f0700;display:inline-block;color:#fff;font:bold 15px Arial;padding:0 16px;text-shadow:0 1px 0 #b23e35;text-align:center;vertical-align:middle;line-height:48px}.ext{line-height:24px!important}.ext2{height:48px;width:180px;line-height:auto!important}input.btn:hover,span.btn:hover{background:-webkit-gradient(linear,left top,left bottom,color-stop(.05,#ce0100),color-stop(1,#fe1a00));background:-moz-linear-gradient(top,#ce0100 5%,#fe1a00 100%);background:-webkit-linear-gradient(top,#ce0100 5%,#fe1a00 100%);background:-o-linear-gradient(top,#ce0100 5%,#fe1a00 100%);background:-ms-linear-gradient(top,#ce0100 5%,#fe1a00 100%);background:linear-gradient(to bottom,#ce0100 5%,#fe1a00 100%);background-color:#ce0100;cursor:pointer}input.btn:active,span.btn:active{position:relative;top:1px}#overlay{position:absolute;left:0;top:0;right:0;bottom:0;background:rgba(0,0,0,.75);z-index:2}#overlay div{position:absolute;top:40%;left:50%;margin-left:-160px;width:320px;border:1px #ccc solid;border-radius:4px;background:#fff;padding:10px}#overlay input[type=text]{height:48px;font:bold 15px arial;margin-right:5px;text-align:center;width:220px}#chat{position:absolute;top:25px;left:5px;width:200px;overflow-x:hidden;color:#fff;text-align:left;font:10pt arial}#chat p:nth-child(2n){color:#ff0}#chatinput{background:0 0;position:absolute;top:5px;left:5px;width:150px;height:15px;color:#efefef;border:0;outline:0}</style><div id=overlay><div><input id=nick placeholder="Enter Nick" maxlength=10> <input id=start type=button class=btn value=Start></div></div><input id=chatinput placeholder=Chat... maxlength=140><div id=chat></div><div id=controls><span id=fold style=display:none class=btn>FOLD</span> <span id=check style=display:none class=btn>CHECK</span> <span id=allin style=display:none class=btn>ALL IN</span> <span id=call style=display:none class="btn ext">CALL<br><span id=call_amount><br></span></span><span id=raise style=display:none class="btn ext">RAISE TO<br><span id=raise_amount><br></span></span><div class="btn ext2"><div id=wait>Waiting for players...</div><div id=betting style=display:none>betting</div></div></div><script src=/socket.io.js></script><script src=sprite.js></script><script>var socket=io({path:location.pathname+"io",upgrade:!1,transports:["websocket"]}),playerId=0,players={},playerList=[],hands={},dealerId=-1,currentId=-1,potSize=0,board=[],hand="",maxBet=0,$allin=$("allin"),$chat=$("chat"),$call=$("call"),$fold=$("fold"),$check=$("check"),$raise=$("raise"),$betting=$("betting"),$wait=$("wait"),$call_amount=$("call_amount"),$raise_amount=$("raise_amount");function $(t){return document.getElementById(t)}socket.on("id",(function(t){playerId=t})),socket.on("nick",(function(t){t.id===playerId&&($("overlay").style.display="none"),players[t.id]&&(players[t.id].name=t.name)})),socket.on("chat",(function(t){if(players[t.id]){var e=document.createElement("p");for(e.innerText="["+(players[t.id].name||"Nick")+"]: "+t.message,$chat.insertBefore(e,$chat.firstChild);$chat.childNodes.length>15;)$chat.removeChild($chat.childNodes[15])}})),socket.on("welcome",(function(t){players[t.id]||(playerList.push(t.id),players[t.id]=t)})),socket.on("goodbye",(function(t){players[t.id]&&(playerList.splice(playerList.indexOf(t.id),1),delete players[t.id])})),socket.on("pot",(function(t){potSize=t})),socket.on("round",(function(t){for(var e in players)players[e].bet=0})),socket.on("bet",(function(t){players[t.id]&&(players[t.id].bet=t.bet)})),socket.on("maxBet",(function(t){maxBet=t})),socket.on("chips",(function(t){players[t.id]&&(players[t.id].chips=t.chips)})),socket.on("state",(function(t){players[t.id]&&(players[t.id].state=t.state)})),socket.on("fold",(function(t){players[t]&&(players[t].state=2,t===playerId&&(hand=""))})),socket.on("hand",(function(t){hand=t})),socket.on("hands",(function(t){players[t.id]&&(hands[t.id]=t.hand)})),socket.on("dealerId",(function(t){dealerId=t})),socket.on("currentId",(function(t){currentId=t})),socket.on("board",(function(t){for(var e in board=t,players)players[e].bet=0})),socket.on("reset",(function(t){for(var e in potSize=0,hand="",hands={},board=[],maxBet=0,players)players[e].bet=0,players[e].state=1})),$("start").addEventListener("click",(function(){socket.emit("nick",$("nick").value)})),$("chatinput").addEventListener("keydown",(function(t){13===t.keyCode&&this.value.trim()&&(socket.emit("chat",this.value.trim()),this.value="")})),$fold.addEventListener("click",(function(t){socket.emit("fold")})),$call.addEventListener("click",(function(t){socket.emit("call")})),$allin.addEventListener("click",(function(t){socket.emit("call")})),$check.addEventListener("click",(function(t){socket.emit("call")})),$raise.addEventListener("click",(function(t){socket.emit("bet",maxBet+20-players[playerId].bet)}));var resized=!0;window.addEventListener("resize",(function(){resized=!0}));var canvas=document.createElement("canvas"),context=canvas.getContext("2d");document.body.appendChild(canvas);var background,sprites={D:drawChip("#ddd","D",1),SB:drawChip("#ff0","SB",1),BB:drawChip("#f00","BB",1),1:drawChip("#4656d3","1"),5:drawChip("#eb3d27","5"),25:drawChip("#7bff58","25"),100:drawChip("#444","100"),500:drawChip("#ff58f5","500"),1e3:drawChip("#ff6c00","1K"),5e3:drawChip("#9ed3da","5K"),25e3:drawChip("#ffb258","25K"),1e5:drawChip("#fff58b","100k")},blinkInterval=0,time=Date.now(),stateInterval=0,cardWidth=60;function render(){var t=Date.now()-time;if(time+=t,(stateInterval+=t)>500){stateInterval=0;var e=0;for(var a in players)1===players[a].state&&players[a].chips>0&&e++;if($wait.style.display="",$fold.style.display="none",$check.style.display="none",$call.style.display="none",$raise.style.display="none",$betting.style.display="none",$allin.style.display="none",e>=2&&($wait.style.display="none",$betting.style.display="",currentId===playerList.indexOf(playerId))){var n=maxBet-players[playerId].bet;n>0?($fold.style.display="",n>players[playerId].chips?$allin.style.display="":($call.style.display="",$call_amount.innerText=n,players[playerId].chips>=maxBet+20&&($raise.style.display="",$raise_amount.innerText=maxBet+20))):($check.style.display="",$raise.style.display="",$raise_amount.innerText="20")}}if((blinkInterval+=t)>1e3&&(blinkInterval=0),resized)for(var i in resized=!1,canvas.width=Math.max(480,window.innerWidth),canvas.height=Math.max(320,window.innerHeight),(background=ctx.createRadialGradient(canvas.width/2,canvas.height/2,0,canvas.width/2,canvas.height/2,canvas.width/2)).addColorStop(0,"#494949"),background.addColorStop(1,"#000000"),updateCardSize(Math.max(canvas.width/40|0,30)),sprites)"c"===i[0]&&(sprites[i]=null);context.fillStyle=background,context.fillRect(0,0,canvas.width,canvas.height),""!=hand&&(context.fillStyle="#fff",context.font="bold 10pt Arial",context.textAlign="right",context.fillText(hand,canvas.width-10,20));var r=drawTable(context,10,.1*canvas.height,canvas.width-20,.9*canvas.height-100),s=canvas.width/2-r,l=canvas.height/2-r/2-50,o=2*r,d=r;if(playerList.length>0){var c=Math.max(80,o/10),p=c/2;context.translate(s+r,l+r/2);for(var h=playerList.indexOf(playerId),f=90,y=0;f<450;f+=360/playerList.length,y++){var x=(h+y)%playerList.length,u=Math.sin(f*Math.PI/180)*d/2,v=Math.cos(f*Math.PI/180)*(o-20)/2,k=Math.max(Math.floor(p/4-1),6);context.translate(v-c/2,u-p/2),roundRect(context,c,p,5),context.fillStyle=currentId===x&&blinkInterval>500?"rgba(0,0,0,0.75)":"rgba(0,0,0,0.6)",context.fill(),context.fillStyle=currentId===x&&blinkInterval>500?"#fff":"#eee",context.font="bold "+k+"pt Arial",context.textAlign="center";var $=players[playerList[x]];if($){context.fillText($.name,c/2,1.8*k),context.fillText(0===$.state?"Sitting out":"$"+$.chips.toLocaleString("en"),c/2,3.6*k),dealerId===x&&context.drawImage(sprites.D,-10,p/2);var m=10*Math.sin(f*Math.PI/180);if(hands.hasOwnProperty($.id)){var w,b;if($.id===playerId&&hands[$.id]){var g="c"+hands[$.id][0].rank+hands[$.id][0].suit,I="c"+hands[$.id][1].rank+hands[$.id][1].suit;sprites[g]||(sprites[g]=drawCard(hands[$.id][0].rank,hands[$.id][0].suit)),w=sprites[g],sprites[I]||(sprites[I]=drawCard(hands[$.id][1].rank,hands[$.id][1].suit)),b=sprites[I]}else sprites.cover||(sprites.cover=drawCover()),w=b=sprites.cover;context.drawImage(w,-(Math.cos(f*Math.PI/180)*p+20)+w.width-5,-Math.sin(f*Math.PI/180)*p-m),context.drawImage(b,-(Math.cos(f*Math.PI/180)*p+20)+2*b.width,-Math.sin(f*Math.PI/180)*p-m)}$.bet>0&&1===$.state&&(drawChips(context,sprites,$.bet,-(Math.cos(f*Math.PI/180)*p+20),-Math.sin(f*Math.PI/180)*p),context.translate(-70,-10),roundRect(context,60,12,2),context.fillStyle="rgba(0,0,0,0.6)",context.fill(),context.fillStyle="#fff",context.font="bold 8pt Arial",context.textAlign="center",context.fillText("$"+$.bet.toLocaleString("en"),30,10),context.translate(70,10))}context.translate(-(v-c/2),-(u-p/2))}for(f=0;f<board.length;f++){var C="c"+board[f].rank+board[f].suit;sprites[C]||(sprites[C]=drawCard(board[f].rank,board[f].suit)),context.drawImage(sprites[C],-sprites[C].width*f,-sprites[C].height)}potSize>0&&(drawChips(context,sprites,potSize,0,20),context.translate(-80,-9-p-p),roundRect(context,120,18,10),context.fillStyle="rgba(0,0,0,0.6)",context.fill(),context.fillStyle="#fff",context.font="bold 10pt Arial",context.textAlign="center",context.fillText("Pot: $"+potSize.toLocaleString("en"),60,15),context.translate(80,9+p+p)),context.translate(-(s+r),-(l+r/2))}}!function t(){requestAnimationFrame(t),render()}()</script>