<!doctype html><style>html{box-sizing:border-box}*,:after,:before{box-sizing:inherit}body{background-color:#647a94;height:100vh;overflow:hidden;color:#0f0}canvas{float:right;width:fit-content;position:initial}@media screen and (max-width:1200px){canvas{transform:translate(-50%,-20%) scale(.5);background-color:#262626}}#score{text-decoration:bold}.container{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%) translateY(20px) scale(1.5);font-family:'Source Code Pro',monospace;width:fit-content}@media screen and (max-width:600px){.container{position:absolute;transform:translate(-50%,-50%) scale(1)}}.console{cursor:move;max-width:720px;min-width:460px;width:50vw;max-height:540px;min-height:320px;height:50vh;border:6px solid #bbb}.console .console-head{height:24px;background-color:#bbb;display:-webkit-box;display:flex;-webkit-box-pack:justify;justify-content:space-between;border-bottom:4px solid #bbb}.console .console-head .console-title{font-weight:600;color:#222}p{margin-top:20px}.console .console-head .console-actions{display:-webkit-box;display:flex;justify-content:space-around}.console .console-head .console-actions .console-action{margin-left:4px;display:block;width:20px;height:20px;color:#222;text-align:center;font-size:.9rem}.console .console-head .console-actions .console-action .fa{line-height:20px;font-family:Verdana,Geneva,Tahoma,sans-serif;font-weight:700}.console .console-head .console-actions .console-action.console-action-min{background-color:#eeee73}.console .console-head .console-actions .console-action.console-action-max{background-color:#bee07e}.console .console-head .console-actions .console-action.console-action-close{background-color:#e08d8d}.console .console-body{overflow:hidden;height:45.7vh;background-color:#222;z-index:-1;text-shadow:0 0 1ex #3f3,0 0 2px rgba(255,255,255,.8)}.console .console-body .console-text{font-family:'Franklin Gothic Medium','Arial Narrow',Arial,sans-serif: 4px}a{color:#fff;text-decoration:none}a::before{content:"["}a::after{content:"]"}em{font-family:monospace}</style><meta name=viewport content="width=device-width,initial-scale=1"><title>Document</title><div class=container id=container><div class=console id=containerheader><div class=console-head id=mydivheader><div class=console-title>JS13KGames</div><div class=console-actions><div class="console-action console-action-min"><span class=fa style=font-weight:900>_</span></div><div class="console-action console-action-max"><span>â—³</span></div><div class="console-action console-action-close"><span class=fa>X</span></div></div></div><div class=console-body><div class=console-text style=float:left><h1>ERROR <a>4<span id=score style=color:#0f0>0</span>4</a><span style=font-size:small> Hi-score: <span id=hi-score></span></h1><p>The page you are looking for might have been removed, had its name changed or is temporarily unavailable. Try <a href=https://js13kgames.com/ >going home</a> playing this game of tetris. Press <small><em>Enter</em></small> to start. Use the <em>Arrow</em> keys or the <em>W,A,S,D</em> keys to move</p><canvas id=tetris width=110 height=185></canvas></div></div></div></div><script>var score=0;const canvas=document.getElementById("tetris"),context=canvas.getContext("2d");function arenaSweep(){let e=1;e:for(let t=arena.length-1;t>0;--t){for(let e=0;e<arena[t].length;++e)if(0===arena[t][e])continue e;const o=arena.splice(t,1)[0].fill(0);arena.unshift(o),++t,player.score+=e,e*=2}}function collide(e,t){const o=t.matrix,r=t.pos;for(let t=0;t<o.length;++t)for(let n=0;n<o[t].length;++n)if(0!==o[t][n]&&0!==(e[t+r.y]&&e[t+r.y][n+r.x]))return!0;return!1}function createMatrix(e,t){const o=[];for(;t--;)o.push(new Array(e).fill(0));return o}function createPiece(e){return"I"===e?[[0,1,0,0],[0,1,0,0],[0,1,0,0],[0,1,0,0]]:"L"===e?[[0,2,0],[0,2,0],[0,2,2]]:"J"===e?[[0,3,0],[0,3,0],[3,3,0]]:"O"===e?[[4,4],[4,4]]:"Z"===e?[[5,5,0],[0,5,5],[0,0,0]]:"S"===e?[[0,6,6],[6,6,0],[0,0,0]]:"T"===e?[[0,7,0],[7,7,7],[0,0,0]]:void 0}function drawMatrix(e,t){e.forEach(((e,o)=>{e.forEach(((e,r)=>{0!==e&&(context.fillStyle=colors[e],context.fillRect(r+t.x,o+t.y,1,1))}))}))}function draw(){context.fillStyle="#262626",context.fillRect(0,0,canvas.width,canvas.height),drawMatrix(arena,{x:0,y:0}),drawMatrix(player.matrix,player.pos)}function merge(e,t){t.matrix.forEach(((o,r)=>{o.forEach(((o,n)=>{0!==o&&(e[r+t.pos.y][n+t.pos.x]=o)}))}))}function rotate(e,t){for(let t=0;t<e.length;++t)for(let o=0;o<t;++o)[e[o][t],e[t][o]]=[e[t][o],e[o][t]];t>0?e.forEach((e=>e.reverse())):e.reverse()}function playerDrop(){player.pos.y++,collide(arena,player)&&(player.pos.y--,merge(arena,player),playerReset(),arenaSweep(),updateScore(),checkHiscore()),dropCounter=0}function playerMove(e){player.pos.x+=e,collide(arena,player)&&(player.pos.x-=e)}function playerReset(){const e="TJLOSZI";player.matrix=createPiece(e[7*Math.random()|0]),player.pos.y=0,player.pos.x=(arena[0].length/2|0)-(player.matrix[0].length/2|0),collide(arena,player)&&(arena.forEach((e=>e.fill(0))),player.score=0,updateScore(),checkHiscore())}function playerRotate(e){const t=player.pos.x;let o=1;for(rotate(player.matrix,e);collide(arena,player);)if(player.pos.x+=o,o=-(o+(o>0?1:-1)),o>player.matrix[0].length)return rotate(player.matrix,-e),void(player.pos.x=t)}context.scale(9.1,9.1);let dropCounter=0,dropInterval=1e3,lastTime=0;function update(e=0){dropCounter+=e-lastTime,dropCounter>dropInterval&&playerDrop(),lastTime=e,draw(),requestAnimationFrame(update)}function updateScore(){checkHiscore(),document.getElementById("score").innerText=player.score}document.addEventListener("keydown",(e=>{37===e.keyCode||65===e.keyCode?playerMove(-1):68===e.keyCode||39===e.keyCode?playerMove(1):40===e.keyCode||83===e.keyCode?playerDrop():(e.keyCode,playerRotate(-1))}));const colors=[null,"#FF0D72","#0DC2FF","#0DFF72","#F538FF","#FF8E0D","#FFE138","#3877FF"];function pauseGame(){gamePaused?gamePaused&&(game=setTimeout(gameLoop,1e3/30),gamePaused=!1):(game=clearTimeout(game),gamePaused=!0)}const arena=createMatrix(12,20),player={pos:{x:0,y:0},matrix:null,score:0};function dragElement(e){var t=0,o=0,r=0,n=0;function a(e){(e=e||window.event).preventDefault(),r=e.clientX,n=e.clientY,document.onmouseup=c,document.onmousemove=l}function l(a){(a=a||window.event).preventDefault(),t=r-a.clientX,o=n-a.clientY,r=a.clientX,n=a.clientY,e.style.top=e.offsetTop-o+"px",e.style.left=e.offsetLeft-t+"px"}function c(){document.onmouseup=null,document.onmousemove=null}document.getElementById(e.id+"header")?document.getElementById(e.id+"header").onmousedown=a:e.onmousedown=a}function checkHiscore(){player.score>parseInt(localStorage.getItem("highscore"),10)?(localStorage.setItem("highscore",player.score),document.getElementById("hi-score").innerHTML=localStorage.getItem("highscore")):document.getElementById("hi-score").innerHTML=localStorage.getItem("highscore")}document.addEventListener("keydown",(function(e){13===event.keyCode&&(playerReset(),updateScore(),update(),checkHiscore(),dropCounter=0,player.score=0),document.body.className="none"})),dragElement(document.getElementById("container")),checkHiscore()</script>