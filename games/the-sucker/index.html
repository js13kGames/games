<!doctype html><title>The Sucker - js13kGames 2012</title><style>body,html{width:100%;height:100%}body,div,html{background:#000;margin:0;padding:0}.cv,.cvs{width:1278px;height:720px;position:relative}.cv{position:absolute;top:0;left:0;border:6px solid #111}#noise{z-index:5}#sucker{z-index:4}#gore{z-index:3}#frenzy_bg{z-index:-1}#bg{z-index:1}#i{margin:20px 0 10px;color:#333;text-align:left}#l{position:absolute;top:0;left:0;right:0;bottom:0;background:#000;z-index:10}#l div{text-align:center;position:absolute;top:50%;left:0;width:100%;margin-top:-1.2em;color:#999}#m{color:#333}#m>div{display:inline-block;margin:0 5px;cursor:pointer}#m>div:hover{color:#999}.mt{margin:0 20px}</style><div id=cvs class=cvs><div id=l><div>please wait..</div></div></div><div class=mt><div id=i></div><form id=m name=m><div>options:</div><div id=t_sfx>sound<div></div></div><div id=t_noise>noise<div></div></div><div id=t_gore>gore layer<div></div></div><div id=b_lvl>blood level<select name=b_lvl></select></div></form></div><script>function p(a){function p(a){return[255&a,a>>8&255,a>>16&255,a>>24&255]}function t(a){return[255&a,a>>8&255]}this.data=[],this.wav=[],this.dataURI="",this.header={chunkId:[82,73,70,70],chunkSize:0,format:[87,65,86,69],subChunk1Id:[102,109,116,32],subChunk1Size:16,audioFormat:1,numChannels:1,sampleRate:8e3,byteRate:0,blockAlign:0,bitsPerSample:8,subChunk2Id:[100,97,116,97],subChunk2Size:0},this.Make=function(a){a instanceof Array&&(this.data=a),this.header.blockAlign=this.header.numChannels*this.header.bitsPerSample>>3,this.header.byteRate=this.header.blockAlign*this.sampleRate,this.header.subChunk2Size=this.data.length*(this.header.bitsPerSample>>3),this.header.chunkSize=36+this.header.subChunk2Size,this.wav=this.header.chunkId.concat(p(this.header.chunkSize),this.header.format,this.header.subChunk1Id,p(this.header.subChunk1Size),t(this.header.audioFormat),t(this.header.numChannels),p(this.header.sampleRate),p(this.header.byteRate),t(this.header.blockAlign),t(this.header.bitsPerSample),this.header.subChunk2Id,p(this.header.subChunk2Size),16==this.header.bitsPerSample?function(a){for(var p=[],t=0,e=a.length,i=0;i<e;i++)p[t++]=255&a[i],p[t++]=a[i]>>8&255;return p}(this.data):this.data),this.dataURI="data:audio/wav;base64,"+e.Encode(this.wav)},a instanceof Array&&this.Make(a)}var e={chars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",encLookup:[],Init:function(){for(var a=0;a<4096;a++)this.encLookup[a]=this.chars[a>>6]+this.chars[63&a]},Encode:function(a){for(var p,t,e=a.length,i="",r=0;2<e;)n=a[r]<<16|a[r+1]<<8|a[r+2],i+=this.encLookup[n>>12]+this.encLookup[4095&n],e-=3,r+=3;return 0<e&&(t=(252&a[r])>>2,p=(3&a[r])<<4,1<e&&(p|=(240&a[++r])>>4),i=(i+=this.chars[t])+this.chars[p],2==e&&(t=(15&a[r++])<<2,i+=this.chars[t|=(192&a[r])>>6]),1==e&&(i+="="),i+="="),i}};e.Init(),window.onload=function(){window.app={},app.local_storage=function(){return"localStorage"in window&&null!==window.localStorage},app.load_cfg=function(a){return a=localStorage.getItem(a),!(!app.local_storage||!a)&&JSON.parse(a)},app.save_cfg=function(a,p){if(!app.local_storage)return!1;localStorage.setItem(a,JSON.stringify(p))},app.create_cv=function(a,p,t,e,i){var r={};return app.cv||(app.cv={}),r.cv=document.createElement("canvas"),r.cv.width=p,r.cv.height=t,r.ctx=r.cv.getContext("2d"),e&&(app.cv[a]=r),i&&(document.getElementById("cvs").appendChild(r.cv),r.cv.setAttribute("width",p),r.cv.setAttribute("height",t),r.cv.setAttribute("id",a),r.cv.setAttribute("class","cv")),r},app.init_cv=function(a,p,t,e,i,r){if(p)app.create_cv(a,t,e,i,r);else{if(app.cv[a].cv=document.getElementById(a),!app.cv[a].cv||!app.cv[a].cv.getContext)return!1;app.cv[a].ctx=app.cv[a].cv.getContext("2d")}},app.gen_sfx_data=function(a,p,t,e){for(var i,r=[],s=0;s<a+t;s++)a<=s?r[s]=128:(i=s<p?s/p:a-p<=s?1-(s-a+p-1)/p:1,r[s]=Math.round(128+e(s)*i));return r},app.gen_audio_elem=function(a){return a=new p(a),new Audio(a.dataURI)},app.play_sfx=function(a){if(0==app.url_params.sfx)return!1;app.sfx[a].play()},app.fps_tout_fn=function(){app.last_fps=app.fps,app.fps=0},app.grant_achv=function(a,p,t,e){var i=app.achv;i[a][0]+=e,clearTimeout(app[a+"_tout"]),i[a][0]===p?(app.toggle_bool(a+"_medal",3e3,!0),i[a][0]=0,i[a][1]+=1,app.play_sfx("exp_1")):app.set_timeout(a+"_tout",function(){i[a][0]=0},t)},app.toggle_bool=function(a,p,t,e,i){void 0===e&&(e=app),void 0===t&&(t=!1),e[a]=t,clearTimeout(e[a+"_tout"]),e[a+"_tout"]=setTimeout(function(){e[a]=!t,i&&i()},p)},app.set_timeout=function(a,p,t){app[a+"_tout"]=setTimeout(p,t)},app.init_frnz_assets=function(){if(1===app.url_params.gore){app.draw_level(app.cv.frenzy_bg.ctx);for(var a=app.cv.frenzy_bg.ctx.getImageData(0,0,app.w,app.h).data,p=a.length,t=app.cv.frenzy_bg.ctx.createImageData(app.w,app.h),e=t.data,i=0;i<p;i+=4)e[i]=a[i],e[i+1]=0,e[i+2]=0,e[i+3]=255;app.cv.frenzy_bg.ctx.putImageData(t,0,0)}},app.init_noise=function(){if(1===app.url_params.noise){var a,p=app.create_cv("pat_cv",240,240),t=p.ctx;app.noise_frames=[];for(var e=app.noise_rate=app.crnt_noise_frame=0;e<16;e+=1){t.clearRect(0,0,p.cv.width,p.cv.height);for(var i=0;i<p.cv.height;i+=6)for(var r=0;r<p.cv.width;r+=6)Math.random()<.5&&(a=Math.random()/2,Math.round(64*Math.random()),t.fillStyle="rgba("+Math.round(30*Math.random())+","+Math.round(30*Math.random())+","+Math.round(30*Math.random())+","+a+")",t.fillRect(r,i,6,6));app.noise_frames.push(app.cv.noise.ctx.createPattern(p.cv,"repeat"))}}},app.draw_noise=function(a){1===app.url_params.noise&&(1===app.noise_rate?(app.noise_rate=0,a.clearRect(0,0,app.w,app.h),a.fillStyle=app.noise_frames[app.crnt_noise_frame],a.fillRect(0,0,app.w,app.h),app.crnt_noise_frame=app.crnt_noise_frame+1===app.noise_frames.length?0:app.crnt_noise_frame+1):app.noise_rate+=1)},app.create_obj=function(a,p){var a=new app[a],t=0<app[a.type+"_id"].length?app[a.type+"_id"].pop():app[a.type].length;return a.id=t,p&&p(a),app[a.type][t]=a},app.remove_obj=function(a){app[a.type+"_id"].push(a.id),delete app[a.type][a.id]},app.update_bot_track=function(a,p){var t=app.bot_track;t.spawn[a]+=p?1:0,t.kill[a]+=p?0:1,t.alive[a]+=p?1:-1,t.alive_count+=p?1:-1},app.spawn_bot=function(a){var p,t=app.create_obj("Bot"),e=.5<Math.random()?0:1;for(p in t.b_t=a||0,t.dir=e,t.dx_max+=.3*app.wave,.7<Math.random()?(t.x=Math.random()*app.w,t.y=-t.h/2):(t.y=Math.random()*app.h,t.x=-t.w/2),app.bot_types[a])t[p]=app.bot_types[a][p];t.anim="bot_walk_"+app.bot_types[a].skin+"_1",app.update_bot_track(a,!0)},app.update_player=function(){var a=app.plr;a.left||a.right?a.anim="player_run_"+a.skin:a.anim="player_idle_"+a.skin,a.update_pos(),a.update_anim_frame(),a.move(),a.update_jump(),a.start_fall(),a.lvl_pads_coll(),a.lvl_bnds_coll(),a.update_phs(),a.bots_coll(),a.update_grab(),a.update_attack(),a.update_hp()},app.set_screen_shake=function(a,p){app.shake_tout||(app.shake=!0,app.shake_d=p||2,clearTimeout(app.shake_tout),app.shake_tout=setTimeout(function(){app.shake=!1,delete app.shake_tout},a))},app.action_mngr=function(){var t=0;if(!app.can_spawn||app.wave_break||app.bot_track.alive_count>=app.max_bot_count+Math.min(app.wave_tmr/15,10))return!1;app.toggle_bool("can_spawn",app.bot_spawn_delay),app.bot_track.alive[0]<Math.max(app.wave/2.2-app.wave/4*(app.wave/app.wave_peak),2)||app.wave<1?t=0:app.bot_chances.forEach(function(a,p){Math.random()<a&&(t=p+1)}),app.spawn_bot(t)},app.on_wave_start=function(){app.plr.dx_max<15&&(app.plr.dx_max+=1),app.max_bot_count=Math.floor(app.wave*app.bot_count_fn[0]+app.bot_count_fn[1]),app.bot_spawn_delay=Math.max(125,1500-150*app.wave),app.bot_chances_fn.forEach(function(a,p){app.bot_chances[p]=a[0]*(app.wave/app.wave_peak)+a[1]}),app.wave_tmr=0},app.update=function(){var p=app.plr;switch(app.fps+=1,app.game_state){case-1:case 0:break;case 1:app.tmr+=.033,app.wave_tmr+=.033,app.update_player(),app.bot.forEach(function(a){a.can_move||!1===app.plr.is_grab||app.plr.is_grab!==a.id?(a.move(),a.lvl_pads_coll(),a.lvl_bnds_coll(),a.update_phs(),a.update_jump(),a.update_pos()):a.lvl_pads_coll(),a.php=a.hp,a.hp+=a.dhp,a.dhp<0&&a.sht_p("Blood",a.x,a.y,0,2*Math.PI,15,-a.dhp*(app.plr.frenzy?2:4),-a.dhp),a.hp<=0?(this.can_move&&!1===this.pad_coll&&app.update_hud_msg("aerial killer!!!"),p.update_kill_ct(),a.destroy()):a.dhp=0,0!==a.b_t&&(a.anim=a.anim.slice(0,a.anim.length-1)+(.5<Math.random()?1:2)),a.update_anim_frame()}),app.blood.forEach(function(a){a.update_phs(),a.update_pos()}),app.body_part.forEach(function(a){a.update_phs(),a.update_pos(),a.lvl_pads_coll(),a.update_anim_frame()}),!0===app.shake?(app.shake_x=-6*app.shake_d+app.round(6*Math.random()*app.shake_d+6),app.shake_y=-6*app.shake_d+app.round(6*Math.random()*app.shake_d+6)):app.shake_y=app.shake_x=0,app.shake&&(app.cvs.style.top=app.shake_y+"px",app.cvs.style.left=app.shake_x+"px"),app.cv.frenzy_bg.cv.style.zIndex=1,app.cv.frenzy_bg.cv.style.opacity=(app.plr.frenzy?3:0)*(.3*Math.random()+.1),!1!==app.plr.frenzy_end&&(app.cv.frenzy_bg.cv.style.opacity=1,app.wave+=1,app.on_wave_start()),app.plr.frenzy&&!app.frenzy_sfx&&app.url_params.sfx&&(app.frenzy_sfx=setInterval(function(){app.plr.frenzy?app.play_sfx("frenzy"):delete app.frenzy_sfx},100)),app.action_mngr();break;case 2:if(app.b_sum)app.bot.forEach(function(a){a.update_anim_frame(!0)});else{app.b_sum=[];for(var a=0;a<4;a+=1)app.spawn_bot(a),app.b_sum[a]=app.bot[app.bot.length-1],app.b_sum[a].x=0,app.b_sum[a].y=0}(p.left||p.right||p.jump||p.down)&&!app.summary_menu_select_tout&&(app.select_smr_m(!0),app.toggle_bool("summary_menu_select_tout",300,!0)),app.smr_hvr_y&&p.attack&&!app.smr_active_tout&&(app.smr_hvr_x?app.tweet_score():app.restart_game())}},app.num_to_roman=function(a){if(100<=a)return!1;var p,t="",e="",i={x:p=10<=a?Math.floor(a/10):0,i:a-=10*p};if(i.x)if(10===i.x)t="c";else if(9===i.x)t+="xc";else if(5<i.x&&(t+="l",i.x-=5),3<i.x){e="",i.x-=3;for(var r=0;r<i.x;r+=1)e="x"+e;t+=e+="l"}else for(r=0;r<i.x;r+=1)t="x"+t;if(i.i)if(9===i.i)t+="ix";else if(4<i.i)for(t+="v",i.i-=5,r=0;r<i.i;r+=1)t+="i";else if(4===i.i)t+="iv";else for(r=0;r<i.i;r+=1)t+="i";return t},app.draw_text=function(a,p,t,e,i,r,s,o){var n;p+="",i=i||0,r=r||0,s=s?8*p.length*6*(o?4:1)/2:0,a.save(),a.translate(app.round(t-s),app.round(e));for(var _=0;_<p.length;_+=1)n=app.cv["f_"+p[_]+(o?"_roman_big":"")].cv,0<_&&a.translate(n.width+6,0),a.drawImage(n,app.round(-i/2+Math.random()*i*6),app.round(-r/2+Math.random()*r*6));a.restore()},app.draw_hud_msg=function(t,e,i){0<app.msg.length&&app.msg.forEach(function(a,p){app.draw_text(t,a,app.round(app.w/2-8*a.length*6/2),app.round(app.h/8)+12+6*p*10,e||0,i||0)})},app.reset_game_stngs=function(){app.tmr=0,app.wave_tmr=app.wave=0,app.ckill=!(app.can_spawn=!(app.shake=app.wave_break=!1)),app.achv={crusher:[app.ckill_max_pts=app.ckill_max_count=app.ckill_count=app.ckill_pts_buff=0,0],feeder:[0,0],grinder:[0,0]},app.bot=[],app.bot_id=[],app.bot_track={kill:[0,0,0,0],spawn:[0,0,0,0],alive:[0,0,0,0],alive_count:0},app.bot_types=[{skin:"normal",dmg:0,dx_max:10,hp:100},{skin:"green",dmg:.47,dx_max:11,hp:125},{skin:"red",dmg:1,dx_max:12,hp:150},{skin:"blue",dmg:1.5,dx_max:13,hp:175}],app.blood=[],app.blood_id=[],app.blood_buff=[],app.body_part=[],app.body_part_id=[],app.plr=new app.Plr,app.plr.x=app.w/2,app.plr.y=app.h/2,app.bot_chances=[]},app.update_hud_msg=function(a){""!==a&&(app.msg.push(a),1<app.msg.length)&&app.msg.shift(),clearTimeout(app.msg_tout),app.msg_tout=setTimeout(function(){0<app.msg.length&&(app.msg.shift(),app.update_hud_msg(""))},3e3)},app.draw_start_screen=function(a){a.save(),a.translate(0,app.h/2-24),app.draw_text(a,"press j to start",app.w/2,0,2,2,!0),a.restore()},app.draw_hud=function(a){var p=app.w-60,t=app.round(p/3);app.round(p/4),a.save(),a.translate(30,30),a.drawImage(app.cv.h_heart.cv,0,0),a.fillStyle=app.plr.pdhp&&0!==app.plr.pdhp&&.5<Math.random()?"#fff":"#f00",a.fillRect(66,0,app.round((t-90)*(app.plr.hp/100)),48),a.translate(t,0),a.drawImage(app.cv.h_score.cv,0,0),app.draw_text(a,Math.floor(app.plr.score*(app.wave+1)),60,0),a.translate(t,0),a.drawImage(app.cv.h_skull.cv,0,0),app.draw_text(a,Math.floor(app.plr.kill_count),48,0),a.translate(t/2,0),a.drawImage(app.cv.h_tmr.cv,0,0),app.draw_text(a,Math.floor(app.tmr),60,0),a.restore(),app.draw_hud_msg(a,2,2),app.plr.frenzy?a.fillStyle="rgba(255,0,0,"+.2*Math.random()+")":app.plr.pdhp<-.36?a.fillStyle="rgba(255,0,0,"+Math.random()/3+")":a.fillStyle="rgba(0,0,0,"+.2*Math.random()+")",a.fillRect(0,0,app.w,app.h),app.wave_break?(a.save(),a.translate(0,80),app.draw_text(a,"wave",app.w/2,app.h/2-190,2,2,!0),app.draw_text(a,app.num_to_roman(app.wave+1),app.w/2,app.h/2,4,4,!0,!0),a.restore()):app.plr.frenzy_start?app.draw_text(a,"kill frenzy!!!",app.w/2,app.h/2+70,2,2,!0):app.ckill_record_msg?app.draw_text(a,"combo "+app.ckill_max_count+" kills ("+app.ckill_max_pts+"pts)",app.w/2,app.h/2+70,2,2,!0):app.crusher_medal?app.draw_achv(a,"crusher"):app.feeder_medal?app.draw_achv(a,"feeder"):app.grinder_medal&&app.draw_achv(a,"grinder")},app.draw_achv=function(a,p){app.draw_text(a,p+"! (x"+app.achv[p][1]+")",app.w/2,app.h/2+70,2,2,!0)},app.round=function(a,p){return a-a%(p||6)},app.draw=function(p){var a=app.plr;switch(p.fillStyle="#000",p.clearRect(0,0,app.w,app.h),app.game_state){case-1:app.draw_start_screen(p);break;case 0:app.draw_text(p,app.intro_msg[0]+" (j)",app.w/2,app.h/2-24,2,2,!0);break;case 1:p.fillStyle="#000",p.clearRect(0,0,app.w,app.h),p.fillStyle="#fff",app.bot.forEach(function(a){p.save(),0===a.dir&&(p.scale(-1,1),p.translate(app.round(-2*a.x),0)),p.translate(app.round(a.x-a.sw/2),app.round(a.y-a.sh/2)),a.can_move||(p.rotate(3*Math.PI/2),p.translate(-a.sw,0)),a.draw_anim_frame(p,0,0),p.restore()}),app.body_part.forEach(function(a){p.save(),0===a.dir&&(p.scale(-1,1),p.translate(app.round(-2*a.x),0)),p.translate(app.round(a.x-a.sw/2),app.round(a.y-a.sh/2)),a.draw_anim_frame(p,a.sw/2,a.sh/2),p.restore()}),app.blood.forEach(function(a){p.fillStyle="rgb("+(128+Math.floor(128*Math.random()))+", 0, 0)",p.fillRect(app.round(a.x),app.round(a.y),a.w,a.h)}),p.save(),0===a.dir&&(p.scale(-1,1),p.translate(app.round(-2*a.x),0)),p.translate(app.round(a.x-a.sw/2),app.round(a.y-a.sh/2)),a.frenzy||a.pdhp<-.9?a.anim=a.anim.split("_frenzy_")[0]+"_frenzy_white_"+(.5<Math.random()?1:2):a.anim=a.anim.split("_frenzy_")[0]+"_frenzy_white_1",a.draw_anim_frame(p,0,0),p.restore(),app.draw_hud(p),app.draw_gore_fx(app.cv.gore.ctx),app.draw_level(app.cv.bg.ctx);break;case 2:app.draw_summary(p),p.fillStyle="#fff",app.smr_hvr_y&&(p.fillStyle="rgba(255,0,0,"+(.2+.4*Math.random())+")",p.fillRect(app.smr_hvr_x,app.smr_hvr_y,app.w/2,60))}app.draw_noise(app.cv.noise.ctx)},app.draw_level=function(r,a){var s,o=app.level;if(r.level_layer&&!a)return!1;r.level_layer=!0,r.clearRect(0,0,app.w,app.h),r.save(),s=r.createPattern(app.cv.wall_1.cv,"repeat"),r.fillStyle=s,r.fillRect(0,0,app.w,app.h),o.pads.forEach(function(a,p){var t=app.round(a.w),e=o.pad_h;r.save(),r.translate(app.round(a.x),app.round(a.y)),s=r.createPattern(app.cv.pad_1.cv,"repeat"),r.fillStyle="#000",r.fillRect(12,12,t,e);for(var i=0;i<t;i+=6)r.fillRect(i,e,6,6*Math.floor(10*Math.random()));r.fillStyle=s,r.fillRect(0,0,t,e),r.restore()}),r.restore()},app.draw_gore_fx=function(p){1===app.url_params.gore&&(app.blood_buff.forEach(function(a){0<a.x&&0<a.y&&a.x<app.w&&a.y<app.h&&Math.random()<.25&&p.drawImage(app.cv.frenzy_bg.cv,app.round(a.x),app.round(a.y),6,6,app.round(a.x),app.round(a.y),6,6)}),app.blood_buff=[])},app.draw_summary=function(t){t.save(),t.fillStyle="#000",t.fillRect(0,0,app.w,app.h),t.translate(app.round(app.w/2),30),app.draw_text(t,"game over!:(",0,0,2,2,!0),t.translate(0,120),app.draw_text(t,"rank:#"+Math.floor(app.plr.rank)+" score:"+app.plr.score,0,0,2,2,!0),app.draw_text(t,"time:"+Math.floor(app.tmr)+" wave:"+(app.wave+1),0,60,2,2,!0),app.draw_text(t,"kills:"+app.plr.kill_count,0,120,2,2,!0),t.translate(-app.w/2,180),app.b_sum&&app.b_sum.forEach(function(a,p){t.save(),t.translate(p*((app.w-60)/6)+app.w/4-48,0),a.draw_anim_frame(t),app.draw_text(t,app.bot_track.kill[p],60,0,2,2),t.restore()}),t.translate(app.w/2,-120),app.draw_text(t,"combo "+app.ckill_max_count+" kills ("+app.ckill_max_pts+"pts)",0,180,2,2,!0),app.draw_text(t,"crusher:"+app.achv.crusher[1]+" feeder:"+app.achv.feeder[1],0,240,2,2,!0),app.draw_text(t,"grinder:"+app.achv.grinder[1],0,300,2,2,!0),t.translate(0,120),app.draw_text(t,"play again : tweet score",0,300,2,2,!0),t.restore()},app.loop=function(){app.update(),app.draw(app.cv.sucker.ctx)},app.save_h_score=function(a){app.h_scores.push(a)},app.end_game=function(){var p=1,t=app.plr;t.score=t.score*(app.wave+1),this.game_state=2,app.h_scores.forEach(function(a){a.score>t.score&&(p+=1)}),t.rank=p,clearInterval(t.move_sfx),clearInterval(t.frenzy_sfx),1===p&&(app.clr_keys(),app.smr_hvr_y=0,app.prompt_tout=setTimeout(function(){t.name=prompt("New best! Enter your name"),app.save_h_score({name:t.name||"unnamed",score:t.score,kills:t.kill_count,kill_types:app.bot_track.kill,time:app.tmr,ckill_max_count:app.ckill_max_count,ckill_max_pts:app.ckill_max_pts,achv:app.achv}),app.save_cfg("sucker_hs",app.h_scores)},50)),app.toggle_bool("smr_active_tout",2e3,!0,app,app.clr_keys())},app.pause=function(){clearInterval(app.loop_interval),delete app.loop_interval},app.start=function(){app.loop_interval||(app.loop_interval=setInterval(app.loop,33))},app.load_sfx=function(){for(var a in app.sfx={},app.sfx_data={footstep_1:{fn:function(a){return Math.round(8*Math.random())},d:400},footstep_2:{fn:function(a){return Math.round(10*Math.random())},d:400},footstep_3:{fn:function(a){return Math.round(6*Math.random())},d:400},hurt:{fn:function(a){return Math.round(16*(a/32%2==0?1:-1))},d:200},jump:{fn:function(a){return Math.round(Math.cos(Math.PI/2*(a/1200))*Math.sin(a/(10-a/1200*5))*32)},d:1200},idle_attack:{fn:function(a){return Math.round(((0<Math.sin(a/1e3)?1:-1)*Math.random()*2+2*Math.sin(a/128))*Math.sin(4*Math.PI/800*a)*2)},d:400},grab:{fn:function(a){return Math.round(32*Math.sin(a/(32-a/1e3*16)*Math.PI)+2*Math.random()*Math.sin(Math.PI*(a/1e3)+Math.PI/6))},d:1e3},feed:{fn:function(a){return Math.round(Math.sin(Math.PI*(a/500))*Math.sin(a/(10-a/500*5))*32)},d:400},exp_1:{fn:function(a){return Math.round(32*Math.sin(a/(32-a/4e3*16)*Math.PI)*Math.sin(Math.PI*(a/800)))},d:4e3},pad_hit_1:{fn:function(a){return Math.round(64*Math.sin(2*Math.PI*((a+Math.random())/(20+20*a/250)))+4*Math.random())},d:250},frenzy:{fn:function(a){return Math.round(Math.cos(Math.PI/2*(a/1e3))*Math.cos(a/(2-a/1e3*1))*4+Math.cos(a/20)*Math.sin(2*Math.PI*(a/1e3))*64)+Math.round(Math.sin(Math.PI*(a/1e3/2))*Math.sin(a/(10-a/1e3/2*5))*32*Math.sin(2*Math.PI*(a/1e3)))},d:1e3}},app.sfx_data){var p=app.gen_sfx_data(app.sfx_data[a].d,100,100,app.sfx_data[a].fn);app.sfx[a]=app.gen_audio_elem(p)}},app.restart_game=function(){app.game_state=1,app.reset_game_stngs(),app.on_wave_start(),app.cv.gore.ctx.clearRect(0,0,app.w,app.h)},app.parse_score=function(a){for(var p="",t=(a+="").length,e=0;e<t;e+=3)p=","+a.slice(Math.max(a.length-3,0))+p,a=a.slice(0,Math.max(a.length-3,0));return p.slice(1)},app.tweet_score=function(){var a="https://twitter.com/intent/tweet?hashtags=js13kGames&original_referer="+window.location.href+"&source=tweetbutton&text=I%20scored%20"+app.parse_score(app.plr.score)+"%20points%20over%20"+(app.wave+1)+"%20wave"+(0<app.wave?"s ":"")+"%20in%20%22The%20Sucker%22%20game%2C%20a%20js13kGames%20entry%20-%20&url=http%3A%2F%2Fether-wp.com%2Fdistillery%2Fsucker%2F&via=pordesign";window.open(a,"","height=600,width=800")},app.select_smr_m=function(a){app.plr,(a||624<app.my&&app.my<684)&&(app.smr_hvr_y=624,app.smr_hvr_x=a?app.smr_hvr_x?0:app.w/2:app.w/2<app.mx?app.w/2:0)},app.img_from_data=function(a,i,r){var s,p,t,o,e=a[0],n=a[2],_=a[1].split(" "),h=n?app.gfx_subtypes[n]:{df:"df"};for(o in i=i||1,r=r||1,p=6*_[0].length*i,t=6*_.length*r,h)s=app.create_cv(e+("df"!==o?"_"+o:""),p,t,!0),_.forEach(function(a,p){for(var t=a.length,e=0;e<t;e+=1)s.ctx.fillStyle="df"!==o&&"e"===_[p][e]?h[o]:app.gfx_pal[_[p][e]],s.ctx.fillRect(6*e*i,6*p*r,6*i,6*r)})},app.load_gfx=function(){app.gfx_subtypes={player:{frenzy_white_1:"rgba(255,255,255,1)",frenzy_white_2:"rgba(255,0,0,1)"},bot:{normal_1:"rgba(141,128,101,1)",green_1:"rgba(213,133,18,1)",green_2:"rgba(171,79,24,1)",red_1:"rgba(200,0,0,1)",red_2:"rgba(255,77,33,1)",blue_1:"rgba(40,129,175,1)",blue_2:"rgba(203,89,228,1)"}},app.gfx_data=[["h_heart","011101110 112111111 121111111 111111111 011111110 001111100 000111000 000010000"],["h_vial","111111 012110 012110 012110 012110 012110 011110 001100"],["h_skull","011110 112111 121111 100100 101101 011011 000010 000110"],["h_tmr","01111110 11211111 12111111 11110001 11101111 11101111 11101111 01111110"],["h_wave","00011010 00210010 00110010 10010210 11110110 00111111 01100100 01001000"],["h_score","00010000 00011000 00121000 11221111 01111110 00111100 01101100 01000100"],["f_ ","00000000"],["f_0","011110 011110 110011 110011 110011 110011 011110 011110"],["f_1","011100 001100 001100 001100 001100 001100 001100 001100"],["f_2","011110 011110 110011 110111 000110 011000 111111 111111"],["f_3","011100 011100 000011 001111 001100 000011 011111 011100"],["f_4","110000 110000 110000 110110 110110 111111 111111 000110"],["f_5","111110 111110 110000 111110 011110 000011 111111 111110"],["f_6","011110 011110 110000 111110 111110 110011 110011 011110"],["f_7","111110 111110 000110 011110 011000 011000 111000 110000"],["f_8","011110 011110 110011 111111 011110 110011 111111 011110"],["f_9","011110 011110 110011 111111 011111 000011 011111 011110"],["f_a","0111110 1110111 1110111 1111111 1110111 1110111 1110111"],["f_b","1111110 1110111 1110111 1111110 1110111 1110111 1111110"],["f_c","0111110 1110111 1110000 1110000 1110000 1110111 0111110"],["f_d","1111110 1110111 1110111 1110111 1110111 1110111 1111110"],["f_e","0111111 1110111 1110000 1111100 1110000 1110111 0111111"],["f_f","0111111 1110111 1110000 1111100 1110000 1110000 1110000"],["f_g","0111110 1110111 1110000 1110111 1110111 1110111 0111110"],["f_h","1110111 1110111 1110111 1111111 1110111 1110111 1110111"],["f_i","1111111 0011100 0011100 0011100 0011100 0011100 1111111"],["f_j","1111111 0000111 0000111 0000111 0000111 1110111 1111110"],["f_k","1110111 1110111 1110111 1111110 1110111 1110111 1110111"],["f_l","1110000 1110000 1110000 1110000 1110000 1110111 0111111"],["f_m","1100011 1110111 1111111 1111111 1110111 1110111 1110111"],["f_n","1111110 1110111 1110111 1110111 1110111 1110111 1110111"],["f_o","0111110 1110111 1110111 1110111 1110111 1110111 0111110"],["f_p","1111110 1110111 1110111 1111110 1110000 1110000 1110000"],["f_q","0111110 1110111 1110111 1110111 1110111 0111110 0000111"],["f_r","1111110 1110111 1110111 1111111 1111110 1110111 1110111"],["f_s","0111111 1110111 1110000 0111110 0000111 1110111 1111110"],["f_t","1111111 0011100 0011100 0011100 0011100 0011100 0011100"],["f_u","1110111 1110111 1110111 1110111 1110111 1110111 0111110"],["f_w","1110111 1110111 1110111 1110111 1111111 1110111 1100011"],["f_v","1110111 1110111 1110111 1110111 1110111 0111110 0011100"],["f_x","1110111 1110111 0111110 0011100 0111110 1110111 1110111"],["f_y","1110111 1110111 1111111 0111111 0000111 1110111 1111110"],["f_z","1111111 1110111 0000111 0111110 1110000 1110111 1111111"],["f_!","0001100 0001100 0001100 0001100 0001100 0000000 0001100"],["f_+","0000000 0001100 0001100 0111111 0001100 0001100 0000000"],["f_(","0001100 0011000 0110000 0110000 0110000 0011000 0001100"],["f_)","0110000 0011000 0001100 0001100 0001100 0011000 0110000"],["f_:","0000000 0000000 0011000 0000000 0000000 0011000 0000000"],["f_?","0011110 0110011 0000011 0000110 0001100 0000000 0001100"],["f_.","0000000 0000000 0000000 0000000 0000000 0110000 0110000"],["f_,","0000000 0000000 0000000 0000000 0011000 0011000 0110000"],["f_'","0001100 0000100 0001000 0000000 0000000 0000000 0000000"],["f_#","0000000 0110110 1111111 0110110 0110110 1111111 0110110"],["pad_1","45669459 5789n89n 889n33n3 9n334679 679n6793 9nn39n33"],["wall_1","bc3i3cci33c3c33c c3c3c3cb3c3i3c33 3i3c3ciic3i3i3i3 c3c3c3cb3c3c3c3c 3c3iccchccc3c3c3 c3c3c3kbbk333i3c 3c33ckbcimm3c3c3 c33icbiccccc3c3c 3ccb3mic3cbllcc3 cmcmlbc33ic33cmc 33cicccmcmb3c3c3 3c33cm3cbb3c333c c3ic33cklc33c33i 3c3c3icbc3c33c33 33i3c3ch3i3i33c3 i33c3ccbc3c3c33c"],["player_run","00000000000000e00000000e0000000000000000e000000000e000 00000e0000000ee0000000ee00000000e000000ee00000000ee000 000eee0e00000ee000000eee000000eee0e0000eee0000000ee000 00eee0e000000ee0000000eee0000e0eee0000eee00000000ee000 0000e00000000e00000000ee0000000ee000000e000000000ee000 000ee00000000ee000000ee0e000000e0000000ee0000000ee0e00 0ee00e000000eee000000e00e00000eee00000eee0000000e00e00 000000e0000000e00000e00e0000ee000e000000e000000e000000 000000e0000000e00000e000000000000e000000e000000e000000","player"],["player_idle","00000000000000e000 00000e0000000e0000 0000e0000000eee000 000eee00000e0e0e00 00e0e0e000000e0000 0000e00000000e0000 000e0e000000e0e000 000e0e000000e0e000 000e00e00000e00e00","player"],["bot_walk","000000000000e000000e0000000000e00000 00000e000000e0000000e000000000e00000 0000e0000000e000000eeee0000000e00000 000ee000000eee0000e0e000000000ee0000 000e0e00000ee00000e0e000000000e00000 000e00000000e00000000e00000000e00000 00e0e0000000e00000000ee000000ee00000 00e00e0000000e000000e00000000e0e0000 00000e0000000e000000e00000000e00e000","bot"],["body_part_1","0f0000f0000f000f0000e0000e0000e0000e0000f000 0e000e0000e00ee0ee000e0000e00e0000e0f0000e00 0e000e000e00e00000ef00e000e00e00fe000ee000e0 0e00e000e00000000000000f00f0f0000000000e00e0","bot"],["body_part_2","0000000000000000 0f0000f000000e00 0e000e000ef000f0 0000000000000000","bot"],["body_part_3","0000000000000000 0f000ff00ff000f0 0ff00f0000f00ff0 0000000000000000","bot"]],app.gfx_pal={0:"rgba(0, 0, 0, 0)",1:"rgba(255, 0, 0, 1)",2:"rgba(255, 244, 195, 1)",3:"rgba(0, 0, 0, 1)",4:"rgba(132, 132, 112, 1)",5:"rgba(114, 115, 100, 1)",6:"rgba(87, 89, 77, 1)",7:"rgba(69, 71, 61, 1)",8:"rgba(50, 50, 40, 1)",9:"rgba(35, 35, 28, 1)",b:"rgba(28, 24, 17, 1)",c:"rgba(11, 8, 6, 1)",h:"rgba(35, 33, 28, 1)",i:"rgba(24, 20, 17, 1)",k:"rgba(43, 37, 30, 1)",l:"rgba(23, 20, 16, 1)",m:"rgba(23, 20, 13, 1)",n:"rgba(15, 15, 12, 1)",e:"rgba(138, 138, 138, 1)",f:"rgba(129, 0, 0, 1)"},app.gfx_data.forEach(function(a){switch(app.img_from_data(a),a[0]){case"f_x":case"f_i":case"f_v":a[0]+="_roman_big",app.img_from_data(a,4,4)}})},app.init_keys=function(){app.kdwn_ct=0,window.onkeydown=function(a){if(!app.k_pressed||!1===app.k_pressed)switch(a.keyCode){case 38:case 87:app.plr.jump=!0;break;case 83:case 40:case 76:case 90:case 32:app.plr.down=!0;break;case 74:case 67:app.plr.attack=!0;break;case 37:case 65:app.plr.left=!0;break;case 39:case 68:app.plr.right=!0;break;case 88:case 75:app.plr.grab=!0}app.kdwn_ct+=1},window.onkeyup=function(a){switch(a.keyCode){case 38:case 87:app.plr.jump=!1;break;case 83:case 40:case 76:case 90:case 32:app.plr.down=!1;break;case 37:case 65:app.plr.left=!1;break;case 39:case 68:app.plr.right=!1;break;case 74:case 67:-1===app.game_state?app.game_state=0:0===app.game_state&&(app.intro_msg.shift(),app.play_sfx("jump"),0===app.intro_msg.length)&&(app.game_state=1,app.toggle_bool("wave_break",3e3,!0)),app.plr.attack=!1;break;case 88:case 75:app.plr.grab=!1}--app.kdwn_ct}},app.clr_keys=function(){["left","right","jump","down","attack","grab"].forEach(function(a){app.plr[a]=!1})},app.init_mouse=function(){window.onmousemove=function(a){app.prev_mx=app.mx||0,app.prev_my=app.my||0,app.mx=a.pageX,app.my=a.pageY,app.mxd=app.prev_mx-app.mx,app.myd=app.prev_my-app.my,2===app.game_state&&app.select_smr_m()},window.onclick=function(a){app.plr,2===app.game_state&&624<app.my&&app.my<684&&(app.mx<app.w/2?app.restart_game():app.tweet_score())},window.onblur=function(){app.clr_keys(),app.pause()},window.onfocus=function(){app.start()}},app.update_url=function(){var a,p=window.location.href.split("?")[0]+"?";for(a in app.url_params)p+=a+"="+app.url_params[a]+"&";p=p.slice(0,p.length-1),window.location.href=p},app.init_html_menu=function(){for(var a=document.m.b_lvl,p=0;p<=9;p+=1)a.options[p]=new Option(p+(3===p?" (default)":""),p,!1,p===app.url_params.blood_level);[["sfx","sound"],["noise","noise"],["gore","gore layer"]].forEach(function(a){var p=document.getElementById("t_"+a[0]);p.onclick=function(){if(1===app.game_state&&!confirm("Sure?"))return!1;app.url_params[a[0]]=app.url_params[a[0]]?0:1,p.innerHTML=a[1]+" "+(1==app.url_params[a[0]]?"on":"off"),app.update_url()},p.innerHTML=a[1]+" "+(1==app.url_params[a[0]]?"on":"off")}),a.onchange=function(){app.url_params.blood_level=a.selectedIndex,app.update_url()},document.getElementById("i").innerHTML="WSAD/ARROWS - move, J/C - feed, K/X - grab, fall - S/DOWN/SPACE, jump - W/UP"},app.content_loaded=function(){return!0},app.update_url_params=function(){var p;app.url_params={sfx:1,noise:1,gore:1,blood_level:3},-1!==window.location.href.indexOf("?")&&(str=window.location.href.split("?")[1].split("&").forEach(function(a){p=a.split("="),app.url_params[p[0]]&&(app.url_params[p[0]]=+p[1]==p[1]?+p[1]:p[1])}))},app.load_content=function(){app.load_content_start=!0,app.load_gfx(),1==app.url_params.sfx&&app.load_sfx()},app.close_overlay=function(){document.getElementById("l").style.display="none"},app.init_app=function(){app.load_content_start?(app.w=1278,app.h=720,app.cv_list=["bg","frenzy_bg","gore","sucker","noise"],app.cv_list.forEach(function(a){app.init_cv(a,!0,app.w,app.h,!0,!0)}),app.cvs=document.getElementById("cvs"),app.init_noise(),app.fps=0,app.game_state=-1,app.ckill_msg=["double","triple","quadruple","quintuple","sextuple","septuple","octuple","nonuple","decuple","undecuple","duodecuple"],app.intro_msg=["hello.. stranger!","your objective..","kill, eat and score!"],app.lp=120,app.level={w:app.w,h:app.h,pads:[{x:app.w/9,y:0,w:app.w/9*3-32},{x:app.w/9*5+32,y:0,w:app.w/9*3},{x:-app.lp,y:app.h/2,w:app.w/9*2+app.lp},{x:app.w/3,y:app.h/2,w:app.w/3},{x:app.w/9*7,y:app.h/2,w:app.w/9*2+app.lp},{x:-app.lp,y:app.h-36,w:app.w/9*4+app.lp},{x:app.w/9*5,y:app.h-36,w:app.w/9*4+app.lp}],pad_h:36},app.wave_peak=20,app.bot_count_fn=[1,2],app.bot_chances_fn=[[.66,.15],[.88,-.3],[1.15,-.75]],app.reset_game_stngs(),app.msg=[],app.init_keys(),app.init_mouse(),app.init_frnz_assets(),app.on_wave_start(),app.start(),app.play_sfx("jump"),app.h_scores=app.load_cfg("sucker_hs")||[],app.fps_tout=setInterval(app.fps_tout_fn,1e3)):(app.update_url_params(),app.init_html_menu(),app.load_content(),app.l_ct_intrvl=setInterval(function(){app.content_loaded()&&(app.init_app(),app.close_overlay(),clearInterval(app.l_ct_intrvl))},50))},app.Coll_Obj=function(){return this.x=app.w/2,this.y=app.h/2,this.w=42,this.h=54,this.dx=0,this.dy=0,this.dx_max=10,this.dy_max=18,this.pad_coll=!1,this.bounce=0,this},app.Coll_Obj.prototype.proj_out_y=function(a,p){var t=app.level;0<a.y+t.pad_h/2-this.y?(this.y=a.y-this.h/2,this.reload_jump(),this.pad_coll=p,"player"===this.type&&18<=this.dy&&(app.play_sfx("pad_hit_1"),app.set_screen_shake(80*(36<this.dy?3:1),2*(36<this.dy?2:1)),36<this.dy)&&this.bot_coll.forEach(function(a){a.special_kill(1)}),"bot"!==this.type||this.can_move||app.plr.is_grab.id===this.id||(26<this.dy?(this.special_kill(0),app.play_sfx("pad_hit_1")):this.can_move=!0)):(this.y=a.y+t.pad_h+this.h/2,"bot"===this.type&&!this.can_move&&this.dy<-10&&(this.special_kill(0),app.play_sfx("pad_hit_1")),"player"===this.type&&(app.play_sfx("pad_hit_1"),app.set_screen_shake(80),this.disable_keep_jump())),this.dy=2<Math.abs(-this.dy*this.bounce)?-this.dy*this.bounce:0},app.Coll_Obj.prototype.lvl_pads_coll=function(){var t=app.level,e=!1;this.pad_coll=!1,px_min=this.x-this.w/2,px_max=this.x+this.w/2,py_min=this.y-this.h/2,py_max=this.y+this.h/2,px_min_prev=px_min-this.dx,px_max_prev=px_max-this.dx,py_min_prev=py_min-this.dy,py_max_prev=py_max-this.dy,t.pads.forEach(function(a,p){if(!0===e)return!1;(py_min<a.y&&py_max>a.y||py_min<a.y+t.pad_h&&py_max>a.y+t.pad_h)&&(px_min>a.x&&px_min<a.x+a.w||px_max>a.x&&px_max<a.x+a.w)&&(px_min>a.x&&px_max<a.x+a.w?this.proj_out_y(a,p):px_min<a.x?px_max_prev<=a.x?("bot"===this.type&&this.dx>this.dx_max&&this.special_kill(0),this.x=a.x-this.w/2,this.dx=0):this.proj_out_y(a,p):px_max>a.x+a.w&&(px_min_prev>=a.x+a.w?("bot"===this.type&&this.dx<-this.dx_max&&this.special_kill(0),this.x=a.x+a.w+this.w/2,this.dx=0):this.proj_out_y(a,p)),e=!0)},this)},app.Coll_Obj.prototype.lvl_bnds_coll=function(){var a=this,p=app.level;a.out_of_level_bounds=!1,a.x<0-a.w/2?(a.out_of_level_bounds=!0,a.x=p.w+a.w/2):a.x>p.w+a.w/2&&(a.out_of_level_bounds=!0,a.x=-a.w/2),a.y<36?(a.out_of_level_bounds=!0,"player"===a.type&&(a.y=36,this.disable_keep_jump(),this.dy=0)):a.y>p.h+a.h/2&&(a.out_of_level_bounds=!0,a.y=-a.h/2)},app.Coll_Obj.prototype.bots_coll=function(){this.bot_coll=[],app.bot.forEach(function(a,p){Math.abs(this.x-a.x)<this.sw&&Math.abs(this.y-a.y)<this.sh&&this.bot_coll.push(a)},this),this.is_grab||(this.b_0=this.bot_coll[0])},app.Coll_Obj.prototype.start_fall=function(){!0===this.down&&this.disable_keep_jump()},app.Coll_Obj.prototype.start_jump=function(){!0===this.jump&&!1===this.jump_lock&&!1!==this.pad_coll&&(this.jump_lock=!0,app.play_sfx("jump"))},app.Coll_Obj.prototype.keep_jump=function(){!0===this.jump&&!0===this.jump_lock?this.jump_duration<this.jump_time&&(this.jump_duration+=1,this.dy-=this.jump_force):!1===this.jump&&!0===this.jump_lock&&(this.jump_duration=this.jump_time)},app.Coll_Obj.prototype.disable_start_jump=function(){!0===this.jump&&!1===this.jump_lock&&(this.jump_lock=!0)},app.Coll_Obj.prototype.disable_keep_jump=function(){!0===this.jump_lock&&(this.jump_duration=2*this.jump_time)},app.Coll_Obj.prototype.reload_jump=function(){!0===this.jump_lock&&(this.jump_lock=!1,this.jump_duration=0)},app.Coll_Obj.prototype.update_jump=function(){"player"===this.type?(this.start_jump(),this.keep_jump()):"bot"===this.type&&!1!==this.pad_coll&&Math.random()>.995-.025*app.wave/app.wave_peak&&(this.dy-=26+5*app.wave/app.wave_peak)},app.Coll_Obj.prototype.update_anim_frame=function(a){if(Math.abs(this.dx)<.5&&Math.abs(this.dy)<.5&&"player"!==this.type&&!a)return!1;this.anim_interval+=1,this.anim_interval===this.anim_rate&&(frame_count=Math.round(app.cv[this.anim].cv.width/this.sw),this.anim_frame=this.anim_frame>=frame_count-1?0:this.anim_frame+1,this.anim_interval=0)},app.Coll_Obj.prototype.draw_anim_frame=function(a,p,t){void 0===p&&(p=this.x),void 0===t&&(t=this.y),a.drawImage(app.cv[this.anim].cv,this.anim_frame*this.sw,0,this.sw,this.sh,p,t,this.sw,this.h)},app.Coll_Obj.prototype.move=function(){var a;switch(this.type){case"player":this.left||this.right?(this.is_moving=!0,this.on_move(this.left?0:1),a=this.dx_max*(this.move_duration/this.move_time),this.dx=Math.min(a,this.dx_max)*(this.dir?1:-1)):(this.is_moving=!1,this.move_duration=0);break;case"bot":a=this.dx_max/2,!0===this.can_move&&(!1!==this.pad_coll?(0===this.dir&&(a=-a),Math.abs(this.dx)<this.dx_max/4&&(this.dx+=a)):this.do_random_dir=!0,"undefined"!==this.do_random_dir)&&!0===this.do_random_dir&&!1!==this.pad_coll&&(this.do_random_dir=!1,this.dir=.4<Math.random()?this.dir?0:1:this.dir)}},app.Coll_Obj.prototype.update_phs=function(){!1===this.pad_coll?("player"===this.type&&!1===this.left&&!1===this.right?this.dx=.94*this.dx:"bot"===this.type&&(this.dx=.99*this.dx),!0===this.jump_lock&&!0===this.jump&&0!==this.jump_duration&&this.jump_duration<this.jump_time&&this.dy<0?this.dy_max=36:(!0===this.down?this.dy_max=42:this.dy_max=18,this.dy<this.dy_max||"player"!==this.type?this.dy+=2.5*(this.down?2:1):this.dy=this.dy_max),"bot"===this.type?this.can_move?this.dy>this.dy_max&&(this.dy=this.dy_max):(this.dy>this.h-10&&(this.dy=this.h-10),this.dy<-(this.h-10)&&(this.dy=-(this.h-10))):"player"===this.type&&this.dy<-this.dy_max&&(this.dy=-this.dy_max)):((!1===this.left&&!1===this.right||"player"!==this.type)&&(this.dx=.6*this.dx,Math.abs(this.dx)<.2)&&(this.dx=0),!1!==this.jump&&"bot"!==this.type||(this.dy=2.8))},app.Coll_Obj.prototype.update_pos=function(){this.x+=this.dx,this.y+=this.dy},app.Coll_Obj.prototype.destroy=function(){"player"!==this.type&&(app[this.type+"_id"].push(this.id),delete app[this.type][this.id]),this.on_destroy&&this.on_destroy()},app.Coll_Obj.prototype.sht_p=function(a,p,t,e,i,r,s,o,n){var _,h,l;if(s+=Math.floor(Math.random()*o||0),void 0!==this.dir&&1===this.dir&&(e=-e),e-=Math.PI/2,"Blood"===a){if(0===app.url_params.blood_level)return!1;3!==app.url_params.blood_level&&app.url_params.blood_level<10&&(o=(s=s*app.url_params.blood_level/3)*app.url_params.blood_level/3)}for(var c=0;c<s;c+=1)h=e-i/2+Math.random()*i,l=r*(Math.random()+.3),(_=app.create_obj(a,n)).x=p,_.y=t,_.dx+=Math.cos(h)*l,_.dy+=Math.sin(h)*l-l/2},app.Plr=function(){return this.rank=0,this.type="player",this.dir=1,this.w=22,this.sw=54,this.sh=54,this.hp=30,this.dhp=0,this.skin="frenzy_white_1",this.anim="player_run_frenzy_white_1",this.anim_frame=0,this.anim_rate=3,this.anim_interval=0,this.jump_time=13,this.jump_duration=0,this.jump_force=8,this.jump_lock=!1,this.grab_rld=!1,this.bot_coll=[],this.frenzy=!1,this.frenzy_start=!1,this.frenzy_end=!1,this.kill_count=0,this.move_time=10,this.move_duration=0,this.is_grab=!1,this.score=0,this},app.Plr.prototype=new app.Coll_Obj,app.Plr.prototype.update_grab=function(){!0===this.grab&&!1===this.grab_rld&&(!this.is_grab&&this.b_0?(this.b_0.can_move=!1,this.is_grab=this.b_0,app.toggle_bool("grab_rld",300,!0,this),app.play_sfx("grab")):this.is_grab?(this.is_grab=!1,this.throw_item(this.b_0),app.toggle_bool("grab_rld",300,!0,this),app.play_sfx("grab")):this.b_0||this.frenzy||app.play_sfx("idle_attack")),this.is_grab&&(this.b_0.x=this.x+(0===this.dir?1:-1),this.b_0.y=this.y-this.h/2-6,this.b_0.dx=this.dx,this.b_0.dy=this.dy,this.b_0.dir=this.dir)},app.Plr.prototype.throw_item=function(a){a.dx+=this.dx+10*(0===this.dir?-1:1)+app.wave/2*(this.frenzy?2:1),a.dy+=-15*(this.frenzy?3:1)+this.dy,a.dy<-a.h&&(a.dy=-a.h)},app.Plr.prototype.on_move=function(a){var p,t=this;this.last_dir=this.dir,this.dir=a,this.dir===this.last_dir?this.move_duration<this.move_time&&(this.move_duration+=1):this.move_duration=0,!1!==t.pad_coll&&app.url_params.sfx&&!t.frenzy&&(p="footstep_"+Math.ceil(2.99*Math.random()),t.move_duration<2&&app.play_sfx(p),t.move_sfx||t.frenzy||(t.move_sfx=setInterval(function(){!t.is_moving||!1===t.pad_coll||t.frenzy||t.attack?(clearInterval(t.move_sfx),delete t.move_sfx):app.play_sfx(p)},240)))},app.Plr.prototype.update_attack=function(){this.attack&&this.b_0?(this.b_0.dhp-=this.frenzy?20:3.5,this.b_0.hp-this.b_0.dhp<0&&this.is_grab&&delete this.is_grab,this.dhp+=this.frenzy?0:.45*(0!==this.b_0.b_t?.5:1),app.play_sfx("feed")):this.attack&&!this.frenzy&&app.play_sfx("idle_attack")},app.Plr.prototype.update_kill_ct=function(){this.kill_count+=1,this.is_grab=!1},app.Plr.prototype.update_hp=function(){this.frenzy?(this.dhp-=.24,this.hp<30&&(this.frenzy=!1,app.toggle_bool("frenzy_end",1,!0,this,function(){app.toggle_bool("wave_break",3e3,!0)})),this.sht_p("Blood",this.x,this.y,Math.PI/4,Math.PI/4,40,5,10)):100<this.hp?(this.hp=100,this.frenzy=!0,app.toggle_bool("frenzy_start",1500,!0,this)):0<this.hp?(this.b_0&&!app.wave_break&&this.bot_coll.forEach(function(a){this.dhp-=a.dmg,0<a.dmg&&app.play_sfx("hurt")},this),30<this.hp&&(this.dhp-=.024)):app.end_game(),this.hp+=this.dhp,this.pdhp=this.dhp,this.dhp=0},app.Plr.prototype.update_stats=function(a){app.ckill_count+=1,app.ckill_pts_buff+=(10+5*a.b_t)*(1+app.wave/5)*app.ckill_count,1<app.ckill_count&&app.update_hud_msg((app.ckill_count<=app.ckill_msg.length?app.ckill_msg[app.ckill_count-2]+" kill!":app.ckill_count+" killstreak!")+" (+"+app.ckill_pts_buff+"pts)"),app.plr.score+=(10+5*a.b_t)*(1+app.wave/5)*app.ckill_count,app.toggle_bool("ckill",2500,!0,app,function(){app.ckill_count>app.ckill_max_count&&(app.ckill_max_count=app.ckill_count,1<app.ckill_count)&&(app.toggle_bool("ckill_record_msg",app.wave_break?5e3:3e3,!0),app.play_sfx("exp_1")),app.ckill_max_pts<app.ckill_pts_buff&&(app.ckill_max_pts=app.ckill_pts_buff),app.ckill_pts_buff=app.ckill_count=0})},app.Bot=function(){return this.type="bot",this.dhp=0,this.hp=100,this.anim="bot_walk",this.anim_frame=0,this.anim_rate=3,this.anim_interval=0,this.sw=54,this.sh=54,this.dir=0,this.is_attacked=!1,this.can_move=!0,this.dy_max=16,this.dx_max=10,this},app.Bot.prototype=new app.Coll_Obj,app.Bot.prototype.on_destroy=function(){var a=this;app.plr.frenzy||(app.plr.dhp+=-this.dhp/4.5+4*this.b_t),-21<this.dhp&&app.grant_achv("feeder",2,2500,this.dhp<-10?.2:1),this.sht_p("Blood",this.x,this.y,0,2*Math.PI,30,app.plr.frenzy?200:100,100),this.sht_p("Body_Part",this.x-this.dx,this.y-this.dy,0,2*Math.PI,15,8,3,function(p){p.dir=Math.floor(2*Math.random()),p.anim="body_part_"+Math.ceil(3*Math.random())+"_"+app.bot_types[a.b_t].skin+"_1",p.timer_events.forEach(function(a){p.timers||(p.timers=[]),p.timers.push(setInterval(a[1],a[0]))}),p.on_destroy=function(){p.timers.forEach(function(a){clearInterval(a)})}}),app.set_screen_shake(150),app.plr.update_stats(this),app.update_bot_track(this.b_t,!1),app.play_sfx("exp_1")},app.Bot.prototype.special_kill=function(a){0===a?(this.dhp-=75*(app.plr.frenzy?2:1),app.grant_achv("crusher",3,1250,1)):1===a&&(this.can_move&&(this.dx+=10*(this.x<app.plr.x?-1:1),this.dy-=20,this.pad_coll=!1,this.y-=5),this.dhp-=75*(app.plr.frenzy?2:1),app.grant_achv("grinder",3,1250,1))},app.Blood=function(){var a=this;this.type="blood",this.w=6,this.h=6,this.destroy_timeout=setTimeout(function(){app.blood_buff.push({x:a.x,y:a.y}),a.destroy()},100+750*Math.random())},app.Blood.prototype=new app.Coll_Obj,app.Body_Part=function(){var a=this;this.type="body_part",this.w=24,this.h=24,this.sw=24,this.sh=24,this.anim="body_part_1",this.anim_frame=0,this.anim_rate=3,this.anim_interval=0,this.bounce=.5,this.timer_events=[[30,function(){a.sht_p("Blood",a.x,a.y,0,Math.PI,10,1,1)}]],this.destroy_timeout=setTimeout(function(){a.destroy()},1500+2e3*Math.random())},app.Body_Part.prototype=new app.Coll_Obj,app.init_app()}</script>