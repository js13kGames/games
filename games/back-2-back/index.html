<html><head><meta charset='utf-8'><style>body{display:flex;justify-content:center;align-items:center;background-color:#111}</style><meta name="monetization" content="$coil.xrptipbot.com/0bcd44aa-fa2d-4aa6-aee1-d66959908e23"></head><body><canvas id="canvas"></canvas><script>
function registerFontFunctions(t){t.drawFontCenter=function(t,a,e,i){var s=a-t.length/2*6*i
this.drawFont(t,s,e,i)},t.drawFontRight=function(t,a,e,i){var s=a-6*t.length*i
this.drawFont(t,s,e,i)},t.drawFont=function(t,a,e,i){for(var s=this.fonts[this.fonts.current],r=0,n=t.length;n>r;r++)this.drawLetter(s,t[r],a+r*(s.width+1)*i,e,i)},t.drawLetter=function(t,a,e,i,s){var s=s||1,a=a.toLowerCase(),r=t.characters[a]
if(!r)throw Error("Character "+a+" is not in font")
for(var n=0;n<t.height;n++)for(var o=0;o<t.width;o++)void 0!==r[n][o]&&("number"==typeof r[n][o]&&(this.fillStyle=this.fonts.palettes[this.fonts.palette][r[n][o]]),this.fillRect(o*s+e,n*s+i,s,s))},t.setPalette=function(t){this.fonts.palette=t}}function registerFonts(t){var a=!0
t.fonts={current:"alphanumeric",palette:0,palettes:[["#000","#333","#666","#7c7","#afa","#fff"],["#000","#333","#666","#68f","#acf","#fff"],["#000000","#333333","#666666","#999999","#cccccc","#ffffff"],["#000000","#ac3232","#df7126","#fbf236","#ffffff"],["#000000","#3232ac","#2671df","#36f2fb","#ffffff"]],alphanumeric:{height:7,width:5,characters:{a:[[,,a,,],[,a,,a],[a,,,,a],[a,,,,a],[a,a,a,a,a],[a,,,,a],[a,,,,a]],b:[[a,a,a,a],[a,,,,a],[a,,,,a],[a,a,a,a],[a,,,,a],[a,,,,a],[a,a,a,a]],c:[[,a,a,a],[a,,,,a],[a,,,,],[a,,,,],[a,,,,],[a,,,,a],[,a,a,a]],d:[[a,a,a,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,a,a,a]],e:[[a,a,a,a,a],[a,,,,],[a,,,,],[a,a,a,a],[a,,,,],[a,,,,],[a,a,a,a,a]],f:[[a,a,a,a,a],[a,,,,],[a,,,,],[a,a,a,a],[a,,,,],[a,,,,],[a,,,,]],g:[[,a,a,a],[a,,,,a],[a,,,,],[a,,,,],[a,,a,a,a],[a,,,,a],[,a,a,a]],h:[[a,,,,a],[a,,,,a],[a,,,,a],[a,a,a,a,a],[a,,,,a],[a,,,,a],[a,,,,a]],i:[[,a,a,a],[,,a,,],[,,a,,],[,,a,,],[,,a,,],[,,a,,],[,a,a,a]],j:[[,a,a,a,a],[,,,a],[,,,a],[,,,a],[,,,a],[a,,,a],[,a,a,,]],k:[[a,,,,a],[a,,,a],[a,,a,,],[a,a,,,],[a,,a,,],[a,,,a],[a,,,,a]],l:[[a,,,,],[a,,,,],[a,,,,],[a,,,,],[a,,,,],[a,,,,],[a,a,a,a,a]],m:[[a,,,,a],[a,a,,a,a],[a,,a,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a]],n:[[a,,,,a],[a,,,,a],[a,a,,,a],[a,,a,,a],[a,,,a,a],[a,,,,a],[a,,,,a]],o:[[,a,a,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[,a,a,a]],p:[[a,a,a,a],[a,,,,a],[a,,,,a],[a,a,a,a],[a,,,,],[a,,,,],[a,,,,]],q:[[,a,a,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,a,,a],[a,,,a,a],[,a,a,a,a]],r:[[a,a,a,a],[a,,,,a],[a,,,,a],[a,a,a,a],[a,,a,,],[a,,,a],[a,,,,a]],s:[[,a,a,a],[a,,,,a],[a,,,,],[,a,a,a],[,,,,a],[a,,,,a],[,a,a,a]],t:[[a,a,a,a,a],[,,a,,],[,,a,,],[,,a,,],[,,a,,],[,,a,,],[,,a,,]],u:[[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[,a,a,a]],v:[[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[,a,,a],[,a,,a],[,,a,,]],w:[[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,a,,a],[a,a,,a,a],[a,,,,a]],x:[[a,,,,a],[a,,,,a],[,a,,a],[,,a,,],[,a,,a],[a,,,,a],[a,,,,a]],y:[[a,,,,a],[a,,,,a],[,a,,a],[,,a,,],[,,a,,],[,,a,,],[,,a,,]],z:[[a,a,a,a,a],[,,,,a],[,,,a],[,,a,,],[,a,,,],[a,,,,],[a,a,a,a,a]],0:[[,a,a,a],[a,,,,a],[a,,,a,a],[a,,a,,a],[a,a,,,a],[a,,,,a],[,a,a,a]],1:[[,a,a,,],[,,a,,],[,,a,,],[,,a,,],[,,a,,],[,,a,,],[,a,a,a]],2:[[,a,a,a],[a,,,,a],[,,,a],[,,a,,],[,a,,,],[a,,,,],[a,a,a,a,a]],3:[[,a,a,a],[a,,,,a],[,,,,a],[,,a,a],[,,,,a],[a,,,,a],[,a,a,a]],4:[[,,,a],[,,a,a],[,a,,a],[a,,,a],[a,a,a,a,a],[,,,a],[,,,a]],5:[[a,a,a,a,a],[a,,,,],[a,,,,],[a,a,a,a],[,,,,a],[a,,,,a],[,a,a,a]],6:[[,a,a,a],[a,,,,a],[a,,,,],[a,a,a,a],[a,,,,a],[a,,,,a],[,a,a,a]],7:[[a,a,a,a,a],[,,,,a],[,,,a],[,,,a],[,,a,,],[,,a,,],[,,a,,]],8:[[,a,a,a],[a,,,,a],[a,,,,a],[,a,a,a],[a,,,,a],[a,,,,a],[,a,a,a]],9:[[,a,a,a],[a,,,,a],[a,,,,a],[,a,a,a,a],[,,,,a],[a,,,,a],[,a,a,a]]," ":[[,,,,],[,,,,],[,,,,],[,,,,],[,,,,],[,,,,],[,,,,]],",":[[,,,,],[,,,,],[,,,,],[,,,,],[,,,,],[,,a,,],[,a,,,]],".":[[,,,,],[,,,,],[,,,,],[,,,,],[,,,,],[,,,,],[,a,,,]],"!":[[,,a,,],[,,a,,],[,,a,,],[,,a,,],[,,a,,],[,,,,],[,,a,,]],":":[[,,,,],[,,a,,],[,,,,],[,,,,],[,,,,],[,,a,,],[,,,,]],"=":[[,,,,],[,,,,],[a,a,a,a,a],[,,,,],[a,a,a,a,a],[,,,,],[,,,,]],"≺":[[,,,,a],[,,a,a],[a,a,,,],[,,,,],[a,a,,,],[,,a,a],[,,,,a]],"≡":[[,,,,],[a,a,a,a,a],[,,,,],[a,a,a,a,a],[,,,,],[a,a,a,a,a],[,,,,]],"?":[[,a,a,a],[a,,,,a],[,,,,a],[,,a,a],[,,a,,],[,,,,],[,,a,,]],"-":[[,,,,],[,,,,],[,,,,],[a,a,a,a,a],[,,,,],[,,,,],[,,,,]],"@":[[,a,a,a],[a,,,a,a],[a,,a,,a],[a,,a,,a],[a,,a,a],[a,,,,],[,a,a,a]],"'":[[,a,,,],[,,a,,],[,,,,],[,,,,],[,,,,],[,,,,],[,,,,]],"₂":[[,,,,],[,,,,],[,,,,],[,a,a,,],[,,,a],[,,a,,],[,a,a,a]],"→":[[,,,,],[,,a,,],[,,,a],[a,a,a,a,a],[,,,a],[,,a,,],[,,,,]],"←":[[,,,,],[,,a,,],[,a,,,],[a,a,a,a,a],[,a,,,],[,,a,,],[,,,,]],"↑":[[,,,,],[,,a,,],[,a,a,a],[a,,a,,a],[,,a,,],[,,a,,],[,,,,]],"↓":[[,,,,],[,,a,,],[,,a,,],[a,,a,,a],[,a,a,a],[,,a,,],[,,,,]],"(":[[,,,a],[,,a,,],[,a,,,],[,a,,,],[,a,,,],[,,a,,],[,,,a]],")":[[,a,,,],[,,a,,],[,,,a],[,,,a],[,,,a],[,,a,,],[,a,,,]],"↶":[[,,a,a],[,a,,,a],[,a,,,],[a,a,a,,],[,a,,,],[,,,,],[,,,,]],"↷":[[,a,a,,],[a,,,a],[,,,a],[,,a,a,a],[,,,a],[,,,,],[,,,,]],"/":[[,,,a],[,,,a],[,,a,,],[,,a,,],[,,a,,],[,a,,,],[,a,,,]],"☐":[[a,a,a,a,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,,,,a],[a,a,a,a,a]],"☑":[[a,a,a,a,a],[a,,,,a],[a,a,,a,a],[a,,a,,a],[a,a,,a,a],[a,,,,a],[a,a,a,a,a]],">":[[,,,,],[,a,,,],[,,a,,],[,,,a],[,,a,,],[,a,,,],[,,,,]],"[":[[,a,a,a],[,a,,,],[,a,,,],[,a,,,],[,a,,,],[,a,,,],[,a,a,a]],"]":[[,a,a,a],[,,,a],[,,,a],[,,,a],[,,,a],[,,,a],[,a,a,a]],"&":[[,,a,,],[,a,,a],[,a,,a],[,a,a,,],[a,,a,,a],[a,,,a],[,a,a,,a]],"♥":[[,,,,],[,a,,a],[a,a,a,a,a],[a,a,a,a,a],[,a,a,a],[,,a,,],[,,,,]]}},gameSprite:{height:16,width:16,characters:{".":[[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,1,1,1,,,,],[,,,,,,,1,1,2,3,3,1,,,],[,,,,,,1,1,2,3,4,3,1,,,],[,,,,,,,1,1,2,2,1,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,]],">":[[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,1,1,1,,,,,],[,,,,,,1,1,2,3,3,2,,,,],[,,,,1,1,2,2,3,4,4,3,2,,,],[,,,1,1,2,2,3,4,4,4,3,2,,,],[,,,,,1,1,1,2,3,3,2,,,,],[,,,,,,,,1,1,1,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,]],m:[[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,2,2,,,,,,,,,,,,,],[,1,3,2,,,2,2,2,2,,,,,,],[,,4,3,2,2,3,3,3,3,2,2,2,,,],[,,4,3,3,3,4,4,4,4,3,3,3,2,2],[,,4,3,3,3,4,4,4,4,3,3,3,2,2],[,,4,3,2,2,3,3,3,3,2,2,2,,,],[,1,3,2,,,2,2,2,2,,,,,,],[,2,2,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,]],s:[[,1,1,1,1,1,,,,,1,1,1,1,,],[1,2,2,2,2,2,1,1,1,1,2,2,2,3,1,1],[4,3,3,3,3,3,2,1,2,2,2,2,2,2,3,1],[1,2,2,2,2,2,1,2,2,2,2,1,1,1,1],[,1,1,1,1,1,2,2,2,2,1,,,,,],[,,,1,2,2,2,2,1,1,1,1,1,1,1,1],[,1,1,1,2,2,2,1,2,3,4,4,1,,,],[,1,3,2,2,2,1,2,3,4,4,4,4,1,,],[,1,3,2,2,2,1,2,3,4,4,4,4,1,,],[,1,1,1,2,2,2,1,2,3,4,4,1,,,],[,,,1,2,2,2,2,1,1,1,1,1,1,1,1],[,1,1,1,1,1,2,2,2,2,1,,,,,],[1,2,2,2,2,2,1,2,2,2,2,1,1,1,1],[4,3,3,3,3,3,3,1,2,2,2,2,2,2,3,1],[1,2,2,2,2,2,1,1,1,1,2,2,2,3,1,1],[,1,1,1,1,1,,,,,1,1,1,1,,]],w:[[,1,1,1,,,,,,,,,,,,],[,1,2,1,1,1,1,1,1,1,1,1,1,,,],[,1,2,2,2,2,4,4,4,4,4,1,1,1,,],[1,1,2,2,2,2,1,1,1,1,1,1,,,,],[3,2,1,1,1,1,,,,,,,,,,],[3,2,2,2,2,1,1,1,1,1,1,1,,,,],[1,1,2,2,2,2,2,2,2,2,2,2,1,1,1],[,1,4,1,4,1,4,1,4,1,2,3,3,3,3,1],[,1,4,1,4,1,4,1,4,1,2,3,3,3,3,1],[1,1,2,2,2,2,2,2,2,2,2,2,1,1,1],[3,2,2,2,2,1,1,1,1,1,1,1,,,,],[3,2,1,1,1,1,,,,,,,,,,],[1,1,2,2,2,2,1,1,1,1,1,1,,,,],[,1,2,2,2,2,4,4,4,4,4,1,1,1,,],[,1,2,1,1,1,1,1,1,1,1,1,1,,,],[,1,1,1,,,,,,,,,,,,]],q:[[,,,,,,1,1,1,1,,,,,,],[,,1,1,1,1,2,2,2,3,1,,,,,],[1,,,,1,2,2,2,2,2,3,1,,,,],[3,1,1,1,2,2,2,2,2,1,1,1,1,,,],[3,2,2,1,2,2,2,2,1,2,2,2,2,1,,],[3,2,2,1,1,1,2,1,2,2,4,4,2,2,1],[1,1,1,1,2,2,1,2,2,1,3,4,4,2,2,1],[,1,2,2,2,2,1,2,2,1,2,4,4,4,1,1],[,1,2,2,2,2,1,2,2,1,2,4,4,4,1,1],[1,1,1,1,2,2,1,2,2,1,3,4,4,2,2,1],[3,2,2,1,1,1,2,1,2,2,4,4,2,2,1],[3,2,2,1,2,2,2,2,1,2,2,2,2,1,,],[3,1,1,1,2,2,2,2,2,1,1,1,1,,,],[1,,,,1,2,2,2,2,2,3,1,,,,],[,,1,1,1,1,2,2,2,3,1,,,,,],[,,,,,,1,1,1,1,,,,,,]],k:[[,,,,1,1,1,1,1,,,,,,,],[,,1,1,1,3,3,3,3,1,1,1,,,,],[,1,2,2,1,2,2,2,2,3,3,3,1,1,,],[,1,2,1,3,2,2,2,2,2,2,2,3,3,1],[1,2,2,1,2,2,1,1,1,1,1,1,1,2,3,1],[1,2,1,3,2,2,2,2,2,2,2,2,2,2,2,1],[1,1,3,3,2,2,2,1,1,1,1,1,1,1,1,1],[4,1,4,4,3,2,1,,,,,,,,,],[4,1,4,4,3,2,1,,,,,,,,,],[1,1,3,3,2,2,2,1,1,1,1,1,1,1,1,1],[1,2,1,3,2,2,2,2,2,2,2,2,2,2,2,1],[1,2,2,1,2,2,1,1,1,1,1,1,1,2,3,1],[,1,2,1,3,2,2,2,2,2,2,2,3,3,1],[,1,2,2,1,2,2,2,2,3,3,3,1,1,,],[,,1,1,1,3,3,3,3,1,1,1,,,,],[,,,,1,1,1,1,1,,,,,,,]],o:[[,,1,1,1,1,1,,,,,,,,,],[1,1,1,3,3,3,1,1,1,,,,,,,],[4,2,2,2,2,2,3,3,3,1,1,1,,,,],[1,1,2,2,2,2,2,2,2,2,2,,,,,],[,1,1,1,2,2,2,2,1,,,,,,,],[,,,,1,2,2,2,1,1,1,,,,,],[,,,,1,3,3,3,2,2,1,1,1,1,1],[,,,1,3,4,4,4,3,2,3,2,3,2,3,1],[,,,1,3,4,4,4,3,2,3,2,3,2,3,1],[,,,,1,3,3,3,2,2,1,1,1,1,1],[,,,,1,2,2,2,1,1,1,,,,,],[,1,1,1,2,2,2,2,1,,,,,,,],[1,1,2,2,2,2,2,2,2,2,2,,,,,],[4,2,2,2,2,2,3,3,3,1,1,1,,,,],[1,1,1,3,3,3,1,1,1,,,,,,,],[,,1,1,1,1,1,,,,,,,,,]],h:[[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,1,1,,1,1,,,,,,,,,],[,,1,3,1,1,2,1,,,,,,,,],[,,1,3,3,1,1,1,1,1,1,,,,,],[,,1,3,3,3,1,2,2,2,2,1,,,,],[,,,1,3,3,3,1,3,4,4,4,4,,,],[,,,1,1,3,3,1,3,4,4,4,4,,,],[,,,1,2,1,1,2,2,2,2,2,1,,,],[,,,1,2,2,2,2,2,1,1,1,1,,,],[,,,,1,2,2,2,2,2,2,2,1,,,],[,,,,,1,1,1,1,1,1,1,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,]],t:[[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,1,1,1,,,,,,,,,,,],[,1,1,1,1,1,,,,,,,,,,],[,1,1,1,1,1,1,,,,,,,,,],[,1,1,1,1,1,1,1,1,1,,,,,,],[,1,1,1,2,2,2,2,2,2,1,,,,,],[,1,1,1,2,2,2,2,2,2,2,1,,,,],[,1,1,1,1,2,2,1,1,1,1,1,,,,],[,1,1,1,1,2,2,2,2,2,2,1,,,,],[,1,1,1,1,2,2,1,1,1,1,1,,,,],[,1,1,1,1,2,2,2,2,2,2,1,,,,],[,1,1,1,1,1,1,1,1,1,1,,,,,],[,1,1,1,1,1,,,,,,,,,,],[,,1,1,1,,,,,,,,,,,],[,,,,,,,,,,,,,,,]],a:[[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,1,1,1,,,,,,,,,,],[,,1,3,3,3,1,,,,,,,,,],[,1,2,2,2,3,1,,,,,,,,,],[,1,2,2,2,2,1,1,1,1,1,1,1,1,1,1],[,1,1,2,2,1,3,3,3,3,3,3,4,4,3,1],[,1,2,1,1,1,1,1,1,1,3,3,3,3,3,1],[,1,2,2,2,2,1,2,2,2,1,1,1,1,1,1],[,1,2,2,2,2,1,2,2,1,,1,2,2,1],[,,1,1,1,1,1,1,1,,,,1,1,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,]],l:[[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,1,1,1,1,1,,,,,,,],[,,,1,3,3,3,3,3,1,1,1,,,,],[,,,1,2,1,2,2,2,3,3,3,1,,,],[,,,1,2,2,2,2,2,2,2,2,1,,,],[,,,,1,1,1,1,1,2,2,1,,,,],[,,,,,1,1,2,2,2,1,1,1,,,],[,,,,1,2,2,2,1,1,1,2,3,1,,],[,,,,1,2,3,1,,,1,2,2,3,1],[,,,,1,3,1,,,,,1,1,1,,],[,,,,,1,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,]],c:[[,,,,,,,,,,,,,,,],[,1,1,1,1,1,,,,,1,1,1,1,1],[,1,4,4,4,1,1,1,1,1,1,4,4,4,1],[,1,3,3,4,1,3,3,3,3,1,3,3,4,1],[,1,3,3,4,1,2,2,2,2,1,3,3,4,1],[,1,1,1,1,1,2,2,2,2,1,1,1,1,1],[,,1,2,2,2,2,2,2,2,2,2,3,1,,],[,,1,2,2,2,2,2,2,2,2,2,3,1,,],[,,1,2,2,2,2,2,2,2,2,2,3,1,,],[,,1,2,2,2,2,2,2,2,2,2,3,1,,],[,1,1,1,1,1,2,2,2,2,1,1,1,1,1],[,1,4,4,4,1,2,2,2,2,1,4,4,4,1],[,1,3,3,4,1,2,2,2,2,1,3,3,4,1],[,1,3,3,4,1,1,1,1,1,1,3,3,4,1],[,1,1,1,1,1,,,,,1,1,1,1,1],[,,,,,,,,,,,,,,,]],0:[[,,,,,,,,,,,,,,,],[,,,,,,,,,1,1,1,,,,],[,,,,1,1,1,,1,2,2,2,1,1,,],[,,1,1,2,2,2,1,1,1,3,3,2,1,,],[,,1,2,3,3,3,2,2,2,4,4,3,2,1],[,1,2,3,4,4,4,3,3,3,2,4,3,2,1],[,1,2,3,4,4,4,4,4,4,3,2,3,2,1],[,1,2,2,4,4,4,4,4,4,3,2,2,1,,],[,,1,1,2,4,4,4,4,4,3,2,1,1,,],[,,,1,2,4,4,4,4,4,3,2,1,,,],[,,1,2,2,3,3,3,4,4,3,2,1,1,,],[,1,2,4,4,2,2,2,3,3,3,2,1,2,1],[,1,2,3,4,2,1,1,2,2,2,1,3,2,1],[,,1,2,2,1,,,1,1,1,2,2,2,1],[,,,1,1,,,,,,,1,1,1,,],[,,,,,,,,,,,,,,,]],1:[[,,,,,,,,,1,1,1,,,,],[,,,,1,1,1,1,1,2,2,2,1,1,,],[,,1,1,2,2,2,1,1,3,3,3,2,2,1],[,1,2,2,3,3,3,2,2,2,4,4,3,2,1],[,1,2,3,4,4,4,3,3,3,4,4,4,3,2,1],[1,2,3,4,4,4,4,4,4,4,3,4,4,3,2,1],[1,2,3,4,4,4,4,4,4,4,4,4,4,3,2,1],[1,2,3,4,4,4,4,4,4,4,4,3,3,2,1],[,1,2,2,3,4,4,4,4,4,4,3,2,2,1],[,1,1,2,3,4,4,4,4,4,4,3,2,1,,],[,1,2,3,3,4,4,4,4,4,4,3,2,1,1],[1,2,3,4,4,3,3,3,4,4,4,3,2,1,2,1],[1,2,3,4,4,3,2,2,3,3,3,2,1,3,2,1],[,1,2,3,3,2,1,1,2,2,2,1,3,3,2,1],[,,1,2,2,1,,,1,1,1,1,2,2,1],[,,,1,1,,,,,,1,1,1,1,,]],2:[[,,,1,1,1,1,1,,1,1,1,1,,,],[,,1,2,2,2,2,2,1,2,2,2,2,1,1],[,1,2,3,3,3,3,3,2,3,3,3,2,2,1],[1,2,3,4,4,4,4,4,3,2,4,4,3,2,2,1],[1,2,3,4,,,,,4,4,,,4,3,2,1],[1,2,3,4,,,,,,,,,4,3,2,1],[1,2,3,4,,,,,,,,,4,3,2,1],[1,2,3,4,,,,,,,,,4,3,2,1],[,1,2,3,4,,,,,,,,4,3,2,1],[,1,2,3,4,,,,,,,,4,3,1],[,1,2,3,4,,,,,,,4,4,3,2,1],[1,2,3,4,,,4,4,4,4,4,4,3,2,2,1],[1,2,3,4,4,4,3,3,3,3,3,3,2,3,2,1],[,1,2,3,3,3,2,2,2,2,2,2,3,3,2,1],[,1,1,2,2,1,1,1,1,2,2,2,2,2,1,1],[,,,1,1,,,,,1,1,1,1,1,1]],3:[[,,2,2,2,2,2,2,,2,2,2,2,,,],[,2,3,3,3,3,3,3,3,3,3,3,3,2,1],[2,3,3,4,,,4,4,4,4,4,4,4,3,2],[2,3,4,,,,,,,4,,,,4,3,2],[2,3,4,,,,,,,,,,,,3,2],[2,3,4,,,,,,,,,,,,3,2],[2,3,,,,,,,,,,,,,3,2],[2,3,,,,,,,,,,,,,,2],[,3,4,,,,,,,,,,,,,2],[,2,3,4,,,,,,,,,,,3],[,2,3,4,,,,,,,,,,,3,2],[2,3,4,,,,,,,,,,,4,3,2],[2,3,4,,,,,,,,,,,4,3,2],[,2,3,4,4,3,3,3,3,4,4,4,4,4,3,2],[,1,3,3,3,2,2,2,2,3,3,3,3,3,2,1],[,,,2,2,,,,,2,2,2,2,2,1]],4:[[,,,3,3,3,3,,,3,3,3,,,,],[,3,4,4,4,3,3,4,4,4,4,4,4,3,,],[3,4,,,,,,,,,,,,4,3],[3,4,,,,,,,,,,,,,4,3],[3,4,,,,,,,,,,,,,4,3],[3,,,,,,,,,,,,,,,3],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,3,4,,,,,,,,,,,,,],[,3,4,,,,,,,,,,,,,],[,3,,,,,,,,,,,,,3],[,4,,,,,,,,,,,,,4,3],[,4,,,,,,,,,,,,,4,3],[,3,4,,,,,,3,4,,,,,4,3],[,3,3,4,4,3,,,,3,4,4,4,4,3],[,,,,,,,,,,3,3,3,3,,]],5:[[,,,4,4,4,4,,,4,4,4,,,,],[,4,,,,,,,,,,,,4,,],[4,,,,,,,,,,,,,,4],[4,,,,,,,,,,,,,,4],[4,,,,,,,,,,,,,,,4],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,,,,,,,,,,,,,,,],[,4,,,,,,,,,,,,,,],[,4,,,,,,,,,,,,,,4],[,4,,,,,,,,,,,,,,4],[,,4,,,,,,,,,,,4,,],[,,,,,,,,,,4,4,4,,,]]}},bossSprite:{height:32,width:32,characters:{o:[[,,,1,1,1,1,1,1,1,1,1,,,,,,,,,,,,,,,,,,,,],[,1,1,2,2,2,2,2,2,2,2,2,1,1,1,1,1,,,,,,1,,,,,,,,,],[1,2,2,2,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,,,],[4,2,1,1,3,1,3,1,3,1,3,1,1,1,1,1,2,2,2,2,2,1,1,1,,,,,,,,],[4,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,1,1,1,1,2,2,2,2,1,1,,,,,,],[1,1,3,1,1,1,1,1,1,1,3,1,3,1,3,1,3,1,3,1,2,2,2,2,2,2,1,1,1,1,1,1],[,1,1,2,2,2,2,2,2,2,1,1,1,1,3,1,3,1,3,1,1,1,2,2,2,2,1,,,,,],[,,,1,2,2,2,2,2,2,2,2,2,2,1,1,1,1,3,1,4,4,1,2,2,2,1,1,,,,],[,,,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,3,4,1,2,2,2,1,2,1,,,],[,,,,1,2,2,1,1,1,1,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,1,2,2,1,,],[,,,,1,2,2,1,2,2,2,1,1,1,2,2,1,2,2,2,1,2,2,2,1,1,2,2,2,1,,],[,,,1,2,2,1,1,1,1,2,2,2,2,1,1,1,2,2,2,2,1,1,1,2,2,2,2,2,2,1],[,,,1,2,1,3,3,3,3,1,2,2,1,4,4,4,1,1,2,2,2,1,2,2,2,2,2,2,2,1],[,1,1,2,2,1,3,3,3,3,1,2,2,1,3,3,3,4,4,1,2,2,2,1,2,2,2,2,2,2,1],[1,2,2,2,2,2,1,1,1,1,2,2,2,2,1,1,3,3,4,4,1,2,2,2,1,1,1,1,2,2,2,1],[4,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,1,3,4,4,1,2,2,2,2,2,3,4,1,2,2,1],[4,2,2,2,2,2,2,1,2,2,2,2,2,2,2,2,1,3,4,4,1,2,2,2,2,2,3,4,1,2,2,1],[1,2,2,2,2,2,1,1,1,1,2,2,2,2,1,1,3,3,4,4,1,2,2,2,1,1,1,1,2,2,2,1],[,1,1,2,2,1,3,3,3,3,1,2,2,1,3,3,3,4,4,1,2,2,2,1,2,2,2,2,2,2,1],[,,,1,2,1,3,3,3,3,1,2,2,1,4,4,4,1,1,2,2,2,1,2,2,2,2,2,2,2,1],[,,,1,2,2,1,1,1,1,2,2,2,2,1,1,1,2,2,2,2,1,1,1,2,2,2,2,2,2,1],[,,,,1,2,2,1,2,2,2,1,1,1,2,2,1,2,2,2,1,2,2,2,1,1,2,2,2,1,,],[,,,,1,2,2,1,1,1,1,2,2,2,2,2,2,1,2,2,2,1,2,2,2,2,1,2,2,1,,],[,,,1,2,2,2,2,2,2,2,2,2,2,2,2,2,1,1,2,3,4,1,2,2,2,1,2,1,,,],[,,,1,2,2,2,2,2,2,2,2,2,2,1,1,1,1,3,1,4,4,1,2,2,2,1,1,,,,],[,1,1,2,2,2,2,2,2,2,1,1,1,1,3,1,3,1,3,1,1,1,2,2,2,2,1,,,,,],[1,1,3,1,1,1,1,1,1,1,3,1,3,1,3,1,3,1,3,1,2,2,2,2,2,2,1,1,1,1,1,1],[4,1,3,1,3,1,3,1,3,1,3,1,3,1,3,1,1,1,1,1,2,2,2,2,1,1,,,,,,],[4,2,1,1,3,1,3,1,3,1,3,1,1,1,1,1,2,2,2,2,2,1,1,1,,,,,,,,],[1,2,2,2,1,1,1,1,1,1,1,2,2,2,2,2,2,1,1,1,1,1,1,1,1,1,1,1,1,,,],[,1,1,2,2,2,2,2,2,2,2,2,1,1,1,1,1,,,,,,1,,,,,,,,,],[,,,1,1,1,1,1,1,1,1,1,,,,,,,,,,,,,,,,,,,,]]}}}}function checkMusicGenerated(){var t=player.generate()>=1
if(t){var a=player.createWave()
window.music=document.createElement("audio"),music.src=URL.createObjectURL(new Blob([a],{type:"audio/wav"})),music.loop=!0,musicGenerated=!0}}function playMusic(){music.play()}function setVolume(t){stopMusic(),music.volume=t,data.sound&&playMusic()}function stopMusic(){music.pause()};var zzfx_v=.5,zzfx_x=new AudioContext,zzfx=(e,f,a,b=1,d=.1,g=0,h=0,k=0,l=0,pan=0)=>{let S=44100,P=Math.PI;a*=2*P/S;a*=1+f*(2*Math.random()-1);g*=1E3*P/(S**2);b=0<b?S*(10<b?10:b)|0:1;d*=b|0;k*=2*P/S;l*=P;f=[];for(var m=0,n=0,c=0;c<b;++c)f[c]=e*zzfx_v*Math.cos(m*a*Math.cos(n*k+l))*(c<d?c/d:1-(c-d)/(b-d)),m+=1+h*(2*Math.random()-1),n+=1+h*(2*Math.random()-1),a+=g;e=zzfx_x.createBuffer(1,b,S);a=zzfx_x.createBufferSource();e.getChannelData(0).set(f);a.buffer=e;
	var panN=zzfx_x.createStereoPanner();
	panN.pan.value = pan;
	panN.connect(zzfx_x.destination);
a.connect(panN);a.start();return a};function playSFX(t,a){if(data.sound){var e=(a-canvas.width/2)/canvas.width
data.sfxDefs[t](e)}}function setup(){window.canvas=document.getElementById("canvas"),window.ctx=canvas.getContext("2d"),canvas.width=1024,canvas.height=768,canvas.onmousedown=click,registerFonts(ctx),registerFontFunctions(ctx),initialiseSprites(),initialiseData(),gameLoop()}function initialiseSprites(){for(var t in data.enemyDefs){var a=data.enemyDefs[t],e=ctx.fonts["boss"===t?"bossSprite":"gameSprite"],i=e.characters[a.sprite]
i&&initialiseSprite(a,e,i)}for(var s in data.projectileDefs){var r=data.projectileDefs[s],n=ctx.fonts.gameSprite.characters[r.symbol]
initialiseSprite(r,ctx.fonts.gameSprite,n)}}function initialiseSprite(t,a,e){for(var i=ctx.createImageData(2*a.width,2*a.height),s=0;s<i.data.length;s+=4){var r=Math.floor(s/4)%(2*a.width),n=Math.floor(Math.floor(s/4)/(2*a.height)),o=e[Math.floor(n/2)][Math.floor(r/2)],d=void 0!==o
i.data[s+0]=d?getRGB(0,t.palette||3,o):0,i.data[s+1]=d?getRGB(2,t.palette||3,o):0,i.data[s+2]=d?getRGB(4,t.palette||3,o):0,i.data[s+3]=d?255:0}t.image=imagedata_to_image(i)}function getRGB(t,a,e){var i=ctx.fonts.palettes[a][e].substring(1)
return parseInt(i.substring(t,t+2),16)}function imagedata_to_image(t){var a=document.createElement("canvas"),e=a.getContext("2d")
a.width=t.width,a.height=t.height,e.putImageData(t,0,0)
var i=new Image
return i.src=a.toDataURL(),i}function initialiseData(){data.keys=[],data.timer=0,data.bossCounter=0,data.waveInterval=180,data.players=[],data.enemies=[],data.projectiles=[],data.powerups=[],data.particles=[],data.stars=[],data.messageLog=[],data.players.push(new Player({dir:-1,player:0})),data.players.push(new Player({dir:1,player:1}))
for(var t=0;150>t;t++)data.stars.push(new Star)}function gameLoop(){window.requestAnimationFrame(gameLoop)
var t=(new Date).getTime(),a=t-data.lastTime
a>data.INTERVAL&&(window.music||checkMusicGenerated(),handleInput(),doSceneLogic(),drawScene(),data.lastTime=t-a%data.INTERVAL)}function updateScene(t){data.previousScene=data.scene+"",data.scene=t}function endGame(){updateScene("end"),data.lastScore=data.players[0].score+data.players[1].score
var t=localStorage.getItem("dhmstarkjs13k2019")
t&&parseInt(t)>=data.lastScore?data.highScore=parseInt(t):data.lastScore>data.highScore&&(data.highScore=data.lastScore),localStorage.setItem("dhmstarkjs13k2019",data.highScore)}function cull(){var t=["projectiles","enemies","powerups","particles","messageLog"]
for(var a in t)for(var e=t[a],i=data[e].length-1;i>=0;i--)data[e][i].cull&&data[e].splice(i,1)}function doSceneLogic(){switch(data.scene){case"start":case"end":data.timer++
for(var t in data.stars)data.stars[t].move()
if(data.gfx&&!data.debug)for(var a in data.particles){var e=data.particles[a]
e.move(e.dx,e.dy)}break
case"options":document.monetization&&"started"===document.monetization.state&&(data.secret="coil")
for(var t in data.stars)data.stars[t].move()
break
case"game":var i=data.players[0].ready&&data.players[1].ready
for(var t in data.stars)data.stars[t].move()
if(data.gfx&&!data.debug)for(var a in data.particles){var e=data.particles[a]
e.move(e.dx,e.dy)}for(var s in data.players){var r=data.players[s]
r.move(r.dy),i&&r.shoot()}for(var n in data.enemies){var o=data.enemies[n]
o.ai()
for(var s in data.players){var r=data.players[s]
o.collidesWith(r)&&(o.cull=!0,r.hit(o))}}for(var d in data.projectiles){var r=data.projectiles[d]
r.ai()
for(var n in data.enemies){var o=data.enemies[n]
"number"==typeof r.player&&r.collidesWith(o)&&(o.hit(r),"laser"!=r.projectileType&&(r.cull=!0))}if(r.player===!1)for(var s in data.players)r.collidesWith(data.players[s])&&(r.cull=!0,data.players[s].hit(r))}for(var h in data.powerups){var c=data.powerups[h]
c.move(c.dx,c.dy)
for(var s in data.players){var l=data.players[s]
c.collidesWith(l)&&(playSFX("powerup",c.x),data.players[1-l.player%2].powerups[c.powerupType].activate(),c.cull=!0,data.messageLog.push(new Message(data.powerupDefs[c.powerupType].name,1-l.player%2)))}}for(var p in data.messageLog){var f=data.messageLog[p]
f.lifeTime++,f.lifeTime>120&&(f.cull=!0)}if(cull(),i){var y=Math.ceil(data.waveInterval)
data.cheats.hyperMode&&(y=Math.floor(y/3)),data.timer%y===0&&(generateWave(),data.waveInterval*=.998),data.timer++}}}function drawScene(){switch(data.scene){case"start":if(clear(),ctx.fillStyle="#fff",data.gfx&&!data.debug)for(var t in data.stars)data.stars[t].draw()
ctx.drawFontCenter("@dhmstark js13k 2019",canvas.width/2,520,5),ctx.drawFont("[ESC] Options",15,canvas.height-30,2),ctx.drawFontRight("[M] Music: "+("undefined"==typeof music?"INITIALISING":data.sound?"ON":"OFF"),canvas.width-15,canvas.height-30,2),ctx.fillStyle="#494",ctx.drawFontCenter("BACK",canvas.width/4+5,235,15),ctx.fillStyle="#999",ctx.drawFontCenter("2",canvas.width/2+30+5,115,50),ctx.fillStyle="#449",ctx.drawFontCenter("BACK",canvas.width/4*3+5,290,15),ctx.fillStyle="#afa",ctx.drawFontCenter("BACK",canvas.width/4,230,15),ctx.fillStyle="#fff",ctx.drawFontCenter("2",canvas.width/2+30,110,50),ctx.fillStyle="#aaf",ctx.drawFontCenter("BACK",canvas.width/4*3,285,15),Math.floor(data.timer/60)%2&&"undefined"!=typeof music&&(ctx.fillStyle="#ff0",ctx.drawFontCenter("Press Any Key To Start",canvas.width/2,630,4))
break
case"end":if(clear(),ctx.fillStyle="#fff",data.gfx&&!data.debug){for(var t in data.stars)data.stars[t].draw()
for(var a in data.particles)data.particles[a].draw()}if(ctx.fillStyle="#fff",ctx.fonts.current="alphanumeric",ctx.drawFontCenter("GAME OVER",canvas.width/2,canvas.height/2-35-150,10),data.highScore===data.lastScore){ctx.drawFontCenter("You scored "+data.highScore+" points",canvas.width/2,canvas.height/2+70,5)
for(var e="NEW HIGH SCORE!",i=5,s=(e.length-1)*i*5+(e.length-2)*i,r=0;r<e.length;r++){var n=Math.sin((data.timer+10*r)/20),o=255*Math.sin(data.timer/60+r)+255,d=255*Math.sin(data.timer/60+r+Math.PI)+255,h=255*Math.cos(data.timer/60+r)+255
ctx.fillStyle="rgba("+o+","+d+","+h+",1)",ctx.drawFontCenter(e[r],canvas.width/2-s/2+r*i*6,canvas.height/2+6*n,i)}}else ctx.drawFontCenter("You Scored: "+data.lastScore,canvas.width/2,canvas.height/2,5),ctx.drawFontCenter("High Score: "+data.highScore,canvas.width/2,canvas.height/2+70,5)
ctx.fillStyle="#ff0",ctx.drawFontCenter("Press ESC to restart",canvas.width/2,canvas.height/2+220,3),drawUI()
break
case"options":if(clear(),ctx.fillStyle="#fff",data.gfx&&!data.debug)for(var t in data.stars)data.stars[t].draw()
if(ctx.drawFontRight("[ESC] Back",canvas.width-20,15,2),ctx.fillStyle=data.optionsPage>0?"#fff":"#666",ctx.drawFont("←",200,80,5),ctx.fillStyle=data.optionsPage<2?"#fff":"#666",ctx.drawFontRight("→",canvas.width-200,80,5),ctx.fillStyle="#fff",0===data.optionsPage)ctx.drawFontCenter("Options",canvas.width/2,80,5),ctx.drawFont("Sound",200,180,3),ctx.drawFontRight(data.sound?"☑":"☐",canvas.width-200,180,3),ctx.drawFont("Graphics",200,360,3),ctx.drawFontRight(data.gfx?"☑":"☐",canvas.width-200,360,3),data.secret?(ctx.drawFont(("coil"===data.secret?"Coil":"Patron")+" Cheats Unlocked!",200,440,3),ctx.drawFont("Invulnerability",200,490,3),ctx.drawFontRight(data.cheats.invulnerability?"☑":"☐",canvas.width-200,490,3),ctx.drawFont("Disable Bosses",200,530,3),ctx.drawFontRight(data.cheats.disableBosses?"☑":"☐",canvas.width-200,530,3),ctx.drawFont("Hyper Mode",200,570,3),ctx.drawFontRight(data.cheats.hyperMode?"☑":"☐",canvas.width-200,570,3),ctx.drawFont("Tether Mode",200,610,3),ctx.drawFontRight(data.cheats.tether?"☑":"☐",canvas.width-200,610,3),ctx.drawFont("Debug View",200,650,3),ctx.drawFontRight(data.debug?"☑":"☐",canvas.width-200,650,3)):(ctx.drawFont("Unlock Cheats",200,440,3),ctx.drawFontRight("☐",canvas.width-200,440,3)),ctx.fillStyle=data.sound?"#fff":"#666",ctx.drawFont("Music",200,230,3),ctx.drawFontRight("← "+("00"+data.musicVolume).slice(-2)+" →",canvas.width-200,230,3),ctx.drawFont("SFX",200,280,3),ctx.drawFontRight("← "+("00"+data.soundVolume).slice(-2)+" →",canvas.width-200,280,3)
else if(1===data.optionsPage){ctx.drawFontCenter("INSTRUCTIONS",canvas.width/2,80,5),ctx.drawFont("Controls",200,180,3),ctx.drawFont("W / S",200,220,3),ctx.drawFontRight("Player One Up / Down",canvas.width-200,220,3),ctx.drawFont("↑ / ↓",200,260,3),ctx.drawFontRight("Player Two Up / Down",canvas.width-200,260,3),ctx.drawFont("ESC",200,300,3),ctx.drawFontRight("Options",canvas.width-200,300,3),ctx.drawFont("M",200,340,3),ctx.drawFontRight("Toggle Music & Sound",canvas.width-200,340,3),ctx.drawFont("Powerups",200,400,3)
var c=440
for(var l in data.powerupDefs){var p=data.powerupDefs[l]
ctx.drawFont(p.symbol,200,c,3),ctx.drawFontRight(p.name,canvas.width-200,c,3),c+=40}}else if(2===data.optionsPage){var f=canvas.width/2
ctx.drawFontCenter("PATRONS",f,80,5),ctx.drawFontCenter("Corrin Motion",f,230,3),ctx.drawFontCenter("Guy Patching",f,270,3)
for(var c=390,y=["4MinuteWarning","Amy Thomasin Allen","Azurit","Joe Rooney","Jonathan Hogg","Susannah Cooke","Victoria Jane Smith"],u=0;u<y.length;u++)ctx.drawFontCenter(y[u],f,390+30*u,2)
ctx.drawFontCenter("https://www.patreon.com/dhmstark",f,670,3),ctx.fillStyle="#ff0",ctx.drawFontCenter("Heroes",f,180,3),ctx.drawFontCenter("Adventurers",f,340,3),ctx.drawFontCenter("Support My Work!",f,630,3)}break
case"game":if(clear(),ctx.fillStyle="#fff",data.gfx&&!data.debug)for(var t in data.stars)data.stars[t].draw()
for(var w in data.messageLog)data.messageLog[w].draw()
for(var v in data.enemies)data.enemies[v].draw(data.enemies[v])
for(var m in data.projectiles)data.projectiles[m].draw()
for(var l in data.powerups)data.powerups[l].draw()
if(data.gfx&&!data.debug)for(var a in data.particles)data.particles[a].draw()
for(var x in data.players)data.players[x].draw()
data.players[0].ready&&data.players[1].ready||showReadyText(),drawUI()}}function adjustVolume(t,a){data[t]+=a,data[t]>10&&(data[t]=10),data[t]<0&&(data[t]=0),"musicVolume"===t&&setVolume(data[t]/10)}function clear(){if(data.smartBomb)ctx.fillStyle="#fff"
else if(data.gfx&&!data.debug){var t=ctx.createLinearGradient(0,0,canvas.width,canvas.height)
t.addColorStop(0,"#003"),t.addColorStop(.5,"#000"),t.addColorStop(.6,"#000"),t.addColorStop(1,"#303"),ctx.fillStyle=t}else ctx.fillStyle="#000"
data.smartBomb>0&&data.smartBomb--,ctx.fillRect(0,0,canvas.width,canvas.height)}function showReadyText(){data.players[0].ready||(drawKey("W",canvas.width/4,canvas.height/2-50),drawKey("S",canvas.width/4,canvas.height/2+50)),data.players[1].ready||(drawKey("↑",canvas.width/4*3,canvas.height/2-50),drawKey("↓",canvas.width/4*3,canvas.height/2+50)),drawKey("ESC",canvas.width/2-80,canvas.height-150),ctx.drawFontCenter("Options",canvas.width/2-80,canvas.height-80,2),drawKey("M",canvas.width/2+80,canvas.height-150),ctx.drawFontCenter("Music",canvas.width/2+79,canvas.height-80,2)}function drawKey(t,a,e){ctx.strokeStyle="#999",ctx.fillStyle="#333",ctx.fillRect(a-30,e-15,56,64),ctx.strokeRect(a-30,e-15,56,64),ctx.strokeRect(a-20,e-10,36,46),ctx.beginPath(),ctx.moveTo(a-30,e+49),ctx.lineTo(a-20,e+36),ctx.moveTo(a+26,e+49),ctx.lineTo(a+16,e+36),ctx.moveTo(a+26,e-15),ctx.lineTo(a+16,e-10),ctx.moveTo(a-30,e-15),ctx.lineTo(a-20,e-10),ctx.stroke(),ctx.fillStyle="#fff",ctx.fonts.current="alphanumeric",ctx.drawFontCenter(t,a,e,4/t.length)}function drawUI(){ctx.fonts.current="alphanumeric",ctx.fillStyle="#333",ctx.fillRect(0,0,canvas.width,data.sah),ctx.fillStyle="#fff"
var t=" - "+("0000000"+data.players[0].score).slice(-7)+" -    ",a="    - "+("0000000"+data.players[1].score).slice(-7)+" - "
ctx.drawFontRight(t,canvas.width/2-20,12,3),ctx.drawFont(a,canvas.width/2+20,12,3),ctx.fillStyle=ctx.fonts.palettes[0][4],ctx.drawFontRight("1UP",canvas.width/2-20,12,3),ctx.fillStyle=ctx.fonts.palettes[1][4],ctx.drawFont("2UP",canvas.width/2+20,12,3)
for(var e=data.players[0].lives,i=data.players[1].lives,s="",r="",n=0;n<t.length;n++)s+=" "
for(var o=0;o<a.length;o++)r+=" "
for(var d=0;e>d;d++)s="♥"+s
for(var h=0;i>h;h++)r+="♥"
if(0>=e&&(s="DEAD"+s),0>=i&&(r+="DEAD"),1===e||1===i){var c=60-data.timer%60
ctx.fillStyle="rgba(255,0,0,"+c/60+")",1===e&&ctx.drawFontRight("♥",canvas.width/2-6*s.length*3+(60-c)/20,12-(60-c)/3,3+(60-c)/10),1===i&&ctx.drawFont("♥",canvas.width/2+6*r.length*3+(60-c)/20,12-(60-c)/3,3+(60-c)/10)}ctx.fillStyle=data.players[0].lives>1?data.players[0].lives>2?"#fff":"#ff0":"#f00",ctx.drawFontRight(s,canvas.width/2-20,12,3),ctx.fillStyle=data.players[1].lives>1?data.players[1].lives>2?"#fff":"#ff0":"#f00",ctx.drawFont(r,canvas.width/2+20,12,3)}function Entity(t){this.x=t.x,this.y=t.y,this.size=t.size||0,this.inBounds=!1,this.move=function(t,a){this.x+=t,this.y+=a,this.checkOOB()},this.checkOOB=function(){this.x>canvas.width+this.size+50||this.x<0-this.size-50||this.y>canvas.height+this.size+50||this.y<data.sah-this.size-50?this.inBounds&&this.onOOB(this.y>canvas.height+this.size||this.y<data.sah-this.size):this.inBounds||(this.inBounds=!0)},this.onOOB=function(t){this.cull=!0},this.draw=function(){ctx.fillRect(this.x-this.size/2,this.y-this.size/2,this.size,this.size)},this.collidesWith=t.collidesWith||function(t){return this.x-this.size/2<=t.x+t.size/2&&this.x+this.size/2>=t.x-t.size/2&&this.y-this.size/2<=t.y+t.size/2&&this.y+this.size/2>=t.y-t.size/2}}function Player(t){this.speed=8,this.dir=t.dir,this.framesSinceLastShot=0,this.damageTimer=0,this.score=0,this.lives=3,this.player=t.player,this.ready=!1,this.powerups={twinShot:new Powerup({player:this.player,disableOnActivate:["missile","laser","chaingun"]}),missile:new Powerup({player:this.player,disableOnActivate:["twinShot","laser","chaingun"]}),laser:new Powerup({player:this.player,disableOnActivate:["missile","twinShot","chaingun"]}),chaingun:new Powerup({player:this.player,disableOnActivate:["missile","twinShot","laser"]}),smartBomb:new Powerup({player:this.player,activate:function(){data.smartBomb=1
for(var t in data.enemies){var a=data.enemies[t]
a.hit({y:a.y,x:a.x,projectileType:"smartBomb",player:this.player})}}}),shield:new Powerup({player:this.player}),heart:new Powerup({player:this.player,activate:function(){data.players[this.player].lives++}})},t.size=32,t.y=canvas.height/2,t.x=canvas.width/2+t.dir*t.size,Entity.call(this,t),this.move=function(t){this.y+=t*this.speed,this.y<data.sah+this.size/2&&(this.y=data.sah+this.size/2),this.y>canvas.height-this.size/2&&(this.y=canvas.height-this.size/2)},this.shoot=function(){this.framesSinceLastShot++,this.powerups.laser.active?this.framesSinceLastShot>=data.projectileDefs.laser.fireRate&&(this.framesSinceLastShot=0,data.projectiles.push(new Projectile({projectileType:"laser",player:this.player,x:this.x,y:this.y,rot:this.dir>0?.01:Math.PI})),data.gfx&&data.particles.push(new Explosion({x:this.x+16*this.dir-8,y:this.y}))):this.powerups.missile.active?this.framesSinceLastShot>=data.projectileDefs.missile.fireRate&&(this.framesSinceLastShot=0,data.projectiles.push(new Projectile({projectileType:"missile",player:this.player,x:this.x,y:this.y,rot:this.dir>0?.01:Math.PI}))):this.powerups.twinShot.active?this.framesSinceLastShot>=data.projectileDefs.bullet.fireRate&&(this.framesSinceLastShot=0,data.projectiles.push(new Projectile({projectileType:"bullet",player:this.player,x:this.x,y:this.y,rot:this.dir>0?-1*Math.PI/20:-19*Math.PI/20})),data.projectiles.push(new Projectile({projectileType:"bullet",player:this.player,x:this.x,y:this.y,rot:this.dir>0?1*Math.PI/20:19*Math.PI/20}))):this.powerups.chaingun.active?this.framesSinceLastShot>=data.projectileDefs.chaingun.fireRate&&(this.framesSinceLastShot=0,data.projectiles.push(new Projectile({projectileType:"chaingun",player:this.player,x:this.x,y:this.y,rot:(this.dir>0?0:Math.PI)+Math.random()*Math.PI/10-Math.PI/20}))):this.framesSinceLastShot>=data.projectileDefs.bullet.fireRate&&(this.framesSinceLastShot=0,data.projectiles.push(new Projectile({projectileType:"bullet",player:this.player,x:this.x,y:this.y,rot:this.dir>0?0:Math.PI})))},this.hit=function(t){if(data.gfx&&data.particles.push(new Explosion({x:t.x+t.dir*t.size/2-16,y:t.y})),this.damageTimer>0);else if(data.cheats.invulnerability);else if(this.powerups.shield.active)playSFX("shieldDest",this.x),this.powerups.shield.active=!1
else{playSFX("playerExplode",this.x),this.damageTimer=30,this.lives--,1===this.lives?data.messageLog.push(new Message("Last Life!",this.player)):this.lives<=0&&endGame()
for(var a in this.powerups)this.powerups[a].disable()}},this.draw=function(){if(Math.floor(this.damageTimer/4)%2===0){if(this.dy&&drawTriangle(this.x-8*this.dir,this.y-18*this.dy-2,Math.PI/2*this.dy),ctx.fonts.current="gameSprite",ctx.setPalette(this.player),ctx.save(),ctx.translate(this.x,this.y-16),this.dir<0&&ctx.scale(-1,1),data.debug)ctx.fillStyle="blue",ctx.fillRect(0,0,this.size,this.size)
else{ctx.drawFontCenter("t",-12,0,2),ctx.drawFontCenter("l",-10,16-this.dy,2),ctx.drawFontCenter("h",-12,-12+Math.floor(data.timer/30)%2,2)
var t=this.powerups.missile.active?data.projectileDefs.missile.fireRate:this.powerups.laser.active?1:data.projectileDefs.bullet.fireRate
ctx.drawFontCenter("a",-12+Math.floor(2*data.timer/t)%2,0,2)}this.powerups.shield.active&&(ctx.fillStyle=data.timer%12?"rgba(0,0,255,0.2)":"rgba(255,255,255,0.2)",ctx.beginPath(),ctx.ellipse(0,16,1*this.size,1.2*this.size,0,0,2*Math.PI),ctx.fill()),ctx.restore()}this.damageTimer>0&&this.damageTimer--}}function Enemy(t){var a=data.enemyDefs[t.enemyType]
this.enemyType=t.enemyType,this.dir=t.dir,this.waveData=t.waveData,this.lifeTimer=0,this.framesSinceLastShot=0,this.speed=a.speed||5,this.fireRate=a.fireRate||0,this.dx=0,this.dy=0,this.hp=t.hp||1,t.size=t.size||(t.waveData&&t.waveData.asteroidSize?32*Math.sqrt(this.waveData.asteroidSize):32),t.setBack=t.setBack||0,t.x=1===t.dir?0-t.size-t.setBack:canvas.width+t.size+t.setBack,t.y=t.y||t.size+Math.random()*(canvas.height-2*t.size-data.sah)+data.sah,Entity.call(this,t),this.draw=a.draw||function(t){ctx.save(),ctx.translate(this.x-this.size/2,this.y-this.size/2),this.dir<0&&ctx.scale(-1,1)
var a=data.enemyDefs[this.enemyType]
data.debug?(ctx.fillStyle="red",ctx.fillRect(0,0,this.size,this.size)):ctx.drawImage(a.image,0,0),ctx.restore()},this.ai=function(){this.lifeTimer++,data.enemyAI[data.enemyDefs[this.enemyType].ai](this)},this.hit=function(t){if(playSFX("explode",this.x+this.dir*this.size/2),data.gfx){var a="laser"===t.projectileType?this.x-this.size/2:t.x-this.size/2
data.particles.push(new Explosion({x:a,y:t.y}))}this.hp-=data.projectileDefs[t.projectileType].damage||1,this.hp<=0&&this.die(data.players[t.player])},this.die=function(t){this.cull=!0
var a=data.enemyDefs[this.enemyType]
if(t&&(t.score+=a.score),a.powerupChance&&Math.random()<a.powerupChance){var e=new PowerupObject({x:this.x,y:this.y,dx:2*this.dir,dy:0,powerupType:chooseRandom(data.lootTypes[a.powerups])})
data.powerups.push(e)}a.onDeath&&a.onDeath(this)}}function Projectile(t){this.projectileType=t.projectileType,this.player=t.player,this.rot=t.rot,this.lifeTime=0,t.size=10,"laser"===this.projectileType&&(t.collidesWith=function(t){var a=0===this.player?0:data.players[this.player].x,e=0===this.player?data.players[this.player].x:canvas.width
return a<=t.x+t.size/2&&e>=t.x-t.size/2&&this.y-this.size/2<=t.y+t.size/2&&this.y+this.size/2>=t.y-t.size/2}),Entity.call(this,t),this.ai=function(){data.projectileAI[data.projectileDefs[this.projectileType].ai](this)},this.draw=function(){var t=data.projectileDefs[this.projectileType]
if(ctx.fonts.current="gameSprite",ctx.setPalette(t.palette),"laser"===this.projectileType){var a=0===this.player?0:data.players[this.player].x,e=0===this.player?data.players[this.player].x:canvas.width,i=ctx.createLinearGradient(0,this.y-this.size/2,0,this.y+this.size/2),s=(20-this.lifeTime)/20*255
i.addColorStop(0,"rgba(0,0,"+s+",1)"),i.addColorStop(.4,"#fff"),i.addColorStop(.6,"#fff"),i.addColorStop(1,"rgba(0,0,"+s+",1)"),ctx.fillStyle=i,ctx.fillRect(a,this.y-this.size/2,e-a,this.size)}else ctx.save(),ctx.translate(this.x,this.y),ctx.rotate(this.rot),data.debug?(ctx.fillStyle="#fff",ctx.fillRect(0,0,this.size,this.size)):ctx.drawImage(t.image,-16,-16),ctx.restore()
if(data.debug&&this.target){var r=steer(Math.atan(this.target.y-this.y,this.target.x-this.x),this.rot)
ctx.strokeStyle="red",ctx.beginPath(),ctx.moveTo(this.x,this.y),ctx.lineTo(this.target.x,this.target.y),ctx.stroke(),ctx.fillStyle="red",ctx.font="30px sans-serif",ctx.fillText(r,this.x,this.y+25)}}}function Explosion(t){this.lifeTime=0,this.dx=0,this.dy=0,Entity.call(this,t),this.draw=function(){if(this.lifeTime>=18)this.cull=!0
else{ctx.fonts.current="gameSprite",ctx.setPalette(3)
var t=Math.floor(this.lifeTime/3)+""
ctx.drawFontCenter(t,this.x,this.y-16,2),this.lifeTime++}}}function Star(t,a){function e(){return{x:canvas.width*Math.random(),y:(canvas.height-data.sah)*Math.random()+data.sah}}var i=Math.floor(Math.random()*Math.random()*3)+1,s=e()
Entity.call(this,{x:s.x,y:s.y,size:i}),this.move=function(){var t=5e-4
this.x+=(this.x-canvas.width/2)*t*this.size,this.y+=(this.y-canvas.height/2)*t*this.size,this.checkOOB()},this.checkOOB=function(){(this.x>canvas.width+this.size||this.x<0-this.size||this.y>canvas.height+this.size||this.y<0-this.size)&&this.onOOB()},this.onOOB=function(){var t=e()
this.x=t.x,this.y=t.y}}function Powerup(t){this.disableOnActivate=t.disableOnActivate||!1,this.player=t.player,this.active=!1,this.activate=t.activate||function(){if(this.disableOnActivate)for(disabled in this.disableOnActivate)data.players[this.player].powerups[this.disableOnActivate[disabled]].active=!1
this.active=!0},this.disable=function(){this.active=!1}}function PowerupObject(t){t.size=20,Entity.call(this,t),this.powerupType=t.powerupType,this.dx=t.dx,this.dy=t.dy,this.draw=function(){ctx.fonts.current="gameSprite",ctx.setPalette(2),ctx.save(),ctx.translate(this.x,this.y-16),ctx.drawFontCenter("c",0,0,2),ctx.fonts.current="alphanumeric",ctx.fillStyle="#fff"
var t=data.powerupDefs[this.powerupType].symbol
ctx.drawFont(t,5,5+4*t.length,2/t.length),ctx.restore()}}function Wave(t){this.spawn=t.spawn,this.isValid=t.isValid,this.waveType=t.waveType}function generateWave(){var t=[]
for(var a in data.waves){var e=data.waves[a];(!e.isValid||e.isValid())&&t.push(e)}t.length>0&&spawnWave(chooseRandom(t))}function spawnWave(t){var a=enemyExists("boss")
a?t.spawn(-1*a.dir):"boss"===t.waveType?(data.bossCounter=0,t.spawn(chooseRandom([-1,1]))):(data.bossCounter++,t.spawn(1),t.spawn(-1))}function enemyExists(t){for(var a in data.enemies)if(data.enemies[a].enemyType===t)return data.enemies[a]
return!1}function drawTriangle(t,a,e){ctx.save(),ctx.translate(t,a),ctx.rotate(e)
for(var i=6;i>0;i--)ctx.fillStyle=ctx.fonts.palettes[3][(Math.floor(data.timer/4)+i)%4+1],ctx.fillRect(2*(i-6),-1*i,2,2*i)
ctx.restore()}function Message(t,a){this.message=t,this.player=a,this.lifeTime=0,this.draw=function(){ctx.fillStyle="rgba(255,255,255,"+(1-this.lifeTime/120)+")",ctx.drawFontCenter(this.message,data.players[this.player].x,data.players[this.player].y-50,2)}}function chooseRandom(t){return t[Math.floor(Math.random()*t.length)]}function steer(t,a){var e=normAngle(t),i=normAngle(a),s=e-i,r=e>Math.PI?2*Math.PI-e:e,n=i>Math.PI?2*Math.PI-i:i,o=r+n
return Math.abs(s)<Math.abs(o)?s/Math.abs(s):Math.abs(s)>Math.abs(o)?Math.PI>i?-1:1:0}function normAngle(t){return t%=2*Math.PI,0>t&&(t+=2*Math.PI),t}function handleInput(){if("game"===data.scene){if(data.keys[27])return updateScene("options"),!1
data.players[0].dy=0,data.players[1].dy=0,(data.keys[87]||data.cheats.tether&&data.keys[38])&&(data.players[0].dy=-1,data.players[0].ready||(data.players[0].ready=!0)),(data.keys[83]||data.cheats.tether&&data.keys[40])&&(data.players[0].dy=1,data.players[0].ready||(data.players[0].ready=!0)),(data.keys[38]||data.cheats.tether&&data.keys[87])&&(data.players[1].dy=-1,data.players[1].ready||(data.players[1].ready=!0)),(data.keys[40]||data.cheats.tether&&data.keys[83])&&(data.players[1].dy=1,data.players[1].ready||(data.players[1].ready=!0))}}function click(t){"options"===data.scene&&(hitsButton(canvas.width-200-25,80,t,5)?data.optionsPage<2&&data.optionsPage++:hitsButton(200,80,t,5)&&data.optionsPage>0&&data.optionsPage--,0===data.optionsPage&&(hitsButton(canvas.width-200-15,180,t)?(data.sound=!data.sound,data.sound?setVolume(data.musicVolume/10):stopMusic()):hitsButton(canvas.width-200-15,230,t)?adjustVolume("musicVolume",1):hitsButton(canvas.width-200-15-90,230,t)?adjustVolume("musicVolume",-1):hitsButton(canvas.width-200-15,280,t)?adjustVolume("soundVolume",1):hitsButton(canvas.width-200-15-90,280,t)?adjustVolume("soundVolume",-1):hitsButton(canvas.width-200-15,360,t)?data.gfx=!data.gfx:data.secret?hitsButton(canvas.width-200-15,490,t)?data.cheats.invulnerability=!data.cheats.invulnerability:hitsButton(canvas.width-200-15,530,t)?data.cheats.disableBosses=!data.cheats.disableBosses:hitsButton(canvas.width-200-15,570,t)?data.cheats.hyperMode=!data.cheats.hyperMode:hitsButton(canvas.width-200-15,610,t)?data.cheats.tether=!data.cheats.tether:hitsButton(canvas.width-200-15,650,t)&&(data.debug=!data.debug):hitsButton(canvas.width-200-15,440,t)&&"alpaca"===prompt("Enter Patreon Unlock Code")&&(data.secret="cheatcode")))}function hitsButton(t,a,e,i){var i=i||3,s=e.offsetX,r=e.offsetY
return s>=t&&t+5*i>=s&&r>=a&&a+7*i>=r?!0:void 0}var song={songData:[{i:[0,125,116,1,0,125,116,0,1,0,4,6,35,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[135,135,,135,135,,135,135,,135,135,,135,,135],f:[]}]},{i:[2,40,140,1,0,0,140,0,0,255,5,0,48,0,0,0,0,0,0,3,161,192,0,32,0,0,71,1],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[,,135,,,,135,,,,135,,,,135],f:[]}]},{i:[0,192,104,1,0,80,99,0,0,0,4,0,66,0,0,3,0,0,0,1,0,1,2,32,37,4,0,0],p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[135,,,,135,,,,135,,,,135],f:[]}]},{i:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,0,0,69,3,1,1,23,167,0,32,77,6,25,6],p:[,,,,1,2,1,3,1,2,1,3,1,2,1,3,,,,,1,2,1,3,1,2,1,3,1,2,1,3,,,,,1,2,1,3,1,2,1,3,1,2,1,3,,,,,1,2,1,3,1,2,1,3,1,2,1,3],c:[{n:[135,135,,135,135,,135,135,,135,135,,138,,140],f:[]},{n:[135,135,,135,135,,135,135,,135,135,,133,,130],f:[]},{n:[135,135,,135,135,,135,135],f:[]}]},{i:[1,255,128,0,1,154,128,9,0,0,7,5,52,0,0,0,0,0,0,2,255,0,0,32,0,3,0,0],p:[1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,,3,3,3,4,3,3,3,4,1,3,1,4,1,3,5,6,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,,3,3,3,4,3,3,3,4,1,3,1,4,1,3,5,6],c:[{n:[111,,111,,123,,111,116,,116,,118,,116,118,121],f:[]},{n:[111,,111,,123,,111,116,,116,,118,,116,118,116],f:[]},{n:[111,,123,,111,,123,121,,120,,118,,116,118,116],f:[]},{n:[118,,118,,121,,118,121,,118,,121,,118,121,123],f:[]},{n:[116,,116,,128,,116,121,,121,,123,,121,123,126],f:[]},{n:[118,,118,,130,,118,130,,123,128,,126,,125],f:[]}]},{i:[1,192,128,0,1,191,116,9,0,0,6,22,34,0,0,0,69,3,1,1,23,167,0,32,77,6,25,6],p:[,,,,,,,1,,,,,,,,1,,,,,,,,1,,,,,,,,,,,,,,,,1,,,,,,,,1,,,,,,,,1],c:[{n:[,,,,,,,,147,,147,,147,,147,147],f:[]}]}],rowLen:5011,patternLen:16,endPattern:63,numChannels:6},CPlayer=function(){var t,a,e,i,s,r=function(t){return Math.sin(6.283184*t)},n=function(t){return 2*(t%1)-1},o=function(t){return.5>t%1?1:-1},d=function(t){var a=t%1*4
return 2>a?a-1:3-a},h=function(t){return.003959503758*Math.pow(2,(t-128)/12)},c=function(t,a,e){var i,s,r,n,o,d,c,p=l[t.i[0]],f=t.i[1],y=t.i[3],u=l[t.i[4]],w=t.i[5],v=t.i[8],m=t.i[9],x=t.i[10]*t.i[10]*4,g=t.i[11]*t.i[11]*4,S=t.i[12]*t.i[12]*4,M=1/S,b=t.i[13],T=e*Math.pow(2,2-t.i[14]),F=new Int32Array(x+g+S),P=0,z=0
for(i=0,s=0;x+g+S>i;i++,s++)s>=0&&(b=b>>8|(255&b)<<4,s-=T,d=h(a+(15&b)+t.i[2]-128),c=h(a+(15&b)+t.i[6]-128)*(1+8e-4*t.i[7])),r=1,x>i?r=i/x:i>=x+g&&(r-=(i-x-g)*M),n=d,y&&(n*=r*r),P+=n,o=p(P)*f,n=c,v&&(n*=r*r),z+=n,o+=u(z)*w,m&&(o+=(2*Math.random()-1)*m),F[i]=80*o*r|0
return F},l=[r,o,n,d]
this.init=function(r){t=r,a=r.endPattern,e=0,i=r.rowLen*r.patternLen*(a+1)*2,s=new Int32Array(i)},this.generate=function(){var n,o,d,h,p,f,y,u,w,v,m,x,g,S,M=new Int32Array(i),b=t.songData[e],T=t.rowLen,F=t.patternLen,P=0,z=0,C=!1,D=[]
for(d=0;a>=d;++d)for(y=b.p[d],h=0;F>h;++h){var R=y?b.c[y-1].f[h]:0
R&&(b.i[R-1]=b.c[y-1].f[h+F]||0,16>R&&(D=[]))
var I=l[b.i[15]],j=b.i[16]/512,k=Math.pow(2,b.i[17]-9)/T,B=b.i[18],E=b.i[19],L=43.23529*b.i[20]*3.141592/44100,A=1-b.i[21]/255,O=1e-5*b.i[22],V=b.i[23]/32,W=b.i[24]/512,G=6.283184*Math.pow(2,b.i[25]-9)/T,U=b.i[26]/255,K=b.i[27]*T&-2
for(m=(d*F+h)*T,p=0;4>p;++p)if(f=y?b.c[y-1].n[h+p*F]:0){D[f]||(D[f]=c(b,f,T))
var N=D[f]
for(o=0,n=2*m;o<N.length;o++,n+=2)M[n]+=N[o]}for(o=0;T>o;o++)u=2*(m+o),v=M[u],v||C?(x=L,B&&(x*=I(k*u)*j+.5),x=1.5*Math.sin(x),P+=x*z,g=A*(v-z)-P,z+=x*g,v=3==E?z:1==E?g:P,O&&(v*=O,v=1>v?v>-1?r(.25*v):-1:1,v/=O),v*=V,C=v*v>1e-5,w=Math.sin(G*u)*W+.5,S=v*(1-w),v*=w):S=0,u>=K&&(S+=M[u-K+1]*U,v+=M[u-K]*U),M[u]=0|S,M[u+1]=0|v,s[u]+=0|S,s[u+1]+=0|v}return e++,e/t.numChannels},this.createWave=function(){var t=44,a=t+2*i-8,e=a-36,r=new Uint8Array(t+2*i)
r.set([82,73,70,70,255&a,a>>8&255,a>>16&255,a>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&e,e>>8&255,e>>16&255,e>>24&255])
for(var n=0,o=t;i>n;++n){var d=s[n]
d=-32767>d?-32767:d>32767?32767:d,r[o++]=255&d,r[o++]=d>>8&255}return r},this.getData=function(t,a){for(var e=2*Math.floor(44100*t),i=Array(a),r=0;2*a>r;r+=1){var n=e+r
i[r]=t>0&&n<s.length?s[n]/32768:0}return i}},player=new CPlayer
player.init(song)
var musicGenerated=!1,data={INTERVAL:1e3/60,lastTime:(new Date).getTime(),debug:!1,secret:!1,scene:"start",previousScene:"start",optionsPage:0,lastScore:0,highScore:0,sah:46,messageLog:[],musicVolume:5,soundVolume:5,sound:!0,gfx:!0,cheats:{invulnerability:!1,disableBosses:!1,hyperMode:!1,tether:!1},smartBomb:0,waves:[new Wave({waveType:"shooter",spawn:function(t){data.enemies.push(new Enemy({enemyType:"shooter",dir:t}))}}),new Wave({waveType:"hover",isValid:function(){return!enemyExists("hover")},spawn:function(t){data.enemies.push(new Enemy({enemyType:"hover",dir:t}))}}),new Wave({waveType:"standard",spawn:function(t){for(var a=Math.floor(7*Math.random()),e=0;7>e;e++)data.enemies.push(new Enemy({enemyType:e===a?"standardElite":"standard",dir:t,y:(canvas.height-data.sah)/8*(e+1)+data.sah,setBack:60*e}))}}),new Wave({waveType:"standardV",spawn:function(t){for(var a=Math.floor(7*Math.random()),e=0;7>e;e++)data.enemies.push(new Enemy({enemyType:e===a?"standardElite":"standard",dir:t,y:(canvas.height-data.sah)/8*(e+1)+data.sah,setBack:40*Math.abs(e-3)}))}}),new Wave({waveType:"waveV",spawn:function(t){for(var a=Math.floor(6*Math.random()),e=Math.random()>.5,i=0;6>i;i++)data.enemies.push(new Enemy({enemyType:i===a?"waveElite":"wave",dir:t,y:(canvas.height-data.sah)/7*(i+1)+data.sah,setBack:40*i,waveData:{yDir:e?1:-1}}))}}),new Wave({waveType:"waveH",spawn:function(t){for(var a=(.8*Math.random()+.1)*(canvas.height-data.sah)+data.sah,e=Math.floor(8*Math.random()),i=0;8>i;i++)data.enemies.push(new Enemy({enemyType:i===e?"waveElite":"wave",dir:t,y:a,setBack:100*i,waveData:{yDir:a>(canvas.height-data.sah)/2?-1:1}}))}}),new Wave({waveType:"dive",spawn:function(t){for(var a=Math.floor(4*Math.random()),e=0;4>e;e++)data.enemies.push(new Enemy({enemyType:e===a?"diveElite":"dive",dir:t}))}}),new Wave({waveType:"asteroid",spawn:function(t){for(var a=Math.ceil(3*Math.random()),e=0;a>e;e++)data.enemies.push(new Enemy({enemyType:"asteroid",dir:t,y:Math.random()*canvas.height/2+canvas.height/4,waveData:{asteroidSize:3,rot:Math.PI/2-t*Math.PI/2+(2*Math.random()-1)*Math.PI/8,drawDR:Math.random()>.5?1:-1,drawRot:Math.random()*Math.PI*2,seed:(Math.random()+"").substring(2)}}))}}),new Wave({waveType:"boss",isValid:function(){return!enemyExists("boss")&&data.bossCounter>20&&!data.cheats.disableBosses},spawn:function(t){data.enemies.push(new Enemy({enemyType:"boss",dir:t,y:Math.random()*canvas.height/2+canvas.height/4,setBack:400,hp:50,size:64})),data.messageLog.push(new Message("BOSS APPROACHING",1-(t+1)/2))}})],lootTypes:{weapons:["twinShot","missile","laser","chaingun"],others:["smartBomb","shield","heart"],boss:["heart"]},enemyDefs:{standard:{sprite:"s",score:10,ai:"standard"},standardElite:{sprite:"s",score:10,powerups:"weapons",powerupChance:.5,ai:"standard"},wave:{sprite:"w",score:20,ai:"wave"},waveElite:{sprite:"w",score:20,powerups:"weapons",powerupChance:.5,ai:"wave"},dive:{sprite:"k",score:30,ai:"dive"},diveElite:{sprite:"k",score:30,powerups:"weapons",powerupChance:.5,ai:"dive"},shooter:{sprite:"q",score:40,speed:2,powerups:"others",powerupChance:.5,ai:"shooter",fireRate:40},hover:{sprite:"o",score:40,speed:3,powerups:"others",powerupChance:.5,ai:"hoverer",fireRate:40},boss:{sprite:"o",score:200,speed:2,powerups:"boss",powerupChance:1,ai:"boss",fireRate:60,onDeath:function(t){if(playSFX("blast",t.x),data.gfx)for(var a=0;8>a;a++)data.particles.push(new Explosion({x:t.x+t.dir*t.size/2-64+64*Math.random(),y:t.y-32+64*Math.random()}))}},asteroid:{sprite:" ",score:10,speed:3,ai:"asteroid",onDeath:function(t){if(t.waveData.asteroidSize>1)for(var a=Math.random(),e=-1;2>e;e+=2)data.enemies.push(new Enemy({enemyType:"asteroid",dir:t.dir,y:t.y,setBack:-1*((1===t.dir?t.x:canvas.width-t.x)+16),waveData:{asteroidSize:t.waveData.asteroidSize-1,rot:t.waveData.rot+e*(a*Math.PI/8+Math.PI/16),drawDR:Math.random()>.5?1:-1,drawRot:Math.random()*Math.PI*2,seed:(Math.random()+"").substring(2)}}))},draw:function(t){var a=t.waveData.seed,e=t.waveData.asteroidSize
ctx.save(),ctx.translate(t.x,t.y),t.waveData.drawRot+=t.waveData.drawDR*Math.PI/8/t.size,ctx.rotate(t.waveData.drawRot),ctx.fillStyle="#666",ctx.beginPath(),ctx.moveTo(0,t.size/2+a[0]/2*e-2*e)
for(var i=4*e,s=0;i>s;s++){var r=t.size/2+a[s]/2*e-2*e
ctx.lineTo(Math.sin(s*Math.PI*2/i)*r,Math.cos(s*Math.PI*2/i)*r)}ctx.fill(),ctx.restore()}}},enemyAI:{shoot:function(t){t.framesSinceLastShot++,t.framesSinceLastShot>=t.fireRate&&(t.framesSinceLastShot=0,data.projectiles.push(new Projectile({projectileType:"enemy",player:!1,x:t.x+t.dir*t.size/2-16,y:t.y,rot:t.dir>0?0:Math.PI})))},hover:function(t){var a=canvas.width/2-canvas.width*(3/8)*t.dir;(a-t.x)*t.dir>0?t.move(t.speed*t.dir,0):(t.yDir=t.yDir||2*Math.round(Math.random())-1,t.y<1*canvas.height/8&&(t.yDir=1),t.y>7*canvas.height/8&&(t.yDir=-1),t.move(0,t.speed*t.yDir))},standard:function(t){t.move(t.speed*t.dir,0)},wave:function(t){t.move(t.speed*t.dir,2*Math.sin(t.x/240)*t.waveData.yDir)},dive:function(t){t.move((t.speed/2+t.lifeTimer*t.lifeTimer/500)*t.dir,0)},shooter:function(t){var a=1===t.dir?data.players[0]:data.players[1],e=a.y-t.y
0!=e&&(t.dy+=e/Math.abs(e)*t.speed/10),t.dy>t.speed/2&&(t.dy=t.speed/2),t.dy<t.speed/-2&&(t.dy=t.speed/-2),t.move(t.speed*t.dir,t.dy),data.enemyAI.shoot(t)},hoverer:function(t){data.enemyAI.hover(t),data.enemyAI.shoot(t)},asteroid:function(t){var a=4-t.waveData.asteroidSize,e=t.waveData.rot
t.move(Math.cos(e)*a,Math.sin(e)*a)},boss:function(t){if(data.enemyAI.hover(t),t.inBounds&&(t.framesSinceLastShot++,t.framesSinceLastShot>=t.fireRate)){t.framesSinceLastShot=0
for(var a=0;3>a;a++){var e=t.dir>0?-1*Math.PI/10+Math.PI*a/10:9*Math.PI/10+Math.PI*a/10
data.projectiles.push(new Projectile({projectileType:"enemy",player:!1,x:t.x+t.dir*t.size/2-32,y:t.y,rot:e}))}}}},projectileDefs:{enemy:{symbol:">",palette:"3",ai:"standard",fireRate:8,speed:4},bullet:{symbol:">",palette:"4",ai:"standard",fireRate:8,speed:10},chaingun:{symbol:".",palette:"4",ai:"standard",fireRate:3,speed:10,damage:.5},missile:{symbol:"m",palette:"2",ai:"missile",fireRate:30,speed:8},laser:{symbol:">",palette:"4",ai:"laser",fireRate:48,speed:0},smartBomb:{symbol:".",palette:"4"}},projectileAI:{standard:function(t){var a=data.projectileDefs[t.projectileType].speed
t.move(Math.cos(t.rot)*a,Math.sin(t.rot)*a)},missile:function(t){var a=!1,e=canvas.width
for(var i in data.enemies){var s=data.enemies[i],r=s.y-t.y,n=s.x-t.x,o=Math.sqrt(r*r+n*n)
e>o&&(a=s,e=o)}if(a){t.target=a
var r=a.y-t.y,n=a.x-t.x,d=Math.atan2(r,n)
t.rot+=Math.PI/30*steer(d,t.rot)}var h=data.projectileDefs[t.projectileType].speed
t.move(Math.cos(t.rot)*h,Math.sin(t.rot)*h)},laser:function(t){t.lifeTime++,t.lifeTime>10&&(t.cull=!0)}},powerupDefs:{twinShot:{name:"Twin Shot",symbol:"≺"},chaingun:{name:"Rapid Fire",symbol:"≡"},missile:{name:"Missiles",symbol:"m"},laser:{name:"Laser",symbol:"-"},smartBomb:{name:"Smart Bomb",symbol:"B"},shield:{name:"Shield",symbol:"s"},heart:{name:"1 UP!",symbol:"♥"}},sfxDefs:{playerExplode:function(t){zzfx(data.soundVolume/10,.1,0,.8,.05,.7,4.6,21.2,.4,t)},explode:function(t){zzfx(data.soundVolume/30,.1,1811,.8,.01,1.9,3,.5,.04,t)},powerup:function(t){zzfx(data.soundVolume/10,.1,240,.2,.85,5.7,.8,0,.77,t)},shieldDest:function(t){zzfx(data.soundVolume/10,.1,1750,.7,.05,.1,1.8,.3,.18,t)},blast:function(t){zzfx(data.soundVolume/10,.1,5e3,1.7,.01,0,4,0,.45,t)}}}
setup(),document.body.onkeydown=function(t){if(data.keys[t.keyCode])return!1
if("undefined"==typeof music)return!1
if(77===t.keyCode)return data.sound=!data.sound,setVolume(data.musicVolume/10),!1
if("start"===data.scene){if(27===t.keyCode)return updateScene("options"),!1
updateScene("game"),setVolume(data.musicVolume/10)}else"end"===data.scene?27===t.keyCode&&(updateScene("start"),initialiseData()):"options"===data.scene?27===t.keyCode?updateScene(data.previousScene):37===t.keyCode?data.optionsPage>0&&data.optionsPage--:39===t.keyCode&&data.optionsPage<2&&data.optionsPage++:data.keys[t.keyCode]=!0},document.body.onkeyup=function(t){data.keys[t.keyCode]=!1}

</script></body></html>