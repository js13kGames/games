<html lang=en><meta name=viewport content="width=device-width"><title>Pawfect Stack - Oracle of Order - js13kGames 2025</title><style>body{--sw:64px;--sh:208px;font-family:monospace;background-color:#feebc9;image-rendering:pixelated;display:flex;flex-direction:column;align-items:center;justify-content:center;padding:8px;margin:8px;min-width:768px;min-height:700px}main{width:768px;height:700px;box-sizing:border-box;border:4px solid #331c1a;background-color:#f0e4d7;display:flex;flex-shrink:0;align-items:stretch;justify-content:stretch;overflow:hidden;border-radius:3px;user-select:none}main>section{width:100%;position:relative;display:none;flex-direction:column;overflow:hidden}[data-cs=_1] #_24,body:not([data-cs]) #_24{display:none}#_24{font-size:1rem;font-weight:700;color:inherit;display:flex;justify-content:center;flex-direction:column;align-items:center}#_24 label{cursor:pointer}#_24 input{cursor:pointer;margin:0;position:relative;top:2px}#_1 h1,#_1 h2{color:transparent;user-select:none;width:335px;height:210px;overflow:hidden;background-image:url("data:image/png;base64,UklGRm4BAABXRUJQVlA4TGIBAAAvQkAKEB8gJCBTsg3uEQgQniR60iemIeTQ/5DS5j8A6Z8FchvbjiOLsygEzaTTIcyiJ6KfQ2s25vDxkmi1IX8WvnhEyOwoCFkP1xBbAn4EEf2fgAO1bucT0Z7u57jn9B90tG7puuu0p+03J+X0zceUorKeNd6cNOo3x+/KuOKo59VbHHhMb9dSojjwMVFt1K/EemZajXHsayNTatxJx5H3nJVVY6I41HhQ1h+uHCvfPacKMafGDfzdxzRwImXl1Lpv/u71Wp8eHO2+6XY1h4IMSBHKCObRPBlmAAVUEHCRpgMuNYPYLDcTcJnFKrBlVS5ZSoG3GbaEm0mKz0IGD4IhuAlE1/4ZvOsQKosHkaF1T4ZK2eQrofLoDoSQhYCad09UtgX3JFvMlnDTSa6JEWyRm0lKyJIli82wWZoJqBAMYjOaboUihAIxj/bJ4AsKMgoCAh4PWVra3DqiptvUuCdyOwE=");background-size:contain;margin:auto}#_1 h2{width:360px;height:75px;background-image:url("data:image/png;base64,UklGRvAAAABXRUJQVlA4TOMAAAAvdwAGEBcgEEhiXnshgWxylvwZm0AgyZ9gpa3mP+BfAeTWtuM2gpcuRf28B/DvPZBVuInPDKvxG+Jrk6QBIg1E9H8CtkML9+2hpaevNedjzb5K/xwFjVEcDd5Z0A2GBEkFGW5hzsYBnTAUJDSp5Ai34AfFTwWb02gpR05Nsjb6pKjiiOhyjpJHl6iVohhmVRPM8BI7H2BGHzxfuhRocJnJrM5iFlHJTxZ+FgzY5dSkcomIJ4mBQ16NlvJlhOzVaU7QJYnOlGBIl5DE0rWYWTAnN6TcrT3W7Ku+1pwfa07bsWLfAAA=");background-size:contain;background-repeat:no-repeat;margin-top:4px;transform:translateX(200%);border:4px solid #331c1a;background-color:#331c1a;border-radius:25px;animation:k1 .5s cubic-bezier(.175,.885,.32,1.275) forwards;animation-delay:.5s}@keyframes k1{0%{transform:translateX(200%)}100%{transform:translateX(0)}}#_1 ._3{margin-top:90px}#_1 .p{font-size:2rem;text-align:center;margin-top:96px}#_1 a{position:absolute;inset:0;display:flex;justify-content:center;align-items:flex-end;padding-bottom:150px}#_1 a,#_1 a:hover,#_23,._8 a{color:inherit;text-decoration:none;font-weight:700;text-transform:uppercase;transition:transform .2s ease}#_23:hover,a:hover{transform:scale(1.05)}._8 a{color:#fff;text-decoration:underline}._8 a:hover{text-decoration:none}#_23{border:0;color:inherit;background:0 0;font-size:1.2rem;cursor:pointer;text-decoration:underline}._0,._0:visited{font-weight:700;text-decoration:none;color:#feebc9;font-size:1rem;position:absolute;top:8px;right:8px}._0:hover{text-decoration:underline}._12{border:16px solid #000}#_3{display:flex;flex-direction:row;align-items:flex-end;padding:64px;justify-content:space-around;background-color:#3a2520;background-image:conic-gradient(from 135deg,#ffffff0d 0 25%,transparent 0 50%,#0000000d 0 75%,transparent 0);background-size:190px 192px}._8{background:#000;color:#feebc9;width:100%;flex:1;margin-top:auto;border:8px solid #feebc9;box-sizing:border-box;font-size:2.3rem;padding:64px;cursor:pointer;position:relative;z-index:101}._8:not(._4)::after{content:"";display:block;position:absolute;right:16px;bottom:24px;border:24px solid transparent;border-left-color:#feebc9;pointer-events:none;animation:k2 1s steps(1) infinite}._8.end::after{border-color:#feebc9;right:40px}._8._4{cursor:default}@keyframes k2{0%,60%{opacity:1}100%,61%{opacity:0}}.c{animation:k0 1s steps(2) infinite}@keyframes k0{from{background-position:var(--x) var(--y)}to{background-position:var(--tx) var(--ty)}}._10,._11,._9{width:128px;height:128px;background-size:calc(var(--sw) * 8) calc(var(--sh) * 8)}#_16>div._2,._10,._11,._9,div.s{background-image:url("./s.png")}._10.left,._11.left,._9.left{transform:scaleX(-1)}._10{--x:-0;--y:-1152px;--tx:-256px;--ty:-1152px}#_6 ._10{transform:scale(.75);position:absolute;bottom:0}._9{--x:-0;--y:-1408px;--tx:-256px;--ty:-1408px}._11{z-index:110;--x:-256px;--y:-1408px;--tx:-512px;--ty:-1408px}._11._1{--x:-256px;--y:-1536px;--tx:-512px;--ty:-1536px}.c._17{--tx:var(--x);--ty:calc(var(--y) - 256px)}.c._7{--tx:var(--x);--ty:var(--y)}._10._18{--x:-128px;--y:-1280px}._9.r{animation:k0 1s steps(2) infinite,k3 2s ease-in-out infinite alternate,k4 2.4s ease-in-out infinite alternate;transform-origin:50% 70%;z-index:105;position:relative}@keyframes k3{0%,100%,50%{bottom:0}25%{bottom:4px}75%{bottom:-3px}}@keyframes k4{from{filter:drop-shadow(0 0 0 transparent)}to{filter:drop-shadow(0 0 12px #feebc9)}}#_5,._12{background:#331c1a}#_5 ._8{font-size:1rem;padding:0 24px;cursor:default;display:flex;align-items:center;overflow:hidden;position:relative}#_18{width:50%;border-right:8px solid #feebc9;padding-right:8px;height:100%;display:flex;align-items:center}._15 #_18{width:100%;border-right:none}#_5 ._8._15:not(._16)::after{display:block;right:8px;bottom:12px;border-width:12px}._15 #_18+#_19{display:none}#_19{flex:1;padding-left:8px;display:flex;justify-content:space-evenly;align-items:center;position:relative;align-self:stretch}#_19 canvas{cursor:pointer;padding:2px;border:1px dashed transparent}#_19 canvas:hover{border-color:#feebc9}#_19 span{position:absolute;left:2px;top:0;background:#000}#_5 ._8::after{display:none}#_12{margin:0 auto;padding:48px;position:relative;overflow:hidden}#_16{position:relative;border-collapse:collapse;background:#331c1a;display:grid;margin:auto;grid-template-columns:repeat(10,48px);grid-template-rows:repeat(10,48px);column-gap:0;row-gap:0}#_12 .cat{z-index:0}#_13{position:absolute;top:12px;left:0;z-index:10;right:0;text-align:center;font-size:1rem}#_13 b{background-color:#613531;color:#feebc9}#_12>canvas{position:absolute;left:0;top:0;z-index:2}#_12Canvas{z-index:0!important}#_12._20>canvas{pointer-events:none}#_16>div{border:1px solid #feebc933;position:relative;overflow:hidden}#_16>div._2,div.s{background-color:#331c1a;border-color:#331c1a;background-size:calc(var(--sw) * 3) calc(var(--sh) * 3);background-position:var(--bx,0) var(--by,-240px)}div._2.v1{--bx:-48px;--by:-240px}#_17,#_6{position:absolute;right:16px;display:flex;flex-direction:column;gap:16px;justify-content:center;align-items:center;top:16px;color:#feebc9;font-size:1.2rem;font-weight:700}#_6{right:auto;left:16px;justify-content:flex-start;height:560px;min-width:63px}dl{font-size:.9rem}dt{font-weight:700}dd{font-weight:400;margin-left:16px;margin-bottom:24px}div.s{width:48px;height:48px;border:1px dashed #feebc9;cursor:pointer;position:relative}div.s._13{opacity:.5;pointer-events:none}#_12 div.s{position:fixed;left:0;top:0;border-style:solid;pointer-events:none;z-index:100}#_17>div._19,#_17>div:hover{border-style:solid}#_17>div._19{background-image:none}#_17>div._19:before{content:"X";position:absolute;left:0;right:0;text-align:center;font-size:2rem;top:3px}#_17>div:after{content:attr(data-cost);width:16px;height:16px;display:block;position:absolute;right:-20px;line-height:16px;padding:1px}div.Rotaleftus:after{transform:scaleX(-1);right:50px!important}#_20{position:absolute;left:0;top:0;right:0;bottom:0;color:#feebc9;font-size:2rem;text-align:center;z-index:1000;display:none}#_20>div{background-color:#331c1a;border-style:solid;border-width:4px 0;padding:16px 0}#_20>div *{margin:8px;padding:0}#_20.v{display:flex;flex-direction:column;align-items:center;justify-content:center}[data-cs=_1] main{background-image:conic-gradient(from 45deg,#ffae99 0 50%,#a0302d 0 100%)}div.Rotaleftus,div.Rotarigus{--bx:-144px;--by:-480px}div.Rotaleftus{transform:scaleX(-1)}div.Hydravo{--bx:0;--by:-96px}div.Ejectum{--bx:-48px;--by:-384px}.h #_17>div:after,.r #_17>div:after{display:none}.h #_17>div.s:not(._19),.r #_17>div.s:not(._19){opacity:.3;pointer-events:none}.h #_16~canvas:not(.c6),.r #_12 .cat{pointer-events:none}.h #_12 .c6,.h #_12 .cat{cursor:pointer}.r #_16~canvas:hover{opacity:.3;cursor:pointer}</style><link id=_0 rel=icon href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAvklEQVR4AYSR0QnCQBiDz+7gi7iEiDiHkzqHiLiE+OIOVr6jgdDLj4U0vf7Jd1c6teI67nezq4i1CKC4LqR3ZCKAweP13uCuBImAVBYICNI6Ahh6iHWlEuCnuD+vve+uDUqAAip1wnI7HS5NG0SAyku+m0A4+n5uM4MB4GWChBC7Sqyn7bn/pQHA0SQvAJNU7iBu/ySQ3PPDCTSsPkVzeQlQAGdnPCkCfPdU8vkA8GEqr98NAP0BnDAu+Zpn9AMAAP//09tkKwAAAAZJREFUAwDFn2fx4bi1fQAAAABJRU5ErkJggg=="><style>body[data-cs="_1"] section#_1,body[data-cs="_2"] section#_2,body[data-cs="_5"] section#_5{display:flex}</style><body data-cs=_1><main><section id=_1><div class=_3><h1>Pawfect Stack</h1><h2>Oracle of Chaos</h2></div><p class=p><a href=#_2>Click to start</a></section><section id=_2 class=_12><div id=_3></div><div class=_8></div><a id=_4 class=_0 href=#_5>Skip</a></section><section id=_5><div id=_6><div id=_7><span>Goals</span><dl><dt>Items<dd><span id=_8>0</span>/<span id=_9>10</span><dt>Magic<dd><span id=_10>0</span>/<span id=_11>100</span></dl></div><div class="c _10"></div></div><div id=_12><div id=_13><b>Level <span id=_13Index></span>/3</b></div><canvas id=_12Canvas width=576 height=576></canvas><div id=_16></div></div><div id=_17></div><div class=_8><div id=_18></div><div id=_19></div></div><aside id=_20><div><h2 id=_21></h2><p id=_22></p><button id=_23></button></div></aside></section></main><p class=p id=_24><label><input id=_25 type=checkbox> Enable sounds</label><br><a id=_26 href=#>Reset save</a></p><script>let e=document,t=Math,n=Promise,a=e.body;!function(){let r=[],i={},l=()=>{};function s(e,t={}){i=t,location.hash=e}let o=[["Potion","A small object highly concentrated in magic, but fragile.",4,[[1]],[32,0],0],["Cauldron","The classic tool in any wizard's kit.",6,[[1,1],[1,1]],[16,16],0],["Candle","A source of light and warmth, often used in magical rituals.",3,[[1],[1]],[48,0],0],["Dead Fish","",0,[[1,1],[1,0]],[0,0],1],["Hat","An old hat still highly concentrated in magic.",5,[[0,1],[1,1]],[32,32],0],["Broom","Perfect for wizards on the move, this magic broom is very bulky.",7,[[1,0],[1,1],[0,1]],[32,80],0],["Dried Plant","This thirsty plant needs water and has lost much of its magic.",1,[[1]],[0,112],0],["Dead Mouse","",0,[[1,1]],[0,48],1],["Magic Wand","A very powerful magical tool... and bulky!",6,[[1,1,1,1]],[0,64],0],["Ball of Wool","",0,[[1]],[32,128],1],["Dead Snake","",0,[[0,1],[1,1],[1,0]],[32,128],1],["Grimoires","If they're put next to other grimoires, their magic increases.",2,[[1]],[0,128],0],["Grimalkin","",0,[[1]],[32,176],2]],c="./s.png",u=0;function f(e,n=3,a=null,r=!1,i=[]){let l=16*n,s=e[7],o=s.getContext("2d"),u=new Image;u.src=c;let f=e[3][0].length*l,d=e[3].length*l;f!==s.width&&d!==s.height&&(s.width=f,s.height=d),u.onload=()=>{o.imageSmoothingEnabled=!1;let n=(e[8]??0)%360,s=e[3],c=s.length,f=s[0].length;function d(e,t,n){return 90===n?[f-1-t,e]:180===n?[c-1-e,f-1-t]:270===n?[t,c-1-e]:[e,t]}for(let h=0;h<c;h++)for(let c=0;c<f;c++)if(1===s[h][c]){let s=c*l,f=h*l;o.clearRect(s,f,l,l),i.find(e=>e[1]===c&&e[0]===h)?(o.fillStyle="#ff000099",o.fillRect(s,f,l,l)):a&&(o.fillStyle=a,o.fillRect(s,f,l,l));let[m,g]=d(h,c,n);o.save(),o.translate(s+l/2,f+l/2),o.rotate(n*t.PI/180),o.drawImage(u,e[4][0]+(r?0:16*g),e[4][1]+(r?0:16*m),16,16,-l/2,-l/2,l,l),o.restore()}}}function d(e){return e&&o.findIndex(t=>t[0]===e[0])}function h(e){let n=e[3].reduce((e,t)=>e+t.reduce((e,t)=>e+t,0),0);e[7].style.zIndex=t.max(1,10-n)}function m(e){let n=[...e[t.floor(t.random()*e.length)]];return n[6]=++u,n}function g(t){let n=(t=>e.getElementById(t))("i"+t);return n?._0}function p(e,t,n,a){let r=e[3],i=[];for(let e=0;e<r.length;e++)for(let l=0;l<r[e].length;l++)r[e][l]&&(a+e<0||a+e>=t.length||n+l<0||n+l>=t[0].length||0!==t[a+e][n+l])&&i.push([e,l]);return i}function _(e,t,n,a){let r=e[3],i=t.map(e=>[...e]);for(let t=0;t<r.length;t++)for(let l=0;l<r[t].length;l++)r[t][l]&&(i[a+t][n+l]=e[6]);return i}function y(e,t){let n=t.map(e=>[...e]);for(let t=0;t<n.length;t++)for(let a=0;a<n[t].length;a++)n[t][a]===e&&(n[t][a]=0);return n}function v(e,t){let n=new Set;for(let a=0;a<t.length;a++)for(let r=0;r<t[a].length;r++)if(t[a][r]===e)for(let i=a+1;i<t.length;i++){let a=t[i][r];if(a!==e){if(!a||a<1)break;n.add(a);break}}return Array.from(n)}let w=(()=>{let e=()=>Array.from({length:10},()=>Array(10).fill(0)),t=e();t[0][9]=-1,t[0][0]=-1,t[8][4]=-1,t[8][5]=-1,t[9][3]=-1,t[9][4]=-1,t[9][5]=-1,t[9][6]=-1;let n=e();n[0][4]=-1,n[0][5]=-1,n[1][4]=-1,n[1][5]=-1,n[2][4]=-1,n[2][5]=-1,n[4][0]=-1,n[4][9]=-1,n[5][0]=-1,n[5][9]=-1,n[7][4]=-1,n[7][5]=-1,n[8][4]=-1,n[8][5]=-1,n[9][4]=-1,n[9][5]=-1;let a=e();return a[0][9]=-1,a[0][0]=-1,a[2][1]=-1,a[2][2]=-1,a[2][7]=-1,a[2][8]=-1,a[4][4]=-1,a[4][5]=-1,a[5][4]=-1,a[5][5]=-1,a[7][1]=-1,a[7][2]=-1,a[7][7]=-1,a[7][8]=-1,a[9][9]=-1,a[9][0]=-1,[t,n,a]})(),T=[15,18,20],L=[40,60,70],b="pawfect-stack-storage";function x(){let e=localStorage.getItem(b);try{return JSON.parse(e)||{}}catch(e){return{}}}let k,A={},M=()=>A,E=(e,t)=>{return n=k(A,e,t),A=n,void function(e,t){!function(e){localStorage.setItem(b,JSON.stringify(e))}({...x(),state:t})}(0,A);var n},S={m:!0,b:null,s:0,order:0,chaos:0};function C(e=S,t,n){switch(t){case"_0":return{...e,b:n,s:0};case"_1":return{...e,b:n};case"_2":return{...e,s:e.s+n};case"toggleMuteSounds":return{...e,m:n};case"_3":return{...e,order:n};default:return e}}let H=()=>M().b;function I(e){let t=[];return e.forEach((e,n)=>{t[n]=[],e.forEach((e,a)=>{let r=g(e),i=!!r&&11===d(r);t[n][a]=i?1:0})}),t}function P(e,t,n,a){let r=e.length,i=r?e[0].length:0,l=[[1,0],[-1,0],[0,1],[0,-1]],s=[[t,n]];a[t][n]=!0;let o=0;for(;s.length;){let[t,n]=s.pop();o++;for(let[o,c]of l){let l=t+o,u=n+c;l>=0&&l<r&&u>=0&&u<i&&!a[l][u]&&1===e[l][u]&&(a[l][u]=!0,s.push([l,u]))}}return o}let O=()=>{let e=H(),t=new Set;return e.forEach(e=>{e.forEach(e=>{e>0&&t.add(e)})}),Array.from(t)},R=()=>O().filter(e=>{let t=g(e);return t?.[5]<2}).length,X=()=>M().m;function N(){return O().reduce((e,t)=>{let n=g(t);return e+(11===d(n)?0:n?.[2]??0)},0)-(M().s??0)+(()=>{let e=I(H()),t=0,n=e.length,a=n?e[0].length:0,r=Array.from({length:n},()=>Array(a).fill(!1));for(let i=0;i<n;i++)for(let n=0;n<a;n++)if(1===e[i][n]&&!r[i][n]){let a=P(e,i,n,r);t+=a*(a+1)}return t})()}function q(e){if(X())return;let t=new AudioContext,n=t.createBuffer(1,96e3,48e3),a=n.getChannelData(0);for(let t=96e3;t--;)a[t]=e(t);let r=t.createBufferSource();r.buffer=n,r.connect(t.destination),r.start()}function V(){if(X())return;let e=1.05946,n=[13,,13,,10,,13,,6,,10,,13,,,,2,13,10,,13,,6,,8,,6,,5,,,,10,,10,,11,,10,,8,,6,,5,,2,13,10,,8,,6,,5,,6,,8,,10,,,,];V.ctx||(V.ctx=new AudioContext);let a=V.ctx,r=t.max(a.currentTime+.03,0),i=a.createGain();i.gain.value=.85,i.connect(a.destination),n.forEach((n,l)=>{let s=r+.25*l,o=s+.24;if(n){let r=a.createOscillator(),l=a.createGain();r.type="square",r.frequency.setValueAtTime(440*t.pow(e,13-n),s),l.gain.setValueAtTime(0,s),l.gain.linearRampToValueAtTime(.9,s+.01),l.gain.exponentialRampToValueAtTime(1e-4,o),r.connect(l),l.connect(i),r.start(s),r.stop(o+.01)}if(l%2==0){let n=l%4==0?13:6,r=a.createOscillator(),c=a.createGain();r.type="triangle",r.frequency.setValueAtTime(440*t.pow(e,13-n-12),s),c.gain.setValueAtTime(0,s),c.gain.linearRampToValueAtTime(.6,s+.01),c.gain.exponentialRampToValueAtTime(1e-4,o),r.connect(c),c.connect(i),r.start(s),r.stop(o+.01)}}),clearTimeout(V.timer),V.timer=setTimeout(()=>{"suspended"===a.state&&a.resume(),V()},.25*n.length*1e3)}function $(){q(e=>{let n=32e3;if(e>n)return null;let a,r=5760,i=(e<1440?e/1440:1)*t.exp(-e/11e3)*(e<n-r?1:1-(e-(n-r))/r),l=1200,s=t.pow(2,20/1200);if(e<l)a=880*(1+e/l*(s-1));else{let n=880,r=(e-l)/30800,i=t.pow(r,1.8);a=880*s*t.pow(n/(880*s),i)}let o=2*t.PI*e*a/48e3,c=(t.sin(o)+t.sin(2*o)*(.4*t.exp(-e/4800))+t.sin(3*o)*(.22*t.exp(-e/(.07*48e3)))+.015*(2*t.random()-1)*t.exp(-e/960))*i*.9;return t.tanh(1.3*c)})}function G(){q(e=>{if(e>24e3)return null;let n=(e<240?e/240:1)*t.exp(-e/5e3),a=.6*(2*t.random()-1),r=[3e3,4200,5600,7200],i=0;for(let n of r)i+=t.sin(2*t.PI*e*n/48e3)*t.exp(-e/7200);return(.4*a+.2*i)*n})}function B(){q(e=>{let n=48e3;if(e>12e3)return null;let a=t.exp(-e/4e3);return(t.sin(2*t.PI*e*600/n)+.4*t.sin(2*t.PI*e*900/n)+.2*t.sin(2*t.PI*e*(600+e/60)/n))*a*.8})}function D(e){e[7].addEventListener("mouseenter",()=>{e._1||(e.hover=!0,f(e,3,"#fff3"))}),e[7].addEventListener("mouseleave",()=>{e._1||(e.hover=!1,f(e,3,"#331c1a"))})}function Y(e,t,n){e[7].onmouseenter=()=>{if(e[10])return;let n=_18.innerHTML,a=e[0],r=e[1];_18.innerHTML=`<span><b>${a}</b>: ${r} ${t?`<i>(${t}: <b>${e[2]??0}</b>)</i>`:""}</span>`,e[7].onmouseleave=()=>{e[10]?e[10]=!1:_18.innerHTML=n}},e[7].onclick=n}function j(e){return new n(t=>{let n=e[7];e[4]=[32,112],e._1=!0,f(e,3,null,!0),n.inert=!0,n.onmouseleave=null,setTimeout(()=>{n.dispatchEvent(new MouseEvent("mouseleave")),n.remove(),E("_1",y(e[6],H())),t()},333)})}async function z(){let e=!1;do{let t=O();e=!1,await n.all(t.map(async t=>{let a=g(t),r=a[7],[i,l]=a[9],s=!1,o=i,c=y(a[6],H());for(;!s;)o++,s=p(a,c,l,o).length>0;let u=o-i-1,f=u>0;e=e||f;let h=i+u;if(a[9]=[h,l],E("_1",_(a,c,l,h)),!u)return;let m=v(a[6],H());await new n(e=>{let t=0,n=()=>{t++,r.style.top=Number(r.style.top.replace("px",""))+48+"px",t<u?setTimeout(n,300):0===d(a)?(G(),j(a).then(e)):e()};setTimeout(n,300)}),f&&await n.all(m.map(e=>{let t=g(e);return new n(e=>{0===d(t)?(G(),j(t).then(e)):e()})}))}))}while(e);_8.innerHTML=R(),_10.innerHTML=N()}function W(e,t){e.classList.add("_17"),e.classList.remove("_7"),t.classList.add("_7"),t.classList.remove("_17")}let J=0,U=0;function F(){return N()>=U}let K=null,Q=null;function Z(n,a){K=n,Q=a,_20.classList.remove("v"),_16.innerHTML="<div></div>".repeat(100),function(){[..._12.querySelectorAll("canvas")].forEach(e=>{e!==_12Canvas&&e.remove()}),_12Canvas.width=576,_12Canvas.height=576;let t=_12Canvas.getContext("2d"),n=new Image;n.src=c,n.onload=()=>{let a=e.createElement("canvas");a.width=96,a.height=48;let r=a.getContext("2d");r.imageSmoothingEnabled=!1,r.drawImage(n,0,80,32,16,0,0,96,48);let i=t.createPattern(a,"repeat");t.clearRect(0,0,_12Canvas.width,_12Canvas.height),t.setTransform(1,0,0,1,0,0),t.fillStyle=i,t.fillRect(0,0,_12Canvas.width,_12Canvas.height)}}(),_13Index.innerHTML=n+1;let[r,i,l]=((e=0)=>[w[e],T[e],L[e]])(n);r?(_8.innerHTML=0,_10.innerHTML=0,_9.innerHTML=i,_11.innerHTML=l,J=i,U=l,r.flat().forEach((e,n)=>{-1===e&&(_16.children[n].className=`_2 v${t.floor(2*t.random())}`)}),E("_0",r),a(n)):s("_2",{end:!0})}function ee(e,t=0,n=2){let a=e[8]??0;e[8]=(a+t)%360;let r=e[3];for(let e=0;e<t/90;e++){let e=[];for(let t=0;t<r[0].length;t++){let n=[];for(let e=r.length-1;e>=0;e--)n.push(r[e][t]);e.push(n)}r=e}return e[3]=r,e[7].width=e[7].width,f(e,n),e}function te(e,n){return[t.floor(e/n),e%n]}let ne=()=>new n(t=>{setTimeout(()=>{e.addEventListener("click",t,{once:!0})},1)}),ae=(e,t)=>new n(n=>{setTimeout(()=>{addEventListener(e,e=>{t?.(e),n(e)},{once:!0})},1)}),re=(e,t=[],n=[])=>{_18.innerHTML=e,_18.parentNode.classList.add(...t),_18.parentNode.classList.remove(...n)};function ie(n){let a=n||m(o.filter(e=>0===e[5]));a[7]=e.createElement("canvas"),a[7].className="c"+d(a),a[7].id="i"+a[6],a[7]._0=a,f(a,2),_19.append(a[7]),Y(a,"magic",async()=>{_19.inert=!0,await a[7].animate([{transform:"translateY(0)"},{transform:"translateY(-300px)"}],{duration:333,easing:"ease-in"}).finished,function(e){f(e,3);let n=e[7];n.style.left="240px",n.style.top="240px",n.style.zIndex=100,_12.append(n),_17.inert=!0;let a=!1;_12.classList.add("_20"),_16.onmousemove=t=>{_19.inert=!1;let r=Array.prototype.indexOf.call(t.target.parentNode.children,t.target),i=_16.getBoundingClientRect(),l=t.target.getBoundingClientRect(),s=n.style.left,o=n.style.top;if(n.style.left=l.left-i.left+48+"px",n.style.top=l.top-i.top+48+"px",s===n.style.left&&o===n.style.top)return;let[c,u]=te(r,10);e[9]=[c,u],n.getContext("2d").clearRect(0,0,n.width,n.height);let d=p(e,H(),u,c);a=0===d.length,_16.style.cursor=a?"grabbing":"not-allowed",f(e,3,"#fff3",!1,d)},_16.onclick=async n=>{if(!a)return;_19.inert=!0,_12.classList.remove("_20"),_19.onmouseenter=null,_16.onclick=null,_16.onmousemove=null,_16.style.cursor="default";let r=Array.prototype.indexOf.call(n.target.parentNode.children,n.target),[i,l]=te(r,10);f(e,3,"#331c1a"),e[7].onclick=null,h(e),D(e),E("_1",_(e,H(),l,i)),B(),await z(),le(),e[10]=!0,11===d(e)&&Object.defineProperty(e,"2",{get:()=>(e=>{let t=H(),n=I(t),a=null;for(let n=0;n<t.length&&!a;n++)for(let r=0;r<(t[n]||[]).length;r++)if(t[n][r]===e){a=[n,r];break}if(!a)return 0;let[r,i]=a,l=n.length,s=l?n[0].length:0;return P(n,r,i,Array.from({length:l},()=>Array(s).fill(!1)))+1})(e[6])});let s=new CustomEvent("_1",{detail:e});dispatchEvent(s);let o=!1;if(0===he||he>=3)if(ce()[7].parentNode){let e=[ge,de,de,ue,ue,ue],n=e[s.ci??t.floor(t.random()*e.length)];!1===await n()&&await ge(),o=n===de}else await ge();else he++;o||ie(),R()>=J?((e,n)=>{_21.innerHTML=e?"Congratulations!":"Oops...",_22.innerHTML=n,_23.innerHTML=e?"Next":"Retry";let a=K+1;e&&E("_3",a),_23.onclick=()=>Z(e?a:K,Q),_20.classList.add("v"),e?(()=>{if(X())return;let e=new AudioContext,n=e.createGain();n.connect(e.destination),[[13,0],[17,.12],[20,.24],[25,.36],[13,.48],[17,.48],[20,.48]].forEach(([a,r])=>{let i=e.createOscillator(),l=e.createGain();i.type="square",i.frequency.setValueAtTime(440*t.pow(1.05946,13-a),r),l.gain.setValueAtTime(1,r),l.gain.exponentialRampToValueAtTime(.001,r+.25),i.connect(l),l.connect(n),i.start(r),i.stop(r+.3)})})():(()=>{if(X())return;let e=new AudioContext,n=e.createGain();n.connect(e.destination),[[19,0],[17,.12],[15,.24],[13,.36],[21,.6]].forEach(([a,r])=>{let i=e.createOscillator(),l=e.createGain();i.type="square",i.frequency.setValueAtTime(440*t.pow(1.05946,13-a),r),l.gain.setValueAtTime(1,r),l.gain.exponentialRampToValueAtTime(.001,r+.4),i.connect(l),l.connect(n),i.start(r),i.stop(r+.5)})})()})(F(),F()?"The cellar is tidy and has enough magic concentration!":"The maximum number of items has been reached, but the magic concentration is not sufficient..."):(_19.inert=!1,_17.inert=!1)},_19.onmouseenter=()=>{_19.onmouseenter=null,async function(e){_12.classList.remove("_20"),_16.onclick=null,_16.onmousemove=null,_16.style.cursor="default",_17.inert=!1,await e[7].animate([{transform:"translateY(0)"},{transform:"translateY(300px)"}],{duration:333,easing:"ease-in"}).finished,f(e,2),e[7].style.removeProperty("left"),e[7].style.removeProperty("top"),_19.append(e[7])}(e)}}(a),dispatchEvent(new CustomEvent("_0",{detail:a}))})}function le(){let e=N();_17.querySelectorAll("div").forEach(t=>{let n=+t.dataset.cost;t.classList.toggle("_13",e<n)})}let se=[(e,t)=>{_19.querySelectorAll("canvas").forEach(e=>{ee(e._0,90)}),oe(e),le(),t()},(e,t)=>{_19.querySelectorAll("canvas").forEach(e=>{ee(e._0,270)}),oe(e),le(),t()},(n,a)=>{_e(n,"h",async n=>{if(2===n._0[5])await me();else{let[a,r]=function(t,n){let a,r=(n,a,r,i)=>["Carnivorous Plant","By watering the dried plant, it"+n,a,r,i,0,t._0[6],e.createElement("canvas")],i=r(" has fully grown and regained all its magic!",9,[[1,1],[0,1]],[0,96]),l=r(" has grown a bit and regained some of its magic.",6,[[1],[1]],[16,96]),s=r(" tried to grow but something blocked it...",3,[[1]],[16,112]),o=y(t._0[6],n);t.dispatchEvent(new MouseEvent("mouseleave")),[[i,(()=>{switch(t._0[8]){case 90:return[-1,0];case 180:return[0,0];case 270:return[0,-1];default:return[-1,-1]}})()],[l,(()=>{switch(t._0[8]){case 90:case 180:return[0,0];case 270:return[0,-1];default:return[-1,-0]}})()],[s,[0,0]]].some(([e,[n,r]])=>{let i=ee(e,t._0[8],3);return i[7]._0=i,i[9]=[...t._0[9]],i[9][0]+=n,i[9][1]+=r,!p(i,o,i[9][1],i[9][0]).length&&(a=i,!0)});let c=_(a,o,a[9][1],a[9][0]);return t.replaceWith(a[7]),a[7].id=t.id,a[7].style.left=48*(a[9][1]+1)+"px",a[7].style.top=48*(a[9][0]+1)+"px",[c,a]}(n,H());q(e=>(2*t.random()-1)*t.sin(e/50)*t.exp(-e/5e3)),D(r),Y(r,"magic"),h(r),E("_1",a)}a()})},(e,n)=>{_e(e,"r",async e=>{q(e=>t.sin(e%400/400*2*t.PI)*t.exp(-e/8e3)*2.2),await j(e._0),await z(),n()})}],oe=e=>{e[2]=e[2]??0,E("_2",e[2]++),e[7].dataset.cost=t.min(e[2],5),_10.innerHTML=N()};function ce(){return ce.c||(ce.c=(e=>{let t;Y(e),D(e);let n=()=>{clearTimeout(t),e[4]=[32===e[4][0]?48:32,e.run?192:176],t=setTimeout(n,e.run?333:1e3),e.s||f(e,3,e.run?null:e.hover?"#fff3":"#331c1a")};return n(),e.animate=n,e})(function(){let t=[...o.find(e=>2===e[5])];return t[6]=++u,t[1]="The master's cat. He's cute, but he's getting in our way a bit here...",t[7]=e.createElement("canvas"),t[7].id="i"+t[6],t[7].className="cat",t[7].style.zIndex=1,t[7]._0=t,h(t),t}())),ce.c}async function ue(){let[e,n]=function(){let e=O(),n=H(),a=[];return e.forEach(e=>{let t=g(e);if(!t)return;let[r,i]=t[9],l=y(e,n);0===p(t,l,i-1,r).length&&a.push([t,-1]),0===p(t,l,i+1,r).length&&a.push([t,1])}),a[t.floor(t.random()*a.length)]??[]}();if(!e)return!1;let a=e[7],[r,i]=e[9],l=i+n;e[9][1]=l,a.style.left=48*(l+1)+"px";let s=H(),o=y(e[6],s);return E("_1",_(e,o,l,r)),B(),_18.innerHTML=`Grimalkin has pushed ${e[0]} to the ${n>0?"right":"left"}!`,await z(),!0}let fe,de=()=>{let e={...m(o.filter(e=>1===e[5]))};e[1]="A gift from the cat. It's useless...",$(),_18.innerHTML=`Grimalkin gave us a ${e[0]}...`,ie(e)},he=0,me=async()=>{he=1;let e=ce();e.run=!0,e.animate(),e[7].inert=!0,E("_1",y(e[6],H())),$(),e[7].animate([{transform:"translate(0, 0)"},{transform:"translate(450px, -100px)"}],{duration:1500,easing:"ease-in"}).finished.then(()=>{e[7].remove()}),await z()},ge=()=>{let e=ce();e.run=!1,he=0,_12.prepend(e[7]),e[7].inert=!1;let n=function(e){let n=[];for(let t=0;t<e[0].length;t++)for(let a=0;a<e.length;a++){let r=void 0===e[a+1]||0!==e[a+1][t];0===e[a][t]&&r&&n.push([a,t])}return 0===n.length?null:n[t.floor(t.random()*n.length)]}(y(e[6],H()));return e[7].style.left=48*n[1]+48+"px",e[7].style.top=48*n[0]+48+"px",e[9]=[...n],_18.innerHTML="Grimalkin has moved in the cellar.",$(),E("_1",_(e,y(e[6],H()),n[1],n[0])),z()};function pe({clientX:e,clientY:t}){fe.style.transform=`translate(${e+8}px, ${t+8}px)`}function _e(e,t,n){let r=!1;function i(){a.classList.remove(t),a.removeEventListener("mousemove",pe),a.removeEventListener("click",l),e[7].classList.remove("_19"),fe?.remove()}async function l(l){if(!a.classList.contains(t)||r)return;r=!0;let{tagName:s}=l.target;if(l.target._0&&"CANVAS"===s&&!1!==await n(l.target))return i(),oe(e),le(),void(_19.inert=!1);r=!1}if(a.classList.contains(t))return i(),void(_19.inert=!1);fe=e[7].cloneNode();let{left:s,top:o}=e[7].getBoundingClientRect();_12.append(fe),pe({clientX:s,clientY:o}),a.classList.add(t),a.addEventListener("mousemove",pe),a.addEventListener("click",l),e[7].classList.add("_19"),_19.inert=!0}var ye={f:["00001111","000111111","0001011111","000001111111","000011111111","0000011212121","000011221211","0001112222222","001112221112","00000112222","00000111111","00001112111","00001111111","000111111111","001111111111","0000010001"],async l(e,t,a){e.classList.remove("end"),_3.innerHTML='<div class="_9 c"></div><div class="_10 c"></div><div class="_11 c"></div>';let r=_3.querySelector("._9"),i=_3.querySelector("._10"),l=_3.querySelector("._11");if(a){l.style.opacity=0;let a=["Master! I've completed the task you entrusted to me!","Very good, Mia! The concentration of magic in the cellar is perfect! Hehehe...","What's happening, Master?"],s=M().chaos>=3;s?a.push("Meow!*<br>*<i>(The Master used Mia to accumulate magic, become overpowered and dominate the world!)","Meow...*<br>*<i>I tried everything to prevent Mia from helping him without her knowing...)","Meow!!!*<br>*<i>(Attack! We must stop him!)","","Master... ? Are you alright? Grimalkin jumped on you... That won't help with your allergy to his fur!"):a.push("Meow...*<br><i>*(Oh no, I've failed...)");let o=-1;return new n(()=>{let n=()=>{switch(o++,e.innerHTML=a[o],o){case 0:i.classList.add("left"),t(i,r);break;case 1:t(r,i);break;case 2:r.classList.add("_7","r"),r.classList.remove("_17"),i.classList.add("_18");break;case 3:l.classList.add("_1"),l.style.opacity=1,l.animate([{transform:"translateX(100%) scaleX(-1)"},{transform:"translateX(0) scaleX(-1)"}],{duration:1200,easing:"linear",fill:"forwards"}).finished.then(()=>{l.classList.remove("_1")});break;case 6:l.classList.add("_1"),l.style.animationDuration="333ms",l.animate([{transform:"translateX(0) scaleX(-1)"},{transform:"translateX(-300%) scaleX(-1)"}],{duration:600,easing:"linear",fill:"forwards"}).finished.then(()=>{r.classList.remove("r"),l.classList.remove("_1"),l.style.removeProperty("animationDuration"),r.animate([{transform:"translateX(0) rotate(0)"},{transform:"translateX(-300%) rotate(360deg"}],{duration:600,easing:"ease-in",fill:"forwards"})})}let c=o===a.length-1;e.onclick=c?()=>{e.classList.add("_4"),e.innerHTML=s?"You've finished BOTH <b>Pawfect Stack</b> games! Thank you so much, I hope you enjoyed the experience! :D":'You\'ve finished <b>Pawfect Stack: Oracle of Order</b>! To discover the true ending, also complete <a target="_parent" href="https://js13kgames.com/2025/games/pawfect-stack-oracle-of-chaos"><b>Pawfect Stack: Oracle of Chaos</b></a>!'}:n,c&&e.classList.add("end")};n()})}let s=["My little Mia, I entrust you with a mission of the utmost importance!","Oh, what is it, Master? Ingredients to find? A potion to brew? A spell to craft?","The cellar really needs to be tidied up!","Oh... I see. I'll take care of it right away.","And make sure the concentration of magic is optimal!","Very well, Master.","Meow..."],o=-1;return new n(n=>{let a=()=>{switch(o++,e.innerHTML=s[o],o){case 0:i.classList.add("left"),t(r,i),l.style.display="none",r.animate([{transform:"translateX(-100%)"},{transform:"translateX(0)"}],{duration:1500,easing:"linear",fill:"forwards"});break;case 1:case 3:r.getAnimations().forEach(e=>{e instanceof CSSAnimation||e.finish()}),t(i,r);break;case 2:case 4:t(r,i);break;case 5:t(i,r),r.classList.remove("_7"),r.animate([{transform:"translateX(0) scaleX(-1)"},{transform:"translateX(-205%) scaleX(-1)"}],{duration:3e3,easing:"linear",fill:"forwards"}).finished.then(()=>{r.style.opacity=0}),setTimeout(()=>{i.classList.remove("left","_17"),i.animate([{transform:"translateX(0)"},{transform:"translateX(205%)"}],{duration:3e3,easing:"linear",fill:"forwards"})},750);break;case 6:r.remove(),i.remove(),l.style.removeProperty("display"),l.animate([{opacity:0},{opacity:1}],{duration:2e3,easing:"ease-in",fill:"forwards"}),setTimeout(()=>{l.classList.add("_1"),l.animate([{transform:"translateX(0)"},{transform:"translateX(400%)"}],{duration:3e3,easing:"linear",fill:"forwards"}).finished.then(n)},2500)}let c=o===s.length-1;e.onclick=c?n:a,c&&e.classList.add("end")};a()})},s:function(t){_19.inert=!1,_17.inert=!1,_19.innerHTML="<span>Reserve</span>",ie(),ie(),ie(),_17.innerHTML="",_17.append(e.createTextNode("Spells")),[["Rotarigus","Rotates ALL items in the reserve 90° to the right."],["Rotaleftus","Rotates ALL items in the reserve 90° to the left."],["Hydravo","Throws water on a cell in the cellar. Plants love it, but the cat doesn't..."],["Ejectum","Destroys an item in the cellar."]].forEach((t,n)=>{let a=e.createElement("div");a.dataset.cost=0,t[2]=0,a.className=`${t[0]} s`,_17.append(a),t[7]=a,Y(t,"cost",()=>{se[n](t,()=>{t[10]=!0,dispatchEvent(new CustomEvent("_2",{detail:t}))})})}),async function(e){if(0===e){_17.style.display="none",_7.style.display="none",re("Here is the cellar! The items to tidy up are in the reserve. Click to see them.",["_15"]),await ne(),re("The reserve is on the right. Click on an item to select it. It'll be sent to the cellar.",[],["_15"]);let{detail:e}=await ae("_0");re(`${e[1]}? Ok then! It's appeared in the cellar. Move it with your mouse and click to place it. Caution: gravity will affect it!`,["_15","_16"]),await ae("_1"),re("Oh, here is Grimalkin, the master's cat. He's cute, but he might bother us a little...",[],["_16"]),await ne(),re("Place a new item in the cellar! Of course, it's impossible to place an item where Grimalkin is standing...",[],["_15"]),await ae("_1",e=>{e.ci=1}),re("Oh! Grimalkin gave us a little gift! Click to see it in the reserve!",["_15"]),await ne(),re("The gifts from this cat are a bit lame... But we shouldn't upset him, right?",[],["_15"]),await ae("_1"),_7.style.removeProperty("display"),re("The game ends when we place the required number of items; we win if we've reached the minimum required amount of magic. See at the top left of the screen!",["_15"]),await ne(),re("Place another item!",[],["_15"]),await ae("_1"),re("As long as an object is in the cellar, it gives its magic to it. The magic score is our main goal but you can also spend some magic to cast spells: try it now! (there is one to scare the cat away!)",["_15","_16"]),_17.style.removeProperty("display");let{detail:t}=await ae("_2");re(`${t[0].toUpperCase()}! You have cast your first spell! Its magic cost has increased by 1.`,["_15"],["_16"]),_17.inert=!0,await ne(),_17.inert=!1,re("You now know all you need to know to properly tidy up the cellar! Try to reach our goals!",[],["_15","_16"])}else re("Tidy up the cellar!")}(t)}};let ve=ye;(()=>{!function(e,t){k=e,A=t}(C,x().state||S),function(t){!function(t){let n=e.createElement("canvas");n.width=16,n.height=16;let a=n.getContext("2d"),r=["transparent","#331c1a","#FEEBC9"];t.forEach((e,t)=>{e.split("").forEach((e,n)=>{a.fillStyle=r[e],a.fillRect(n+2,t,1,1)})}),_0.href=n.toDataURL()}(t),_25.checked=!X(),_25.onchange=e=>function(e){E("toggleMuteSounds",e),e?(V.ctx&&(V.ctx.close(),V.ctx=null),clearTimeout(V.timer),V.timer=null):V()}(!e.currentTarget.checked),_26.onclick=e=>{confirm("Are you sure you want to reset the game save?")?E("_3",0):e.preventDefault()}}(ve.f);let t=!1;!function(t){l=t;let n=[];for(let t of e.querySelectorAll("section[id]"))r.push(t.id),n.push(`body[data-cs="${t.id}"] section#${t.id}`);function o(){!function(e){let t=function(e){return r.includes(e)}(e)?e:"_1";t!==a.dataset.cs&&(a.dataset.cs&&(a.dataset.prevSection=a.dataset.cs),!1!==l({nextSection:t,cs:a.dataset.prevSection,vars:i})?a.dataset.cs=t:history.forward())}(location.hash.substring(1))}e.head.insertAdjacentHTML("beforeend",`<style>${n.join(",")+"{display:flex;}"}</style>`),addEventListener("hashchange",o),a.addEventListener("click",e=>{"A"===e.target.tagName.toUpperCase()&&(i=JSON.parse(JSON.stringify(e.target.dataset)))}),s("_1"),o()}(async({cs:n,nextSection:a,vars:r})=>{t||"_1"!==n||(t=!0,V()),"_2"===a&&(await async function(t,n){n&&_4.remove(),await t(e.querySelector("#_3 + ._8"),W,n)}(ve.l,r.end),s("_5")),"_5"===a&&Z(M().order??0,ve.s)})})()}()</script>