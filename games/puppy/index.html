<!DOCTYPE html>
<html>

<head>
  <title>Puppy</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">  
<style>
body{margin:0;padding:0;overflow:hidden;background:#000}#cb canvas{cursor:none;max-width:100%;display:block;margin:auto;background:#000}

</style>
  
</head>

<body >
  <div class="crtx" id="cb"></div>
  <script>
  t=[],s=["PUPPY","PRESS [SPACE]"],e=["WOOF","BARK","WHAT! TONY HAS FALLEN DOWN A WELL+AND HAS ONLY {*} MINUTES TO LIVE?","WHATS THAT! SOME PEOPLE ARE TRAPPED+AND IF WE DONT RESCUE THEM SOON+THEY WILL BE MISTAKEN FOR WELL TROLLS+AND BURNED BY RAMPAGING VILLAGERS?","HELLO BOY","GOOD DOG","WANNA TREAT FELLA?","DO YOU DO TRICKS?","ROLL OVER","YOU SHOULDNT BE OUT HERE ALONE+THERE ARE WELL TROLLS ABOUT YOU KNOW!","ARRGGH! ","IVE FALLEN","PUPPY GET HELP!+BEFORE ITS TOO LATE!","GET HELP!","LEAD THE WAY PUPPY","LETS GO PUPPY"],h=["TOYS INCREASE TIME","TREATS BOOST BARK POWER","BEWARE MEAN DOGS","BARK TO LOCATE HELP+[SPACE]","GUIDE HELP TO TONY"],n=["BLAH ","TONY STILL NOT FOUND","HERO PUPPY LEADS HEROIC RESCUE","MAN DISAPPEARS YESTER+DAY. ","ALIENS DID IT, +SAYS LOCAL.","LOCAL IDIOT WHO FELL+DOWN A WELL HAS BEEN+FOUND","POLICE ARREST 2 MEN+OVER TROLL HOAX","PUPPY CAUSES MAYHEM ON+HIGHWAY. ^HE WASNT LOOK+ING WHERE HE WAS GOING^+SAYS CONCERNED MOTORIST","WELL TROLL WORRIES OLD+LADY. ^I HEARD A VOICE+COMING FROM THE WELL+SO JUST RAN OFF^","MEAN DOGS AT LARGE IN+WOODS","2ND MAN GOES MISSING.+","WELL TROLLS BLAMED"],o={game:5},a={up:0,dn:1,lt:2,rt:3,sq:4,dd:5,wt:6},d=["#2AF764","#29EB5F","#B1B3B5","#78421e","#532d0f","#532d0f","#532d0f","#29E0FF","#26D1F0","#22BBD6","#1C9AB0","#2AF764","#29EB5F","#B1B3B5","#4800FF","#2AF764","#29EB5F","#C46D37","#B26233","#9E572B","#89451E","#626365","#565759","#4C4D4F","#404042","#81544e","#7e524c","#734b44","#64413b","#49B530","#42A02B","#368724","#2D701E","#B658D8","#A549C6","#9538B7","#f4ac6e","#e27d54","#F2DE00","#E6D200","#D1BF00","#A69800","#FC4C75","#F0486F","#D64165","#B03552","rgba(100, 100, 100, 0.3)","#000000","#161616","#333333","#a0a0a0","#FFFFFF","#e20909","#db4444","#2aca50","#626365","#565759","#4C4D4F"],c={pupu:{idl:[3,[8,3,10,-1,10,-8,8,-4],2,[8,3,5,2,5,-5,8,-4],3,[14,-14,15,-16,15,-25,14,-23],0,[14,-23,12,-24,13,-26,15,-25],3,[10,-6,14,-14,14,-29,10,-21],2,[10,-6,-7,-10,-7,-25,10,-21],0,[10,-21,-7,-25,-3,-33,14,-29],3,[7,2,10,-5,10,-14,7,-7],1,[7,-8,-10,-12,-7,-18,10,-13.8],2,[7,1,-10,-3,-10,-12,7,-8],3,[4,11,7,5,7,-2,4,4],1,[4,4.3,-13,.4,-10,-6,7,-1.8],2,[4,11,-13,7,-13,0,4,4],3,[-3,2,-2,-.8,-2,-3.2,-3,-1.6],2,[-3,3,-6,2,-6,-2,-3,-1.3],0,[-3,-1.3,-5.8,-2,-4.3,-4,-2,-3.4]],bod:[3,[14,-14,15,-16,15,-25,14,-23],0,[14,-23,12,-24,13,-26,15,-25],3,[10,-6,14,-14,14,-29,10,-21],2,[10,-6,-7,-10,-7,-25,10,-21],0,[10,-21,-7,-25,-3,-33,14,-29],3,[3,7,10,-8,10,-17,3,-2],1,[3,-2,-14,-6,-7,-20,10,-16.8],2,[3,7,-14,3,-14,-6,3,-2],3,[-3,-3,-2,-5.8,-2,-8.2,-3,-6.6],2,[-3,-3,-6,-4,-6,-7,-3,-6.3],0,[-3,-6.3,-5.8,-7,-4.3,-9,-2,-8.4]],leg:[3,[8,3,10,-1,10,-8,8,-4],2,[8,3,5,2,5,-5,8,-4],3,[3,13,5,9,5,2,3,6],2,[3,13,0,12,0,5,3,6],3,[-11,10,-9,6,-9,-1,-11,3],2,[-11,10,-14,9,-14,2,-11,3]],run:[2,[10,1,15,-15,9,-15,6,0],3,[10,1,10,-9,12,-14,12,-8,15,-15,15,-10],3,[1,15,5,7,5,2,1,10],1,[1,15,-4,14,-4,10,-1,5,3,6,1,10],3,[-11,12,-6,3,-7,0,-11,8],1,[-11,12,-16,11,-16,7,-14,3,-8,2,-11,8]],fc:[]},pupd:{idl:[3,[10,0,13,-6,13,-12,10,-6],2,[10,0,7,-1,7,-7,10,-6],1,[10,-6,-10,-11,-7,-17,13,-12],3,[6,6,8,2,8,-5,6,-1],2,[6,6,3,5,3,-2,6,-1],3,[6,2,10,-6,10,-13,6,-6],1,[6,-6,-10,-10,-7,-17,10,-12.8],3,[2,10,6,2,6,-13,2,-5],2,[2,10,-15,6,-15,-9,2,-5],0,[2,-5,-15,-9,-11,-17,6,-13],3,[1,11,2,10,2,0,1,2],1,[1,11,-16,7,-16,-2,1,2],0,[1,2,-16,-2,-15,-4,2,0]],bod:[3,[6,0,13,-15,13,-24,6,-9],1,[6,-9,-10,-13,-3,-27,13,-23.8],3,[2,10,6,2,6,-13,2,-5],2,[2,10,-15,6,-15,-9,2,-5],0,[2,-5,-15,-9,-11,-17,6,-13],3,[1,11,2,10,2,0,1,2],1,[1,11,-16,7,-16,-2,1,2],0,[1,2,-16,-2,-15,-4,2,0],3,[5,-22,6,-24.8,6,-27.2,5,-25.6],2,[5,-22,2,-23,2,-26,5,-25.3],0,[5,-25.3,2.2,-26,3.7,-28,6,-27.4]],leg:[3,[11,-4,13,-8,13,-15,11,-11],2,[11,-4,8,-5,8,-12,11,-11],3,[6,6,8,2,8,-5,6,-1],2,[6,6,3,5,3,-2,6,-1]],run:[2,[11,-5,16,-22,12,-23,8,-6],3,[11,-5,11,-11,16,-22,16,-16],2,[-1,10,4,12,7,2,2,-2],3,[4,12,4,7,6,3,6,-2,8,-8,8,3]],fc:[0,[-5,5,-10,4,-10,0,-5,1],4,[-.6,-1.2,-4.6,-2.1,-4.6,-4.9,-.6,-4],4,[-9,-3,-13,-4,-13,-7,-9,-6],4,[1,9,-16,5,-16,4,1,8,3,5,3,5.9],6,[-3,10,-8,9,-8,6,-3,7]],fc2:[0,[-5,5,-10,4,-10,0,-5,1],7,[-.6,-1,-4.6,-1.8,-4.6,-3.9,-.6,-3],7,[-9,-3,-13,-4,-13,-6,-9,-5],0,[1,10,-16,6,-16,4,1,8,3,5,3,6.9],4,[-13,6.8,-9.1,7.9,-9,6.8,-13,5.8],4,[-6,8.3,-2.1,9.4,-2,8.3,-6,7.3]]},pupl:{idl:[3,[-5,6,-3,1,-3,-4,-5,-1],2,[-5,6,-9,5,-9,-3,-5,-2],2,[-19,-3,-21,-3.7,-21,-12,-19,-11.7],0,[-19,-11.6,-21,-12,-16,-22,-14,-21.7],3,[-10,-1,-5,-12,-5,-26.3,-10,-15.2],2,[-10,-1,-19,-3,-19,-17,-10,-15],0,[-10,-15,-19,-17,-13,-28,-5,-26],3,[0,2,5,-9,5,-16,0,-6],2,[0,2,-10,0,-10,-8,0,-5.6],1,[0,-5.6,-10,-8,-5,-18,5,-15.6],2,[9,9,-2,6.4,-2,-2,9,1],1,[9.2,2.1,0,-.3,4.8,-9.1,13.7,-7],3,[9,9,13.7,-.2,13.7,-7,9,1.9],3,[11,-1,12,-3,12,-6,11,-4],2,[11,-1.1,8,-2,8,-5,11,-4.1],0,[11,-4.2,8,-5,9,-7,12,-6.1]],bod:[2,[-19,-3,-21,-3.7,-21,-12,-19,-11.7],0,[-19,-11.6,-21,-12,-16,-22,-14,-21.7],3,[-10,-1,-5,-12,-5,-26.3,-10,-15.2],2,[-10,-1,-19,-3,-19,-17,-10,-15],0,[-10,-15,-19,-17,-13,-28,-5,-26],2,[13,3,-10,-2,-10,-11,13,-6],1,[13.2,-5.9,-10,-10.9,-5,-20,18,-15],3,[13,3,18,-8,18,-15,13,-5.1],3,[15,-8,16,-10,16,-13,15,-11],2,[15,-8.1,12,-9,12,-12,15,-11.1],0,[15,-11.2,12,-12,13,-14,16,-13.1]],leg:[3,[-5,6,-3,1,-3,-4,-5,-1],2,[-5,6,-9,5,-9,-3,-5,-2],3,[16,2,18,-3,18,-8,16,-5],2,[16,2,12,1,12,-7,16,-6],3,[13,10,15,5,15,-4,13,1],2,[13,10,9,9,9,0,13,1]],run:[3,[-5,5,-2,-1,-14,-6,-16,-2],2,[-5,5,-16,2,-16,-2,-9,0,-9,-3,-5,-2],3,[22,1,24,-3,24,-7,14,-9,14,-6,22,-4],2,[22,1,15,-1,15,-6,22,-4],3,[18,9,20,5,20,1,11,-1,8,2,18,4],2,[18,9,8,7,8,2,18,4]],fc:[1,[-16,-4,-21,-5,-21,-6,-16,-5]],fc2:[0,[-16,-4,-21,-5,-21,-6,-16,-5]]},pupr:{idl:[3,[-5,5,0,-4,-3,-5,-5,-2],1,[-5,-3,-15,-5,-11,-13,-1,-11],3,[1,7,3,2,3,-3,1,-2],2,[1,7,-3,6,-3,-3,1,-2],2,[-5,5.5,-15,3,-15,-5.4,-5,-3],2,[3,1.7,-7,-1,-7,-9.7,3,-7],1,[3,-6.7,-7,-8.9,-3,-17,7,-15],3,[11,4,16,-7,16,-21.3,11,-10.2],2,[11,4,2,2,2,-12,11,-10],0,[11,-10,2,-12,8,-23,16,-21],3,[13,4,18,-7,18,-15,13,-5],2,[13,4,11,4,11,-5,13,-4.7],1,[13,-4.6,11,-5,16,-15,18,-14.7],3,[-10,-7,-9,-9,-9,-12,-10,-10],2,[-10,-7.1,-13,-8,-13,-11,-10,-10.1],0,[-10,-10.2,-13,-11,-12,-13,-9,-12.1]],bod:[2,[5,0,-18,-5,-18,-14,5,-9],1,[5,-8.9,-18,-13.9,-13,-23,10,-18],3,[11,4,16,-7,16,-21.3,11,-10.2],2,[11,4,2,2,2,-12,11,-10],0,[11,-10,2,-12,8,-23,16,-21],3,[13,4,18,-7,18,-15,13,-5],2,[13,4,11,4,11,-5,13,-4.7],1,[13,-4.6,11,-5,16,-15,18,-14.7],3,[-13,-16,-12,-18,-12,-21,-13,-19],2,[-13,-16.1,-16,-17,-16,-20,-13,-19.1],0,[-13,-19.2,-16,-20,-15,-22,-12,-21.1]],leg:[3,[-14,3,-12,-2,-12,-7,-14,-4],2,[-14,3,-18,2,-18,-6,-14,-5],3,[1,7,3,2,3,-3,1,-2],2,[1,7,-3,6,-3,-3,1,-2]],run:[0,[-20,-15,-18,-18,-12,-16,-13,-13],3,[-15,-10,-20,-11,-20,-15,-15,-14],1,[-24,-7,-22,-10,-13,-8,-11,-6,-14,-1,-14,-5],2,[-14,-1,-24,-3,-24,-7,-14,-5],3,[7,7,10,2,-1,-5,-1,2],2,[7,7,-3,5,-3,-3,1,-2,1,2,7,3]],fc:[0,[14.5,-4,16.5,-8,16.5,-11.4,14.4,-6.9],4,[14,-11,15,-14,15,-16.7,14,-14],4,[12,-7,13,-10,13,-12.7,12,-10],4,[13,2,18,-8,18,-9,13,1,8,0,8,1],6,[17,-4,15,0,15,-3,17,-7]],fc2:[0,[14.5,-4,16.5,-8,16.5,-11.4,14.4,-6.9],7,[14,-11,15,-14,15,-15.7,14,-13],7,[12,-7,13,-10,13,-11.7,12,-9],0,[13,3,18,-7.5,18,-9,13,1,8,0,8,2],4,[17,-5,16,-3,16,-4,17,-6],4,[15,-1,14,1,14,0,15,-2]]},man:{bod:[2,[11,-2,21,-25,21,-44,11,-21],1,[11,-2,-21,-9,-21,-28,11,-21],4,[11,-21,21,-44,21,-63,11,-40],3,[11,-21,-21,-28,-21,-47,11,-40],3,[11,-40,-21,-47,-9,-70,21,-63]],v:{ex:[2,[21,-11,23,-15,23,-28,21,-24],1,[21,-11,15,-12.5,15,-25.4,21,-24],0,[21,-24,15,-25,17,-29,23,-28]],fceu:[10,[11,-28,16,-39,16,-43,21,-55,21,-63,11,-40],9,[11,-28,-21,-35,-21,-47,11,-40],8,[11,-40,-21,-47,-9,-70,21,-63]],fced:[10,[11,-34,16,-45,16,-39,21,-50,21,-63,11,-40],9,[11,-34,-21,-41,-21,-47,11,-40],8,[11,-40,-21,-47,-9,-70,21,-63],4,[-10,-33,-15,-34,-15,-37,-10,-36],4,[5,-30,0,-31,0,-34,5,-33],0,[2,-25,-12,-28,-12,-30.1,-10,-30,-10,-29,0,-27,0,-28,2,-27.5]],leg:[2,[-8,4,-3,-6,-3,-24,-8,-14],1,[-8,4,-17,2,-17,-14,-8,-13],2,[12,8,17,-2,17,-20,12,-10],1,[12,8,3,6,3,-10,12,-9]],leg1:[2,[-11,9,-6,-1,-6,-19,-11,-9],1,[-11,9,-20,7,-20,-9,-11,-8],2,[15,2,20,-8,20,-26,15,-16],1,[15,2,6,0,6,-16,15,-15]],leg2:[2,[-7,-2,-2,-12,-2,-30,-7,-20],1,[-7,-2,-16,-4,-16,-20,-7,-19],2,[10,13,15,3,15,-15,10,-5],1,[10,13,1,11,1,-5,10,-4]]},h:{ex:[2,[-3,-1,-1,-5,-1,-18,-3,-14],1,[-3,-1,-9,-2.5,-9,-15.4,-3,-14],0,[-3,-14,-9,-15,-7,-19,-1,-18]],fcel:[10,[11,-27,21,-50,21,-63,11,-40],9,[11,-27,-3,-30,-3,-36,-21,-40,-21,-47,11,-40],8,[11,-40,-21,-47,-9,-70,21,-63]],fcer:[10,[11,-34,21,-56,21,-63,11,-40],9,[11,-34,-3,-37,-3,-30,-21,-34,-21,-47,11,-40],8,[11,-40,-21,-47,-9,-70,21,-63],4,[13,-33,15,-38,15,-41,13,-36],4,[17,-41,19,-46,19,-49,17,-43.8],0,[14,-29.8,19,-41.8,19,-42.8,14,-31.8]],leg:[2,[7,-1,12,-11,12,-29,7,-19],1,[7,-1,-2,-3,-2,-19,7,-18],2,[1,11,5,3,5,-11,1,-7],1,[1,11,-11,8,-11,-7,1,-5]],leg1:[2,[15,0,19,-8,19,-26,15,-16],1,[15,0,5,-2,5,-18,15,-17],2,[-8,9,-4,1,-4,-13,-8,-9],1,[-8,9,-20,6,-20,-9,-8,-7]],leg2:[2,[-4,-3,0,-11,0,-29,-4,-19],1,[-4,-3,-14,-5,-14,-21,-4,-20],2,[10,13,14,5,14,-9,10,-5],1,[10,13,-2,10,-2,-5,10,-3]]}},tree:{bod:[3,[7,8,13,-5,13,-51,7,-40],2,[7,8,-12,4,-12,-47,7,-43]],hd1:[3,[13,-16,26,-44,26,-77,13,-49],2,[13,-16,-24,-24,-24,-57,13,-49],0,[13,-49,-24,-57,-10,-85,26,-77]],hd2:[3,[21,-35,41,-80,41,-89,21,-45],2,[21,-35,-42,-49,-42,-59,21,-45],1,[21,-45,-42,-59,-22,-102,41,-89],3,[11,-59,21,-82,21,-93,11,-70],2,[11,-59,-21,-66,-21,-77,11,-70],0,[11,-70,-21,-77,-10,-100,21,-93]]},tile:{sol:[0,[-11,-15,21.4,-7.7,11,15.4,-21.4,7.9]],hol:[0,[-11,-15,-21.9,9,-11.3,13]],cor:[0,[-1.2,-12.6,-11,-14.6,-21.3,7.6,-1.2,11.7]]},flat:[0,[-11,-15,21.4,-7.7,11,15.4,-21.4,7.9]],hat:[2,[22,29,-42,15,-22,-30,42,-16],0,[11,15,21,-8,21,-27,11,-4],1,[11,-4,-21,-11,-9,-34,21,-27],2,[11,15,-21,8,-21,-11,11,-4]],cube:[2,[11,15,21,-8,21,-27,11,-4],0,[11,-4,-21,-11,-9,-34,21,-27],1,[11,15,-21,8,-21,-11,11,-4]],car:{bod:[2,[11,9,21,-14,21,-33,11,-10],2,[11,9,-54,-6,-54,-25,11,-10],1,[11,-10,-54,-25,-43,-47,21,-33],2,[-4,-13,6,-36,6,-55,-4,-32],2,[-4,-13,-36,-20,-36,-39,-4,-32],1,[-4,-32,-36,-39,-24,-62,6,-55]],win:[0,[1,12,3,7.2,1,6.7],0,[-31,5,-29,-.3,-31,-.8],1,[1,12,-12,9,-12,-3,1,0],1,[-31,5,-44,2,-44,-10,-31,-7],3,[-35,1,-40,0,-40,-5,-35,-4],3,[-3,8,-8,7,-8,2,-3,3],3,[-3,-17,5,-36,5,-50,-3,-31],3,[-6,-15,-34,-21.4,-34,-37,-6,-30.9]],ltf:[4,[13,-3,15,-8,15,-13,13,-8],4,[20,-20,18,-15,18,-20,20,-25]],ltr:[5,[13,-3,15,-8,15,-13,13,-8],5,[20,-20,18,-15,18,-20,20,-25]]},well:[2,[11,15,21,-8,21,-27,11,-4],1,[11,15,-21,8,-21,-11,11,-4],0,[11,-4,-21,-11,-9,-34,21,-27],2,[-1,12,-21,8,-21,0,-1,4],2,[11,5,-9,1,-9,-8,11,-4],2,[-10,1,-20.7,-1.3,-20.8,-11,-10,-8.7],2,[11,15,.3,12.7,.2,4,11,6],3,[11,15,17,1,17,-7,11,6],3,[15,-4,21,-18,21,-26,15,-13],3,[18,-1,21,-8,21,-16,18,-9],3,[11,5,14,-3,14,-11,11,-4],1,[-4.9,-16.7,-16.6,-18.8,-9,-34,2.9,-31.3],1,[-10,-9,-21,-11,-17,-18,-6,-16],1,[14.5,-12,-4,-16,4,-31,21,-27],1,[11,-4,-9,-8,-5,-15,14,-11]]},y={A:[[,1],[1,,1],[1,1,1],[1,,1],[1,,1]],B:[[1,1],[1,,1],[1,1,1],[1,,1],[1,1]],C:[[1,1,1],[1],[1],[1],[1,1,1]],D:[[1,1],[1,,1],[1,,1],[1,,1],[1,1]],E:[[1,1,1],[1],[1,1,1],[1],[1,1,1]],F:[[1,1,1],[1],[1,1],[1],[1]],G:[[,1,1],[1],[1,,1,1],[1,,,1],[,1,1]],H:[[1,,1],[1,,1],[1,1,1],[1,,1],[1,,1]],I:[[1,1,1],[,1],[,1],[,1],[1,1,1]],J:[[1,1,1],[,,1],[,,1],[1,,1],[1,1,1]],K:[[1,,,1],[1,,1],[1,1],[1,,1],[1,,,1]],L:[[1],[1],[1],[1],[1,1,1]],M:[[1,1,1,1,1],[1,,1,,1],[1,,1,,1],[1,,,,1],[1,,,,1]],N:[[1,,,1],[1,1,,1],[1,,1,1],[1,,,1],[1,,,1]],O:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],P:[[1,1,1],[1,,1],[1,1,1],[1],[1]],R:[[1,1],[1,,1],[1,,1],[1,1],[1,,1]],S:[[1,1,1],[1],[1,1,1],[,,1],[1,1,1]],T:[[1,1,1],[,1],[,1],[,1],[,1]],U:[[1,,1],[1,,1],[1,,1],[1,,1],[1,1,1]],V:[[1,,,,1],[1,,,,1],[,1,,1],[,1,,1],[,,1]],W:[[1,,,,1],[1,,,,1],[1,,,,1],[1,,1,,1],[1,1,1,1,1]],X:[[1,,,,1],[,1,,1],[,,1],[,1,,1],[1,,,,1]],Y:[[1,,1],[1,,1],[,1],[,1],[,1]],0:[[1,1,1],[1,,1],[1,,1],[1,,1],[1,1,1]],1:[[,1],[,1],[,1],[,1],[,1]],2:[[1,1,1],[,,1],[1,1,1],[1,,],[1,1,1]],3:[[1,1,1],[,,1],[1,1,1],[,,1],[1,1,1]],4:[[1,,1],[1,,1],[1,1,1],[,,1],[,,1]],5:[[1,1,1],[1,,],[1,1,1],[,,1],[1,1,1]],6:[[1,1,1],[1,,],[1,1,1],[1,,1],[1,1,1]],7:[[1,1,1],[,,1],[,,1],[,,1],[,,1]],8:[[1,1,1],[1,,1],[1,1,1],[1,,1],[1,1,1]],9:[[1,1,1],[1,,1],[1,1,1],[,,1],[1,1,1]]," ":[[,,],[,,],[,,],[,,],[,,]],"[":[[,1,1],[,1],[,1],[,1],[,1,1]],"]":[[1,1],[,1],[,1],[,1],[1,1]],".":[[,,],[,,],[,,],[,,],[,1]],"?":[[1,1,1],[1,,1],[,1,1],[,1],[,1]],"!":[[,1,1],[,1,1],[,1],[,,],[,1]],"^":[[,1],[,,],[,,],[,,],[,,]],"+":[]};!function(){function i(i,s,e,h){this.type=e,this.enabled=!0,this.home={x:i,y:s},this.width=48,this.length=48,this.x=i,this.y=s,this.z=0,this.p=0,this.dx=0,this.dy=0,this.idle=0,this.jumping=!1,this.dest={x:0,y:0},this.accel=180,this.action=a.dn,this.motion=0,this.death=0,this.woof=32,this.power=0,this.help=null,this.target=h,this.altTarget=null,this.patrol={rnd:!0,wait:256,d:0,inp:null,p:[{x:0,y:0},{x:this.x,y:this.y}],pi:0},this.shadow=p.Build([c.tile.sol],1.5,[46]);var n=[[[t[0],t[1],t[2]],[t[3],t[4],t[5]],[t[6],t[7],t[8]],[t[9],t[10],t[11]],[t[59]],[]],[[t[12],t[13],t[14]],[t[15],t[16],t[17]],[t[18],t[19],t[20]],[t[21],t[22],t[23]],[t[59]],[]],[[t[24],t[25],t[26]],[t[27],t[28],t[29]],[t[30],t[31],t[32]],[t[33],t[34],t[35]],[t[59]],[]]];this.body=n[this.type-1],this.anims=[],this.reset=function(t){t&&(this.death=t),this.jumping=!1,this.dx=0,this.dy=0,this.z=0,this.patrol.inp=null}}i.prototype={Logic:function(i){var s=this.accel*i;if(0==this.death){if(this.jumping){this.z>4?this.motion=2:this.motion=1;d=u.HopLogic(this,48,8);if(!this.jumping){if(this.patrol.d&&0==--this.patrol.d&&(this.patrol.inp=null),null==this.altTarget&&this.help){if(this.help.man&&2==E.dlog.active&&(E.AddChat(h[4],this.x-140,this.y+(this.action==a.dn?80:-80),null,3,100),this.help.man=0),this.help.brk&&this.power>0&&0==this.help.trt&&(E.AddChat(h[3],this.x-140,this.y+(this.action==a.dn?80:-80),null,3,100),this.help.brk=0),this.help.toy)for(var n=E.assets.Get([7]),o=0;o<n.length;o++){(r=u.Dir(n[o],this)).d<240&&(E.AddChat(h[0],n[o].x-140,n[o].y+(r.up?64:-64),null,3,100),this.help.toy=0)}if(this.help.trt)for(n=E.assets.Get([6]),o=0;o<n.length;o++){(r=u.Dir(n[o],this)).d<240&&(E.AddChat(h[1],n[o].x-140,n[o].y+(r.up?64:-64),null,3,100),this.help.trt=0)}if(this.help.dog)for(n=E.assets.Get([2,3]),o=0;o<n.length;o++){var r;(r=u.Dir(n[o],this)).d<480&&(E.AddChat(h[2],this.x+(r.left?-210:0),this.y+(r.up?-64:64),null,3,100),this.help.dog=0)}}if(this.idle=64,-1!=T.colliders.over.indexOf(d))if(d>6&&d<11){this.action=a.dd,this.death=a.wt;for(o=0;o<16;o++)this.anims.push(new Grunt(this.x,this.y,t[36],0,{x:p.Rnd(60)-30,y:p.Rnd(60)-30,z:200},!0))}else this.action=a.dd,this.death=a.dd}}else{if(1==this.type){if(1!=E.dlog.active)if(this.altTarget){var l=u.Dir(this.altTarget,this);u.InputLogic(l,this,100*i,48)}else{var l={up:input.isDown("UP")||input.isDown("W"),down:input.isDown("DOWN")||input.isDown("S"),left:input.isDown("LEFT")||input.isDown("A"),right:input.isDown("RIGHT")||input.isDown("D")};u.InputLogic(l,this,s,48)}}else if((l=u.Dir(this.target,this)).d<288)u.InputLogic(l,this,1.2*s,48);else if(this.patrol.inp)u.InputLogic(this.patrol.inp,this,s,48),this.jumping||(this.patrol.inp=null);else if(0==--this.patrol.wait){var d={x:this.x,y:this.y},c=p.RndI(-4,5);this.patrol.rnd?(p.OneIn(2)?d.x+=48*c:d.y+=48*c,this.patrol.wait=p.RndI(64,256)):(d=this.patrol.p[this.patrol.pi],this.patrol.pi=1-this.patrol.pi,this.patrol.wait=256),this.patrol.inp=u.Dir(d,this),this.patrol.d=this.patrol.inp.d/48}this.idle>0&&0==--this.idle&&(this.motion=0)}if(this.woof>0&&this.woof--,1==this.type&&1!=E.dlog.active&&0==this.woof&&input.isUp("SPACE")){c=u.WhichDir(this.action,[{v:a.rt,r:{x:this.x+48,y:this.y-48}},{v:a.lt,r:{x:this.x-144,y:this.y-48}},{v:a.up,r:{x:this.x-48,y:this.y-96}},{v:a.dn,r:{x:this.x-48,y:this.y+48}}]);E.AddChat(e[0],c.x,c.y),this.woof=48,(l=u.Dir(this.target,this)).d<240?(this.target.target=this,E.StartChat()):l.d<17*this.power*48&&E.AddChat("!!",this.x+300*p.OSet(this.x,this.target.x),this.y+200*p.OSet(this.y,this.target.y),null,6,100),this.power>0&&this.power--}}},Update:function(t){this.x+=this.dx,this.y+=this.dy;for(var i=0;i<this.anims.length;i++)this.anims[i].enabled&&this.anims[i].Update(t)},Collider:function(t){if(0==this.death){var i;if(this.jumping)!(i=u.Collisions(this,t,!0))||5!=i.type&&4!=i.type&&3!=i.type&&2!=i.type||this.reset();(i=u.Collisions(this,t,!1))&&(8==i.type||9==i.type||3==i.type||2==i.type?(this.motion=0,this.action=a.sq,this.type=0,this.reset(a.sq),E.splats.push({x:this.x,y:this.y,src:this.body[this.action][0]})):7==i.type&&1==this.type?(E.time+=10,i.enabled=!1):6==i.type&&1==this.type&&(this.power++,i.enabled=!1))}},Render:function(t){var i=this.x,s=this.y,e=p.IsoPoint(i-t.x,s-t.y);0==this.death&&A.PolySprite(e.x,e.y,this.shadow),this.action<a.sq&&A.PolySprite(e.x,e.y-this.z,this.body[this.action][this.motion]);for(var h=0;h<this.anims.length;h++)this.anims[h].enabled&&this.anims[h].Render(t)}},window.Dog=i}(),function(){function i(i,s,e){this.type=4,this.enabled=!0,this.width=48,this.length=48,this.x=i,this.y=s,this.z=0,this.p=0,this.dx=0,this.dy=0,this.jumping=!1,this.dest={x:0,y:0},this.accel=90,this.action=a.dn,this.motion=0,this.death=0,this.target=e,this.targMin=3,this.shadow=p.Build([c.tile.sol],1.5,[46]),this.body=[[t[37],t[38],t[37],t[39]],[t[40],t[41],t[40],t[42]],[t[43],t[44],t[43],t[45]],[t[46],t[48],t[46],t[47]],[t[59]],[]],this.hat=56,this.anims=[],this.anims.push(new Grunt(this.x,this.y,t[51],0,null,!1)),this.reset=function(t){t&&(this.death=t),this.jumping=!1,this.dx=0,this.dy=0,this.z=0}}i.prototype={Logic:function(i){var s=this.accel*i;if(0==this.death)if(this.jumping){this.motion=this.p/12|0;var e=u.HopLogic(this,48,6);if(!this.jumping&&(this.motion=0,-1!=T.colliders.over.indexOf(e)))if(e>6&&e<11){this.action=a.dd,this.death=a.wt,this.anims[0].enabled=!1;for(var h=0;h<16;h++)this.anims.push(new Grunt(this.x,this.y,t[36],0,{x:p.Rnd(60)-30,y:p.Rnd(60)-30,z:200},!0))}else{this.action=a.dd,this.death=a.dd;for(h=0;h<this.anims.length;h++)this.anims[h].dt={x:0,y:0,z:100},this.anims[h].die=!0}}else if(this.target){var n=u.Dir(this.target,this);1==E.dlog.active?this.action=u.WhichDir(!0,[{v:n.right,r:a.rt},{v:n.left,r:a.lt},{v:n.up,r:a.up},{v:n.down,r:a.dn}]):n.d<384&&n.d>48*this.targMin&&u.InputLogic(n,this,s,48)}},Collider:function(t){var i;if(0==this.death)if(this.jumping)!(i=u.Collisions(this,t,!0))||5!=i.type&&4!=i.type&&3!=i.type&&2!=i.type||this.reset();else if((i=u.Collisions(this,t,!1))&&(8==i.type||9==i.type)){this.motion=0,this.action=a.sq,this.type=0,this.reset(a.sq),E.splats.push({x:this.x,y:this.y,src:this.body[this.action][0]});for(var s=0;s<this.anims.length;s++)this.anims[s].dt={x:p.Rnd(60)-30,y:p.Rnd(60)-30,z:200}}},Update:function(t){this.x+=this.dx,this.y+=this.dy;for(var i=0;i<this.anims.length;i++)this.anims[i].enabled&&(0==this.death?(this.anims[i].x=this.x,this.anims[i].y=this.y,this.anims[i].z=this.z+this.hat):this.anims[i].Update(t))},Render:function(t){var i=this.x,s=this.y,e=p.IsoPoint(i-t.x,s-t.y);0==this.death&&A.PolySprite(e.x,e.y,this.shadow),this.action<a.sq&&A.PolySprite(e.x,e.y-this.z,this.body[this.action][this.motion]);for(var h=0;h<this.anims.length;h++)this.anims[h].enabled&&this.anims[h].Render(t)}},window.Man=i}(),function(){function t(t,i,s,e,h,n){this.type=e,this.enabled=!0,this.home={x:t,y:i},this.x=t,this.y=i,this.z=0,this.width=48,this.length=48,this.dt=h,this.body=s,this.die=n,this.dest={x:0,y:0},this.desty}t.prototype={Logic:function(t){var i=E.scene.Content(this.x,this.y);-1!=T.colliders.fend.indexOf(i)&&(this.enabled=!1),this.dest.x=8==this.type?this.x-this.width:this.x+this.width,this.dest.y=this.y},Collider:function(t){if(8==this.type||9==this.type){var i=u.Collisions(this,t,!0);!i||8!=i.type&&9!=i.type||(this.dt.x=i.dt.x)}},Update:function(t){this.enabled&&this.dt&&(this.x+=this.dt.x*t,this.y+=this.dt.y*t,this.z+=this.dt.z*t,this.dt.z&&(this.dt.z-=400*t,this.z<0&&(this.enabled=!this.die,this.dt=null)))},Render:function(t){var i=p.IsoPoint(this.x-t.x,this.y-t.y);A.PolySprite(i.x,i.y-this.z,this.body)}},window.Grunt=t}();var u={Dir:function(t,i){var s={up:!1,down:!1,left:!1,right:!1,d:0},e=p.AbsDist(t.x,i.x),h=p.AbsDist(t.y,i.y);return s.d=p.PDist(e,h),e>h?t.x>i.x?s.right=!0:t.x<i.x&&(s.left=!0):t.y>i.y?s.down=!0:t.y<i.y&&(s.up=!0),s},RectHit:function(t,i){return t.x-=t.width/2,t.y-=t.length/2,i.x-=i.width/2,i.y-=i.length/2,t.x<i.x+i.width&&t.x+t.width>i.x&&t.y<i.y+i.length&&t.length+t.y>i.y},Collisions:function(t,i,s){for(var e=0;e<i.length;e++)if(t!=i[e]){var h={x:s?t.dest.x:t.x,y:s?t.dest.y:t.y,width:t.width,length:t.length},n={x:i[e].x,y:i[e].y,width:i[e].width,length:i[e].length};if(u.RectHit(h,n))return i[e]}return null},WhichDir:function(t,i){for(var s=0;s<i.length;s++)if(t==i[s].v)return i[s].r},InputLogic:function(t,i,s,e){var h=i.x,n=i.y,o=i.dx,r=i.dy;if(t.up?(r=-s,n=i.y-e,i.action=a.up):t.down?(r=s,n=i.y+e,i.action=a.dn):t.left?(o=-s,h=i.x-e,i.action=a.lt):t.right&&(o=s,h=i.x+e,i.action=a.rt),h!=i.x||n!=i.y){var l=E.scene.Content(h,n);-1==T.colliders.hit.indexOf(l)&&(i.dest.x=h,i.dest.y=n,i.dx=o,i.dy=r,i.jumping=!0)}},HopLogic:function(t,i,s){return t.dy>0?t.y>t.dest.y?(t.y=t.dest.y,t.dy=0,t.jumping=!1,t.z=0):(t.p=t.dest.y-t.y,t.z=p.Arc(t.p,i,s)):t.dy<0&&(t.y<t.dest.y?(t.y=t.dest.y,t.dy=0,t.jumping=!1,t.z=0):(t.p=t.y-t.dest.y,t.z=p.Arc(t.p,i,s))),t.dx>0?t.x>t.dest.x?(t.x=t.dest.x,t.dx=0,t.jumping=!1,t.z=0):(t.p=t.dest.x-t.x,t.z=p.Arc(t.p,i,s)):t.dx<0&&(t.x<t.dest.x?(t.x=t.dest.x,t.dx=0,t.jumping=!1,t.z=0):(t.p=t.x-t.dest.x,t.z=p.Arc(t.p,i,s))),E.scene.Content(t.x,t.y)},CarSpawn:function(t,i,s,e){for(var h=0;h<i.length;h++)t.push({ready:100,x:i[h].x*e,y:i[h].y*e,type:s})},PlaceAssets:function(t,i,s,e,h,n,o,r,a,l){for(var d=0;d<t;d++){do{var c={x:p.RndI(s,e-s),y:p.RndI(s,h-s)},x=n.Content(c.x*i,c.y*i),y=(u=o.Get(r)).filter(t=>t.x==c.x*i&&t.y==c.y*i)}while(x>1||0!=y.length);var u=new Grunt(c.x*i,c.y*i,p.OneOf(a),l);o.Add(u)}}},p={OneIn:function(t){return 0==p.RndI(0,t)},OneOf:function(t){return t[p.RndI(0,t.length)]},RndI:function(t,i){return parseInt(Math.random()*(i-t))+t},Rnd:function(t){return Math.random()*t},SLerp:function(t,i,s){return t>i?t-s>i?t-s:i:t+s<i?t+s:i},Lerp:function(t,i,s){return(i-t)*s+t},AbsDist:function(t,i){return Math.abs(t-i)},Dist:function(t,i,s,e){var h=s-t,n=e-i;return p.PDist(h,n)},PDist:function(t,i){return Math.sqrt(t*t+i*i)},IsoPoint:function(t,i){return{x:t-.32*i,y:.7*(i+.32*t)}},Arc:function(t,i,s){return s*Math.sin(Math.PI*t/i)},Build:function(t,i,s){var e=[];i=i||1;for(var h=0;h<t.length;h++)for(var n=0;n<t[h].length;n+=2){for(var o=[],r=0;r<t[h][n+1].length;r+=2)o.push({x:t[h][n+1][r]*i,y:t[h][n+1][r+1]*i});var a=s&&s[h]||0;e.push({col:d[t[h][n]+a],pt:o})}return e},OSet:function(t,i){return p.AbsDist(t,i)<240?0:t>i?-1:1},Replies:function(t,i){var s=[4,5,6,7,8,9];s.sort(()=>Math.random()-.5),s[t]=i,s=s.slice(0,4);for(var h=[],n=0;n<s.length;n++)h.push(e[s[n]]);return h},Speaks:function(t){for(var i=[],s=0;s<t;s++){do{for(var h="",n=p.RndI(1,5),o=0;o<n;o++)h+=e[p.RndI(0,2)]+" "}while(i.includes(h));i.push(h)}return i}},f=function(){var t=[];return{Is:function(i){for(var s=0;s<t.length;s++)if(0==t[s].enabled&&t[s].type==i)return t[s];return null},Add:function(i){t.push(i)},Get:function(i){return i?t.filter(t=>t.enabled&&-1!=i.indexOf(t.type)):t.filter(t=>t.enabled)},Count:function(i){return i?t:t.filter(t=>t.enabled).length}}};!function(){var t={},i={};function s(i,s){var h=e(i,s);return t[h]=s,h}function e(t,i){var s,e=t.keyCode;switch(e){case 13:s="RET";break;case 27:s="ESC";break;case 32:s="SPACE";break;case 37:s="LEFT";break;case 38:s="UP";break;case 39:s="RIGHT";break;case 40:s="DOWN";break;default:s=String.fromCharCode(e)}return s}document.addEventListener("keydown",(function(t){s(t,!0)})),document.addEventListener("keyup",(function(t){s(t,!1);!function(t,s){var h=e(t,s);i[h]=s}(t,!0)})),window.addEventListener("blur",(function(){t={}})),window.input={isDown:function(i){return t[i.toUpperCase()]},isUp:function(t){return i[t.toUpperCase()]},Clr:function(){i=[]}}}();var g=function(t,e,h){var o=t,a=1,c=null;function x(t,i){return Math.round(t*(i||a))}function u(t,i,s){o.fillStyle=s.col,o.beginPath(),o.moveTo(x(s.pt[0].x+t),x(s.pt[0].y+i));for(var e=1;e<s.pt.length;e++)o.lineTo(x(s.pt[e].x+t),x(s.pt[e].y+i));o.closePath(),o.fill()}function p(t,i,s,e,h){o.fillStyle=h||"#000000",o.fillRect(t,i,s,e)}function f(t,s,e,h,n,r){for(o.fillStyle=r||"#000000",cr=s,i=0;i<t.length;i++)if(xp=0,yp=0,mx=0,"+"==(d=t.charAt(i)))e+=8*h,s=cr;else if(l=y[t.charAt(i)],l){for(var a=0;a<l.length;a++){xp=0,row=l[a];for(var d=0;d<row.length;d++)szx=n&&d==row.length-1?2*h:h,szy=n&&a==l.length-1?2*h:h,row[d]&&o.fillRect(x(xp+s,1),x(yp+e,1),szx,szy),xp+=szx;mx=xp>mx?xp:mx,yp+=szy}s+=mx+h}}function g(t,i,s,e,h){var n=0,o=r=0;for(let a=0;a<e;a++)f(t[n],i+o,s+r,3,0),n=n==t.length-1?0:n+1,(o+=12)>h&&(o=0,r+=18)}return e&&(c={minx:0,maxx:e.w,miny:0,maxy:e.h},h&&(c.minx-=h.x1,c.maxx+=h.x2,c.miny-=h.y1,c.maxy+=h.y2)),{News:function(t,i,e,h){p(0,0,t,i,d[51]),p(4,4,t-8,i-8,d[47]),p(8,8,t-16,i-16,d[51]),p(8,140,t-16,2,d[47]),f("4 APRIL",740,12,2,0),f("DAILY BLAH",200,60,10,0),f("PROBABLY ENTIRELY FACTUAL",240,120,3,0),f(h[0],20,154,6,0),f(h[1],18,195,3,0),f(h[2],500,195,3,0),g(n[0],18,280,80,250),g(n[0],18,400,200,250),g(n[0],280,400,100,200),g(n[0],500,360,240,290),f(s[1],580,580,4,0),o.putImageData(function(t){for(var i=t.data,s=0;s<i.length;s+=4){var e=.2126*i[s]+.7152*i[s+1]+.0722*i[s+2];i[s]=i[s+1]=i[s+2]=e}return t}(e),280,195)},Get:function(t,i,s,e){return o.getImageData(t,i,s,e)},Set:function(t){a=t},Box:function(t,i,s,e,h){p(t,i,s,e,h)},PolyTile:function(t,i,s){return!c||t>c.minx&&t<c.maxx&&i>c.miny&&i<c.maxy?(u(t,i,s),1):0},PolySprite:function(t,i,s){return s&&(!c||t>c.minx&&t<c.maxx&&i>c.miny&&i<c.maxy)?(function(t,i,s){for(var e=0;e<s.length;e++)u(t,i,s[e])}(t,i,s),1):0},Text:function(t,i,s,e,h,n){f(t,i,s,e,h,n)}}},w=function(t,i,s){var e=t,h=function(t){for(var i,s,e=[],h=t.split("|"),n=0;n<h.length;n++)if(s=h[n].split(","),i=parseInt(s[0]),e.push(i),s.length>1)for(var o=1;o<s[1];o++)e.push(i);for(n=0;n<e.length;n++)e[n]+",";return e}(i.data),n=i.dim.width,o=i.dim.height,r={x:-64,y:-270},a={x:0,y:0,xoffset:0,yoffset:0},l=e.tile.width,d=s;function c(t,i){return function(t,i){return Math.floor(t/i)}(t,l)+function(t,i){return Math.floor(t/i)}(i,l)*n}return{Set:function(t){r=t?{x:-323,y:-431}:{x:-64,y:-270}},Content:function(t,i){return function(t,i){return h[c(t,i)]}(t,i)},ScrollOffset:function(){return{x:a.xoffset*l-a.x-r.x,y:a.yoffset*l-a.y-r.y}},ScrollTo:function(t,i,s){var h=e.iso.width*l/2,r=e.iso.height*l/2,d=n*l-e.iso.width*l,c=o*l-e.iso.height*l,x=a.xoffset*l-a.x,y=a.yoffset*l-a.y,u=p.Lerp(x,t-h,s||.04),f=p.Lerp(y,i-r,s||.04);u>0&&u<d&&(a.x=-u%l,a.xoffset=parseInt(u/l)),f>0&&f<c&&(a.y=-f%l,a.yoffset=parseInt(f/l))},Render:function(){!function(t){for(var i,s=0,o=n,c=e.iso.width,x=e.iso.height,y=0;y<x;y++)for(var u=0;u<c;u++){s=(y+a.yoffset)*o+(u+a.xoffset),i=h[s];var f=p.IsoPoint(u*l+a.x+r.x,y*l+a.y+r.y);d[i].length?A.PolySprite(f.x,f.y,d[i]):A.PolyTile(f.x,f.y,d[i])}}()}}};!function(){function i(i){var s=c.pupu,h=c.pupd,n=c.pupl,o=c.pupr;for(x of[{t:1,s:1.2,c:17,c2:47},{t:0,s:1.5,c:21,c2:47},{t:0,s:1.5,c:25,c2:47}])t.push(p.Build([s.idl,s.fc],x.s,[x.c,x.c2])),t.push(p.Build([s.leg,s.bod,s.fc],x.s,[x.c,x.c,x.c2])),t.push(p.Build([s.run,s.bod,s.fc],x.s,[x.c,x.c,x.c2])),t.push(p.Build([h.idl,x.t?h.fc:h.fc2],x.s,[x.c,x.c2])),t.push(p.Build([h.leg,h.bod,x.t?h.fc:h.fc2],x.s,[x.c,x.c,x.c2])),t.push(p.Build([h.run,h.bod,x.t?h.fc:h.fc2],x.s,[x.c,x.c,x.c2])),t.push(p.Build([n.idl,x.t?n.fc:n.fc2],x.s,[x.c,x.c2])),t.push(p.Build([n.leg,n.bod,x.t?n.fc:n.fc2],x.s,[x.c,x.c,x.c2])),t.push(p.Build([n.run,n.bod,x.t?n.fc:n.fc2],x.s,[x.c,x.c,x.c2])),t.push(p.Build([o.idl,x.t?o.fc:o.fc2],x.s,[x.c,x.c2])),t.push(p.Build([o.leg,o.bod,x.t?o.fc:o.fc2],x.s,[x.c,x.c,x.c2])),t.push(p.Build([o.run,o.bod,x.t?o.fc:o.fc2],x.s,[x.c,x.c,x.c2]));t.push(p.Build([c.cube],.3,[8]));var r=c.man;t.push(p.Build([r.v.leg,r.bod,r.v.ex,r.v.fceu],1,[33,33,33,47])),t.push(p.Build([r.v.leg1,r.bod,r.v.ex,r.v.fceu],1,[33,33,33,47])),t.push(p.Build([r.v.leg2,r.bod,r.v.ex,r.v.fceu],1,[33,33,33,47])),t.push(p.Build([r.v.leg,r.bod,r.v.ex,r.v.fced],1,[33,33,33,47])),t.push(p.Build([r.v.leg1,r.bod,r.v.ex,r.v.fced],1,[33,33,33,47])),t.push(p.Build([r.v.leg2,r.bod,r.v.ex,r.v.fced],1,[33,33,33,47])),t.push(p.Build([r.h.leg,r.bod,r.h.ex,r.h.fcel],1,[33,33,33,47])),t.push(p.Build([r.h.leg1,r.bod,r.h.ex,r.h.fcel],1,[33,33,33,47])),t.push(p.Build([r.h.leg2,r.bod,r.h.ex,r.h.fcel],1,[33,33,33,47])),t.push(p.Build([r.h.leg,r.bod,r.h.ex,r.h.fcer],1,[33,33,33,47])),t.push(p.Build([r.h.leg1,r.bod,r.h.ex,r.h.fcer],1,[33,33,33,47])),t.push(p.Build([r.h.leg2,r.bod,r.h.ex,r.h.fcer],1,[33,33,33,47])),t.push(p.Build([c.tree.bod,c.tree.hd1],1,[25,29])),t.push(p.Build([c.tree.bod,c.tree.hd2],1,[25,29])),t.push(p.Build([c.hat],.3,[47]));for(var l=[38,42,21],y=0;y<l.length;y++)t.push(p.Build([c.car.bod,c.car.win,c.car.ltf],1.3,[l[y],47,47])),t.push(p.Build([c.car.bod,c.car.win,c.car.ltr],1.3,[l[y],47,47]));t.push(p.Build([c.well],1.5,[17])),t.push(p.Build([c.flat],1,[17])),t.push(p.Build([r.h.leg,r.bod,r.h.ex,r.h.fcer],.8,[33,33,33,47])),t.push(p.Build([r.h.leg1,r.bod,r.h.ex,r.h.fcer],.8,[33,33,33,47])),t.push(p.Build([r.h.leg2,r.bod,r.h.ex,r.h.fcer],.8,[33,33,33,47])),t.push(p.Build([c.cube],.2,[17])),t.push(p.Build([c.cube],.4,[38]));y=0;var g=[];for(let t=0;t<17;t++)g.push(p.Build([c.tile.sol],1.5,[t]));g[4]=p.Build([c.tile.sol,c.tile.hol],1.5,[3,4]),g[5]=p.Build([c.tile.sol,c.tile.cor],1.5,[3,4]),g[8]=p.Build([c.tile.sol,c.tile.hol],1.5,[7,8]),g[9]=p.Build([c.tile.sol,c.tile.cor],1.5,[7,8]),this.scene=new w(i.size,i.level,g),this.screen={w:i.size.screen.width*i.size.tile.width,h:i.size.screen.height*i.size.tile.height},this.gameState=0,this.scCol=1,this.count=16,this.photo=null,this.reset=function(s){A.Set(s||1),this.endCheck=!0,this.scene.Set(s),this.chat=[],this.carSpawn=[],this.splats=[],this.level=0,this.win=0,this.assets=new f,this.dlog={active:0,p:0,r:2,wt:0,tx:p.Speaks(4),rp:[e[4],e[6],e[2],e[7]]};var h=i.level.spawn,n=i.size.tile.width,o=i.size.tile.height;u.CarSpawn(this.carSpawn,h.carl,8,n),u.CarSpawn(this.carSpawn,h.carr,9,n),this.player=new Dog(h.plr[0].x*n,h.plr[0].y*o,1),this.assets.Add(this.player),this.man=new Man(h.man[this.level].x*n,h.man[this.level].y*o,null),this.player.target=this.man,this.assets.Add(this.man);for(var r=0;r<h.wdog.length;r++){var l=new Dog(h.wdog[r].x*n,h.wdog[r].y*o,3,this.player);this.assets.Add(l)}for(r=0;r<h.gdog.length;r++){(l=new Dog(h.gdog[r].s.x*n,h.gdog[r].s.y*o,2,this.player)).patrol.p[0]={x:h.gdog[r].e.x*n,y:h.gdog[r].e.y*o},l.patrol.rnd=!1,this.assets.Add(l)}for(r=0;r<h.hard.length;r++){l=new Grunt(h.hard[r].x*n,h.hard[r].y*o,p.OneOf([t[49],t[50]]),5);this.assets.Add(l)}for(r=0;r<h.trt.length;r++){l=new Grunt(h.trt[r].x*n,h.trt[r].y*o,t[63],6);this.assets.Add(l)}for(r=0;r<h.tys.length;r++){l=new Grunt(h.tys[r].x*n,h.tys[r].y*o,t[64],7);this.assets.Add(l)}var d=h.hme,c=[{x:d.x-1,y:d.y-1},{x:d.x,y:d.y-1},{x:d.x+1,y:d.y-1},{x:d.x-1,y:d.y},{x:d.x+1,y:d.y},{x:d.x-1,y:d.y+1},{x:d.x,y:d.y+1},{x:d.x+1,y:d.y+1}];this.home={x:48*d.x,y:48*d.y};for(r=0;r<c.length;r++){l=new Grunt(c[r].x*n,c[r].y*o,t[58],5);this.assets.Add(l)}s||(this.tony=new Man(h.tony[0].x*n,h.tony[0].y*o,{x:h.tony[1].x*n,y:h.tony[1].y*o}),this.tony.action=a.rt,this.tony.targMin=0,this.tony.hat=56*.8,this.tony.body=[[],[],[],[t[60],t[62],t[60],t[61]],[t[59]],[]],this.assets.Add(this.tony),u.PlaceAssets(120,n,4,i.level.dim.width,i.level.dim.height,this.scene,this.assets,[5,4,3,2,1],[t[49],t[50]],5),u.PlaceAssets(16,n,8,i.level.dim.width,i.level.dim.height-26,this.scene,this.assets,[5,4,3,2,1],[t[63]],6),u.PlaceAssets(8,n,8,i.level.dim.width,i.level.dim.height-26,this.scene,this.assets,[5,4,3,2,1,7,6],[t[64]],7)),this.subTick=160,this.time=60,this.subTime=this.subTick,this.scriptStage=0,this.scriptStop=4,this.player.altTarget={x:h.plr[1].x*n,y:h.plr[1].y*o},this.player.help={toy:1,trt:1,dog:1,brk:1,man:1},this.scene.ScrollTo(this.player.x,this.player.y,1)};var m=this;this.script=[function(){m.player.x==m.player.altTarget.x&&(m.scriptStage++,m.player.altTarget=null)},function(){m.scCol=p.SLerp(m.scCol,1,.02),m.scCol>.9&&(m.scriptStage++,m.count=300)},function(){m.scCol=1,input.isUp("SPACE")&&(m.scriptStage++,m.tony.x=m.home.x,m.tony.y=m.home.y,input.Clr())},function(){m.scCol=p.SLerp(m.scCol,0,.02),m.scCol<.1&&(m.scriptStage++,m.player.script=!1,m.count=64,m.tony.action=a.dd,m.tony.death=a.dd,m.tony.anims[0].dt={x:0,y:0,z:100},m.tony.anims[0].die=!0,E.AddChat(e[10]+e[11],m.tony.x-200,m.tony.y-100,d[47],4,80,32,(function(){E.AddChat(e[12],m.tony.x-200,m.tony.y-100,d[47],4,80,32)})))},function(){m.scCol=p.SLerp(m.scCol,1,.02),m.scCol>.9&&(m.scriptStage++,m.count=100)},function(){if(m.scCol=1,input.isUp("SPACE")){m.scriptStage++;var s=new Grunt(m.tony.x,m.tony.y,t[51],0,{x:0,y:0,z:100},!0);s.z=56*.8,m.assets.Add(s),m.level++;var e=i.level.spawn,h=i.size.tile.width;m.man.x=e.man[m.level].x*h,m.man.y=e.man[m.level].y*h,m.man.target=null,m.dlog.active=0,m.dlog.r=p.RndI(0,4),m.dlog.rp=p.Replies(m.dlog.r,1==m.level?3:p.RndI(2,4)),m.dlog.tx=p.Speaks(4),m.endCheck=!0,input.Clr()}},function(){m.scCol=p.SLerp(m.scCol,0,.02),m.scCol<.1&&(m.scriptStage++,m.count=64,m.tony.action=a.dd,m.tony.death=a.dd,E.AddChat(e[10],m.tony.x-200,m.tony.y-100,d[47],4,80,32,(function(){E.AddChat(e[13],m.tony.x-200,m.tony.y-100,d[47],4,80,32)})))}],this.AddChat=function(t,i,s,e,h,n,o,r){this.chat.push({w:t,tm:n||64,sz:h||4,x:i,y:s,c:e,wt:o,nt:r})},this.StartChat=function(){0==this.dlog.active&&(this.dlog.active=1)},this.reset(2)}i.prototype={Update:function(i){var s=this.assets.Get();switch(this.gameState){case 0:0==this.count?(this.scCol=p.SLerp(this.scCol,0,.01),this.scCol<.1&&(this.gameState=1)):this.count--;break;case 1:input.isUp("SPACE")&&(this.photo=A.Get(300,200,200,200),this.gameState=2);break;case 2:this.scCol=p.SLerp(this.scCol,1,.02),this.scCol>.9&&(this.gameState=3,this.count=240);break;case 3:input.isUp("SPACE")&&(this.gameState=4,this.reset());break;case 4:this.scCol=p.SLerp(this.scCol,0,.02),this.scCol<.1&&(this.gameState=o.game,this.count=64);break;case o.game:this.scriptStage<this.scriptStop&&this.script[this.scriptStage]();for(var h=0;h<this.carSpawn.length;h++)if(0==this.carSpawn[h].ready){var r=p.RndI(100,300),a=p.OneOf([52,54,56]),l=t[a];8==this.carSpawn[h].type&&(r=-r,l=t[a+1]);var c=this.assets.Is(this.carSpawn[h].type);if(c)c.enabled=!0,c.x=this.carSpawn[h].x,c.dt.x=r;else{var x=new Grunt(this.carSpawn[h].x,this.carSpawn[h].y,l,this.carSpawn[h].type,{x:r,y:0,z:0},!0);x.width=96,this.assets.Add(x)}this.carSpawn[h].ready=p.RndI(300,500)}else this.carSpawn[h].ready--;if(1==this.dlog.active){if(0==this.dlog.wt&&(input.isUp("UP")&&this.dlog.p>0&&this.dlog.p--,input.isUp("DOWN")&&this.dlog.p<3&&this.dlog.p++,input.isUp("SPACE"))){var y=this,f={x:y.player.x-140,y:y.player.y+120};y.dlog.wt=1,E.AddChat(this.dlog.tx[y.dlog.p],f.x,f.y,d[47],3,128,0,(function(){var t=y.dlog.rp[y.dlog.p].replace("{*}",y.time);E.AddChat(t,f.x,f.y,d[51],3,y.dlog.p==y.dlog.r?4*t.length:196,32,(function(){y.dlog.p==y.dlog.r?E.AddChat(p.OneOf([e[14],e[15]]),f.x,f.y,d[51],3,128,32,(function(){y.dlog.wt=0,y.dlog.active=2,y.player.woof=48})):y.dlog.wt=0}))}))}}else--this.subTick<=0&&(this.time--,this.subTick=this.subTime,0==this.time&&(this.count=64,this.gameState=o.game+1,this.win=[n[1],n[3]+n[4],p.OneOf([n[7],n[8],n[9]])]));var g=u.Dir(this.home,this.man);if(this.endCheck&&g.d<240&&(this.endCheck=!1,this.level<2?(this.scriptStop=7,this.scriptStage=4):(this.count=64,this.gameState=o.game+1,this.win=[n[2],p.OneOf([n[5],n[6]]),p.OneOf([n[7],n[8],n[9]])])),(this.player.death||this.man.death)&&0==--this.count){var w=this.scene.ScrollOffset(),m=p.IsoPoint(this.player.x-w.x,this.player.y-w.y);this.photo=A.Get(m.x-100,m.y-100,200,200),this.count=64,this.gameState=o.game+1,this.man.death>0||this.level>0?this.win=[n[1],n[10]+p.OneOf([n[11],n[4]]),p.OneOf([n[7],n[8],n[9]])]:this.win=[n[1],n[3]+n[4],p.OneOf([n[7],n[8],n[9]])]}break;case 6:input.isUp("SPACE")&&(this.count=64,this.gameState=0,this.scCol=1,this.count=64,this.reset(2))}for(var S=0;S<s.length;S++)this.gameState==o.game&&s[S].enabled&&(s[S].Logic(i),s[S].Collider(s)),s[S].Update(i);this.scene.ScrollTo(this.player.x,this.player.y),input.Clr()},Render:function(){var t=this.scene.ScrollOffset(),i=this.assets.Get();i.sort((function(t,i){var s=p.IsoPoint(t.x,t.y),e=p.IsoPoint(i.x,i.y);return s.y-e.y})),this.scene.Render();for(var e=0;e<this.splats.length;e++){var h=p.IsoPoint(this.splats[e].x-t.x,this.splats[e].y-t.y);A.PolySprite(h.x,h.y,this.splats[e].src)}for(e=0;e<i.length;e++)i[e].Render(t);switch(this.gameState){case 0:A.Box(0,0,this.screen.w,this.screen.h,"rgba(0, 0, 0, "+this.scCol+")"),A.Text(s[0],260,100,12,1);break;case 1:A.Text(s[0],260,100,12,1),A.Text(s[1],280,480,6,0);break;case 2:A.Box(0,0,this.screen.w,this.screen.h,"rgba(0, 0, 0, "+this.scCol+")");break;case 3:A.Box(0,0,this.screen.w,this.screen.h,"rgba(0, 0, 0, 1)"),A.Text("TONY WAS OUT WALKING WITH HIS+FAITHFULL COMPANION",20,100,4,0,d[51]),A.Text(s[1],580,580,4,0,d[51]);break;case 4:A.Box(0,0,this.screen.w,this.screen.h,"rgba(0, 0, 0, "+this.scCol+")");break;case o.game:this.scriptStage<this.scriptStop?(A.Box(0,0,this.screen.w,this.screen.h,"rgba(0, 0, 0, "+this.scCol+")"),2==this.scriptStage&&(A.Text("WHEN THEY CAME ACROSS AN OLD WELL.",20,100,4,0,d[51]),A.Text("^MAKE A WISH PUPPY!^, SAID TONY",20,134,4,0,d[51]),A.Text("AS HE LEANED OVER TO THROW A PENNY",20,168,4,0,d[51]),A.Text("INTO THE WELL...",20,202,4,0,d[51]),A.Text(s[1],580,580,4,0,d[51])),5==this.scriptStage&&(0==this.level?(A.Text("PUPPY FINDS HELP AND BRINGS HIM TO HIS MASTER.",20,100,4,0,d[51]),A.Text("^HELLO DOWN THERE!^, SHOUTS THE MAN.",20,134,4,0,d[51]),A.Text("^THANK THE LORD IM SAVED^, REPLIES TONY AS HIS",20,168,4,0,d[51]),A.Text("RESCUER LEANS OVER THE EDGE OF THE WELL...",20,202,4,0,d[51])):(A.Text("PUPPY GUIDES THE MAN TO THE WELL.",20,100,4,0,d[51]),A.Text("^ARE THERE TROLLS DOWN THERE^ ASKS THE MAN.",20,134,4,0,d[51]),A.Text("PUPPY GIVES A SIGH AS THE MAN LEANS+OVER TO TAKE A LOOK...",20,168,4,0,d[51]),A.Text(s[1],580,580,4,0,d[51])))):(A.Box(0,0,this.screen.w,48,"rgba(0, 0, 0, 0.7)"),A.Text("TIME",this.screen.w-200,8,3,0,d[51]),A.Text("TO LIVE",this.screen.w-200,26,3,0,d[51]),A.Text(""+this.time,this.screen.w-100,10,6,0,d[51]),A.Text("BARK",60,14,4,0,d[51]),A.Box(140,20,8*this.player.power,16,d[51]));for(e=0;e<this.chat.length;e++){var n=this.chat[e];if(n.tm>0)if(n.wt>0)n.wt--;else{h=p.IsoPoint(n.x-t.x,n.y-t.y);A.Text(n.w,h.x,h.y,n.sz,1,n.c),0==--n.tm&&n.nt&&n.nt()}}if(1==this.dlog.active){A.Box(0,480,this.screen.w,this.screen.h,"rgba(0, 0, 0, 0.7)");for(e=0;e<this.dlog.tx.length;e++)A.Text(this.dlog.tx[e],180,496+28*e,4,0,1==this.dlog.wt?d[49]:this.dlog.p==e?d[33]:d[35])}break;case 6:A.News(this.screen.w,this.screen.h,this.photo,this.win)}}},window.Game=i}();var m,S,E,A,v=window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(t){window.setTimeout(t,1e3/60)},O=0,T={size:{tile:{width:48,height:48},iso:{width:24,height:24},screen:{width:17,height:13}},colliders:{hit:[11,12,13],over:[3,4,5,6,7,8,9,10],fend:[14]},level:{dim:{width:70,height:70},data:"0,20|4|3,17|0,32|1,20|5|3,17|1,32|0,22|4|3,14|0,33|1,23|4|3,11|1,35|0,23|5|3,10|0,36|1,6|12,17|6|3,9|12,31|1,6|0,6|11|0,19|4|3,5|0,11|15,7|0,13|11|0,6|1,6|12|1,37|4|3,4|1,14|12|1,6|0,6|11|0,38|4|3,2|0,15|11|0,6|1,6|12|1,35|16,8|1,13|12|1,6|0,6|11|0,37|4|3,3|0,15|11|0,6|1,6|12|1,35|4|3,4|1,16|12|1,6|0,6|11|0,38|4|3,2|0,15|11|0,6|1,6|12|1,45|16,6|1,5|12|1,6|0,6|11|0,40|4|0,15|11|0,6|1,6|12|1,7|16,7|1,24|4|1,3|4|1|16,6|1,6|12|1,6|0,6|11|0,7|15,7|0,5|8|7|0,19|4|0,3|15,2|0|15,4|0,5|11|0,6|7,6|12|1,7|16,7|1,4|8|7,2|1,17|4|1,4|4|16,7|1,5|12|1,6|7,7|0,8|15,5|0,3|8|7,3|0,19|15,3|0,4|4|3|0,8|11|0,6|7,7|1,15|8|7,3|1,19|4|3|16|4|1,5|16,2|1,5|4|1|12|1,6|7,8|0,3|8|7|0|8|7|0,2|8|7,3|8|7,3|0,18|4|3|15,2|5|3,3|15,3|4|0|4|0,2|4|3|0|11|0,6|7,11|9|7|1|9|7,3|8|7,6|1,20|16,2|4|3,2|1,2|4|16,2|5|3,5|1,2|12|1,6|7,13|0,2|8|7,7|0,16|4|3|0,4|15,2|0,5|3,2|15,2|0|4|3,3|0,2|11|0,6|1,6|12|1,5|8|7|1,41|16|1,2|4|3,2|1,2|12|1,6|0,6|11|0,8|15|0,38|15,3|0|5|3,2|0,2|11|0,6|1,6|12|1,47|4|16|4|3,3|1,3|12|1,6|0,6|11|0,46|4|5|15|5|3,3|0,3|11|0,6|1,6|12|1,46|5|16,2|3,3|1,4|12|1,6|0,6|11|0,46|15,2|4|3|0,6|11|0,6|2,6|13|2,56|13|2,5|14|2,6|13|2,56|13|2,5|14,2|2,5|13|2,56|13|2,6|14|2,5|13|2,56|13|2,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,7|16,7|1,8|16|1,33|12|1,6|0,6|11|0,7|15,7|0,15|15,15|0,12|11|0,6|1,6|12|1,7|16,7|1,15|16,15|1,12|12|1,6|0,6|11|0,7|15,7|0,12|15|0,2|15,12|6|15,2|0,12|11|0,6|1,6|12|1,7|16,7|1,12|16|1,2|16,15|1,12|12|1,6|0,6|11|0,26|15|0,2|15,15|0,12|11|0,6|1,6|12|1,56|12|1,6|0,6|11|0,33|15|0,22|11|0,6|1,6|12|1,33|16|1,22|12|1,6|0,6|11|0,33|15|0,22|11|0,6|1,6|12|1,33|16|1,22|12|1,6|0,6|11|0,56|11|0,6|1,6|12|1,56|12|1,6|0,6|11,58|0,6|1,70|0,70|1,70|0,70|1,70|0,70",spawn:{plr:[{x:40,y:54},{x:46,y:54}],man:[{x:17,y:52},{x:17,y:17},{x:53,y:17}],wdog:[{x:38,y:8},{x:42,y:18},{x:44,y:24},{x:58,y:36}],gdog:[{s:{x:27,y:9},e:{x:27,y:15}},{s:{x:43,y:9},e:{x:48,y:9}},{s:{x:29,y:17},e:{x:34,y:17}},{s:{x:29,y:38},e:{x:29,y:44}},{s:{x:44,y:39},e:{x:44,y:43}}],hme:{x:48,y:53},carl:[{x:69,y:31},{x:69,y:32}],carr:[{x:0,y:29},{x:0,y:30}],hard:[{x:57,y:6},{x:62,y:6},{x:38,y:7},{x:60,y:7},{x:62,y:7},{x:52,y:8},{x:59,y:8},{x:40,y:9},{x:61,y:9},{x:36,y:10},{x:38,y:13},{x:41,y:13},{x:61,y:13},{x:40,y:16},{x:54,y:16},{x:58,y:16},{x:41,y:18},{x:60,y:18},{x:61,y:18},{x:38,y:19},{x:62,y:19},{x:62,y:20},{x:36,y:22},{x:61,y:22},{x:9,y:23},{x:18,y:23},{x:22,y:23},{x:53,y:23},{x:57,y:23},{x:20,y:24},{x:39,y:24},{x:43,y:24},{x:47,y:24},{x:53,y:24},{x:60,y:24},{x:7,y:25},{x:14,y:28},{x:15,y:28},{x:20,y:28},{x:50,y:28},{x:52,y:28},{x:57,y:28},{x:26,y:33},{x:34,y:33}],tys:[{x:40,y:57}],trt:[{x:29,y:50},{x:33,y:53}],tony:[{x:40,y:53},{x:46,y:53}]}}};function L(t){var i=document.createElement("canvas");if(i.getContext){var s=i.getContext("2d");i.width=T.size.screen.width*T.size.tile.width,i.height=T.size.screen.height*T.size.tile.height,document.getElementById(t).appendChild(i),A=new g(s,{w:i.width,h:i.height},{x1:32,x2:32,y1:32,y2:96}),function(){var t=b();m=t,E=new Game(T),C()}()}}function C(){for(S=b(),O+=Math.min(1,(S-m)/1e3);O>1/60;)O-=1/60,R(1/60);E.Render(),m=S,v(C)}function b(){var t=window.performance;return t&&t.now?t.now():(new Date).getTime()}function R(t){E.Update(t)}window.onload=function(){L("cb")}
  </script>

</body>

</html>