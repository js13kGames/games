<!doctype html><title>Repeewsenim - js13kGames 2019</title><meta name=viewport content="width=device-width"><style id=webmakerstyle>:root{--unit:100px}*{box-sizing:border-box}:focus{outline-offset:3px;outline-color:#000;outline-width:5px;outline-style:dashed}body{font-family:"Segoe UI",Tahoma,Geneva,Verdana,sans-serif;font-size:200%;line-height:1.4;max-width:100vw;overflow-x:hidden;margin:0;min-height:100vh;background:linear-gradient(180deg,#141142 0,#58549c 82%,#46345a 100%);color:#b5b1fb;text-align:center;position:relative}@media screen and (max-width:400px){body{font-size:100%}}.link{color:#faebd7}.small-text{font-size:.7em}.screen{top:0;left:0;right:0;bottom:0;opacity:0;width:100vw;min-height:90vh;overflow-x:hidden;display:none}.screen.visible{opacity:1;visibility:visible;display:block}.btn{font-family:inherit;font-size:inherit;padding:1rem 2rem;margin:.5rem;border:4px solid #000;box-shadow:6px 6px;cursor:pointer;transition:.25s ease;will-change:transform}.btn:focus,.btn:hover{transform:rotateZ(6deg)}.btn:active{box-shadow:1px 1px}.btn p{margin-bottom:0}summary{cursor:pointer}.container{transform:rotateX(60deg) rotateY(0) rotateZ(-45deg);position:relative;width:calc(var(--unit) * 6);transform-origin:center center}.tile{font-size:calc(var(--unit) * .7);text-align:center;--border-width:0.1em;width:var(--unit);height:var(--unit);position:absolute;background:#8ba069;border-left:var(--border-width) solid rgba(0,0,0,.5);border-bottom:var(--border-width) solid rgba(0,0,0,.3);color:#414e2d;contain:size layout style;transition:opacity .25s ease,border .25s ease,margin .25s ease,color .25s ease}.tile:not(.hole):not(.cover){text-shadow:7px -4px 0 rgba(0,0,0,.5),6px -4px 0 rgba(0,0,0,.6),0 -4px 0 rgba(255,255,255,.6)}.game-started .tile:not(.hole):not(.cover):focus,.game-started .tile:not(.hole):not(.cover):hover{margin-left:10px;margin-top:-10px;z-index:10;box-shadow:5px -5px 20px 2px rgba(0,0,0,.35)}.cover{border:0;background:#3b3779;height:20px}.hole:before{content:"";display:block;position:absolute;width:10px;height:200vw;bottom:200vh;background:#fff;left:20px;opacity:0;transition:.5s ease;transition-delay:var(--blast-delay)}.bomb-place-anim-1 .hole:before{opacity:1;bottom:30px}.bomb-place-anim-2 .hole:before{height:0}.bomb-place-anim-2 .hole{background:#fff}.game-started .hole{--hole-width:0.5em;background:#dc143c;border-left:0;border-bottom:0;border-right:var(--hole-width) solid rgba(0,0,0,.5);border-top:var(--hole-width) solid rgba(0,0,0,.3)}.game-started .hole:after{content:"💣";display:block;margin:-.2em 0 0 .1em}.tile:focus{outline-width:8px;outline-style:solid;outline-color:#000}.overlay{background:linear-gradient(to bottom,rgba(255,255,255,0),rgba(255,255,255,0) 50%,rgba(0,0,0,.2) 70%,rgba(0,0,0,.4));background-size:5px 5px;pointer-events:none;position:fixed;z-index:3;left:0;right:0;top:0;bottom:0;opacity:.4}[data-screen=game]{flex-direction:column}.game-board,[data-screen=game].visible{display:flex;justify-content:center;align-items:center;perspective:1170px;transition:perspective-origin 2s cubic-bezier(.42, 0, .24, 1.01)}details{margin:2rem auto;padding:2rem;color:#000;background:#fff;transition:.5s cubic-bezier(.5, -.03, .25, 1);border:5px solid;box-shadow:6px 6px;width:95vw;max-width:600px}details[open]{transform:translateY(-240px);max-width:95vw}.message{position:fixed;contain:layout style paint;top:30vh;left:50%;width:3px;height:10px;transform:translateX(-50%);overflow:hidden;background:#fff;color:#000;transition:.4s cubic-bezier(.99, -.1, .71, 1.68)}.message__text{overflow:hidden;max-height:0}.message-anim-1 .message{width:90vw}.message-anim-2 .message{transition:.3s ease;width:90vw;transform:translateX(-50%) scale(1);border:5px solid #000;box-shadow:6px 6px}.message-anim-2 .message__text{max-height:700px}.message-anim-2 .message{padding:3rem;height:auto}.particle{width:15px;height:15px;background:red;position:fixed;top:0;left:0;z-index:3;will-change:transform,opacity;contain:size layout paint style}[data-screen=menu] .container{animation:board-swing 50s;animation-iteration-count:infinite;animation-timing-function:linear;transform-origin:center center}@keyframes board-swing{30%{transform:rotateX(60deg) rotateY(0) rotateZ(-15deg)}60%{transform:rotateX(40deg) rotateY(0) rotateZ(-55deg)}80%{transform:rotateX(80deg) rotateY(0) rotateZ(0)}}.bomb{position:fixed;contain:size layout paint paint;height:100px;height:100px;font-size:100px;z-index:-1;top:0;left:0;will-change:transform,opacity}.title{display:inline-flex;justify-content:center;transition:.7s cubic-bezier(.95, .05, .795, .035)}.title-letter{width:1em;overflow:hidden;transition:.6s cubic-bezier(.8, -.07, .51, 1.13);text-transform:uppercase}.title-letter-odd{width:0;opacity:0}.title-wrap:hover .title-letter{width:0;opacity:0}.title-wrap:hover .title-letter-odd{width:1em;opacity:1}</style><div class="screen visible" data-screen=menu><div class=title-wrap><h1 id=titleEl class=title aria-label="Repeewsenim (Minesweeper in reverse)"></h1><script>const letters="Minesweeper".split("");letters.forEach(((t,e)=>{const l=document.createElement("div");l.className="title-letter title-letter-odd",l.textContent=t,titleEl.append(l);const n=document.createElement("div");n.className="title-letter",n.textContent=letters[letters.length-e-1],titleEl.append(n)}))</script></div><div class=d-f><button class=btn type=button data-level=0 onclick=setupGame(event)>Play easy <span aria-hidden=true>🙂</span><p class=small-text>Highscore: <span id=easyHighScoreEl>-</span></button> <button class=btn type=button data-level=1 onclick=setupGame(event)>Play hard <span aria-hidden=true>🤪</span><p class=small-text>Highscore: <span id=hardHighScoreEl>-</span></button></div><div><details><summary>See Help</summary><h2>If you know how to play Minesweeper:</h2><p>You need to play Minesweeper backwards. You know where the bombs and you need to put correct number on each tile.<h2>If you don't know how to play Minesweeper:</h2><p>A grid will show up with bombs placed in random cells. Your task is to assign correct number to each cell which does not have a bomb.<p>A cell's number is the count of bombs that are placed around it i.e. the (at most) eight cells surrounding it. So if there is just one bomb around a cell, its number should be 1 and so on...If there is no bomb around a cell, it should be left empty.</details><details><summary>Controls</summary><h2>Mouse</h2><p>Click any cell to cycle between values 0 to 8. Left click increments by 1 and right click decrements by 1.<h2>Keyboard</h2><strong>This game is screen-reader compatible.</strong><p>Navigate through cells with <kbd>Tab</kbd> or <kbd>Arrow</kbd> keys. Press <kbd>Space</kbd> or <kbd>Enter</kbd> key to cycle between values 0 to 8 or simply press the numeric key to assign value directly.</details></div><div aria-hidden=true style=position:fixed;z-index:-1;top:100px;opacity:.5;pointer-events:none><div class="game-board game-started"><div id=menuTileContainer class=container></div></div></div></div><div class=screen data-screen=help><h2>Help</h2><p>Hahahaha</div><div class=screen data-screen=game><div id=tileContainer class=container></div><div class=time>Your time: <span id=timeEl>0</span> seconds</div></div><div aria-hidden=true id=particleContainer style="position:fixed;left:0;top:0;width:100vw;height:100vh;z-index:4;contain:size layout paint style;pointer-events:none"></div><div class=overlay></div><footer class=small-text>A Js13kGames 2019 entry by <a class=link href=https://kushagra.dev>Kushagra Gour</a></footer><script>const u=window.innerWidth,p=window.innerHeight;function d(e,t){return e+~~(Math.random()*(t-e))}function m(t,s){Object.keys(s).map(e=>{t.style[e]=s[e]})}function y(e,t){return(e=document.createElement(e)).className=t,e}const i={};e=function(e){function t(e){e=e.split(o),this.frequency=t.getFrequency(e[0])||0,this.duration=t.getDuration(e[1])||0}function s(e,t,s){this.ac=e||new AudioContext,this.createFxNodes(),this.tempo=t||120,this.loop=!0,this.smoothing=0,this.staccato=0,this.notes=[],this.push.apply(this,s||[])}var i=440*Math.pow(Math.pow(2,1/12),-9),n=/^[0-9.]+$/,o=/\s+/,a=/(\d+)/,r={};"B#-C|C#-Db|D|D#-Eb|E-Fb|E#-F|F#-Gb|G|G#-Ab|A|A#-Bb|B-Cb".split("|").forEach(function(e,t){e.split("-").forEach(function(e){r[e]=t})}),t.getFrequency=function(e){e=e.split(a);var t=r[e[0]];return e=(e[1]||4)-4,i*Math.pow(Math.pow(2,1/12),t)*Math.pow(2,e)},t.getDuration=function(e){return n.test(e)?parseFloat(e):e.toLowerCase().split("").reduce(function(e,t){return e+("w"===t?4:"h"===t?2:"q"===t?1:"e"===t?.5:"s"===t?.25:0)},0)},s.prototype.createFxNodes=function(){var s=this.gain=this.ac.createGain();return[["bass",100],["mid",1e3],["treble",2500]].forEach(function(e,t){(t=this[e[0]]=this.ac.createBiquadFilter()).type="peaking",t.frequency.value=e[1],s.connect(s=t)}.bind(this)),s.connect(this.ac.destination),this},s.prototype.push=function(){return Array.prototype.forEach.call(arguments,function(e){this.notes.push(e instanceof t?e:new t(e))}.bind(this)),this},s.prototype.createCustomWave=function(e,t){t=t||e,this.waveType="custom",this.customWave=[new Float32Array(e),new Float32Array(t)]},s.prototype.createOscillator=function(){return this.stop(),this.osc=this.ac.createOscillator(),this.customWave?this.osc.setPeriodicWave(this.ac.createPeriodicWave.apply(this.ac,this.customWave)):this.osc.type=this.waveType||"square",this.osc.connect(this.gain),this},s.prototype.scheduleNote=function(e,t){var s=60/this.tempo*this.notes[e].duration,i=s*(1-(this.staccato||0));return this.setFrequency(this.notes[e].frequency,t),this.smoothing&&this.notes[e].frequency&&this.slide(e,t,i),this.setFrequency(0,t+i),t+s},s.prototype.getNextNote=function(e){return this.notes[e<this.notes.length-1?e+1:0]},s.prototype.getSlideStartDelay=function(e){return e-Math.min(e,60/this.tempo*this.smoothing)},s.prototype.slide=function(e,t,s){var i=this.getNextNote(e),n=this.getSlideStartDelay(s);return this.setFrequency(this.notes[e].frequency,t+n),this.rampFrequency(i.frequency,t+s),this},s.prototype.setFrequency=function(e,t){return this.osc.frequency.setValueAtTime(e,t),this},s.prototype.rampFrequency=function(e,t){return this.osc.frequency.linearRampToValueAtTime(e,t),this},s.prototype.play=function(s){return s="number"==typeof s?s:this.ac.currentTime,this.createOscillator(),this.osc.start(s),this.notes.forEach(function(e,t){s=this.scheduleNote(t,s)}.bind(this)),this.osc.stop(s),this.osc.onended=this.loop?this.play.bind(this,s):null,this},s.prototype.stop=function(){return this.osc&&(this.osc.onended=null,this.osc.disconnect(),this.osc=null),this},e.Note=t,e.Sequence=s},"function"==typeof define&&define.amd?define(["exports"],e):e("object"==typeof exports&&"string"!=typeof exports.nodeName?exports:this.TinyMusic={});var o,e=window.TinyMusic,t=new AudioContext,s=new e.Sequence(t,120,["- w","- w","- w","- w","B2 h","B3 e","B3 e","- h","B2 h","B1 s","B1 s","- h","A2 h","A3 s","A3 s","- h","F#1 e","F#1 e","F#2 e","F#2 e","B2 h","B3 e","B3 e","- h","B2 h","B1 s","B1 s","- h","A2 h","A3 s","A3 s","- h","F#1 e","F#1 e","F#2 e","F#2 e","B2 h","B3 e","B3 e","- h","B2 h","B1 s","B1 s","- h","A2 h","A3 s","A3 s","- h","F#1 e","F#1 e","F#2 e","F#2 e"]);s.staccato=.05,s.smoothing=.4,s.gain.gain.value=.3,s.mid.gain.value=3,s.bass.gain.value=8,s.bass.frequency.value=80,s.mid.gain.value=-6,s.mid.frequency.value=500,s.treble.gain.value=-2,s.treble.frequency.value=1400,s.loop=!1;const n=["B3 e","B3 s","B3 s","B3 e","B3 s","B3 s","B3 e","B3 s","B3 s","B3 e","C#4 e","D4 e","D4 s","D4 s","D4 e","D4 s","D4 s","D4 e","D4 s","D4 s","D4 e","C#4 e","A3 e","A3 s","A3 s","A3 e","A3 s","A3 s","A3 e","A3 s","A3 s","A3 e","A3 s","A3 s","F#3 e","F#3 s","F#3 s","F#3 e","F#3 s","F#3 s","G3 e","G3 s","G3 s","G3 e","G3 s","G3 s","B3 e","B3 s","B3 s","B3 e","B3 s","B3 s","B3 e","B3 s","B3 s","B3 e","C#4 e","D4 e","D4 s","D4 s","D4 e","D4 s","D4 s","D4 e","D4 s","D4 s","D4 e","C#4 e","A3 e","A3 s","A3 s","A3 e","A3 s","A3 s","A3 e","A3 s","A3 s","A3 e","A3 s","A3 s","F#3 e","F#3 s","F#3 s","F#3 e","F#3 s","F#3 s","G3 e","G3 s","G3 s","G3 e","G3 s","G3 s","B3 e","B3 e","F#4 e","D4 s","D4 s","D4 e","E4 e","C#4 e","A3 e","B3 e","B3 e","F#4 e","D4 s","D4 s","D4 e","E4 e","C#4 e","A3 e","A3 e","A3 e","E4 e","C#4 s","C#4 s","C#4 e","D4 e","C#4 e","A3 e","C#4 s","C#4 s","C#4 s","C#4 s","C#4 e","C#4 s","C#4 s","C#4 s","C#4 e","D4 e","C#4 e","A3 e","A3 e","B3 e","B3 e","F#4 e","D4 s","D4 s","D4 e","E4 e","C#4 e","A3 e","B3 e","B3 e","F#4 e","D4 s","D4 s","D4 e","E4 e","C#4 e","A3 e","A3 e","A3 e","E4 e","C#4 s","C#4 s","C#4 e","D4 e","C#4 e","A3 e","C#4 s","C#4 s","C#4 s","C#4 s","C#4 e","C#4 s","C#4 s","C#4 s","C#4 e","D4 e","C#4 e","A3 e","A3 e"],a=new e.Sequence(t,120,n),$=new e.Sequence(t,120,n);[a,$].forEach(e=>{e.staccato=.4,e.gain.gain.value=.7,e.mid.frequency.value=800,e.mid.gain.value=3,e.loop=!0,e.waveType="triangle"}),s.loop=!0,s.play(),a.play(),setTimeout(()=>{$.play()},8e3);class r{constructor({width:e=15,height:t=15,x:s=0,y:i=0,rotationX:n=0,rotationY:o=0,rotationZ:a=0,angularSpeed:r={x:10,y:10,z:10},alpha:h=1,vx:c=0,vy:l=0,friction:u=1,isConfetti:p=!1,classes:d="",color:m="red",gravity:y=0,alphaSpeed:f=-.01,scale:w=1,timeToDie:g=.6}){this.width=e,this.height=t,this.x=s,this.y=i,this.rotationX=n,this.rotationY=o,this.rotationZ=a,this.alpha=h,this.vx=c,this.vy=l,this.isConfetti=p,this.angularSpeed=r,this.friction=u,this.color=m,this.gravity=y,this.alphaSpeed=f,this.scale=w,this.timeToDie=g,this.el=document.createElement("div"),this.el.classList.add("particle"),d&&this.el.classList.add(d),this.el.style.backgroundColor=m,this.el.style.width=this.width+"px",this.el.style.height=this.height+"px",this.draw(),window.particleContainer.append(this.el)}destroy(){this.el.remove()}hasHitEnd(){return this.alpha<0||this.y>p}update(){this.x+=this.vx,this.y+=this.vy,this.vx*=this.friction,this.vy*=this.friction,this.vy+=this.gravity,this.isConfetti&&(.5<Math.random()&&(this.rotationX+=this.angularSpeed.x),.8<Math.random()&&(this.rotationY+=this.angularSpeed.y),.3<Math.random())&&(this.rotationZ+=this.angularSpeed.z),this.timeToDie-=1/60,this.timeToDie<0&&(this.alpha+=this.alphaSpeed)}draw(){this.el.style.transform=`translate(${this.x}px, ${this.y}px) rotate3d(1,1,1,${this.rotationX}deg)  scale(${this.scale})`,this.el.style.opacity=this.alpha}}class X{constructor({width:e=100,height:t=100,x:s=0,y:i=0,angularSpeed:n={x:10,y:10,z:10},alpha:o=0,vx:a=0,vy:r=0,classes:h="",gravity:c=.2,alphaSpeed:l=.01,scale:u=1,timeToDie:p=.6}){this.type="bomb",this.width=e,this.height=t,this.x=s,this.y=i,this.rotationZ=d(0,360),this.alpha=o,this.vx=a,this.vy=r,this.angularSpeed=n,this.gravity=c,this.alphaSpeed=l,this.scale=u,this.timeToDie=p,this.bounces=d(1,4),this.el=document.createElement("div"),this.el.classList.add("bomb"),this.el.textContent="💣",h&&this.el.classList.add(h),this.el.style.width=this.width+"px",this.el.style.height=this.height+"px",document.querySelector('[data-screen="menu"]').append(this.el)}destroy(){this.el.remove()}hasHitEnd(){return this.y+this.height===p}update(){this.x+=this.vx,this.y+=this.vy,this.vy+=this.gravity,this.y+this.height>p&&(this.bounces--,this.bounces?(this.y=p-this.height-1,this.rotationZ=this.rotationZ+d(-50,50),this.vy=.5*-this.vy):(this.y=p-this.height,this.gravity=0,this.vy=0)),this.alpha<1&&(this.alpha+=this.alphaSpeed)}draw(){this.el.style.transform=`translate(${this.x}px, ${this.y}px) rotateZ(${this.rotationZ}deg)  scale(${this.scale})`,this.el.style.opacity=this.alpha}}function h(s,e){i[s]=[],e.forEach(function(e){var t=new Audio;t.src=jsfxr(e),i[s].push(t)})}function c(e){i[e]&&i[e][d(0,i[e].length-1)].play()}function G(){this.B=function(e){for(var t=0;t<24;t++)this[String.fromCharCode(97+t)]=e[t]||0;this.c<.01&&(this.c=.01),(e=this.b+this.c+this.e)<.18&&(this.b*=e=.18/e,this.c*=e,this.e*=e)}}o=new function(){var W,U,Z,j,z,P,V,J,K,Q,_,ee;this.A=new G,this.reset=function(){var e=this.A;j=100/(e.f*e.f+.001),z=100/(e.g*e.g+.001),P=1-.01*e.h*e.h*e.h,V=1e-6*-e.i*e.i*e.i,e.a||(_=.5-e.n/2,ee=5e-5*-e.o),J=0<e.l?1-.9*e.l*e.l:1+10*e.l*e.l,K=0,Q=1==e.m?0:2e4*(1-e.m)*(1-e.m)+32},this.D=function(){this.reset();var e=this.A;return(W=1e5*e.b*e.b)+(U=1e5*e.c*e.c)+(Z=1e5*e.e*e.e+10)|0},this.C=function(e,t){for(var s,i,n,o,a=1!=(A=this.A).s||A.v,r=.1*A.v*A.v,h=1+3e-4*A.w,c=.1*A.s*A.s*A.s,l=1+1e-4*A.t,u=1!=A.s,p=A.x*A.x,d=A.g,m=A.q||A.r,y=.2*A.r*A.r*A.r,$=A.q*A.q*(A.q<0?-1020:1020),f=A.p?32+(2e4*(1-A.p)*(1-A.p)|0):0,X=A.d,w=A.j/2,G=.01*A.k*A.k,g=A.a,v=W,H=1/W,O=1/U,R=1/Z,A=1-(.8<(A=5/(1+20*A.u*A.u)*(.01+c))?.8:A),b=!1,x=0,C=0,D=0,B=0,S=0,q=0,F=0,E=0,T=0,k=0,L=Array(1024),N=Array(32),Y=L.length;Y--;)L[Y]=0;for(Y=N.length;Y--;)N[Y]=2*Math.random()-1;for(Y=0;Y<t;Y++){if(b)return Y;if(f&&++T>=f&&(T=0,this.reset()),Q&&++K>=Q&&(Q=0,j*=J),(j*=P+=V)>z&&(j=z,0<d)&&(b=!0),i=j,0<w&&(k+=G,i*=1+Math.sin(k)*w),(i|=0)<8&&(i=8),g||((_+=ee)<0?_=0:.5<_&&(_=.5)),++C>v)switch(C=0,++x){case 1:v=U;break;case 2:v=Z}switch(x){case 0:D=C*H;break;case 1:D=1+2*(1-C*O)*X;break;case 2:D=1-C*R;break;case 3:b=!(D=0)}m&&((n=0|($+=y))<0?n=-n:1023<n&&(n=1023)),a&&h&&((r*=h)<1e-5?r=1e-5:.1<r&&(r=.1));for(var M=0,I=8;I--;){if(++F>=i&&(F%=i,3==g))for(s=N.length;s--;)N[s]=2*Math.random()-1;switch(g){case 0:o=F/i<_?.5:-.5;break;case 1:o=1-F/i*2;break;case 2:o=(o=(o=.5<(o=F/i)?6.28318531*(o-1):6.28318531*o)<0?1.27323954*o+.405284735*o*o:1.27323954*o-.405284735*o*o)<0?.225*(o*-o-o)+o:.225*(o*o-o)+o;break;case 3:o=N[Math.abs(32*F/i|0)]}a&&(s=q,(c*=l)<0?c=0:.1<c&&(c=.1),S=u?(S+(o-q)*c)*A:(q=o,0),o=B=(B+((q+=S)-s))*(1-r)),m&&(L[E%1024]=o,o+=L[(E-n+1024)%1024],E++),M+=o}e[Y]=1<=(M=.125*M*D*p)?32767:M<=-1?-32768:32767*M|0}return t}},window.jsfxr=function(e){o.A.B(e);var t=o.D();e=new Uint8Array(4*((t+1)/2|0)+44),t=2*o.C(new Uint16Array(e.buffer,44),t),(s=new Uint32Array(e.buffer,0,44))[0]=1179011410,s[1]=36+t,s[2]=1163280727,s[3]=544501094,s[4]=16,s[5]=65537,s[6]=44100,s[7]=88200,s[8]=1048578,s[9]=1635017060,s[10]=t,t+=44;for(var s=0,i="data:audio/wav;base64,";s<t;s+=3){var n=e[s]<<16|e[s+1]<<8|e[s+2];i+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>18]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>12&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[n>>6&63]+"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/"[63&n]}return i.slice(0,i.length-(s-=t))+"==".slice(0,s)},h("laser",[[0,0,.20186369123006712,.08864788869394417,.3533138312310672,.730741378990208,.2,-.18340614838729788,0,0,0,0,0,.13312363811900763,.13711016008646912,0,0,0,1,0,0,.1086867241891986,0,.5],[0,0,.2732218187386066,.09292699553578221,.03300790675047618,.764744932473655,.36691959834015275,-.23915212474273018,0,0,0,0,0,.20399771679086742,.0022463616577739656,0,0,0,1,0,0,.0673932643123878,0,.5]]),h("explosion",[[3,,.3417,.4126,.2799,.0141,,.1053,,,,.239,.612,,,,.4363,-.2564,1,,,,,.5],[3,0,.29543862264632753,.34516609461402187,.42899737981196207,.33660416688363043,0,-.2690700410417636,0,0,0,0,0,0,0,0,-.21134041848609875,-.2316907481419962,1,0,0,0,0,.5],[3,0,.25248370901712475,.6325791872481547,.09061954133800243,.10337277112428506,0,-.2985780353874932,0,0,0,-.7302524884341515,.6027070326674928,0,0,0,.0061548340192078,-.02154246942121234,1,0,0,0,0,.5]]),h("hit",[[3,,.2403,.6344,.2291,.1147,,-.0681,,,,-.7594,.7851,,,.5514,,,1,,,,,.5],[3,.0341,.1945,.5512,.1999,.1522,.0221,-.0542,-.0411,.0473,,-.7584,.7943,,-.0028,.5986,,-.0285,1,.0442,,,-.0111,.5],[3,.0715,.2252,.5179,.1874,.1626,.0116,-.0217,-.0186,.0577,.0614,-.8043,.827,,-.0028,.6757,-.0179,-.0466,1,.0064,,,.0265,.5]]),h("winExplosion",[[3,0,.37402130250153964,.37755261732779943,.20860049840982053,.2615879349464807,0,-.3452769016527329,0,0,0,-.7349481878855222,.8091127974010215,0,0,0,-.059400677951952086,-.19253254157222524,1,0,0,0,0,.5]]),h("powerup",[[0,,.2102,,.321,.375,,.4517,,,,,,.341,,.4955,,,1,,,,,.5]]);var t=new AudioContext,l=new e.Sequence(t,220,["F5 s","- es","F5 es","F5 q","- s","G5 s","- es","G5 es","G5 q","- s","A5 s","- es","A5 es","A5 q"]),f=new e.Sequence(t,220,["A5 s","- es","A5 es","A5 q","- s","B5 s","- es","B5 es","B5 q","- s","C#6 s","- es","C#6 es","C#6 q"]),w=new e.Sequence(t,220,["C6 s","- es","C6 es","C6 q","- s","D6 s","- es","D6 es","D6 q","- s","E6 s","- es","E6 es","E6 q"]);l.loop=!1,f.loop=!1,w.loop=!1,l.waveType="triangle",f.waveType="triangle",w.waveType="triangle";let g=parseInt(window.getComputedStyle(document.documentElement).getPropertyValue("--unit")),v=[],A=[],b=6;const H={0:{n:3,mines:2},1:{n:6,mines:8},2:{n:12,mines:20}},O=[...document.querySelectorAll(".screen")],x="notStarted",C="started";let D,B,S=x,q="menu",F=[];const E="bms-high-score";let R,T=window.localStorage.getItem(E)&&JSON.parse(window.localStorage.getItem(E))||{0:0,1:0};function I(){easyHighScoreEl.textContent=T[0]?T[0]+"s":"-",hardHighScoreEl.textContent=T[1]?T[1]+"s":"-"}function W(e){O.forEach(e=>e.classList.remove("visible")),document.querySelector(`[data-screen="${e}"]`).classList.add("visible"),q=e,j(),window.removeEventListener("keyup",L),window.removeEventListener("click",L),"game"!==e&&(v=[],A=[],timeEl.textContent="0",document.body.classList.remove("bomb-place-anim-1","bomb-place-anim-2","bomb-place-anim-3","game-started"),Array.from(tileContainer.children).map(e=>e.remove()),S=x)}function U(e,t=window.tileContainer,s){b=H[e].n;var i=H[e].mines;g=~~(.8*Math.min(u,p)/b),document.documentElement.style.setProperty("--unit",g+"px"),m(t,{width:g*b+"px",height:g*b+"px"});let n=[];for(;n.length<i;){var o=d(0,b*b);n.includes(o)||n.push(o)}n=n.map(e=>({y:~~(e/b),x:e%b})),Array.from(t.children).map(e=>e.remove()),v=[];for(var a,r,h,c=0;c<b;c++){v[c]=[],A[c]=[];for(var l=0;l<b;l++)v[c][l]=0,A[c][l]=0}for(l=0;l<b+1;l++)for(c=0;c<b;c++){({isHole:a,isFake:r,isDummy:h}={isHole:n.some(e=>e.x===c&&e.y===l),isFake:l===b,isDummy:s}),r=y(r||a||h?"div":"button","tile"),a&&(r.classList.add("hole"),r.tileType="hole"),"BUTTON"===r.tagName&&r.setAttribute("type","button");const u=r;if(u.style.top=l*g+"px",u.style.left=c*g+"px",u.count=0,u.posX=c,u.posY=l,u.className.match(/(hole|cover)/)||N(u,l+1,c+1,0),u.className.match(/hole/)&&(N(u,l+1,c+1,"Bomb"),u.setAttribute("tabindex",0)),m(u,{transform:"translate(-10px, --10px)",transitionDelay:.02*(l*b+c)+"s",transitionTimingFunction:"0.25s cubic-bezier(0, 0.6, 0.6, 1.34)",opacity:0}),u.style.setProperty("--blast-delay",.3*Math.random()+"s"),setTimeout(()=>{m(u,{transform:"translate(0px, 0px)",opacity:1})},1),setTimeout(()=>{m(u,{transitionTimingFunction:null,transitionDelay:null,transitionDuration:null})},2e3),l===b)u.setAttribute("class","tile cover");else if("hole"===u.tileType)for(let t=v[c][l]=-1;t<=1;t++)for(let e=-1;e<=1;e++)0===t&&0===e||c+t<0||l+e<0||c+t>b-1||l+e>b-1||-1===v[c+t][l+e]||(v[c+t][l+e]=v[c+t][l+e]+1);t.append(u)}}function k(t){return new Promise(e=>{setTimeout(e,t)})}async function Z(e){var t=y("div","message");t.setAttribute("role","alert"),document.body.append(t),t.innerHTML=`<div class="message__text">${e}</div>`,await k(10),document.body.classList.add("message-anim-1"),await k(430),document.body.classList.add("message-anim-2"),c("powerup")}async function j(){document.body.classList.remove("message-anim-2"),document.querySelector(".message")&&document.querySelector(".message").remove(),document.body.classList.remove("message-anim-1")}function L(){S===x&&async function(){j();var e=Array.from(document.querySelectorAll(".tile.hole"));document.body.classList.add("bomb-place-anim-1"),e.forEach(e=>{setTimeout(()=>{c("laser")},d(0,600))}),await k(500),document.body.classList.add("bomb-place-anim-2"),V({time:.5}),e.forEach(e=>{var t=e.getBoundingClientRect();for(let e=d(5,8);e--;)F.push(new r({height:d(5,15),width:d(5,15),x:d(t.left,t.left+t.width),y:d(t.top,t.top+t.height),vx:d(-10,10),vy:-d(20,55),isConfetti:!0,gravity:.2,friction:.88,alphaSpeed:-.025,scale:.3+Math.random(0,1),angularSpeed:{x:d(-5,5),y:0,z:0},color:"#f00",timeToDie:.7}));setTimeout(()=>{c("explosion")},d(0,500))}),await k(500),document.body.classList.add("bomb-place-anim-3"),document.body.classList.add("game-started"),S=C,D=Date.now()}()}function N(e,t,s,i){e.setAttribute("aria-label",`Row ${t}, Column ${s}, Value `+i)}function z(e,t,s=1){A[e.posX][e.posY]=void 0!==t?t:A[e.posX][e.posY]+s,A[e.posX][e.posY]%=9,A[e.posX][e.posY]<0&&(A[e.posX][e.posY]=8),e.textContent=[1,2,3,4,5,6,7,8][A[e.posX][e.posY]-1],N(e,e.posY+1,e.posX+1,A[e.posX][e.posY]),V({time:.3,el:e,shakeIntensity:5}),c("hit");var i=e.getBoundingClientRect();for(let e=d(5,15);e--;)F.push(new r({height:20,width:20,x:d(i.left,i.left+i.width),y:d(i.top,i.top+i.height),vx:d(-10,10),vy:-d(20,55),isConfetti:!0,gravity:.2,friction:.88,alphaSpeed:-.025,scale:.3+Math.random(0,1),angularSpeed:{x:d(-5,5),y:0,z:d(-20,25)},color:"#5d6f41",timeToDie:.4}));if(function(){for(var e=0;e<b;e++)for(var t=0;t<b+1;t++)if(-1!==v[e][t]&&v[e][t]!==A[e][t])return;return 1}()){const d=(Date.now()-D)/1e3;S="ended",setTimeout(async()=>{await Z(`<p>You completed the level in <strong>${d} seconds!</strong></p><p><button class="btn" onclick="window.changeScreen('menu')">👈🏽 Back to menu</button><button class="btn" onclick="window.tweetScore(${R}, ${B})">🐦 Tweet your score!</button></p>`),document.querySelector(".message button").focus()},10),async function(){Y({n:30,minX:u/4-50,maxX:u/4+50,minY:100,maxY:p-100}),c("winExplosion"),await k(500),Y({n:30,minX:3*u/4-50,maxX:3*u/4+50,minY:100,maxY:p-100}),c("winExplosion"),await k(1500),c("winExplosion"),Y({n:20,minX:u/2-200,maxX:u/2+200,minY:100,maxY:p-100})}(),l.play(),f.play(),w.play(),((t=d)<T[B]||!T[B])&&(T[B]=t,window.localStorage.setItem(E,JSON.stringify(T)),I()),R=t}}function P(e){var t;S===C&&(t=e.target).className.match(/tile/)&&"BUTTON"===t.tagName&&z(t,void 0,0===e.button?1:-1)}function Y({n:t=20,minX:s=0,maxX:i=u,minY:n=0,maxY:o=p,...a}){for(let e=t;e--;)F.push(new r({x:s===i?s:d(s,i),y:n===o?n:d(n,o),vy:-d(40,60),vx:d(-40,40),isConfetti:!0,gravity:.5,friction:.88,color:`rgb(${d(0,255)}, ${d(0,255)}, ${d(0,255)} )`,...a}))}function M(t,s){function i(e,t,s){return e.parentElement.children[s*b+t]}if("right"===s||"left"===s){let e=t;for(var n="right"===s?"nextElementSibling":"previousElementSibling";(e=e[n]||t.parentElement.children["right"===s?0:b*b-1])&&e.className.match(/cover/););e.focus()}else if("up"===s||"down"===s){let e=t;for(var o="down"===s?1:-1;(e=e.posY+o<b&&0<=e.posY+o?i(e,e.posX,e.posY+o):i(e,e.posX,"down"===s?0:b-1))&&e.className.match(/cover/););e.focus()}}function V({time:e,el:t=document.body,shakeIntensity:s=15}){let i=e;!function e(){i-=1/60,t.style.transform=`translate(${d(-s,s)}px,${d(-s,s)}px)`,0<i?requestAnimationFrame(e):t.style.transform=null}()}window.oncontextmenu=e=>{if(e.target.className.match(/tile/))return P(e),!1},window.onclick=e=>{v.length&&"game"===q&&S===C&&P(e)},window.onkeyup=e=>{var t,s=e.target;S===C&&(s.className.match(/tile/)||["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(e.key)&&tileContainer.querySelector(".tile:not(.cover):not(.hole)").focus(),t=parseInt(e.key,10),isNaN(t)||z(s,t),"ArrowRight"===e.key?M(e.target,"right"):"ArrowLeft"===e.key?M(e.target,"left"):"ArrowDown"===e.key?M(e.target,"down"):"ArrowUp"===e.key&&M(e.target,"up"),["ArrowRight","ArrowLeft","ArrowUp","ArrowDown"].includes(e.key))&&e.preventDefault()},U(0,window.menuTileContainer,!0),function e(){var t=Date.now();"menu"===q&&Math.random()<.005&&F.push(new X({x:d(0,u),y:d(0,p/2)})),S===C&&(t=(~~(t-D)/1e3).toFixed(1),window.timeEl.textContent=t),F.map(e=>{if(e.update(),e.draw(),e.hasHitEnd&&e.hasHitEnd()){if(e.dead=!0,"bomb"===e.type){var t=e.el.getBoundingClientRect();for(let e=d(5,20);e--;)F.push(new r({height:d(5,15),width:d(5,15),x:d(t.left,t.left+t.width),y:d(t.top,t.top+t.height),vx:d(-10,10),vy:-d(20,55),isConfetti:!0,gravity:.4,friction:.88,alphaSpeed:-.025,scale:.3+Math.random(0,1),angularSpeed:{x:d(-5,5),y:0,z:0},color:"yellow",timeToDie:.7}))}e.destroy()}}),F=F.filter(e=>!e.dead),requestAnimationFrame(e)}(),I(),document.querySelectorAll("details").forEach(e=>{e.innerHTML+='<p><button class="btn">Close</button></p>',e.querySelector("button").addEventListener("click",()=>{e.open=!1})}),window.setupGame=function(e,t){e&&(t=parseInt(e.currentTarget.dataset.level,10),e.stopPropagation()),U(B=t),async function(){var e=document.querySelector('[data-screen="game"]');e.style.transition="none",e.style.perspectiveOrigin=`1170px ${p/2}px`,await k(10),e.style.transition=null,e.style.perspectiveOrigin=`${u/2}px ${p/2}px`}(),W("game"),Z("Click/Tap anywhere or press any key to start").then(()=>{window.addEventListener("keyup",L,{once:!0}),window.addEventListener("click",L,{once:!0})})},window.changeScreen=W,window.tweetScore=function(e,t){var s=["Yay!","Wohoo!","Yuhoo!","Check it out!","Rad!","Dang!","Woah!","Beat this!"];window.open(`http://twitter.com/share?url=${location.href}&text=🎮 ${s[d(0,s.length)]} I finished "Repeewsenim" in just ${e} seconds in ${t?"hard":"easy"} mode! 🔥💣&hashtags=js13k,indiedev&related=chinchang457`)}</script>