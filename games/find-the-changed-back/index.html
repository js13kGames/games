<title>Find the changed back</title><script src=/2019/webxr/babylon.js></script><style>body,html{overflow:hidden;width:100%;height:100%;margin:0;padding:0}#renderCanvas{width:100%;height:100%;touch-action:none}</style><canvas id=renderCanvas></canvas><script>var camera,textPlane,font,changeMaterial,canvas=document.getElementById("renderCanvas"),startFlag=!1,texts=["Start game","Game Over","TRUE! ","FALSE","TEST! ","press here for start","","Now changing..."],createScene=function(){var e=new BABYLON.Scene(engine);e.clearColor=new BABYLON.Color3(.3,.3,.3);createSphere(-3,0,2,.7,.5,0,0),createSphere(-1.5,0,2,.5,0,.2,1),createSphere(0,0,2,.6,.2,0,2),createSphere(1.5,0,2,0,.3,.6,3),createSphere(3,0,2,.8,0,.6,4),createSphere(-3,2,2,0,.5,.7,5),createSphere(-1.5,2,2,0,.8,0,6),createSphere(0,2,2,0,.2,.9,7),createSphere(1.5,2,2,.7,0,.7,8),createSphere(3,2,2,.6,.7,0,9);var a,r=Math.floor(10*Math.random())+0,t=e.getMeshByName("sphere"+r);genTextBoard("startBoard",texts[5],0,-5,25),genTextBoard("progressBoard",texts[6],0,2,25),genTextBoard("judgeBoard",texts[6],0,4,25);var n=e.createDefaultVRExperience();return n.enableInteractions(),n.onControllerMeshLoaded.add((e=>{var n;e.onTriggerStateChangedObservable.add((o=>{if("right"===e.hand){if(n<.9&&o.value>=.9&&null!=a)if("startBoard"==a.name&&0==startFlag){startFlag=!0,updateTextBoard("startBoard",texts[6]),updateTextBoard("progressBoard",texts[7]);var s=setInterval((function(){switch(r){case 3:case 5:case 7:t.material.diffuseColor.r+=.01,t.material.diffuseColor.r>=1&&(clearInterval(s),updateTextBoard("progressBoard",texts[1]));break;case 1:case 4:case 8:t.material.diffuseColor.g+=.01,t.material.diffuseColor.g>=1&&(clearInterval(s),updateTextBoard("progressBoard",texts[1]));break;case 0:case 2:case 6:case 9:t.material.diffuseColor.b+=.01,t.material.diffuseColor.b>=1&&(clearInterval(s),updateTextBoard("progressBoard",texts[1]))}}),100)}else a.name=="sphere"+r&&1==startFlag?updateTextBoard("judgeBoard",texts[2]):-1==a.name.indexOf("sphere")||a.name!="sphere"+r&&1==startFlag&&updateTextBoard("judgeBoard",texts[3]);n=o.value}}))})),n.onNewMeshSelected.add((function(e){a=e})),n.onSelectedMeshUnselected.add((function(){a=null})),new BABYLON.HemisphericLight("light",new BABYLON.Vector3(0,1,0),e).intensity=.7,e},createSphere=function(e,a,r,t,n,o,s){var l=BABYLON.MeshBuilder.CreateSphere("sphere"+s,{diameter:2,segments:32},scene);l.position=new BABYLON.Vector3(.5+e,1+a,4+r),l.scaling=new BABYLON.Vector3(.5,.5,.5);var d=new BABYLON.StandardMaterial("Material"+s,scene);d.diffuseColor=new BABYLON.Color3(t,n,o),d.specularColor=new BABYLON.Color3(.5,.6,.87),d.ambientColor=new BABYLON.Color3(.23,.98,.53),l.material=d},genTextBoard=function(e,a,r,t,n){(textPlane=BABYLON.MeshBuilder.CreatePlane(e,{width:10,height:3},scene)).position=new BABYLON.Vector3(r,t,n);var o=new BABYLON.DynamicTexture("DynamicTexture",{width:600,height:180},scene);o.hasAlpha=!0;var s=o.getContext();s.font="12px Arial";var l=s.measureText(a).width/12,d=Math.floor(600/(1*l));font=d+"px Arial",o.drawText(a,null,null,font,"#111111","transparent",!0,!0);var i=new BABYLON.StandardMaterial("mat",scene);i.diffuseTexture=o,textPlane.material=i},updateTextBoard=function(e,a){var r=scene.getMeshByName(e);if(null!=r){var t=r.material.diffuseTexture,n=t.getContext();n.clearRect(0,0,600,180),n.font="12px Arial";var o=n.measureText(a).width/12,s=Math.floor(600/(1*o));font=s+"px Arial",t.drawText(a,null,null,font,"#111111","transparent",!0,!0)}},engine=new BABYLON.Engine(canvas,!0,{preserveDrawingBuffer:!0,stencil:!0}),scene=createScene();engine.runRenderLoop((function(){scene&&scene.render()})),addEventListener("resize",(function(){engine.resize()}))</script>