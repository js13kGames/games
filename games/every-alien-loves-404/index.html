<!doctype html><title>Every Alien Loves 404 - js13kGames 2020</title><style>body{margin:0;transition:1s;font-family:monospace;background:#0e1a25;color:#aaa;line-height:1.6em;font-size:14px}.ui,canvas{position:absolute;left:0;top:0;width:100%;height:100%;image-rendering:pixelated;overflow:hidden}.ui{z-index:1}.p{position:absolute;padding:0 10px;background:#574ab7;color:#fff;border-radius:4px;transition:opacity .5s;font-weight:700;font-size:12px;transform:translate(-50%);min-width:108px;text-align:center;line-height:32px;box-sizing:border-box}.p.po{opacity:0!important}.p::before{position:absolute;top:0;left:50%;transform:translate(-50%,-50%) rotate(45deg);width:8px;height:8px;background:inherit;content:''}.p::after{display:flex;align-items:center;justify-content:center;position:absolute;top:0;left:0;height:100%;width:0;content:'';white-space:nowrap;transition:width .2s linear;font-size:12px;font-weight:700;color:#4e6d47;background:#9be889;box-sizing:border-box;border-radius:4px}.p.y{background:#a641e7}.p.R{background:#dd4391}.p.pl{overflow:hidden}.p.pf{animation:p4 .3s ease forwards}.p.pl::after{width:100%;transition:width 1s linear;border:2px solid #4e6d47}.p.pf::after{content:'404 NOT FOUND'}@keyframes p4{0%{transform:translate(-50%) scale(1)}50%{transform:translate(-50%) scale(1.2)}100%{transform:translate(-50%) scale(1)}}#a{text-align:center;position:relative;top:50%}#b,#b .w,#b.w .f,#u{display:none}#b{position:absolute;left:50vw;right:10vw;min-width:350px;top:90px}#b.w .w{display:block}h2,h3,h4,h5,h6{text-align:center}h3{font-size:45px;font-family:serif;color:#fff}h4{margin-bottom:-25px;font-size:22px;color:#ccc}h5{margin:120px 0 0 0;font-size:15px}h5 a{color:#9be889}h6{margin:0}a{color:#32c5d9}@keyframes blink{from{opacity:1}to{opacity:.4}}h2{animation:.5s blink ease-in-out infinite alternate;margin:10px 0}#w{position:absolute;height:2.2vh;width:16vh;transform:translate(-50%,50%);border-radius:.3vh;background:#202731;opacity:0;transition:opacity .15s}#wt{height:100%;background:#32c5d9}#wp{position:absolute;top:0;left:0;width:.3vh;height:100%;background:#fff;animation:wiggle .8s linear infinite alternate}#f{top:25%;left:50%;position:absolute;font-size:7vh;color:#444;text-shadow:0 0 1vh rgba(255,255,255,.5);opacity:0;font-weight:700;transform:translate(-50%,50%)}#f.i{transition:opacity .15s ease .4s,transform .15s ease .4s;opacity:1;transform:translate(-50%,0)}#f.o{transition:opacity .15s,transform .15s;opacity:0}#g{display:none}#r{border-radius:6px;padding:15px;width:50vh;background:rgba(28,37,46,.5);top:50%;margin:50vh auto;color:#fff;z-index:1000;position:relative;text-align:center;display:none}.t{background:rgba(28,37,46,.7);border-radius:6px;width:260px;position:absolute;top:70px;transition:.5s ease-in;max-height:450px;overflow:auto;z-index:100}#h{display:none;width:215px;left:20px;padding:15px 10px}#h .a{border-color:#32c5d9}#t{right:20px}.T{margin:5px 0;min-height:70px;padding:5px 0}@keyframes hl{0%{background-color:#9be889}100%{background-color:transparent}}.TT{background-color:#9be889;animation:hl 3s forwards}.TT .a{border-color:#9be889}.a{width:32px;image-rendering:pixelated;border:2px solid #dd4391;border-radius:4px;margin-left:6px}.v{color:#fff;font-size:12px;text-align:center;line-height:13px}.l{width:48px;float:left;margin-left:10px}.r{margin:0 10px 0 70px}.n{color:#fff;font-size:13px;font-weight:700;overflow:hidden;text-overflow:ellipsis;line-height:1;margin-bottom:4px}.c{font-size:11px;line-height:16px;overflow:hidden}@keyframes wiggle{to{left:100%}}</style><div class=ui><div id=a><h3>EVERY ALIEN LOVES 404</h3><p>BEST WITH EARPHONES; VR SUPPORTED<h2 id=x>LOADING...</h2></div><div id=b><h4>EVERY ALIEN LOVES 404</h4><h3 class=f>GAME OVER</h3><h3 class=w>YOU WIN</h3><p class=f>YOU FAILED TO GET ENOUGH DNA SAMPLES ON THE EARTH. NOW, TOO MANY HUMANS HEARD ABOUT YOUR SPECIES AND THE COOPERATION WITH SEVERAL GOVERNMENTS HAS BEEN TERMINATED DUE TO THE PUBLIC PRESSURE.<p class=w>YOU MANAGED TO GET ENOUGH DNA SAMPLES ON THE EARTH. YOU HAVE JUST SEND THE DATA BACK TO YOUR PLANET.<p>THE GOOD NEWS IS THAT WE CAN FINALLY GO BACK HOME NOW. HOME, SWEET HOME.<p>WELL, THE BAD NEWS IS THAT THE NAVIGATION SYSTEM KEEPS RETURNING 404...<h2>PRESS ENTER TO REPLAY</h2><h5>A <a href=//umeecorn.com>UMEECORN</a> GAME</h5><h6>BY <a href=//github.com/devyumao>@DEVYUMAO</a> AND <a href=//github.com/Ovilia>@OVILIA</a></h6></div><div id=g><div id=h class=t></div><div id=t class=t></div><div id=r></div><div id=p></div><div id=w><div id=wt></div><div id=wp></div></div><div id=f>?</div></div><canvas id=u></canvas></div><script type=module>import*as y from"/2020/webxr/three.js";var U,H,V,G,W,T=window,_=document,t=Math.PI,P=T.AudioContext||T.webkitAudioContext,Y=T.OfflineAudioContext||T.webkitOfflineAudioContext,F=[,,714,.09,.14,.42,1,.53,5.9,.1,199,.03,.1,.1,,,.1,.92,.08,.01],B=[,,113,.02,,.3,,.2,,.3,,,,,,,.03,.9,,.04],z=[,,73,,,.32,4,.62,-.2,,,,,,,,,.92,.02,.29],q=[,,47,.06,.03,.01,1,.72,74,92,432,.03,.03,,-.8],K=[,,1433,.11,,0,,.55,-5.7,,-431,.09,.23,,,,.14,,.16],k={t:null,e:!(H=44100),n:function(){function t(){2==++s&&(k.e=!0,k.i)&&(k.r.start(),k.s.start())}function e(M,A,a){var r=new Y(1,4*(A?44:.5)*44100,44100),s=[];M.forEach(function(t,p){var u=[],m=[],e=(s.push(m),r.createGain());e.gain.value=t.volumn||1,e.connect(r.destination);for(var f=t.maxOscillatorCnt||1,a=0;a<f;++a){var i=r.createOscillator(),n=(m.push(i),t.wave&&(i.type=t.wave),r.createGain());u.push(n),i.connect(n),n.connect(e)}for(var y=0,T=t.envelope,E=0;E<t.patterns.length;++E){var v=t.patterns[E];if(null!=v&&-1!=v){var w=1;v.span&&(w=v.span,v=v.pattern),v.forEach(function(t,e){var a=1/t.length,i=4*w/v.length*4;A&&0===p&&E===M[0].patterns.length-1&&(i/=4);for(var n,o=T.attack*i,r=y+o,s=r+T.decay*i,l=(o=T.sustain*i,T.value*a),c=s+o,h=T.release*i,d=0;d<f;++d)d<t.length?(n=function(t,e){for(e=e||0;t<=0;)--e,t+=7;for(;7<t;)++e,t-=7;return 440*Math.pow(2,e+[0,2,3,5,7,8,10][t-1]/12)}(t[d]),m[d].frequency.setValueAtTime(n,y),(n=u[d].gain).setValueAtTime(0,y),n.linearRampToValueAtTime(a,r),n.linearRampToValueAtTime(l,s),n.setValueAtTime(l,c),n.linearRampToValueAtTime(0,c+h)):(u[d].gain.setValueAtTime(0,y),u[d].gain.setValueAtTime(0,y+i));y+=i})}else{for(var o=0;o<f;++o)u[o].gain.setValueAtTime(0,y);y+=16}}}),s.forEach(function(t){t.forEach(function(t){t.start()})}),r.startRendering(),r.oncomplete=function(t){var e=k.t.createBufferSource();e.buffer=t.renderedBuffer,e.loop=!0,(t=k.t.createGain()).gain.value=0,e.connect(t),t.connect(k.o),A?(t.gain.value=1,k.h=t,k.r=e):(k.u=t,k.s=e),a(e)}}var i,a,n,o,r,s;k.i||(k.i=!0,U=new P,k.t=new P,s=0,k.o=k.t.createGain(),k.o.gain.value=.7,k.o.connect(k.t.destination),i=[7,4,5,2,3,0,3,4],r=(a=function(t,a){return a=a||0,i.map(function(e){return t.map(function(t){return e+7*a+t})})})([0],-1),n=a([0],-1),o=a([0],0),e([{patterns:[{span:2,pattern:r},r={span:2,pattern:a([0,3],-1)},r,r,r,[[3,0,-4]]],volumn:.2,maxOscillatorCnt:3,envelope:{attack:.3,decay:.05,sustain:.05,release:.5,value:.9}},{patterns:[,,o,n,,,n,o,n,-1],volumn:.1,envelope:{attack:0,decay:.5,sustain:0,release:.3,value:1}}],!0,t),e([{patterns:[{pattern:[[-5]],span:1/8}],volumn:.15,envelope:{attack:.4,decay:.05,sustain:.05,release:.5,value:.9},wave:"triangle"}],!1,t))},l:function(m){if(k.e){var[f=1,m=.05,y=220,T=0,E=0,v=.1,w=0,M=1,A=0,g=0,S=0,O=0,x=0,N=0,L=0,I=0,b=0,R=1,C=0,D=0]=[...m];let t,e,a=2*Math.PI,i=A*=500*a/H**2,n=(0<L?1:-1)*a/4,o=y*=(1+2*m*Math.random()-m)*a/H,r=[],s=0,l=0,c=0,h=1,d=0,p=0,u=0;for(g*=500*a/H**3,L*=a/H,S*=a/H,O*=H,x=H*x|0,e=(T=99+H*T)+(C*=H)+(E*=H)+(v*=H)+(b*=H)|0;c<e;r[c++]=u)++p%(100*I|0)||(u=w?1<w?2<w?3<w?Math.sin((s%a)**3):Math.max(Math.min(Math.tan(s),1),-1):1-(2*s/a%2+2)%2:1-4*Math.abs(Math.round(s/a)-s/a):Math.sin(s),u=(x?1-D+D*Math.sin(2*Math.PI*c/x):1)*(0<u?1:-1)*Math.abs(u)**M*f*.2*(c<T?c/T:c<T+C?1-(c-T)/C*(1-R):c<T+C+E?R:c<e-b?(e-c-b)/v*R:0),u=b?u/2+(b>c?0:(c<e-b?1:(e-c)/b)*r[c-b|0]/2):u),s+=(t=(y+=A+=g)*Math.sin(l*L-n))-t*N*(1-1e9*(Math.sin(c)+1)%2),l+=t-t*N*(1-1e9*(Math.sin(c)**2+1)%2),h&&++h>O&&(y+=S,o+=S,h=0),!x||++d%x||(y=o,A=i,h=h||1);(f=U.createBuffer(1,e,H)).getChannelData(0).set(r),(y=U.createBufferSource()).buffer=f,y.connect(U.destination),y.start()}},f:function(t){k.e&&k.u&&t!==k._lastIndicatorRatio&&(k.u.gain.value=t?2*t+.5:0,k.s.playbackRate.value=1+4*t,k.h.gain.value=1-.5*t,k._lastIndicatorRatio=t)},r:null,h:null,s:null,u:null,_lastIndicatorRatio:null,o:null,i:!1},X=[],$=[],j="?t=0"==T.location.search,J=[];function E(t){if(!j){var e=_.getElementById("r"),a="";switch(W=t){case 0:case 8:return void(e.style.display="none");case 1:a="USE A/S/D/W TO MOVE AROUND.";break;case 2:a="YOUR MISSION IS TO FIND 10 DNA SAMPLES ON THE EARTH. IF ONE IS NEAR YOU, THE BLUE LIGHT ON YOUR FLYING SAUCER WILL BLINK FASTER AND THE RADAR AUDIO MAY ALSO HELP.",setTimeout(()=>{J[2]=1},1e4);break;case 3:a="FIND THE PLACE WHERE THE LIGHT BLINKS FASTEST AND THE AUDIO HAS THE HIGHEST FREQUENCY.";break;case 4:a="HOLD SPACE AND RELEASE AT THE CORRECT MOMENT TO CATCH IT!";break;case 5:a="OOPS... YOU WERE WITNESSED BY HUMANS. IF TOO MANY PEOPLE KNOW ABOUT YOU, THE SECRET AGREEMENT WITH SEVERAL GOVERNMENTS THAT ALLOWS YOU TO COLLECT DNA WILL BE TERMINATED. SO, WATCH OUT FOR THE POPULARITY OF EACH TWEET AND MAKE IT 404 WHEN NECESSARY.",setTimeout(()=>{J[5]=1},15e3);break;case 6:a="FLY OVER THE RED SPOT AND HOLD SPACE TO MAKE IT 404, THANKS TO THE GREAT TECHNOLOGY OF OUR THREE-BODY GALAXY.";break;case 7:a="GOOD JOB! NOW, COMPLETE YOUR GOAL OF COLLECTING 10 DNA SAMPLES. REMEMBER YOU ONLY HAVE TO MAKE THE TWEETS 404 WHEN NECESSARY. DON'T WASTE TOO MUCH TIME ON IT.",setTimeout(()=>{E(8),j=!0},15e3)}e.innerText=a,e.style.display="block"}}function o(t){return _.getElementById(t)}var v,Q,Z,w,tt,et,at,it,nt,l,ot="block",rt="none",st="#fff",s=T.innerWidth,n=T.innerHeight,c=2,lt=10,M=t/600,ct=M/30,ht=.42*t,A={g:0,D:1,L:2,H:3,m:4,U:5,k:6,C:7,W:8,Y:9,F:10},dt=new y.Vector3(1,0,0),pt=new y.Vector3(0,1,0),ut=new y.Vector3(0,0,0),mt=new y.Vector3(1,1,1),ft=Math.max(2,Math.round(n/250));T.rttOn=!0;var yt,Tt,Et,g,S,O,vt,wt,Mt,At,gt,x,St,Ot,xt,Nt,Lt,It,N=[],L=new y.Group,I=new y.Group,bt=new y.Group,Rt=0,Ct={},b={phi:0,theta:0},R=0,Dt=0,C=A.g,Ht=new y.Vector3(-50,-.65,13),kt=new y.Vector3(0,0,20),Ut=new y.Vector3(0,0,0),Vt=new y.Vector3(-100,0,-250),Gt=new y.Vector3(-50,0,11),Wt=se(11,ht,0),_t=new y.Vector3(-3,1,16),Pt=!1,h={J:"#DD4391",Q:"#0e1a25",X:["#31d9d9","#32c5d9","#44a9c8","#2694b9","#067499"],j:"#9be889"},Yt=o("g"),Ft=!0,Bt=[87,38,83,40,65,37,68,39],D={q:new y.Group,Z:new y.SphereGeometry(.1,16,16),tt:new y.MeshToonMaterial({color:"#ffadd2"}),et:1/0,nt:!1,at:!1,it:null,rt(){L.add(this.q),this.q.layers.set(2),this.st(.42+ht,.42);for(var t=he(lt,ht,0),e=0;e<9;++e){do{var a=le(),i=le(),n=se(lt,a,i)}while(n.angleTo(t)<=.5);this.st(a,i)}},ot(){this.q.remove(...this.q.children);for(var t=0;t<10;++t)this.st(le(),le());this.it=null},st(t,e){var a=new y.Mesh(this.Z,this.tt);a.position.setFromSphericalCoords(lt,t,e),a.visible=!1,this.q.add(a)},ht(t){this.q.remove(t)},ut(){return this.q.children.length},ct(){this.et=qt(this.q.children),this.nt=this.et<=.5,this.at=this.et<=.045,this.Et()},Et(){if(C===A.U&&this.at&&!this.it){if(this.it=Kt(this.q.children),!this.it)return;var t=he(lt,ht,0);this.it.position.set(t.x,t.y,t.z),this.it.visible=!0}if(this.it){const t=(new y.Spherical).setFromVector3(this.it.position);t.radius<11?(t.radius+=.02,this.it.position.setFromSpherical(t)):(this.ht(this.it),this.it=null,oe(),$t.st(),this.ut()||setTimeout(()=>te(3,1),500))}}},zt={q:new y.Group,Z:new y.SphereGeometry(.15,16,16),tt:new y.MeshToonMaterial({color:"#ff4d4f",transparent:!0,opacity:.7}),et:1/0,it:null,lt:o("p"),ft:Date.now(),vt:{Tt:null,wt:!1,$t:null},At:null,rt({At:t}){this.At=t,this.q.layers.set(2),L.add(this.q)},ot(){for(var t=this.q.children,e=t.length-1;0<=e;e--)this.ht(t[e]);this.it=null},ut(){return this.q.children.length},st(t,e){var a=new y.Mesh(this.Z,this.tt);a.position.setFromSphericalCoords(lt,t,e),a._viewed=pe(1,10),a._maxV=pe(100,1e5),a._p=r("div",this.lt,"p"),this.q.add(a),this.Mt(a),t=this.At.st(a._viewed),a._n=t},ht(t){t&&(t._p&&this.lt.removeChild(t._p),t._p=null,t._n=null,this.q.remove(t))},Ot(){return this.q.children.reduce((t,e)=>t+(e._d?0:e._viewed),0)},ct(){var t,e,a;re()&&(this.ut()<8&&((t=Math.floor(Rt/30))&&!Ct[t]&&(e=bt.children.sort((t,e)=>t._t-e._t)[0])&&((a=new y.Spherical).setFromVector3(e.position),a.phi+=i(.6),a.theta+=i(.6),this.st(a.phi,a.theta),bt.remove(e)),Ct[t]=!0),this.et=qt(this.q.children),this.Et(),this.It())},Et(){var t;this.it=this.et<.03?Kt(this.q.children):null,C===A.Y&&(t=this.vt,N[32]?t.wt?1e3<=Date.now()-t.Tt&&this.Nt():this.pt():this.dt())},pt(){var{vt:t,it:e}=this;e&&(t.wt=!0,e._p.classList.add("pl"),t.Tt=Date.now())},dt(){var{vt:t,it:e}=this;e&&(e._p.classList.remove("pl"),t.wt=!1,t.$t=!1)},Nt(){var{vt:t,it:e,At:a}=this;e&&(t.wt=!1,t.$t=!0,e._p.classList.add("pf"),e.visible=!1,e._d=!0,a.St(e._n),setTimeout(()=>{e&&(e._p&&e._p.classList.add("po"),setTimeout(()=>this.ht(e),500))},3e3),k.l(K),5!==W&&6!==W||setTimeout(()=>E(7),1e3),oe())},It(){var n=1e3<Date.now()-this.ft,o=(n&&(this.ft=Date.now()),!1);this.q.children.forEach(t=>{var e=ce(t),a=t._p,i=a.style;i.left=Math.round(e.x)+"px",i.top=Math.round(e.y+10)+"px",i.opacity=e.z<5?.2:1,t._d||t===this.it&&C===A.Y||!n||(t._viewed+=pe(0,t._maxV),this.Mt(t),this.At.Rt(t._n,a.innerText),o=!0)}),o&&(oe(),5e6<=zt.Ot())&&setTimeout(()=>te(3),500)},Mt(t){var e,a=t._p;1e6<=t._viewed?(e=Math.round(t._viewed/1e5)/10+"M",a.setAttribute("class","p R"),a.innerText=e+" VIEWED"):1e4<=t._viewed?(e=Math.round(t._viewed/100)/10+"K",a.setAttribute("class","p y"),a.innerText=e+" VIEWED"):a.innerText=t._viewed+" VIEWED"}};function qt(t){return t.reduce(function(t,e){var a=I.position.angleTo(e.localToWorld(new y.Vector3));return e.userData.angle=a,Math.min(t,a)},1/0)}function Kt(t){return t.reduce(function(t,e){return e._d||t&&!(e.userData.angle<t.userData.angle)?t:e},null)}var Xt={gt:o("t"),Dt(){this.gt.style.display=ot},Lt(){this.gt.style.display=rt},ot(){this.Lt(),this.gt.innerHTML=""},st(){var t=r("div",this.gt,"T"),e=r("div",t,"l");return r("img",e,"a").setAttribute("src",(null==V&&(V=Math.floor(Math.random()*X.length)-1),++V>=X.length&&(V=0),X[V])),r("div",e,"v"),e=r("div",t,"r"),r("div",e,"n").innerText="@"+de(["ALICE","BOB","CAROL","DAVE","EVE","FRANK","GRACE","HEIDI"])+"_"+de(["LOVES","HATES","MISSING","THE"])+"_"+de(["CATS","DOGS","SLEEPING","OVILIA","YUMAO","YOU","JOKES","JS","GAMES"]),r("div",e,"c").innerText=de(["OMG!","OH NO!","OH SH*T...","CAN YOU BELIEVE THIS?","TELL ME I HAVEN'T WOKEN UP FROM MY DREAM.","ARE YOU KIDDING?","YOU WON'T BELIEVE THIS!","I CAN'T BELIEVE THIS EITHER... BUT","I CAN'T BELIEVE MY OWN EYES","!!!",""])+" "+de(["THERE IS AN ALIEN IN MY BACKYARD?!!","AN ALIEN IN THE DOWNTOWN!","MY SON SAID THAT HE SAW AN ALIEN THIS MORNING. GUESS HOW OLD IS HE?","GUESS WHAT/WHO I SAW TODAY!","I SAW A UFO FLYING OVER MY HOUSE JUST NOW!","WHAT'T THE *THING* FLYING OVER ME JUST NOW???","WAS IT AN ALIENE OR AEROPLANE?"]),t.parentNode.scrollTop=t.offsetTop,this.Dt(),k.l(q),t},Rt(t,e){t.getElementsByClassName("v")[0].innerText=e},St(t){t.className="T TT",this.Rt(t,"NA"),t.children[1].children[1].innerText="(404) NOT FOUND",t.parentNode.scrollTop=t.offsetTop}},$t={gt:o("h"),Dt(){this.gt.style.display=ot},Lt(){this.gt.style.display=rt},ot(){this.Lt(),this.gt.innerText=""},st(){r("img",this.gt,"a d").setAttribute("src",(null==G&&(G=Math.floor(Math.random()*$.length)-1),++G>=$.length&&(G=0),$[G])),this.Dt()}},jt={gt:o("w"),Ht:o("wt"),mt:o("wp"),Ut:16,bt:0,kt:0,Ct:.3,$t:null,Wt(t){this.bt=(this.Ut-(t=1.5+.075/(.03+t)))/2,this.kt=this.Ut-this.bt;var e=this.Ht.style;e.marginLeft=this.bt+"vh",e.width=t+"vh"},Yt(){this.mt.style.animationPlayState="paused";var t=parseFloat(T.getComputedStyle(this.mt).left,10)/T.innerHeight*100;return t>=this.bt-this.Ct&&t<=this.kt},ct(){switch(this.Ft(),C){case A.m:this.gt.style.opacity=1,N[32]||(this.$t=this.Yt());break;case A.g:case A.k:this.gt.style.opacity=0,this.mt.style.animationPlayState="running"}C!==A.m&&(this.$t=null)},Ft(){var t,e;[A.m,A.k,A.U].includes(C)&&(t=ce(I),(e=this.gt.style).left=Math.round(t.x)+"px",e.top=Math.round(t.y)+"px")}},Jt={gt:o("f"),Tt:null,wt:!1,ct(){var t,e,a;C===A.k&&(t=this.gt,e=ce(I),(a=this.gt.style).left=Math.round(e.x)+"px",a.top=Math.round(e.y-T.innerHeight/12)+"px",t.className&&"o"!==t.className?1e3<=Date.now()-this.Tt&&(t.className="o",this.wt=!1):(this.wt=!0,t.className="i",this.Tt=Date.now()))}};function Qt(){var t=s,e=n,a=(s=T.innerWidth)/ft,i=(n=T.innerHeight)/ft;w.aspect=a/i,w.updateProjectionMatrix(),tt.left=a/-2,tt.right=a/2,tt.top=i/2,tt.bottom=i/-2,tt.updateProjectionMatrix(),it.scale.x*=s/t,it.scale.y*=n/e,at.setSize(a,i),v.setSize(s,n),nt.width=s*c,nt.height=n*c,oe()}function Zt(t,e){0<b[e]?b[e]=Math.max(b[e]-t,0):b[e]<0&&(b[e]=Math.min(b[e]+t,0))}function te(t,e){R=t,t=o("b");var a,i=o("u");function n(){et.resetPose(),I._v=Wt.clone().sub(I.position).divideScalar(3),w._v=kt.clone().sub(w.position).divideScalar(3),S.position.y=-.08,S.scale.set(1.3,1.3,1),x.stop()}0===R?(I.position.set(...Gt.toArray()),w.position.set(...Ht.toArray())):1===R?((a=o("a")).parentNode.removeChild(a),n(),setTimeout(function(){te(2)},3e3)):3===R?(L._v=Vt.clone().sub(L.position).divideScalar(60),I._v=_t.clone().sub(I.position).divideScalar(15),S.scale.set(1,1,1),x.play(),t.style.display=ot,i.style.display=rt,t.className=e?"w":"f",Yt.style.display=rt,k.f(0),Rt=0,Ct={},Ft=!(xt=It=null),bt.remove(...bt.children),Dt=0,g.scale.set(0,0,0),O.scale.set(0,0,0),D.ot(),zt.ot(),Xt.ot(),$t.ot(),setTimeout(function(){te(4)},6e4)):2===R&&(t.style.display=rt,i.style.display=ot,k.f(0),n(),I.position.set(...Wt.toArray()),w.position.set(...kt.toArray()),L.position.set(...Ut.toArray()),i.style.display=ot,oe(),Yt.style.display=ot,E(1))}function ee(e,a,i){["x","y","z"].forEach(function(t){a[t]>i[t]?e[t]=Math.max(e[t],i[t]):e[t]=Math.min(e[t],i[t])})}function ae(t,e,a,i){t._s?(t.scale.add(t._s.clone().multiplyScalar(a)).clamp(ut,mt),(t.scale.equals(ut)||t.scale.equals(mt))&&(t._s=null)):t._s=(i?ut:mt).clone().sub(t.scale).divideScalar(e)}function ie(t){t.isRunning()&&!t.paused||(t.stop(),t.play())}function ne(t){t.paused||(t.paused=!0)}function oe(){l.clearRect(0,0,nt.width,nt.height);var t=[20,30];o("DNA SAMPLES COLLECTED",t[0],t[1],"#ddd",16);for(var e=10-D.ut(),a=0;a<10;++a){var i=a<e?h.X[0]:"rgba(200,200,200,.1)";r(t[0]+22*a,42,18,18,2,i)}var n=s-t[0]-216;function o(t,e,a,i,n){l.fillStyle=i,l.font=n*c+"px monospace",l.fillText(t,e*c,a*c)}function r(t,e,a,i,n,o,r){l.fillStyle=o,o=a*c;var s=i*c;l.fillRect(t*c,e*c,o,s),o=t+a-n,s=e+i-n,a=n*c,l.clearRect(t*c,e*c,a,a),l.clearRect(t*c,s*c,a,a),r||(l.clearRect(o*c,e*c,a,a),l.clearRect(o*c,s*c,a,a))}o("PUBLIC PRESSURE",70+n,t[1],"#ddd",16),r(n,42,216,8,2,"rgba(200,200,200,.1)"),r(n,42,Math.min(zt.Ot(),5e6)/5e6*216,8,2,h.J,1)}function re(){return j||J[4]}function se(t,e,a){var i=new y.Vector3;return i.setFromSphericalCoords(t,e,a),i}function i(t){return y.MathUtils.randFloatSpread(t)}function le(){return i(2*t)}function ce(t){var e=s/2,a=n/2,i=new y.Vector3;return t.getWorldPosition(i),t=i.z,i.project(w),i.x=i.x*e+e,i.y=-i.y*a+a,i.z=t,i}function he(t,e,a){return L.worldToLocal(se(t,e,a))}function r(t,e,a){return t=_.createElement(t),e&&e.appendChild(t),a&&(t.className=a),t}function de(t){return t[Math.floor(Math.random()*t.length)]}function pe(t,e){return Math.floor(Math.random()*(e-t+1))+t}ke("👨‍🌾👩‍✈️👩‍🏫🕵️‍♀️👩‍💻👨‍🎨👩‍💼👨‍🚒🧙‍♂️👨‍🎓👨‍🚀🧛‍♂️👨‍🎤👷👨‍⚖️🧕",16,X),ke("🐼🦋🦊🐶🌻🐷🐝🐔🐙🐡",10,$),Q=new y.Scene,Z=new y.Scene,(w=new y.PerspectiveCamera(75,s/n,.1,1e6)).layers.enable(2),e=new y.BoxGeometry(5e3,5e3,5e3),a=new y.MeshBasicMaterial({color:h.Q,side:y.BackSide}),e=new y.Mesh(e,a),Q.add(e),a=s/ft,e=n/ft,(tt=new y.OrthographicCamera(a/-2,a/2,e/2,e/-2,-1e4,1e4)).position.z=100,at=new y.WebGLRenderTarget(a,e,{minFilter:y.NearestFilter,magFilter:y.NearestFilter,format:y.RGBFormat}),a=new y.PlaneBufferGeometry(a,e),e=new y.MeshBasicMaterial({map:at.texture}),(it=new y.Mesh(a,e)).position.z=-100,Z.add(it),(a={}).ambient=new y.AmbientLight(st,.7),a.ambient.layers.enable(2),a.ambient.layers.disable(0),Q.add(a.ambient),a.key=new y.DirectionalLight(st,.4),a.key.position.set(0,.5,1),a.key.layers.enableAll(),a.key.castShadow=!0,Q.add(a.key),a.spot=new y.SpotLight("#fc6",.25,100,t/12,.5,2),a.spot.position.set(0,5,20),a.spot.lookAt(0,0,0),a.spot.shadow.mapSize.width=1024,a.spot.shadow.mapSize.height=1024,a.spot.layers.enableAll(),a.fillTop=new y.DirectionalLight("#888",1),a.fillTop.position.set(.5,1,.75),a.fillBottom=new y.DirectionalLight("#555",1),a.fillBottom.position.set(-.5,-1,-.75),a.fillTop.layers.enable(0),a.fillBottom.layers.enable(0),a.fillTop.layers.disable(2),a.fillBottom.layers.disable(2),L.add(a.fillTop),L.add(a.fillBottom);for(var ue=new y.IcosahedronGeometry(9.8,4),me=[],fe=0;fe<ue.vertices.length;++fe)me.push({x:ue.vertices[fe].x,y:ue.vertices[fe].y,z:ue.vertices[fe].z,delta:Math.random()*t*2});var e=new y.MeshPhongMaterial({color:h.X[0],flatShading:!0,vertexColors:!0,shininess:.8});(yt=new y.Mesh(ue,e)).layers.set(2),yt.receiveShadow=!0,L.add(yt),(a=new y.Mesh(new y.SphereGeometry(.25,32,32),new y.MeshToonMaterial({color:"#bfbfbf"}))).position.y=-.05,e=new y.Mesh(new y.ConeGeometry(.5,.25,32),new y.MeshToonMaterial({color:"#8c8c8c"})),(S=new y.Mesh(new y.TorusGeometry(.25,.05,32,64),new y.MeshBasicMaterial({color:h.X[0],transparent:!0,opacity:0}))).rotateX(Math.PI/2),S.position.y=-.06,(g=new y.Mesh(new y.ConeGeometry(.45,.8,32),new y.MeshToonMaterial({color:"#faad14",transparent:!0,opacity:.5}))).position.y=-.35,g.scale.set(0,0,0),(O=new y.Mesh(new y.CylinderGeometry(.15,.15,.76,32),new y.MeshToonMaterial({color:"#dd4491",transparent:!0,opacity:.5}))).position.y=-.4,O.scale.set(0,0,0),I.position.set(...Wt.toArray()),I.rotation.x=1,I.layers.set(0),I.add(a,e,S,g,O),Q.add(I),Nt=I.rotation.clone(),vt=new y.AnimationMixer(I),a=I.position,e=se(11.28,ht,0),a=new y.VectorKeyframeTrack(".position",[0,.8],[a.x,a.y,a.z,e.x,e.y,e.z]),e=new y.AnimationClip("UfoIdle",.8,[a]),(gt=vt.clipAction(e)).loop=y.LoopPingPong,gt.play(),wt=new y.AnimationMixer(S),(x=wt.clipAction(new y.AnimationClip("UfoIndicator",1,[new y.NumberKeyframeTrack(".material.opacity",[0,1],[0,1])]))).loop=y.LoopPingPong,x.play(),Mt=new y.AnimationMixer(g),(St=Mt.clipAction(new y.AnimationClip("UfoRay",1.2,[new y.VectorKeyframeTrack(".scale",[0,1.2],[1,1,1,.5,1,.5])]))).loop=y.LoopPingPong,At=new y.AnimationMixer(O),(Ot=At.clipAction(new y.AnimationClip("UfoLaser",.3,[new y.VectorKeyframeTrack(".scale",[0,.3],[1,1,1,.4,1,.4])]))).loop=y.LoopPingPong,Tt=new y.Group,L.add(Tt);for(var ye=new y.MeshPhongMaterial({color:new y.Color(st),flatShading:!0}),Te=0;Te<50;++Te)for(var Ee=i(2*t),ve=i(2*t),we=.5*Math.random()+.8,Me=0;Me<5;++Me){var Ae=[.4,.6,.8,.4][Me]+i(.2),ge=(Ae=new y.IcosahedronGeometry(Ae*we,0),Ae=new y.Mesh(Ae,ye),Ee+=.04+i(.03*t),i(.1));Ae.position.setFromSphericalCoords(12+ge,Ee,ve),Ae.rotation.set(i(2*t),i(2*t),i(2*t)),Ae.layers.set(2),Tt.add(Ae)}var a=new y.MeshPhongMaterial({color:h.j,flatShading:!0,shininess:0}),Se=new y.IcosahedronGeometry(10.1,4);(e=new y.Mesh(Se,a)).layers.set(2),e.receiveShadow=!0,L.add(e);for(var d={},Oe=[],p=0;p<Se.vertices.length;++p){var u=Se.vertices[p];100<u.x*u.x+u.y*u.y&&14<u.x*u.y-u.z||50<u.y*u.x+u.y*u.z&&u.y*u.x+u.y*u.z<65||u.y*u.z*u.z-u.x*u.x<-300||60<u.x*u.z-u.x*u.y||55<u.x-u.y+u.x*u.z||1400<u.x-(u.y+50)*(u.z-20)&&200<u.y*u.x||u.x*u.y-u.x<-50||(u.x-50)*u.z-u.x*u.y*8<-500||u.y*u.y-30*u.z-50*u.y+20*u.x<-490&&6<u.y||u.z<-8&&2<u.x||110<u.y*u.y-u.z+10*u.x?(Se.vertices[p].multiplyScalar(.6),Oe.push(0)):Oe.push(1)}for(Et=[],p=0;p<Se.faces.length;++p){var m=Se.faces[p];Oe[m.a]&&Oe[m.b]&&Oe[m.c]?(Et.push(5),d[m.a]=2,d[m.b]=2,d[m.c]=2):Et.push(-10)}for(var f=1;-4<f;--f)for(p=0;p<Se.faces.length;++p){var xe=d[(m=Se.faces[p]).a]>f,Ne=d[m.b]>f,Le=f<d[m.c];xe&&Ne&&Le||!(xe||Ne||Le)?f<=d[m.a]&&f<=d[m.b]&&(Et[p]=Math.max(f,Et[p])):(Et[p]=f,d[m.a]=null==d[m.a]?f:Math.max(f,d[m.a]),d[m.b]=null==d[m.b]?f:Math.max(f,d[m.b]),d[m.c]=null==d[m.c]?f:Math.max(f,d[m.c]))}Et.forEach(function(t,e){yt.geometry.faces[e].color=new y.Color(1<=t?h.X[0]:h.X[Math.min(1-t,h.X.length-1)])}),yt.geometry.colorsNeedUpdate=!0,Se.verticesNeedUpdate=!0;var Ie=new y.Group;L.add(Ie);for(var be=0;be<3e3;++be){var Re=new y.MeshBasicMaterial({color:"#999",opacity:.8*Math.random(),transparent:!0}),Ce=new y.TetrahedronGeometry(Math.random(),0),De=(Ce=new y.Mesh(Ce,Re),Re=150*(2*Math.random()+1),new y.Spherical(Re));De.phi=i(2*t),De.theta=i(2*t),Ce.position.setFromSphericalCoords(Re,De.phi,De.theta),Ce.rotation.set(Math.random()*t*2,Math.random()*t*2,Math.random()*t*2),Ce.scale.setScalar(i(6)),Ie.add(Ce)}function He(t,e){var a=_.createElement("canvas");return a.width=t,a.height=e,a}function ke(t,e,a){var i=He(64*e,64).getContext("2d");i.textAlign="left",i.textBaseline="top",i.font="64px serif",i.fillText(t,0,2);for(var n=He(16,16),o=n.getContext("2d"),r=0;r<e;++r){o.clearRect(0,0,16,16);for(var s=i.getImageData(64*r,0,64,64).data,l=i.createImageData(16,16),c=l.data,h=0;h<16;++h)for(var d=Math.round(4*h),p=0;p<16;++p)for(var u=4*(64*Math.round(4*p)+d),m=4*(16*p+h),f=0;f<4;++f)c[m+f]=s[u+f];o.putImageData(l,0,0),a.push(n.toDataURL())}}L.add(bt),Q.add(L),D.rt(),zt.rt({At:Xt}),v=new y.WebGLRenderer({antialias:!0,alpha:!0}),c=T.devicePixelRatio||1,v.setPixelRatio(c),v.autoClear=!1,v.setClearColor(h.Q,0),v.xr.enabled=!0,_.body.appendChild(v.domElement),nt=o("u"),l=nt.getContext("2d"),Qt(),Lt=new y.Clock,T.addEventListener("resize",Qt,!1),_.addEventListener("keydown",function(t){var e=-1<[13,32].indexOf(t.keyCode);!e&&Bt.includes(t.keyCode)&&0!==Dt||(N[t.keyCode]=!0),0===R?e&&(te(1),k.n()):2===R?Pt||(Pt=!0,It=Date.now()):3!==R&&4!==R||13===t.keyCode&&(T.location.href=j?"?t=0":"")}),_.addEventListener("keyup",function(t){N[t.keyCode]=!1,32===t.keyCode&&(Ft=!0)}),et=new function(a){var i,n=null;"VRFrameData"in T&&(n=new VRFrameData),navigator.getVRDisplays&&navigator.getVRDisplays().then(function(t){0<t.length&&(i=t[0])}),this.update=function(){var t;if(i&&(i.getFrameData?(i.getFrameData(n),t=n.pose):i.getPose&&(t=i.getPose()),t)&&null!==t.orientation){for(var e=0;e<3;++e)t.orientation[e]=Math.min(.2,Math.max(-.2,t.orientation[e]));a.quaternion.fromArray(t.orientation)}},this.resetPose=function(){i&&i.resetPose()}}(w),te(0),function t(){var i,e,a=Lt.getDelta();if(2===R){s=w.position,n=w.rotation,N[32]&&Ft?(Dt=15<s.z?(s.z=Math.max(s.z-.25,15),2):1,n.x<.36&&(n.x=Math.min(n.x+.018,.36))):C!==A.H&&C!==A.g||(Dt=s.z<20?(s.z=Math.min(s.z+.25,20),3):0,0<n.x&&(n.x=Math.max(n.x-.018,0))),s=ct*a/.02,N[32]?(Zt(s,"phi"),Zt(s,"theta")):(N[87]||N[38]?b.phi<M&&(b.phi=Math.min(b.phi+s,M)):N[83]||N[40]?-M<b.phi&&(b.phi=Math.max(b.phi-s,-M)):Zt(s,"phi"),N[65]||N[37]?b.theta<M&&(b.theta=Math.min(b.theta+s,M)):N[68]||N[39]?-M<b.theta&&(b.theta=Math.max(b.theta-s,-M)):Zt(s,"theta")),b.phi&&L.rotateOnWorldAxis(dt,b.phi),b.theta&&L.rotateOnWorldAxis(pt,b.theta);var n=a;switch(C){case A.g:b.phi||b.theta?C=A.D:N[32]&&1===Dt&&(zt.it?(C=A.C,k.l(z)):C=A.L);break;case A.D:b.phi||b.theta||(C=A.g);break;case A.L:N[32]?1<=g.scale.y&&(D.at?(C=A.m,jt.Wt(D.et)):(C=A.k,k.l(B))):C=A.H;break;case A.m:null!=jt.$t&&(C=jt.$t?A.U:A.k,jt.$t)&&k.l(F);break;case A.k:Jt.wt||(C=A.H);break;case A.U:case A.H:g.scale.y<=0&&(C=A.g);break;case A.C:N[32]?1<=O.scale.y&&(C=A.Y):C=A.W;break;case A.Y:zt.vt.wt||(C=A.W);break;case A.W:O.scale.y<=0&&(C=A.g)}I.rotation.x=Nt.x-30*b.phi,I.rotation.z=Nt.z+30*b.theta,gt.paused=C!==A.g,s=x.isRunning(),D.nt?(x.timeScale=.55/(.05+D.et),s||x.play(),r=(x.timeScale-1)/10,k.f(r)):(s&&x.stop(),k.f(0));var o=n;switch(C){case A.L:ae(g,.6,o);break;case A.H:ae(g,.4,o,!0);break;case A.m:ie(St);break;case A.U:ne(St),ae(g,.9,o,!0);break;case A.k:ne(St)}var r,s,l=n;switch(C){case A.C:ae(O,.3,l);break;case A.W:ne(Ot),ae(O,.3,l,!0);break;case A.Y:ie(Ot)}switch(re()&&(r=he(lt,ht,0),xt&&(Rt+=r.distanceTo(xt)),xt=r),re()&&3e3<=(s=Date.now())-It&&(It=s,bt.children.length<9?(e=new y.Object3D,f(),bt.add(e)):(e=bt.children[0],f())),D.ct(),zt.ct(),jt.ct(),Jt.ct(),vt.update(a),Mt.update(a),At.update(a),W){case 1:!J[1]&&Bt.some(t=>N[t])&&(J[1]=1,setTimeout(()=>{E(2)},3e3));break;case 2:D.ut()<10?c():J[2]&&D.nt&&E(3);break;case 3:D.at&&E(4);break;case 4:D.ut()<10?c():D.at||E(3);break;case 5:J[5]&&E(6)}function c(){E(0),setTimeout(()=>{J[4]=1;var t=new y.Spherical;t.setFromVector3(he(lt,ht-.5,-.5)),zt.st(t.phi,t.theta),setTimeout(()=>{E(5)},1e3)},3e3)}}else 1===R?(n=a,I.position.add(I._v.clone().multiplyScalar(n)),ee(I.position,Gt,Wt),w.position.add(w._v.clone().multiplyScalar(n)),ee(w.position,Ht,kt)):3===R&&(s=a,I.position.add(I._v.clone().multiplyScalar(s)),ee(I.position,Wt,_t),L.position.add(L._v.clone().multiplyScalar(s)),ee(L.position,Ut,Vt));for(var h=1e3*a,d=yt.geometry.vertices,p=0;p<d.length;++p){var u=me[p],m=(u.delta+=.002*h,Math.min(.1*Math.sin(u.delta),10.1-9.8-.1));d[p].set(u.x+m,u.y+m,u.z+m)}if(yt.geometry.verticesNeedUpdate=!0,Tt.rotation.x+=2e-5*(i=1e3*a),Tt.rotation.z+=12e-6*i,Tt.children.forEach(function(t,e){t.rotation.y+=2e-4*i,t.rotation.x+=1e-4*i;var a=me[e],a=.8*Math.sin(a.delta/5+e/10)+.2;t.scale.setScalar(a)}),wt.update(a),0!==R&&3!==R&&4!==R||(r=(S.scale.x-1)/.4,r=1+.4*(1<(r+=a/2)?0:r),S.scale.set(r,r,1)),T.rttOn&&(v.setRenderTarget(at),v.clear()),2===R){switch(C){case A.W:case A.H:case A.U:N[32]&&(Ft=!1)}et.update()}function f(){e.position.setFromSphericalCoords(lt,ht,0),L.worldToLocal(e.position),e._t=Date.now()}w.layers.set(2),v.render(Q,w),w.layers.set(0),v.render(Q,w),T.rttOn&&(v.setRenderTarget(null),v.clear(),v.render(Z,tt)),v.setAnimationLoop(t)}(),o("x").innerHTML="PRESS ENTER"</script>