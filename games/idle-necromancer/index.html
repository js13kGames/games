<!doctype html><title>Idle Necromancer - js13kGames 2022</title><meta name=viewport content="user-scalable=no,maximum-scale=1,minimum-scale=1,width=device-width"><meta name=monetization content=$ilp.uphold.com/RHmgAHYJnaYP><style>body{background-color:#000}canvas{position:absolute;top:0;left:0;image-rendering:pixelated;background-color:#000}#fixedContainter{position:absolute;z-index:-10;width:100%;height:100%;top:0;left:0}</style><body scroll=no style=overflow:hidden id=body><div id=fixedContainter><canvas id=canvas></canvas></div><script>localStorage;var e,t={},o=[],a=[],l=[],r=null,d={Touch:!1,MoneCoil:!1,CoilNum:0,CoilCard:!1,Blood:null,AppVersion:"1.0.0",Mobile:0,MobileWork:!1,VX:[50,20],VY:[25,10],LXY:[0,0],RestartCounter:0,RestartCounter2:0,RestartCounter_2:0,RestartCounter2_2:0,FullHarvest:!1,AutoPlay:!1,AutoC:0,AutoCard:0,RundC:0,Rune:0,Blocade:!1,Moves:0,Power:0,AcumulatedPower:1,SoulPower:0,CardCreated:0,CardsOnBoard:0,CardsSacrificed:0,CardsMerge:0,MaxBuiltUp:0,Restarts:0,Harvests:0,Loaded:!1,WindowMove:null,Cell:null,Width:0,Height:0,PxW:0,PxH:0,TouchX:0,TouchY:0,DiffY:0,DiffX:0,AddCards:[null,null],MouseONCardCounter:[0,null],Cost:{0:5,1:100,2:600},CostMulti:{0:{0:[0,10,5],1:[11,18,100],2:[19,20,25e4],3:[21,25,55e6],4:[26,1e5,15e7]},1:{0:[0,5,50],1:[6,10,1500],2:[11,15,25e5],3:[16,20,135e6],4:[21,1e5,25e8]}},Ranks:{0:[1,0],1:[1,0],2:[1,0]},Rank2Cards:{lenght:5,0:[!0,0],1:[!1,3],2:[!1,5],3:[!1,4],4:[!1,6]},NomCost:{0:0,1:0},SpecCost:{0:0,1:600,2:125e4,3:8e7,4:66666666666666},DemonEye:{PX:0,PY:0}},n={0:{Size:17,Spec:"normal",Color:"red",LWidth:2,SColor:"red",LineJoin:"round",SPY:0},1:{Size:20,Spec:"bold",Color:"white"},100:{Size:20,Spec:"bold",Color:"red"},2:{Size:11,Enter:15,Spec:"normal",Color:"white"},3:{Size:16,Spec:"normal",Color:"white",LWidth:8,SColor:"black",LineJoin:"round",SPY:0},4:{Size:30,Spec:"normal",Color:"white"},400:{Size:30,Spec:"bold",Color:"red"},5:{Size:30,Spec:"bold",Color:"white"},6:{Size:20,Enter:40,Spec:"normal",Color:"white"},7:{Size:14,Spec:"normal",Color:"white",LWidth:1,SColor:"white",LineJoin:"round",SPY:0},700:{Size:14,Spec:"bold",Color:"red"},7e3:{Size:10,Spec:"bold",Color:"red"},7e4:{Size:8,Spec:"bold",Color:"red"},8:{Size:20,Spec:"normal",Color:"white"},9:{Size:45,Spec:"normal",Color:"white"},10:{Size:25,Spec:"bold",Color:"white"},11:{Size:35,Spec:"bold",Color:"red"},12:{Size:30,Spec:"bold",Color:"red"},Ver:{Size:15,Spec:"normal",Color:"white"},13:{Size:17,Spec:"bold",Color:"black",LWidth:1,SColor:"black",LineJoin:"round",SPY:0}},s={P0:{0:[3,6,0],1:[7,9,1],2:[10,13,2],3:[14,500,3]},P1:{0:[3,6,0],1:[7,10,1],2:[11,14,2],3:[15,500,3]}},u={Colors:"ffff000f000fff00fff0f",Colors_Hero:"ffff00fff0000007ff1cf",0:{StarPatern:2,Skill:"*",NumberS:"",SkillSpec:0,Rang:3,Name:"NECROMANCER",Spec:0,PX:14,PY:55,M:6,S:19,F:"@PRRRRRR@@@RRZ[RRB@@PR[[[[R@@@Z[kmm]B@@X]kRRR]@@@U[RRRRE@@PjSRRRR@@@RZSRRRB@@PR[RRRR@@@RjSRRRB@@PRZSRRR@@@RR]RRRB@@PRR[RRR@@@RRjSRRB@@PRRZSRR@@@RRR]RRB@@PRRR[RR@@@RRRZSRB@@PRRR]RR@@",Text:[["Harvest - adds death energy when you"],["right click a card, the amount of added"],["energy depends on the built up energy"],["from cards. Revives all cards and saves game."],["Necromancer can shatter the card."]]},1:{StarPatern:1,Skill:"*",NumberS:2,Rang:1,Name:"MOVING GRAVE",Spec:1,PX:33,PY:57,M:5,S:15,F:"@@@HHH@@@@@AAAA@@IHIII@@HIIII@@@HIIIA@@@HIIA@@@@HIA@@@@HIA@@@@@II@@@@@II@@@@@HIA@@@@@IIA@@@BHIA@@@RJIJ@R@RRRRQRR@",Text:[["Death Energy Multiplier - multiplies the energy"],["of the cards in range, < + > on the frames"],[" indicates the direction of energy multiplication,"],["it can be merged with a twin card"],["(same level and card name)."]]},2:{StarPatern:0,Skill:"+",NumberS:1,Rang:0,Name:"BONES",Spec:2,PX:33,PY:55,M:5,S:15,F:"@@@@@@@@@HA@IHA@@IAHII@@II@HI@HIA@@IA@IA@AHI@@I@IAIA@@@IAIIA@@IAHAI@@@A@@@@@H@@A@@@HIIIAA@@IIIIHA@@A@H@HA@@@@@@@@",Text:[["Death Energy Transfer - adds energy to"],["the cards in range, < + > on the frames"],["indicates the transfer direction of energy,"],["it can be merged with a twin card"],["(same level and card name)."]]},Rank:{0:{0:{Name:"SKELETON",PX:33,PY:55,M:5,S:15,F:"@@@@@@@@@@HI@@@@@@JB@@@@@HI@@@@@@H@@@@@HHIH@@@HHHHH@@@AIHAA@@HHHHH@@@AHI@A@@@H@H@@@@@A@A@@@@H@H@@@@@A@A@@@@I@HA@@"},1:{Name:"CORPSES",PX:33,PY:55,M:5,S:15,F:"@@@@@@@@HJHI@@@@III@@@@HJIIIA@@@HIA@@@@@AHI@@@@H@@AIAIB@@@PQHI@I@@IAJIA@@@A@HIA@HIA@IIIAHI@AHA@@IAH@HI@IA@@@@@HI@"},2:{Name:"UNDEADS",PX:33,PY:55,M:5,S:15,F:"@@@@@@@@@@HA@@@@@HJA@@@@@HI@IA@IHIAPQHAHHA@IA@AHI@@A@@IAIHIH@@IAAIIA@@HIHAI@@HI@HI@@@AI@AA@@I@IHH@@HAHAAA@HA@HIH@"},3:{Name:"DEAD ARMY",PX:33,PY:55,M:5,S:15,F:"@@@IA@@@@@PQHI@HI@IAJB@JB@@HI@HI@@@@@@@@IA@IA@@PQ@PQ@IAIA@IAPQ@@@@A@IA@@AIA@A@@AAAAIAAHHAIAAAAAAAIAIHH@IAAAAA@A@A"}},1:{0:{Name:"TOMB",PX:33,PY:55,M:5,S:15,F:"@@@@@@@@@@@B@@@@@@RB@@@@@@B@@@@@@IA@@@@@IIA@@@@IIIA@@@IIIIA@@IRRRJA@IB@@@JAHB@@@@J@B@@B@@BP@@JB@P@B@JIB@BP@PIQ@P@"},1:{Name:"GRAVEYARD",PX:33,PY:55,M:5,S:15,F:"@@@@@@@@@@@@@@@@B@@@@B@RB@B@RB@B@RB@B@P@@B@P@@@BP@B@@@RB@RB@@@B@@B@@@P@BP@@@B@RB@B@RB@B@RB@B@P@@B@P@@@@P@@@@@@@@@"},2:{Name:"BLACK CHURCH",PX:33,PY:55,M:5,S:15,F:"@@@P@@@@@@@B@@@@@@RB@@@@@@B@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@A@@@@@@H@@@@@@PR@@@@@PRR@@@@PRRR@@@PRRRR@@"},3:{Name:"DEAD CASTLE",PX:33,PY:55,M:5,S:15,F:"@@A@@A@@@AIHAA@@HHHHH@@@AAAAA@@H@@@H@@@A@B@A@@HIIII@@@@@P@@@@@@@B@@@@@@R@@@@@@RB@@@@@RB@@@@@PRR@@@@@PRR@@@@@PRB@@"}}},3:{Eye:{PX:53,PY:85,M:5,S:7,F:"@RB@RRBRBRRRPRRBRBRRB@RB@"},DAdd:!0,StarPatern:2,Skill:"*",NumberS:"",Rang:3,Name:"%#$%@@#$",Spec:0,SkillSpec:1,PX:34,PY:66,M:5,S:15,F:"@PRRRR@@P@@@@P@P@@@@@PP@@@@@@PB@@@@@@R@@@@@@PB@@@@@@R@@@@@@PB@@@@@@R@@@@@@PB@@@@@@R@@@@@@PP@@@@@P@P@@@@P@@PRRRR@@",Text:[["Service - the demon watches and memorizes the"],["used cards, he does not have a good memory"],["so moving the card or go to sleep clears his memory."],["The demon must see the full harvest to repeat it"],["(eye twitches when he is ready to serve)."]]},4:{BloodStains:{M:8,S:8,length:6,0:{PX:-1,PY:-1,F:"RRRRRRRRRRRBRR@@RB@@R@@@@R@@PR@@",Star:0},1:{PX:35,PY:56,F:"@@@@@@@@@R@@@RB@@PR@@PR@@@@@@@@@",Star:null},2:{PX:-1,PY:137,F:"@@@@@@PB@@RRB@PRRB@BRB@@RRR@RRRB",Star:2},3:{PX:78,PY:137,F:"@@B@@RRP@RRR@PRR@@RR@PRRPRRR@RRR",Star:7},4:{PX:43,PY:76,F:"@@@@@@P@@PR@@RR@@RR@@PB@@@@@@@@@",Star:null},5:{PX:78,PY:-1,F:"RRR@@RRR@PRR@RRR@PRR@@PR@@@B@@@@",Star:5}},StarPatern:3,Skill:"*",NumberS:"",DAdd:!0,Rang:3,Name:"DEAD SINNER",SkillSpec:4,Spec:0,PX:40,PY:70,M:5,S:15,F:"@@@@@@@@@@@@IA@@@AHHI@@@IIIIA@@IIII@@@IIIII@@@AHIII@@@HIIIA@@HIIAI@@HIIIHA@IIHI@H@HI@IA@@@HAHI@@@@@HI@@@@@@I@@@@@",Text:[["Splash - the sinner's body fills with blood"],["every harvest, using the card splashes blood"],["on cards in < + > direction. A card covered in"],["blood gives 2x death energy. Splashing"],["again cleans the previous cards."]]},5:{StarPatern:2,Skill:"*",NumberS:"",SkillSpec:3,DAdd:!0,Spec:0,Rang:3,Name:["DEAD RUNS"],Runs_0:[["%%%#%#$&"],["&#$%$%#&"],["@*%%#%%&"],["&%$%$#$&"],["&#$%$%#&"],["&#$%#$%#$"]],Runs_1:[["@&&$%#$%%"],["&%$#%#$&"],["&#$%#$%#&"],["@&$%#$&%&"],["&#$$@#$#$"],["&%&#$%&#"]],Runs_2:[["&%@#$%#%"],["&#$%#$%#$"],["&$%%$$%&#"],["&$%$%#$&"],["&%$&#&#$"],["&%&#$%&#"]],PX:22,PY:65,Text:[["Dead Field - dead runes allow the"],["necromancer to handle a larger harvest"],["field, card works passively."]]},6:{Fire:{N:[0,1,3,5,5],0:[69,69],1:[34,89],2:[104,89],3:[33,130],4:[104,130]},StarPatern:2,Skill:"*",NumberS:"",DAdd:!0,Rang:3,Name:"BLOOD RITUAL",SkillSpec:5,Spec:0,PX:34,PY:78,M:5,S:15,F:"@@@H@@@@@@@A@@@@@@P@@@@@@PP@@@A@@BB@@I@@B@B@HRRRRRRRBBB@@@BB@R@@@PB@@RB@RB@@B@RB@B@P@RPBP@QPB@@RPIR@@@@PJB@@@@@@B",Text:[["Sacrifice - after all candles are lit, a ritual"],["is held that sacrifices all cards except"],["the necromancer. Each sacrificed level of a card"],["adds soul energy, build up energy is multiplied"],["by soul energy at each harvest."]]}},P={XY:[7,4],PX:685,PY:114,List:[],List_2:[],Unlock:[1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1]},S={0:{length:4,0:{Rang:0,Width:550,Height:117,MouseOn:!1,Clicked:!1,PX:71,PY:753},1:{Rang:1,Width:266,Height:117,MouseOn:!1,Clicked:!1,PX:71,PY:898},2:{Rang:2,Width:266,Height:117,MouseOn:!1,Clicked:!1,PX:355,PY:898},3:{Width:90,Height:90,MouseOn:!1,Clicked:!1,PX:15,PY:15}},1:{length:5,0:{Rang:0,Width:266,Height:117,MouseOn:!1,Clicked:!1,PX:71,PY:753},1:{Rang:1,Width:266,Height:117,MouseOn:!1,Clicked:!1,PX:355,PY:753},2:{Rang:2,Width:266,Height:117,MouseOn:!1,Clicked:!1,PX:355,PY:898},3:{Width:90,Height:90,MouseOn:!1,Clicked:!1,PX:15,PY:15},4:{Width:266,Height:117,MouseOn:!1,Clicked:!1,PX:71,PY:898}}},C={0:{length:4,0:{0:[0,0,1,0,0,0,0,1],1:[1,0,0,0,0,1,0,0],2:[1,0,1,0,0,0,0,0],3:[0,0,0,0,0,1,0,1]},1:{0:[0,0,1,0,1,0,0,1],1:[1,0,0,1,0,1,0,0],2:[1,1,1,0,0,0,0,0],3:[0,0,0,0,0,1,1,1]},2:{0:[1,0,1,0,1,1,0,1],1:[1,0,1,1,0,1,0,1],2:[1,1,1,0,0,1,0,1],3:[1,0,1,0,0,1,1,1]},3:{0:[1,1,1,0,1,1,1,1],1:[1,1,1,1,0,1,1,1],2:[1,1,1,1,1,1,0,1],3:[1,0,1,1,1,1,1,1]},4:{0:[1,1,1,1,1,1,1,1],1:[1,1,1,1,1,1,1,1],2:[1,1,1,1,1,1,1,1],3:[1,1,1,1,1,1,1,1]}},1:{length:4,0:{0:[0,0,0,1,0,0,0,0],1:[0,1,0,0,0,0,0,0],2:[0,0,0,0,1,0,0,0],3:[0,0,0,0,0,0,1,0]},1:{0:[0,0,0,1,0,0,1,0],1:[0,1,0,0,0,0,1,0],2:[0,1,0,0,1,0,0,0],3:[0,1,0,0,0,0,1,0]},2:{0:[0,1,0,1,0,0,1,0],1:[0,1,0,1,0,0,1,0],2:[0,1,0,0,1,0,1,0],3:[0,1,0,0,1,0,1,0]},3:{0:[0,1,0,1,1,0,1,0],1:[0,1,0,1,1,0,1,0],2:[0,1,0,1,1,0,1,0],3:[0,1,0,1,1,0,1,0]},4:{0:[0,1,1,1,1,0,1,1],1:[1,1,0,1,1,1,1,0],2:[1,1,0,1,1,0,1,1],3:[0,1,1,1,1,1,1,0]}},2:{length:1,0:{0:[1,1,1,1,1,1,1,1]}},3:{length:1,0:{0:[1,0,1,0,0,1,0,1]}}},c=window.innerWidth,h=window.innerHeight,R=window.devicePixelRatio||1,f=document.getElementById("canvas"),M=f.getContext("2d");function A(){c=window.innerWidth;var e=(h=window.innerHeight)*(R=window.devicePixelRatio||1),o=c*R;if(f.width=c*R,f.height=h*R,f.style.width=c+"px",f.style.height=h+"px",Math.floor(h/(c+h)*100)>36)for(;36!=Math.floor(h/(c+h)*100);)h=Math.round((c+h)/100*36);if(Math.floor(c/(c+h)*100)>64)for(;64!=Math.floor(c/(c+h)*100);)c=Math.round((c+h)/100*64);d.PxW=c*R/1920,d.PxH=h*R/1080,d.DiffY=(e-h*R)/2,d.DiffX=(o-c*R)/2,d.Width=1920*d.PxW,d.Height=1080*d.PxH,y()}function m(e,t,a,l,r){d.CardsOnBoard++;for(var n=[],i=0;i<P.List.length;i++)null==P.List[i].CardIn&&P.List[i].Unlock&&n.push(i);var s=n[Math.floor(Math.random()*n.length)],S=!1,c=0;0==e?s=10:d.CardCreated++,null!=a&&(s=a),c=Math.floor(Math.random()*C[u[e].StarPatern].length),null!=l&&(c=l);var h=C[u[e].StarPatern][0][c],R={Card_Num:e,TN:0,Blood:[],BloodL:0,Merged:!1,Restart:!1,Level:1,Data:u[e],Draw:!1,Function:null,PX:P.List[s].PX+13.5,PY:P.List[s].PY+13.5,Cell:s,Skill:u[e].Skill,NumberS:u[e].NumberS,AddedNumber:u[e].NumberS,SkillText:u[e].Skill+u[e].NumberS,Shadow:0,Counter:0,UseCounter:0,Scale:1,ScaleM:.85,ScaleAdd:0,PX_2:0,PY_2:0,PX_2_M:0,PY_2_M:0,MadeCounter:200,Start_Stars_Patern:u[e].StarPatern,PaternNum:c,StarsTab:h,Stars:{0:" ",1:" ",2:" ",3:" ",4:" ",5:" ",6:" ",7:" "},BloodStars:{0:" ",1:" ",2:" ",3:" ",4:" ",5:" ",6:" ",7:" "}};for(i=0;i<h.length;i++)h[i]&&(R.Stars[i]="+");if(o.length>1)for(i=0;i<o.length;i++)null==o[i]&&(S=!0,c=i);if(i=0,S?(o[c]=JSON.parse(JSON.stringify(R)),i=c):(o.push(JSON.parse(JSON.stringify(R))),i=o.length-1),P.List[s].CardIn=i,o[i].TN=i,o[i].Function=function(){!function(e){if(M.save(),0==e.Shadow&&e.Draw&&(e.Shadow=1,e.Counter=5,e.ScaleAdd=(e.ScaleM-1)/5),e.Counter>0&&1==e.Shadow&&(e.Scale+=e.ScaleAdd,e.PX_2+=2.5,e.PY_2+=3,e.Counter--),e.Counter>0&&2==e.Shadow&&(e.Scale-=e.ScaleAdd,e.PX_2-=e.PX_2_M,e.PY_2-=e.PY_2_M,e.Counter--,e.Counter<=0&&(e.Shadow=0,e.Scale=1,e.PX_2=0,e.PY_2=0,e.PX=P.List[e.Cell].PX+13.5,e.PY=P.List[e.Cell].PY+13.5)),M.translate((e.PX_2+e.PX)*d.PxW,(e.PY_2+e.PY)*d.PxH),e.MadeCounter>0){if(M.translate(Math.floor(Math.random()*(e.MadeCounter/12)-e.MadeCounter/25)*d.PxW,Math.floor(Math.random()*(e.MadeCounter/12)-e.MadeCounter/25)*d.PxH),e.MadeCounter>9)for(var o=0;o<d.VX[d.Mobile];o++)M.save(),M.beginPath(),M.rect(Math.floor(140*Math.random())*d.PxW,(207-e.MadeCounter+Math.floor(5*Math.random()))*d.PxH,4*d.PxW,4*d.PxH),1==Math.floor(2*Math.random())?M.fillStyle="white":M.fillStyle="black",M.fill(),M.closePath(),M.restore();M.rect(-5*d.PxW,-5*d.PxH,150*d.PxW,(210-e.MadeCounter)*d.PxH),M.clip(),e.MadeCounter-=9,e.MadeCounter<=0&&(e.MadeCounter=0)}e.UseCounter>0&&(M.translate(Math.floor(5*Math.random()-2.5)*d.PxW,Math.floor(5*Math.random()-2.5)*d.PxH),e.UseCounter--,e.UseCounter<=0&&(e.ShadowUse=!1,e.Restart||3==e.Data.Rang?(e.Used=!1,e.Restart=!1):e.Used=!0)),e.Shadow>0&&M.scale(e.Scale,e.Scale),I(e),M.restore()}(o[i])},null!=r&&r>1){o[i].Level=r,o[i].NumberS=u[e].NumberS;for(var f=0;f<o[i].Level-1;f++)o[i].NumberS+=o[i].NumberS;o[i].AddedNumber=o[i].NumberS,o[i].SkillText=o[i].Skill+o[i].NumberS}if(t&&o[i].Data.Rang<3&&o[i].Level!=d.Ranks[o[i].Data.Rang][0]){for(o[i].Level=d.Ranks[o[i].Data.Rang][0],o[i].NumberS=u[e].NumberS,f=0;f<o[i].Level-1;f++)o[i].NumberS+=o[i].NumberS;o[i].AddedNumber=o[i].NumberS,o[i].SkillText=o[i].Skill+o[i].NumberS}4==o[i].Data.SkillSpec&&function(e){for(var o=0;o<u[4].BloodStains.length;o++)e.Blood.push({StarN:null,M:u[4].BloodStains.M,S:u[4].BloodStains.S,PX:u[4].BloodStains[o].PX,PY:u[4].BloodStains[o].PY,F:u[4].BloodStains[o].F}),null!=u[4].BloodStains[o].Star&&"+"==e.Stars[u[4].BloodStains[o].Star]&&(e.BloodStars[u[4].BloodStains[o].Star]="+",e.Blood[e.Blood.length-1].StarN=u[4].BloodStains[o].Star),e.BloodL++}(o[i]),N(o[i])}function I(e){if(M.save(),M.beginPath(),M.strokeStyle="White",M.lineWidth=2*d.PxW,M.rect(0,0,140*d.PxW,200*d.PxH),M.fillStyle="Black",e.Draw?(M.beginPath(),M.shadowColor="white",M.shadowBlur=10,M.shadowOffsetX=0,M.shadowOffsetY=0,M.strokeStyle="white",M.rect(0,0,140*d.PxW,200*d.PxH),M.stroke(),M.closePath()):e.MouseON&&D(1,"red",-2,-2,144,204),e.ShadowUse&&(Y(1,"red",-2,-2,144,204,"red"),"*"==e.SkillText&&1==e.Data.SkillSpec&&(W(e.Data.Eye,!0,100),W(e.Data,!0,100))),M.fill(),M.stroke(),M.closePath(),M.restore(),e.ShadowUse?(X([e.Stars[0]+"     "+e.Stars[3]+"     "+e.Stars[5]],13,70,18),X([e.Stars[1]+"           "+e.Stars[6]],13,70,100),X([e.Stars[2]+"     "+e.Stars[4]+"     "+e.Stars[7]],13,70,192)):(X([e.Stars[0]+"     "+e.Stars[3]+"     "+e.Stars[5]],0,70,18),X([e.Stars[1]+"           "+e.Stars[6]],0,70,100),X([e.Stars[2]+"     "+e.Stars[4]+"     "+e.Stars[7]],0,70,192)),M.save(),M.beginPath(),X([e.Data.Name],2,71,45),"*"==e.SkillText)if(0==e.Data.SkillSpec)Y(5,"red",31,55,80,114,"red"),W(e.Data,!0,e.Data.SkillSpec);else if(1==e.Data.SkillSpec)e.ShadowUse||(M.save(),M.translate(0,3*d.PxH),W(e.Data,!0,101),M.restore(),M.save(),d.AutoPlay?(M.save(),M.translate(.8*l[d.AutoCard].Mpx*d.PxW,.8*l[d.AutoCard].Mpy*d.PxH),W(e.Data.Eye,!0,101),M.restore(),M.translate(l[d.AutoCard].Mpx*d.PxW,l[d.AutoCard].Mpy*d.PxH)):(B(e),M.save(),M.translate(.8*d.DemonEye.PX*d.PxW,.8*d.DemonEye.PY*d.PxH),W(e.Data.Eye,!0,101),M.restore(),M.translate(d.DemonEye.PX*d.PxW,d.DemonEye.PY*d.PxH)),W(e.Data.Eye,!0,e.Data.SkillSpec),M.restore(),M.save(),(d.AutoPlay||d.FullHarvest)&&M.translate(Math.floor(4*Math.random())*d.PxW-2,Math.floor(4*Math.random())*d.PxH-2),W(e.Data,!0,e.Data.SkillSpec),M.restore());else if(3==e.Data.SkillSpec)X(e.Data["Runs_"+d.Rune],2,71,70),d.RundC<=0?(d.RundC=2,d.Rune=Math.floor(3*Math.random())):d.RundC--;else if(5==e.Data.SkillSpec){W(e.Data,!0,e.Data.SkillSpec),M.save();for(var o=0;o<e.Data.Fire.N[d.RestartCounter_2];o++)for(var t=0;t<10;t++)M.save(),M.beginPath(),M.rect((e.Data.Fire[o][0]+Math.floor(4*Math.random()))*d.PxW,(e.Data.Fire[o][1]+Math.floor(7*Math.random()))*d.PxH,2*d.PxW,2*d.PxH),M.fillStyle="red",M.fill(),M.closePath(),M.restore();M.restore()}else e.Data.F&&W(e.Data,!0,e.Data.SkillSpec);else W(e.Data),e.Merged?e.SkillText.length<7?X([e.SkillText],100,70,160):e.SkillText.length<12?X([e.SkillText],700,70,160):e.SkillText.length<15?X([e.SkillText],7e3,70,160):X([e.SkillText],7e4,70,160):e.SkillText.length<7?X([e.SkillText],1,70,160):X([e.SkillText],7,70,160),X([L(e.Level)],3,70,5);M.save(),M.beginPath(),M.strokeStyle="White",M.lineWidth=1*d.PxW;for(var a=0;a<e.Data.Rang+1;a++)M.rect((28-3*a)*d.PxW,(28-3*a)*d.PxH,(86+6*a)*d.PxW,(144+6*a)*d.PxH);if(M.stroke(),M.closePath(),M.restore(),M.closePath(),M.restore(),e.BloodL>0){for(t=0;t<e.BloodL;t++)W(e.Blood[t],!1);X([e.BloodStars[0]+"     "+e.BloodStars[3]+"     "+e.BloodStars[5]],13,70,18),X([e.BloodStars[1]+"           "+e.BloodStars[6]],13,70,100),X([e.BloodStars[2]+"     "+e.BloodStars[4]+"     "+e.BloodStars[7]],13,70,192)}e.Used&&(M.save(),M.beginPath(),M.globalAlpha=.6,Y(1,"Black",-12,-12,164,224,"Black"),M.closePath(),M.restore())}function g(e){if((d.CardsOnBoard!=P.List.length||!d.Rank2Cards[2][0])&&(d.CardsOnBoard!=P.List.length-8||d.Rank2Cards[2][0])){var o=[2,1,0];if(T(),d.Power>=d.Cost[e])if(o[e]>0)d.NomCost[e]++,m(o[e],!0),d.Power-=d.Cost[e],v();else for(var t=0;t<d.Rank2Cards.lenght;t++)if(!d.Rank2Cards[t][0]){if(m(d.Rank2Cards[t][1]),d.Power-=d.Cost[e],d.Ranks[2][0]++,d.CoilCard&&2==t&&d.Ranks[2][0]++,2==t)for(var a=0;a<P.List.length;a++)P.List[a].Unlock=!0;return d.Rank2Cards[t][0]=!0,void v()}}}function N(e){if(e.Data.Rang<3)for(var o=0;o<4;o++)if(s["P"+e.Data.Rang][o][0]<=e.Level&&s["P"+e.Data.Rang][o][1]>=e.Level){var d=u.Rank[e.Data.Rang][s["P"+e.Data.Rang][o][2]];e.Data.Name=d.Name,e.Data.F=d.F,e.Data.PX=d.PX,e.Data.PY=d.PY,e.Data.M=d.M,e.Data.S=d.S;var t=C[e.Start_Stars_Patern][s["P"+e.Data.Rang][o][2]+1][e.PaternNum];for(e.StarsTab=t,o=0;o<t.length;o++)t[o]?e.Stars[o]="+":e.Stars[o]=" "}}function v(){for(var e=0;e<5;e++)d.NomCost[0]>=d.CostMulti[0][e][0]&&d.NomCost[0]<=d.CostMulti[0][e][1]&&(d.Cost[0]=d.CostMulti[0][e][2]*(d.NomCost[0]+1));for(e=0;e<5;e++)d.NomCost[1]>=d.CostMulti[1][e][0]&&d.NomCost[1]<=d.CostMulti[1][e][1]&&(d.Cost[1]=d.CostMulti[1][e][2]*(d.NomCost[1]+1));d.Ranks[2][0]>1&&(d.Cost[2]=d.SpecCost[d.Ranks[2][0]])}function H(e,t,l){d.CardsOnBoard--,function(e,t,l){for(var r=!0,n=0,i=0;i<a.length;i++)null==a[i]&&(a[i]=o[e],r=!1,n=i,i=a.length);r&&(a.push(o[e]),n=a.length-1),a[n].Function=function(){!function(e){if(e.MadeCounter<=0)e.MadeCounter=0;else{e.MadeCounter-=15,M.save(),M.translate(e.PX*d.PxW,e.PY*d.PxH),M.save(),M.beginPath(),Y(1,"black",0,0,140,-20,"black"),M.closePath(),M.restore(),e.DesAnim-=.01,M.globalAlpha=e.DesAnim;for(var o=0;o<d.VY[d.Mobile];o++)M.save(),M.beginPath(),M.rect(Math.floor(140*Math.random())*d.PxW,(7+e.MadeCounter+Math.floor(15*Math.random()))*d.PxH,4*d.PxW,4*d.PxH),1==e.DesType?1==Math.floor(2*Math.random())?M.fillStyle="white":M.fillStyle="black":M.fillStyle="red",M.fill(),M.closePath(),M.restore();M.rect(-5*d.PxW,-5*d.PxH,150*d.PxW,(10+e.MadeCounter)*d.PxH),M.clip(),1!=e.DesType&&M.translate(Math.floor(5*Math.random()-2.5)*d.PxW,Math.floor(5*Math.random()-2.5)*d.PxH),I(e),M.restore()}}(a[n])},a[n].MadeCounter=200,a[n].DesType=t,a[n].DesAnim=1,0!=t&&(a[n].PX=d.LXY[0],a[n].PY=d.LXY[1]),null!=l&&(a[n].PX=o[l].PX,a[n].PY=o[l].PY)}(e,t,l),P.List[o[e].Cell].CardIn=null,o[e]=null,k()}function B(e){for(var o=0;o<10;o++)d.TouchX/d.PxW>d.DiffX+e.PX+70+50*o?d.DemonEye.PX=o:d.TouchX/d.PxW<=d.DiffX+e.PX+100-50*o&&(d.DemonEye.PX=-o),d.TouchY/d.PxH>d.DiffY+e.PY+100+50*o?d.DemonEye.PY=o:d.TouchY/d.PxH<=d.DiffY+e.PY+100-50*o&&(d.DemonEye.PY=-o)}function b(e){if(e.UseCounter<=0){switch(e.Data.Spec){case 0:switch(e.Data.SkillSpec){case 0:var t;d.Blocade=!1,d.Harvests++,t=d.SoulPower>0?d.AcumulatedPower*d.SoulPower:d.AcumulatedPower,d.Power+=t,t>d.MaxBuiltUp&&(d.MaxBuiltUp=t),d.AcumulatedPower=1;for(var a=0;a<o.length;a++)null==o[a]||o[a].Data.Name==e.Data.Name||o[a].Data.DAdd||(o[a].UseCounter=10,o[a].Restart=!0,o[a].Merged=!1,o[a].AddedNumber=o[a].NumberS,o[a].SkillText=o[a].Skill+o[a].NumberS);!d.AutoPlay&&d.Rank2Cards[1][0]&&(d.FullHarvest=!0),null!=d.Blood&&(o[d.Blood].BloodL=6,d.Blood=null),function(){localStorage.setItem("CFG_IdleN_S",!0);for(var e=0,t=0;t<o.length;t++)null!=o[t]&&(localStorage.setItem("CFG_IdleN_Card_Num_"+e,o[t].Card_Num),localStorage.setItem("CFG_IdleN_Cell_"+e,o[t].Cell),localStorage.setItem("CFG_IdleN_Level_"+e,o[t].Level),localStorage.setItem("CFG_IdleN_PaternNum_"+e,o[t].PaternNum),o[t].Blood.length>0?localStorage.setItem("CFG_IdleN_Blood_"+e,!0):localStorage.setItem("CFG_IdleN_Blood_"+e,!1),e++);for(t=0;t<2;t++)localStorage.setItem("CFG_IdleN_Ranks_0_"+t,d.Ranks[t][0]),localStorage.setItem("CFG_IdleN_Ranks_1_"+t,d.Ranks[t][1]);for(t=0;t<2;t++)localStorage.setItem("CFG_IdleN_NomCost_"+t,d.NomCost[t]);for(t=0;t<d.Rank2Cards.lenght;t++)localStorage.setItem("CFG_IdleN_R2C_"+t,d.Rank2Cards[t][0]);localStorage.setItem("CFG_IdleN_CLlen",e),localStorage.setItem("CFG_IdleN_S",!0),localStorage.setItem("CFG_IdleN_Power",d.Power),localStorage.setItem("CFG_IdleN_SoulPower",d.SoulPower),localStorage.setItem("CFG_IdleN_CardCreated",d.CardCreated),localStorage.setItem("CFG_IdleN_CardsSacrificed",d.CardsSacrificed),localStorage.setItem("CFG_IdleN_CardsMerge",d.CardsMerge),localStorage.setItem("CFG_IdleN_MaxBuiltUp",d.MaxBuiltUp),localStorage.setItem("CFG_IdleN_Restarts",d.Restarts),localStorage.setItem("CFG_IdleN_Harvests",d.Harvests)}();break;case 1:!d.AutoPlay&&d.FullHarvest?d.AutoPlay=!0:d.AutoPlay=!1,d.AutoCard=0,d.AutoC=8;break;case 4:if(null==d.Blood){for(var r=[[0,1,1,0,0,0,1],[1,0,1,0,0,0,2],[0,0,0,1,0,1,1],[0,0,0,0,1,1,2],[0,1,0,1,0,0,2],[1,0,0,0,0,1,2],[0,0,1,0,1,0,2]],n=0;n<o.length;n++)null!=o[n]&&o[n].BloodL>0&&(e.TN!=n&&(o[n].Blood=[]),o[n].BloodL=0,o[n].BloodStars={0:" ",1:" ",2:" ",3:" ",4:" ",5:" ",6:" ",7:" "});e.BloodL=6;var i=w(e,3);if(i.length>0)for(let d=0;d<i.length;d++){var s=Math.floor(7*Math.random());for(let t=0;t<6;t++)r[s][t]&&(o[i[d]].Blood.push(e.Blood[t]),o[i[d]].BloodL++,null!=e.Blood[t].StarN&&"+"==o[i[d]].Stars[e.Blood[t].StarN]&&(o[i[d]].BloodStars[e.Blood[t].StarN]="+"))}for(let o=0;o<e.BloodL;o++)null!=e.Blood[o].StarN&&"+"==e.Stars[e.Blood[o].StarN]&&(e.BloodStars[e.Blood[o].StarN]="+");e.BloodL=0,d.Blood=e.TN}break;case 5:d.RestartCounter_2++,d.RestartCounter2_2=80,d.RestartCounter_2>3&&(x(!0),d.RestartCounter_2=0)}break;case 1:w(e,1);break;case 2:w(e,2)}if(d.Mobile)for(a=0;a<o.length;a++)null!=o[a]&&1==o[a].Data.SkillSpec&&B(o[a]);d.AutoPlay||!d.Rank2Cards[1][0]||1==e.Data.SkillSpec||e.Data.DAdd||l.push({Mpx:d.DemonEye.PX,Mpy:d.DemonEye.PY,Card:e.TN}),e.SkillText=e.Skill+e.NumberS,e.ShadowUse=!0,e.UseCounter=20}}function w(e,t){if(3==t)var a=[];for(var l=-1,r=0;l<2;l++)for(var n=-1;n<2;n++)if(0!=l||0!=n){if(P.List[e.Cell].Y+n>-1&&P.List[e.Cell].X+l>-1&&P.List[e.Cell].Y+n<P.XY[1]&&P.List[e.Cell].X+l<P.XY[0]){var i=P.List[P.List_2[P.List[e.Cell].Y+n][P.List[e.Cell].X+l]].CardIn;null==i||1!=e.StarsTab[r]||(o[i].Used||!(o[i].UseCounter<=0))&&"NECROMANCER"!=o[i].Data.Name||o[i].Data.DAdd||(1==t&&("NECROMANCER"==o[i].Data.Name?e.Blood.length>0?d.AcumulatedPower*=2*e.AddedNumber:d.AcumulatedPower*=e.AddedNumber:(e.Blood.length>0?o[i].AddedNumber*=2*e.AddedNumber:o[i].AddedNumber*=e.AddedNumber,o[i].SkillText=o[i].Skill+o[i].AddedNumber)),2==t&&("NECROMANCER"==o[i].Data.Name?e.Blood.length>0?d.AcumulatedPower+=2*e.AddedNumber:d.AcumulatedPower+=e.AddedNumber:(e.Blood.length>0?o[i].AddedNumber+=2*e.AddedNumber:o[i].AddedNumber+=e.AddedNumber,o[i].SkillText=o[i].Skill+o[i].AddedNumber)),3==t&&"NECROMANCER"!=o[i].Data.Name&&a.push(i),3==t||(o[i].Merged=!0))}r++}if(3==t)return a;e.Merged=!1,d.Blocade=!0}function _(){null!=d.WindowMove&&(o[d.WindowMove].PX=P.List[o[d.WindowMove].Cell].PX+13.5,o[d.WindowMove].PY=P.List[o[d.WindowMove].Cell].PY+13.5,o[d.WindowMove].Draw=!1,o[d.WindowMove].Shadow=0,o[d.WindowMove].Counter=0,o[d.WindowMove].Scale=1,o[d.WindowMove].PX_2=0,o[d.WindowMove].PY_2=0,d.WindowMove=null,d.Cell=null),d.AddCards=[null,null]}function k(){l=[],d.AutoCard=0,d.FullHarvest=!1,d.AutoPlay=!1}function x(e){if(e){for(var t=d.SoulPower-5,a=0;a<o.length;a++)null!=o[a]&&(o[a].Start_Stars_Patern<2?t+=o[a].Level:t+=5,d.CardsSacrificed++);d.CardsSacrificed--;var l=d.CardCreated,n=d.CardsSacrificed,i=d.CardsMerge,s=d.MaxBuiltUp,u=d.Restarts,M=d.Harvests}for(d=JSON.parse(JSON.stringify(r)),(navigator.userAgent.match(/mobile/i)||navigator.userAgent.match(/iPad|Android|Touch/i))&&(d.Mobile=1),a=0;a<o.length;a++)null!=o[a]&&H(a,0);for(m(0),a=0;a<P.List.length;a++)P.Unlock[a]?P.List[a].Unlock=!1:P.List[a].Unlock=!0;d.CardsOnBoard=1,k(),T(),A(),v(),e?(d.CardCreated=l,d.CardsSacrificed=n,d.CardsMerge=i,d.MaxBuiltUp=s,d.Harvests=M,d.Restarts=u+1,d.SoulPower+=t):d.SoulPower=0}function W(e,o,t){M.save(),M.beginPath(),M.translate(e.PX*d.PxW,e.PY*d.PxH);var a=[];for(e.F.replace(/./g,(e=>{z=e.charCodeAt(),a.push(7&z),a.push(z>>3&7)})),j=0;j<e.S;j++)for(i=0;i<e.S;i++)a[j*e.S+i]&&(M.save(),o?0==t||2==t?(M.translate(Math.floor(2*Math.random())*d.PxW,Math.floor(2*Math.random())*d.PxH),M.fillStyle="#"+u.Colors_Hero.substr(3*(a[j*e.S+i]-1),3)):M.fillStyle=1==t?"#"+u.Colors.substr(3*(a[j*e.S+i]-1),3):100==t?"Black":101==t?"White":"#"+u.Colors.substr(3*(a[j*e.S+i]-1),3):M.fillStyle="#"+u.Colors.substr(3*(a[j*e.S+i]-1),3),M.fillRect((i*e.M-.5)*d.PxW,(j*e.M-.5)*d.PxH,(e.M+1)*d.PxW,(e.M+1)*d.PxH),M.restore());M.closePath(),M.restore()}function D(e,o,t,a,l,r){M.beginPath(),M.lineWidth=e*d.PxW,M.strokeStyle=o,M.rect(t*d.PxW,a*d.PxH,l*d.PxW,r*d.PxH),M.stroke(),M.closePath()}function Y(e,o,t,a,l,r,n){M.strokeStyle=o,M.lineWidth=e*d.PxW,M.rect(t*d.PxW,a*d.PxH,l*d.PxW,r*d.PxH),M.fillStyle=n,M.stroke(),M.fill()}function X(e,o,t,a){for(var l=n[o],r=0;r<e.length;r++){if(M.save(),r>0)var i=a+l.Enter*r;else i=a;M.font=l.Spec+" "+l.Size*d.PxW+"px Courier New",M.textAlign="center",l.SColor&&(M.lineWidth=l.LWidth*d.PxW,M.strokeStyle=l.SColor,M.lineJoin=l.LineJoin,M.strokeText(e[r],t*d.PxW,(i+l.SPY)*d.PxH)),M.fillStyle=l.Color,M.fillText(e[r],t*d.PxW,i*d.PxH),M.restore()}}function p(e){X(["Ability"],10,340,470),X(e,6,340,510)}function L(e){var o={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1},d="";for(var t of Object.keys(o)){var a=Math.floor(e/o[t]);e-=a*o[t],d+=t.repeat(a)}return d}function T(){O(),!d.CoilCard&&d.MoneCoil&&(d.CoilNum=1,d.Rank2Cards[3][0]=!0,m(d.Rank2Cards[3][1]),d.CoilCard=!0),localStorage.setItem("CFG_IdleN_CoilCard",d.CoilCard)}function F(){E(),M.closePath(),M.restore(),t.UpdateScreen=requestAnimationFrame(F)}function y(){E(),X(["Click on the Screen to Continue the Game"],3,960,1050),M.closePath(),M.restore()}function E(){M.clearRect(0,0,f.width,f.height),M.save(),M.beginPath(),d.RestartCounter>0&&(0==d.RestartCounter2?d.RestartCounter=0:d.RestartCounter2--),d.RestartCounter_2>0&&(0==d.RestartCounter2_2?(d.RestartCounter_2--,d.RestartCounter2_2=80):d.RestartCounter2_2--),M.translate(d.DiffX,d.DiffY),M.rect(0,0,d.Width,d.Height),M.clip(),M.save(),Y(1,"Black",0,0,1920,1080,"Black"),D(2,"White",0,0,1920,1080),D(2,"White",5,5,1910,1070),M.restore(),function(){for(var e=0;e<P.List.length;e++){var t=P.List[e];M.save(),M.translate(t.PX*d.PxW,t.PY*d.PxH),e==d.AddCards[2]&&"NECROMANCER"==d.AddCards[0]&&(M.beginPath(),D(2,"white",0,0,168,228),M.fillStyle="red",M.fill(),D(8,"black",0,0,168,228),M.closePath()),M.beginPath(),e==d.Cell&&(M.globalAlpha=.55,M.strokeStyle="White"),e==d.AddCards[2]&&(M.strokeStyle="Red"),M.lineWidth=2*d.PxW,(e==d.Cell||e==d.AddCards[2])&&M.rect(0,0,168*d.PxW,228*d.PxH),M.stroke(),M.closePath(),M.restore(),M.save(),M.translate(t.PX*d.PxW,t.PY*d.PxH),M.beginPath(),e==d.Cell?M.globalAlpha=.3:M.globalAlpha=.1,P.List[e].Unlock||(M.globalAlpha=.04),D(2,"White",13,13,142,202),M.fillStyle="White",M.fill(),M.closePath(),M.globalAlpha=.4,P.List[e].Unlock&&X(["+"],4,85,120),M.restore()}d.AutoPlay&&(d.AutoC<=0?(o[l[d.AutoCard].Card].Used||b(o[l[d.AutoCard].Card]),d.AutoCard++,d.AutoCard>l.length-1&&(d.AutoCard=0),d.AutoC=10):d.AutoC--)}(),X(["DEATH ENERGY"],5,1272,55),X([d.Power],5,1272,95),null!=d.WindowMove?p(o[d.WindowMove].Data.Text):null!=d.MouseONCard&&(d.MouseONCardCounter[0]<=0?p(o[d.MouseONCard].Data.Text):d.MouseONCardCounter[0]--),X(["BUILT UP ENERGY"],8,998,59),1==d.AcumulatedPower?d.SoulPower>0?X([d.AcumulatedPower*d.SoulPower],8,998,90):X([d.AcumulatedPower],8,998,90):d.SoulPower>0?X([d.AcumulatedPower*d.SoulPower],100,998,90):X([d.AcumulatedPower],100,998,90),X(["SOUL ENERGY"],8,1547,59),X([d.SoulPower],8,1547,90),X(["IDLE NECROMANCER"],9,340,70),X(["MAX Built Up"],8,190,160),X([d.MaxBuiltUp],8,190,190),X(["Summoned Cards"],8,190,260),X([d.CardCreated],8,190,290),X(["Sacrificed Cards"],8,490,160),X([d.CardsSacrificed],8,490,190),X(["Merge Cards"],8,490,260),X([d.CardsMerge],8,490,290),X(["Blood Rituals"],8,190,360),X([d.Restarts],8,190,390),X(["Harvests"],8,490,360),X([d.Harvests],8,490,390),X([d.AppVersion],"Ver",50,1050),d.Blocade&&0==d.Moves&&(M.save(),D(3,"Red",684,113,1178,914),M.restore(),M.save(),D(1,"Red",680,109,1186,922),M.restore()),function(){for(var e=0;e<S[d.Mobile].length;e++)M.save(),M.translate(S[d.Mobile][e].PX*d.PxW,S[d.Mobile][e].PY*d.PxH),M.beginPath(),M.strokeStyle="white",M.lineWidth=2*d.PxW,M.rect(0,0,S[d.Mobile][e].Width*d.PxW,S[d.Mobile][e].Height*d.PxH),M.fillStyle="Black",M.fill(),3!=e&&S[d.Mobile][e].MouseOn&&D(2,"red",-4,-4,8+S[d.Mobile][e].Width,8+S[d.Mobile][e].Height),S[d.Mobile][e].Clicked&&D(2,"red",0,0,S[d.Mobile][e].Width,S[d.Mobile][e].Height),3!=e&&M.stroke(),M.closePath(),4==e&&(d.MobileWork?(D(4,"red",5,5,S[d.Mobile][e].Width-10,S[d.Mobile][e].Height-10),X(["USE CARDS"],12,S[d.Mobile][e].Width/2,65)):X(["MOVE CARDS"],4,S[d.Mobile][e].Width/2,63)),e<3&&(d.Cost[e]?(X(["RANK "+L(S[d.Mobile][e].Rang+1)+" CARD"],8,S[d.Mobile][e].Width/2,40),d.Cost[e]<=d.Power?X([d.Cost[e]],4,S[d.Mobile][e].Width/2,80):X([d.Cost[e]],400,S[d.Mobile][e].Width/2,80)):X(["MAX"],4,S[d.Mobile][e].Width/2,63)),e<3?X(2==e?[L(d.Ranks[e][0]+d.CoilNum)]:[L(d.Ranks[e][0])],3,S[d.Mobile][e].Width/2,5):d.RestartCounter>0&&3==e&&X(["!"+d.RestartCounter+"!"],11,S[d.Mobile][e].Width/2,50),M.restore()}();for(var e=0;e<o.length;e++)null==o[e]||o[e].Draw||o[e].Function();for(e=0;e<a.length;e++)null!=a[e]&&(a[e].Function(),a[e].MadeCounter<=0&&(a[e]=null));null!=d.WindowMove&&o[d.WindowMove].Function()}function O(){document.MoneCoil&&!d.MoneCoil&&document.MoneCoil.addEventListener("MoneCoilstart",(()=>{d.MoneCoil=!0}))}function U(){_(),d.AutoPlay||(cancelAnimationFrame(t.UpdateScreen),y())}function G(){cancelAnimationFrame(t.UpdateScreen),t.UpdateScreen=requestAnimationFrame(F)}function $(){Q(2),null!=d.WindowMove&&(d.LXY[0]=o[d.WindowMove].PX,d.LXY[1]=o[d.WindowMove].PY,o[d.WindowMove].Draw=!1,o[d.WindowMove].Shadow=2,o[d.WindowMove].Counter=5,null!=d.Cell?(P.List[o[d.WindowMove].Cell].CardIn=null,o[d.WindowMove].PX_2_M=(o[d.WindowMove].PX-P.List[d.Cell].PX+13.5)/o[d.WindowMove].Counter,o[d.WindowMove].PY_2_M=(o[d.WindowMove].PY-P.List[d.Cell].PY+13.5)/o[d.WindowMove].Counter,o[d.WindowMove].Cell=d.Cell,P.List[o[d.WindowMove].Cell].CardIn=d.WindowMove,d.WindowMove=null,k()):(o[d.WindowMove].PX=P.List[o[d.WindowMove].Cell].PX+13.5,o[d.WindowMove].PY=P.List[o[d.WindowMove].Cell].PY+13.5,o[d.WindowMove].PX_2_M=2.5,o[d.WindowMove].PY_2_M=3,d.WindowMove=null)),null==d.AddCards[0]||d.Blocade||0==o[d.AddCards[1]].Data.Spec||function(){if("NECROMANCER"==d.AddCards[0])return"*"==o[d.AddCards[1]].Skill?d.AcumulatedPower*=o[d.AddCards[1]].AddedNumber:"+"==o[d.AddCards[1]].Skill&&(d.AcumulatedPower+=o[d.AddCards[1]].AddedNumber),v(),void H(d.AddCards[1],2);d.CardsMerge++,o[d.AddCards[0]].Level++,o[d.AddCards[0]].NumberS+=o[d.AddCards[1]].AddedNumber,o[d.AddCards[0]].AddedNumber=o[d.AddCards[0]].NumberS,o[d.AddCards[0]].SkillText=o[d.AddCards[0]].Skill+o[d.AddCards[0]].NumberS,d.Ranks[o[d.AddCards[0]].Data.Rang][0]+2==o[d.AddCards[0]].Level&&(d.Ranks[o[d.AddCards[0]].Data.Rang][1]++,d.Ranks[o[d.AddCards[0]].Data.Rang][1]>2&&(d.Ranks[o[d.AddCards[0]].Data.Rang][0]++,d.Ranks[o[d.AddCards[0]].Data.Rang][1]=0)),N(o[d.AddCards[0]]),H(d.AddCards[1],1,d.AddCards[0]),_(),k()}(),d.Cell=null,d.AddCards=[null,null],q(2);for(var e=0;e<S[d.Mobile].length;e++)S[d.Mobile][e].Clicked=!1,d.Mobile&&(S[d.Mobile][e].MouseOn=!1)}function J(e,o){0==e.button&&o||!d.MobileWork&&!o?((!d.Blocade||d.Moves>0)&&q(1),Q(1),null!=d.WindowMove&&Z()):(d.Mobile&&Q(1),q(0),_())}function V(e){if(d.AddCards=[null,null],q(2),null!=d.WindowMove){var t=o[d.WindowMove];d.TouchX>d.DiffX&&d.TouchY>d.DiffY&&d.TouchX<d.DiffX+d.Width&&d.TouchY<d.DiffY+d.Height?(t.PX=(d.TouchX-d.DiffX)/d.PxW-t.MPX,t.PY=(d.TouchY-d.DiffY)/d.PxH-t.MPY,d.Cell=null,Z()):_()}null==d.WindowMove&&Q(0)}function Q(e){if(!d.AutoPlay)for(var o=0;o<S[d.Mobile].length;o++)d.TouchX>d.DiffX+S[d.Mobile][o].PX*d.PxW&&d.TouchY>d.DiffY+S[d.Mobile][o].PY*d.PxH&&d.TouchX<d.DiffX+S[d.Mobile][o].PX*d.PxW+S[d.Mobile][o].Width*d.PxW&&d.TouchY<d.DiffY+S[d.Mobile][o].PY*d.PxH+S[d.Mobile][o].Height*d.PxH?((0==e||d.Mobile)&&(S[d.Mobile][o].MouseOn=!0),1==e&&(S[d.Mobile][o].Clicked=!0),2==e&&S[d.Mobile][o].Clicked&&(o<3?g(o):4==o?d.Blocade||(d.MobileWork?d.MobileWork=!1:d.MobileWork=!0):(d.RestartCounter++,d.RestartCounter2=50,d.RestartCounter>3&&(x(),d.RestartCounter=0)))):(S[d.Mobile][o].MouseOn=!1,S[d.Mobile][o].Clicked=!1)}function Z(){for(var e=0;e<P.List.length;e++)P.List[e].Unlock&&d.TouchX>d.DiffX+P.List[e].PX*d.PxW&&d.TouchY>d.DiffY+P.List[e].PY*d.PxH&&d.TouchX<d.DiffX+P.List[e].PX*d.PxW+168*d.PxW&&d.TouchY<d.DiffY+P.List[e].PY*d.PxH+228*d.PxH&&(null==P.List[e].CardIn||e==o[d.WindowMove].Cell?d.Cell=e:o[P.List[e].CardIn].Data.Name!=o[d.WindowMove].Data.Name||o[P.List[e].CardIn].Level!=o[d.WindowMove].Level||o[P.List[e].CardIn].Used||o[P.List[e].CardIn].Merged||o[d.WindowMove].Merged?"NECROMANCER"==o[P.List[e].CardIn].Data.Name&&0!=o[d.WindowMove].Data.Spec&&(d.AddCards=[o[P.List[e].CardIn].Data.Name,d.WindowMove,e]):d.AddCards=[P.List[e].CardIn,d.WindowMove,e])}function q(e){for(var t=!1,a=0;a<o.length;a++)if(null!=o[a]&&(o[a].MouseON=!1,d.TouchX>d.DiffX+o[a].PX*d.PxW&&d.TouchY>d.DiffY+o[a].PY*d.PxH&&d.TouchX<d.DiffX+o[a].PX*d.PxW+140*d.PxW&&d.TouchY<d.DiffY+o[a].PY*d.PxH+200*d.PxH&&(t=!0,null==d.WindowMove)))if(0!=e||o[a].Used||3==o[a].Data.SkillSpec)if(1!=e||o[a].Used||d.Blocade&&!(d.Moves>0)||d.AutoPlay)2==e&&(o[a].MouseON=!0,d.MouseONCard=a,d.MouseONCardCounter[1]!=a&&(d.MouseONCardCounter[0]=6,d.MouseONCardCounter[1]=a));else{d.WindowMove=a;var l=o[a];l.Draw=!0,l.MPX=Math.abs(l.PX-(d.TouchX-d.DiffX)/d.PxW),l.MPY=Math.abs(l.PY-(d.TouchY-d.DiffY)/d.PxH)}else 1!=o[a].Data.SkillSpec&&d.AutoPlay||b(o[a]);if(t||(d.MouseONCard=null),d.Mobile&&2==e)for(a=0;a<o.length;a++)null!=o[a]&&(o[a].MouseON=!1,d.MouseONCard=null)}f.width=c*R,f.height=h*R,f.style.width=c+"px",f.style.height=h+"px",window.addEventListener("load",(function(){r=JSON.parse(JSON.stringify(d)),A(),function(){for(var e=0;e<P.XY[1];e++){P.List_2.push([]);for(var t=0;t<P.XY[0];t++)P.List.push({X:t,Y:e,PX:P.PX+168*t,PY:P.PY+228*e,CardIn:null,Unlock:!1}),P.Unlock[P.List.length-1]||(P.List[P.List.length-1].Unlock=!0),P.List_2[e].push(P.XY[0]*e+t)}!function(){if("true"==localStorage.getItem("CFG_IdleN_S")){var e=null;d.Loaded=!0;for(var t=0;t<Number(localStorage.getItem("CFG_IdleN_CLlen"));t++){if(m(Number(localStorage.getItem("CFG_IdleN_Card_Num_"+t)),!1,Number(localStorage.getItem("CFG_IdleN_Cell_"+t)),Number(localStorage.getItem("CFG_IdleN_PaternNum_"+t)),Number(localStorage.getItem("CFG_IdleN_Level_"+t))),5==Number(localStorage.getItem("CFG_IdleN_Card_Num_"+t)))for(var a=0;a<P.List.length;a++)P.List[a].Unlock=!0;4==Number(localStorage.getItem("CFG_IdleN_Card_Num_"+t))&&(e=o[t]),null!=o[t].Data.SkillSpec&&0!=Number(localStorage.getItem("CFG_IdleN_Card_Num_"+t))&&d.Ranks[2][0]++}if(null!=e){var l=[[0,1,1,0,0,0,1],[1,0,1,0,0,0,2],[0,0,0,1,0,1,1],[0,0,0,0,1,1,2],[0,1,0,1,0,0,2],[1,0,0,0,0,1,2],[0,0,1,0,1,0,2]];for(t=0;t<o.length;t++)if("true"==localStorage.getItem("CFG_IdleN_Blood_"+t)&&4!=Number(localStorage.getItem("CFG_IdleN_Card_Num_"+t))){var r=Math.floor(7*Math.random());for(let d=0;d<6;d++)l[r][d]&&(o[t].Blood.push(e.Blood[d]),o[t].BloodL++,null!=e.Blood[d].StarN&&"+"==o[t].Stars[e.Blood[d].StarN]&&(o[t].BloodStars[e.Blood[d].StarN]="+"))}}for(d.Power=Number(localStorage.getItem("CFG_IdleN_Power")),d.SoulPower=Number(localStorage.getItem("CFG_IdleN_SoulPower")),d.CardCreated=Number(localStorage.getItem("CFG_IdleN_CardCreated")),d.CardsSacrificed=Number(localStorage.getItem("CFG_IdleN_CardsSacrificed")),d.CardsMerge=Number(localStorage.getItem("CFG_IdleN_CardsMerge")),d.MaxBuiltUp=Number(localStorage.getItem("CFG_IdleN_MaxBuiltUp")),d.Restarts=Number(localStorage.getItem("CFG_IdleN_Restarts")),d.Harvests=Number(localStorage.getItem("CFG_IdleN_Harvests")),"true"==localStorage.getItem("CFG_IdleN_CoilCard")?d.CoilCard=!0:d.CoilCard=!1,t=0;t<2;t++)d.Ranks[t][0]=Number(localStorage.getItem("CFG_IdleN_Ranks_0_"+t)),d.Ranks[t][1]=Number(localStorage.getItem("CFG_IdleN_Ranks_1_"+t));for(t=0;t<2;t++)d.NomCost[t]=Number(localStorage.getItem("CFG_IdleN_NomCost_"+t));for(t=0;t<d.Rank2Cards.lenght;t++)"true"==localStorage.getItem("CFG_IdleN_R2C_"+t)?d.Rank2Cards[t][0]=!0:d.Rank2Cards[t][0]=!1;v()}else d.Loaded||(m(0),T())}()}(),t.UpdateScreen=requestAnimationFrame(F),navigator.userAgent.match(/mobile/i)||navigator.userAgent.match(/iPad|Android|Touch/i)?(d.Mobile=1,window.addEventListener("touchmove",(function(e){e.preventDefault(),1==e.targetTouches.length&&(d.TouchX=e.targetTouches[0].pageX*R,d.TouchY=e.targetTouches[0].pageY*R,V())}),{passive:!1}),window.addEventListener("touchstart",(function(e){1==e.targetTouches.length&&(d.TouchX=e.targetTouches[0].pageX*R,d.TouchY=e.targetTouches[0].pageY*R,J(e,!1))}),!1),window.addEventListener("touchend",(function(e){0==e.targetTouches.length&&$()}),!1)):(window.oncontextmenu=function(e){return!1},window.addEventListener("mousemove",(function(e){d.TouchX=e.clientX*R,d.TouchY=e.clientY*R,V()}),!1),window.addEventListener("mousedown",(function(e){d.TouchX=e.clientX*R,d.TouchY=e.clientY*R,J(e,!0)}),!1),window.addEventListener("mouseup",(function(e){$()}),!1)),window.addEventListener("blur",U),window.addEventListener("focus",G),O()})),window.addEventListener("resize",(function(o){clearTimeout(e),e=setTimeout(A,500)}))</script>