<!doctype html><title>Nine Lives Later - Déjà Meow - js13kGames 2025</title><style>body,html{background:#666;height:100%;margin:0}canvas#c{background:linear-gradient(#e68e35 0,#dd517e 100%);margin:auto;display:block}#crt{display:inline-block;position:relative}#crt:after{content:"";pointer-events:none;opacity:.95;background:repeating-linear-gradient(0deg,#0000001f 0 1px,#0000 1px 3px),radial-gradient(120% 80%,#ffffff0f 0 35%,#0000 60%),radial-gradient(120% 90%,#0000 65%,#00000059 85%);animation:6s steps(60,end) infinite crtFlicker;position:absolute;inset:0}#ov{opacity:.3;background:0 0;display:block;position:absolute;inset:0}@keyframes crtFlicker{50%{opacity:.98}}</style><meta name=viewport content="width=device-width,initial-scale=1"><body style=place-items:center;height:100vh;margin:0;display:grid><div id=crt><canvas id=c width=640 height=400></canvas><canvas id=ov width=640 height=400></canvas></div><script>let e,t,n,o,i,s,a,l,r,d,c,h,f;const u=function(){let e=document.createElement("canvas");e.width=640,e.height=400;let t=e.getContext("2d"),n=t.createLinearGradient(0,0,40,0);n.addColorStop(0,"rgba(0,0,0,0.5)"),n.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=n,t.fillRect(0,0,40,400),(n=t.createLinearGradient(640,0,600,0)).addColorStop(0,"rgba(0,0,0,0.5)"),n.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=n,t.fillRect(600,0,40,400),(n=t.createLinearGradient(0,0,0,40)).addColorStop(0,"rgba(0,0,0,0.5)"),n.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=n,t.fillRect(0,0,640,40),(n=t.createLinearGradient(0,400,0,360)).addColorStop(0,"rgba(0,0,0,0.5)"),n.addColorStop(1,"rgba(0,0,0,0)"),t.fillStyle=n,t.fillRect(0,360,640,40),t.beginPath(),t.strokeStyle="#00000012";for(let e=0;e<=640;e+=40)t.moveTo(e,0),t.lineTo(e,400);for(let e=0;e<=400;e+=40)t.moveTo(0,e),t.lineTo(640,e);return t.stroke(),e}(),y=(e,t)=>!e.hi&&!t.hi&&w(e,t)&&e.m&t.c&&t.m&e.c,w=(e,t)=>!e.hi&&!t.hi&&!(e.x+e.w<t.x||e.x>t.x+t.w||e.y+e.h<t.y||e.y>t.y+t.h),x=(e,t)=>{let n=e.x+e.w/2,o=e.y+e.h/2,i=t.x+t.w/2,s=t.y+t.h/2,a=n-i,l=(e.w+t.w)/2-Math.abs(a),r=o-s,d=(e.h+t.h)/2-Math.abs(r);l<d?(e.x+=a<0?-l:l,e.dx=-e.dx):(e.y+=r<0?-d:d,e.dy=-e.dy),e.justB=!0,e.justBDT=0},m=(e,t,n)=>(e.save(),e.shadowBlur=5,e.shadowColor="rgba(0,0,0,.7)",e.fillText(t,n.x+n.w/2,n.y+n.h/2),e.restore()),p=(e,t,n)=>({x:e,y:t,w:20,h:20,t:"e",e:"m",dx:.5>Math.random()?1.5:-1.5,dy:.5>Math.random()?1.5:-1.5,c:2,m:15,...n}),g=(e,t,n,o,i)=>({x:e,y:t,w:n,h:o,t:"w",c:8,m:7,...i}),v=(e,t,n,o,i)=>({x:e,y:t,w:n,h:o,t:"x",c:16,m:1,...i}),S=(e,t)=>({x:e,y:t,w:20,h:20,t:"e",e:"d",dx:.5>Math.random()?1:-1,dy:.5>Math.random()?1:-1,c:2,m:79}),b=(e,t,n,o,i,s)=>({x:e,y:t,w:n,h:o,t:"d",d:i,c:64,m:7,...s}),L=(e,t,n,o,i,s)=>({x:e,y:t,h:o,w:n,te:i,t:"et",...s,c:256}),T=(e,t,n,o,i)=>({x:e,y:t,w:n,h:o,mv:i,t:"x",a:1,c:16,m:1}),R=(e,t,n,o,i,s,a,l)=>({x:e,y:t,w:n,h:o,t:"n",a:0,tdx:i,tdy:s,tx:a,...l}),M=(e,t,n,o,i)=>({x:e,y:t,w:n,h:o,t:"bw",c:8,m:7,...i}),C=e=>`stefor.js13k2025.cat.${e}`,I=e=>(console.log("ls load",C(e)),localStorage.getItem(C(e))),k=(e,t)=>{localStorage.setItem(C(e),t)},D=e=>JSON.parse(I(e)),E=(e,t)=>{k(e,JSON.stringify(t))};var B=function(){var e,t,n,o,i,s=function(e){return Math.sin(6.283184*e)},a=function(e){return.003959503758*2**((e-128)/12)},l=function(e,t,n){var o,i,s,l,d,c,h=r[e.i[0]],f=e.i[1],u=e.i[3]/32,y=r[e.i[4]],w=e.i[5],x=e.i[8]/32,m=e.i[9],p=e.i[10]*e.i[10]*4,g=e.i[11]*e.i[11]*4,v=e.i[12]*e.i[12]*4,S=1/v,b=-e.i[13]/16,L=e.i[14],T=n*2**(2-e.i[15]),R=new Int32Array(p+g+v),M=0,C=0;for(o=0,i=0;o<p+g+v;o++,i++)i>=0&&(i-=T,d=a(t+(15&(L=L>>8|(255&L)<<4))+e.i[2]-128),c=a(t+(15&L)+e.i[6]-128)*(1+8e-4*e.i[7])),s=1,o<p?s=o/p:o>=p+g&&(s=(1-(s=(o-p-g)*S))*3**(b*s)),l=h(M+=d*s**u)*f,l+=y(C+=c*s**x)*w,m&&(l+=(2*Math.random()-1)*m),R[o]=80*l*s|0;return R},r=[s,function(e){return e%1<.5?1:-1},function(e){return e%1*2-1},function(e){var t=e%1*4;return t<2?t-1:3-t}];this.init=function(s){e=s,t=s.endPattern,n=0,i=new Int32Array(o=s.rowLen*s.patternLen*(t+1)*2)},this.generate=function(){var a,d,c,h,f,u,y,w,x,m,p,g,v,S,b=new Int32Array(o),L=e.songData[n],T=e.rowLen,R=e.patternLen,M=0,C=0,I=!1,k=[];for(c=0;c<=t;++c)for(h=0,y=L.p[c];h<R;++h){var D=y?L.c[y-1].f[h]:0;D&&(L.i[D-1]=L.c[y-1].f[h+R]||0,D<17&&(k=[]));var E=r[L.i[16]],B=L.i[17]/512,P=2**(L.i[18]-9)/T,A=L.i[19],$=L.i[20],j=135.82764118168*L.i[21]/44100,W=1-L.i[22]/255,O=1e-5*L.i[23],U=L.i[24]/32,F=L.i[25]/512,N=6.283184*2**(L.i[26]-9)/T,G=L.i[27]/255,J=L.i[28]*T&-2;for(f=0,p=(c*R+h)*T;f<4;++f)if(u=y?L.c[y-1].n[h+f*R]:0){k[u]||(k[u]=l(L,u,T));var Y=k[u];for(d=0,a=2*p;d<Y.length;d++,a+=2)b[a]+=Y[d]}for(d=0;d<T;d++)(m=b[w=2*(p+d)])||I?(g=j,A&&(g*=E(P*w)*B+.5),M+=(g=1.5*Math.sin(g))*C,C+=g*(v=W*(m-C)-M),m=3==$?C:1==$?v:M,O&&(m=((m*=O)<1?m>-1?s(.25*m):-1:1)/O),I=(m*=U)*m>1e-5,S=m*(1-(x=Math.sin(N*w)*F+.5)),m*=x):S=0,w>=J&&(S+=b[w-J+1]*G,m+=b[w-J]*G),b[w]=0|S,b[w+1]=0|m,i[w]+=0|S,i[w+1]+=0|m}return++n/e.numChannels},this.createAudioBuffer=function(e){for(var t=e.createBuffer(2,o/2,44100),n=0;n<2;n++)for(var s=t.getChannelData(n),a=n;a<o;a+=2)s[a>>1]=i[a]/65536;return t},this.createWave=function(){var e=44+2*o-8,t=e-36,n=new Uint8Array(44+2*o);n.set([82,73,70,70,255&e,e>>8&255,e>>16&255,e>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&t,t>>8&255,t>>16&255,t>>24&255]);for(var s=0,a=44;s<o;++s){var l=i[s];l=l<-32767?-32767:l>32767?32767:l,n[a++]=255&l,n[a++]=l>>8&255}return n},this.getData=function(e,t){for(var n=2*Math.floor(44100*e),o=Array(t),s=0;s<2*t;s+=1){var a=n+s;o[s]=e>0&&a<i.length?i[a]/32768:0}return o}};const P={songData:[{i:[0,48,128,0,3,75,128,0,0,0,5,9,58,0,0,0,0,195,6,1,2,69,0,0,32,147,6,95,6],p:[1,1,1,1,1,1,,,,,,,,,,,,,,,,,,,1,1,1,1],c:[{n:[138,137,138,135,,,,,138,137,138,,131,,,,138,137,138,135,,,,,138,137,138,137,131,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142,140,142,138],f:[]}]},{i:[0,255,116,79,0,255,116,0,83,0,4,6,69,52,0,0,0,0,0,0,2,14,0,0,32,0,0,0,0],p:[,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[135,,,,135,,,,135,,,,135,,,,135,,,,135,,,,135,,,,135],f:[]}]},{i:[0,91,128,64,0,103,128,0,120,135,4,7,52,85,0,0,0,24,1,1,2,255,0,0,32,61,5,0,6],p:[,,1,1,1,1,1,1,1,1,1,2,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,1],c:[{n:[,,,,135,,,,,,,,135,,,,,,,,135,,,,,,,,135],f:[]},{n:[,,,,135,,,,,,,,135,,,,,,,,135,,,135,,,135,,135,135,135],f:[]}]},{i:[2,84,128,0,1,113,128,0,0,0,0,6,29,0,0,0,0,43,2,1,3,5,23,7,108,79,3,37,6],p:[1,2,1,2,1,2,1,2,1,2,1,2,1,2,3,4,1,2,3,4,1,2,1,2,1,2,1,2],c:[{n:[114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126,114,126],f:[]},{n:[111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123,111,123],f:[]},{n:[107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119,107,119],f:[]},{n:[109,121,109,121,109,121,109,121,109,121,109,121,109,121,109,121,109,121,109,121,109,121,109,121,111,123,111,123,114,126,114,126],f:[]}]},{i:[3,100,128,0,2,201,128,0,0,0,3,32,43,4,0,0,0,92,3,1,2,35,32,0,19,147,6,76,8],p:[,,1,2,1,2,3,4,3,5,3,4,,,,,,,,,3,5,3,4],c:[{n:[,,142,,,,,,,,,,,,142,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142,,,,,,,,138,,,,,,,,,,,,,,,,,,,,,,143,,,,,,,,140],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138,,,,,,,,,,,138,,142,,,,,,,,142,,,138,,,,,,,,,,,,137,,,,,,,,140,,,,,,,,143,,,,,,,,140],f:[]},{n:[,,142,,,,,,,,,,,,142,,,,142,,,,,,,,,,,,,,138,,,143,,,,,,,,,,,,,138,,,143,,,142,,,,,,,,138,,,,,,,,,,,,,,,,,,,,,,143,,,,,,,,140],f:[]},{n:[,,,,,,,,,,,,,,,,,,143,,,,,,,,,,145,,,,143,,142,,,,,142,,,,,,138,,142,,,,,,,,,,,138,,,,,,,,,,,,138,,,,,,,,,,,,,,,,143,,,,,,,,140],f:[]},{n:[,,142,,,,,,,,,,,,138,,,,140,,,,,,,,,,,,,,138,,,143,,,,,,,,,,,,,142,,,142,,,142,,,,,,,,138,,,,,,,,,,,,,,,,,,,,,,143,,,,,,,,140],f:[]}]},{i:[2,100,128,0,3,115,128,0,0,0,5,6,58,0,0,0,0,195,4,1,2,47,0,0,32,147,6,69,6],p:[,,,,,,1,3,1,2,1,3,,,,,,,,,1,2,1,3],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138,,,,,,,,,,,,,,,,,,142,130,138],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142,,,142,143,,138],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,143,,142],f:[]}]},{i:[3,113,128,0,1,136,128,6,0,0,134,119,158,0,0,0,0,0,0,0,2,15,64,0,13,0,0,24,8],p:[,,,,1,2,1,2,1,2,1,2,,,,,1,2,3,4,1,2,1,2],c:[{n:[126,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138],f:[]},{n:[123,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,135,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142],f:[]},{n:[119,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,131],f:[]},{n:[121,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,133],f:[]}]},{i:[0,0,140,0,0,0,140,0,0,39,4,10,47,55,0,0,0,187,5,0,1,239,135,0,32,25,5,16,4],p:[,,,,,,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135,,135],f:[10,,10,,10,,10,,10,,10,,10,,10,,10,,10,,10,,10,,10,,10,,10,,10,,39,,103,,39,,103,,39,,103,,39,,103,,39,,103,,39,,103,,39,,103,,39,,103]}]},{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[,,,,,,,,,,,,1,2,3,4,1,2,3,4],c:[{n:[,,,,142,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,142],f:[]},{n:[,,,,138,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,137,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,135],f:[]},{n:[,,,,138,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,137,,,,,,,,,,,,,,,,,,142,,,,,,,,,,,,,,,,,,138,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,140],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,133,,,,,,,,,,,,,,,,142,,,,,,,,,,,,,,,,,,,,137,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,140],f:[]}]},{i:[0,100,128,0,1,115,128,0,0,0,7,6,58,0,0,0,0,81,2,1,2,60,16,0,21,64,6,69,4],p:[,,,,,,,,,,,,1,2,3,4,1,2,3,4],c:[{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,137,138,,137,,,,138,,,,142],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,135,,,,,,130,131,142,,138,,137],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,138,,,,,,,,142],f:[]},{n:[,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,140,,,,,,140,,,,,,,,,,140,,,,,,143,,,,,,,,138,,,,,,137,,,,,,,,,,,,,,142,,,,,,142],f:[]}]}],rowLen:6125,patternLen:32,endPattern:27,numChannels:10},A={songData:[{i:[3,255,128,0,0,255,140,0,0,127,2,2,47,19,0,0,0,96,3,1,3,94,79,0,32,84,2,12,4],p:[1],c:[{n:[135],f:[]}]}],rowLen:5513,patternLen:3,endPattern:0,numChannels:1},$={songData:[{i:[0,73,107,55,3,57,128,76,36,0,5,51,58,0,55,4,2,195,6,1,1,20,27,0,32,16,2,121,2],p:[1],c:[{n:[162,159,161,155,157,154,150,147,149,145,143,140,142],f:[]}]}],rowLen:5513,patternLen:32,endPattern:0,numChannels:1},j={songData:[{i:[3,255,128,0,0,255,140,0,0,180,2,2,47,61,138,3,0,0,3,1,3,79,79,0,32,84,2,12,4],p:[1],c:[{n:[123],f:[]}]}],rowLen:5513,patternLen:4,endPattern:0,numChannels:1},W={songData:[{i:[3,116,106,64,2,65,106,60,64,0,5,7,71,0,0,0,0,138,9,1,3,62,76,19,56,0,5,25,1],p:[1],c:[{n:[147],f:[]}]}],rowLen:5513,patternLen:4,endPattern:0,numChannels:1},O=document.getElementById("c"),U=O.getContext("2d"),F=document.getElementById("ov"),N=F.getContext("2d"),G=+new URLSearchParams(location.search).get("dpr")||window.devicePixelRatio||1;t={},e={};const J={x:0,y:1},Y="\n    Use left mouse button to shoot hairballs. (... have I already told myself this?)\n    ||Magic pen records for future and past. Use space bar to activate pen mode and draw with mouse. Right mouse to erase. Find and draw the trap to the right.\n    ||Who closed this wall?\n    ||Already looked, nothing to the south\n    ||*Sigh* Told you so...\n    ||Sacrifice to void to get a glimpse into future. For those that comes after.\n    ||You should play blue prince\n    ||Secret south door in room with an H\n    ||Shoot hairball on yourself in potato room\n    ||Trap shapes can form numbers\n    ||Sometimes it's better to die and try again\n    ||Trap shapes can form numbers\n    ||Trap shapes can form numbers\n    ||Thank you for playing. I had more ideas but the jam fell under the song of silk. If you want the game to be over, it's over.\n    ||Send cheese signal by pressing 'g'\n    ||Reach my family grave without spilling any of our blood\n    ||Traps will hide when you leave a room, mark them with pen\n    ".replaceAll("\n","").split("||").map(e=>e.trim()),q=()=>{window.sounds&&window.sounds.playSong(0,.4),e={},t={},n=[],o=(({ov:e,ot:t,cv:n}={})=>{let o=!1,i=window.devicePixelRatio||1,s=-1,a=-1,l=!0;addEventListener("keydown",t=>{"Space"===t.code&&(t.preventDefault(),(o=!o)||function(){let t=document.createElement("canvas"),n=t.getContext("2d");t.width=640,t.height=400,n.setTransform(1,0,0,1,0,0),n.imageSmoothingEnabled=!1,n.drawImage(e,0,0,e.width,e.height,0,0,640,400),k(`${s},${a}`,t.toDataURL("image/png"))}(),e.style.opacity=o?1:.3,n.style.opacity=o?.5:1,document.body.style.cursor="crosshair")}),addEventListener("mousedown",function(e){o&&l&&(r=!0,t.lineWidth=(h=2===e.button)?10*i:3*i,[d,c]=f(e),e.preventDefault())}),addEventListener("mousemove",function(e){if(!r)return;let[n,o]=f(e);h?t.clearRect(n,o,t.lineWidth,t.lineWidth):(t.beginPath(),t.moveTo(d,c),t.lineTo(n,o),t.stroke()),[d,c]=[n,o]}),addEventListener("mouseup",u),addEventListener("mouseleave",u);let r=!1,d=0,c=0,h=!1;function f(t){let n=e.getBoundingClientRect(),o=n.width/640;return[(t.clientX-n.left)/o,(t.clientY-n.top)/o]}function u(){r=!1}return{update:(e,t)=>!!o,load:function(e,n){s=e,a=n,l=!1;let o=I(`${s},${a}`);t.clearRect(0,0,640,400),o?(console.log("found room for",s,a),(async()=>{let e=new Image;e.src=o,await e.decode(),t.drawImage(e,0,0,640,400,0,0,640,400),l=!0})()):(console.log("did not find room for",s,a),l=!0)}}})({ov:F,ot:N,cv:O}),i=(({}={})=>{let e=40,t=200,n=0,o=1,i=0,s=9,a=0,l=0,r={c:0},d=0,c="😺";function h(n){n.beginPath(),n.strokeStyle="#232323",n.moveTo(e+10,t+10),n.lineTo(e+10+24*o,t+10+24*i),n.stroke(),m(n,c,{x:e,y:t,w:20,h:20})}function f(){window.sounds&&window.sounds.sfx(1),s--,l=500,x(a)}let u={s:{x:300,y:40},n:{x:300,y:340},w:{x:590,y:200},e:{x:50,y:200}};function x(n){({x:e,y:t}=u[n]),a=n}let p=0;function g(){r.c>0&&r.c--}return{x:40,y:200,r:10,adx:1,ady:0,updatePlayer:function(s,a,l,c,h){let u=!!a.d-!!a.a,x=!!a.s-!!a.w;if(u||x){let e=Math.hypot(u,x);u/=e,x/=e}let m=e+3*u*(s/16),p=t+3*x*(s/16),g={x:m,y:p,w:20,h:20,c:1,m:510};for(let n of(d>0&&(d=Math.max(0,d-s)),h.collisions))if("n"===n.t){let e=w(g,n);0===n.a&&e?n.a=1:e||1!==n.a||(n.a=0)}else if(y(g,n)){if("x"===n.t)return f(),n.a=1,n;if("d"===n.e&&0===d)return d=2e3,f(),n;if("d"===n.t||"e"===n.t)return n;"c"===n.t&&(r.c++,n.mfd=!0),m=e,p=t}e=m,o=Math.cos(n=Math.atan2(c-(t=p),l-e)),i=Math.sin(n)},drawPlayer:h,getBullet:function(){return{x:e+10+24*o,y:t+10+24*i,dx:5*o,dy:5*i,w:5,h:5,c:4,m:331}},newRoom:x,death:f,dc:function(n,o){if(!l)return!1;c="😿";let i=(l=Math.max(0,l-n))>400?4:l>300?3:l>200?2:+(l>100);return i!==p&&(i%2?h(o):i&&o.clearRect(e,t,20,20),p=i),0===l&&(c="😺"),l},invText:function(){return`🐈‍⬛${s} 🧀${r.c}`},isDead:function(){return s<=0},setRooms:function(e){},canOpen:function(e){if(e.dt){if(r.c<1)return!1;e.dt=!1,g()}return!0},getPosRect:function(){return{x:e,y:t,w:20,h:20,c:1,m:510}},useCheese:g,ic:c}})(),s=0,a=0,l=0,J.x=0,J.y=1,c=0,h={t:0,a:!1,d:0},f={t:0,proph:Y[Math.floor(5*Math.random()+6)]},r=(d=X.map(e=>(({rects:e=[],doors:t="",x:n=0,y:o=0,w:i=640,h:s=400,bw:a=16}={})=>{let l=e.slice(),r=t.toLowerCase();l.push(g(0,0,i,a)),l.push(g(0,0,a,s)),l.push(g(0,s-a,i,a)),l.push(g(i-a,0,i,s)),r.includes("n")&&l.push(b(i-80>>1,0,80,a,"n",{dt:t.includes("N")})),r.includes("s")&&l.push(b(i-80>>1,s-a,80,a,"s",{dt:t.includes("S")})),r.includes("w")&&l.push(b(0,s-80>>1,a,80,"w",{dt:t.includes("W")})),r.includes("e")&&l.push(b(i-a,s-80>>1,a,80,"e",{dt:t.includes("E")}));let d={e:(e,t)=>m(e,"d"===t.e?"🐶":"🐭",t),x:(e,t)=>t.a&&(e.fillStyle="#3337",e.strokeRect(t.x,t.y,t.w,t.h),e.fillRect(t.x,t.y,t.w,t.h),e.fillStyle="#333",e.fillText("☠️",t.x+t.w/2,t.y+t.h/2)),c:(e,t)=>e.fillText("🧀",t.x+t.w/2,t.y+t.h/2),w:(e,t)=>(e.fillStyle=4&t.m?"#333":"rgba(195, 235, 255, 0.9)",e.fillRect(t.x,t.y,t.w,t.h)),d:(e,t)=>(e.globalAlpha=t.alpha??1,e.fillStyle=t.dt?"#b29a39":"#556CC9",e.fillRect(t.x,t.y,t.w,t.h),e.globalAlpha=1,t.dt&&(e.save(),e.font="14px monospace",e.fillText("🧀",t.x+t.w/2,t.y+t.h/2),e.restore())),o:(e,t)=>(e.fillStyle="#6cf",e.fillRect(t.x,t.y,t.w,t.h)),t:(e,t)=>(e.fillStyle="#000000cc",e.fillText(t.m,t.x+t.w/2,t.y+t.h/2)),et:(e,t)=>(e.globalAlpha=t.alpha??1,e.fillStyle="#000",e.fillText(t.te,t.x+t.w/2,t.y+t.h/2),e.globalAlpha=1),n:(e,t)=>{e.fillStyle="#333",e.fillText("📓",t.x+t.w/2,t.y+t.h/2),t.a&&function(e,t,n,o,i){let s=parseInt(e.font)||16;o.split("\n").forEach(o=>{let a=o.split(" "),l="";for(let o=0;o<a.length;o++){let r=l+(l?" ":"")+a[o];e.measureText(r).width>i&&l?(e.fillText(l,t,n),n+=s,l=a[o]):l=r}e.fillText(l,t,n),n+=s})}(e,t.x+t.tdx,t.y+t.tdy,t.tx,t.tdw??250)},bw:(e,t)=>(e.fillStyle="#ffbe7cff",e.fillRect(t.x,t.y,t.w,t.h))};return{collisions:l,update:e=>{for(let t=l.length;t--;){let n=l[t];if(n.dx||n.dy){if(n.tim){n.tim-=e,n.tim<0&&(n.tim=0);continue}let o=n.x+n.dx*(e/16),i=n.y+n.dy*(e/16);for(let s=l.length;s--;)t!==s&&(n.justB&&(n.justBDT+=e),n.justB&&n.justBDT>3e3&&(n.justB=!1),y({x:o,y:i,w:n.w,h:n.h,c:n.c,m:n.m},l[s])?(n.x=o,n.y=i,n.justB||x(n,l[s]),(n.x<10||n.y<10||n.x>630||n.y>390)&&(n.x=30,n.y=30,n.dx=1,n.dy=1)):(n.x=o,n.y=i))}else if(n.mv&&e){n.mv.o=(n.mv.o+e)%(2*n.mv.t);let t=n.mv.o/n.mv.t;t>1&&(t=2-t),n.x=n.mv.x+n.mv.dx*t,n.y=n.mv.y+n.mv.dy*t}n.mfd&&("m"===n.e&&l.push({x:n.x,y:n.y,w:n.w,h:n.h,t:"c",c:128,m:1}),l.splice(t,1))}},draw:e=>{e.drawImage(u,0,0);for(let t=0;t<l.length;t++)l[t].hi||d[l[t].t](e,l[t]);4===n&&0===o&&function(e,t,n,o,i,s){e.save(),e.fillStyle="#000",e.fillRect(15,15,610,200);let a=Math.hypot(610,200)/2,l=.001*s;e.lineWidth=2;for(let t=120;t--;){let n=t/120,o=a*n,i=l+8*n,r=.5*Math.sin(97*t+.01*s);o*=1+.05*r,i+=.6*r,(t+s/50|0)%17!=0&&(e.strokeStyle=t%4?"#E68E35":"#ffffff",e.beginPath(),e.moveTo(320+Math.cos(i)*o,115+Math.sin(i)*o),e.lineTo(320+Math.cos(i+.25)*o*.98,115+Math.sin(i+.25)*o*.98),e.stroke())}e.restore()}(e,0,0,0,0,performance.now())},x:n,y:o}})(JSON.parse(JSON.stringify(e))))).find(e=>e.x===J.x&&e.y===J.y),o.load(J.x,J.y),i.newRoom("e"),i.setRooms(d),E("cc",(D("cc")??0)+1),requestAnimationFrame(V)};function H(){let e=Math.min(innerWidth/640,innerHeight/400),t=(t,n)=>{t.style.width=640*e+"px",t.style.height=400*e+"px",t.width=640*G,t.height=400*G,n.setTransform(G,0,0,G,0,0),n.font="18px monospace",n.textAlign="center",n.textBaseline="middle"};t(O,U),t(F,N),o&&o.load()}const X=[{rects:[R(200,200,20,20,10,-100,Y[0])],doors:"n",x:0,y:1},{rects:[g(210,130,20,140),g(220,250,130,20),g(350,130,20,140,{m:3}),g(210,130,140,20),L(280,160,20,20,"⚫",{m:5,ac:12,as:0}),R(280,220,20,20,140,-25,Y[16])],doors:"we",x:1,y:0},{rects:[p(200,200),S(100,100),S(300,200)],doors:"wE",x:2,y:0},{rects:[v(140,130,20,185),v(290,220,100,50)],doors:"wns",x:3,y:0},{rects:[],doors:"nsew",x:3,y:1},{rects:[g(15,300,500,15),L(18,20,20,20,"🐟",{alpha:.2,hi:1}),v(100,100,15,60),v(100,160,60,15),v(160,100,15,120)],doors:"ne",x:3,y:2},{rects:[L(200,100,20,20,"⚫",{m:5,ac:3,as:0}),L(300,100,20,20,"⚫",{m:5,ac:4,as:0}),L(400,100,20,20,"⚫",{m:5,ac:5,as:0})],doors:"w",x:4,y:2},{rects:[L(305,30,32,32,'"exit"'),L(530,184,32,32,"💻",{hi:1}),g(500,140,600,15,{m:3}),g(500,245,600,15,{m:3}),g(485,140,15,120,{m:3}),L(230,300,20,20,"🐟0",{m:5,ac:8,av:0}),L(280,300,20,20,"🐶0",{m:5,ac:9,av:0}),L(330,300,20,20,"🥬0",{m:5,ac:10,av:0}),L(380,300,20,20,"🥝0",{m:5,ac:11,av:0})],doors:"wen",x:4,y:1},{rects:[],doors:"sWe",x:3,y:-1},{rects:[v(105,85,80,245),v(265,125,110,25),v(315,195,125,20),v(215,265,145,25),v(435,310,30,75),v(490,20,40,220)],doors:"ew",x:4,y:-1},{rects:[g(240,0,10,80),g(250,80,110,10,{m:3}),g(360,0,10,80),L(290,20,20,20,"⚫",{m:5,ac:6,as:0}),g(140,130,380,10),g(550,0,20,400),v(450,50,70,70),v(70,70,70,50),S(300,200),S(100,300),R(600,100,20,20,-160,10,Y[2],{hi:1})],doors:"ew",x:5,y:-1},{rects:[g(140,120,10,170),g(220,200,230,20),g(510,120,10,170),T(160,20,150,90,{t:5e3,x:100,y:70,o:0,dx:250,dy:0}),p(50,50),S(300,300),S(200,200),S(100,100),b(280,384,80,16,"s",{dt:0,alpha:0}),T(160,20,60,40,{t:2e3,x:140,y:30,o:0,dx:0,dy:100})],doors:"wN",x:6,y:-1},{rects:[v(510,250,10,110),v(520,250,50,10),v(520,350,50,10),v(560,310,10,40),v(520,300,50,10),L(600,50,20,20,"🥬",{alpha:.2,hi:1})],doors:"w",x:6,y:0},{rects:[],doors:"ne",x:5,y:0},{rects:[v(480,150,15,100),R(400,200,20,20,10,-120,Y[1],{tdw:300})],doors:"se",x:0,y:0},{rects:[g(0,120,130,10,{m:3}),M(120,15,40,3),M(220,117,40,3),M(300,15,40,3),M(290,15,30,3),M(390,110,80,3,{mv:{t:2e3,x:390,y:117,o:0,dx:100,dy:0}}),g(130,80,10,50),g(140,120,420,10),g(560,0,10,400),g(380,0,10,40),L(460,40,20,20,"⚫",{m:5,ac:7,as:0})],doors:"es",x:6,y:-2},{rects:[S(50,50),S(390,50),S(120,350),S(520,250),g(190,160,10,90),g(200,160,40,10),g(240,170,10,70),v(200,240,40,10),v(280,170,10,70),g(290,240,60,10),g(350,170,10,70),v(290,160,60,10),g(380,160,10,90),g(390,240,50,10),v(440,200,10,50),g(410,190,40,10),v(390,160,60,10),S(200,200)],doors:"ne",x:2,y:-1},{rects:[v(120,70,410,240),p(200,200)],doors:"SWe",x:2,y:1},{rects:[R(200,200,20,20,10,-30,Y[3])],doors:"es",x:1,y:1},{rects:[],doors:"ns",x:1,y:2},{rects:[],doors:"ns",x:1,y:3},{rects:[R(400,300,20,20,10,-30,Y[4])],doors:"n",x:1,y:4},{rects:[L(305,80,32,32,"🪦"),L(240,60,128,32,"🐭",{alpha:.6}),g(0,120,640,10)],doors:"ns",x:2,y:-2},{rects:[L(300,300,20,20,"🥝",{alpha:.2,hi:1}),v(80,60,20,230)],doors:"s",x:2,y:-3},{rects:[R(200,300,20,20,10,-70,Y[5])],doors:"s",x:4,y:0},{rects:[R(500,200,20,20,-50,-100,Y[13])],doors:"w",x:5,y:1},{rects:[v(0,310,640,30),L(200,80,32,32,"🥔"),R(200,350,20,20,10,-100,Y[14])],doors:"n",x:2,y:2},{rects:[R(200,350,20,20,10,-50,Y[15]),L(160,350,20,20,"🐭",{alpha:.6})],doors:"w",x:7,y:-2}],z=()=>{"4,5,6,1"==`${d[7].collisions[5].av},${d[7].collisions[6].av},${d[7].collisions[7].av},${d[7].collisions[8].av}`&&(d[7].collisions[4].hi=1)},K=[0,1,e=>{d[5].collisions[1].hi=1,d[12].collisions[5].hi=1;for(let e=0;e<3;e++)r.collisions[e].te="⚫",r.collisions[e].as=0},e=>{K[2](),e.as=1,e.te=e.as?"🐟":"⚫",d[5].collisions[1].hi=0,window.sounds&&window.sounds.sfx(3)},e=>{K[2](),e.as=1,e.te=e.as?"🥬":"⚫",d[12].collisions[5].hi=0,window.sounds&&window.sounds.sfx(3)},e=>{K[2](),e.as=1,e.te=e.as?"🥝":"⚫",d[23].collisions[0].hi=0,window.sounds&&window.sounds.sfx(3)},e=>{e.as=+(0===e.as),r.collisions[5].hi=+(0!==e.as),e.te=0===e.as?"⚫":"🟢",window.sounds&&window.sounds.sfx(3)},e=>{e.as=+(0===e.as),r.collisions[8].hi=+(0!==e.as),e.te=0===e.as?"⚫":"🟢",window.sounds&&window.sounds.sfx(3)},e=>{e.av=(e.av+1)%10,e.te="🐟"+e.av,z()},e=>{e.av=(e.av+1)%10,e.te="🐶"+e.av,z()},e=>{e.av=(e.av+1)%10,e.te="🥬"+e.av,z()},e=>{e.av=(e.av+1)%10,e.te="🥝"+e.av,z()},e=>{e.as=+(0===e.as),r.collisions[2].hi=+(0!==e.as),e.te=0===e.as?"⚫":"🟢",window.sounds&&window.sounds.sfx(3)}],Q={"6,-1":()=>{let e=d.find(e=>5===e.x&&-1===e.y);e.collisions[5].hi=0,e.collisions[3].as=0,e.collisions[3].te="⚫",d.find(e=>5===e.x&&-1===e.y).collisions[10].hi=0},"2,-2":()=>{let e=d.find(e=>2===e.x&&-2===e.y);e.collisions[1].te="🐭 "+c,e.collisions[2].hi=0===c?1:0}};function V(u){let m=Math.min(50,u-l);if(l=u,i.isDead()&&0===f.t&&(window.sounds&&window.sounds.sfx(4),window.sounds&&window.sounds.pauseSong(0),f.t=m,U.fillStyle="#fff",U.fillText("Again",320,200),f.prev=-1),o.update(J.x,J.y));else if(h.a){r.draw(U);let e=h.d?h.t/250:1-h.t/250;U.fillStyle=`rgba(0,0,0,${Math.min(e,1)})`,U.fillRect(0,0,640,400),h.t+=m,h.d&&h.t>=75&&(h.h(),h.t=1,h.d=0),!h.d&&h.t>=150&&(h.a=!1,F.style.display="block")}else if(f.t>0||4===J.x&&0===J.y&&w(i.getPosRect(),{x:0,y:0,w:640,h:180})){f.t||(U.fillStyle="#fff",U.fillText(f.proph,320,120),f.prev=-1),f.t+=m;let e=Math.floor(f.t/500);e>f.prev&&(U.fillStyle="rgba(0, 0, 0, 0.1)",U.fillRect(0,0,640,400),f.prev=e)}else if(i.dc(m,U));else{if(U.clearRect(0,0,640,400),e.g&&r.collisions.filter(e=>"d"===e.t&&e.dt).forEach(e=>e.dt=0),t[0]||t[2]){let e={...i.getBullet(),t:t[2]};n.push(e),t[0]=0,t[2]=0}let l=i.updatePlayer(m,e,s,a,r);for(let e of n)for(let t of(e.x+=e.dx*(m/16)*2,e.y+=e.dy*(m/16)*2,2===r.x&&2===r.y&&y(e,i.getPosRect())&&(r.collisions[0].hi=1),r.collisions))if(y(e,t)){if("m"===t.e&&(t.mfd=!0,c++,E("mc",(D("mc")??0)+1)),"d"!==t.e||t.tim||(t.tim=1500),t.ac>0&&K[t.ac](t),"bw"===t.t){x(e,t);continue}e.mdf=!0}n=n.filter(e=>!e.mdf),r.update(m),r.draw(U);let f="";for(let e of n){let t=e.t?"hotpink":"blue";t!==f&&(U.fillStyle=t,f=t),U.fillText("🧶",e.x,e.y)}i.drawPlayer(U),l&&(l.t,"e"===l.t||"d"===l.t&&i.canOpen(l)&&("e"===l.d&&J.x++,"w"===l.d&&J.x--,"s"===l.d&&J.y++,"n"===l.d&&J.y--,F.style.display="none",h.a=!0,h.t=0,h.d=1,h.h=()=>{r=d.find(e=>e.x===J.x&&e.y===J.y),o.load(J.x,J.y),console.log("entering room",J),n=[],i.newRoom(l.d),window.sounds&&window.sounds.sfx(2),r.collisions.forEach(e=>{"x"!==e.t||e.mv||(e.a=0)}),Q[`${J.x},${J.y}`]?.()})),U.fillStyle="#461E52",U.fillText(i.invText(),575,35)}f.t>3e3?q():requestAnimationFrame(V)}U.textAlign="center",U.textBaseline="middle",addEventListener("resize",H),H(),onkeydown=t=>e[t.key.toLowerCase()]=1,onkeyup=t=>{e[t.key.toLowerCase()]=0},oncontextmenu=e=>e.preventDefault(),onmousemove=e=>{let t=O.getBoundingClientRect();s=640*(e.clientX-t.left)/t.width,a=400*(e.clientY-t.top)/t.height},onmousedown=e=>t[e.button.toString()]=1,onmouseup=e=>t[e.button.toString()]=0,window.warp=(e,t)=>{J.x=e,J.y=t,o.load(e,t),r=d.find(n=>n.x===e&&n.y===t),n=[],i.newRoom("w"),window.sounds&&window.sounds.sfx(1),Q[`${J.x},${J.y}`]?.()},U.fillStyle="#000000cc",U.fillText("loading...",320,200),window.sounds=new class{constructor(){this.player=new B,this.soundsLoading=[P,A,j,W,$],this.sounds=[],this.currentlyLoadingIndex=0,this.startedLoading=!1}load(e){if(this.startedLoading||(this.player.init(this.soundsLoading[this.currentlyLoadingIndex]),this.startedLoading=!0),1>this.player.generate())setTimeout(()=>this.load(e),100);else{let t=this.player.createWave(),n=document.createElement("audio");n.src=URL.createObjectURL(new Blob([t],{type:"audio/wav"})),this.sounds.push(n),this.currentlyLoadingIndex++,this.currentlyLoadingIndex<this.soundsLoading.length?(this.player.init(this.soundsLoading[this.currentlyLoadingIndex]),this.load(e)):(this.sounds[0].loop=!0,this.sounds[0].volume=0,e())}}playSong(e,t=0){this.sounds[e].loop=!0,this.sounds[e].volume=t,this.sounds[e].play()}pauseSong(e){this.sounds[e].pause()}stopSong(e){this.pauseSong(e),this.sounds[e].currentTime=0}sfx(e){this.sounds[e].play()}fade(e,t){this.intervalID&&clearInterval(this.intervalID),this.sounds[e].play(),this.intervalID=setInterval(()=>{if(this.sounds[e].volume<.9){let n=this.sounds[e].volume+.1;if(n>.9&&(n=.9),this.sounds[e].volume=n.toFixed(2),this.sounds[t].volume>0){let e=.9-n;e<0&&(e=0),this.sounds[t].volume=e.toFixed(2)}}else clearInterval(this.intervalID),this.intervalID=void 0},100)}}(void 0),window.sounds.load(()=>{U.clearRect(0,0,640,400),U.save(),U.font="64px monospace",U.shadowBlur=15,U.shadowColor="rgba(0,0,0,.7)",U.fillText("😼",320,130),U.restore(),U.fillStyle="#000000cc",U.fillText("nine lives later - déjà meow",320,200),U.fillText("click to start",320,240);let e=()=>{window.removeEventListener("click",e),q()};window.addEventListener("click",e)})</script>