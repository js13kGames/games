<!doctype html><meta content="width=device-width" name=viewport><title>GREEBLE</title><style>body{margin:0;overflow:hidden;background:#111;color:#ccc}#canvas{position:fixed;top:50%;bottom:0;left:50%;right:0;width:144vmin;height:96vmin;transform:translate(-50%,-25%);image-rendering:optimizeSpeed;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:-o-crisp-edges;image-rendering:pixelated;-ms-interpolation-mode:nearest-neighbor;cursor:none;margin:auto}</style><canvas id=canvas></canvas><script>!function(){function e(e){ae.fill(e,Q,Q+k)}function o(e,t,o){e=(0|e).clamp(0,b),t=(0|t).clamp(0,A),o|=0,ae[Q+t*b+e]=o}function n(e,t,o=Q){return ae[o+e+t*b]}function a(e,t,n,a,s){var r,i,l=(a|=0)-(t|=0),f=(n|=0)-(e|=0);if(l<0?(l=-l,i=-1):i=1,f<0?(f=-f,r=-1):r=1,l<<=1,f<<=1,o(e,t,s),f>l)for(var c=l-(f>>1);e!=n;)c>=0&&(t+=i,c-=f),c+=l,o(e+=r,t,s);else for(c=f-(l>>1);t!=a;)c>=0&&(e+=r,c-=l),c+=f,o(e,t+=i,s)}function s(e,t,n,a){var s=-n,r=0,i=2-2*n;do{o(e-s,t+r,a),o(e-r,t-s,a),o(e+s,t-r,a),o(e+r,t+s,a),(n=i)<=r&&(i+=2*++r+1),(n>s||i>r)&&(i+=2*++s+1)}while(s<0)}function r(e,t,o,n){if(!(o<0)){e|=0,t|=0,n|=0;var s=-(o|=0),r=0,i=2-2*o;do{a(e-s,t-r,e+s,t-r,n),a(e-s,t+r,e+s,t+r,n),(o=i)<=r&&(i+=2*++r+1),(o>s||i>r)&&(i+=2*++s+1)}while(s<0)}}function i(e,t,o,n,s){x1=0|e,y1=0|t,x2=e+o|0,y2=t+n|0;var r=Math.abs(y2-y1);if(a(x1,y1,x2,y1,s),r>0)for(;--r;)a(x1,y1+r,x2,y1+r,s);a(x1,y2,x2,y2,s)}function l(e,t,o,n,a,s){for(let r=0;r<=a;r++)i(e+r,t-r,o-2*r,n+2*r,s)}function f(e,t,o,n,s,r){let i=e+s,l=e+o-s,f=e+o,c=t+s,_=t+n-s,d=t+n;a(i,t,l,t,r),a(l,t,f,c,r),a(f,c,f,_,r),a(f,_,l,d,r),a(l,d,i,d,r),a(i,d,e,_,r),a(e,_,e,c,r),a(e,c,i,t,r)}function c(e,t,o,n=o,a=o,s=o){for(let r=0;r<=b;r++)for(let i=0;i<=A;i++){let l=r-1+i*b,f=r+1+i*b,c=r+(i+1)*b,_=r+(i-1)*b;ae[e+(r+i*b)]&&(ae[e+l]||(ae[t+l]=o),ae[e+f]||(ae[t+f]=a),ae[e+_]||(ae[t+_]=n),ae[e+c]||(ae[t+c]=s))}}function _(e,t,o,n,a,s,r){var i=b,l=(e=Math.round(16*e),o=Math.round(16*o),a=Math.round(16*a),t=Math.round(16*t),e-o),f=(n=Math.round(16*n))-t,c=o-a,_=(s=Math.round(16*s))-n,d=a-e,u=t-s,p=Math.max(Math.min(e,o,a)+15>>4,0),y=Math.min(Math.max(e,o,a)+15>>4,b),m=Math.max(Math.min(t,n,s)+15>>4,0),x=Math.min(Math.max(t,n,s)+15>>4,A);p&=-8;var h=-f*e-l*t,v=-_*o-c*n,g=-u*a-d*s;(f>0||0==f&&l>0)&&h++,(_>0||0==_&&c>0)&&v++,(u>0||0==u&&d>0)&&g++,h=h-1>>4,v=v-1>>4,g=g-1>>4;var w=0,R=0,I=0,S=0,M=0,N=0;l>=0?R-=7*l:w-=7*l,f>=0?R-=7*f:w-=7*f,c>=0?S-=7*c:I-=7*c,_>=0?S-=7*_:I-=7*_,d>=0?N-=7*d:M-=7*d,u>=0?N-=7*u:M-=7*u;for(var E=i-8,G=m&=-8;G<x;G+=8)for(var q=p;q<y;q+=8){var T=h+l*G+f*q,D=v+c*G+_*q,K=g+d*G+u*q;if(!(T<R||D<S||K<N)){var L=q+G*i;if(T>=w&&D>=I&&K>=M)for(O=0;O<8;O++){for(B=0;B<8;B++,L++)ae[Q+L]=r;L+=E}else for(var O=0;O<8;O++){for(var k=T,C=D,F=K,B=0;B<8;B++)(k|C|F)>=0&&(ae[Q+L]=r),k+=f,C+=_,F+=u,L++;T+=l,D+=c,K+=d,L+=E}}}}function d(e=0,t=0,o=384,n=256,a=0,s=0,r=!1,i=!1){for(var l=0;l<n;l++)for(var f=0;f<o;f++)s+l<A&&a+f<b&&s+l>-1&&a+f>-1&&(r&i?ae[V+((t+(n-l))*b+e+(o-f))]>0&&(ae[Q+((s+l)*b+a+f)]=$[ae[V+((t+(n-l))*b+e+(o-f))]]):i&&!r?ae[V+((t+(n-l))*b+e+f)]>0&&(ae[Q+((s+l)*b+a+f)]=ae[V+((t+(n-l))*b+e+f)]):r&&!i?ae[V+((t+l)*b+e+(o-f))]>0&&(ae[Q+((s+l)*b+a+f)]=ae[V+((t+l)*b+e+(o-f))]):r||i||ae[V+((t+l)*b+e+f)]>0&&(ae[Q+((s+l)*b+a+f)]=$[ae[V+((t+l)*b+e+f)]]))}function u(e,t,o,n,a,s,r,i){i*=.0174533;let l=o/2|0,f=n/2|0,c=o*r/2*1.41421356237|5,_=n*r/2*1.41421356237|5,d=-c,u=c,p=-_,y=_,m=1/r,x=Math.cos(-i)*m,h=Math.sin(-i)*m;for(let r=p;r<y;r++)for(let i=d;i<u;i++){let c=l+Math.round(x*i+h*r),_=f+Math.round(-h*i+x*r),d=i+a|0,u=r+s|0;c>=0&&_>=0&&c<o&&_<n&&ae[V+(c+e)+(_+t)*b]>0&&(d.clamp(0,b),u.clamp(0,A),ae[Q+d+u*b]=ae[V+(c+e)+(_+t)*b])}}function p(e,t=1,o=0,n=!1,a=1){var s=me.createBufferSource(),r=me.createGain(),i=me.createStereoPanner();return s.buffer=e,s.connect(i),i.connect(r),r.connect(me.destination),s.playbackRate.value=t,s.loop=n,r.gain.value=a,i.pan.value=o,s.start(),{volume:r,sound:s}}function y(){e(0),Q=P,V=P,i(8,10,17,9,8),i(7,11,19,7,8),i(9,12,15,5,2),i(11,14,2,1,16),i(21,14,2,1,16),a(12,15,13,15,21),a(22,15,23,15,21),a(17,9,17,6,5),o(17,6,21),i(44,15,3,1,5),i(42,17,7,7,5),i(43,21,5,5,0),r(139,28,5,13),i(74,22,2,5,8),r(75,28,3,8),s(75,28,1,5),_(105,19,114,27,117,23,8),i(206,10,4,12,9),c(P,F,23,21,31,23),V=F,d(),V=P,d(128,0,32,40,165,4),d(32,0,32,32,162,5),d(64,0,32,32,165,4),d(96,0,32,32,165,3),d(0,0,32,32,160,0),d(64,0,32,32,118,0,4),d(32,0,32,32,162,45),d(0,0,32,32,160,40),d(32,0,32,32,162,85),d(96,0,32,32,165,83),d(0,0,32,32,160,80)}function m(e=Date.now(),t=1664525,o=1013904223,n=Math.pow(2,32)){this.seed=e,this.a=t,this.c=o,this.m=n}function x(e){return Math.sin(6.283184*e)}function h(e){return.00390625*Math.pow(1.059463094,e-128)}function v(e,t){setTimeout((function(){var o=new Uint8Array(e*pe*2),n=o.length-2,a=function(){for(var e=new Date,s=0;n>=0;)if(o[n]=0,o[n+1]=128,n-=2,(s+=1)%1e3==0&&new Date-e>ye)return void setTimeout(a,0);setTimeout((function(){t(o)}),0)};setTimeout(a,0)}),0)}function g(e,t,o,n,a){var s=o.fx_delay_time*n>>1,r=o.fx_delay_amt/255,i=0,l=function(){for(var o=new Date,n=0;i<t-s;){var f=4*i,c=4*(i+s),_=e[c]+(e[c+1]<<8)+(e[f+2]+(e[f+3]<<8)-32768)*r;if(e[c]=255&_,e[c+1]=_>>8&255,_=e[c+2]+(e[c+3]<<8)+(e[f]+(e[f+1]<<8)-32768)*r,e[c+2]=255&_,e[c+3]=_>>8&255,++i,(n+=1)%1e3==0&&new Date-o>ye)return void setTimeout(l,0)}setTimeout(a,0)};setTimeout(l,0)}function w(e){lcg.setSeed(1019);let t=k*O;for(;--t;)ae[t]=0;switch(y(),e){case he:currentRoom[0]--,currentRoom[0]<0&&(currentRoom[0]=qe),console.log(currentRoom);break;case ve:currentRoom[0]++,currentRoom[0]>qe&&(currentRoom[0]=0),console.log(currentRoom);break;case ge:currentRoom[1]--,currentRoom[1]<0&&(currentRoom[1]=Te),console.log(currentRoom);break;case we:currentRoom[1]++,currentRoom[1]>Te&&(currentRoom[1]=0),console.log(currentRoom)}Q=z,rooms[world[currentRoom[1]*(qe+1)+currentRoom[0]]].draw(),R()}function R(){lcg.setSeed(1019+currentRoom[0]+1234.5678*currentRoom[1]),Q=H,e(0),Q=j,e(0),Q=Y,e(0),V=z,Q=j,d(),function(){Q=H,e(0);let t=5e3;for(;--t;)o(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),1);for(t=200;--t;)o(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),26);for(t=60;--t;)o(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),20);for(t=20;--t;)o(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),21);for(t=3;--t;)r(lcg.nextIntRange(0,384),lcg.nextIntRange(0,256),lcg.nextIntRange(2,5),lcg.nextIntRange(16,19))}(),function(){let e=k;for(;--e;)ae[z+e]==Me&&(roomNG.setSeed(lcg.seed+1234.5678*e),ae[j+e]=roomNG.nextIntRange(2,4))}(),function(){let e=k;for(;--e;)ae[z+e]==Se&&(roomNG.setSeed(lcg.seed+1234.5678*e),ae[j+e]=roomNG.nextIntRange(9,11))}(),S(),S(),function(){Q=B,e(0);for(var t=1500;--t;){let e=lcg.nextIntRange(0,b),t=lcg.nextIntRange(0,A);ae[z+e+t*b]==Re&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),l(e,t,roomNG.nextIntRange(5,13),roomNG.nextIntRange(2,4),1,25))}let o=2e3;for(;--o;){let e=lcg.nextIntRange(0,b),t=lcg.nextIntRange(0,A);ae[z+e+t*b]==Re&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),i(e,t,roomNG.nextIntRange(3,7),roomNG.nextIntRange(1,3),0))}for(o=15;--o;){let e=lcg.nextIntRange(0,b),t=lcg.nextIntRange(0,A);ae[z+e+t*b]==Re&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),i(e,t,roomNG.nextIntRange(10,80),roomNG.nextIntRange(10,80),0))}Q=U,e(0),c(B,U,24,18,25),Q=j,V=B,d(),V=U,d()}(),function(t=1,o=2,n=15,a=2,r=0){Q=B,e(0);for(var l=400;--l;){let e=lcg.nextIntRange(0,b),o=lcg.nextIntRange(0,A);ae[z+e+o*b]==Re&&(roomNG.setSeed(lcg.seed+e+1234.5678*o),i(e+roomNG.nextIntRange(-5,0),o+roomNG.nextIntRange(-20,0),t,roomNG.nextIntRange(1,16),1),s(e,o-10,1,t))}Q=U,e(0),c(B,U,o,n,a,r),Q=Y,V=B,d(),V=U,d()}(),Q=z,rooms[world[currentRoom[1]*(qe+1)+currentRoom[0]]].specials()}function I(){let e=k;for(;--e;){let o=ae[z+e],n=e/b|0,a=e%b;switch(V=P,Q=C,o){case Ie:u(192,0,32,32,a-2,n-5,1,90*t);break;case Ne:u(32,0,32,32,a-2,n-5,1,90*t);break;case Ee:u(96,0,32,32,a-2,n-5,1,90*t);break;case Ge:u(128,0,32,40,a-2,n-5,1,90*t)}}}function S(t=1,o=1,a=15,s=3,r=1){for(V=z,Q=B,e(0),l=3e3;--l;){let e=lcg.nextIntRange(0,b),t=lcg.nextIntRange(0,A);n(e,t,z)==Re&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),i(e+roomNG.nextIntRange(-2,2),t+roomNG.nextIntRange(-2,2),roomNG.nextIntRange(2,6),1,2))}Q=U,e(0),c(B,U,1),Q=j,V=B,d(),V=U,d();for(var l=3e3;--l;){let e=lcg.nextIntRange(0,b),t=lcg.nextIntRange(0,A);n(e,t,z)==Re&&(roomNG.setSeed(lcg.seed+e+1234.5678*t),i(e+roomNG.nextIntRange(-2,2),t+roomNG.nextIntRange(-2,2),1,roomNG.nextIntRange(2,6),2))}Q=U,e(0),c(B,U,1,15,3,1),Q=j,V=B,d(),V=U,d()}function M(){let e=36;for(;e--;){roomNG.setSeed(lcg.seed+1234.5678*e);let o=(roomNG.nextIntRange(-200,A)-20*t|0)%A*2+A,n=roomNG.nextIntRange(20,120),a=roomNG.nextIntRange(10,30);f(roomNG.nextIntRange(-200,b),o,n,a,5,1)}}function N(e=1,t=14){let o=150;for(;o--;){Q=H,roomNG.setSeed(lcg.seed+1234.5678*o);let t=roomNG.nextIntRange(60,A),n=roomNG.nextIntRange(3,15);r(roomNG.nextIntRange(0,b),t,n,e)}for(o=150;o--;){Q=H,roomNG.setSeed(lcg.seed+1232.5678*o);let e=roomNG.nextIntRange(100,A),n=roomNG.nextIntRange(3,15);r(roomNG.nextIntRange(0,b),e,n,t)}for(o=100;o--;){Q=H,roomNG.setSeed(lcg.seed+1230.5678*o);let t=roomNG.nextIntRange(150,A),n=roomNG.nextIntRange(15,20);r(roomNG.nextIntRange(0,b),t,n,e)}}function E(){let e=150;for(;e--;){Q=H,roomNG.setSeed(lcg.seed+1234.5678*e);let t=roomNG.nextIntRange(0,A),o=roomNG.nextIntRange(15,60),n=roomNG.nextIntRange(15,60);f(roomNG.nextIntRange(0,b),t,o,n,3,1)}}function G(t,n=!1){t.forEach((function(e,t,n){1==e&&i(t%12*32,32*(t/12|0),32,32,Re),2==e&&o(t%12*32+16,32*(t/12|0)+16,Ie),7==e&&o(t%12*32+16,32*(t/12|0)+16,Ee),8==e&&o(t%12*32+16,32*(t/12|0)+16,Ge)})),n&&(V=z,Q=B,d(0,0,b,A,0,0,!0),Q=z,e(),V=B,d())}function q(e=0,t=0,o=10,n=10,a=21,s=!1,r=!1){this.x=e,this.y=t,this.maxSize=o,this.speed=n,this.counter=this.speed,this.color=a,this.size=1,this.filled=s,this.square=r}function T(e="",t=9,o=200){this.text=e,this.color=t,this.time=o,this.string="",this.counter=0}function D(e){for(var t=e[0].length,n=0;n<t;n++){var a;a=L(e[0].charAt(n));for(var s=0;s<5;s++)for(var r=0;r<5;r++)1==a[5*s+r]&&(1==e[4]?o(e[1]+r*e[4]+(5*e[4]+e[3])*n,e[2]+s*e[4],e[5]):i(e[1]+r*e[4]+(5*e[4]+e[3])*n,e[2]+s*e[4],e[4],e[4],e[5]))}}function K(e){var t=5*e[7],o=e[0].split("\n"),n=o.slice(0),a=o.length,s=n.sort((function(e,t){return t.length-e.length}))[0],r=s.length*t+(s.length-1)*e[3],i=a*t+(a-1)*e[4];e[5]||(e[5]="left"),e[6]||(e[6]="bottom");var l=e[1],f=e[2],c=e[1]+r,_=e[2]+i;"center"==e[5]?(l=e[1]-r/2,c=e[1]+r/2):"right"==e[5]&&(l=e[1]-r,c=e[1]),"center"==e[6]?(f=e[2]-i/2,_=e[2]+i/2):"bottom"==e[6]&&(f=e[2]-i,_=e[2]);for(var d=l+r/2,u=f+i/2,p=0;p<a;p++){var y=o[p],m=y.length*t+(y.length-1)*e[3],x=e[1],h=e[2]+(t+e[4])*p;"center"==e[5]?x=e[1]-m/2:"right"==e[5]&&(x=e[1]-m),"center"==e[6]?h-=i/2:"bottom"==e[6]&&(h-=i),D([y,x,h,e[3]||0,e[7]||1,e[8],e[9]])}return{sx:l,sy:f,cx:d,cy:u,ex:c,ey:_,width:r,height:i}}function L(e){return index=fontString.indexOf(e),fontBitmap.substring(25*index,25*index+25).split("")}const b=384,A=256,O=22,k=b*A,C=0,F=2*k,B=6*k,U=8*k,P=10*k,z=12*k,j=14*k,Y=16*k,H=18*k,X=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];var W=document.getElementById("canvas"),J=W.getContext("2d"),Q=0,V=k,Z=[4278190080,4281606178,4282132549,4281416038,4282078863,4280709599,4284915929,4288332782,4281791227,4283491737,4281384554,4285436983,4281297227,4280568658,4281941042,4285808447,4286734384,4292963931,4294941539,4293184863,4294761419,4294967295,4290227611,4287069828,4285164137,4283586137,4287251062,4281479852,4284700633,4290411479,4283078543,4281364362],$=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31];paldrk=[0,0,1,2,3,4,5,6,6,10,11,12,13,14,2,2,15,16,17,18,22,20,23,24,25,26,2,2,27,28,31,13],J.imageSmoothingEnabled=!1,J.mozImageSmoothingEnabled=!1,W.width=b,W.height=A;var ee=J.getImageData(0,0,b,A),te=new ArrayBuffer(ee.data.length),oe=new Uint8Array(te),ne=new Uint32Array(te),ae=new Uint8ClampedArray(b*A*O);Number.prototype.clamp=function(e,t){return Math.min(Math.max(this,e),t)},Number.prototype.map=function(e,t,o,n){return(this-e)/(t-e)*(n-o)+o},world=[0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,2,4,2,1,2,4,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,5,0,0,0,7,4,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,4,7,11,2,4,0,4,2,5,12,0,0,17,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,0,2,16,2,18,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,2,6,2,10,11,4,0,15,5,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,2,4,0,0,17,5,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,12,4,4,5,2,16,8,2,13,2,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,0,0,0,15,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,8,2,2,2,6,8,4,0,14,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,6,2,13,2,2,18,2,4,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,2,2,0,0,0,0,2,7,8,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,6,10,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19,19];var se={osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:0,osc1_waveform:0,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:548,env_sustain:0,env_release:16584,env_master:192,fx_filter:2,fx_freq:914,fx_resonance:67,fx_delay_time:2,fx_delay_amt:72,fx_pan_freq:1,fx_pan_amt:88,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:2,lfo_amt:51,lfo_waveform:0},re={rowLen:5513,endPattern:17,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:128,osc1_waveform:2,osc2_oct:6,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:142,osc2_waveform:3,noise_fader:0,env_attack:137,env_sustain:2653,env_release:1979,env_master:155,fx_filter:3,fx_freq:1052,fx_resonance:154,fx_delay_time:6,fx_delay_amt:25,fx_pan_freq:8,fx_pan_amt:144,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:3,lfo_amt:69,lfo_waveform:0,p:[2,2,3,3,2,2,3,3,2,2,3,3,2,2,3,3],c:[{n:[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{n:[171,166,169,171,174,171,169,171,0,166,169,171,174,171,169,171,171,166,169,171,174,171,169,171,0,166,169,171,174,171,169,171]},{n:[169,164,167,169,172,169,167,169,0,164,167,169,172,169,167,169,169,164,167,169,172,169,167,169,0,164,167,169,172,169,167,169]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:116,osc1_waveform:1,osc2_oct:8,osc2_det:0,osc2_detune:8,osc2_xenv:0,osc2_vol:255,osc2_waveform:2,noise_fader:0,env_attack:351,env_sustain:4611,env_release:1403,env_master:199,fx_filter:2,fx_freq:200,fx_resonance:254,fx_delay_time:5,fx_delay_amt:12,fx_pan_freq:0,fx_pan_amt:214,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:87,lfo_waveform:3,p:[1,1,2,2,1,1,2,2,1,1,2,2,1,1,2,2],c:[{n:[123,0,0,121,0,0,123,0,0,0,0,0,0,0,121,0,123,0,0,121,0,0,123,0,0,0,0,0,0,0,0,0]},{n:[121,0,0,119,0,0,121,0,0,0,0,0,0,0,119,0,121,0,0,119,0,0,121,0,0,0,0,0,0,0,0,0]}]},{osc1_oct:6,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:162,osc1_waveform:0,osc2_oct:6,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:162,osc2_waveform:0,noise_fader:14,env_attack:50,env_sustain:150,env_release:8181,env_master:161,fx_filter:2,fx_freq:5900,fx_resonance:240,fx_delay_time:4,fx_delay_amt:33,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[123,0,0,123,0,0,0,123,123,0,0,0,0,0,0,0,123,0,0,0,0,0,0,0,123,0,0,0,0,0,0,0]}]},{osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:0,osc1_waveform:0,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:29,env_attack:50,env_sustain:419,env_release:4607,env_master:130,fx_filter:2,fx_freq:10332,fx_resonance:120,fx_delay_time:4,fx_delay_amt:16,fx_pan_freq:5,fx_pan_amt:108,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:5,lfo_amt:187,lfo_waveform:0,p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[0,123,123,123,0,123,123,123,0,123,0,123,0,123,123,123,0,123,123,123,0,123,0,123,0,123,123,123,0,123,123,123]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:4,osc2_xenv:0,osc2_vol:154,osc2_waveform:2,noise_fader:0,env_attack:197,env_sustain:13163,env_release:10614,env_master:180,fx_filter:2,fx_freq:1792,fx_resonance:136,fx_delay_time:6,fx_delay_amt:81,fx_pan_freq:3,fx_pan_amt:151,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1,2,3,4,5,2,3,4,5,2,3,4,5,2,3,4],c:[{n:[162,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,164,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{n:[166,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,171,0,0,0,0,0,0,0,166,0,0,0,0,0,0,0]},{n:[164,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,162,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{n:[164,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,169,0,0,0,0,0,0,0,0,0,0,0,167,0,0,0]},{n:[166,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,164,0,0,0,0,0,0,0,0,0,0,0,167,0,0,0]}]}],songLen:69},ie={rowLen:6615,endPattern:32,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:191,osc1_waveform:1,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:125,osc2_waveform:1,noise_fader:0,env_attack:200,env_sustain:2e3,env_release:2418,env_master:60,fx_filter:2,fx_freq:3859,fx_resonance:130,fx_delay_time:6,fx_delay_amt:128,fx_pan_freq:4,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[0,0,0,0,0,0,0,0,0,0,0,0,1,2,1,2,1,2,1,2,3,4,1,2,1,2],c:[{n:[137,0,140,0,144,0,147,0,137,0,140,0,144,0,147,0,137,0,140,0,144,0,147,0,137,0,140,0,144,0,147,0]},{n:[137,0,140,0,144,0,146,0,137,0,140,0,144,0,146,0,137,0,140,0,144,0,146,0,137,0,140,0,144,0,146,0]},{n:[137,0,140,0,144,0,147,0,151,0,147,0,149,0,144,0,152,0,144,0,151,0,152,0,149,0,142,0,144,0,140,0]},{n:[142,0,137,0,142,0,144,0,147,0,144,0,146,0,142,0,140,0,142,0,137,0,142,0,147,0,144,0,146,0,142,0]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:1,osc2_oct:7,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:154,osc2_waveform:1,noise_fader:0,env_attack:197,env_sustain:3158,env_release:1403,env_master:45,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:2,fx_delay_amt:65,fx_pan_freq:3,fx_pan_amt:47,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[0,0,0,0,0,0,0,0,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,0,1],c:[{n:[125,0,0,123,0,0,125,0,0,0,0,0,0,0,123,0,125,0,0,123,0,0,125,0,0,0,0,0,0,0,0,0]},{n:[130,0,0,128,0,0,130,0,0,0,0,0,0,0,128,0,130,0,0,128,0,0,130,0,0,0,0,0,0,0,0,0]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:5,osc2_xenv:0,osc2_vol:192,osc2_waveform:2,noise_fader:0,env_attack:88,env_sustain:6338,env_release:444,env_master:131,fx_filter:2,fx_freq:4425,fx_resonance:219,fx_delay_time:3,fx_delay_amt:61,fx_pan_freq:0,fx_pan_amt:23,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:7,lfo_amt:97,lfo_waveform:0,p:[0,0,0,0,0,0,0,0,0,0,3,4,0,0,0,0,0,0,0,0,0,0,1,2,3,4],c:[{n:[152,151,152,0,0,0,0,0,151,0,0,152,0,0,149,0,0,0,0,0,0,0,149,0,152,0,0,156,0,0,159,0]},{n:[158,154,149,0,0,0,149,151,152,0,154,151,0,152,149,0,0,0,0,0,0,0,0,149,152,151,149,0,149,147,0,0]},{n:[152,151,152,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,149,152,156,161]},{n:[158,154,149,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]},{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:255,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:9,osc2_xenv:0,osc2_vol:154,osc2_waveform:2,noise_fader:0,env_attack:0,env_sustain:99915,env_release:128335,env_master:115,fx_filter:2,fx_freq:1052,fx_resonance:166,fx_delay_time:5,fx_delay_amt:0,fx_pan_freq:3,fx_pan_amt:178,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[0,0,1,0,2,0,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,0,2],c:[{n:[113,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]},{n:[118,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]},{osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:82,osc1_waveform:2,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:0,env_sustain:0,env_release:2193,env_master:63,fx_filter:3,fx_freq:5200,fx_resonance:63,fx_delay_time:2,fx_delay_amt:29,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159,0,159]}]},{osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:0,osc1_waveform:0,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:1e5,env_sustain:1e5,env_release:1e5,env_master:215,fx_filter:2,fx_freq:817,fx_resonance:16,fx_delay_time:2,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:255,lfo_osc1_freq:0,lfo_fx_freq:1,lfo_freq:2,lfo_amt:119,lfo_waveform:0,p:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],c:[{n:[111,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:155},le={osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:117,osc1_waveform:3,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:155,osc2_waveform:2,noise_fader:0,env_attack:7105,env_sustain:0,env_release:444,env_master:192,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:2,fx_delay_amt:16,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:59,lfo_waveform:0},fe={rowLen:2544,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:192,osc1_waveform:3,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:166,osc2_waveform:3,noise_fader:47,env_attack:0,env_sustain:1234,env_release:19736,env_master:72,fx_filter:2,fx_freq:5029,fx_resonance:132,fx_delay_time:4,fx_delay_amt:16,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1],c:[{n:[171,170,171,170,171,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:4},ce={rowLen:4134,endPattern:2,songData:[{osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:0,osc1_vol:192,osc1_waveform:2,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:192,osc2_waveform:2,noise_fader:0,env_attack:0,env_sustain:351,env_release:5268,env_master:103,fx_filter:0,fx_freq:11025,fx_resonance:255,fx_delay_time:3,fx_delay_amt:56,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0,p:[1],c:[{n:[161,166,170,175,173,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]}]}],songLen:7},_e={osc1_oct:7,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:255,osc1_waveform:0,osc2_oct:7,osc2_det:0,osc2_detune:0,osc2_xenv:1,osc2_vol:255,osc2_waveform:0,noise_fader:163,env_attack:50,env_sustain:150,env_release:96977,env_master:228,fx_filter:2,fx_freq:1934,fx_resonance:254,fx_delay_time:0,fx_delay_amt:0,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0},de={osc1_oct:8,osc1_det:0,osc1_detune:0,osc1_xenv:1,osc1_vol:82,osc1_waveform:2,osc2_oct:8,osc2_det:0,osc2_detune:0,osc2_xenv:0,osc2_vol:0,osc2_waveform:0,noise_fader:255,env_attack:100,env_sustain:0,env_release:663,env_master:186,fx_filter:2,fx_freq:5200,fx_resonance:63,fx_delay_time:1,fx_delay_amt:25,fx_pan_freq:0,fx_pan_amt:0,lfo_osc1_freq:0,lfo_fx_freq:0,lfo_freq:0,lfo_amt:0,lfo_waveform:0};fontString="ABCDEFGHIJKLMNOPQRSTUVWXYZ1234567890_!@#.'\"?/<()",fontBitmap="11111100011111110001100011111010001111101000111110111111000010000100000111111100100101000110001111101111110000111001000011111111111000011100100001000011111100001011110001111111000110001111111000110001111110010000100001001111111111000100001010010111101000110010111001001010001100001000010000100001111110001110111010110001100011000111001101011001110001011101000110001100010111011110100011001011100100000111010001100011001001111111101000111110100011000101111100000111000001111101111100100001000010000100100011000110001100010111010001100011000101010001001000110001101011010101110100010101000100010101000110001010100010000100001001111100010001000100011111001000110000100001000111001110100010001000100111111111000001001100000111110100101001011111000100001011111100001111000001111100111110000111101000101110111110000100010001000010001110100010111010001011100111010001011110000101110011101000110001100010111000000000000000000000111110010000100001000000000100111111000110111101011011101010111110101011111010100000000000000000000000100001100001000100000000000011011010011001000000000000111010001001100000000100000010001000100010001000000010001000100000100000100001000100001000010000010",m.prototype.setSeed=function(e){this.seed=e},m.prototype.nextInt=function(){return this.seed=(this.seed*this.a+this.c)%this.m,this.seed},m.prototype.nextFloat=function(){return this.nextInt()/this.m},m.prototype.nextBool=function(e){return null==e&&(e=.5),this.nextFloat()<e},m.prototype.nextFloatRange=function(e,t){return e+this.nextFloat()*(t-e)},m.prototype.nextIntRange=function(e,t){return Math.floor(this.nextFloatRange(e,t))},m.prototype.nextColor=function(){for(var e=this.nextIntRange(0,Math.pow(2,24)).toString(16).toUpperCase();e.length<6;)e="0"+e;return"#"+e};var ue={},pe=2,ye=33,me=null,xe=[x,function(e){return x(e)<0?-1:1},function(e){return e%1-.5},function(e){var t=e%1*4;return t<2?t-1:3-t}];ue.AudioGenerator=function(e){this.mixBuf=e,this.waveSize=e.length/pe/2},ue.AudioGenerator.prototype.getAudioBuffer=function(e){null===me&&(me=new AudioContext);var t=this.mixBuf,o=this.waveSize*pe*2,n=me.createBuffer(pe,this.waveSize,44100),a=n.getChannelData(0),s=n.getChannelData(1),r=0,i=function(){for(var l=new Date,f=0;r<o/2;){var c=4*(t[4*r]+(t[4*r+1]<<8)-32768);if(c=c<-32768?-32768:c>32767?32767:c,a[r]=c/32768,c=(c=4*(t[4*r+2]+(t[4*r+3]<<8)-32768))<-32768?-32768:c>32767?32767:c,s[r]=c/32768,r+=1,(f+=1)%1e3==0&&new Date-l>ye)return void setTimeout(i,0)}setTimeout((function(){e(n)}),0)};setTimeout(i,0)},ue.SoundGenerator=function(e,t){this.instr=e,this.rowLen=t||5605,this.osc_lfo=xe[e.lfo_waveform],this.osc1=xe[e.osc1_waveform],this.osc2=xe[e.osc2_waveform],this.attack=e.env_attack,this.sustain=e.env_sustain,this.release=e.env_release,this.panFreq=Math.pow(2,e.fx_pan_freq-8)/this.rowLen,this.lfoFreq=Math.pow(2,e.lfo_freq-8)/this.rowLen},ue.SoundGenerator.prototype.genSound=function(e,t,o){new Date;for(var n=0,a=0,s=h(e+12*(this.instr.osc1_oct-8)+this.instr.osc1_det)*(1+8e-4*this.instr.osc1_detune),r=h(e+12*(this.instr.osc2_oct-8)+this.instr.osc2_det)*(1+8e-4*this.instr.osc2_detune),i=this.instr.fx_resonance/255,l=0,f=0,c=this.attack+this.sustain+this.release-1;c>=0;--c){var _=c+o,d=this.osc_lfo(_*this.lfoFreq)*this.instr.lfo_amt/512+.5,u=1;c<this.attack?u=c/this.attack:c>=this.attack+this.sustain&&(u-=(c-this.attack-this.sustain)/this.release);var p=s;this.instr.lfo_osc1_freq&&(p+=d),this.instr.osc1_xenv&&(p*=u*u),n+=p;var y=this.osc1(n)*this.instr.osc1_vol;p=r,this.instr.osc2_xenv&&(p*=u*u),a+=p,y+=this.osc2(a)*this.instr.osc2_vol,this.instr.noise_fader&&(y+=(2*Math.random()-1)*this.instr.noise_fader*u),y*=u/255;var m=this.instr.fx_freq;this.instr.lfo_fx_freq&&(m*=d);var v=i*(y-f)-(l+=(m=1.5*Math.sin(3.141592*m/44100))*f);switch(f+=m*v,this.instr.fx_filter){case 1:y=v;break;case 2:y=l;break;case 3:y=f;break;case 4:y=l+v}if(p=x(_*this.panFreq)*this.instr.fx_pan_amt/512+.5,y*=39*this.instr.env_master,3+(_*=4)<t.length){var g=t[_]+(t[_+1]<<8)+y*(1-p);t[_]=255&g,t[_+1]=g>>8&255,g=t[_+2]+(t[_+3]<<8)+y*p,t[_+2]=255&g,t[_+3]=g>>8&255}}},ue.SoundGenerator.prototype.getAudioGenerator=function(e,t){var o=this.attack+this.sustain+this.release-1+32*this.rowLen,n=this;v(o,(function(a){n.genSound(e,a,0),g(a,o,n.instr,n.rowLen,(function(){t(new ue.AudioGenerator(a))}))}))},ue.SoundGenerator.prototype.createAudioBuffer=function(e,t){this.getAudioGenerator(e,(function(e){e.getAudioBuffer(t)}))},ue.MusicGenerator=function(e){this.song=e,this.waveSize=44100*e.songLen},ue.MusicGenerator.prototype.generateTrack=function(e,t,o){var n=this;v(this.waveSize,(function(a){var s=n.waveSize,r=n.waveSize*pe*2,i=n.song.rowLen,l=n.song.endPattern,f=new ue.SoundGenerator(e,i),c=0,_=0,d=0,u=function(){for(var t=new Date;;)if(32!==d){if(_===l-1)return void setTimeout(p,0);var o=e.p[_];if(o){var n=e.c[o-1].n[d];n&&f.genSound(n,a,c)}if(c+=i,d+=1,new Date-t>ye)return void setTimeout(u,0)}else d=0,_+=1},p=function(){g(a,s,e,i,m)},y=0,m=function(){for(var e=new Date,n=0;y<r;){var s=t[y]+(t[y+1]<<8)+a[y]+(a[y+1]<<8)-32768;if(t[y]=255&s,t[y+1]=s>>8&255,y+=2,(n+=1)%1e3==0&&new Date-e>ye)return void setTimeout(m,0)}setTimeout(o,0)};setTimeout(u,0)}))},ue.MusicGenerator.prototype.getAudioGenerator=function(e){var t=this;v(this.waveSize,(function(o){var n=0,a=function(){n<t.song.songData.length?(n+=1,t.generateTrack(t.song.songData[n-1],o,a)):e(new ue.AudioGenerator(o))};a()}))},ue.MusicGenerator.prototype.createAudioBuffer=function(e){this.getAudioGenerator((function(t){t.getAudioBuffer(e)}))},states={},init=()=>{lcg=new m(1019),roomNG=new m,roomNG.setSeed(1019),sounds={},soundsLoaded=0,totalSounds=8,score=0,fuelTimer=0,parts=0,last=0,dt=0,now=0,t=0,state="loading",splodes=[],messages=[],help=[],tCounter=0,helpSection=0,credits=!1,paused=!1,transition=!1,gotFirst200=!1,s_titleSong=!1,s_gameSong=!1,s_jump=!1,s_step=!1,me=new AudioContext,y(),states.loading.init(),player.init(),loop()},window.addEventListener("keyup",(function(e){Key.onKeyup(e)}),!1),window.addEventListener("keydown",(function(e){Key.onKeydown(e)}),!1),window.addEventListener("blur",(function(e){paused=!0}),!1),window.addEventListener("focus",(function(e){paused=!1}),!1),loop=e=>{if(paused)$=paldrk,K(["PAUSED",b/2,128,3,1,"center","top",4,21,0]);else{$=X;let e=(new Date).getTime();dt=Math.min(1,(e-last)/1e3),t+=dt,states[state].step(dt),last=e,states[state].render()}(function(){for(var e=k;e--;)ne[e]=Z[$[ae[e]]];ee.data.set(oe),J.putImageData(ee,0,0)})(),requestAnimationFrame(loop)};const he=1,ve=2,ge=3,we=4,Re=1,Ie=8,Se=9,Me=4,Ne=27,Ee=28,Ge=29,qe=39,Te=16,De=b/6,Ke=b/6*3,Le=b/6*5,be=A/4,Ae=A/4*2,Oe=A/4*3;rooms=[{draw:function(e){},specials:function(e){}},{draw:function(e){_(Ke,Ae,Le,Oe,De,Oe,Re),_(Le,Oe,Ke,Ae,De,Oe,Re),_(Ke,Ae,De,Oe,Le,Oe,Re),i(0,Oe,b,be,Re)},specials:function(e){N(),function(e,t,o,n,a){Q=j,V=P;let s=a;for(;s--;)$=paldrk,roomNG.setSeed(lcg.seed+1234.5678*s),u(0,0,32,32,roomNG.nextIntRange(e,e+o),roomNG.nextIntRange(t,t+n),1,roomNG.nextIntRange(0,359)),$=X}(0,Oe,b,be-10,20)}},{draw:function(e){G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1]),o(25+325*Math.random(),A-36,Ie),o(25+325*Math.random(),A-36,Ie)},specials:function(e){N()}},{draw:function(e){G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,1,1,1,1,1,1,1,1,1,0,0,0])},specials:function(e){N()}},{draw:function(e){G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,0,2,0,0,0,0,1,1,1,1,0,0,0,0,1,1,1,1])},specials:function(e){N()}},{draw:function(e){G([1,1,1,1,0,0,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,0,2,0,0,0,0,2,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1,1,1,0,0,0,0,1,1,0,0,1,1,1,1,0,0,0,0,1,1,1,1])},specials:function(e){E()}},{draw:function(e){G([1,1,1,1,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,0,0]),o(200*Math.random()+70,A-40,Ne)},specials:function(e){E(),N()}},{draw:function(e){G([0,1,1,1,0,0,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,1,1,1,0,1,1,1,2,0,0,0,0,0,2,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,2,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1])},specials:function(e){E()}},{draw:function(e){G([1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,1,1,0,0,1,1,1,1,1,0,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1])},specials:function(e){E()}},{draw:function(e){G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,1,1,1,1,1,1,1,1,1])},specials:function(e){N(0,27)}},{draw:function(e){G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,1,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1])},specials:function(e){E()}},{draw:function(e){G([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,0,1,0,0,0,0,0,1,2,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,1,1,1,1,1,1,1,1,1,1,1,1],!0)},specials:function(e){E()}},{draw:function(e){G([0,1,1,1,0,0,0,0,1,1,1,1,0,1,1,1,0,0,0,0,1,1,1,1,0,1,1,1,2,0,0,0,0,0,2,0,0,1,1,1,1,1,1,1,1,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,0,0,0,2,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1,1,1,1,1,0,0,0,0,1,1,1,1],!0)},specials:function(e){E()}},{draw:function(e){G([1,0,0,0,0,0,0,0,0,2,1,1,1,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,1,1,1,1,1,0,0,0,0,0,0,2,0,0,0,1,1,0,0,0,0,0,1,1,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,1,1,1,0,1,1,1,1,1,1,1,1,1,1,1,1])},specials:function(e){E()}},{draw:function(e){G([1,1,2,0,0,0,0,0,0,0,0,1,1,1,1,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,1,1,1,0,0,0,1,1,0,0,0,0,0,0,2,0,0,0,1,1,0,0,0,0,0,0,1,1,0,0,1,1,0,0,0,0,0,0,0,0,0,0,1,1,0,0,0,0,0,0,0,0,0,1,1])},specials:function(e){E()}},{draw:function(e){G([1,1,1,1,0,0,0,0,0,0,0,1,1,1,1.1,1,1,0,0,0,0,0,1,1,0,0,0,0,0,1,0,0,0,0,1,1,0,0,0,0,0,0,2,0,0,0,1,1,0,0,0,0,2,0,0,1,0,0,1,1,0,0,0,1,1,0,0,0,0,0,1,1,0,0,0,0,0,0,0,1,1,1,1,1,1,0,0,0,0,0,0,0,0,0,1])},specials:function(e){E()}},{draw:function(e){G([1,1,1,1,0,0,0,0,0,0,0,1,1,0,1,1,0,0,0,0,0,0,0,1,1,2,1,1,1,1,0,0,0,0,0,1,1,2,1,0,0,0,0,0,1,0,0,1,1,2,1,0,0,0,0,0,7,0,0,1,1,2,1,0,0,0,1,1,1,1,1,0,1,2,1,0,0,0,0,0,0,1,1,0,1,1,1,1,0,0,0,0,0,0,0,1])},specials:function(e){E()}},{draw:function(e){G([1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,0,0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0,1])},specials:function(e){E()}},{draw:function(e){G([1,1,1,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,1,1,0,0,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,1,1,0,1,1,0,0,0,0,0,1,1,1,1,8,1,1,1,0,0,1,1,1,1,1,1,1,1,1,1,1,1])},specials:function(e){E()}},{draw:function(e){let t=roomNG.nextIntRange(100,300),o=roomNG.nextIntRange(50,200),n=roomNG.nextIntRange(30,50);r(t,o,n,Re),r(t,o,n-5,0),i(0,200,b,20,Re),i(170,200,100,20,0),i(0,0,b,20,Re)},specials:function(e){E(),credits=!0,helpSection=4}}],player={init(){this.x=192,this.y=106,this.radius=8,this.hitRadius=8,this.xvel=0,this.yvel=0,this.xspeed=80,this.yspeed=80,this.drag=.8,this.gravity=8,this.maxYvel=400,this.maxXvel=200,this.minYvel=-400,this.minXvel=-200,this.b={},this.facingLeft=!1,this.jumping=!0,this.jumpCooldown=0,this.angle=0,this.mode=1,this.gunCooldown=0,this.minedFuel=!1,fuelTimer=30,currentRoom=[20,1]},update(e){this.updateB(),this.oldX=this.x,this.oldY=this.y,this.xvel*=player.drag,this.yvel+=player.gravity,this.yvel=this.yvel.clamp(this.minYvel,this.maxYvel),this.xvel=this.xvel.clamp(this.minXvel,this.maxXvel);let t=e*player.xvel,a=e*player.yvel;if(player.x+=t,this.updateB(),this.collides()&&(player.x=player.oldX,player.xvel=.4*-player.xvel),player.y+=a,this.updateB(),this.collides()&&(player.y=player.oldY,player.yvel=.4*-player.yvel),this.updateB(),this.collides()&&(this.collideResolution(),this.updateB(),this.collides()&&(this.collideResolution(),this.updateB())),this.overlapResolution(),this.updateB(),player.yvel>0&&(s_step=!1,(ae[z+player.b.x+player.b.bottom*b]>0||ae[z+player.b.x+4+player.b.bottom*b]>0||ae[z+player.b.x-4+player.b.bottom*b]>0)&&(this.jumping=!1),4==player.mode)){let e=player.b.width;for(;e--;)ae[z+player.b.x+e+player.b.bottom*b]&&(this.jumping=!1)}switch(player.yvel<-10&&(splodes.push(new q(player.x+3+2*Math.random(),player.y+6+2*Math.random(),7,1,19)),splodes.push(new q(player.x-3-2*Math.random(),player.y+6+2*Math.random(),7,1,19)),s_step||(stepSound=p(sounds.step,1,player.x.map(0,b,-1,1),!1,.25),s_step=!0)),player.mode){case 1:player.yspeed=80,player.xspeed=80,fuelTimer>=360&&(fuelTimer=360),(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.facingLeft=!1,this.jumping?player.xvel=player.xspeed:player.xvel=0),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(this.facingLeft=!0,this.jumping?player.xvel=-player.xspeed:player.xvel=0),(Key.isDown(Key.w)||Key.isDown(Key.UP)||Key.isDown(Key.z)||Key.isDown(Key.SPACE))&&!this.jumping&&fuelTimer>0&&player.jumpCooldown<0&&(this.jumping=!0,s_jump=!0,player.jumpCooldown=5,player.yvel=-player.yspeed,p(sounds.jump,2.5,player.x.map(0,b,-1,1),!1)),player.angle-=player.xvel/30,player.jumping&&(player.angle-=player.facingLeft?-player.yvel/30:player.yvel/30),player.jumpCooldown--,player.yvel>0&&ae[z+player.b.x+player.b.bottom*b]>0&&(this.jumping=!1);break;case 2:helpSection=1,player.maxXvel=150,player.minYvel=-300,player.xspeed=150,player.yspeed=260,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.facingLeft=!1,player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(this.facingLeft=!0,player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP)||Key.isDown(Key.z)||Key.isDown(Key.SPACE))&&!this.jumping&&fuelTimer>0&&(fuelTimer-=1,this.jumping=!0,s_jump=!0,player.yvel=-player.yspeed,p(sounds.jump,2.5,player.x.map(0,b,-1,1),!1));break;case 3:if(player.maxXvel=150,player.minYvel=-300,player.xspeed=150,player.yspeed=270,helpSection=2,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.facingLeft=!1,player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(this.facingLeft=!0,player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP)||Key.isDown(Key.SPACE)||Key.isDown(Key.z))&&!this.jumping&&fuelTimer>0&&(fuelTimer-=.7,this.jumping=!0,s_jump=!0,player.yvel=-player.yspeed,p(sounds.jump,2.5,player.x.map(0,b,-1,1),!1)),Key.isDown(Key.x)){fuelTimer-=.01,splodes.push(new q(player.x+(player.facingLeft?-16:16)+(2*Math.random()-1)|0,player.y+(15*Math.random()-8)|0,6,5)),Q=z,r(player.x+(player.facingLeft?-10:10),player.y+(20*Math.random()-15)|0,10,0);let e=5;for(;--e;)splodes.push(new q(player.x+(player.facingLeft?10*Math.random()-30:30+10*Math.random()),player.y+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),27+2*Math.random()|0,!1,!0));if(Key.isDown(Key.DOWN)||Key.isDown(Key.s)){splodes.push(new q(player.x+(15*Math.random()-8)|0,player.y+16+(2*Math.random()-1)|0,6,5)),Q=z,r(player.x+(20*Math.random()-15)|0,player.y+10,10,0);let e=5;for(;--e;)splodes.push(new q(player.x+10*Math.random(),player.y+30+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),27+2*Math.random()|0,!1,!0))}player.gunCooldown<0&&(player.gunCooldown=4,p(sounds.zapgun,2.5,player.x.map(0,b,-1,1),!1),R())}player.minedFuel&&(o(player.x+(player.facingLeft?-10:10),player.y-5,Ie),fuelTimer+=25,player.minedFuel=!1),player.gunCooldown--;break;case 4:if(player.maxXvel=250,player.minYvel=-290,player.xspeed=200,player.yspeed=290,fuelTimer=12e8,helpSection=3,(Key.isDown(Key.d)||Key.isDown(Key.RIGHT))&&(player.facingLeft=!1,player.xvel=player.xspeed),(Key.isDown(Key.a)||Key.isDown(Key.LEFT))&&(this.facingLeft=!0,player.xvel=-player.xspeed),(Key.isDown(Key.w)||Key.isDown(Key.UP)||Key.isDown(Key.Z)||Key.isDown(Key.SPACE))&&(player.jumping||(player.yvel+=-player.yspeed*e*5,p(sounds.jet,2.5,player.x.map(0,b,-1,1),!1))),Key.isDown(Key.x)){if(Key.isDown(Key.DOWN)||Key.isDown(Key.s)){splodes.push(new q(player.x+(15*Math.random()-8)|0,player.y+16+(2*Math.random()-1)|0,6,5)),Q=z,n(player.b.x+(player.facingLeft?-10:10),player.b.y)==Se&&(player.minedFuel=!0),r(player.x+(20*Math.random()-15)|0,player.y+10,10,0);let e=5;for(;--e;)splodes.push(new q(player.x+10*Math.random(),player.y+30+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),27+2*Math.random()|0,!1,!0))}else{fuelTimer-=.01,splodes.push(new q(player.x+(player.facingLeft?-16:16)+(2*Math.random()-1)|0,player.y+(15*Math.random()-8)|0,6,5)),Q=z,n(player.b.x+(player.facingLeft?-10:10),player.b.y)==Se&&(player.minedFuel=!0),r(player.x+(player.facingLeft?-10:10),player.y+(20*Math.random()-15)|0,10,0);let e=5;for(;--e;)splodes.push(new q(player.x+(player.facingLeft?10*Math.random()-30:30+10*Math.random()),player.y+20*Math.random()-10,10+10*Math.random()-5,3*Math.random(),27+2*Math.random()|0,!1,!0))}player.gunCooldown<0&&(player.gunCooldown=4,p(sounds.zapgun,2.5,player.x.map(0,b,-1,1),!1),R())}player.gunCooldown--}player.x>b&&(player.x=16,w(ve)),player.x<0&&(player.x=b-16,w(he)),player.y>A&&(player.y=16,w(we)),player.y<0&&(player.y=A-16,w(ge))},draw(e){switch(player.mode){case 1:V=P,u(0,0,32,32,player.x,player.y,1,player.angle);break;case 2:V=P,d(32,0,32,32,player.b.x+2-16,player.b.y+5-20),d(0,0,32,32,player.b.x-16,player.b.y-20,player.facingLeft);break;case 3:V=P,d(32,0,32,32,player.b.x+2-16,player.b.y+5-20),d(96,0,32,32,player.b.x+5-16+(this.facingLeft?-12:0),player.b.y+3-20,this.facingLeft),d(0,0,32,32,player.b.x-16,player.b.y-20,player.facingLeft);break;case 4:V=P,d(128,0,32,40,player.b.x+5-16,player.b.y+4-20),d(32,0,32,32,player.b.x+2-16,player.b.y+5-20),d(64,0,32,32,player.b.x+5-16,player.b.y+4-20),d(96,0,32,32,player.b.x+5-16+(this.facingLeft?-12:0),player.b.y+3-20,this.facingLeft),d(0,0,32,32,player.b.x-16,player.b.y-20,player.facingLeft)}},collides(){this.b.x+this.hitRadius>=b-1&&player.xvel>0&&(this.x=b+1);for(var e=-this.hitRadius;e<this.hitRadius;e++)for(var t=-this.hitRadius;t<this.hitRadius;t++){let o=ae[z+(this.b.x+e)+(this.b.y+t)*b];if(o==Re||o==Me||o==Se)return!0}return!1},overlaps(){for(var e=-this.radius;e<this.radius;e++)for(var t=2*-this.radius;t<this.radius;t++){let o=ae[z+(this.b.x+e)+(this.b.y+t)*b];if(o)return{x:this.b.x+e,y:this.b.y+t,o:o}}return!1},updateB(){this.b={left:this.x-this.hitRadius|0,right:this.x+this.hitRadius|0,top:this.y-this.hitRadius|0,bottom:this.y+this.hitRadius|0,width:2*this.hitRadius,height:2*this.hitRadius,x:0|this.x,y:0|this.y}},collideResolution(e){Q=z,i(player.x-32,player.y-32,64,64,0),R()},overlapResolution(e){let t=player.overlaps();switch(t.o){case Ie:Q=z,ae[z+t.x+t.y*b],r(t.x,t.y,3,0),Q=F,splodes.push(new q(t.x,t.y)),p(sounds.fuelget,2,player.x.map(0,b,-1,1),!1);let e=10;for(;--e;)splodes.push(new q(192+50*Math.random()-25,14+4*Math.random()-2,10+4*Math.random()-2,10+4*Math.random()-2,2*Math.random()-1+9|0,!1,!0));fuelTimer+=25;break;case Ne:1==player.mode&&(ae[z+t.x+t.y*b],Q=z,r(t.x,t.y,3,0),Q=F,player.mode=2,messages.push(new T("AUX BOOSTERS ACQUIRED. ENERGY CAPACITY INCREASED.")),p(sounds.fuelget,1,player.x.map(0,b,-1,1),!1));break;case Ee:2==player.mode&&(ae[z+t.x+t.y*b],Q=z,r(t.x,t.y,3,0),Q=F,player.mode=3,p(sounds.fuelget,1,player.x.map(0,b,-1,1),!1),messages.push(new T("DISINTIGRATE TOOL ACQUIRED. PRESS X TO USE")));break;case Ge:3==player.mode&&(ae[z+t.x+t.y*b],Q=z,r(t.x,t.y,3,0),Q=F,player.mode=4,p(sounds.fuelget,1,player.x.map(0,b,-1,1),!1),messages.push(new T("WHERE WE ARE GOING, WE DONT NEED WHEELS")))}}},q.prototype.draw=function(e){if(++this.size>this.maxSize)return splodes.splice(e,1);this.square?this.filled?i(this.x-this.size/2,this.y-this.size/2,this.size,this.size,this.color):function(e,t,o,n,s){x1=0|e,y1=0|t,x2=e+o|0,y2=t+n|0,a(x1,y1,x2,y1,s),a(x2,y1,x2,y2,s),a(x1,y2,x2,y2,s),a(x1,y1,x1,y2,s)}(this.x-this.size/2,this.y-this.size/2,this.size,this.size,this.color):this.filled?r(this.x,this.y,this.size,this.color):s(this.x,this.y,this.size,this.color),0==--this.counter&&(this.size++,this.counter=this.speed)},T.prototype.draw=function(e){if(Q=C,this.time--,this.counter+=2,this.time<0)return messages.splice(e,1);this.string=this.text.substring(0,this.counter),K(credits?[this.string,b/2,40+22*e,2,2,"center","top",2,8]:[this.string,b/2,20+12*e,2,2,"center","top",1,this.color]),K([this.string,b/2,20+12*e,2,2,"center","top",1,this.color])},states.gameover={step:function(e){Key.isDown(Key.r)&&(state="menu")},render:function(t){Q=0,e(0),K(["CRITICAL SYSTEM\nFAILURE",192,80,8,15,"center","top",3,27])}},states.menu={step:function(e){if(s_titleSong||(titleSong=p(sounds.titleMusic,1,0,!0),s_titleSong=!0),Key.justReleased(Key.p)){let e=10;for(;e--;)splodes.push(new q(player.x+40*Math.random()-20,player.y+40*Math.random()-20,200,1,5)),splodes.push(new q(player.x+40*Math.random()-20,player.y+40*Math.random()-20,200,1,8)),splodes.push(new q(player.x+40*Math.random()-20,player.y+40*Math.random()-20,32,1,21,!0)),splodes.push(new q(player.x+40*Math.random()-20,player.y+40*Math.random()-20,25,1,0,!0));p(sounds.boom,1,player.x.map(0,b,-1,1),!1),w(),state="game",titleSong.sound.stop()}},render:function(n){for(Q=z,e(0),Q=0,e(0),Q=F,e(0),Q=B,e(0),Q=C,e(0),Q=z,i(0,128,b,10,2),K(["GREEBLE",b/2,50,14,20,"center","top",7,2]),Q=F,V=z,d(),Q=U,lcg.setSeed(21),a=6e3;--a;){let e=lcg.nextIntRange(0,b),t=lcg.nextIntRange(0,A);ae[z+e+t*b]&&i(e+lcg.nextIntRange(-2,2),t+lcg.nextIntRange(-1,1),1,lcg.nextIntRange(0,3),lcg.nextIntRange(24,25))}c(U,B,25,20,23,18),Q=F,V=U,d(),V=B,d(),Q=U,lcg.setSeed(20);for(var a=6e3;--a;){let e=lcg.nextIntRange(0,b),t=lcg.nextIntRange(0,A);ae[z+e+t*b]&&i(e+lcg.nextIntRange(-1,1),t+lcg.nextIntRange(0,1),lcg.nextIntRange(1,5),1,lcg.nextIntRange(22,24))}c(U,B,25,20,23,18),Q=F,V=U,d(),V=B,d(),V=P;let s=15;for(;--s;)d(160,0,32,40,(32*s+16*t|0)%b,90),(32*s+16*t|0)%b==b-1&&(splodes.push(new q(16,100)),splodes.push(new q(16,116)));for(K(["PRESS P TO CONTINUE",b/2,230,2,2,"center","top",1,21]),Q=C,r=8e3;--r;)o((lcg.nextIntRange(0,384)+10*t|0)%384,lcg.nextIntRange(0,256),1);for(r=400;--r;)o((lcg.nextIntRange(0,384)+20*t|0)%384,lcg.nextIntRange(0,256),26);for(var r=100;--r;)o((lcg.nextIntRange(0,384)+30*t|0)%384,lcg.nextIntRange(0,256),21);c(F,C,15),V=F,d(),splodes.forEach((function(e,t,o){e.draw(t)}))}},states.game={messageDelay:240,messageIndex:0,helpLoops:[["CRITICAL SYSTEM FAILURE IMMINENT.","FIND FUEL SOURCE.","AUX JETS OFFLINE. HOLD LEFT/RIGHT\nTAP JUMP TO MOVE"],["FIND MORE FUEL","SEEK OUT REMAINING BODY COMPONENTS"],["DISINTEGRATOR ONLINE. PRESS X TO USE","FIND MISSING COMPONENTS TO INCREASE MOBILITY","PRESS DOWN WHILE USING TO DIG DOWNWARD"],["THRUSTERS ONLINE. FUSION REACTOR ONLINE."],["OOH YOU FOUND A SECRET","...","THANKS FOR PLAYING GREEBLE","A JS13K 2017 ENTRY BY RYAN MALM","SHOUT OUT TO A FEW CODERS...","TRASEVOL DOG \nYOU ARE AN INSPIRATION","XEM, CANTELOPE, P01, XEN\nJS GOLFERS EXTROARDINAIRE"]],step(e){credits&&(helpSection=4),s_gameSong||(s_gameSong=!0,gamesong=p(sounds.gameMusic,1,0,!0)),Key.isDown(Key.r)&&(player.init(),state="menu"),player.update(e),fuelTimer-=e,fuelTimer>200&&!gotFirst200&&(gotFirst200=!0,helpSection=1),credits&&(helpSection=4),--this.messageDelay<0&&(messages.push(new T(this.helpLoops[helpSection][this.messageIndex],fuelTimer<50?27:9,240)),this.messageDelay=240,++this.messageIndex>this.helpLoops[helpSection].length&&(this.messageIndex=0))},render(t){if(Q=C,e(0),V=H,d(),M(),Q=F,e(0),I(),V=j,d(),player.draw(),V=Y,d(),Q=C,fuelTimer>0){if(fuelTimer>15)V=F,d();else if(Math.random()>fuelTimer/15){Q=C,e(0);let t=1e3;for(;t--;)o(Math.random()*b,Math.random()*A,27);for(t=6e3;t--;){let e=Math.random()*b,t=Math.random()*A;o(e,t,ae[F+e+t*b]>0?28:0)}}}else gamesong.sound.stop(),state="gameover";Q=C,4==player.mode?(fueltext="INFINITE",fuelcolor=19):(fueltext=fuelTimer.toFixed(2).toString(),fuelcolor=fuelTimer<150?27:10),K([fueltext,b/2,10,2,2,"center","top",1,fuelcolor]),splodes.forEach((function(e,t,o){e.draw(t)})),messages.forEach((function(e,t,o){e.draw(t)}))}},states.loading={init:function(e){var t=new ue.MusicGenerator(re);t.createAudioBuffer((function(e){sounds.titleMusic=e,soundsLoaded++})),(t=new ue.MusicGenerator(ie)).createAudioBuffer((function(e){sounds.gameMusic=e,soundsLoaded++})),(t=new ue.MusicGenerator(fe)).createAudioBuffer((function(e){sounds.zapgun=e,soundsLoaded++})),(t=new ue.MusicGenerator(ce)).createAudioBuffer((function(e){sounds.fuelget=e,soundsLoaded++}));var o=new ue.SoundGenerator(le);o.createAudioBuffer(147,(function(e){me.createBufferSource(),sounds.jump=e,soundsLoaded++})),(o=new ue.SoundGenerator(_e)).createAudioBuffer(147,(function(e){me.createBufferSource(),sounds.boom=e,soundsLoaded++})),(o=new ue.SoundGenerator(de)).createAudioBuffer(147,(function(e){me.createBufferSource(),sounds.step=e,soundsLoaded++})),(o=new ue.SoundGenerator(se)).createAudioBuffer(130,(function(e){me.createBufferSource(),sounds.jet=e,soundsLoaded++}))},step:function(e){Key.justReleased(Key.z)&&soundsLoaded==totalSounds&&(state="menu"),--tCounter<0&&soundsLoaded!=totalSounds&&(tCounter=9,splodes.push(new q(b/2+100*Math.cos(t),A/2+70*Math.sin(t),300,1,12)))},render:function(o){Q=C,e(0),soundsLoaded!=totalSounds?(Q=C,e(0),splodes.forEach((function(e){e.draw()})),K(["LOADING...",b/2,128+20*Math.sin(t),3,2,"center","top",3,9])):(splodes.forEach((function(e){e.draw()})),K(["HEADPHONES RECOMMENDED.\nPRESS Z TO CONTINUE",b/2,128+20*Math.sin(t),2,10,"center","top",2,9]))}},Key={_pressed:{},_released:{},LEFT:37,UP:38,RIGHT:39,DOWN:40,SPACE:32,ONE:49,TWO:50,THREE:51,FOUR:52,a:65,c:67,w:87,s:83,d:68,z:90,x:88,f:70,p:80,r:82,isDown(e){return this._pressed[e]},justReleased(e){return this._released[e]},onKeydown(e){this._pressed[e.keyCode]=!0},onKeyup(e){this._released[e.keyCode]=!0,delete this._pressed[e.keyCode]},update(){this._released={}}},window.onload=init()}()</script>