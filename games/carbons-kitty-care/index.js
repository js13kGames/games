window.addEventListener("load",function(){gameResize(),document.querySelector(".start-box").style.display="block",document.querySelector(".start-box").onclick=function(){gameStarted=!0,playSound(lickSound,.27),loadGame(),document.querySelector(".start-box").style.display="none"},window.onkeydown=function(e){gameStarted||" "!=e.key||(gameStarted=!0,playSound(lickSound,.27),loadGame(),document.querySelector(".start-box").style.display="none")},document.querySelector(".start-box").ontouchmove=function(){gameStarted=!0,playSound(lickSound,.27),loadGame(),document.querySelector(".start-box").style.display="none"}},!1),window.addEventListener("resize",function(){gameResize()},!1),window.addEventListener("keyup",mapKeyUp,!1),window.addEventListener("keydown",mapKeyDown,!1),window.addEventListener("keydown",function(e){[" ","ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].indexOf(e.key)>-1&&e.preventDefault()},!1);var gameloop,A,A2,gameStarted=!1,skipInstructions=!1,dom=document.querySelector(".game").innerHTML,time=0,timePrev=0,toggleOnscreenControls=!0,skullEmoji="😴",shelves=[],angle=0,x_velocity=0,y_velocity=0,x_translation=5,y_translation=-25,map={},freeze_controls=!1,speedCoefficient=3,crateMounted=100,previousCrateMounted=100,reverse=!1,actor_in_shelf=!1,hit_points=100,damage_per_hit=.15,damage_while_running=.025,showColors=!1,posX=[],valX=0,combinations=[],aw=0,crates=[],crateColors=[],cratesShelvedCount=0,gameOver=!1;function instantiateGame(e,t,o,n,s,r,a,l){shelves=[],angle=l,x_velocity=n,y_velocity=s,x_translation=r,y_translation=a,map={},freeze_controls=!1,speedCoefficient=3,crateMounted=100,previousCrateMounted=100,reverse=!1,actor_in_shelf=!1,hit_points=o,damage_per_hit=.15,damage_while_running=.02,showColors=!1,posX=[],valX=0,combinations=[],aw=0,crates=[],crateColors=[],level=e,cratesShelvedCount=0,gameOver=!1,document.querySelector(".game").innerHTML=dom,document.querySelector(".level-indicator").innerHTML="Litter "+level,1==toggleOnscreenControls?(document.querySelector(".mobile-controls-all").style.display="block",document.querySelector(".toggle-onscreen-controls").style.color="#c3c3c3"):(document.querySelector(".mobile-controls-all").style.display="none",document.querySelector(".toggle-onscreen-controls").style.color="#5d5d5d"),level,2==level&&playSound(startLevel2Sound,.27),3==level&&playSound(startLevel3Sound,.27),4==level&&playSound(startLevel4Sound,.27),5==level&&playSound(startLevel5Sound,.27),mobile_controls(),createCrates(t),game()}function tableCreate(){var e=document.querySelector(".game"),t=document.createElement("table");t.style.width="100%",t.style.height="100%",t.style.backgroundColor="#20212aff",t.style.opacity="1",t.style.borderSpacing="25px 90px";var o=document.createElement("tbody");shelvesCtr=0;for(var n=0;n<5;n++){for(var s=document.createElement("tr"),r=0;r<10;r++)shelves[shelvesCtr]=new shelf(s,n,r,shelvesCtr),shelvesCtr++;o.appendChild(s)}shelves_odd=[],shelves.forEach(function(e){e.ctr%2!=0&&shelves_odd.push(e)}),shelves=shuffle(shelves_odd).slice(0,crates.length),t.appendChild(o),e.appendChild(t);for(var a=0,l=0;l<5;l++)for(var i=0;i<10;i++)shelf_id="r"+l+"c"+i,shelves.forEach(function(e){e.shelfID==shelf_id&&(0!=a&&4!=a&&8!=a&&12!=a&&16!=a&&20!=a&&24!=a||(document.querySelector("#"+shelf_id).style.backgroundColor="rgba(255,0,0,1)",e.color="rgba(255,0,0,1)"),1!=a&&5!=a&&9!=a&&13!=a&&17!=a&&21!=a||(document.querySelector("#"+shelf_id).style.backgroundColor="rgba(0,128,0,1)",e.color="rgba(0,128,0,1)"),2!=a&&6!=a&&10!=a&&14!=a&&18!=a&&22!=a||(document.querySelector("#"+shelf_id).style.backgroundColor="rgba(0,0,255,1)",e.color="rgba(0,0,255,1)"),3!=a&&7!=a&&11!=a&&15!=a&&19!=a&&23!=a||(document.querySelector("#"+shelf_id).style.backgroundColor="rgba(255,255,0,1)",e.color="rgba(255,255,0,1)"),a++)})}function shelf(e,t,o,n){var s=document.createElement("td");this.shelfID="r"+t+"c"+o,this.color="",this.locked=!1,this.ctr=n,s.setAttribute("id",this.shelfID),s.appendChild(document.createTextNode("")),s.style.opacity=".6",s.style.borderRadius="20px",e.appendChild(s)}function game(){tableCreate(),gameloop=window.setInterval(function(){go(),actorToShelfCollision(),actorToBoundaryCollision(),relocate_crate()},10)}function gameStartShowHideColors(e){showColors=!0,window.setTimeout(function(){showColors=!1},e)}function gameResize(){window.innerWidth>window.innerHeight?document.querySelector(".game").style.scale=window.innerHeight/1e3:document.querySelector(".game").style.scale=window.innerWidth/1e3}function gameOverInstantiate(){instructions_timeouts.forEach(function(e){clearTimeout(e)}),clearInterval(gameloop),clearTimeout(next_level_instance),gameOver=!0,window.setTimeout(function(){instantiateGame(1,3,100,0,0,5,-25,0),playSound(startLevel1Sound,.27)},5e3)}function go(){time+=.01,document.querySelector(".hit-bar").style.backgroundColor=`hsl(${hit_points}, 70%, 35%)`,document.querySelector(".hit-bar").style.width=hit_points+"%",keycodes=[" ","arrowleft","arrowup","arrowright","arrowdown","a","d","s","w"];for(var e=0;e<=8;e++)"arrowright"!=keycodes[e]&&"d"!=keycodes[e]||1==map[keycodes[e]]&&(angle=(angle-1*speedCoefficient)%360),"arrowleft"!=keycodes[e]&&"a"!=keycodes[e]||1==map[keycodes[e]]&&(angle=(angle+1*speedCoefficient)%360),"arrowup"!=keycodes[e]&&"w"!=keycodes[e]&&" "!=keycodes[e]||1==map[keycodes[e]]&&(reverse=!1,x_translation-=x_velocity,y_translation-=y_velocity,hit_points>0&&(hit_points-=damage_while_running),hit_points<=0&&0==gameOver&&(showMessage("Whoops..Carbon fell asleep "+skullEmoji+"</br></br>taking a power nap...",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"arrowdown"!=keycodes[e]&&"s"!=keycodes[e]||1==map[keycodes[e]]&&(100!=crateMounted&&(crates[crateMounted].mount=!1,crates[crateMounted].left_new=x_translation+17,crates[crateMounted].top_new=y_translation+790,previousCrateMounted=crateMounted,crateMounted=100,document.querySelector(".forklift").style.top="-12.5px",playSound(dropCrateSound,.26)),reverse=!0,x_translation+=x_velocity,y_translation+=y_velocity);x_velocity=speedCoefficient*Math.cos((90-angle)/(180/Math.PI)),y_velocity=speedCoefficient*Math.cos(angle/(180/Math.PI)),document.querySelector(".actor .rotator").style.transform="rotate3d(0,0,1,"+-1*angle+"deg)",document.querySelector(".actor").style.transform="translate3d("+x_translation+"px, "+y_translation+"px, 0px)",document.querySelector(".face-cat").innerHTML=hit_points>60?"•˕•":hit_points>30?"ˑ˕ˑ":hit_points>0?"¯˕¯":"ˣ˕ˣ"}function shuffle(e){let t,o=e.length;for(;0!=o;)t=Math.floor(Math.random()*o),o--,[e[o],e[t]]=[e[t],e[o]];return e}function actorToShelfCollision(){document.querySelector(".actor");for(var e=document.querySelector(".actor").getBoundingClientRect().top,t=document.querySelector(".actor").getBoundingClientRect().bottom,o=document.querySelector(".actor").getBoundingClientRect().left,n=document.querySelector(".actor").getBoundingClientRect().right,s=0;s<shelves.length;s++){var r=document.querySelector("#"+shelves[s].shelfID),a=r.getBoundingClientRect().top,l=r.getBoundingClientRect().bottom,i=r.getBoundingClientRect().left,c=r.getBoundingClientRect().right;function d(d){o<c&&n>c&&(e>a&&t<l||e>a&&e<l||t<l&&t>a)&&("matched"==d&&(x_translation-=3),"not matched"==d&&(x_translation+=5,hit_points>0&&(hit_points-=damage_per_hit,playSound2(hitSound,.23)),hit_points<=0&&0==gameOver&&(showMessage("Dang..Carbon fell asleep "+skullEmoji+"</br></br>taking a power nap...",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"locked"==d&&(x_translation+=5,hit_points>0&&(hit_points-=damage_per_hit,playSound2(hitSound,.23)),hit_points<=0&&0==gameOver&&(showMessage("Oh no..Carbon fell asleep "+skullEmoji+"</br></br>taking a power nap...",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"no crate"==d&&(r.style.backgroundColor=shelves[s].color,x_translation+=1,actor_in_shelf=!1),"has crate"==d&&(r.style.backgroundColor=shelves[s].color)),n>i&&o<i&&(e>a&&t<l||e>a&&e<l||t<l&&t>a)&&("matched"==d&&(x_translation+=3),"not matched"==d&&(x_translation-=5,hit_points>0&&(hit_points-=damage_per_hit,playSound2(hitSound,.23)),hit_points<=0&&0==gameOver&&(showMessage("Welp..Carbon fell asleep "+skullEmoji+"</br></br>taking a power nap...",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"locked"==d&&(x_translation-=5,hit_points>0&&(hit_points-=damage_per_hit,playSound2(hitSound,.23)),hit_points<=0&&0==gameOver&&(showMessage("Oh dear..Carbon fell asleep "+skullEmoji+"</br></br>taking a power nap...",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"no crate"==d&&(r.style.backgroundColor=shelves[s].color,x_translation-=1,actor_in_shelf=!1),"has crate"==d&&(r.style.backgroundColor=shelves[s].color)),t>a&&e<a&&o>i&&n<c&&("matched"==d&&(y_translation+=3),"not matched"==d&&(y_translation-=5,hit_points>0&&(hit_points-=damage_per_hit,playSound2(hitSound,.23)),hit_points<=0&&0==gameOver&&(showMessage("Whoops..Carbon fell asleep "+skullEmoji+"</br></br>taking a power nap...",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"locked"==d&&(y_translation-=5,hit_points>0&&(hit_points-=damage_per_hit,playSound2(hitSound,.23)),hit_points<=0&&0==gameOver&&(showMessage("Dang..Carbon fell asleep "+skullEmoji+"</br></br>taking a power nap...",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"no crate"==d&&(r.style.backgroundColor=shelves[s].color,y_translation-=1,actor_in_shelf=!1),"has crate"==d&&(r.style.backgroundColor=shelves[s].color)),e<l&&t>l&&o>i&&n<c&&("matched"==d&&(y_translation-=3),"not matched"==d&&(y_translation+=5,hit_points>0&&(hit_points-=damage_per_hit,playSound2(hitSound,.23)),hit_points<=0&&0==gameOver&&(showMessage("Oh no..Carbon fell asleep "+skullEmoji+"</br></br>taking a power nap...",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"locked"==d&&(y_translation+=5,hit_points>0&&(hit_points-=damage_per_hit,playSound2(hitSound,.23)),hit_points<=0&&0==gameOver&&(showMessage("Welp..you kinda died. "+skullEmoji+"</br></br>Simulator will reset in a bit",5e3),gameOverInstantiate(),playSound(deathSound,.27))),"no crate"==d&&(r.style.backgroundColor=shelves[s].color,y_translation+=1,actor_in_shelf=!1),"has crate"==d&&(r.style.backgroundColor=shelves[s].color))}if(r.style.backgroundColor=0==showColors?"#04050D":shelves[s].color,100!=crateMounted&&crates[crateMounted].color==shelves[s].color&&0==shelves[s].locked&&(d("matched"),o<c&&n<c&&n>i&&o>i&&e>a&&t<l&&t>a&&e>a)){if(o-i<c-n?x_translation+=1:o-i>c-n?x_translation-=1:e-a<l-t?y_translation+=1:e-a>l-t&&(y_translation-=1),crates[crateMounted].mount=!1,previousCrateMounted=crateMounted,crateMounted=100,document.querySelector(".forklift").style.top="-12.5px",playSound(shelfCrateSound,.265),hit_points<75?hit_points+=15:hit_points=100,cratesShelvedCount++,1==level&&3==cratesShelvedCount&&(showMessage("Litter 1 cleared in</br>"+parseInt(time).toString()+" seconds!</br></br>Get ready for the next litter.</br></br>Hint: press <span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>W</span> and the up <span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>↑</span> key at the same time for a boost",6e3),instructions_timeouts.forEach(function(e){clearTimeout(e)}),timePrev+=time,clearTimeout(next_level_instance),playSound(endLevel1Sound,.27),next_level_instance=window.setTimeout(function(){clearInterval(gameloop),instantiateGame(2,7,hit_points,x_velocity,y_velocity,x_translation,y_translation,angle),gameStartShowHideColors(2e3),time=0},6e3)),2==level&&7==cratesShelvedCount&&(showMessage("Litter 2 cleared in</br>"+parseInt(time).toString()+" seconds!</br></br>Get ready for the next litter.",5e3),timePrev+=time,clearTimeout(next_level_instance),playSound(endLevel2Sound,.27),next_level_instance=window.setTimeout(function(){clearInterval(gameloop),instantiateGame(3,12,hit_points,x_velocity,y_velocity,x_translation,y_translation,angle),gameStartShowHideColors(3e3),time=0},5e3)),3==level&&12==cratesShelvedCount&&(showMessage("Litter 3 cleared in</br>"+parseInt(time).toString()+" seconds!</br></br>Get ready for the next litter.",5e3),timePrev+=time,clearTimeout(next_level_instance),playSound(endLevel3Sound,.27),next_level_instance=window.setTimeout(function(){clearInterval(gameloop),instantiateGame(4,18,hit_points,x_velocity,y_velocity,x_translation,y_translation,angle),gameStartShowHideColors(4e3),time=0},5e3)),4==level&&18==cratesShelvedCount&&(timePrev+=time,clearTimeout(next_level_instance),playSound(endLevel4Sound,.27),showMessage("Litter 4 cleared in</br>"+parseInt(time).toString()+" seconds!</br></br>Get ready for the final litter.",5e3),next_level_instance=window.setTimeout(function(){clearInterval(gameloop),instantiateGame(5,25,hit_points,x_velocity,y_velocity,x_translation,y_translation,angle),gameStartShowHideColors(5e3),time=0},5e3)),5==level&&25==cratesShelvedCount){timePrev+=time,clearTimeout(next_level_instance),showMessage("🏅🥇</br></br><b>You are now a certified Kitty Care Assistant!</b></br></br> Litter 5 cleared in "+parseInt(time).toString()+" seconds</br>All litters cleared in "+parseInt(timePrev/60).toString()+" minutes!</br></br>Enjoyed this game? Share the link with your friends!",15e3),document.querySelector(".instructions-progress").style.width="100%",document.querySelector(".instructions-progress").style.display="block",document.querySelector(".instructions-progress").style.animation="beacon 2.5s infinite",hit_points=100,time=0,playSound(gameCompleteSound,.27);for(var u=0;u<crates.length;u++)document.querySelector("#el"+u).style.animation="glow 1s infinite"}var p=document.querySelector("#el"+previousCrateMounted),m=r.offsetLeft-parseInt(p.style.left.replace("px",""))+12.75,y=r.offsetTop-parseInt(p.style.top.replace("px",""))+12.75;p.style.transform="translate3d("+m+"px, "+y+"px, 0px) rotate3d(0,0,1,0deg)",p.style.opacity="1",p.style.animation="",shelves[s].locked=!0,crates[previousCrateMounted].shelved=!0,r.style.backgroundColor=shelves[s].color,actor_in_shelf=!0}100!=crateMounted&&crates[crateMounted].color!=shelves[s].color&&d("not matched"),d(100==crateMounted?"no crate":"has crate"),1==shelves[s].locked&&100!=crateMounted&&d("locked")}}function actorToBoundaryCollision(){document.querySelector(".actor");var e=document.querySelector(".actor").getBoundingClientRect().top,t=document.querySelector(".actor").getBoundingClientRect().bottom,o=document.querySelector(".actor").getBoundingClientRect().left,n=document.querySelector(".actor").getBoundingClientRect().right,s=document.querySelector(".game").offsetWidth,r=document.querySelector(".game").offsetHeight,a=document.querySelector(".game").getBoundingClientRect().left,l=document.querySelector(".game").getBoundingClientRect().right,i=document.querySelector(".game").getBoundingClientRect().top,c=document.querySelector(".game").getBoundingClientRect().bottom;a>=o&&(x_translation+=s-50),Math.abs(o-a)<=10&&Math.abs(t-c)<=10&&(x_translation+=s-50,y_translation+=-(r-50)),l<=n&&(x_translation+=-(s-50)),Math.abs(n-l)<=10&&Math.abs(t-c)<=10&&(x_translation-=s-50,y_translation-=r-50),i>=e&&(y_translation+=r-50),Math.abs(n-l)<=10&&Math.abs(e-i)<=10&&(x_translation+=s-50,y_translation+=r-50),Math.abs(o-a)<=10&&Math.abs(e-i)<=10&&(x_translation+=s-50,y_translation+=r-50),c<=t&&(y_translation+=-(r-45))}function mapKeyDown(e){map[e.key.toLowerCase()]=!0}function mapKeyUp(e){map[e.key.toLowerCase()]=!1}function crate(e){this.neutral=!1,this.ctr=e,this.top=combinations[e][0],this.left=combinations[e][1],this.width=25,this.height=25,this.x_translate=0,this.y_translate=0,this.content='<span class="ears-kitten">&#92;</span><span class="whiskers-kitten">></span><span class="face-kitten">•˕•</span><span class="whiskers-kitten"><</span><span class="ears-kitten">/</span>',this.id="el"+e,this.class="crate",this.rotateBy=0,this.mount=!1,this.shelved=!1,this.top_new=0,this.left_new=0,0!=e&&4!=e&&8!=e&&12!=e&&16!=e&&20!=e&&24!=e||(this.backgroundColor="rgba(255,0,0,0.25)",this.color="rgba(255,0,0,1)"),1!=e&&5!=e&&9!=e&&13!=e&&17!=e&&21!=e||(this.backgroundColor="rgba(0,128,0,0.25)",this.color="rgba(0,128,0,1)"),2!=e&&6!=e&&10!=e&&14!=e&&18!=e&&22!=e||(this.backgroundColor="rgba(0,0,255,0.25)",this.color="rgba(0,0,255,1)"),3!=e&&7!=e&&11!=e&&15!=e&&19!=e&&23!=e||(this.backgroundColor="rgba(255,255,0,0.25)",this.color="rgba(255,255,0,1)"),crateColors.push(this.color);var t=document.createElement("span");t.setAttribute("class",this.class),t.setAttribute("id",this.id),t.setAttribute("style","width: "+this.width+"px; height: "+this.height+"px; position: absolute; top: "+this.top+"px; left: "+this.left+"px; z-index: 99"),this.top_new=this.top,this.left_new=this.left,t.innerHTML=this.content,document.querySelector(".game").insertBefore(t,document.querySelector(".actor"))}function createCrates(e){for(t=0;valX<=7500;t++)posX[t]=valX,valX+=75;for(ctra=1;ctra<=9;ctra++)for(ctrb=2;ctrb<=9;ctrb++)combinations[aw]=[posX[ctra],posX[ctrb]],aw++;shuffle(combinations);for(var t=0;t<=e-1;t++)crates[t]=new crate(t)}function relocate_crate(){for(var e=0;e<crates.length;e++){var t=document.querySelector(".actor"),o=(t.offsetWidth,t.offsetHeight,t.offsetLeft,t.offsetTop,document.querySelector(".actor").getBoundingClientRect().top),n=(document.querySelector(".actor").getBoundingClientRect().bottom,document.querySelector(".actor").getBoundingClientRect().left),s=(document.querySelector(".actor").getBoundingClientRect().right,document.querySelector("#el"+e)),r=(s.offsetWidth,s.offsetHeight,s.style.left,s.style.top,s.getBoundingClientRect().top),a=s.getBoundingClientRect().left,l=s.getBoundingClientRect().right,i=s.getBoundingClientRect().bottom,c=document.querySelector(".game").getBoundingClientRect().left,d=document.querySelector(".game").getBoundingClientRect().right,u=document.querySelector(".game").getBoundingClientRect().top,p=document.querySelector(".game").getBoundingClientRect().bottom,m=document.querySelector(".game").offsetWidth,y=document.querySelector(".game").offsetHeight,h=100,g=1.1;const b=a-n,f=r-o;function v(e){if("string"!=typeof e||""===e)return[0,0];const t=e.match(/translate3d\(([-\d.]+)px,\s*([-\d.]+)px(?:,\s*([-\d.]+)px)?\)/);if(!t)return[0,0];return[parseFloat(t[1]),parseFloat(t[2])]}crates[e].x_translate=x_translation-crates[e].left_new+17,crates[e].y_translate=y_translation-crates[e].top_new+790,relocate_x=x_translation-parseInt(s.style.left.replace("px",""))+17,relocate_y=y_translation-parseInt(s.style.top.replace("px",""))+790;let[S,_]=v(s.style.transform);Math.abs(crates[e].x_translate)<=20&&Math.abs(crates[e].y_translate)<=20&&0==crates[e].neutral&&100==crateMounted&&0==crates[e].mount&&0==reverse&&0==crates[e].shelved&&0==actor_in_shelf?(crateMounted=e,crates[e].mount=!0,playSound(loadCrateSound,.26)):Math.abs(crates[e].x_translate)<=100&&Math.abs(crates[e].y_translate)<=100&&0==crates[e].neutral&&100==crateMounted&&0==crates[e].mount&&0==reverse&&0==crates[e].shelved&&0==actor_in_shelf?c>=a||d<=l||u>=r||p<=i?(c>=a&&(console.log("left bdy"),s.style.transform=`translate3d(${S+(m-50)}px, ${_}px, 0px)`,crates[e].x_translate+=m-50,crates[e].left_new+=m-50),d<=l&&(console.log("right bdy"),s.style.transform=`translate3d(${S-(m-50)}px, ${_}px, 0px)`,crates[e].x_translate+=-(m-50),crates[e].left_new+=-(m-50)),u>=r&&(console.log("top bdy"),s.style.transform=`translate3d(${S}px, ${_+(y-50)}px, 0px)`,crates[e].y_translate+=y-50,crates[e].top_new+=y-50),p<=i&&(console.log("bottom bdy"),s.style.transform=`translate3d(${S}px, ${_-(y-50)}px, 0px)`,crates[e].y_translate+=-(y-50),crates[e].top_new+=-(y-50)),Math.abs(l-d)<=10&&Math.abs(i-p)<=10&&(console.log("bottom right bdy"),s.style.transform=`translate3d(${S-(m-50)}px, ${_-(y-50)}px, 0px)`,crates[e].x_translate=50,crates[e].left_new=50,crates[e].y_translate=50,crates[e].top_new=50),Math.abs(a-c)<=10&&Math.abs(i-p)<=10&&(console.log("bottom left bdy"),s.style.transform=`translate3d(${S+(m-50)}px, ${_-(y-50)}px, 0px)`,crates[e].y_translate=50,crates[e].top_new=50,crates[e].x_translate=m-50,crates[e].left_new=m-50),Math.abs(l-d)<=10&&Math.abs(r-u)<=10&&(console.log("top right bdy"),s.style.transform=`translate3d(${S-(m-50)}px, ${_+(y-50)}px, 0px)`,crates[e].y_translate=y-50,crates[e].top_new=y-50,crates[e].x_translate=50,crates[e].left_new=50),Math.abs(a-c)<=10&&Math.abs(r-u)<=10&&(console.log("top left bdy"),s.style.transform=`translate3d(${S+(m-50)}px, ${_+(y-50)}px, 0px)`,crates[e].x_translate=m-50,crates[e].left_new=m-50,crates[e].y_translate=y-50,crates[e].top_new=y-50)):b<0&&Math.abs(b)<h&&f<0&&Math.abs(f)<h?(s.style.transform=`translate3d(${S-g}px, ${_-g}px, 0px)`,crates[e].x_translate-=g,crates[e].y_translate-=g,crates[e].left_new-=g,crates[e].top_new-=g):b>0&&b<h&&f>0&&f<h?(s.style.transform=`translate3d(${S+g}px, ${_+g}px, 0px)`,crates[e].x_translate+=g,crates[e].y_translate+=g,crates[e].left_new+=g,crates[e].top_new+=g):b<0&&Math.abs(b)<h&&f>0&&f<h?(s.style.transform=`translate3d(${S-g}px, ${_+g}px, 0px)`,crates[e].x_translate-=g,crates[e].y_translate+=g,crates[e].left_new-=g,crates[e].top_new+=g):b>0&&b<h&&f<0&&Math.abs(f)<h&&(s.style.transform=`translate3d(${S+g}px, ${_-g}px, 0px)`,crates[e].x_translate+=g,crates[e].y_translate-=g,crates[e].left_new+=g,crates[e].top_new-=g):0==crates[e].shelved?(s.style.color="rgba(195, 195, 195, 1)",s.style.backgroundColor="",s.style.animation="glow infinite 1s",s.querySelector(".face-kitten").innerHTML="•˕•"):s.querySelector(".face-kitten").innerHTML="¯˕¯",1==crates[e].mount&&(document.querySelector(".forklift").style.top="6.5px",s.style.transform="translate3d("+relocate_x+"px, "+relocate_y+"px, 0px) rotate3d(0,0,1,"+-1*angle+"deg)",s.style.color=crates[e].color,s.style.backgroundColor=crates[e].backgroundColor,crates[e].shelved=!1,s.style.animation="glow infinite 1s",s.querySelector(".face-kitten").innerHTML="ˑ˕ˑ"),s.style.color=0==showColors?"rgba(195, 195, 195, 1)":crates[e].color}}var instructions_timeouts=[];function showMessage(e,t){document.querySelector(".message-container").style.display="block",document.querySelector(".message").innerHTML=e}function hideMessage(e){window.setTimeout(function(){document.querySelector(".message-container").style.display="none"},e)}var instructionSlide=0;function showInstructions(){instructions_timeouts.push(window.setTimeout(function(){document.querySelector(".message-container").style.display="block",document.querySelector(".message").innerHTML="<h4>Welcome to</h4>"},1e3)),instructions_timeouts.push(window.setTimeout(function(){document.querySelector(".message").innerHTML="<h4>Welcome to<br/><h3><b>Carbon's</b></h3></h4>",playSound(messageBeep,.26)},2500)),instructions_timeouts.push(window.setTimeout(function(){document.querySelector(".message").innerHTML="<h4>Welcome to<br/><h3><b>Carbon's Kitty</b></h3></h4>",playSound(messageBeep,.26)},3500)),instructions_timeouts.push(window.setTimeout(function(){document.querySelector(".message").innerHTML="<h4>Welcome to<br/><h3><b>Carbon's Kitty Care</b></h3></h4>",playSound(messageBeep,.26),instructionSlide=1},4500)),instructions_timeouts.push(window.setTimeout(function(){document.querySelector(".skip-instructions").style.display="block"},5500)),window.addEventListener("keydown",function(e){" "==e.key&&goThroughInstructions()},!1)}function goThroughInstructions(){var e=instructionSlide/14*100;document.querySelector(".instructions-progress").style.backgroundColor=`hsl(${e}, 70%, 35%)`,document.querySelector(".instructions-progress").style.width=instructionSlide/14*100+"%",1==instructionSlide?(document.querySelector(".instructions-progress").style.display="block",document.querySelector(".message").innerHTML="<div>Help <b>Carbon the Black Cat</b> bring</div>these kittens <div style='display: inline-block; background-color: #2a2b34ff; padding: 4px 9px 11px 9px'><table style='position: relative; display: inline; border-spacing: 20px;'><tr><td class='crate-sample' style='background-color:red'><span class='ears-kitten-sample'>&#92;</span><span class='whiskers-kitten-sample'>></span><span class='face-kitten-sample'>•˕•</span><span class='whiskers-kitten-sample'><</span><span class='ears-kitten-sample'>/</span></td><td class='crate-sample' style='background-color:green'><span class='ears-kitten-sample'>&#92;</span><span class='whiskers-kitten-sample'>></span><span class='face-kitten-sample'>•˕•</span><span class='whiskers-kitten-sample'><</span><span class='ears-kitten-sample'>/</span></td><td class='crate-sample' style='background-color:blue'><span class='ears-kitten-sample'>&#92;</span><span class='whiskers-kitten-sample'>></span><span class='face-kitten-sample'>•˕•</span><span class='whiskers-kitten-sample'><</span><span class='ears-kitten-sample'>/</span></td></tr></table></div> to<div style='padding-top: 6.5px'>their assigned beds</div><div style='padding-top: 6.5px'><div><table style='top: 2.5px; position: relative; display: inline'><tr><td class='shelf-sample' style='background-color:red'></td> <td class='shelf-sample' style='background-color:green'></td> <td class='shelf-sample' style='background-color:blue'></td></tr></table></div></div>",playSound(messageBeep,.26),instructionSlide=2):2==instructionSlide?(document.querySelector(".message").innerHTML="<div style='padding-bottom: 6.5px'>But due to power blackouts,</div><div style='padding-bottom: 6.5px'>they look more like this<br/><div style='display: inline-block; background-color: #2a2b34ff; padding: 4px 9px 11px 9px'><table style='position: relative; display: inline; border-spacing: 20px;'><tr><td class='crate-sample'><span class='ears-kitten-sample'>&#92;</span><span class='whiskers-kitten-sample'>></span><span class='face-kitten-sample'>•˕•</span><span class='whiskers-kitten-sample'><</span><span class='ears-kitten-sample'>/</span></td><td class='crate-sample'><span class='ears-kitten-sample'>&#92;</span><span class='whiskers-kitten-sample'>></span><span class='face-kitten-sample'>•˕•</span><span class='whiskers-kitten-sample'><</span><span class='ears-kitten-sample'>/</span></td><td class='crate-sample'><span class='ears-kitten-sample'>&#92;</span><span class='whiskers-kitten-sample'>></span><span class='face-kitten-sample'>•˕•</span><span class='whiskers-kitten-sample'><</span><span class='ears-kitten-sample'>/</span></td></tr></table></div>",playSound(messageBeep,.26),instructionSlide=3):3==instructionSlide?(document.querySelector(".message").innerHTML="<div style='display: inline-block; background-color: #2a2b34ff; padding: 4px 9px 11px 9px'><table style='position: relative; display: inline; border-spacing: 20px;'><tr><td class='crate-sample' style='background-color:red'><span class='ears-kitten-sample'>&#92;</span><span class='whiskers-kitten-sample'>></span><span class='face-kitten-sample'>•˕•</span><span class='whiskers-kitten-sample'><</span><span class='ears-kitten-sample'>/</span></td></tr></table>\n        \n          <span class=\"forklift-sample\">\n              <span class=\"nose\"><span class=\"ears-cat-sample\">&#92;</span><span class=\"whiskers-cat\">></span><span class=\"face-cat\">•˕•</span><span class=\"whiskers-cat\"><</span><span class=\"ears-cat-sample\">/</span></span>\n          </span>\n          \n          </div><br/>until you catch them</div>\n        ",playSound(messageBeep,.26),instructionSlide=4):4==instructionSlide?(document.querySelector(".message").innerHTML="<div style='padding-bottom: 6.5px; padding-top: 6.5px'>and their beds look like this</div><div><table style='top: 2.5px; position: relative; display: inline'><tr><td class='shelf-sample' style='background-color:#0E1018da'></td> <td class='shelf-sample' style='background-color:#0E1018da'></td> <td class='shelf-sample' style='background-color:#0E1018da'></td></tr></table></div>",playSound(messageBeep,.26),instructionSlide=5):5==instructionSlide?(document.querySelector(".message").innerHTML='<div style=\'display: inline-block; background-color: #2a2b34ff; padding: 4px 9px 50px 9px\'><table style=\'top: 2.5px; position: relative; display: inline\'><tr><td class=\'shelf-sample\' style=\'background-color:red\'></td></tr></table></div><div style=\'padding-top: 9px\'>\n        <span class="forklift-sample-2">\n            <span class="nose"><span class="ears-cat-sample">&#92;</span><span class="whiskers-cat">></span><span class="face-cat">•˕•</span><span class="whiskers-cat"><</span><span class="ears-cat-sample">/</span></span>\n        </span>\n        until you bump them.</div>',playSound(messageBeep,.26),instructionSlide=6):6==instructionSlide?(document.querySelector(".message").innerHTML=`the bar <table style='position: relative; display: inline'><tr><td class='hit-bar-sample' style='background-color:hsl(${hit_points}, 70%, 35%);'></td></tr></table> at the</br>bottom shows the energy Carbon has`,playSound(messageBeep,.26),instructionSlide=7):7==instructionSlide?(document.querySelector(".message").innerHTML+=" before she ",playSound(messageBeep,.26),instructionSlide=8):8==instructionSlide?(document.querySelector(".message").innerHTML+="falls ",playSound(messageBeep,.26),instructionSlide=9):9==instructionSlide?(document.querySelector(".message").innerHTML+="asleep..",playSound(messageBeep,.26),instructionSlide=10):10==instructionSlide?(document.querySelector(".message").innerHTML+=" "+skullEmoji,playSound(messageBeep,.26),instructionSlide=11):11==instructionSlide?(document.querySelector(".toggle-onscreen-controls").style.animation="glow 1s infinite",document.querySelector(".mobile-controls-all").style.animation="glow 1s infinite",document.querySelector(".message").innerHTML="<div style='padding-bottom: 6.5px'>Navigate using <span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>W</span>&nbsp<span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>A</span>&nbsp<span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>S</span>&nbsp<span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>D</span></div>or the arrow keys <span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>←</span>&nbsp<span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>↑</span>&nbsp<span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>↓</span>&nbsp<span style='color:#c3c3c3; padding: 0 7px 0 7px;background-color:#0E1018; border-radius: 4px'>→</span><br/>but if you're on mobile,<br/>use the onscreen controls",playSound(messageBeep,.26),instructionSlide=12):12==instructionSlide?(document.querySelector(".toggle-onscreen-controls").style.animation="",document.querySelector(".mobile-controls-all").style.animation="",document.querySelector(".message").innerHTML="<div style='padding-bottom: 6.5px'>The objective is simple:",playSound(messageBeep,.26),instructionSlide=13):13==instructionSlide?(document.querySelector(".message").innerHTML="<div style='padding-bottom: 6.5px'><b>Put the kittens to bed,</b>",playSound(messageBeep,.26),instructionSlide=14):14==instructionSlide?(document.querySelector(".skip-instructions").innerHTML="Click here or press <b>[space bar]</b> to start",document.querySelector(".skip-instructions").style.backgroundColor="#ffe4b9",document.querySelector(".skip-instructions").style.animation="none",document.querySelector(".message").innerHTML="<div style='padding-bottom: 6.5px'><b>Put the kittens to bed,<br/>before they put Carbon to sleep.</b>",playSound(messageBeep,.26),instructionSlide=15):15==instructionSlide&&(gameStartShowHideColors(1e3),document.querySelector(".message-container").style.display="none",playSound(startLevel1Sound,.27),document.querySelector(".skip-instructions").style.display="none",document.querySelector(".instructions-progress").style.display="none",instructionSlide=16)}function clearAllInstructionsAndStart(){if(0==skipInstructions){for(;instructions_timeouts.length>0;){const e=instructions_timeouts.pop();clearTimeout(e)}gameStartShowHideColors(1e3),document.querySelector(".message").style.display="none",playSound(startLevel1Sound,.27),document.querySelector(".skip-instructions").style.display="none",skipInstructions=!0}}function loadGame(){next_level_instance=instantiateGame(1,3,hit_points,0,0,5,-25,0),showInstructions()}function mobile_controls(){document.querySelector(".skip-instructions").onclick=function(){goThroughInstructions()},document.querySelector(".mobile-controls-forward").onmousedown=function(){map.arrowup=!0,document.querySelector(".mobile-controls-forward").style.color="white"},document.querySelector(".mobile-controls-forward").onmouseup=function(){map.arrowup=!1,document.querySelector(".mobile-controls-forward").style.color="grey"},document.querySelector(".mobile-controls-backward").onmousedown=function(){map.arrowdown=!0,document.querySelector(".mobile-controls-backward").style.color="white"},document.querySelector(".mobile-controls-backward").onmouseup=function(){map.arrowdown=!1,document.querySelector(".mobile-controls-backward").style.color="grey"},document.querySelector(".mobile-controls-left").onmousedown=function(){map.arrowleft=!0,document.querySelector(".mobile-controls-left").style.color="white"},document.querySelector(".mobile-controls-left").onmouseup=function(){map.arrowleft=!1,document.querySelector(".mobile-controls-left").style.color="grey"},document.querySelector(".mobile-controls-right").onmousedown=function(){map.arrowright=!0,document.querySelector(".mobile-controls-right").style.color="white"},document.querySelector(".mobile-controls-right").onmouseup=function(){map.arrowright=!1,document.querySelector(".mobile-controls-right").style.color="grey"},document.querySelector(".toggle-onscreen-controls").onclick=function(){1==toggleOnscreenControls?(document.querySelector(".toggle-onscreen-controls").style.color="#5d5d5d",document.querySelector(".mobile-controls-all").style.display="none",toggleOnscreenControls=!1):(document.querySelector(".toggle-onscreen-controls").style.color="#c3c3c3",document.querySelector(".mobile-controls-all").style.display="block",toggleOnscreenControls=!0)},document.querySelector(".mobile-controls-forward").ontouchstart=function(){map.arrowup=!0,document.querySelector(".mobile-controls-forward").style.color="white"},document.querySelector(".mobile-controls-forward").ontouchend=function(){map.arrowup=!1,document.querySelector(".mobile-controls-forward").style.color="grey"},document.querySelector(".mobile-controls-backward").ontouchstart=function(){map.arrowdown=!0,document.querySelector(".mobile-controls-backward").style.color="white"},document.querySelector(".mobile-controls-backward").ontouchend=function(){map.arrowdown=!1,document.querySelector(".mobile-controls-backward").style.color="grey"},document.querySelector(".mobile-controls-left").ontouchstart=function(){map.arrowleft=!0,document.querySelector(".mobile-controls-left").style.color="white"},document.querySelector(".mobile-controls-left").ontouchend=function(){map.arrowleft=!1,document.querySelector(".mobile-controls-left").style.color="grey"},document.querySelector(".mobile-controls-right").ontouchstart=function(){map.arrowright=!0,document.querySelector(".mobile-controls-right").style.color="white"},document.querySelector(".mobile-controls-right").ontouchend=function(){map.arrowright=!1,document.querySelector(".mobile-controls-right").style.color="grey"},document.querySelector(".toggle-onscreen-controls").ontouchmove=function(){"none"==document.querySelector(".mobile-controls-all").style.display&&(document.querySelector(".mobile-controls-all").style.display="block"),"block"==document.querySelector(".mobile-controls-all").style.display&&(document.querySelector(".mobile-controls-all").style.display="none")}}function playSound(e,o){for(null!=A&&A.close(),f=function(o){var n=e,s=35e3;if(o>s)return null;var r=n[n.length*o/s|0];if(void 0===r)return 0;var a=.8*Math.pow(2,r/12),l=t(o*n.length%s,s);return o*a&64?l:-l},t=(e,t)=>(t-e)/t,A=new AudioContext,m=A.createBuffer(1,96e3,48e3),b=m.getChannelData(0),i=96e3;i--;)b[i]=f(i);s=A.createBufferSource(),s.buffer=m;var n=A.createGain();n.gain.value=o,n.connect(A.destination),s.connect(n),s.start()}function playSound2(e,o){for(null!=A2&&A2.close(),f=function(o){var n=e,s=35e3;if(o>s)return null;var r=n[n.length*o/s|0];if(void 0===r)return 0;var a=.8*Math.pow(2,r/12),l=t(o*n.length%s,s);return o*a&64?l:-l},t=(e,t)=>(t-e)/t,A2=new AudioContext,m=A2.createBuffer(1,96e3,48e3),b=m.getChannelData(0),i=96e3;i--;)b[i]=f(i);s=A2.createBufferSource(),s.buffer=m;var n=A2.createGain();n.gain.value=o,n.connect(A2.destination),s.connect(n),s.start()}levelCompleteSound=[0,void 0,4,void 0,7,void 0,12],startGameSound=[0,4,7,12,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],startLevel1Sound=[0,4,7,void 0,void 0,void 0,void 0,void 0,void 0],startLevel2Sound=[1,5,8,void 0,void 0,void 0,void 0,void 0,void 0],startLevel3Sound=[2,6,9,void 0,void 0,void 0,void 0,void 0,void 0],startLevel4Sound=[3,7,10,void 0,void 0,void 0,void 0,void 0,void 0],startLevel5Sound=[4,8,11,void 0,void 0,void 0,void 0,void 0,void 0],endLevel1Sound=[0,4,7,12,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],endLevel2Sound=[1,5,8,13,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],endLevel3Sound=[2,6,9,14,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],endLevel4Sound=[3,7,10,15,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],endLevel5Sound=[4,8,11,16,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],loadCrateSound=[4,7,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],shelfCrateSound=[7,12,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],dropCrateSound=[7,4,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],messageBeep=[0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0,void 0],hitSound=[-20,void 0,void 0,void 0,void 0],deathSound=[-21,-25,-45],gameCompleteSound=[-5,0,4,7,void 0,4,7],lickSound=[2,4,5,7,4,void 0,0,2];