<title>Zooback Rider</title><meta content="width=device-width,maximum-scale=1,user-scalable=0" name=viewport><style>*{-webkit-tap-highlight-color:transparent}</style><body style=margin:0;overflow:hidden><div id=galldiv></div><script>var ggameid=0,ggamelocal=0,tb={};tbmake();var _All_pens={total:0,first:null,last:null},_All_tile_kinds={total:0,first:null,last:null},_Camera_size_x=0,_Camera_size_y=0,_Camera_x=0,_Camera_y=0,_Farmer=null,_Flower=null,_Game_state=0,_Grain=null,_Grass=null,_Grid=null,_Guy_who_is_talking=null,_Guys_list={total:0,first:null,last:null},_Horse=null,_Horsey=null,_Invisible_wall=null,_Is_Mac=!1,_Lock=null,_Man=null,_Mountain=null,_Ocean=null,_Octopus=null,_Pig=null,_Piggy=null,_Rose=null,_S=null,_Seedling=null,_Sheep=null,_Sign_Post=null,_Tile_size=0,_Tile_that_is_talking=null,_Touch_start_x=0,_Touch_start_y=0,_Tree=null,_Wind=null,_Woman=null,_You=null,_You_image=null,_Zoo_tree=null,_Zoohouse=null,_Zookeeper=null,gloop=function(){requestAnimationFrame(gloop),tb.updateshould()&&(_Main_Loop(),tb.glis&&tb.ggl.draw(),tb.update())};function _All_penned(){for(var g=null,t=_Guys_list.first;t;){if((g=t.val).Kind!=_Man&&g.Kind!=_Woman&&!g.Penned)return!1;t=t.next}return!0}function _Camera_update(){_Camera_size_x=Math.ceil(tb.screensizex/_Tile_size)+1,_Camera_size_y=Math.ceil(tb.screensizey/_Tile_size)+1,_Camera_x=_You.X,_Camera_y=_You.Y}function _Convert_map(){var g="",t=null,e=0,i=0;for(i=1;i<=tb.arrayheightget(_Grid)-1;i++)for(e=1;e<=tb.arraylengthget(_Grid);e++)null==(t=_Grid[e][i])&&tb.notificationcancel(0),g+=t.Kind.Letter;tb.debugset(g)}function _Draw_guys(g){for(var t=null,e=null,i={total:0,first:null,last:null},m=!1,n=_Guys_list.first;n;)t=n.val,Math.floor(t.Y+.5)==g&&tb.listpush(2,i,t),n=n.next;m=!0;for(var o=0;m;){if(o++>999999)throw{line:7,message:"Infinite While Loop"};m=!1,e=null;for(var s=i.first;s;){if(t=s.val,null!=e&&t.Y<e.Y){tb.listremove(12,i,t),tb.listinsertbefore(13,i,t,e),m=!0;break}e=t,s=s.next}}for(var a=i.first;a;)(t=a.val)._Draw(),a=a.next}function _Draw_main_menu(){var g=0,t=0,e=!1,i=0;for(i=tb.screensizey/15,tb.screensizey>tb.screensizex&&(i=tb.screensizex/15),tb.cls({r:20,g:130,b:255,a:255}),tb.rngsetup(2),tb.fontsizeset(2*i),tb.transparencyset(.7),t=1;t<=44;t++)tb.textdrawcentered("‚òÅ",tb.mod(tb.randomint(1,3*tb.screensizex)+tb.loops,3*tb.screensizex)-tb.screensizex,tb.randomint(1,tb.screensizey));tb.transparencyset(0),tb.fontsizeset(1.2*i),tb.colorset({r:252,g:252,b:254,a:255}),tb.textdrawcentered("Zooback Rider",tb.screensizex/2,2*i),g=2*i,t=4.7*i,e=!!tb.rectshit(tb.touchx,tb.touchy,0,0,tb.screensizex/2-3*g/2,t-1.3*g/2,3*g,1.3*g),tb.mousedownany&&e&&(t+=1),tb.fontsizeset(g),tb.offsetset(tb.screensizex/2,t),tb.scaleset(3,1.3),tb.textdrawcentered("üî≤",0,0),tb.scaleset(1,1),tb.offsetset(0,0),tb.fontsizeset(.8*i),tb.colorset({r:0,g:72,b:232,a:255}),tb.textdrawcentered("Play ‚ñ∂",tb.screensizex/2,t-.1*i),tb.mouseclickedany&&e&&(_Game_state=4),tb.colorset({r:237,g:237,b:249,a:255}),tb.fontsizeset(.4*i),tb.mobile?tb.textdrawcentered("Press where you want to go, tap yourself to interact.",tb.screensizex/2,6.6*i):tb.textdrawcentered("Arrow keys or WASD to move, space to interact.",tb.screensizex/2,6.6*i),tb.fontsizeset(.5*i),tb.textdrawcentered("Coded on my iPhone in",tb.screensizex/2,7.6*i),t=9.2*i,g=1.3*i,e=!!tb.rectshit(tb.touchx,tb.touchy,0,0,tb.screensizex/2-4*g/2,t-1.3*g/2,4*g,1.3*g),tb.mousedownany&&e&&(t+=1),tb.fontsizeset(g),tb.offsetset(tb.screensizex/2,t),tb.scaleset(4.1,1.3),tb.textdrawcentered("üî≤",0,0),tb.scaleset(1,1),tb.offsetset(0,0),tb.mouseclickedany&&e&&tb.browseropen("http://touchbasicapp.com"),tb.fontsizeset(.5*i),tb.colorset({r:0,g:81,b:158,a:255}),tb.textdrawcentered("Touch Basic üëÜ",tb.screensizex/2,t-.1*i)}function _Draw_map(){var g,t,e=0,i=0,m=0,n=0,o=null,s=null,a=0,r=0;for(g=_Camera_x-tb.screensizex/2/_Tile_size,t=_Camera_y-tb.screensizey/2/_Tile_size,tb.cls(tb.colormake(44,166,44,255)),r=-3;r<=_Camera_size_y;r++){for(a=-4;a<=_Camera_size_x;a++)if(o=_Tile_get(Math.floor(g)+a,n=Math.floor(t)+r),!(a<0||r<0)||null!=o&&o.Kind==_Zoohouse){if(i=(a+0-tb.mod(g,1))*_Tile_size,m=(r+0-tb.mod(t,1))*_Tile_size,s=_Mountain,e=0,null!=o){if(o.Kind==_Grass)continue;s=o.Kind,i+=o.Add_X*_Tile_size,m+=o.Add_Y*_Tile_size,e=o.Angle}s.walkable&&(m-=s.Size/4*_Tile_size),tb.colorset(s.color),tb.fontsizeset(_Tile_size*s.Emoji_size),s==_Lock&&(o.Locked?(s.Emoji="üîí",tb.transparencyset(.4)):(s.Emoji="üîì",tb.transparencyset(.7))),s==_Ocean&&(tb.rectdraw(i-_Tile_size/2,m-_Tile_size/2,_Tile_size,_Tile_size),tb.transparencyset(.7)),s==_Wind&&(tb.transparencyset(.7),_Grid[o.X+1][o.Y].Kind!=_Wind&&tb.transparencyset(.7+tb.mod(2*tb.loops,_Tile_size)/_Tile_size*.29),i+=tb.mod(2*tb.loops,_Tile_size),m+=.2*_Tile_size),tb.textdrawrotated(s.Emoji,i,m,e),tb.transparencyset(0),s==_Sign_Post&&_Tile_that_is_talking==o&&(tb.fontsizeset(4.5*_Tile_size),tb.textdrawcentered("üóØ",i+2.1*_Tile_size,m+-2.2*_Tile_size),tb.colorset(tb.colormake(0,0,0,255)),tb.fontsizeset(.4*_Tile_size),tb.textdrawcentered("‚ö†",i+2.1*_Tile_size,m-3.4*_Tile_size),tb.textdrawcentered("Windy Pass",i+2.1*_Tile_size,m-2.9*_Tile_size),tb.fontsizeset(.3*_Tile_size),tb.textdrawcentered("None can pass.",i+2.1*_Tile_size,m-2.4*_Tile_size),tb.textdrawcentered("It's always too windy.",i+2.1*_Tile_size,m-2.1*_Tile_size),tb.textdrawcentered("Cross the river instead.",i+2.1*_Tile_size,m-1.8*_Tile_size))}_Draw_guys(n),tb.offsetset(0,0)}}function _Main_Loop(){var g=null,t=0;if(tb.resized&&_Resized(),tb.mousehitany&&(_Touch_start_x=tb.touchx,_Touch_start_y=tb.touchy),null==_Grid){if(!tb.assetsallloaded())return;_Setup_map_2(),_Game_state=1}if(1!=_Game_state&&_Camera_update(),4==_Game_state){for(var e=_Guys_list.first;e;)e.val._Update(),e=e.next;_Tap_to_dismount(),_Tap_to_pick_up_item()}if(1!=_Game_state){_Draw_map(),null!=_Guy_who_is_talking&&(_Guy_who_is_talking.Bob+=15),tb.fontsizeset(.3*_Tile_size);for(var i=_Guys_list.first;i;)(g=i.val).Kind!=_Man&&g.Kind!=_Woman&&(g.Penned||tb.transparencyset(.6),t+=.5*_Tile_size,tb.textdrawcentered(g.Kind.Emoji,t,.4*_Tile_size),tb.transparencyset(0)),i=i.next}else _Draw_main_menu()}function _On_Tap(){}function _Resized(){_Tile_size=tb.screensizey>tb.screensizex?tb.screensizey/15:tb.screensizex/15}function _Setup_guy_kinds(){var g=null;(g=new _Create_Guy_kind_class).Name="Woman",g.Emoji="üö∂‚Äç‚ôÄÔ∏è",g.Emojisize=.8,g.Unrideable=!0,_Woman=g,(g=new _Create_Guy_kind_class).Name="Man",g.Emoji="üö∂‚Äç‚ôÇÔ∏è",g.Emojisize=.8,g.Unrideable=!0,_Man=g,(g=new _Create_Guy_kind_class).Name="Octopus",g.Emoji="üêô",g.Emojisize=.6,_Octopus=g,(g=new _Create_Guy_kind_class).Name="Horse",g.Emoji="üêé",g.Emojisize=1,_Horse=g,(g=new _Create_Guy_kind_class).Name="Sheep",g.Emoji="üêë",g.Emojisize=.8,_Sheep=g,(g=new _Create_Guy_kind_class).Name="Pig",g.Emoji="üêñ",g.Emojisize=.8,_Pig=g}function _Setup_guys(){(_Piggy=new _Create_Guy_class).X=6,_Piggy.Y=10,_Piggy.Speed=.15,_Piggy.Kind=_Pig,(_You=new _Create_Guy_class).X=23,_You.Y=23,_You.Speed=.18,_You.Kind=_Horse,(_You=new _Create_Guy_class).X=29,_You.Y=27,_You.Speed=.05,_You.Kind=_Octopus,(_You=new _Create_Guy_class).X=44,_You.Y=11,_You.Speed=.08,_You.Kind=_Sheep,(_Zookeeper=new _Create_Guy_class).X=39,_Zookeeper.Y=15,_Zookeeper.Speed=.1,_Zookeeper.Kind=_Man,(_Farmer=new _Create_Guy_class).X=11,_Farmer.Y=30,_Farmer.Speed=.1,_Farmer.Kind=_Man,(_You=new _Create_Guy_class).X=41,_You.Y=13,_You.Speed=.1,_You.Kind=_Woman,_You_image=tb.imagemake(_Tile_size,_Tile_size),tb.drawtocanvas(50,_You_image),tb.fontsizeset(_Tile_size*_You.Kind.Emojisize),tb.textdrawrotated(_You.Kind.Emoji,_Tile_size*_You.Kind.Emojisize*0,_Tile_size*_You.Kind.Emojisize*.05,0),tb.drawtoscreen(53)}function _Setup_map(){var g="",t="",e=null,i=0,m=0;for((_S=tb.arraymake(0,"",11))[1]="mmmmmmmmmmmmmmmmmmmm",_S[2]="mttttttttttttttttttm",_S[3]="mt     t          tm",_S[4]="mt     t   ggg    tm",_S[5]="mt f tt      f    tm",_S[6]="mt                tm",_S[7]="mt  ooooo         tm",_S[8]="mt  ooooo         tm",_S[9]="mt  ooooo         tm",_S[10]="mttttttttttttttttttm",_S[11]="mmmmmmmmmmmmmmmmmmmm",_Grid=tb.arraymake(12,null,_S[1].length,tb.arraylengthget(_S)),m=1;m<=tb.arrayheightget(_Grid);m++)for(t=_S[m],i=1;i<=tb.arraylengthget(_Grid);i++)e=new _Create_Tile_class,_Grid[i][m]=e,"g"==(g=tb.stringpart(t,i,1,19))&&(e.Kind=_Grain),"f"==g&&(e.Kind=_Flower),"t"==g&&(e.Kind=_Tree),"m"==g&&(e.Kind=_Mountain),"o"==g&&(e.Kind=_Ocean)," "==g&&(e.Kind=_Grass)}function _Setup_map_2(){var g=0,t="",e=null,i=null,m=null,n=0,o=0;for("mmmmmmmmmmmmmmmmmmommmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmttttoottttttttmmmmmttmtttttttttttttttmmmmmmmmmmmmmmmmmmmmtmmttmmmmoommtttttttttttmmttttttttttttttttttttmtmmmmmmmmmmmmmttttttttttootttgggggttttttppppptppppptppppptppppptttmmmmmmmtmtttffggggfgoogggggggggtttttpwggptpoooptpgggptpgggptttmmmmmmtttgfggggggggooogggggggggtttttpgggptpgggptpgggptpgggptttmmmmmmtfggfggggggggooogggggggggtgtttpgggptpgggptpgggptpgggptttmmmmmmtfggggttgggggooogggggggggtttttpplpptpplpptpplpptpplpptttmmmmmmtgggggggggggooooggggggggggttttgggggggggggggggggggggggtttmmmmmmmtggggooooooooooggggggggggggttggggggggggggggggggggggtttttmmmmmmtgggoooooooooooggggfgggggggttggggggggggggggggggggggtttttmmmmmmmggmmooooooooogggggggggggggttggggggggggggggggggggttttttttmWWWWWWWWgggooooooggggggggggggggttziiiiggggggggggggtttttttttttmmmmmgggggggggggggggggggggfggggggtiiiiiggggggggggttttttttttfttmmmttSgggggggggggggggggggggggggggtiiiiiggggggggttttttttttgttttmmtttgggggggggggfggggfgggggggggggtiiiiigggtttttttttttttttgttttmmtttgggggggggggggggggggggggggggggrrrrrfggfgggggggtgtgtgttttttmmtttgggggggfggggggggggfggggggggggrrrrrfggfgggggggttttgttgttmtmmttggggggggggggggtggggggggggggtgggggggfggfggfggggfgtttggtttmtmmttfggggggggggggggggggggggggggggggggggggggggggggggggttttttgmtmmttgggggggggggggggggggggggggggggggggggggggggggggggggttgtttgmtmgttggtggggggggggggggggtggggfggggggggggggggggggggggggggttttgtmmmttfgtwwwgwwwggggggggggggfgggggggggggggggggggggggggggggtttttmmmttfgtwwwgwwwggggggggfggggggggggggggfggggfgggggggggggggggtttmmmttfgtwwwgwwwggggggfggggggggggggfgggggggggggggfgggggggggggttmmmttggtwwwgwwwggggggggggggoooooggggggggggggggggggggtgggggtggtmmmttggtwwwgwwwgggggggtggggoooooogggggfgggggggggggggggggtggggtmmmttgggwwwgwwwgfggggggggggtooootgggggggggggggggggggggggggggfgmtmtttggwwwgwwwggfggggggggfgggggggggggggggggggtggtgtggggtgtgggttmtgttggggggggggggggggggggggggggggggggggggggggggggggggggggtggttmtttggggggggggggggggggggggggggggggggfggggtgggggggggggggtgggtttmtttggsssgggggggggggggfggggggggggggggggggggtggggtggtgggggggmttmmttggsssgggfgggggggggggggggggggggggggggggggggggggggggtggttttmmmtggggggggggggtgggggggggggggfgggggfgggggrgggtgggggggggggttmmmmttgggggggggggggggggggggggggggggggggggggggggggggtgtggggtttmmmmmttggggggggggggggggggggttggggggggggttgtggrgfggtggggggttttmmtmmmttggrggtggggggggggggggtgggggggggggtggggggfgtgggrgftttmmgmmmmmmgtggggggggggggggggggggggtggggttttgggggrgggggggggtttmmggmmttmmmtttgggggggrggggggfggggggggggggggggtgtgggfgrggttttmmmgmmgmttmmmtttggggggggggggggggggggggggggggggggfgfggggggttttmfmmmggmgttgmmmttggggggggtgggggtgggggggggggggggggggggrggttttmmgmmmggmgggtmmmmttgggggggggggggtgggtggggfggggggggggfggggtgtmtmgmmgggmtgggmmmmmttggtggggggtggggggggggggggggggggggggtgftttmmttgmgggmtgggmmtmmmttgggggggggtgtgggggggggggggfgggggggfggtttmmtggmtmmtggggmmttmmmttggggggggggtttgggggggggggggfgggggggttttmmtgmmmgmgggggmmgtmmmmttggggtgggggttttgggggggggggggggggggttttgmtgmgmgmgggggmmgmmmmmmmtggggttgggggttttggggtggggggggggggttttmmtgmgmgmfgtgtmmgmfmmmmmmtttgggtttgggggttttggggggggggggggttttmmtggmmmggggtgmmmmggmmmmmmmttggggtttggggggtttgggggggggggggtttmmttggmmggggggmmmmggtmmmmmmmttgggggtttggggggggggggggggggggtgtmmtgggmgmgggmmmmmmgggtmmmmmmmtttgggggttttgggggggggggggggfttgtgmttgtmgmgtmmmtggmgggtmtmmmmmmmtttgggggttttgggggggggggggggtttgmmtmmmgmttmgmgggmmgggmmmmmmmmmmtmttgfgggttttttgggggggggggtgtmttggmmgggmggmmgmmmgfgmmtmmmmmmmttmtttttggggtttttggggggttttttgmtggmmmmmggmmgggggggmttttmmmmmmmttmttttttfggttttttggggggggtttmgtgmmmmggmmggmmmgmmtttttmmmmmmmmmmmtttttttggggggggggggfgtttmmgtgmmgggttmmmmtmmtftttttgmmmmmmmmmmmmmttmmtttttttttttttttttmmmtmmmmmmmmmmmmmmmttmmtmttmmmmmmmmmmmmmmmmmmmmmtttttttttttttmmtmmmmttmmmmmmtmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmtmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm",_Grid=tb.arraymake(49,null,62,60),n=1,o=1,g=1;g<=3658;g++){(i=new _Create_Tile_class).X=n,i.Y=o,_Grid[n][o]=i,t=tb.stringpart("mmmmmmmmmmmmmmmmmmommmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmttttoottttttttmmmmmttmtttttttttttttttmmmmmmmmmmmmmmmmmmmmtmmttmmmmoommtttttttttttmmttttttttttttttttttttmtmmmmmmmmmmmmmttttttttttootttgggggttttttppppptppppptppppptppppptttmmmmmmmtmtttffggggfgoogggggggggtttttpwggptpoooptpgggptpgggptttmmmmmmtttgfggggggggooogggggggggtttttpgggptpgggptpgggptpgggptttmmmmmmtfggfggggggggooogggggggggtgtttpgggptpgggptpgggptpgggptttmmmmmmtfggggttgggggooogggggggggtttttpplpptpplpptpplpptpplpptttmmmmmmtgggggggggggooooggggggggggttttgggggggggggggggggggggggtttmmmmmmmtggggooooooooooggggggggggggttggggggggggggggggggggggtttttmmmmmmtgggoooooooooooggggfgggggggttggggggggggggggggggggggtttttmmmmmmmggmmooooooooogggggggggggggttggggggggggggggggggggttttttttmWWWWWWWWgggooooooggggggggggggggttziiiiggggggggggggtttttttttttmmmmmgggggggggggggggggggggfggggggtiiiiiggggggggggttttttttttfttmmmttSgggggggggggggggggggggggggggtiiiiiggggggggttttttttttgttttmmtttgggggggggggfggggfgggggggggggtiiiiigggtttttttttttttttgttttmmtttgggggggggggggggggggggggggggggrrrrrfggfgggggggtgtgtgttttttmmtttgggggggfggggggggggfggggggggggrrrrrfggfgggggggttttgttgttmtmmttggggggggggggggtggggggggggggtgggggggfggfggfggggfgtttggtttmtmmttfggggggggggggggggggggggggggggggggggggggggggggggggttttttgmtmmttgggggggggggggggggggggggggggggggggggggggggggggggggttgtttgmtmgttggtggggggggggggggggtggggfggggggggggggggggggggggggggttttgtmmmttfgtwwwgwwwggggggggggggfgggggggggggggggggggggggggggggtttttmmmttfgtwwwgwwwggggggggfggggggggggggggfggggfgggggggggggggggtttmmmttfgtwwwgwwwggggggfggggggggggggfgggggggggggggfgggggggggggttmmmttggtwwwgwwwggggggggggggoooooggggggggggggggggggggtgggggtggtmmmttggtwwwgwwwgggggggtggggoooooogggggfgggggggggggggggggtggggtmmmttgggwwwgwwwgfggggggggggtooootgggggggggggggggggggggggggggfgmtmtttggwwwgwwwggfggggggggfgggggggggggggggggggtggtgtggggtgtgggttmtgttggggggggggggggggggggggggggggggggggggggggggggggggggggtggttmtttggggggggggggggggggggggggggggggggfggggtgggggggggggggtgggtttmtttggsssgggggggggggggfggggggggggggggggggggtggggtggtgggggggmttmmttggsssgggfgggggggggggggggggggggggggggggggggggggggggtggttttmmmtggggggggggggtgggggggggggggfgggggfgggggrgggtgggggggggggttmmmmttgggggggggggggggggggggggggggggggggggggggggggggtgtggggtttmmmmmttggggggggggggggggggggttggggggggggttgtggrgfggtggggggttttmmtmmmttggrggtggggggggggggggtgggggggggggtggggggfgtgggrgftttmmgmmmmmmgtggggggggggggggggggggggtggggttttgggggrgggggggggtttmmggmmttmmmtttgggggggrggggggfggggggggggggggggtgtgggfgrggttttmmmgmmgmttmmmtttggggggggggggggggggggggggggggggggfgfggggggttttmfmmmggmgttgmmmttggggggggtgggggtgggggggggggggggggggggrggttttmmgmmmggmgggtmmmmttgggggggggggggtgggtggggfggggggggggfggggtgtmtmgmmgggmtgggmmmmmttggtggggggtggggggggggggggggggggggggtgftttmmttgmgggmtgggmmtmmmttgggggggggtgtgggggggggggggfgggggggfggtttmmtggmtmmtggggmmttmmmttggggggggggtttgggggggggggggfgggggggttttmmtgmmmgmgggggmmgtmmmmttggggtgggggttttgggggggggggggggggggttttgmtgmgmgmgggggmmgmmmmmmmtggggttgggggttttggggtggggggggggggttttmmtgmgmgmfgtgtmmgmfmmmmmmtttgggtttgggggttttggggggggggggggttttmmtggmmmggggtgmmmmggmmmmmmmttggggtttggggggtttgggggggggggggtttmmttggmmggggggmmmmggtmmmmmmmttgggggtttggggggggggggggggggggtgtmmtgggmgmgggmmmmmmgggtmmmmmmmtttgggggttttgggggggggggggggfttgtgmttgtmgmgtmmmtggmgggtmtmmmmmmmtttgggggttttgggggggggggggggtttgmmtmmmgmttmgmgggmmgggmmmmmmmmmmtmttgfgggttttttgggggggggggtgtmttggmmgggmggmmgmmmgfgmmtmmmmmmmttmtttttggggtttttggggggttttttgmtggmmmmmggmmgggggggmttttmmmmmmmttmttttttfggttttttggggggggtttmgtgmmmmggmmggmmmgmmtttttmmmmmmmmmmmtttttttggggggggggggfgtttmmgtgmmgggttmmmmtmmtftttttgmmmmmmmmmmmmmttmmtttttttttttttttttmmmtmmmmmmmmmmmmmmmttmmtmttmmmmmmmmmmmmmmmmmmmmmtttttttttttttmmtmmmmttmmmmmmtmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmtmmmmmmmmmmmmmmmmmmmmmmmmmmmmmmm",g,1,58);for(var s=_All_tile_kinds.first;s;){if((m=s.val).Letter==t){i.Kind=m;break}s=s.next}null==i.Kind&&(tb.debugset(""+n),tb.debugset(""+o),tb.debugset(""+g),tb.debugset(""+e[g]),tb.debugset(""+e[g+1]),tb.runtimeerror(71,""+e[g+2])),(n+=1)>tb.arraylengthget(_Grid)&&(n=1,o+=1)}for(o=2;o<=tb.arrayheightget(_Grid)-2;o++)for(n=2;n<=tb.arraylengthget(_Grid)-2;n++)null==(i=_Grid[n][o])&&tb.notificationcancel(0),i.Kind==_Lock&&(i.Transparency=.5,(new _Create_Pen).Lock_tile=i),i.Kind==_Lock&&(i.Transparency=.5),i.Kind==_Zoohouse&&(i.Add_X=2,i.Add_Y=1),i.Kind==_Zoo_tree&&(i.Angle=45,_Grid[n][o-1].Kind==i.Kind?(i.Angle=315,_Grid[n-1][o-0].Kind==i.Kind&&(i.Angle=0,i.Add_X=-.3,i.Add_Y=-.3),_Grid[n+1][o-0].Kind==i.Kind&&(i.Angle=90,i.Add_X=.3,i.Add_Y=-.3)):_Grid[n-0][o+1].Kind==i.Kind&&(i.Angle=315,_Grid[n-1][o-0].Kind==i.Kind&&(i.Angle=90,i.Add_X=-.3,i.Add_Y=.3),_Grid[n+1][o-0].Kind==i.Kind&&(i.Angle=0,i.Add_X=.3,i.Add_Y=.3)),_Is_Mac&&(i.Angle-=2))}function _Setup_tilekinds(){var g=null;(g=new _Create_Tile_kind_class).Letter="g",g.Emoji="",g.walkable=!0,g.Size=1,_Grass=g,(g=new _Create_Tile_kind_class).Letter="t",g.Emoji="üå≤",g.Emoji_size=1.3,_Tree=g,(g=new _Create_Tile_kind_class).Letter="p",g.Emoji="üîó",g.Emoji_size=.8,_Zoo_tree=g,(g=new _Create_Tile_kind_class).Letter="o",g.Emoji="üåä",g.color={r:0,g:134,b:244,a:255},g.Size=1,_Ocean=g,(g=new _Create_Tile_kind_class).Letter="w",g.Emoji="üåæ",g.color={r:204,g:178,b:0,a:255},g.walkable=!0,g.Pickable=!0,g.Emoji_size=.6,g.Size=1,_Grain=g,(g=new _Create_Tile_kind_class).Letter="f",g.Emoji="üåº",g.walkable=!0,g.Pickable=!0,g.Emoji_size=.3,g.Size=1,_Flower=g,(g=new _Create_Tile_kind_class).Letter="m",g.Emoji=String.fromCharCode(9968),g.Emoji_size=1.4,g.Size=1,_Mountain=g,(g=new _Create_Tile_kind_class).Letter="z",g.Emoji="üè∞",g.Emoji_size=4.4,g.Size=4,_Zoohouse=g,(g=new _Create_Tile_kind_class).Letter="s",g.Emoji="üå±",g.walkable=!0,g.Pickable=!0,g.Emoji_size=.4,g.Size=.4,_Seedling=g,(g=new _Create_Tile_kind_class).Letter="r",g.Emoji="üå∑",g.walkable=!0,g.Pickable=!0,g.Emoji_size=.4,g.Size=.4,_Rose=g,(g=new _Create_Tile_kind_class).Letter="W",g.Emoji="üí®",g.walkable=!0,g.Emoji_size=1,g.Size=1,_Wind=g,(g=new _Create_Tile_kind_class).Letter="S",g.Emoji="üöß",g.walkable=!0,g.Emoji_size=.7,g.Size=.7,_Sign_Post=g,(g=new _Create_Tile_kind_class).Letter="l",g.Emoji="üîí",g.walkable=!0,g.Emoji_size=.7,g.Size=.7,_Lock=g,(g=new _Create_Tile_kind_class).Letter="i",g.Emoji="",g.Size=1,_Invisible_wall=g}function _Tap_to_dismount(){var g=null;if(null!=_You.Guy_it_is_riding&&(tb.mouseclickedany&&_Tapping_on_dismount_area(tb.touchx,tb.touchy)||tb.keyreleased[32])){for(_You.X=_You.Guy_it_is_riding.X,_You.Y=_You.Guy_it_is_riding.Y,_You.Guy_it_is_riding.Guy_riding_it=null,(g=_You.Guy_it_is_riding).Scared_amount=-500,_You.Guy_it_is_riding=null,gvar=1;gvar<=6;gvar++)_You._Go(1,1),g._Go(-1,-1);g._Pen_update()}}function _Tap_to_pick_up_item(){var g=null,t=null;(tb.mouseclickedany&&_Tapping_on_dismount_area(tb.touchx,tb.touchy)||tb.keyreleased[32])&&(t=_Tile_get(Math.floor(_You.X+.5),Math.floor(_You.Y+.7)),null==_You.Tile_kind_holding?t.Kind.Pickable&&(_You.Tile_kind_holding=t.Kind,t.Kind=_Grass,tb.debugset("Pickup item"+_You.Tile_kind_holding.Emoji)):t.Kind==_Grass?(tb.debugset("Drop item"+_You.Tile_kind_holding.Emoji),t.Kind=_You.Tile_kind_holding,_You.Tile_kind_holding=null):t.Kind.Pickable&&(tb.debugset("Swap item with"+t.Kind.Emoji),g=_You.Tile_kind_holding,_You.Tile_kind_holding=t.Kind,t.Kind=g))}function _Tapping_on_dismount_area(g,t){var e;return e=.8*_Tile_size,!!tb.rectshit(g,t,1,1,tb.screensizex/2-e,tb.screensizey/2-e,2*e,2*e)}function _Tile_get(g,t){return tb.rectshit(g,t,0,0,0,0,tb.arraylengthget(_Grid),tb.arrayheightget(_Grid))?_Grid[g][t]:null}function _When_App_Loaded(){"iP"!=tb.stringpart(tb.devicename,1,2,0)&&"Ma"!=tb.stringpart(tb.devicename,1,2,0)||(_Is_Mac=!0),tb.fontset("Segoe UI Emoji"),_Setup_tilekinds(),_Setup_guy_kinds(),_Resized(),_Setup_guys()}function _Create_Guy_class(){return this.Bob=0,this.Facing_right=!1,this.Frame=0,this.Go_amount=0,this.Go_angle=0,this.Guy_it_is_riding=null,this.Guy_riding_it=null,this.Kind=null,this.Penned=!1,this.Scared_amount=0,this.Size=0,this.Speed=0,this.Speed_x=0,this.Speed_y=0,this.Tile_kind_holding=null,this.X=0,this.Y=0,tb.listpush(0,_Guys_list,this),this.Size=.5,null}function _Create_Guy_kind_class(){return this.Emoji="",this.Emoji_frame_2="",this.Emojisize=0,this.Name="",this.Speed=0,this.Unrideable=!1,this.Emojisize=1,null}function _Create_Tile_class(){return this.Add_X=0,this.Add_Y=0,this.Angle=0,this.Kind=null,this.Locked=!1,this.Transparency=0,this.X=0,this.Y=0,null}function _Create_Tile_kind_class(){return this.color={r:0,g:0,b:0,a:255},this.Emoji="",this.Emoji_size=0,this.Image=null,this.Letter="",this.Pickable=!1,this.Size=0,this.walkable=!1,this.Emoji_size=1,tb.listpush(1,_All_tile_kinds,this),null}function _Create_Pen(){return this.Animal_in_it=null,this.Kind_its_for=null,this.Lock_tile=null,tb.listpush(0,_All_pens,this),1==_All_pens.total&&(this.Kind_its_for=_Horse),2==_All_pens.total&&(this.Kind_its_for=_Octopus),3==_All_pens.total&&(this.Kind_its_for=_Pig),4==_All_pens.total&&(this.Kind_its_for=_Sheep),null}function tbmake(){Math.sign||(Math.sign=function(g){return(g>0)-(g<0)||+g});var g=console.log.bind(console);window.location.host;var t=localStorage;t||(t={});var e=2147483648,i=0;tb.canvassaves=0,tb.glis=0,tb.touchx=0,tb.touchy=0,tb.mousedownmouse=0,tb.mouses={},tb.resized=!1,tb.now=0;var m=0,n=0,o=1e3/60,s=0;tb.fps=0,tb.loops=0,tb.running=0;var a=0,r=[];tb.keydown=[],tb.keyhit=[],tb.keyreleased=[],tb.mousedowntime=0,tb.mousehitany=0,tb.mousedownany=0,tb.mousereleasedany=0,tb.mouseclickedany=0,tb.mousewheelspeed=0;var l=22;tb.font="arial",tb.scalex=1,tb.scaley=1,tb.offsetx=0,tb.offsety=0,tb.color={r:255,g:255,b:255,a:255},tb.transparency=0,tb.imagesmoothing=!1;var _,d,u=[];tb.images=[],tb.sounds=[],tb.devicename="device",tb.rootpath="";var c,b,f=4294967040,h=Math.PI/180;tb.degreestoradians=h,tb.audiocontext=null;var p=window.AudioContext||window.webkitAudioContext||!1;try{tb.audiocontext=new p}catch(t){g(t)}var w=function(g){var t=tb.mouses[g];return t||((t={}).index=g,t.x=0,t.y=0,t.speedx=0,t.speedy=0,t.down=0,t.downx=0,t.downy=0,t.movedsincedown=0,tb.mouses[g]=t,t)};tb.mousereal=w("real"),tb.setup=function(){tb.offsettransformedx=0,tb.offsettransformedy=0,tb.mobile=0;var t=navigator.userAgent;/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(t)?(tb.mobile=1,(t=t.toLowerCase()).indexOf("android")>=0?tb.devicename="Android":t.indexOf("iphone")>=0?tb.devicename="iPhone":t.indexOf("ipad")>=0?tb.devicename="iPad":t.indexOf("ipod")>=0&&(tb.devicename="iPod")):(tb.devicename="Windows computer","Mac"==navigator.platform.substr(0,3)&&(tb.devicename="Mac computer"));var e=document.createElement("div");e.innerHTML="\t\t\t<input type='password' id=gbginput spellcheck='false' autocomplete='off' style='position:absolute;top:40px;left:0;width:1px;height:1px;font-size:1px' />\t\t\t<canvas width='0' height='0' id='gglcanvas' style='position:absolute;top:0;left:0'></canvas>\t\t\t<canvas width='0' height='0' id='gcanvas' style='position:relative;top:0;left:0'></canvas>\t\t\t<canvas width='0' height='0' id='gtex' style='display:none;position:absolute;top:0;left:0'></canvas>\t\t",window.galldiv=document.getElementById("galldiv"),galldiv.appendChild(e),window.gcanvas=document.getElementById("gcanvas"),d=gcanvas,_=d.getContext("2d"),window.gdraw=_,tb.imagesmoothingset(!1),tb.mobile?(c=A(tb.rootpath+"/nothing.wav"),galldiv.onclick=K):b=1;var i=function(g){var t;t=g.detail?-120*g.detail:g.wheelDelta,tb.mousewheelspeed=t};window.addEventListener("mousemove",x.bind(tb)),window.addEventListener("mousedown",z.bind(tb)),window.addEventListener("mouseup",G.bind(tb)),window.addEventListener("keydown",Y.bind(tb)),window.addEventListener("keyup",S.bind(tb)),window.addEventListener("resize",y.bind(tb)),window.addEventListener("blur",tb.inputclear.bind(tb)),document.addEventListener("DOMMouseScroll",(function(g){i(g)})),window.addEventListener("mousewheel",(function(g){i(g)})),document.addEventListener("touchstart",(function(t){g("touchstart",t.changedTouches);for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],m=w(i.identifier);m.x=i.clientX,m.y=i.clientY,tb.mousereal.x=m.x,tb.mousereal.y=m.y,m.down=1,M(t,m)}return!v(t)||(t.preventDefault(),!1)}),{passive:!1}),document.addEventListener("touchend",(function(t){g("touchend",t.changedTouches);for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],m=w(i.identifier);m.x=i.clientX,m.y=i.clientY,tb.mousereal.x=m.x,tb.mousereal.y=m.y,E(t,m)}return!v(t)||(t.preventDefault(),!1)}),{passive:!1}),document.addEventListener("touchcancel",(function(t){g("touchcancel",t.changedTouches);for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],m=w(i.identifier);m.x=i.clientX,m.y=i.clientY,tb.mousereal.x=m.x,tb.mousereal.y=m.y,E(t,m)}return t.preventDefault(),!1}),{passive:!1}),document.addEventListener("touchmove",(function(t){g("touchmove",t.changedTouches);for(var e=0;e<t.changedTouches.length;e++){var i=t.changedTouches[e],m=w(i.identifier),n=m.x,o=m.y;if(m.x=i.clientX,m.y=i.clientY,m.down,tb.mousereal.x=m.x,tb.mousereal.y=m.y,k(m,n,o),C(m),tb.clickmovedcallback&&0==tb.clickmovedcallback(t,m))return t.preventDefault(),!1;if(tb.running)return t.preventDefault(),!1}}),{passive:!1}),document.addEventListener("visibilitychange",(function(){if(g("visibilitychange() hidden=",document.hidden),tb.running)for(var t,e=-1;t=tb.sounds[++e];)document.hidden?(t.loopstoppedminimize=0,t.looping&&(t.loopstoppedminimize=1),tb.soundstop(t)):t.loopstoppedminimize&&(t.loopstoppedminimize=0,tb.soundloop(t))}),!1),tb.running=1,tb.rngsetup((new Date).getTime()),_.textAlign="left",_.textBaseline="top",U(),y()},tb.fpsset=function(g){g>0||(g=1),o=1e3/g,tb.fpstimewanted=o},tb.updateshould=function(){tb.now=(new Date).getTime();var g=tb.now-s;return tb.elapsed=g,g<o-1?0:(s=tb.now-g%o,1)},tb.update=function(){for(var g in n++,tb.now>m&&(m=tb.now+1e3,tb.fps=n,n=0),tb.loops++,tb.resized=!1,tb.mouses){var t=tb.mouses[g];t.speedx=0,t.speedy=0}a=0,r=[],tb.keyhit=[],tb.keyreleased=[],tb.mousehitany=0,tb.mousereleasedany=0,tb.mouseclickedany=0,tb.mousewheelspeed=0};var v=function(g){if(tb.running&&b&&!a)return 1};tb.canvasreset=function(){u=[],Z(),_.textAlign="left",_.textBaseline="top"};var y=function(g){tb.screensizex=Math.max(document.documentElement.clientWidth,window.innerWidth||0),tb.screensizey=Math.max(document.documentElement.clientHeight,window.innerHeight||0),gcanvas.setAttribute("width",tb.screensizex),gcanvas.setAttribute("height",tb.screensizey),gcanvas.style.width=tb.screensizex+"px",gcanvas.style.height=tb.screensizey+"px",tb.glis&&(gglcanvas.setAttribute("width",tb.screensizex),gglcanvas.setAttribute("height",tb.screensizey),gglcanvas.style.width=tb.screensizex+"px",gglcanvas.style.height=tb.screensizey+"px"),R(),_.textAlign="left",_.textBaseline="top",U(),tb.running&&window.scrollTo(0,0),tb.resized=!0},z=function(g){if(T(g),tb.mousereal.x=g.clientX,tb.mousereal.y=g.clientY,tb.mousereal.down=1,M(g,tb.mousereal),!v(g))return!0;g.preventDefault()},x=function(g){var t=tb.mousereal,e=t.x,i=t.y;if(t.x=g.clientX,t.y=g.clientY,k(t,e,i),tb.mouseoverdiv=g.target,t.down&&(C(t),tb.clickmovedcallback&&0==tb.clickmovedcallback(g,t)))return g.preventDefault(),!1},k=function(t,e,i){t!=tb.mousereal&&(tb.mouseoverdiv=document.elementFromPoint(t.x,t.y),g("mouseoverdiv="+(tb.mouseoverdiv&&tb.mouseoverdiv.id))),e>-1&&(t.speedx=t.x-e,t.speedy=t.y-i),tb.mousemovedcallback&&tb.mousemovedcallback(t)},T=function(g){tb.keydown[16]&&!g.shiftKey&&(tb.keydown[16]=0,tb.keyreleased[16]=1),tb.keydown[17]&&!g.ctrlKey&&(tb.keydown[17]=0,tb.keyreleased[17]=1)},G=function(g){T(g),E(g,tb.mousereal)},S=function(g){tb.keydown[g.keyCode]=0,tb.keyreleased[g.keyCode]=1},Y=function(t){g(t),tb.keydown[t.keyCode]||(tb.keydown[t.keyCode]=1,tb.keyhit[t.keyCode]=1);var e=t.keyCode;if(r.push(e),g("keydown",e,String.fromCharCode(e),r),9==e)return t.preventDefault(),!1};tb.inkey=function(){return r.shift()||null};var C=function(g){if(g.down){var t=g.x,e=g.y;tb.touchx=t,tb.touchy=e,(Math.abs(g.downx-t)>6||Math.abs(g.downy-e)>6)&&(g.movedsincedown=1)}},M=function(t,e){g("tb _clickstarted()"),tb.mousehitany=1,tb.mousedownany=1,tb.touchx=e.x,tb.touchy=e.y,e.downx=e.x,e.downy=e.y,tb.mousedownmouse=e,tb.mousedowntime=tb.now,e.movedsincedown=0,tb.mouseoverdiv=t.target},E=function(t,e){for(var i in g("clickended()",e),e.down=0,tb.mousereleasedany=1,tb.mousedownany=0,tb.mouses)if(tb.mouses[i].down){tb.mousedownany=1;break}if(!e.movedsincedown&&(tb.mouseclickedany=1,tb.clickedcallback&&!tb.clickedcallback(t,e)))return t.preventDefault(),!1;e!=tb.mousereal&&delete tb.mouses[e.index]};tb.soundvolumeset=function(g,t){if(!g)return 0;if(t<0)throw"Volume cannot be negative: "+t;if(t>1)throw"Volume must be between 0 and 1. Was "+t;g.volume=t,g.audio&&g.audio.play?g.audio.volume=t:g.gainnode&&(g.gainnode.gain.value=t)},tb.soundplay=function(t,e,i){if(!t)throw"Play Sound: Sound is Null";var m=t.audio;if(!m)return 0;if(!t.loaded){if(!(m.readyState>3))return 0;t.loaded=1}if(g("soundplay",t,e,i),m.play){m.pause(),m.currentTime=0,m.volume=t.volume;var n=m.play();n&&n.catch&&n.catch((function(g){console.log("soundplay",g)}))}else if(tb.audiocontext){var o=tb.audiocontext.createBufferSource();if(o&&(o.buffer=m,o.start||(o.start=o.noteOn),o.start)){var s=tb.audiocontext.createGain();o.connect(s),s.connect(tb.audiocontext.destination),s.gain.value=t.volume,i||e?i?o.start(0,e||0,i):o.start(0,e||0):o.start(),t.gainnode=s,t.playedtime=tb.now}}},tb.gethacksound=function(){return c},tb.gethacksoundplayed=function(){return b};var K=function(){!b&&c&&(tb.audiocontext.resume&&tb.audiocontext.resume(),tb.soundplay(c),c.loaded&&(b=1,galldiv.removeAttribute("onclick"),galldiv.onclick=function(){}))};tb.soundloop=function(g){return g&&g.audio?(tb.soundstop(g),g.looping=1,g.loopstopped=0,tb.soundplay(g),void(g.timeout=setTimeout((function(){g.loopstopped||tb.soundloop(g)}),1e3*g.audio.duration))):0},tb.soundstop=function(g){if(!g.loaded)return 0;var t=g.audio;if(!t)return 0;g.looping=0,g.loopstopped=1,g.timeout&&(clearTimeout(g.timeout),g.timeout=0),t.play?(t.pause(),t.currentTime=0):(g.gainnode&&(g.gainnode.gain.value=0),g.playedtime=0)},tb.soundplaying=function(g){var t=g.audio;return t?t.play?!t.paused:g.playedtime?tb.now-g.playedtime<1e3*t.duration:0:0};var A=function(g){var t={volume:1,loaded:0,playedtime:0};return t.audio=document.createElement("audio"),t.audio.addEventListener("canplaythrough",(function(){t.loaded=1}),!1),t.audio.src=g,t};tb.soundloadonline=function(g){if("http"!=g.substr(0,4))throw'Sound URL should start with "http" Instead found "'+g+'"';return A(g)},tb.soundadd=function(g){var t={volume:1,version:1,loaded:0,playedtime:0};return g&&g.substr?("/"==g[0]&&(g=tb.rootpath?tb.rootpath+g:g.substr(1)),t.url=g,L(g,(function(g){t.loaded=1,t.audio=g}))):(t.audio=g,t.loaded=1),tb.sounds.push(t),t};var L=function(g,t){if(!tb.audiocontext)return 0;var e=new XMLHttpRequest;return e.open("GET",g,!0),e.responseType="arraybuffer",e.onload=function(){tb.audiocontext.decodeAudioData(e.response,(function(g){t&&t(g)}),(function(g){}))},e.onerror=function(){},e.send(),e},I=function(g){var t={};return t.val=g,t.next=null,t.prev=null,t},j=function(g,t){for(var e=g.first;;){if(!e)return;if(e.val==t)return e;e=e.next}},P=function(g,t){return t.prev?t.prev.next=t.next:g.first=t.next,t.next?t.next.prev=t.prev:g.last=t.prev,g.total--,t.prev=null,t},X=function(g,t,e,i){if(g.total++,i){if(!e&&!(e=g.first))return g.first=t,void(g.last=t);e.prev?e.prev.next=t:g.first=t,t.prev=e.prev,t.next=e,e.prev=t}else{if(!e&&!(e=g.last))return g.first=t,void(g.last=t);e.next?e.next.prev=t:g.last=t,t.prev=e,t.next=e.next,e.next=t}};tb.listpush=function(g,t,e){if(t){var i=I(e);X(t,i,t.last)}else B(g,"Push: List is null.")},tb.listfirstget=function(g,t){if(t){var e=t.first;return e?e.val:null}B(g,"First Item: List is null.")},tb.listlastget=function(g,t){if(t){var e=t.last;return e?e.val:null}B(g,"Last Item: List is null.")},tb.listpop=function(g,t){if(t){var e=t.last;return e?(P(t,e),e.val):null}B(g,"Pop: List is null.")},tb.listpopfront=function(g,t){if(t){var e=t.first;return e?(P(t,e),e.val):null}B(g,"Pop Front: List is null.")},tb.listinsert=function(g,t,e,i){if(t)if(i<1)B(g,"List Insert: Index cannot be less than 1. It was "+i);else{var m=I(e);if(i>t.total)X(t,m,t.last);else{for(var n=t.first;i>1;i--)n=n.next;X(t,m,n,1)}}else B(g,"List Insert: List is null.")},tb.listitemget=function(g,t,e){if(t){if(e<1)return B(g,"Get Item From List: Index cannot be less than 1. It was "+e),null;if(e>t.total)return null;for(var i=t.first;e>1;e--)i=i.next;return i.val}B(g,"Get Item From List: List is null.")},tb.listinsertbefore=function(g,t,e,i){if(t){var m=I(e),n=j(t,i);n?X(t,m,n,1):B(g,"Insert Before: Item is not in the list.")}else B(g,"Insert Before: List is null.")},tb.listinsertafter=function(g,t,e,i){if(t){var m=I(e),n=j(t,i);n?X(t,m,n):B(g,"Insert After: Item is not in the list.")}else B(g,"Insert After: List is null.")},tb.listremove=function(g,t,e){if(t){var i=j(t,e);i?P(t,i):B(g,"List Remove: item was not in the list.")}else B(g,"Remove From List: List is null.")},tb.textdraw=function(g,t,e){_.fillText(g,t,e)},tb.textdrawrotated=function(g,t,e,i){_.save(),tb.canvassaves++,_.translate(t,e),_.rotate(i*h),_.textAlign="center",_.textBaseline="middle",_.fillText(g,0,0),_.restore(),tb.canvassaves--},tb.textdrawcentered=function(g,t,e){_.textAlign="center",_.textBaseline="middle",_.fillText(g,t,e),_.textAlign="left",_.textBaseline="top"},tb.stringpart=function(g,t,e,i){return g.substr(t-1,e)},tb.browseropen=function(g){window.open(g)},tb.imagedraw=function(g,t,e){return g?g.canvas?void(void 0!==g.angle?W(g,t,e):_.drawImage(g.canvas,t-g.offsetx,e-g.offsety)):(B(void 0,"Draw Image: Image canvas is not set."),0):(B(void 0,"Draw Image: Image value is not set."),0)},tb.imagedrawgl=function(g,t,e,i,m){if(!g)return B(void 0,"Draw Image: Image value is not set."),0;void 0!==i?tb.imagedrawatsize(g,t,e,i,m):tb.imagedraw(g,t,e)},tb.imageoffsetset=function(g,t,e){g.offsetx=t,g.offsety=e};var W=function(g,t,e){_.save(),tb.canvassaves++,_.translate(t,e),_.rotate(g.angle),_.drawImage(g.canvas,-g.offsetx,-g.offsety),_.restore(),tb.canvassaves--},F=function(g,t,e,i,m){_.save(),tb.canvassaves++,_.translate(t,e),_.rotate(g.angle);var n=1,o=1;i<0&&(n=-1),m<0&&(o=-1),_.scale(n,o),_.drawImage(g.canvas,-g.offsetx*i/g.canvas.width*n,-g.offsety*m/g.canvas.height*o,Math.abs(i),Math.abs(m)),_.scale(n,o),_.restore(),tb.canvassaves--};tb.imagedrawatsize=function(g,t,e,i,m){if(i<0||m<0)if(void 0!==g.angle)F(g,t,e,i,m);else{var n=1,o=1;i<0&&(n=-1),m<0&&(o=-1),_.scale(n,o),_.drawImage(g.canvas,t*n-g.offsetx,e*o-g.offsety,Math.abs(i),Math.abs(m)),_.scale(n,o)}else void 0!==g.angle?F(g,t,e,i,m):_.drawImage(g.canvas,t-g.offsetx,e-g.offsety,i,m)},tb.imagesizexget=function(g){return g?g.glis?g.sizex:g.loaded?g.canvas?g.canvas.width:(B(void 0,"Image Width: Image canvas is not set."),0):0:64},tb.imagesizeyget=function(g){return g?tb.glis?g.sizey:g.loaded?g.canvas?g.canvas.height:(B(void 0,"Image Height: Image canvas is not set."),0):0:64},tb.imageadd=function(g){"/"==g[0]&&(g=tb.rootpath?tb.rootpath+g:g.substr(1));var t={};t.canvas=new Image,t.offsetx=0,t.offsety=0,t.canvas.onload=function(){t.loaded=1},t.canvas.src=g,tb.images.push(t)},tb.imageaddviacanvas=function(g){var t=g.getContext("2d");t.textAlign="left",t.textBaseline="top";var e={};return e.canvas=g,e.offsetx=0,e.offsety=0,e.loaded=1,tb.images.push(e),e},tb.assetsallloaded=function(){for(var g,t=-1;g=tb.images[++t];)if(!g.glis&&!g.loaded)return 0;var e;for(t=-1;e=tb.sounds[++t];)if(!e.loaded)return 0;return 1},tb.mod=function(g,t){return g>0?g%t:t>0?g-t*Math.floor(g/t):0==t?g:g%t},tb.rngsetup=function(g){(!g||g<0)&&(g=0),i=g||Math.floor(Math.random()*(e-1))};var D=function(){return i=(1103515245*i+12345)%e};tb.random=function(){return D()/(e-1)},tb.randomint=function(g,t){if(g=Math.floor(g),(t=Math.floor(t))<=g)return g;var i=t+1-g,m=D()/e;return g+Math.floor(m*i)},tb.angleto=function(g,t,e,i){var m=Math.atan2(i-t,e-g)/h;return m<0&&(m+=360),m},tb.clamp=function(g,t,e){if(t>e)throw"Clamp: From cannot be greater than To.";return g<t?t:g>e?e:g},tb.arraylengthget=function(g){if(!g)throw"Array Length: Array is null.";return g.length-1},tb.arrayheightget=function(g){if(!g)throw"Array Height: Array is null.";return g.length?g[1].length-1:0},tb.arraymake=function(g,t,e,i,m){e<1&&B(g,"Array length can't be less than 1. It was "+e);var n=[];if(void 0===i)for(var o=1;o<=e;o++)n[o]=t;else if(void 0===m)for(i<1&&B(g,"Array height can't be less than 1. It was "+i),o=1;o<=e;o++){n[o]=[];for(var s=1;s<=i;s++)n[o][s]=t}else for(m<1&&B(g,"Array depth can't be less than 1. It was "+m),o=1;o<=e;o++)for(n[o]=[],s=1;s<=i;s++){n[o][s]=[];for(var a=1;a<=m;a++)n[o][s][a]=t}return n},tb.debugset=function(g){console.log(g),window.gdebugtextdiv&&(gdebugtextdiv.innerHTML=g)};var B=function(){};tb.fontsizeset=function(g){l=g,_.font=l+"px "+tb.font},tb.fontset=function(g){tb.font=g,_.font=l+"px "+tb.font},tb.rectdraw=function(g,t,e,i){_.fillRect(g,t,e,i)},tb.circledraw=function(g,t,e){if(e<0)return 0;_.beginPath(),_.arc(g,t,e,0,2*Math.PI),_.fill()},tb.offsetset=function(g,t){tb.offsetx=g,tb.offsety=t,H("offset"),Z(),O()},tb.scaleset=function(g,t){tb.scalex=g,tb.scaley=t,H("scale"),Z(),O()};var O=function(){if(tb.glis)for(var g=tb.offsetx,t=tb.offsety,e=0;e<u.length;e++){var i=u[e];if("scale"==i)g*=tb.scalex,t*=tb.scaley;else if("offset"==i)return tb.offsettransformedx=g,void(tb.offsettransformedy=t)}},H=function(g){var t=u.indexOf(g);t>=0&&u.splice(t,1),u.push(g)},R=function(){_.restore(),tb.canvassaves--},Z=function(){R(),U()},U=function(){_.save(),tb.canvassaves++;for(var g=0;g<u.length;g++){var t=u[g];"scale"==t?_.scale(tb.scalex,tb.scaley):"offset"==t&&_.translate(tb.offsetx,tb.offsety)}tb.fontset(tb.font),tb.colorset(tb.color),tb.imagesmoothingset(tb.imagesmoothing),tb.transparencyset(tb.transparency)};tb.imagepixelsget=function(g){return new Uint8Array(new ArrayBuffer(16385))},tb.colormake=function(g,t,e){if(g<0||g>255)throw"RGB Color: Color must be from 0 to 255. Red was "+g;if(t<0||t>255)throw"RGB Color: Color must be from 0 to 255. Green was "+t;if(e<0||e>255)throw"RGB Color: Color must be from 0 to 255. Blue was "+e;return{r:Math.floor(g),g:Math.floor(t),b:Math.floor(e),a:255}},tb.colortostring=function(g){return"rgba("+g.r+","+g.g+","+g.b+","+g.a+")"},tb.cls=function(g){R(),_.fillStyle=tb.colortostring(g),_.fillRect(0,0,tb.screensizex,tb.screensizey),U()},tb.colorset=function(g){tb.color=g,_.fillStyle=_.strokeStyle=tb.colortostring(g),tb.glis&&(f=16777216*g.r+(g.g<<16)+(g.b<<8),tb.drawrgb=f)},tb.colorredget=function(g){return g.r},tb.colorgreenget=function(g){return g.g},tb.colorblueget=function(g){return g.b},tb.transparencyset=function(g){if(g<0)throw"Transparency cannot be negative: "+g;if(g>1)throw"Transparency must be between 0 and 1. Was "+g;_.globalAlpha=1-g,tb.transparency=g},tb.imagemake=function(g,t){var e={url:"",version:1,loaded:1};return e.canvas=tb.canvasmake(g,t),e.offsetx=0,e.offsety=0,e},tb.canvasmake=function(g,t){var e=document.createElement("canvas");e.width=g,e.height=t;var i=e.getContext("2d");return i.imageSmoothingEnabled=!1,i.fillStyle="#FFF",i.strokeStyle="#FFF",i.textAlign="left",i.textBaseline="top",e},tb.imageloaded=function(g){return g.glis?tb.ggl.ready:!!g.loaded},tb.imagesmoothingset=function(g){tb.imagesmoothing=_.mozImageSmoothingEnabled=_.webkitImageSmoothingEnabled=_.msImageSmoothingEnabled=_.imageSmoothingEnabled=g},tb.drawtoscreen=function(g){tb.drawtocanvas(g,gcanvas)},tb.drawtocanvas=function(g,t){if(!t)return B(void 0,"Draw To Image: Image value is not set."),0;if(t==gcanvas)var e=gcanvas;else{if(!t.loaded)return B(g,"Draw To Image: Image has not finished loading yet."),0;if(t.glis)return B(g,"Draw To Image: Cannot draw to images that are hardware accelerated. Resize it first or use Create Image."),0;t.canvas.getContext||function(g){var t=tb.canvasmake(g.canvas.width,g.canvas.height);t.getContext("2d").drawImage(g.canvas,0,0),g.canvas=t}(t),e=t.canvas}if(d==e)return 0;var i=(d=e).getContext("2d");_?(_=i,tb.fontsizeset(l),tb.colorset(tb.color)):_=i},tb.pointincircle=function(g,t,e,i,m){var n=e-g,o=i-t;return n*n+o*o<m*m},tb.rectshit=function(g,t,e,i,m,n,o,s){return g>=m+o||t>=n+s||m>=g+e||n>=t+i?0:1},tb.inputclear=function(){tb.keydown=[],tb.mouses={},tb.mousereal=w("real"),tb.touchx=0,tb.touchy=0,tb.mousedownmouse=0}}window.onload=function(){tb.rootpath="",tb.setup(),_When_App_Loaded(),tb.clickedcallback=_On_Tap,gloop()},_Create_Guy_class.prototype._Can_see_point=function(g,t){var e,i,m,n=null,o=0,s=0;o=this.X,s=this.Y,e=tb.angleto(o,s,g,t),i=.1*Math.cos(e*tb.degreestoradians),m=.1*Math.sin(e*tb.degreestoradians);for(var a=0;!tb.pointincircle(o,s,g,t,1);){if(a++>999999)throw{line:6,message:"Infinite While Loop"};if(o+=i,s+=m,n=_Tile_get(Math.floor(o+.5),Math.floor(s+.5)),!this._Can_walk_through_tile(n))return!1}return!0},_Create_Guy_class.prototype._Can_walk_through_tile=function(g){return!!(g.Kind.walkable||this.Kind==_Octopus&&g.Kind==_Ocean)&&(g.Kind!=_Lock||this.Kind==_Woman||null!=this.Guy_riding_it)},_Create_Guy_class.prototype._Draw=function(){var g,t=0,e="";tb.offsetset((this.X-_Camera_x)*_Tile_size+tb.screensizex/2,(this.Y-_Camera_y)*_Tile_size+tb.screensizey/2),this.Facing_right&&tb.scaleset(-1,1),tb.fontsizeset(_Tile_size*this.Kind.Emojisize),e=this.Kind.Emoji,""!=this.Kind.Emoji_frame_2&&this.Frame>=2&&(e=this.Kind.Emoji_frame_2),null!=this.Guy_it_is_riding?(t=0-(7+3*Math.sin(this.Bob*tb.degreestoradians)),tb.textdrawrotated(e,0,1*Math.sin(this.Bob*tb.degreestoradians),t)):(t=0-(7+7*Math.sin(this.Bob*tb.degreestoradians)),tb.textdrawrotated(e,0,0,t)),null!=this.Guy_riding_it&&tb.imagedrawgl(_You_image,0,-.34*_Tile_size-_Tile_size*_You.Kind.Emojisize*.05-0,_Tile_size,_Tile_size),null!=this.Tile_kind_holding&&(tb.fontsizeset(_Tile_size*this.Tile_kind_holding.Emoji_size*.8),tb.textdrawrotated(this.Tile_kind_holding.Emoji,-.2*_Tile_size,0,t)),tb.scaleset(1,1),g=_Tile_get(Math.floor(this.X+.5),Math.floor(this.Y+.5)),null==this.Guy_it_is_riding&&g.Kind==_Ocean&&(tb.colorset(g.Kind.color),tb.transparencyset(.5),tb.circledraw(0,.2*_Tile_size,.2*_Tile_size,0,2*Math.PI),tb.circledraw(.2*_Tile_size,.2*_Tile_size,.2*_Tile_size,0,2*Math.PI),tb.circledraw(-.2*_Tile_size,.2*_Tile_size,.2*_Tile_size,0,2*Math.PI),tb.transparencyset(0)),_Guy_who_is_talking==this&&(tb.fontsizeset(4.5*_Tile_size),tb.textdrawcentered("üóØ",2.1*_Tile_size,-2.2*_Tile_size),tb.colorset(tb.colormake(0,0,0,255)),tb.fontsizeset(.3*_Tile_size),this==_Zookeeper&&(_All_penned()?(tb.textdrawcentered("üòÑ",2.1*_Tile_size,-3.3*_Tile_size),tb.textdrawcentered("You did it!",2.1*_Tile_size,-2.9*_Tile_size),tb.textdrawcentered("It's still sunny",2.1*_Tile_size,-2.5*_Tile_size),tb.textdrawcentered("Gather us flowers?",2.1*_Tile_size,-2.1*_Tile_size)):(tb.textdrawcentered("üòü",2.1*_Tile_size,-3.3*_Tile_size),tb.textdrawcentered("A storm is coming!",2.1*_Tile_size,-2.9*_Tile_size),tb.textdrawcentered("Bring the animals",2.1*_Tile_size,-2.5*_Tile_size),tb.textdrawcentered("back to their pens!",2.1*_Tile_size,-2.1*_Tile_size))),this==_Farmer&&(tb.textdrawcentered("ü§†",2.1*_Tile_size,-3.3*_Tile_size),tb.textdrawcentered("I'm a farmer.",2.1*_Tile_size,-2.9*_Tile_size),tb.textdrawcentered("Feel free to take",2.1*_Tile_size,-2.5*_Tile_size),tb.textdrawcentered("all my crops!",2.1*_Tile_size,-2.1*_Tile_size)))},_Create_Guy_class.prototype._Go=function(g,t){g>0&&(this.Facing_right=!0),g<0&&(this.Facing_right=!1),this.X+=g*this.Speed,this._Hit_map()?(this.X-=g*this.Speed,this.Speed_x=0):this.Speed_x=g*this.Speed,this.Y+=t*this.Speed,this._Hit_map()?(this.Y-=t*this.Speed,this.Speed_y=0):this.Speed_y=t*this.Speed,this.Bob+=(Math.abs(g)+Math.abs(t))*this.Speed*333,null!=this.Guy_riding_it&&(this.Guy_riding_it.Bob+=(Math.abs(g)+Math.abs(t))*this.Speed*333),this.Frame+=(Math.abs(g)+Math.abs(t))*this.Speed*1.5,this.Frame>=3&&(this.Frame=1),null!=this.Guy_riding_it&&(this.Guy_riding_it.X=this.X,this.Guy_riding_it.Y=this.Y-.35,this.Guy_riding_it.Facing_right=this.Facing_right)},_Create_Guy_class.prototype._Hit_guy=function(){for(var g=null,t=_Guys_list.first;t;){if((g=t.val)!=this&&this.Guy_it_is_riding!=g&&Math.pow(g.X-this.X,2)+Math.pow(g.Y-this.Y,2)<.35)return g;t=t.next}return null},_Create_Guy_class.prototype._Hit_map=function(){var g,t,e,i,m=0,n=0,o=null;for(g=Math.floor(this.X+(1-this.Size)/2),t=Math.floor(this.X+(1-this.Size/2)),e=Math.floor(this.Y+(1-this.Size)/2),i=Math.floor(this.Y+(1-this.Size/2)),n=e;n<=i;n++)for(m=g;m<=t;m++){if(null==(o=_Tile_get(m,n)))return!0;if(!this._Can_walk_through_tile(o))return!0}return!1},_Create_Guy_class.prototype._Pen_update=function(){for(var g=null,t=_All_pens.first;t;){if((null==(g=t.val).Animal_in_it||g.Animal_in_it==this)&&tb.rectshit(this.X,this.Y,0,0,g.Lock_tile.X-1.5,g.Lock_tile.Y-5,3,5))return void(g.Animal_in_it!=this&&(g.Animal_in_it=this,g.Lock_tile.Locked=!0,this.Penned=!0));t=t.next}if(this.Penned)for(var e=_All_pens.first;e;)(g=e.val).Animal_in_it==this&&(g.Animal_in_it=null,g.Lock_tile.Locked=!1,this.Penned=!1),e=e.next},_Create_Guy_class.prototype._Tile_get2=function(){return _Tile_get(Math.floor(this.X+.5),Math.floor(this.Y+.5))},_Create_Guy_class.prototype._Update=function(){var g,t=0,e=!1,i=0,m=0,n=null,o=0,s=0,a=0,r=0;if(this==_You)tb.mousedownany&&(_Tapping_on_dismount_area(_Touch_start_x,_Touch_start_y)||(t=tb.angleto(tb.screensizex/2,tb.screensizey/2,tb.touchx,tb.touchy),i=Math.cos(t*tb.degreestoradians),m=Math.sin(t*tb.degreestoradians))),t=1,(tb.keydown[38]||tb.keydown[87])&&(t=270),(tb.keydown[40]||tb.keydown[83])&&(t=90),(tb.keydown[39]||tb.keydown[68])&&(t=1!=t?90==t?45:315:0),(tb.keydown[37]||tb.keydown[65])&&(t=1!=t?90==t?135:225:180),1!=t&&(i=Math.cos(t*tb.degreestoradians),m=Math.sin(t*tb.degreestoradians)),n=this._Hit_guy(),_Guy_who_is_talking=null,null!=n&&(null==this.Guy_it_is_riding&&Math.abs(this.Speed_x)+Math.abs(this.Speed_y)<.16&&(n.Kind.Unrideable||(this.Guy_it_is_riding=n,n.Guy_riding_it=this,this.Frame=1,n.Go_amount=0,n.Scared_amount=0)),n.Kind.Unrideable&&(_Guy_who_is_talking=n));else if(this.Kind!=_Man&&null==this.Guy_riding_it){if(o=2.5,(e=!!tb.rectshit(this.X,this.Y,1,1,_You.X-o,_You.Y-o,2*o,2*o)&&this._Can_see_point(_You.X,_You.Y))||(this.Scared_amount>0&&(this.Scared_amount-=.5),this.Scared_amount<0&&(this.Scared_amount+=.5)),e&&this.Kind==_Horse&&_You.Tile_kind_holding==_Grain)this.Go_angle=tb.angleto(this.X,this.Y,_You.X,_You.Y),this.Go_amount=2;else{if(!this.Penned&&(e&&this.Scared_amount<=0||this.Go_amount<=0&&this.Scared_amount>0))for(e&&(this.Scared_amount+=1),r=1;r<=1+tb.clamp(.2*this.Scared_amount,0,100);r++){if(t=tb.angleto(_You.X,_You.Y,this.X,this.Y),t+=(tb.random()-.5)*tb.clamp(5*this.Scared_amount,0,300),o=2+2/r,s=this.X+Math.cos(t*tb.degreestoradians)*o,a=this.Y+Math.sin(t*tb.degreestoradians)*o,this._Can_see_point(s,a)){this.Go_angle=t,this.Go_amount=33;break}e&&(this.Scared_amount+=3)}this.Scared_amount<=0&&tb.random()<.03&&(t=tb.randomint(1,360),o=2*(tb.random()+1),s=this.X+Math.cos(t*tb.degreestoradians)*o,a=this.Y+Math.sin(t*tb.degreestoradians)*o,this._Can_see_point(s,a)&&(this.Go_angle=t,this.Go_amount=66))}this.Go_amount>0&&(this.Go_amount-=1,i=Math.cos(this.Go_angle*tb.degreestoradians),m=Math.sin(this.Go_angle*tb.degreestoradians),this.Scared_amount<=0&&(i*=.1,m*=.1))}this.Scared_amount<=0&&this.Kind==_Pig&&(m=0),(g=this._Tile_get2()).Kind==_Wind&&(tb.debugset(""+this.Y),tb.mod(this.Y+.5,1)>.2&&(i=1,m=.1)),this==_You&&(_Tile_that_is_talking=null,g.Kind==_Sign_Post&&(_Tile_that_is_talking=g)),this.Speed_x=0,this.Speed_y=0,null!=this.Guy_it_is_riding?this.Guy_it_is_riding._Go(i,m):this._Go(i,m),this.Penned&&null!=this.Guy_riding_it&&this._Pen_update()}</script>