<!doctype html><style>body{margin:0;background:#222}body,div{display:flex;width:100vw;height:100vh;overflow:hidden;align-items:center;justify-content:center;color:#eee;background:#000;font-family:monospace}div{position:fixed;display:none}body.l div{display:flex}canvas{width:100%;height:100%;object-fit:contain}</style><body class=l><canvas width=600 height=400></canvas><div>Generating audio assets...</div><script>"use strict";let aa={38:88,67:16,17:90},ba=[,"#0ff","#01f","#f80","#ff0","#0f0","#909","#f00"],ca=[,"#5aa","#549","#a74","#995","#5a4","#747","#954"];var k={},m={},p=null,da={};function q(t){return p.buttons[t].pressed}function ea(){return Object.values(k).some((t=>t))}function r(t){return!!k[t]&&!m[t]}function fa(){if(p){var t=function(t,e){e&&!da[t]&&(ha(t),da[t]=!0),!e&&da[t]&&(ia(t),da[t]=!1)};t(37,-.3>(p=navigator.getGamepads()[p.index]).axes[0]||q(14)),t(39,.3<p.axes[0]||q(15)),t(32,-.3>p.axes[1]||q(12)),t(40,.3<p.axes[1]||q(13)),t(88,q(1)||q(3)),t(90,q(0)||q(2)),t(16,q(4)||q(5)||q(6)||q(7)),t(27,q(8)||q(9)||q(10))}}function ja(){Object.entries(k).forEach((([t,e])=>{m[t]=e}))}function ha(t){t=aa[t]||t,m[t]=k[t],k[t]=!0}function ia(t){t=aa[t]||t,m[t]=k[t],k[t]=!1}document.addEventListener("keydown",(({repeat:t,keyCode:e})=>{t||ha(e)}),!1),document.addEventListener("keyup",(({keyCode:t})=>{ia(t)}),!1),window.addEventListener("gamepadconnected",(t=>{p||(p=t.gamepad)}));let t=document.querySelector("canvas"),u=t.getContext("2d");function ka(){u.resetTransform()}function la(t,e,i,a){u.fillRect(t,e,i,a),u.strokeRect(t,e,i,a)}function ma(t,e,i){u.save(),u.translate(t,e),i(),u.restore()}function v(t,e,i,a=0,s=1,n=1,h=0){ma(e,i,(()=>{u.rotate(h),u.scale(s,n);let e=t.L[a];u.drawImage(t.S,e.x,e.y,e.s,e.o,-e.v,-e.w,e.s,e.o)}))}u.imageSmoothingEnabled=!1;class na{constructor(){this.y=this.x=this.u=0,this.M=this.T=!1,this.F=0,this.D=[0,0],this.a=0,this.b=.01}move(t,e){this.x+=t,this.y+=e}I(){this.u=(this.u+1)%4}H(){this.u=(this.u+3)%4}i(){if(this.a++,60<this.a&&Math.random()<this.b){if(this.F)this.F=0;else if(.4>Math.random())return this.a=50,void(this.F=this.b=1);this.a=0,this.b=.01,this.D=[4*Math.random()-2,4*Math.random()-2]}}}function w(t,e,i){return class extends na{ca(){return t}N(){return ba[t]}B(){return e[this.u].map((([t,e])=>[this.x+t,this.y+e]))}ea(){return i[this.u]}da(){return i[(this.u+3)%4].map((([t,e])=>[-t,-e]))}}}let x=[[[0,0],[-1,0],[-1,1],[0,-2],[-1,-2]],[[0,0],[1,0],[1,-1],[0,2],[1,2]],[[0,0],[1,0],[1,1],[0,-2],[1,-2]],[[0,0],[-1,0],[-1,-1],[0,2],[-1,2]]],oa=w(6,[[[0,0],[-1,0],[0,1],[1,0]],[[0,0],[0,1],[1,0],[0,-1]],[[0,0],[1,0],[0,-1],[-1,0]],[[0,0],[0,-1],[-1,0],[0,1]]],x),pa=[[0,1],[1,1],[0,0],[1,0]],qa=w(4,[pa,pa,pa,pa],[]),y=new AudioContext,z=y.createDynamicsCompressor();z.knee.setValueAtTime(40,0),z.threshold.setValueAtTime(-12,0),z.connect(y.destination);let A,B=y.sampleRate;async function C(t,e=1,i=!1){let a=y.createBufferSource();if(a.buffer=await t,i&&a.connect(A),1!==e){let t=y.createGain();t.gain.setValueAtTime(e,0),a.connect(t),a.onended=()=>t.disconnect(z),t.connect(z)}else a.connect(z);a.start()}function D(t,e){for(;t.b<t.a.length-1;){let[i,a,s=1]=t.a[t.b],[n,h]=t.a[t.b+1];if(i<=e&&e<n)return e=(e-i)/(n-i),e=1<s?e**s:1-(1-e)**(1/s),t.g?a*(h/a)**e:a+e*(h-a);t.b++}return t.a[t.a.length-1][1]}class E{constructor(t,e=!1){this.a=t,this.g=e,this.b=0}}async function ra(){await new Promise((t=>requestAnimationFrame(t)))}function G(t,e){return(t=t.toString()).length>e?Array(e).fill(9).join(""):Array(e-t.length).fill(0).join("")+t}function H(){return 2*Math.random()-1}function sa(t){return"number"==typeof t?[[0,t],[1,t]]:t}function ta(t,e){let i=0,a=0;for(let s=0;s<t.length;++s){let n=e(s/(t.length-1)),h=t[s],r=h*n[0]+i;t[s]=r,i=h*n[1]-r*n[3]+a,a=h*n[2]-r*n[4]}return t}function ua(t,e,i=Math.SQRT1_2){let a=new E(sa(e),!0),s=new E(sa(i));return ta(t,(t=>{{var e=D(a,t),i=D(s,t);let n=1/(1+(i=1/i)*(e=1/Math.tan(Math.PI*e/B))+(t=e*e));e=[n,2*n,n,2*n*(1-t),n*(1-i*e+t)]}return e}))}function I(t,e,i=Math.SQRT1_2){let a=new E(sa(e),!0),s=new E(sa(i));return ta(t,(t=>{{var e=D(a,t),i=D(s,t);let n=1/(1+(i=1/i)*(e=1/Math.tan(Math.PI*e/B))+(t=e*e));e=[n*e*i,0,-n*e*i,2*n*(1-t),n*(1-i*e+t)]}return e}))}function J(t,e){t=new Float32Array(t*B);for(let i=0;i<t.length;i++)t[i]=e(i/t.length,i/B);return t}function K(t,e){e=new E(e);for(let i=0;i<t.length;i++)t[i]*=D(e,i/t.length);return t}async function L(t){t=t(),Array.isArray(t)||(t=[t]);let e=y.createBuffer(t.length,t[0].length,B);for(let i=0;i<t.length;i++)e.getChannelData(i).set(t[i]);return await ra(),e}function va(){return I(K(J(.2,H),[[0,0,.5],[.1,.3,.2],[1,0]]),[[0,2e3,.2],[1,800]])}function wa(t,e,i,a=!1){Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);for(let s=0;s<e.length;s++){let n=t[s%t.length],h=e[s%e.length],r=Math.min(i+n.length,h.length);for(let t=i;t<r;t++)h[t]=a?n[t-i]:h[t]+n[t-i]}}function xa(t){let e=0,i=[],a=0;return t.forEach((([t,...s])=>{t<a&&(e+=4),a=t,i.push([e+t,...s])})),i}function M(t,e,i,a,s=!1){let n={};t.forEach((t=>{let h=t.slice(1).join("|");n[h]||(n[h]=i(440*2**(t[1]/12),...t.slice(2))),wa(n[h],e,Math.round(B*t[0]*60/a),s)}))}function N(t,e){return t.forEach((t=>{t[0]+=e})),t}function ya(t,e){for(let e=0;e<t.length-1;e++)t[e][2]=t[e+1][0]-t[e][0];return t[t.length-1][2]=e-t[t.length-1][0],t}function za(t){t.a.forEach((t=>{t.source&&t.source.disconnect(),t.source=null}))}function Aa(t,e=1){t.a.forEach((t=>{t.Z.linearRampToValueAtTime(0,y.currentTime+e)})),setTimeout((()=>za(t)),1e3*e)}function Ba(){var t=Ca;t.a.forEach((t=>{t.source.playbackRate.setValueAtTime(1,y.currentTime),t.source.playbackRate.linearRampToValueAtTime(1e-4,y.currentTime+1)})),setTimeout((()=>za(t)),1e3)}class Da{constructor(t,e=null){let i=y.createGain();this.a=t.map((t=>{let e=y.createGain();if(e.connect(i),t.K){let i=y.createGain();i.gain.value=t.K,e.connect(i),i.connect(A)}return{buffer:t.buffer,fa:e,volume:t.volume,Z:e.gain}})),this.b=e,i.connect(z)}play(){this.a.forEach((t=>{t.source&&t.source.disconnect();let e=y.createBufferSource();this.b&&(e.loop=!0,e.loopStart=this.b.start,e.loopEnd=t.buffer.duration),e.buffer=t.buffer,e.connect(t.fa),e.start(),t.source=e,t.Z.setValueAtTime(1,y.currentTime)}))}}function O(t,e){return()=>{let i=0,a=[[0,0],[.01/e,.2,.5],[1-.01/e,.2,.5],[1,0]];return ua(K(J(e,(function(e){return i+=440*2**(t[0|e*t.length]/12)/B,2*(i%1<.5-.2*e)-1})),a),4200)}}let Ea=O([-2],.1),Fa=O([-2,5],.2),Ga=O([-2,5,10],.3),Ha=O([10,17,10,17,10,5,5,8,8],.5),Ia=O([-2,5,-2,10,5,10,15,10,15,17,15,17,22],.6);function Ja(){function t(){let t=0,e=[];do{e.push([t,Math.random()]),t+=.01}while(1>=t);return e}let e=t(),i=t(),a=[[0,0,.5],[.05,1,.2],[1,0]];return[K(K(J(4,H),e),a),K(K(J(4,H),i),a)]}let Ka=Math.ceil(80*B),La=960/132,Ma=[[0,0],[.001,.12,.35],[.04,.02,.3],[1,0,1]];function Na(t){let e=[[0,Math.min(B/2,18*t),.5],[1,t/3]],i=Math.random();return ua(K(J(4,(function(){return i+=t/B,.4*(2*(.5>i%1)-1)+.4*(2*(.55>2*i%1)-1)})),Ma),e,1)}function Oa(){let t=new Float32Array(Ka);return M(N(xa([[0,5],[1,1],[1.5,0],[2,-2],[3,1],[3.5,0],[0,-2],[1.5,1],[2,5],[3,3],[3.5,1],[0,0],[.5,-2],[1,-4],[1.5,-7],[2,3],[3,5],[0,1],[1,-2],[2,0],[2.5,-4],[3,-2],[3.5,-7],[0,-6],[.5,3],[1.5,6],[2,10],[3,8],[3.5,6],[0,5],[1.5,1],[2,5],[3,1],[3.5,0],[0,-2],[1.5,-7],[2,-2],[2.5,1],[3,5],[3.5,3],[0,1],[1,-2],[1.96,-3],[2.04,0],[.5,-2],[1.5,1],[2,5],[3,10],[3.5,8],[0,5],[1.5,1],[2,5],[3,3],[3.5,1],[0,0],[1,1],[1.5,3],[2,5],[2.5,0],[3,-2],[3.5,-3],[0,-2],[1,-7],[2,-14],[0,5],[0,1],[0,-2],[2,1],[2,-2],[2,-7],[0,3],[0,-2],[0,-6],[2,0],[2,-2],[2,-6],[0,1],[0,-2],[0,-6],[2,-2],[2,-6],[2,-9],[0,-4],[0,-7],[0,-11],[2,0],[2,-4],[2,-7],[0,-6],[0,-11],[1.5,-2],[1.5,-6],[3,1],[3,-4],[0,3],[0,-2],[1,1],[1,-2],[1.5,0],[1.5,-2],[2,1],[2,-4],[3,0],[3,-4],[0,-6],[0,-11],[1.5,-2],[1.5,-6],[3,1],[3,-4],[0,3],[0,0],[1,1],[1,-4],[1.25,0],[1.25,-4],[1.75,0],[1.75,-3],[3,-7],[3,-12],[0,5],[1,1],[1.5,0],[2,-2],[3,1],[3.25,0],[3.75,-2],[.5,-2],[1.25,-2],[1.5,1],[2,5],[3,3],[3.5,1],[0,0],[.5,-2],[1,-4],[1.25,-7],[2,3],[3,5],[0,1],[1,-2],[2,0],[2.5,-4],[3,-2],[3.25,-7],[3.75,-6],[.5,3],[1.5,6],[2,10],[2.5,10],[3,8],[3.25,6],[3.75,5],[1.5,1],[2,5],[2.5,5],[2.75,1],[3.25,0],[3.75,-2],[.5,-2],[1.25,-2],[1.5,-7],[2,-2],[2.5,1],[3,5],[3.25,3],[3.75,1],[.5,1],[1,-2],[1.96,-3],[2.04,0],[.5,-2],[1.5,1],[2,5],[2.5,5],[3,10],[3.25,8],[3.75,5],[.5,5],[1.25,5],[1.5,1],[2,5],[2.5,5],[3,3],[3.25,1],[3.75,0],[.5,0],[1,1],[1.5,3],[2,5],[2.5,0],[3,-2],[3.25,-3],[0,-2],[1,-7],[1.5,-6],[1.75,-7],[2,-14],[0,5],[0,1],[0,-2],[2,1],[2,-2],[2,-7],[0,3],[0,-2],[0,-6],[2,0],[2,-2],[2,-6],[0,1],[0,-2],[0,-6],[2,-2],[2,-6],[2,-9],[0,-4],[0,-7],[0,-11],[2,0],[2,-4],[2,-7],[0,-6],[0,-11],[1.5,-2],[1.5,-6],[3,1],[3,-4],[0,3],[0,-2],[1,1],[1,-2],[1.25,0],[1.25,-2],[1.75,0],[1.75,-2],[3,-4],[3,-7],[0,-6],[0,-11],[1.5,-2],[1.5,-6],[3,1],[3,-4],[0,3],[0,0],[1,1],[1,-4],[1.5,0],[1.5,-4],[2,0],[2,-3],[2,-7],[3,-7],[3,-12],[3,-15]]),16),t,Na,132),t}let Pa=[[0,0,1],[.005,.06,.5],[.05,.015,.1],[1,0,1]];function Qa(t){let e=0;return ua(K(J(2,(function(){return e+=t/B,2*(.5>e%1)-1})),Pa),9500)}let Ra=[[0,1,3],[.25,0,1/3],[.5,-1,3],[.75,0,1/3],[1,1]];function Sa(t,e){let i=1/(1e3*e),a=[[0,0,2],[2*i,1,20],[1-2*i,.5],[1,0]],s=[[0,.055],[1,.055*Math.max(0,1-e/3)]],n=0,h=new E([[0,7,2],[15*i,0]]),r=new E(Ra);return K(K(J(e,(function(e){return n+=t*2**(D(h,e)/12)/B,1<n&&(--n,r.b=0),D(r,n)})),s),a)}let Ta=N(xa([[0,-26],[2,-26],[3.5,-23],[0,-30],[2,-30],[0,-28],[1.5,-28],[2,-31],[3,-31],[0,-26],[1.5,-26],[2,-26],[3,-28],[3.5,-34],[0,-33],[2,-33],[3.5,-33],[0,-23],[1.5,-23],[2,-23],[3,-23],[0,-21],[1,-21],[2,-24],[3,-24],[3.5,-23],[0,-31],[1,-31],[2,-31],[3.5,-26],[0,-30],[1.5,-30],[2,-30],[0,-28],[1.5,-28],[2,-28],[0,-27],[1,-27],[2,-31],[3,-31],[0,-26],[1,-31],[2,-26],[0,-26],[2,-26],[0,-26],[2,-26],[0,-26],[2,-26],[0,-35],[2,-31],[0,-30],[2,-28],[0,-26],[2,-28],[0,-30],[2,-30],[0,-28],[2,-27],[0,-26],[2,-26],[3.5,-23],[0,-30],[2,-30],[0,-28],[1.5,-28],[2,-31],[3,-31],[0,-26],[1.5,-26],[2,-26],[3,-28],[3.5,-34],[0,-33],[2,-33],[3.5,-33],[0,-23],[1.5,-23],[2,-23],[3,-23],[0,-21],[1,-21],[2,-24],[3,-24],[3.5,-23],[0,-31],[1,-31],[2,-31],[3.5,-26],[0,-30],[1.5,-30],[2,-30],[0,-28],[1.5,-28],[2,-28],[0,-27],[1,-27],[2,-31],[3,-31],[0,-26],[1,-31],[2,-26],[0,-26],[.5,-26],[1,-26],[1.5,-26],[2,-26],[2.5,-26],[3,-26],[3.5,-23],[0,-30],[.5,-30],[1,-30],[1.5,-30],[2,-30],[2.5,-30],[3,-30],[3.5,-26],[0,-33],[.5,-33],[1,-33],[1.5,-33],[2,-33],[2.5,-33],[3,-33],[3.5,-33],[0,-35],[.5,-35],[1,-35],[1.5,-35],[2,-31],[2.5,-31],[3,-31],[3.5,-31],[0,-30],[.5,-30],[1,-30],[1.5,-30],[2,-28],[2.5,-28],[3,-28],[3.5,-28],[0,-26],[.5,-26],[1,-26],[1.5,-26],[2,-28],[2.5,-28],[3,-28],[3.5,-28],[0,-30],[.5,-30],[1,-30],[1.5,-30],[2,-30],[2.5,-30],[3,-30],[3.5,-30],[0,-28],[.5,-28],[1,-28],[1.5,-28],[2,-27],[2.5,-27],[3,-27],[3.5,-27]]),16);function Ua(){let t=new Float32Array(Ka);return M(ya(Ta,176),t,Sa,132,!0),t}function Va(){let t=new Float32Array(Ka);return M([...Ta,...xa([[0,-14],[.5,-7],[.5,-2],[1.5,-7],[1.5,-2],[2,-14],[2.5,-7],[2.5,-2],[3.5,-14],[3.5,-7],[3.5,-2],[0,-18],[.5,-11],[.5,-7],[1.5,-11],[1.5,-7],[2,-18],[2.5,-11],[2.5,-7],[3.5,-11],[3.5,-7],[0,-16],[.5,-12],[.5,-9],[1.5,-16],[1.5,-12],[1.5,-9],[2,-19],[2.5,-12],[2.5,-9],[3,-19],[3.5,-12],[3.5,-9],[0,-14],[.5,-11],[.5,-7],[1,-19],[1.5,-11],[1.5,-7],[2,-26],[3.5,10],[3.667,12],[3.833,13],[.5,-7],[.5,-2],[1.5,-7],[1.5,-2],[2.5,-7],[2.5,-2],[3.5,-7],[3.5,-2],[.5,-11],[.5,-7],[1.5,-11],[1.5,-7],[2.5,-11],[2.5,-7],[3.5,-11],[3.5,-7],[.5,-12],[.5,-9],[1.5,-12],[1.5,-9],[2.5,-12],[2.5,-9],[3.5,-12],[3.5,-9],[.5,-11],[.5,-7],[1.5,-11],[1.5,-7],[2.5,-11],[2.5,-7],[3.5,-11],[3.5,-7],[.5,-14],[.5,-9],[1.5,-14],[1.5,-9],[2.5,-14],[2.5,-9],[3.5,-14],[3.5,-9],[.5,-7],[.5,-4],[1.5,-7],[1.5,-4],[2.5,-7],[2.5,-4],[3.5,-7],[3.5,-4],[.5,-6],[.5,-2],[1.5,-6],[1.5,-2],[2.5,-6],[2.5,-2],[3.5,-6],[3.5,-2],[.5,-7],[1,-2],[1.5,-7],[2.5,-7],[3,-7],[3,-3],[3.5,-3],[3.5,0],[.5,-6],[.5,-2],[.5,1],[1.5,-6],[1.5,-2],[1.5,1],[2.5,-6],[2.5,-2],[2.5,1],[3.5,-6],[3.5,-2],[3.5,1],[.5,-4],[.5,0],[.5,3],[1.5,-4],[1.5,0],[1.5,3],[2.5,-4],[2.5,0],[2.5,3],[3.5,-4],[3.5,0],[3.5,3],[.5,-3],[.5,0],[.5,3],[1.5,-3],[1.5,0],[1.5,3],[2.5,-3],[2.5,1],[2.5,5],[3.5,-3],[3.5,1],[3.5,5],[0,1],[0,5],[1,-3],[1,0],[2,-7],[1,-7],[1,-2],[3,-7],[3,-2],[1,-6],[1,-2],[3,-6],[3,-2],[1,-6],[1,-2],[3,-6],[3,-2],[1,-4],[1,0],[3,-4],[3,0],[1,-2],[1,1],[3,0],[3,3],[1,1],[1,5],[3,0],[3,3],[1,-2],[1,1],[3,-2],[3,1],[1,-4],[1,1],[1,5],[3,-3],[3,0],[3,5],[3.5,10],[3.667,12],[3.833,13],[.5,-7],[.5,-2],[1.5,-7],[1.5,-2],[2.5,-7],[2.5,-2],[3.5,-7],[3.5,-2],[.5,-11],[.5,-7],[1.5,-11],[1.5,-7],[2.5,-11],[2.5,-7],[3.5,-11],[3.5,-7],[.5,-12],[.5,-9],[1.5,-12],[1.5,-9],[2.5,-12],[2.5,-9],[3.5,-12],[3.5,-9],[.5,-11],[.5,-7],[1.5,10],[1.5,-11],[1.5,-7],[1.667,12],[1.833,13],[2,12],[2.5,-11],[2.5,-7],[2.5,8],[3,10],[3.25,5],[3.5,-11],[3.5,-7],[3.75,6],[.5,-14],[.5,-9],[1.5,-14],[1.5,-9],[2.5,-14],[2.5,-9],[3.5,-14],[3.5,-9],[.5,-7],[.5,-4],[1.5,-7],[1.5,-4],[2.5,-7],[2.5,-4],[3.5,-7],[3.5,-4],[.5,-6],[.5,-2],[1.5,-6],[1.5,-2],[2.5,-6],[2.5,-2],[3.5,-6],[3.5,-2],[.5,-7],[1,-2],[1.5,-7],[2.5,-7],[3,-7],[3,-3],[3.5,-3],[3.5,0],[.5,-6],[.5,-2],[.5,1],[1.5,-6],[1.5,-2],[1.5,1],[2.5,-6],[2.5,-2],[2.5,1],[3.5,-6],[3.5,-2],[3.5,1],[.5,-4],[.5,0],[.5,3],[1.5,-4],[1.5,0],[1.5,3],[2.5,-4],[2.5,0],[2.5,3],[3.5,-4],[3.5,0],[3.5,3],[.5,-3],[.5,0],[.5,3],[1.5,-3],[1.5,0],[1.5,3],[2.5,-3],[2.5,1],[2.5,5],[3.5,-3],[3.5,1],[3.5,5],[0,1],[0,5],[1,-3],[1,0],[2,-7],[3.5,10],[3.667,12],[3.833,13],[1,-7],[1,-2],[3,-7],[3,-2],[1,-6],[1,-2],[3,-6],[3,-2],[1,-6],[1,-2],[3,-6],[3,-2],[1,-4],[1,0],[3,-4],[3,0],[1,-2],[1,1],[3,0],[3,3],[1,1],[1,5],[3,0],[3,3],[1,-2],[1,1],[3,-2],[3,1],[1,-4],[1,1],[1,5],[3,-3],[3,0],[3,5],[3.5,10],[3.667,12],[3.833,13]])],t,Qa,132),t}async function Wa(){let[t,e,i]=await Promise.all([Oa,Va,Ua].map((t=>L(t))));return new Da([{buffer:t,K:.5},{buffer:e,K:.5},{buffer:i}],{start:La})}let Xa=Math.ceil(1219.98/120*B);function Ya(){let t=new Float32Array(Xa);return M([[0,-6],[.167,-4],...N([[0,-2],[1,-2],[1.333,-2],[1.667,-2],[2,0],[2.5,0],[2.667,-4],[2.833,-9],[3,0],[3.667,3],[4,5],[4,10],[5,5],[5,10],[5.667,2],[5.833,3],[6,5],[7.667,2],[7.833,3],[8,5],[8.333,10],[8.667,8],[9,5],[9.667,3],[10,5],[10.333,3],[10.667,5],[11,2],[11.667,-4],[12,-14],[12.167,-7],[12.25,-2],[12.333,0],[12.5,2]],.333)],t,Na,120),t}function Za(){let t=new Float32Array(Xa);var e=[[0,-18],[1,-18],[1.333,-18],[1.667,-18],[2,-16],[3,-16],[3.667,-16],[4,-14],[8,-14],[9,-16],[10,-17],[11,-19]];for(let t=0,i=e.length;t<i;t++){let[i,a,...s]=e[t];e.push([i,a+12,...s])}return M(N(e=[...e,[4.333,5],[4.667,10],[5,14],[5.333,10]],.333),t,Qa,120),t}function $a(){let t=new Float32Array(Xa);return M(ya(N([[0,-30],[1,-30],[1.333,-30],[1.667,-30],[2,-28],[3,-28],[3.667,-28],[4,-26],[8,-26],[9,-28],[10,-29],[11,-31],[12.25,-26]],.333),20.333),t,Sa,120,!0),K(t,[[0,1],[.9,1],[1,0]]),t}async function ab(){let[t,e,i]=await Promise.all([Ya,Za,$a].map((t=>L(t))));return new Da([{buffer:t,K:.5},{buffer:e,K:.5},{buffer:i}])}var bb={J:"data:image/gif;base64,R0lGODlh8AAGAIAAAP///////yH5BAEAAAEALAAAAADwAAYAAALXjAOny4ngTHwRuivthdn244FgSHWbp52SWJrI+ipVHIfaeFboPfeiv0oFWYwFBsaBvYBHYoOWmC2V0Z9VZsxSi1Xp6AGeDsfiMnYLrKmVtG3xDHU6c1EbiZpM1/PaZbJdU+WW9QfYNSVYlrj4QaSH6BhJyHPD5jVxZ/nktRbIIZSGZvTXUwk4xBm3oWqDmBnnJnioSNrH9gR32Ye5KQl7pagKfPs4KEsMzDgR+GvMcjz7yzuIO6pD1/hMcodJyhe0nWeH0vDtiYPGk9y4TKHMLVPI23SpUQAAOw=="},cb={J:"data:image/gif;base64,R0lGODlh0wASAIAAAP///wAAACH5BAEAAAEALAAAAADTABIAAAL/BIKpYdv8IDQU0fjukSmuflmbqJFZKU7op46au2HHO8dwatqguTsjHpLQWidiTeH5DD3LlzFF+yGdT05F6DzprNmbqjf15bBKDPTGlIrP4TUZ+EuWXTguryHXHrl0Ga8OBtcyCJLG8QZYpljoxyYY+PVXV4SFp1YUJKOZGWXYpkfIuNPUxnIYuNKE4inaWkVZkbp1laZH2xknRTlxalHoU8LK4iecYxk0rObwS9RDjLwL+9uYPAeb+zSEeMytrNptOWqzlWh9W30YvtZoq25XyjiLrS2bXhOLDGybjeZVnHyl1yNEzvzBODewnKmFDBs6fAgxosSJFCtalBgCHK6N4RyDdfwIMmQUIyJL4jOJMuDFlSxbunwJM6bDPgx8jaNTs4MrXRlVRsrp6yfQMfSgjQkaz9VPXZKayiRzZMbQGJOQ5mSKRKdVqlpxDv2qNezVrVbBxiFrD6lXsDCluhXClipXb8uydrV7Fuhatl/zcg2K1W5dwDWl6hWr7CVNuZLmjuXV18zdyYBXAVOiD2eqy2IRE75quXPMxTYxP7aCdzBav6kpl+3MOq7q11PL/j3N9ynD2LE/w27tG/dtvoEf0xXsuXbf1ch1QzSqfOmtk7VybTp4M2/y4X9kVf8dSujTAgA7",L:[{x:0,y:0,s:52,o:10,v:26,w:4},{x:53,y:0,s:67,o:10,v:33,w:4},{x:121,y:0,s:45,o:10,v:22,w:4},{x:0,y:11,s:14,o:5,v:7,w:3},{x:15,y:11,s:38,o:7,v:19,w:3},{x:54,y:11,s:43,o:7,v:21,w:3},{x:98,y:11,s:39,o:7,v:19,w:3},{x:139,y:11,s:39,o:7,v:19,w:3},{x:167,y:0,s:44,o:10,v:22,w:4}]},db={J:"data:image/gif;base64,R0lGODlhEQAIAPD/AAAAAP///yH5BAUAAAIALAAAAAARAAgAAAIclIBgywsBg2rsRTjpuVgbe03ZsXFZcoZelaxGAQA7",L:[{x:0,y:0,s:8,o:8,v:4,w:4},{x:9,y:0,s:8,o:8,v:4,w:4},{x:18,y:0,s:8,o:8,v:4,w:4}]},eb={J:"data:image/gif;base64,R0lGODlhTwArAIAAAP///wAAACH5BAEAAAEALAAAAABPACsAAAL/jI+pywcNo5y0vYqzjnf7CoTiSJbmeX5Up2ZsC8eyZc5LKoeMbge88vtccK/WsOZTPVDMptOZ3CxFPSm1KJlWYTosJLg1enfjsBVEppod6tvE+yrHWGN53dddT/O7BAkPJWcEGDiCULYXFba39NVn4adHqOhW+eiwRmlnaYDE9ifUNvkZB3Qo5UHniMl62ooh6GYIN9lRpKoRazrbhwL4qhuZW9t79drp6oLKK2uMLEwqSigNG2XbhvsMzUnJhZ1seCyerJ1zyny5vcs3o4rOTR7p3H4+bwpZ3Gjjbq9+fz8kzRM1pZLcySKQ1rBb1Mal8+fwjUJ4HB5GHEQxyy0gIsFobPTTkaOtT+Z+aWuYqgsYLiATLXqZcR/Mf2ZCoonZoAAAOw==",L:[{x:0,y:0,s:79,o:43,v:39,w:0}]},fb={J:"data:image/gif;base64,R0lGODlhMwAuAKIAACKxTKNJpACi6P/yAP9/J////+0cJAAAACH5BAEAAAcALAAAAAAzAC4AAAP/eLpc9o/JSattMMPL+zGYJoIU4Z3OqEpEe3ZqTC7me6XyaL+5vB8DTowx/E0iH91RZKSQVk5N0wKNbi41ntI6o00V1eiklb0EK+FTmUdML7pfdDG+y3EK5PVZsRfaJ3h5LnQ9EoGCgwUDizBLPgqIgnyLfXWPkgeSlJuVYEhcTHkMopybElJUSoM0ZECljG+oqaFrra6MnLGysxuRraaTsG6Ovb4mlAy5c3IZmb7BEqaPzMWYt5XSf6eottGwycg94s4WyN7C4kWrrLcTwEnptLUu5uDf8PFIxjX1C+90APFp8PVqAICDCA8KWMhwYYCHEB8GnLgi0jVTCQ8uaChAbYFEjwE8ySP16kBGjRwXHoC48mOsUWvAMdCoAGVHBSpbstwGs5u/PjRNAjiQk+hNnWJY+Zw086TRjUd38mRX4Z7TpzhvRgw5FRIimQtoIjTKEalUTz1F/WwadijZnC5dTowTg+CrkwpTCtjKMgEAOw==",L:[{x:0,y:0,s:51,o:46,v:25,w:0}]};function P(t){return new Promise((e=>{let i=new Image;i.onload=()=>{t.S=i,e(t)},i.src=t.J}))}let gb,Q,hb,ib,jb,Ca,kb,lb=L((function(){return I(K(J(.1,H),[[0,.5,.2],[.3,0],[.301,.4,.2],[.5,0],[.501,.35,.2],[1,0]]),1800,3)})),mb=L((function(){return I(K(J(.2,H),[[0,.3,.2],[1,0]]),1800,2)})),nb=L(va),R=L((function(){return I(K(J(.1,H),[[0,.1,.2],[1,0]]),2e3)})),ob=[L(Ea),L(Fa),L(Ga),L(Ia)],pb=L((function(){return I(K(J(.2,H),[[0,.2,.2],[1,0]]),2e3)})),qb=L(va),rb=L((function(){let t=new E([[0,5],[.3,12],[.6,10]]),e=0;return K(J(.25,(function(i){return i=D(t,i),i=e+=440*2**(i/12)/B,i%=1,Math.sin(2*Math.PI*(3-2*i)*i*i)})),[[0,0,.1],[.3,.3,20],[.5,0],[.6,0,.1],[.8,.3],[1,0]])})),sb=L(Ha);async function tb(){let t=y.createConvolver(),e=Ja(),i=y.createBuffer(2,e[0].length,B);i.getChannelData(0).set(e[0]),i.getChannelData(1).set(e[1]),t.buffer=i,A=y.createGain(),A.gain.value=.7,A.connect(t),t.connect(z),await ra()}let S,T=0,ub=0,U=1;class vb{constructor(t,e){this.a=t,this.f=e}i(){this.C();{var t=this.f,e=this.a;let i=t.h.get(e);for(let[e,a]of i)t.a[a][e]=0;wb(t,e)}this.P&&this.f.P(this.a)}move(t,e){return this.a.move(t,e),xb(this.f,this.a)?(this.a.move(-t,-e),!1):(this.O=0,!0)}H(){let t=this.a.da();this.a.H();for(let e of t){if(this.a.move(e[0],e[1]),!xb(this.f,this.a))return this.O=1,!0;this.a.move(-e[0],-e[1])}return this.a.I(),!1}I(){let t=this.a.ea();this.a.I();for(let e of t){if(this.a.move(e[0],e[1]),!xb(this.f,this.a))return this.O=1,!0;this.a.move(-e[0],-e[1])}return this.a.H(),!1}}function yb(t){14>t.l?(t.b=30,t.l++):(C(nb),t.done=!0)}class zb extends vb{constructor(t,e){super(t,e),this.m=k[37]||k[39]?0:12,this.A=0,this.g=60*(.8-.007*(U-1))**(U-1),this.l=0,this.b=-1,this.h=this.g,this.c=0,this.G=!1,this.O=null}C(){this.g=60*(.8-.007*(U-1))**(U-1);let t=this.a.x,e=this.a.u;var i=k[37]?-1:k[39]?1:0;if(i&&(r(37)||r(39)?(this.move(i,0)&&C(R),this.m=12):0>=this.m&&0>=this.A&&(this.move(i,0)&&C(R),this.A=2),this.m--,this.A--),i=this.a instanceof qa,r(90)?(i||this.H())&&C(lb):r(88)&&(i||this.I())&&C(lb),r(32)){for(i=0;this.move(0,-1);)i++;T+=2*i,C(pb),this.done=!0}else{i=0,r(40)&&(this.c=0);var a=!1;if(this.g<1/this.f.height)i=this.f.height;else{if(a=!!k[40])for(this.c--;0>=this.c;)i++,this.c+=this.g/30;for(this.h--;0>=this.h;)a||i++,this.h+=this.g}var s=0;for(let t=0;t<i&&this.move(0,-1);t++)s++;0<s&&(0<this.l&&this.l--,a&&(T+=s,C(R)))}this.move(0,-1)?(this.move(0,1),i=void 0):i=!0,i&&!this.G&&C(mb),i||(this.b=0),!i||t===this.a.x&&e===this.a.u||yb(this),i&&0>=this.b&&yb(this),0<this.b&&(this.b--,i?0===this.b&&(C(nb),this.done=!0):this.b=0),this.G=i}}class V{constructor(t){this.g=t,this.b=this.a=0}i(){this.a++,this.b=this.a/this.g,this.a===this.g&&(this.done=!0)}}class Ab extends V{constructor(t,e){super(30),this.c=t,this.rows=e}j(){let t=20>this.a?this.a:0;u.fillStyle=20>this.a?`rgba(255,255,255,${this.a/15})`:"#000";for(let e of this.rows)u.fillRect(-t,16*(this.c.ga-1-e),this.c.width+2*t,16)}}class Bb{constructor(t){this.a=t,this.b=0}N(){return this.b?ca[this.a]:ba[this.a]}i(){this.b=1}}let Cb=new Bb(1);function xb(t,e){for(let[i,a]of e.B()){if(0>i||i>=t.width||0>a)return!0;if(a>=t.a.length)continue;let s=t.a[a][i];if(s&&s!==e)return!0}return!1}function W(t,e,i){return 0>e||e>=t.width||0>i?Cb:t.a[i][e]}function Db(t,e){return t.a[e].every((t=>!t))}function Eb(t,e){return t.a[e].every((t=>t))}function Fb(t,e){if(t.a[t.height+2].some((t=>t)))return!0;e=e.B();for(let[i,a]of e)if(t.a[a+t.height][i+t.width/2-1])return!0;return!1}function wb(t,e){let i=[];for(let[a,s]of e.B())t.a[s][a]=e,i.push([a,s]);t.h.set(e,i),t.g.add(e),t.b.add(e)}function Gb(t,e,i){for(let a=0;a<t.width;a++){let s=t.a[e][a];s&&i(s)}}function Hb(t,e){e.sort(((t,e)=>t-e));let i=new Map,a=0;for(let s=0;s<t.c;s++)s===e[a]?(Gb(t,s,(e=>{e instanceof Bb&&t.b.delete(e)})),a++):(Gb(t,s,(t=>{t instanceof na&&i.set(t,a)})),t.a[s-a]=t.a[s]);for(let[e,a]of i)e.y-=a,wb(t,e);for(e=t.c-a;e<t.c;e++)t.a[e]=Array(t.width).fill(0)}function Ib(t,e){let i=new Set;for(let a of e)Gb(t,a,(t=>{t instanceof na&&i.add(t)}));return i}class Jb{constructor(t,e){for(this.width=t,this.height=e,this.c=this.height+4,this.a=[],t=0;t<this.c;t++)this.a.push(Array(this.width).fill(0));this.g=new Set,this.b=new Set,this.h=new Map}P(t){this.g.delete(t),this.b.delete(t),this.h.delete(t);for(let[e,i]of t.B())this.a[i][e]=0}}let Kb={".":[0,2],":":[2,2],"!":[4,2],"+":[6,6],"-":[12,6],",":[18,3]};function X(t,e,i,a=1,s=0){let n=0,h=0;for(let r=0;r<t.length;r++)if(" "===t[r])n+=6+s;else if("\n"===t[r])n=0,h+=8;else{let o,c=Kb[t[r]],l=6;c?(o=c[0],l=c[1]):o="A">t[r]?25+6*(t.charCodeAt(r)-48):85+6*(t.charCodeAt(r)-65),u.drawImage(gb.S,o,0,l-1,6,e+a*n,i+a*h,a*(l-1),6*a),n+=l+s}}function Y(t,e,i,a=1){X(t,e,i,a,1),X(t,e+a,i,a,1)}function Lb(t,e,i){X(t,e-6*t.length/2,i,1)}function Mb(t,e){Y(t,-(0|7*t.length/2),e,1)}function Nb(t){t.a=0,t.l.push(new Ab(t.c,[t.m])),t.m++}class Ob extends V{constructor(t,e){super(e?120:200),this.C=e,this.c=t,this.m=0,this.l=[],Nb(this),this.A=new E([[0,0],[.4,0,2],[.45,2.5,1.5],[.5,2]])}i(){super.i(),2<this.a&&this.m<this.c.f.height&&Nb(this),this.h++,this.l.forEach((t=>{t.i()}))}j(){if(this.l.forEach((t=>t.j())),10<this.a){let t=this.c.width/2,e=D(this.A,(this.a-10)/60);this.C||v(Q,t,112,8,e,e),this.a>=this.g&&30>(this.a-this.g)%60&&(Lb("PRESS ANY BUTTON",t,160),Lb("TO START A NEW GAME",t,167))}}}class Pb extends V{constructor(t){super(30),this.c=t,this.x=60*Math.random()}j(){this.done||(u.globalAlpha=1-this.b**2,X((0<this.c?"+":"")+this.c,20+this.x,294-this.a/2,2),u.globalAlpha=1)}}class Qb extends V{constructor(){super(120),this.c=new E([[0,0],[.1,0,2],[.2,1.3,1.5],[.3,1],[.9,1,2]])}j(){if(!this.done){var t=D(this.c,this.b);X("BACK-TO-BACK",-36*t,150,t)}}}class Rb extends V{constructor(t){super(120),this.type=t,this.m=[1,2].includes(t),this.c={3:2,1:2,2:2,4:2,5:2,6:2,10:0,11:1}[t],this.h={2:4,4:4,5:5,6:6}[t],void 0===this.c&&(this.done=!0),this.l=new E([[0,0,2],[.1,1.75,1.5],[.2,1],[.9,1,2],[1,1.4]]),this.C=new E([[0,0,6],[.2,1.2,1.5],[.3,1]]),this.A=new E([[0,2===this.c?2*Math.PI:0,.04],[1,0]])}j(){if(!this.done){var t=this.b,e=D(this.l,t),i=D(this.C,t);t=D(this.A,t),this.m&&v(Q,0,100,3,e,e),v(Q,0,112,this.c,e,e,t),this.h&&v(Q,0,130,this.h,i,i)}}}let Sb=w(1,[[[-1,0],[0,0],[1,0],[2,0]],[[1,1],[1,0],[1,-1],[1,-2]],[[-1,-1],[0,-1],[1,-1],[2,-1]],[[0,1],[0,0],[0,-1],[0,-2]]],[[[0,0],[-2,0],[1,0],[-2,-1],[1,2]],[[0,0],[-1,0],[2,0],[-1,2],[2,-1]],[[0,0],[2,0],[-1,0],[2,1],[-1,-2]],[[0,0],[1,0],[-2,0],[1,-2],[-2,1]]]),Tb=w(3,[[[-1,0],[0,0],[1,0],[1,1]],[[0,1],[0,0],[0,-1],[1,-1]],[[-1,0],[0,0],[1,0],[-1,-1]],[[0,1],[0,0],[0,-1],[-1,1]]],x),Ub=w(2,[[[-1,0],[0,0],[1,0],[-1,1]],[[0,1],[0,0],[0,-1],[1,1]],[[-1,0],[0,0],[1,0],[1,-1]],[[0,1],[0,0],[0,-1],[-1,-1]]],x),Vb=w(5,[[[-1,0],[0,0],[0,1],[1,1]],[[0,1],[0,0],[1,0],[1,-1]],[[1,0],[0,0],[0,-1],[-1,-1]],[[0,-1],[0,0],[-1,0],[-1,1]]],x),Wb=w(7,[[[1,0],[0,0],[0,1],[-1,1]],[[0,-1],[0,0],[1,0],[1,1]],[[-1,0],[0,0],[0,-1],[1,-1]],[[0,1],[0,0],[-1,0],[-1,-1]]],x);class Xb{constructor(){this.a=[Sb,Tb,Ub,oa,qa,Vb,Wb];for(let t=6;1<t;t--){let e=0|Math.random()*(t+1),i=this.a[e];this.a[e]=this.a[t],this.a[t]=i}}}function Yb(t){let e=t.a.a.pop();return e?new e:(t.a=new Xb,Yb(t))}class Zb{constructor(){this.a=new Xb}}let $b={"-1":"2",1:"3"};function Z(t,e=5,i=""){if(0===e)return"";let a=t.a.x,s=t.a.y,n=t.a.u,h=()=>{t.a.x=a,t.a.y=s,t.a.u=n};if(t.move(0,1)&&t.move(0,1))return i+"11";if(h(),t.a.M&&t.move(0,1))return i+"1";if(h(),t.move(0,1)){var r=Z(t,e-1,i+"1");if(r)return r}if(h(),t.move(t.b,0)&&(r=Z(t,e-1,i+$b[t.b])))return r;if(h(),t.move(-t.b,0)&&(t.b=-t.b,r=Z(t,e-1,i+$b[t.b])))return r;if(h(),!(t.a instanceof qa)){if(t.H()&&(r=Z(t,e-1,i+"5")))return r;if(h(),t.I()&&(e=Z(t,e-1,i+"4")))return e;h()}return""}class ac extends vb{constructor(t,e){super(t,e),this.g=[],this.c=this.h=0,this.m=5<U?1:2,this.l=0,this.b=1}C(){if(!this.done&&(this.a.M=!0,this.h++,this.h===this.m))t:{if(this.h=0,T+=5*-U,this.c<this.g.length){switch(this.g[this.c]){case"1":this.move(0,1),C(R);break;case"2":this.move(-1,0),C(R);break;case"3":this.move(1,0),C(R);break;case"4":this.I(),C(lb);break;case"5":this.H(),C(lb)}this.c++}else{if(!this.move(0,1)){if(10<this.l){this.a.M=!1,this.done=!0;break t}this.l++,this.c=0,this.g=Z(this);break t}C(R)}this.a.y>this.f.height&&(this.P=this.done=!0)}}}class bc extends V{constructor(t,e){super(120),this.x=t,this.y=e,this.c=H(),this.h=H()}i(){super.i(),this.c+=.5,this.y+=this.c,this.x+=this.h}j(){v(hb,this.x-4,this.y,0),v(hb,this.x+4,this.y,0)}}class cc{constructor(t){this.a=t}j(){this.a.paused=!0,this.a.j(),this.a.paused=!1,ka(),u.fillStyle="rgba(0,0,0,0.8)",u.fillRect(0,0,t.width,t.height)}}class dc extends cc{constructor(t,e=!1){super(t),this.b=e,k={},m={}}i(){(r(27)||this.b&&ea())&&(S=this.a)}j(){super.j(),u.setTransform(1,0,0,1,t.width/2,0),u.scale(2,2),Mb("PAUSED",30),u.scale(.5,.5),Mb("INSTRUCTIONS",100),X("YOUR GOAL IS PLAIN AND SIMPLE.\n\nMAKE 200 LINES WITH THE TETROMINOES THAT FALL DOWN\nEITHER AS FAST AS POSSIBLE OR WITH AN END SCORE AS\nHIGH AS POSSIBLE.\nTHERE IS ONE CATCH THOUGH: THESE TETROMINOES WILL\nTRY FLEEING ONCE THEY REALIZE THEIR FATE IS TO BE\nDISINTEGRATED! SO TRY TO NEUTRALIZE THEM BEFORE\nTHEY GO BACK UP.\n\nTRY TO CLEAR AS MUCH LINES AT THE SAME TIME AS\nPOSSIBLE, AND ALSO TRY OUT SOME TRICKS... THEY MIGHT\nREWARD YOU SOME EXTRA POINTS...\n\nGOOD LUCK!",-150,118),u.setTransform(1,0,0,1,t.width/2-100,248),Mb("KEYBOARD CONTROLS",0),X("UN/PAUSE GAME   - ESC\nHARD DROP       - SPACE\nSOFT DROP       - ARROW DOWN\nROTATE CLOCKW   - ARROW UP/X\nROTATE C CLOCKW - CTRL/Z\nHOLD            - SHIFT/C\n",-83,18),u.setTransform(1,0,0,1,t.width/2+100,248),Mb("GAMEPAD CONTROLS",0),v(ib,0,22),X("HOLD",-12,15),X("HARD\nDROP",-64,33),X("SOFT\nDROP",-32,66),X("ROTATE\nC.CLOCKW",7,66),X("ROTATE\nCLOCKW",42,36)}}function ec(e){if(!e.image){e.image=document.createElement("canvas"),e.image.width=t.width+80,e.image.height=t.height+80;var i=e.image.getContext("2d");for(let t=0;t<e.image.width;t+=80)for(let a=0;a<e.image.height;a+=80)i.save(),i.translate(t+28,a+20),i.rotate(-Math.PI/4),i.drawImage(jb.S,-25,-20),i.restore();i.fillStyle="rgba(0,0,0,0.85)",i.fillRect(0,0,e.image.width,e.image.height)}}class fc{constructor(){this.y=this.x=0,this.direction=this.a=Math.PI/3,this.speed=1}i(t){var e=this.speed;t=t?.5:1.08**U;var i=1/30;this.speed=e>t?Math.max(e-i,t):Math.min(e+i,t),e=2*Math.PI,e=2*(t=(this.a-this.direction)%e)%e-t,this.direction+=e/500,.1>Math.abs(e)&&(this.a=Math.random()*Math.PI*2),this.x+=Math.cos(this.direction)*this.speed,this.y+=Math.sin(this.direction)*this.speed,-80>=this.x&&(this.x+=80),-80>=this.y&&(this.y+=80),0<this.x&&(this.x-=80),0<this.y&&(this.y-=80)}j(){u.drawImage(this.image,this.x,this.y)}}let gc=new fc;function hc(t){200<=ub?ic(t):(jc(t,t.C.shift()),t.C.push(Yb(t.Y)))}function kc(t,e){let i=[];for(var a of e)Eb(t.f,a)&&i.push(a);i.sort(((t,e)=>t-e)),nc(t,e=lc(t),a=i.length,mc(t,i)),0===a?Fb(t.f,t.C[0])?(t.b=new Ob(t,!0),Ba()):hc(t):(oc(t,i),t.a=null)}function pc(t){for(var e=0;e<t.f.height;e++)for(var i=0;i<t.f.width;i++){var a=W(t.f,i,e);a&&qc(i,19-e,a.N(),16,a instanceof Bb)}if(!t.b){for(var s of t.f.g)rc(s);if(t.a){e=sc,i=t.a,a=t.a.B(),s=[0,0,0,0];for(let e=0;4>e;e++){let[i,n]=a[e];for(let a=0;a<=n;a++){let h=W(t.f,i,n-a);if(h&&h!==t.a)break;s[e]=a}}e(t,i,a=-Math.min(...s),16,19),tc(t.a,16,19)}}t.c&&t.c.j(),t.b&&t.b.j();for(let e of t.R)e.j()}function uc(t){let e=0|t.time/60%1*100,i=0|(t=0|t.time/60)/60;return`${G(0|t/3600,2)}:${G(i%60,2)}:${G(t%60,2)}.${G(e,2)}`}function vc(t){let e=8;for(let i=0;i<t.C.length;i++)tc(t.C[i],e,3),0===i?(u.translate(0,5*e),e*=.75):u.translate(0,4*e)}function sc(t,e,i,a,s){t=e.B(),e=e.N(),t.forEach((t=>t[1]+=i));for(let[i,n]of t)wc(i,s-n,e,a)}function tc(t,e,i){let a=t.B(),s=t.N();for(let[t,n]of a)qc(t,i-n,s,e);16===e&&rc(t)}function lc(t){if(!(t.a instanceof oa)||1!==t.controller.O)return!1;let e=t.a.x,i=t.a.y,a=[!!W(t.f,e-1,i+1),!!W(t.f,e+1,i+1),!!W(t.f,e+1,i-1),!!W(t.f,e-1,i-1)];return!(1<!a[0]+!a[1]+!a[2]+!a[3])&&(t=[W(t.f,e-1,i)===t.a,W(t.f,e,i+1)===t.a,W(t.f,e+1,i)===t.a,W(t.f,e,i-1)===t.a],2>[a[0]+t[1]+a[1],a[1]+t[2]+a[2],a[2]+t[3]+a[3],a[3]+t[0]+a[0]].filter((t=>3===t)).length?1:3)}function mc(t,e){for(e=e.length;20>e;e++)if(!Db(t.f,e))return!1;return!0}function nc(t,e,i,a){T+=50*U*t.m,ub+=i,U=0|ub/10+1,e&&C(rb,1,!0),a?(xc(t,11),C(sb,1,!0),T+=1500*U):0<i&&(C(ob[i-1],1,!0),t.V&&4===i?(t.l=new Qb,T+=1200*U):T+={1:100,2:300,3:500,4:800}[i]*U,xc(t,6+i)),3===e?(t.V&&0<i?(t.l=new Qb,T+=600*(i+1)*U):T+=400*(i+1)*U,xc(t,3+i)):1===e&&(T+=U*(i+1)*100,xc(t,1+i)),t.W||(0<i?(t.m++,t.V=e||4===i):t.m=0)}function oc(t,e){t.c=new Ab(t,e);var i=Ib(t.f,e),a=t.f;for(var s of i){for(let[t,e]of s.B())a.a[e][t]=new Bb(s.ca()),a.b.add(a.a[e][t]);a.g.delete(s),a.b.delete(s)}for(var n of i){let[e,i]=n.B()[1];t.R.add(new bc(16*(e+.5),16*(19-i+.5)))}for(var h of(a=new Set,e))for(e=0;10>e;e++)a.add(`${e}:${h}`);for(var r of i)for(let[t,e]of r.B())a.add(`${t}:${e}`);for(o of(h=1e3,i=-1e3,a))r=Number(o.split(":")[1]),h=Math.min(r,h),i=Math.max(r,i);var o=new Set;for(--h;h<=i+1;h++)for(r=0;10>r;r++)if(!a.has(`${r}:${h}`)&&(e=W(t.f,r,h))instanceof na)for(s=[`${r-1}:${h}`,`${r+1}:${h}`,`${r}:${h-1}`,`${r}:${h+1}`],n=0;4>n;n++)if(a.has(s[n])){o.add(e);break}a=new Set;for(let t of o)t.T&&a.add(t),t.T=!0,(o=t).D=[0,2],o.a=30,o.b=1;t.ba=a}function xc(t,e){e&&(t.A=new Rb(e))}function ic(t){t.b=new Ob(t),Aa(Ca),setTimeout((()=>kb.play()),700)}function qc(t,e,i,a=16,s=!1){u.fillStyle=i,u.fillRect(t*a,e*a,a-1,a-1),s||(u.fillStyle="rgba(255,255,255,0.5)",u.fillRect(t*a,e*a,2,a),u.fillRect(t*a,e*a,a,2))}function rc(t){u.fillStyle="#000";let[e,i]=t.B()[1],a=16*(19-i+.5),s=16*(e+.25),n=16*(e+.75);if(t.M)t.F=0,t.D=[0,-2];else if(t.T){t.F=0;let e=2*Math.random()-1;s+=e,n+=e,a+=2*Math.random()-1}v(hb,s,a,t.F),v(hb,n,a,t.F),0===t.F&&(u.fillRect(s-1+t.D[0],a-1+t.D[1],2,2),u.fillRect(n-1+t.D[0],a-1+t.D[1],2,2))}function jc(t,e){for(t.a=e,e.x=t.f.width/2-1,e.y=t.f.height-2,e.D=[0,2];xb(t.f,e);)e.move(0,1);wb(t.f,e),t.controller=new zb(e,t.f)}function wc(t,e,i,a=16){u.fillStyle=i,u.fillRect(t*a,e*a,a-1,a-1),u.fillStyle="#000",u.fillRect(t*a+1,e*a+1,a-3,a-3)}class yc{constructor(){k={},m={},ub=T=0,U=1,this.ga=20,this.time=0,this.f=new Jb(10,20),this.width=160,this.height=320,this.V=!1,this.m=0,this.h=new Set,this.G=[],this.R=new Set,u.lineWidth=2,this.U=gc,ec(this.U),this.Y=new Zb,this.g=null,this.C=Array.from(Array(6),(()=>Yb(this.Y))),hc(this),this.X=!1,this.aa=Array.from(Array(20),((t,e)=>e))}i(){if(this.X||(this.X=!0,Aa(kb,.1),Ca.play()),r(27))S=new dc(this);else{if(this.b){if(this.b.done&&ea())return void(S=new yc)}else this.time++;if(this.A&&!this.A.done&&this.A.i(),this.l&&!this.l.done&&this.l.i(),this.U.i(this.b),this.c&&!this.c.done)this.c.i();else{for(var t of(this.b&&this.b.i(),this.R))t.i(),t.done&&this.R.delete(t);for(var e of this.G)e.i();for(var i of this.f.b)i.i()}if(this.c){if(this.c.done){Hb(this.f,this.c.rows),this.c=null;var a,s=this.ba,n=new Set;for(a of s){{e=(t=s=new ac(a,this.f)).a.x,i=t.a.y;let n=t.a.u;t.g=Z(t),t.a.x=e,t.a.y=i,t.a.u=n,t=!!t.g}t&&n.add(s)}this.h=a=n,0<this.h.size?this.a=null:hc(this)}}else{if(a=T,t=0<this.h.size||this.b,0<this.h.size){for(s of this.h)s.i(),s.done&&this.h.delete(s);0===this.h.size&&(this.W=!0,kc(this,this.aa),this.W=!1)}if(!t)if(r(16)&&!this.controller.$)this.f.P(this.a),this.g&&Fb(this.f,this.g)?(this.b=new Ob(this,!0),Ba()):(C(qb),n=this.g,this.g=this.a,this.g.x=0,this.g.y=0,this.g.u=0,n?jc(this,n):hc(this),this.controller.$=!0);else if(this.controller.i(),this.controller.done){for(n of(this.a.D=[0,0],s=this.a.B(),t=new Set,s))t.add(n[1]);kc(this,t)}T!==a&&(this.G.push(new Pb(T-a)),4===this.G.length&&this.G.shift())}}}j(){ka(),u.clearRect(0,0,t.width,t.height),this.U.j(),u.translate((t.width-160)/2,(t.height-320)/2),u.strokeStyle="#fff",u.fillStyle="#000",la(-1,-1,162,322),this.paused||pc(this),u.translate(185,0),u.fillStyle="#000",la(-16,-1,48,170),X("TIME:",-17,189),Y(uc(this),-17,196),X("LEVEL:",-17,210),Y(G(Math.min(20,U),2),-17,217),X("LINES:",-17,231),Y(G(ub,4),-17,238),X("SCORE:",-17,297),Y(G(T,9),-17,309,2);for(let t of this.G)t.j();this.paused||this.b||vc(this),ka(),u.translate((t.width-160)/2-40,(t.height-320)/2+10),u.fillStyle="#000",la(-17,-11,48,40),Y("HOLD",-6,-8),this.paused||this.b||!this.g||(this.controller.$?(sc(this,this.g,0,8,2),u.fillStyle="rgba(0,0,0,0.5)",u.fillRect(-8,8,32,16)):tc(this.g,8,2)),ma(-10,50,(()=>{1<this.m&&(v(Q,0,0,7),Y(`${10>this.m?" ":""}${this.m-1}`,-5,7,2)),this.A&&this.A.j(),this.l&&this.l.j()}))}}class zc extends cc{constructor(t){super(t),this.h=0}i(){ea()&&(S=new dc(this.a,!0)),this.h++}j(){super.j(),u.setTransform(1,0,0,1,t.width/2,150),v(jb,0,0,0,2,2),30>this.h%60&&Lb("PRESS ANY BUTTON TO START",0,130)}}let Ac=0,Bc=0;function Cc(t){requestAnimationFrame(Cc);let e=Bc?t-Bc:0;Bc=t,Ac+=e,67<1e3/Ac||(Ac=0,t=S,fa(),t.i(),ja(),t.j())}(async function(){await Promise.all([R,lb,mb,nb,...ob,pb,qb,rb,sb]),[gb,Q,hb,ib,jb]=await Promise.all([P(bb),P(cb),P(db),P(eb),P(fb)]),await tb(),[Ca,kb]=await Promise.all([Wa(),ab()]),document.body.classList.remove("l")})().then((function(){S=new zc(new yc),requestAnimationFrame(Cc)}))</script>