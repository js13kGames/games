<html><head><meta charset="utf-8"><title>Dark light</title><meta name="viewport" content="user-scalable=no"><style>body {position: fixed; overflow: hidden;background-color:black;margin:0;padding:0;} canvas{position:absolute;top:0;left:0; right:0; bottom:0;}</style></head><body><script>!function(t){var i={};function e(s){if(i[s])return i[s].exports;var h=i[s]={i:s,l:!1,exports:{}};return t[s].call(h.exports,h,h.exports,e),h.l=!0,h.exports}e.m=t,e.c=i,e.d=function(t,i,s){e.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:s})},e.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},e.t=function(t,i){if(1&i&&(t=e(t)),8&i)return t;if(4&i&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(e.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(var h in t)e.d(s,h,function(i){return t[i]}.bind(null,h));return s},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,i){return Object.prototype.hasOwnProperty.call(t,i)},e.p="",e(e.s=0)}([function(t,i,e){"use strict";e.r(i);class s{constructor(t){this.g=t,this.t=function(t,i){this.context=new(window.AudioContext||window.webkitAudioContext),this.n("sine",1,1,1);let e=this.g;e.e[0]=!0,e.c.r(),delete e.i.e.m.a,e.uf("touchend",this.t)}.bind(this),t.i.e.m.a=this.t,t.f("touchend",this.t),this.v=0===t.v.d.vol?0:1,this.f=[[49,55,61.74,65.41,73.42,82.41,87.31,98],[98,110,123.5,130.8,146.8,164.8,185,196],[196,220,246.9,261.6,293.7,329.6,349.2,392],[392,440,493.9,523.3,587.3,659.3,740,784]],this.i=["triangle","square","sawtooth"],this.b=[[[2012,2032,2042,2058,2011,2011,2032,2042,2008,2012,2032,2042,2058,2041,2061,2041,2051,2031,2021,2008],[1124,1132,1148,1124,1112,1108,1124,1132,1148,1122,1112,1122,1108],[-8,-2,3374,-8,-2,3344,-8,-2,3374,-8,-2,3334]],[[22111,2241,22111,2251,22111,2261,22111,2271,22111,2261,22111,2251,22111,2242,2262,2242,2232],[1113,1141,1113,1151,1113,1161,1113,1171,1113,1161,1113,1151,1115,1162,1142,1132]],[[3214,3251,3262,3252,3214,3251,3261,3261,3252,3204,3241,3252,3242,3204,3241,3251,3251,3242],[1119],[-2,1252,1231,1242,1252,-2,1252,1231,1241,1241,1252,-2,1232,1221,1232,1242,-2,1232,1221,1231,1231,1242]]],this.c=-1}k(t,i){return setTimeout(t,i)}s(){let t=this.g,i=t.v,e=this.v?0:1;this.v=e,i.d.vol=e,i.s(),t.c.r()}n(t,i,e=1,s=0){let h=this.context;if(h&&this.v){var l=h.createOscillator(),n=h.createGainNode?h.createGainNode():h.createGain();l.connect(n),n.connect(h.destination),l.frequency.value=i,l.type=t,l.start(0),n.gain.setValueAtTime(.1*this.v*(s?.001:1),h.currentTime),n.gain.exponentialRampToValueAtTime(.001,h.currentTime+e),l.stop(h.currentTime+e)}}p(t){if(this.c!=t){this.q(),this.z={},this.c=t;for(let i in this.b[t])this.z[i]={},this.e(t,i,0,0)}}q(){for(let t in this.z)clearTimeout(this.z[t]);this.c=-1}e(t,i,e,s){let h=this.b[t][i];e>=h.length&&(e=0);let l=h[e]+"",n=.25*l.substr(-1);if(e++,l>0){let t=0,i=1,h=2;l.length>4&&s<l.substr(0,1)?(e--,s++,t=1,i=2,h=3):s=0,this.n(this.i[l.substr(t,1)-1],this.f[l.substr(i,1)][l.substr(h,1)])}this.z[i]=this.k(this.e.bind(this,t,i,e,s),1e3*n)}x(t){let i=this.i,e=this.f,s=this.n.bind(this),h=function(t,i,e){this.k(s.bind(this,i,e),t)}.bind(this);if(t<1)for(let t=0;t<4;t++)h(90*t,i[2],e[3-(t>2?2:t>0?1:0)][t%2*5]);else if(t<2)s(i[2],e[0][5]);else if(t<3)for(let t=0;t<3;t++)h(75*t+75*(t-1.5)*t,i[2],e[1][t<2?1:0]);else if(t<4)for(let t=0;t<3;t++)h(90*t,i[2],e[1][3+2*t]);else if(t<5)s(i[1],e[3][7]);else if(t<6)for(let t=0;t<4;t++)h(90*t,i[1],e[2][4-(t>2?-3:t%2)]);else if(t<7)for(let t=0;t<6;t++)h(130*t,i[1],e[2][t>2?Math.min(3*(t-3)+(t-3)%2*(t-3)+2,7):7-t%2*2])}}class h{constructor(t,i){this.p=["#000000","#ffffff","#333333","#a6a6a6","#204572","#3870c1","#af5735","#d3986c","#327724","#5fad51","#9835a0","#c26dcc","#b29a34","#d6c26b","#7f1919","#ce2e2e","#e0e0e0"],this.a={},this.s=!0,this.m=i,this.g=t,t.f("resize",this.z.bind(this)),this.c(),this.v()}t(t){let i=this.w,e=this.h,s=i/e;if(t<2){let t=.75*e;return s<1&&(t=.95*i),[i/2-t/2-(s>1?.1*i:0),s<1?.025*i:.05*e,t,t,t/11]}if(t<4){let h,l=this.t(1);return t>2&&(h=this.t(2)),[s>1&&t>2?l[0]+l[2]+.01*i:l[0],s>1?l[1]+(t<3?l[3]+.01*i:0):l[1]+l[3]+(t>2?h[3]:0)+.02*(t>2?e:i),s>1&&t>2?.1*i:l[2],s>1?t>2?l[3]:.12*e:.1*e]}}r(){this.s=!0}z(){this.c(),this.b(),this.r()}c(){let t=window.innerWidth,i=t,e=window.innerHeight,s=0,h=i/e;h>16/9?i=Math.min(i,e*(16/9)):h<1&&h>9/16&&(i=Math.min(i,e*(9/16))),s=(t-i)/2,this.w=i,this.h=e,this.i=s}l(){let t=this.w,i=this.h;this.ctx.clearRect(0,0,t,i),this.o(0,0,t,i,0)}v(){let t=this.w,i=this.h,e=(this.i,document.createElement("canvas"));this.n=e,this.b(),document.body.appendChild(e);let s=e.getContext("2d");this.ctx=s,this.o(0,0,t,i,0)}b(){let t=this.n;t.setAttribute("width",this.w),t.setAttribute("height",this.h),t.style.left=this.i+"px"}d(){if(this.s){this.l();let t=this.w,i=this.h,e=this.m,s=this.g.n,h=this.g.gg,l=Math.floor;if(this.g.e[0])if(h){this.g.a.q();let n,o=h>8,r=this.x.bind(this),f=i/8;r(o?"Congratulation!":"Game over",t/2,f,55,1,1),f+=i/(o?8:4);let a=i/10;if(this.g.gg>1){let i=this.g.h;i.t(t/2-a/2,f,a,a),i.s(0,3,o?2:0,!o),n="As you try to go further, |you sense your strength leaving you.",h>8&&(n="You found your lover! | |You go back home and enjoy a happy life.|Or can you...?")}else s.d(6,t/2-a/2,f,a,a),n="Your light faded away only |to let you roam endlessly in the dark.";f+=1.5*a,n=n.split("|");for(let e=0;e<n.length;e++)r(n[e],t/2,f+e*i/30,20,0,1);if(o){let e=l(this.g.t),s=l(e/3600),h=l((e-3600*s)/60),n=e%60;r("Your time: "+((s<10?"0":"")+s+":"+(h<10?"0":"")+h+":"+(n<10?"0":"")+n),t/2,f+i/3.5,30,1,1)}r((e?"Touch":"Click")+" anywhere to restart",t/2,.9*i,20,0,1)}else{let t=this.a;for(let i in t)t[i].d(this);let i=this.m,e=this.w,s=this.h;(i&&e>s||!i&&e<s)&&(this.o(0,0,e,s,0,-1),this.x("You need to be in ",e/2,.47*s,30,1,1,-1,1),this.x((e>s?"Portrait":"Landscape")+" mode to play",e/2,.52*s,30,1,1,-1,1))}else{let h=this.x.bind(this),l=i/8;h("Dark Light",t/2,l,60,1,1),l+=i/16,h("Your lover has been captured by evil creatures.",t/2,l,20,0,1),h("They locked her up inside their lair.",t/2,l+i/30,20,0,1),h("You must bring her back!",t/2,l+i/10,20,0,1),l+=i/5;let n,o,r,f=i/20;for(let i=0;i<4;i++)n=t/2+f*(i%2?-.5:i<1?-1.5:.5),o=l+(1==i?0:f),r=e?s.d.bind(s,i+14):s.k.bind(s,"A"+(i%2?i<2?"u":"d":i<1?"l":"r")),r(n,o,f,f);l+=3*f,h("Move",t/2,l,24,0,1),l+=i/16;for(let i=0;i<2;i++)n=t/2-f*i,r=e?s.d.bind(s,18):s.k.bind(s,i<1?"x":"z"),r(n,l,f,f,i);l+=2*f,h("Increase / Decrease light",t/2,l,24,0,1),h("Never run out of light...",t/2,.85*i,24,1,1),h((e?"Touch":"Click")+" anywhere to start",t/2,.9*i,20,0,1)}this.s=!1}}y(t=-1,i=-1,e=1,s=!0){let h=this.ctx;h.fillStyle=null,h.strokeStyle=null,e=this.h/1008*e,t>=0&&(h.fillStyle=this.p[t],s&&h.fill()),i>=0&&(h.strokeStyle=this.p[i],h.lineWidth=e*(1080/this.h),s&&h.stroke())}f(t){this.ctx.globalAlpha=t}e(t){this.ctx.setLineDash(t)}k(t,i,e,s,h,l=1){let n=this.ctx;n.strokeStyle=this.p[h],n.lineWidth=l*(this.h/1008),n.beginPath(),n.moveTo(t,i),n.lineTo(e,s),n.stroke()}o(t,i,e,s,h=-1,l=-1,n=1,o=0){let r=this.ctx;this.y(h,l,n,!1),h>=0&&r.fillRect(t,i,e,s),l>=0&&r.strokeRect(t,i,e,s),o&&this.o(t-4,i-4,e+8,s+8,h,l,n,0)}q(t,i=-1,e=-1,s=1,h=0){let l=this.ctx;l.beginPath(),l.moveTo(t[0][0],t[0][1]),t.splice(0,1);for(let i in t){let e=t[i];l.lineTo(e[0],e[1])}h||l.closePath(),this.y(i,e,s)}u(t,i,e,s=-1,h=-1,l=1){let n=this.ctx;n.beginPath(),n.arc(t,i,e,0,2*Math.PI),this.y(s,h,l)}j(t,i,e,s,h,l,n=-1,o=-1,r=1){let f=this.ctx;f.beginPath(),f.arc(t,i,e,s,h,l),this.y(n,o,r,!0)}x(t,i,e,s,h=0,l=-1,n=-1,o=1,r="center"){let f=this.ctx;f.font=(h?"bold ":"")+s*(this.h/1008)+"px Arial",f.textAlign=r,this.y(l,n,o,0),f.fillText(t,i,e)}}class l{constructor(t,i,e,s=0){this.u=s,this.c=i,this.m=e,this.p=t,this.f=0,this.n=3,this.r=999}d(){this.s(this.f%2,this.n)}t(t,i,e,s){this.z=[t,i,e,s]}l(t,i){let e=this.p,s=Math.abs,h=this.r;return s(e[0]-t)<=h&&s(e[1]-i)<=h}}class n extends l{constructor(t,i,e,s,h){super(e,s,h,i),this.id=t,this.a=!1,this.n=Math.floor(4*Math.random())}l(t,i){let e=Math.abs,s=this.p;return 3==this.id?s[0]==t&&s[1]==i||e(s[0]-t)>2||e(s[1]-i)>2:super.l(t,i)}s(t,i){let e,s=this.c,h=this.z,l=h[0],n=h[1],o=h[2],r=h[3],f=i%2<1,a=this.a,u=this.id,c=a?14:12,d=a?15:13,g=this.m,b=this.p,p=g.g.h.p,y=g.g.h.r,x=Math.abs,m=s.o.bind(s),k=s.u.bind(s),w=(s.k.bind(s),s.q.bind(s)),M=(t,e=0)=>{1!=i&&(this.e(w,l+o*(i>2?.35:i<1?.3:.62),n+.35*r+e,.08*o,.2*r,i>1,t),i>2&&this.e(w,l+.57*o,n+.35*r+e,.08*o,.2*r,0,t))};if(u>3){e=[()=>k(l+.5*o,n+.5*r,t<1?.4*o:.35*o,d,c),M.bind(this,0,t<1?.05*r:.025*r)];let i=.6*o,h=.15*o;for(let t=0;t<=2;t+=2){let a=f?t-1:0,u=f?0:t-1,k=b[0]+a,w=b[1]+u,M=x(k-p[0]),v=x(w-p[1]);!g.i(k,w)&&M<6&&v<6&&e.push(()=>{let e=l+(f?0:.45*o),g=n+(f?.45*r:0),b=f?i:h,p=f?h:i;t<1?(e-=f?b:0,g-=f?0:p):(e+=f?o:0,g+=f?0:r),m(e,g,b,p,d,d),f?(e+=t<1?-p:b,g-=p,b=p,p*=3):(e-=b,g+=t<1?-b:p,p=b,b*=3),m(e,g,b,p,c,c),(M>y||v>y)&&(s.f(.9),m(l+o*a,n+r*u,o,r,0,-1),s.f(1))})}}else if(u>2){let s=(i=0)=>{for(let e=0;e<2;e++)m(l+o*(e<1?.3:.55)+i*(e%2<1?1:-1),n+.6*r-(e==t?r/16:0),.15*o,r/3,d,c)};if(f){let h=()=>{for(let e=0;e<2;e++){let s=l+o*(e<1?.65:.75),h=o*(.1-.03*e);i<1&&(s=l+o*(e<1?.35:.25)-h),m(s,n+r*(e<1?.225:t<1?.3:.325),h,r*(e<1?.45:.3),0,c)}m(l+.35*o,n+.125*r,.3*o,.65*r,d,c)},f=()=>m(l+o*(i<1?.65:.25),n+.3*r,.1*o,.3*r,d,c);e=[s.bind(this,.05*o),h,f]}else{e=[()=>m(l+.075*o,n+.35*r,.85*o,.2*r,d,c),s,()=>{if(k(l+.5*o,n+.45*r,.325*o,d,c),i>2)for(let i=3;i>0;i--)k(l+.5*o,n+.45*r+(i<2&&t>0?.03*r:0),.08*o*i,0,c)}]}}else if(u>1){let i=t<1?.1*-r:0;e=[()=>s.f(.75),()=>w([[l+.2*o,n+.395*r],[l+.2*o,n+.9*r],[l+.35*o,n+.8*r+i],[l+.5*o,n+.9*r],[l+.65*o,n+.8*r+i],[l+.8*o,n+.9*r],[l+.8*o,n+.395*r]],0,c,1),()=>s.j(l+.5*o,n+.4*r,.3*r,0,Math.PI,1,0,c),M.bind(this,d),()=>s.f(1)]}else{let s=()=>k(l+.5*o,n+.5*r,.3*o,d,c),h=o*(f?i<1?-.05:.05:0),a=()=>w([[l+o/2+h,n],[l+.37*o+h,n+.3*r],[l+.63*o+h,n+.3*r]],0,c),u=(i,e)=>{let s=l+o*(e?.25:.55)+i*o,h=n+r/2+r*-(e?t<1?.1:.05:t<1?.05:.1),f=r/12;m(s,h,.2*o,r/2,0,c),m(s,h+r/2-f,.2*o,f,d,c)},g=u.bind(this,f?.05:0,1),b=u.bind(this,f?-.05:0,0),p=t=>w([[t,n+2*r/3],[t+.16*o,n+2*r/3],[t+.08*o,n+2*r/3+.1*o]],0,-1),y=()=>{if(1!=i){let t=l+1*o/3,e=1*o/3;f&&(e=.2*o,t=l+o*(i<1?1/4:4/7)),m(t,n+2*r/3,e,2,0),p(t),i>2&&p(t+e-.16*o)}};e=[1==i?b:g,1==i?g:b,s,M.bind(this,0),a,y]}for(let t in e)e[t]();this.g||(s.f(.9),m(l,n,o,r,0),s.f(1))}e(t,i,e,s,h,l,n){t([[i,e+h],[i+s,e+h],[i+s,e+h*(l?.15:0)],[i,e+h*(l?0:.15)]],n,-1)}}class o extends l{constructor(t,i,e){super(t,i,e),this.r=2,this.j=100,this.k=100,this.h=2,this.i=2,this.v=[0,.5,1,1.5,2,4]}s(t,i,e=0,s=0){let h=this.c,l=this.z,n=l[0],o=l[1],r=l[2],f=l[3],a=i%2<1,u=h.o.bind(h),c=(h.q.bind(h),()=>u(n+.19*r,o+f*(0==t?.5:.48),.11*r,.2*f,3,0)),d=()=>u(n+.71*r,o+f*(0==t?.48:.5),.11*r,.2*f,3,0);if(a){let i=()=>u(n+r*(0==t?.47:.42),o+.5*f,.13*r,.2*f,3,0);d=0==t?()=>{}:i,c=1==t?()=>{}:i}let g=[()=>u(n+r*(a?.5:.31),o+f*(1==t||e?.75:.7),.15*r,.15*f,2,0),()=>u(n+r*(a?.37:.56),o+f*(0==t||e?.75:.7),.15*r,.15*f,2,0),0==t?d:c,()=>u(n+r*(a?.32:.25),o+.25*f,r*(a?.36:.5),.5*f,e%2+1,0),0==t?c:d];e&&g.push(c);for(let t in g)g[t]();this.y(n,o,r,f,t,i,e,s)}y(t,i,e,s,h,l,n,o){let r=this.c,f=l%2<1;if(f)r.q([[t+.25*e,i+.1*s],[t+.75*e,i+.1*s],[t+.75*e,i+s*(0==l?.45:.52)],[t+.25*e,i+s*(0==l?.52:.45)]],3,0);else{let h=s*(n>1?.2:.1);r.q([[t+.2*e,i+h],[t+.8*e,i+h],[t+.8*e,i+.45*s],[t+.5*e,i+.6*s],[t+.2*e,i+.45*s]],3,0)}if(n>1)for(let h=0;h<5;h++)r.u(t+e*(h<2?.32+.36*h:.5-.2*((h-2)%2+(h>3?-1:0))),i+s/12*(h<2?0:h>2?2:1),e/(h<2?5:8),2,0);let a=()=>{3==l&&(r.o(t+.37*e,i+.27*s,.06*e,.17*s,0),r.o(t+.57*e,i+.27*s,.06*e,.17*s,0))};f&&(a=()=>r.o(t+e*(0==l?.35:.6),i+.27*s,.06*e,.17*s,0)),o&&(a=()=>{r.o(t+.35*e,i+.37*s,e/10,s/30,0,0),r.o(t+.55*e,i+.37*s,e/10,s/30,0,0)}),a(),n<1&&(r.o(t+e*(f?.25:.2),i+.1*s,e*(f?.5:.6),.1*s,2,0),3==l?r.u(t+.5*e,i+.15*s,.1*e,1,0):f&&r.o(t+e*(0==l?.19:.76),i+.08*s,.05*e,.15*s,1,0))}}class r{constructor(t){this.c=t}d(t,i,e,s,h,l=0){let n=this.c,o=n.o.bind(n),r=n.u.bind(n),f=n.k.bind(n),a=function(t,i,e,s){n.j(t+e/2,i+s/2,e/5,Math.PI/-4,Math.PI/4,Math.PI,-1,3,6*s/60)};if(t<5){let o,r=2*t+2,a=.15;t<2?(a=.2,o=(t,i,e,s)=>[[t+e/2,i],[t+e,i+s],[t,i+s],[t+e/2,i]]):t<3?o=(t,i,e,s)=>[[t,i+s/6],[t+e,i+s/6],[t+e,i+5*s/6],[t,i+5*s/6],[t,i+s/6]]:t<4?(a=.2,o=(t,i,e,s)=>[[t+e/2,i],[t+e,i+s/2],[t+e/2,i+s],[t,i+s/2],[t+e/2,i]]):(a=.12,o=(t,i,e,s)=>[[t+e/12,i+s/4],[t+e/2,i],[t+11*e/12,i+s/4],[t+11*e/12,i+3*s/4],[t+e/2,i+s],[t+e/12,i+3*s/4],[t+e/12,i+s/4]]),l&&n.e([12,8]);let u=[o(i,e,s,h),o(i+.2*s,e+.2*h,.6*s,.6*h)];if(n.q(u[0],l?-1:r+1,r+(l?1:0),2,0),l)n.e([]);else{let t=u[0].length;for(let i=0;i<t;i++){let e=u[0][i],s=u[1][i+1<t?i+1:0];f(e[0],e[1],s[0],s[1],r,2)}n.q(u[1],r)}}else if(t<6){let t=n.ctx;e+=27*h/32,i+=h/2;let s=h/2,o=Math.PI/180,r=Math.sin,f=Math.cos,a=-90*o,u=-67.5*o,c=180*o,d=-112.5*o,g=i+s*f(a),b=e+s*r(a),p=i+s*f(u),y=e+s*r(u),x=i+s*f(d),m=e+s*r(d),k=2*s*r(22.5*o/2);t.beginPath(),t.moveTo(g,b),t.arc(p,y,k,c,c+225*o),t.lineTo(i,e),t.moveTo(g,b),t.arc(x,m,k,0,135*o,!0),t.lineTo(i,e),n.y(l?-1:14,14,2,!0)}else if(t<7)for(let t=0;t<3;t++)r(i+s/2,e+h/2,s*(.5-.15*t),t<1?2:t<2?3:1,t<1?3:-1);else if(t<8)r(i+s/2,e+h/2,.5*s,2,3,2),a(i,e,s,h);else if(t<9){o(i,e,s,h,2,-1);let t={b:[()=>o(i,e,s,h/8,3,2),()=>o(i,e+7*h/8,s,h/8,3,2)],f:[]};for(let l=0;l<4;l++)t.b.push(()=>o(i+1*s/3*l-1*s/22*l,e,s/8,h,3,2)),t.f.push(()=>o(i+7*s/8*(l<2?0:1),e+7*h/8*(l%2),s/8,h/8,2*l+5,0));for(let i in t)for(let e in t[i])t[i][e]()}else if(t<10){o(i,e,s,h,0,2,2);for(let t=0;t<2;t++)o(i+s*(t<1?.075:.125),e+h*(t<1?.05:.38),s*(.95-.1*(t+1)),.33*h,3-t%2)}else if(t<11)o(i,e,s,h,3,0,2),o(i+.12*s,e+.12*h,.76*s,.76*h,12,0,2),r(i+s/2,e+h/2,s/4,2,3),a(i+.2*s,e+.2*h,.6*s,.6*h);else if(t<12)n.j(i+3*s/4,e+h/3,s/4,2*-Math.PI/3,Math.PI,1,-1,3,3),r(i+s/2,e+.7*h,.3*s,2,-1),o(i+3*s/8,e+.33*h,s/4,.15*h,2,-1);else if(t<13){let t=l?2:3;i+=s/4,e+=h/12;for(let l=0;l<2;l++)r(i+s/2*l,e+h*(1-2/7-.05),h/7,t),o(i+s/2*l+.033*h,e+.05*h,s/10,.7*h,t);o(i+.033*h,e+.05*h,s/1.8,s/10,t),l&&f(i,e,i+.75*s,e+.75*h,t,5)}else if(t<14){let t=s/4;o(i,e,s,h,0,3);for(let s=0;s<16;s++)o(i+s%4*t,e+Math.floor(s/4)*t,t,t,s%3.5==1?3:-1,2)}else if(t<18){let l,r=t-14;if(o(i,e,s,h,2,3),i+=.2*s,e+=.2*h,s*=.6,h*=.6,r%2){let t=h*(r-1)/2;l=[[i+s/2,e+t],[i,e-t+h],[i+s,e-t+h]]}else{let t=s*(r/2);l=[[i+t,e+h/2],[i-t+s,e],[i-t+s,e+h]]}n.q(l,3,-1)}else t<19&&(o(i,e,s,h,2,3),o(i+.2*s,e+.45*h,.6*s,.1*h,3),l||o(i+.45*s,e+.2*h,.1*s,.6*h,3))}k(t,i,e,s,h){let l=this.c,n=l.o.bind(l),o=l.k.bind(l);if(n(i,e,s,h,2,1),n(i+.1*s,e+.1*h,.8*s,.65*h,1,2),2==t.length){let n,r=h/15;"Au"==t||"Ad"==t?(n=[[i+.33*s,e+.43*h],[i+s/2,e+h*("Au"==t?.25:.6)],[i+.67*s,e+.43*h]],o(i+s/2,e+.25*h,i+s/2,e+.6*h,0,r)):(n=[[i+s/2,e+.26*h],[i+s*("Al"==t?.33:.67),e+.42*h],[i+s/2,e+.58*h]],o(i+.33*s,e+.42*h,i+.67*s,e+.42*h,0,r)),l.q(n,-1,0,r,1)}else l.x(t,i+s/2,e+.6*h,h/2.5,1,0,1)}}class f{constructor(t,i){this.g=t,this.d=-1,this.l=0,this.e={k:{},t:{},m:{}},this.v={},this.t={},t.f("keydown",this.j.bind(this)),t.f("keyup",this.k.bind(this)),t.f("touchstart",this.c.bind(this,0)),t.f("touchmove",this.c.bind(this,1)),t.f("touchend",this.c.bind(this,2)),t.f("mouseup",this.m.bind(this))}get P(){let t=this.g;return t.gg||t.pa}u(t){this.d>=0&&!this.P&&(this.l-=t,this.l<0&&(this.l=150,this.g.o(this.d)))}j(t){if(!this.P){let i=t.keyCode;this.d!=i-37&&i<41&&i>36&&(-1==this.d&&(this.l=250),this.d=i-37,this.g.o(this.d))}}k(t){let i=t.keyCode,e=this.g;this.P||(this.d>=0&&this.d==i-37&&(this.d=-1),90!=i&&88!=i||e.x(i>88?1:-1),83==i&&e.a.s()),77==i&&e.r();let s=this.e.k;for(let t in s)s[t](i)}c(t,i){let e=this.v,s=-1,h=this.t,l=i.touches,n=this.e.t,o=function(t,i,e){return t>=e[0]&&t<=e[0]+e[2]&&i>=e[1]&&i<=e[1]+e[3]};for(let r in e){let f=e[r];for(let t in l){let i=l[t],e=i.clientX,n=i.clientY;if(h[i.identifier]=[e,n],o(e,n,f)){s=r;break}}if(2==t)for(let r in h){let f=0;for(let t in l)if(r==l[t].identifier){f=1;break}if(!f){let l=h[r][0],f=h[r][1];for(let t in e)o(l,f,e[t])&&(s=h[r],this.g.j(function(){this.d=-1}.bind(this)));for(let e in n)n[e][1]&&!o(l,f,n[e][1])||n[e][0](i,t);delete h[r]}}}this.d=s,0==t&&s>=0&&(this.g.o(s),this.l=250),-1==s&&(this.l=250),this.g.e[2]&&this.g.k(()=>window.location.reload(),100)}m(t){let i=this.e.m;for(let e in i)i[e](t);this.g.e[2]&&this.g.k(()=>window.location.reload(),100)}}class a{constructor(t,i,e){this.g=t,this.c=i,this.m=e}r(t){let i=5*(t-1)+10;this.l=t;let e=[];for(let t=0;t<i;t++){e.push([]);for(let s=0;s<i;s++)e[t][s]=0}let s={x:Math.floor(Math.random()*i),y:Math.floor(Math.random()*i)};e[s.x][s.y]=1;let h=[];for(s.x+1<i&&h.push({x:s.x+1,y:s.y}),s.x-1>=0&&h.push({x:s.x-1,y:s.y}),s.y+1<i&&h.push({x:s.x,y:s.y+1}),s.y-1>=0&&h.push({x:s.x,y:s.y-1});h.length>0;){let t=Math.floor(Math.random()*h.length),s=h[t],l=[];s.x+1<i&&1===e[s.x+1][s.y]&&l.push({x:s.x-1,y:s.y}),s.x-1>=0&&1===e[s.x-1][s.y]&&l.push({x:s.x+1,y:s.y}),s.y+1<i&&1===e[s.x][s.y+1]&&l.push({x:s.x,y:s.y-1}),s.y-1>=0&&1===e[s.x][s.y-1]&&l.push({x:s.x,y:s.y+1}),1===l.length&&(e[s.x][s.y]=1,l[0].x>=0&&l[0].x<i&&l[0].y>=0&&l[0].y<i&&(e[l[0].x][l[0].y]=1,l[0].x+1<i&&0===e[l[0].x+1][l[0].y]&&h.push({x:l[0].x+1,y:l[0].y}),l[0].x-1>=0&&0===e[l[0].x-1][l[0].y]&&h.push({x:l[0].x-1,y:l[0].y}),l[0].y+1<i&&0===e[l[0].x][l[0].y+1]&&h.push({x:l[0].x,y:l[0].y+1}),l[0].y-1>=0&&0===e[l[0].x][l[0].y-1]&&h.push({x:l[0].x,y:l[0].y-1}))),h.splice(t,1)}let l=[];for(let t in e){let i=[];for(let s in e[t])for(let h=0;h<3;h++)i.push(e[t][s]);for(let t=0;t<3;t++)l.push(i.slice())}this.e=l,this.x={},this.z=3*i,this.p(),this.s()}p(){let t=this.g,i=this.z,e=this.l,s=Math.random,h=Math.ceil(i/2),l=this.n(h,h,1);this.g.s(1,9,l),this.spawnPoint=[l[0],l[1]+1];let n=t.missing;for(let t=0;t<n.length;t++){let e=n[t];this.g.s(1,e,this.n(e-1>1?i:0,(e-1)%2?i:0,1))}let o=[3,5,7,7][e-1];this.t(o,t.s.bind(t,1,6),1),o=5*e+10;let r=()=>Math.floor(i*s()),f=()=>this.n(r(),r(),1),a=this.g.w;for(let i=0;i<o;i++){let i=f(),e=!1;for(;!e;){e=!0,Math.abs(i[0]-l[0])<3&&Math.abs(i[1]-l[1])<3&&(e=!1);for(let t in a[1]){let s=a[1][t];if(i[0]==s[0]&&i[1]==s[1]){e=!1;break}}e||(i=f())}t.s(1,7,i)}let u=Math.floor(e+4+Math.max(.25,s())*i/3*(e<2?0:1)),c=l[0]+u*(s()>.5?-1:1),d=l[1]+u*(s()>.5?-1:1),g=this.n(c,d,1);this.shopSpawn=g,t.s(1,10,g)}s(){let t=this.l,i=t+2;this.t(i,function(t,i){this.g.s(2,Math.ceil(Math.random()*t),i)}.bind(this,t))}t(t,i,e=0){let s=this.z,h=Math.round(s/(t+1)),l=s/2;for(let s=0;s<t;s++)for(let n=0;n<t;n++){let t=this.n(h*(n+1),h*(s+1),e);(Math.abs(t[0]-l)>5||Math.abs(t[1]-l)>5)&&i(t.slice())}}o(t,i){for(let e=t[1]-i;e<t[1]+i;e++)for(let s=t[0]-i;s<t[0]+i;s++)this.x[s+"_"+e]=1}i(t,i){let e=this.e;return!e[i]||!e[i][t]}b(t,i){return[i[0]+(0==t?-1:2==t?1:0),i[1]+(1==t?-1:3==t?1:0)]}n(t,i,e=0){let s=this.g.w,h=function(t){let i=1;for(let e=0;e<4;e++){let s=this.b(e,t);i=i&&!this.i(s[0],s[1])}return i}.bind(this);if(this.i(t,i)||e&&!h([t,i])){let l=1;for(;l<10;){for(let n=-l;n<l;n++)for(let o=-l;o<l;o++)if(!this.i(t+n,i+o)){let l=1,r=t+n,f=i+o;for(let t in s)for(let i in s[t]){let e=s[t][i].p;if(e[0]==r&&e[1]==f){l=0;break}}if(l){let t=[r,f];if(!e)return t;if(h(t))return t}}l++}}return[t,i]}a(t){let i=this.i(t[0],t[1]),e=[];for(let s=-1;s<2;s++)for(let h=-1;h<2;h++)0!=h&&0!=s||!i&&this.i(t[0]+h,t[1]+s)||e.push([t[0]+h,t[1]+s]);return e[Math.floor(Math.random()*e.length)]}f(t,i,e){let s=[{c:t,p:[],s:0}],h={};for(;s.length>0;){let t=s.shift();for(let l=0;l<4;l++){let n=this.fc(t,l,i,e);if(n.s>0)return n.p[0];if(0==n.s){let t=n.c[0]+"_"+n.c[1];(!h[t]||h[t].length>n.p.length)&&(h[t]=n.p,s.push(n))}}}}fc(t,i,e,s){let h=this.b(i,t.c),l=t.p.slice();l.push(h);let n=e[0]==h[0]&&e[1]==h[1]?1:!s&&this.i(h[0],h[1])?-1:0;if(0==n){let t=this.g.w[2];for(let i in t){let e=t[i].p;if(e[0]==h[0]&&e[1]==h[1]){n=-1;break}}}return{c:h,p:l,s:n}}d(){this.m;let t=this.c,i=(this.e,this.g.w),e=this.g.h,s=!1,h=this.map,l=this.z,n=t.t(1),o=n[0],r=n[1],f=n[3],a=n[4],u=t.o.bind(t),c=[];if(h){let i=this.x,s=f/l,h=this.spawnPoint,n=this.shopSpawn,a=this.g.n;for(let f=0;f<l;f++)for(let u=0;u<l;u++){let l=i[u+"_"+f],c=0,d=o+s*u,g=r+s*f,b=l&&n[0]==u&&n[1]-1==f,p=h[0]==u&&h[1]-1==f;l&&(c=this.i(u,f)?this.y(u,f):1),t.o(d,g,s,s,c,2,.5/this.l),b&&t.o(d,g,s,s,12,13,2),p&&a.d(8,d,g,s,s);let y=e.p;y[0]==u&&y[1]==f&&(t.o(d,g,s,s,14,15,1),e.t(d,g,s,s),e.d(0,3))}}else{for(let t=e.p[1]-5,h=0;t<=e.p[1]+5;t++,h++)for(let l=e.p[0]-5,n=0;l<=e.p[0]+5;l++,n++){let f=e.l(l,t);for(let e in i[2])f&=i[2][e].l(l,t);let d=n*a+o,g=h*a+r;u(d,g,a,a,f?1:0,-1),this.i(l,t)&&f?this.w(d,g,l,t,a):f&&this.h(d,g,l,t,a);for(let e in i)for(let h in i[e]){let n=i[e][h],o=n.p;o[0]==l&&o[1]==t&&(n.t(d,g,a,a),n.g=f,c.push(n.d.bind(n)),s=s||n.a)}c.push(()=>u(d,g,a,a,-1,f?3:2))}for(let t in c)c[t]();e.t(o+5*a,r+5*a,a,a),e.d()}t.o(o,r,f,f,-1,s&&!h?15:1,1,1)}h(t,i,e,s,h){let l=this.c,n=[.15,.85,.45,.85,.15,.7,.28,.78,.2,.7];for(let e=0;e<10;e+=2){let s=i+h/10*(e+1);l.k(t+h*n[e],s,t+h*n[e+1],s,16,2)}}w(t,i,e,s,h){let l=this.l,n=this.z,o=this.y(e,s),r=this.c,f=r.o.bind(r);(e<0||e>=n||s<0||s>=n)&&f(t,i,h,h,0,-1),t+=.05*h,i+=.05*h,h*=.9;let a=function(e){r.k(t+.5*h,i+.3*h+e,t+.3*h,i+.5*h+e,o),r.k(t+.7*h,i+.3*h+e,t+.5*h,i+.5*h+e,o)},u=function(e){for(let s=0;s<2;s++)r.k(t+.4*h,i+h*(s<1?.35:.43)+e,t+.6*h,i+h*(s<1?.35:.43)+e,o,1)},c=function(t,i,e,s=1){let h=[[t,i,e,e],[t+.13*e,i+.13*e,.74*e,.74*e,o+1]];for(let t=0;t<2;t++)f(h[t][0],h[t][1],h[t][2],h[t][3],o+t,0,2);if(s)for(let t=0;t<4;t++){let i=t>1?1:0,e=t%2>0?0:1;r.k(h[0][0]+h[0][2]*i,h[0][1]+h[0][3]*e,h[1][0]+h[1][2]*i,h[1][1]+h[1][3]*e,0,2)}};if(l>3){c(t+.12*h,i+.12*h,.76*h,0);let e=function(t,i,e){return[[t+e/2,i],[t+e,i+e/2],[t+e/2,i+e],[t,i+e/2],[t+e/2,i]]},s=[e(t,i,h),e(t+.17*h,i+.12*h,.66*h)];for(let t=0;t<2;t++)r.q(s[t],o+t,0,2);for(let t=0;t<4;t++){let i=s[0][t],e=s[1][t];r.k(i[0],i[1],e[0],e[1],0,2)}u(.05*h)}else if(l>2){c(t,i,h);for(let e=0;e<2;e++)r.u(t+h/2,i+h/2-.1*h*e,h*(e>0?.2:.4),o+e,0,2);u(0)}else if(l>1){let e=[];for(let s=0;s<2;s++){let l=h*(s%2>0?.66:1),n=h/2-l/2,f=t+n,a=i+n-.1*l*s;e.push([[1/4,0],[3/4,0],[1,1/4],[1,3/4],[3/4,1],[1/4,1],[0,3/4],[0,1/4],[1/4,0]]);for(let t=0;t<9;t++)e[s][t][0]=f+e[s][t][0]*l,e[s][t][1]=a+e[s][t][1]*l;r.q(e[s],o+s,0,2)}for(let t in e[0]){let i=e[0][t],s=e[1][t];r.k(i[0],i[1],s[0],s[1],0)}a(.015*h)}else{let e=.15*h;f(t,i,h,h,o,0,2),f(t+e,i+e,.7*h,.55*h,o+1,0,2);let s=[0,0,e,e,h,0,h-e,e,0,h,e,.7*h,h,h,h-e,.7*h];for(let e=0;e<=24;e+=4)r.k(t+s[e],i+s[e+1],t+s[e+2],i+s[e+3],0);a(0)}}y(t,i){let e=[.33,.66],s=this.z,h=1,l=2;for(let n=0;n<2;n++)for(let o=0;o<2;o++){let r=s*e[n],f=s*e[o];if((n<1&&t<=r||n>0&&t>=r)&&(o<1&&i<=f||o>0&&i>=f)){l=2+2*h;break}h++}return l}}class u{constructor(t,i,e,s,h){this.id=t,this.u=i,this.y=h,this.c=s,this.p=e}t(t,i,e,s){this.z=[t,i,e,s]}w(){return this.q()}q(){let t=1;if(9==this.id){let i=this.y,e=i.missing,s=i.g;for(let i in e)t=t&&s[e[i]]}return t}b(){let t=this.id;if(t<8){let i=this.y;if(i.a.x(t>4?t-3:5),t>6)i.z++;else if(t>5){let t=i.h.j,e=i.h.k;i.h.j=Math.min(e,t+Math.ceil(e/2))}else i.g[t]=1;i.ds(this.u)}}d(){let t=this.id,i=this.g,e=this.y.c;if(i||t<8){let s=.75;t>8?s=1:7==t&&(s=.6);let h=this.z,l=h[2]*s,n=h[3]*s;this.c.d(this.id-(this.q()?0:1),h[0]+(h[2]-l)/2,h[1]+(h[3]-n)/2,l,n),i||(e.f(.9),e.o(h[0],h[1],h[2],h[3],0,-1),e.f(1))}}}class c{constructor(t){this.d,this.k="darklight_save",this.l()}s(){window.localStorage.setItem(this.k,btoa(JSON.stringify(this.d)))}l(){let t=window.localStorage.getItem(this.k);t=t?JSON.parse(atob(t)):{},this.d=t}}class d{constructor(t,i,e){this.c=i,this.g=t,this.m=e,t.i.e.k.u=this.k.bind(this),t.i.e.t.u=[this.t.bind(this)]}f(){if(this.l&&this.g.e[0]){let t=this.g;this.l=!1,t.a.p(0),this.c.r(),t.j((function(){t.pa=!1,t.i.d=-1}))}}k(t){let i=this.g,e=i.p;if(this.f(),this.s){if(t>48&&t<52){let s=t-48,h=e[s];h&&i.z>=h&&(i.z-=h,s<2?(i.h.i++,i.h.h++):s<3?(i.h.k+=50,i.h.j=i.h.k):i.b=!0,e[s]=0)}81==t&&(this.s=!1,i.a.p(0),i.pa=!1),i.c.r()}}t(t,i,e){this.f();let s=this.g;t>=18?s.x(t<19?1:-1):12==t?s.a.s():13==t&&s.r()}d(){let t=this.c,i=this.g,e=i.h,s=i.n,h=e.k,l=Math.max(0,e.j/h),n=e.h,r=e.i,f=i.z,a=i.missing,u=i.g,c=i.b,d=t.w/t.h,g=d>1,b=this.m,p=i.i.e.t,y=[];for(let i=1;i<4;i++)y.push(t.t(i));let x=s.d.bind(s),m=s.k.bind(s),k=y[1];t.o(k[0],k[1],k[2],k[3],-1,1,1,1);let w=k[3]/4,M=k[3]-2*w,v=k[1]+k[3]/2-M/2,P=k[0]+w;for(let t=0;t<r;t++)x(5,P+1.15*M*t,v,M,M,t>=n);let q=M/3,z=3*M*(1+(g?0:d<9/16?3/8-d:.15))*(h>100?1.5:1.25)-(g?0:.18*k[2]),j=k[0]+k[2]-z-w,T=v+M/2-q/2,S=l<.4?l<.15?15:13:1;for(let i=0;i<2;i++)t.o(j,T,z*(i>0?l:1),q,i<1?-1:S,S);x(6,j-3*q,T-q/2,2*q,2*q);let A=y[2];t.o(A[0],A[1],A[2],A[3],-1,1,1,1);let I,O,_=.08*A[g?3:2];for(let t=0;t<a.length;t++){let i=a[t],e=w+t*(_+w);I=A[0]+(g?A[2]/2-_/2:e),O=A[1]+(g?e:A[3]/2-_/2),x(i,I,O,_,_,!u[i])}let C=g?I:A[0]+.75*A[2],W=g?A[1]+.835*A[3]:O;if(x(7,C,W,_,_),t.x("x"+f,A[0]+A[2]*(g?.5:f>99?.9:.88),g?W+.13*A[3]:A[1]+.6*A[3],30,0,1),c&&x(11,C-(g?0:.2*A[2]),W-(g?.15*A[3]:0),_,_),g){let t=k[0]+k[2]+w,e=A[1]+A[3]+w*(b?1.5:1),s=t+w+_;if(x(13,t,e,_,_),x(12,s,e,_,_,!i.a.v),!b){let i=_/2;m("m",t+_/2-i/2,e+1.25*_,i,i),m("s",s+_/2-i/2,e+1.25*_,i,i)}}let Y=y[0];if(b&&d<1){t.w;let e=A[1]+A[3]+Y[1],s=t.h-e-2*Y[1],h=Math.min(.8*s,1.5*_),l=e+s/2+1.35*-h;for(let t=0;t<4;t++){let e=A[0]+A[2]/10+h*(t<2||t%2>0?0:2)+h*(t%2)+h/5*(t%2?0:t<2?-1:1),s=l+h*(t%2?t<2?0:2:1)+h/5*(t%2?t<2?-1:1:0);x(14+t,e,s,h,h),i.i.v[t]=[e,s,h,h]}h*=1.25;for(let t=0;t<2;t++){let e=A[0]+.58*A[2]+h*(t%2)*1.4,s=l;x(18,e,s+1.4*h,h,h,t),p[18+t]=[this.t.bind(this,18+t),[e,s+1.4*h,h,h]],x(13-t,e,s,h,h,!i.a.v),p[13-t]=[this.t.bind(this,13-t),[e,s,h,h]]}}let B=Y[0]+Y[2]/2;if(this.l){t.o(Y[0],Y[1],Y[2],Y[3],0,-1);let e=.05*Y[2],s=Y[1]+Y[3]/2-(.03*Y[2]+3*e+_)/2;t.x("Floor "+i.l,B,s,30,1,1,-1,1),t.x("Find the missing gem"+(i.l>1?"s":"")+" to unlock the stairs",B,s+e,20,0,1,-1,1);let h="Press any key to continue";b&&(h="Touch to countinue"),t.x(h,B,s+5*e,15,1,1,-1,1),B-=(4*_+3*e)/2;for(let t=0;t<4;t++)x(t+1,B+(_+e)*t,s+2*e,_,_,a.includes(t+1))}if(this.s){let e=i.p;t.o(Y[0],Y[1],Y[2],Y[3],0,-1);let s=B,h=new o([],t),l=1.25*_;h.t(B-l/2,Y[1]+Y[3]/4,l,l),h.s(1,3,1);let n=Y[2]/8;B-=(2*n+3*l)/2;let r=Y[3]/2,f=0;for(let i=0;i<3;i++){let s=e[i+1],h=B+(l+n)*i;x(i<2?5+i:11,h,r,l,l),t.x(s?"x"+s:"Sold out",h+(s?7*l/8:l/2),r+1.6*l,20,0,s?1:2),s&&(x(7,h,r+1.25*l,l/2,l/2),f++,b?p[i+49]=[this.k.bind(this,i+49),[h,r,2*l,2*l]]:m(i+1,h+l/4,r+2*l,l/2,l/2));let o=Y[0]+Y[2]/2,a=Y[1]+.8*Y[3];b?(t.q([[o-1.5*l,a-l/8],[o-l,a-l/2],[o-l,a+l/3]],3),p[81]=[this.k.bind(this,81),[o-l,a-l,3*l,3*l]]):m("q",o-l/4,a+l/8,l/2,l/2),t.x("Return",o,a,20,0,1,0)}t.x(f?"Hi there! I've got brand new items for you.":"Sorry, I'm out of stock.",s,Y[1]+Y[2]/6,25,1,1,0,-1)}}}class g{constructor(){let t=/Android|webOS|iPhone|iPad|iPod|BlackBerry|BB|PlayBook|IEMobile|Windows Phone|Kindle|Silk|Mobile|Opera Mini/i.test(navigator.userAgent);this.d=1,this.w={1:[],2:[]},this.z=0,this.g={1:0,2:0,3:0,4:0},this.p={1:15,2:15,3:10},this.y=(new Date).getTime(),this.e=[!1,!1,!1],this.t=0,this.b=0,this.l=0,this.pa=!1,this.gg=0,this.v=new c;let i=new f(this);this.i=i;let e=new h(this,t);this.c=e,this.a=new s(this);let l=new a(this,e,t);this.m=l,this.c.maze=l;let n=new r(e);this.n=n;let u=new d(this,e,t);this.u=u,e.a.m=l,e.a.u=u;let g=new o([],e,l);this.h=g,this.tu={i:i},this.nl(),this.q()}f(t,i){window.addEventListener(t,i)}uf(t,i){window.removeEventListener(t,i)}j(t){window.requestAnimationFrame(t)}k(t,i){return setTimeout(t,i)}s(t,i,e){let s=null,h=this.d;return s=t>1?new n(i,h,e,this.c,this.m):new u(i,h,e,this.n,this),this.w[t].push(s),this.d++,s}ds(t){let i=this.w;for(let e in i)for(let s=0;s<i[e].length;s++)if(i[e][s].u==t){i[e].splice(s,1);break}}nl(){let t=this.m;this.maxlight=2;let i=this.h,e=this.w;if(this.l++,this.l<5){for(let t in e){for(let i in e[t])this.ds(e[t][i].u);e[t]=[]}let s=[],h=[1,2,3,4];this.g={1:0,2:0,3:0,4:0};for(let t=0;t<this.l;t++){let t=Math.floor(Math.random()*h.length);s.push(h[t]),h.splice(t,1)}s.sort(),this.missing=s,t.r(this.l),i.p=t.spawnPoint,i.r=2,i.n=3,i.j=i.k,t.o(i.p,2),this.u.l=!0}else this.gg=9;this.c.r()}q(){let t=(new Date).getTime(),i=t-this.y;this.y=t,!this.e[0]||this.e[1]||this.gg||(this.t+=i/1e3);let e=this.tu;for(let t in e)e[t].u(i);this.c.d(),this.j(this.q.bind(this))}x(t){let i=this.h,e=i.v,s=this.maxlight,h=this.h.r,l=Math.min(5,Math.max(0,h+t));if(i.r=l,l>s){let t=e[l]-e[s];i.gas-=t,this.maxlight=l,this.m.o(i.p,l)}this.c.r()}r(){this.m.map=!this.m.map,this.c.r()}o(t){let i=Math.abs,e=this.h,s=e.r,h=this.m,l=e.p,n=this.a,o=h.b(t,l),r=this.w;this.maxlight=s;h.x;let f=this.c.r.bind(this.c),a=this.b&&o[0]>=0&&o[1]>=0&&o[0]<h.z&&o[1]<h.z;e.n=t;let u=function(){for(let t in r[2])r[2][t].a=!1;n.p(2),this.i.d=-1,this.pa=!0,this.u.s=!0,f()}.bind(this);if(h.i(o[0],o[1]))this.hitWall&&!a||(this.hitWall=1,n.x(1),a&&(h.e[o[1]][o[0]]=1));else{let t=1,i=null;for(let e=r[1].length-1;e>=0;e--){let s=r[1][e],h=s.p,l=h[0]==o[0]&&h[1]==o[1];t=t&&(!l||s.w()),l&&(i=s)}if(t){if(e.p=o,e.f++,this.hitWall=0,h.o(o,s),i&&9==i.id)return n.q(),n.x(6),this.pa=!0,this.k(this.nl.bind(this),1e3),void f();if(i&&10==i.id)return void u();e.j-=e.v[e.r],i&&i.b()}}if(this.hitWall&&(o=l),e.j<0)this.gg=1;else if(this.u.s)u();else{let t=!1;for(let f in r[2]){let a,u=r[2][f],c=u.p,d=function(t){return i(t[0]-o[0])<=s&&i(t[1]-o[1])<=s},g=u.a,b=c,p=function(t,i,e,s){let h=function(t,i){return t[0]==i[0]&&t[1]==i[1]};if(t>3)for(let t=0;t<2;t++)if(h(s,this.m.b(i%2+2*t,e)))return 1;return h(e,s)}.bind(this,u.id,u.n);if(p(b,o)||p(b,l))n.x(2),e.h--,this.ds(u.u),e.h<=0&&(this.gg=2);else{if(g)b=h.f(c,o,2==u.id),b||(b=c);else if(Math.random()<.3){h.a(c)}if(b!=c){let t;t=b[0]!=c[0]?b[0]<c[0]?0:2:b[1]<c[1]?1:3,u.p=b,u.n=t,u.f++}p(b,o)||(a=d(b),u.a=a,!g&&a&&(n.q(),this.k((function(){n.x(0)}),200),this.k((function(){n.p(1)}),900)),t=t||a,u.a=a)}}t||n.p(0)}this.gg&&this.k(function(){this.e[2]=!0,this.a.q()}.bind(this),1e3),f()}}new g}]);</script></body></html>