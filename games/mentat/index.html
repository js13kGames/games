<!doctype html><title>Mentat - js13kGames 2012</title><style>*{vertical-align:baseline;font-weight:inherit;font-family:inherit;font-style:inherit;font-size:100%;border:0 none;outline:0;padding:0;margin:0;background:0 0;cursor:default;-webkit-user-select:none}::selection{background:0 0;color:transparent}body{position:relative;width:20em;height:100%;margin:1em auto;background:#fdf6e3;color:#586e75}h1{text-align:center;margin:0 auto;padding:.5em 0;width:33%;font-size:2em}h2{font-size:1.25em;line-height:1.2;margin:1.65em 0 .75em 0}p{font-size:1em;line-height:1.5;margin-bottom:1.5em}#player1,#player2{position:absolute;top:0;width:33%;text-align:center}#player1{left:0}#player2{right:0}table{margin:1em auto;border-spacing:1;border:.0625em solid #586e75;border-radius:.5em;padding:.25em;background:#93a1a1}td{text-align:center;width:4em;height:4em;line-height:4em;border:.0625em solid #586e75;border-radius:.25em;background:#eee8d5;box-shadow:inset 0 0 .25em 0 #657b83}#player1pieces,#player2pieces{display:block;height:3em;margin:1em auto;text-align:center;list-style:none;padding-left:1em}#player1pieces .piece,#player2pieces .piece{margin-left:-1em}.piece{position:relative;display:inline-block;height:2.5em;width:2.5em;line-height:2.5em;font-weight:700;color:transparent;border:.25em dotted #eee8d5;border-radius:2.5em;box-shadow:inset 0 0 .0625em .0625em #586e75,0 0 .125em .0625em #839496,inset 0 2.5em .0625em #fdf6e3}.piece:hover{z-index:1}abbr[title=and]{font-family:fantasy;font-size:1em;line-height:1em}a,a:visited{color:#d33682;text-decoration:none}a:hover{cursor:auto}em{font-style:italic}#credits{text-align:right;font-size:.75em}.piece{margin:0 auto}.green{background:#859900}.magenta{background:#d33682}.cyan{background:#2aa198}.orange{background:#cb4b16}.yellow{background:#b58900}.dragging{z-index:1}.dropping{background:#eee8d5;box-shadow:0 0 .25em .125em #2aa198}.moving{-webkit-transition:top 2s,left 2s;-o-transition:top 2s,left 2s;z-index:1}.playing{color:#586e75}.hide{display:none}.center{text-align:center}.computer-icon span,.human-icon span{display:block;margin:0 auto}#info{display:inline-block;float:left;height:1em;width:1em;line-height:1em;text-align:center;font-style:italic;border:.125em solid #586e75;border-radius:2em}#info:hover{border-color:#d33682}#notes{clear:both}.score{display:block;margin:0 auto;font-size:1.25em}.computer-icon,.human-icon{display:inline-block;width:2em;padding:.5em 0}.human-icon span:first-child{display:block;margin:0 auto;height:.725em;width:.6em;border:.0625em solid #586e75;border-radius:.5em}.human-icon span:last-child{display:block;margin:0 auto;height:1em;width:.75em;border:.0625em solid #586e75;border-radius:.5em .5em 0 0}.computer-icon span:first-child{height:1em;width:1.5em;border-radius:.125em;border:.125em solid transparent;box-shadow:0 0 0 .0625em #586e75,inset 0 0 0 .0625em #586e75,inset 0 1em 0 .0625em #eee8d5}.computer-icon span:last-child{height:.6em;width:1.5em;border:.0625em solid #586e75;border-radius:.125em .125em 0 0}</style><h1>Mentat</h1><div id=player1><span class=human-icon id=player1icon><span class=cyan></span><span class=cyan></span></span> <span class=score id=player1score>0</span></div><div id=player2><span class=computer-icon id=player2icon><span class=yellow></span><span class=yellow></span></span> <span class=score id=player2score>0</span></div><ul id=player2pieces><li class="piece yellow">0<li class="piece yellow">0<li class="piece yellow">0<li class="piece yellow">0<li class="piece yellow">0<li class="piece yellow">0<li class="piece yellow">0<li class="piece yellow">0</ul><table><tr><td class="c1 d1 r1"><td class="c2 r1"><td class="c3 r1"><td class="c4 d2 r1"><tr><td class="c1 r2"><td class="c2 d1 r2"><td class="c3 d2 r2"><td class="c4 r2"><tr><td class="c1 r3"><td class="c2 d2 r3"><td class="c3 d1 r3"><td class="c4 r3"><tr><td class="c1 d2 r4"><td class="c2 r4"><td class="c3 r4"><td class="c4 d1 r4"></table><ul id=player1pieces><li class="piece cyan">0<li class="piece cyan">0<li class="piece cyan">0<li class="piece cyan">0<li class="piece cyan">0<li class="piece cyan">0<li class="piece cyan">0<li class="piece cyan">0</ul><p id=info>i<div id=notes class=hide><h2>How to Play</h2><p>You’re blue, and you go first. Drag a numbered playing piece onto the game board.<p>You score points if the sum of the pieces in the row or column you played in (major diagonals count too) is evenly divisible by 3, 5, or 7.<p class=center><span class="piece magenta playing">3</span> <span class="piece magenta playing">5</span> <span class="piece magenta playing">7</span><p>So if you’re first move is a 5 in a corner, you’ll score 3 points. Five goes into five one time, and you score once for each row, column, and diagonal.<p>Additionally, you can score bonus points for getting two of a kind (2 points), three of a kind (6 points), four of a kind (12 points), or four consecutive numbers (4 points) in the same row, column, or diagonal.<p>There are 52 pieces in the game, four sets of 1 through 13.<h2>Taking Turns</h2><p>You can click the human and computer icons above the scores to toggle who plays which color.<p class=center><span class=human-icon><span class=magenta></span><span class=magenta></span></span> <span class=computer-icon><span class=magenta></span><span class=magenta></span></span><p>Play against a friend, or have the computer go first if you want more of a challenge.<h2>Colophon</h2><p><em>Mentat</em> was named after the quick thinking humans in Frank Herbert’s <em><a href=http://en.wikipedia.org/wiki/Dune_(novel) title="Wikipedia’s entry for Dune">Dune</a></em> books. Ethan Schoonover’s <a href=http://ethanschoonover.com/solarized title="Ethan Schoonover’s precision colors for machines and people">Solarized</a> provies the color scheme, and the rules where inspired by Keith Stevens’ card game <em><a href=http://www.pagat.com/invented/kstevens/ title="Rules for playing Keith Stevens’ card game">DOM</a></em>. All the HTML, CSS, and JavaScript where hand written in <a href=http://code.google.com/p/macvim/ title="Vim for the Mac">MacVim</a>. Feel free to fork the code on <a href=https://github.com/elimossinary/mentat title="Frank Mitchell’s Github repository for Mentat">Github</a>.</div><p id=credits>Design <abbr title=and>&</abbr> dev by <a href=http://frankmitchell.org/ title="designer, engineer, wizard">Frank Mitchell</a> for <a href=https://js13kgames.com/ title="HTML5 and JavaScript Game Development competition in just 13 kilobytes">js13kGames</a>.<br>Colored with <a href=http://ethanschoonover.com/solarized title="Ethan Schoonover’s precision colors for machines and people">Solarized</a> and inspired by <em><a href=http://www.pagat.com/invented/kstevens/ title="Rules for playing Keith Stevens’ card game">DOM</a></em>.</p><script>O=document,I=[],P=function(e){var t,n,o=[];if(e instanceof P)return e;if("string"==typeof(this.element=e)){if(0===e.indexOf("#")&&(this.element=document.getElementById(e.slice(1))),0===e.indexOf(".")){for(n=O.getElementsByClassName(e.slice(1)),t=0;t<n.length;t+=1)o.push(new P(n[t]));return o}if(0===e.indexOf("<")){for(e=e.slice(1,-1),n=O.getElementsByTagName(e),t=0;t<n.length;t+=1)o.push(new P(n[t]));return o}}return this},Y.fromPoint=function(e,t,n){return(n=Y(n)).add("hide"),e=Y(O.elementFromPoint(e,t)),n.remove("hide"),e},Y.stopAnimations=function(){for(var e,t,n,o=0;o<I.length;o+=1)e=I[o].element,t=I[o].callback,n=I[o].class,e.off("webkitTransitionEnd",t),e.off("otransitionend",t),e.remove(n)},P.prototype.html=function(e){if(this.element){if(void 0===e)return this.element.innerHTML;this.element.innerHTML=e}return this},P.prototype.int=function(){return parseInt(this.html(),10)},P.prototype.top=function(e){if(this.element){if(void 0===e)return parseInt(this.element.style.top,10);this.element.style.top=e+"px"}},P.prototype.left=function(e){if(this.element){if(void 0===e)return parseInt(this.element.style.left,10);this.element.style.left=e+"px"}},P.prototype.toggle=function(e){this.has(e)?this.remove(e):this.add(e)},P.prototype.has=function(e){return!!this.element&&0<=this.element.className.indexOf(e)},P.prototype.add=function(e){this.element&&this.element.className.indexOf(e=" "+e)<0&&(this.element.className+=e)},P.prototype.remove=function(e){return this.element&&(e=new RegExp("(\\s+)?"+e,"g"),this.element.className=this.element.className.replace(e,"")),this},P.prototype.on=function(e,t){this.element&&this.element.addEventListener(e,t,!1)},P.prototype.off=function(e,t){this.element&&this.element.removeEventListener(e,t,!1)},P.prototype.center=function(){var e=this.element,t=0,n=0;for(e&&(t=e.offsetWidth/2,n=e.offsetHeight/2);e&&!isNaN(e.offsetLeft)&&!isNaN(e.offsetTop);)t+=e.offsetLeft-e.scrollLeft,n+=e.offsetTop-e.scrollTop,e=e.offsetParent;return{x:t,y:n}},P.prototype.animate=function(e,t){var n,o=this;this.element&&(I.push({element:o,callback:n=function(){for(var i=[],r=0;r<I.length;r+=1)I[r].element!==o&&I[r].callback!==n&&I[r].class!==e&&i.push(I[r]);I=i,o.off("webkitTransitionEnd",n),o.off("otransitionend",n),o.remove(e),t&&t()},class:e}),this.on("webkitTransitionEnd",n),this.on("otransitionend",n),this.add(e))},P.prototype.name=function(){return this.element?this.element.nodeName:""},P.prototype.data=function(e){if(this.element){if(void 0===e)return parseInt(this.element.getAttribute("data-value"),10);this.element.setAttribute("data-value",e)}return""},P.prototype.klass=function(){return this.element?this.element.className:""},P.prototype.kids=function(e){return this.element?this.element.getElementsByTagName(e):[]},P.prototype.unwrap=function(){return this.element};var e,t,n,o,i,r,s,l,f,a,c,u,h,m,p,d,v,g,y,N,k,w,b,x,T,E,L,O,I,P,A=Y;function B(){var t=0,n=0,i=[];for(e.stopAnimations(),t=0;t<4;t+=1)for(n=1;n<=13;n+=1)i.push(n);var s,l,f=i,a=0;for(a=f.length-1;0<a;--a)l=Math.floor(Math.random()*(a+1)),s=f[a],f[a]=f[l],f[l]=s;o=2,u(1,i),u(2,i);var c=0,h=e("<td>");for(c=0;c<h.length;c+=1)h[c].html("").data("");r(0,1),r(0,2),m()}function M(t){var o=e(this),i=function(e){return n.off("mouseup",i),o.toggle("human-icon"),o.toggle("computer-icon"),B(),!1};return n.on("mouseup",i),!1}function X(e){return w.unwrap()&&L(),(w=d(this)).add("dragging"),N=w.left(),k=w.top(),g=e.clientX,y=e.clientY,v.on("mousemove",E),v.on("mouseup",L),!1}function Y(e){return new P(e)}v=(d=A)(document),k=N=y=g=0,w=d(),b=d(),T=x=null,E=function(e){return w.left(N+(e.clientX-g)),w.top(k+(e.clientY-y)),b.remove("dropping"),b=d.fromPoint(e.clientX,e.clientY,w),x(b)&&b.add("dropping"),!1},L=function(e){return v.off("mouseup",L),v.off("mousemove",E),w.remove("dragging"),(b=d.fromPoint(e.clientX,e.clientY,w)).remove("dropping"),x(b)&&T(w,b),w.left(N),w.top(k),b=d(),w=d(),!1},t={bind:function(e,t,n){(e=d(e)).on("mousedown",X),e.left(0),e.top(0),x=t,T=n},unbind:function(e){d(e).off("mousedown",X)}},n=(e=A)(document),o=2,i=function(e,t){return e%t==0?e/t:0},r=function(t,n){e("#player"+(n=void 0===n?o:n)+"score").html(t)},s=function(e){var t,n=0,o=0,i=0;if(e.length<=1)return 0;if(t=function(e){var t=0,n={};for(t=0;t<e.length;t+=1)n[e[t]]=1;return Object.keys(n).length}(e),e.length<=2)return 1===t?2:0;if(e.length<=3)return 2===t?2:1===t?6:0;for(i=o=0,e.sort(),n=0;n<e.length-1;n+=1)e[n]+1===e[n+1]&&(i+=1);return 3===i&&(o+=4),3===t&&(o+=2),2===t&&(o+=6),1===t&&(o+=12),o},l=function(t,n){var r=0,l=0,f=0,a=[],c=e("#player"+o+"score").int(),u=[],h=0,m=(t=e(t)).klass().replace(/\s+/g," ").split(" ");for(r=0;r<m.length;r+=1){for(h=0,a=[],u=e("."+m[r]),l=0;l<u.length;l+=1)f=u[l].data(),n&&u[l].klass()===t.klass()&&(f=n),isNaN(f)||(a.push(f),h+=f);c=(c=(c=(c+=i(h,3))+i(h,5))+i(h,7))+s(a)}return c},f=function(t){return"TD"===(t=e(t)).name()&&""===t.html()},a=function(t){return e("#player"+(t=void 0===t?o:t)+"pieces").kids("li")},c=function(){var t=e("#player1icon"),n=e("#player2icon");return t.has("human-icon")&&n.has("human-icon")?"hvh":t.has("human-icon")&&n.has("computer-icon")?"hvc":t.has("computer-icon")&&n.has("human-icon")?"cvh":t.has("computer-icon")&&n.has("computer-icon")?"cvc":""},u=function(t,n){var o=0,i=c(),r=null,s=a(t);for(o=0;o<s.length;o+=1)(r=e(s[o])).html(n.shift()),r.remove("hide"),r.remove("moving"),r.left(0),r.top(0),"cvc"===i||"hvc"===i&&1===t||"cvh"===i&&2===t?r.add("playing"):r.remove("playing")},h=function(){var t,n,o,i,r,s,c=0,u=0,h=e("<td>"),m=[],d=null,v=a(),g={piece:void 0,tile:void 0,score:0};for(c=0;c<h.length;c+=1)f(h[c])&&m.push(h[c]);for(c=0;c<v.length;c+=1)if(!(d=e(v[c])).has("hide"))for(t=d.int(),u=0;u<m.length;u+=1)(n=l(m[u],t))>=g.score&&(g={piece:d,tile:m[u],score:n});o=g.piece,i=g.tile,f(i)&&(o=e(o),i=e(i),r=o.left(),s=o.top(),o.add("playing"),o.animate("moving",function(){p(o,i),o.remove("playing"),o.left(r),o.top(s)}),o.left(o.left()+(i.center().x-o.center().x)),o.top(o.top()+(i.center().y-o.center().y)))},m=function(){var n=0,i=c(),r=a();for(n=0;n<r.length;n+=1)t.unbind(r[n]),"hvh"===i&&e(r[n]).remove("playing");for(o=1===o?2:1,r=a(),n=0;n<r.length;n+=1)t.bind(r[n],f,p),(1===o&&"hvc"===i||2===o&&"cvh"===i||"hvh"===i||"cvc"===i)&&e(r[n]).add("playing");("cvc"===i||"cvh"===i&&1===o||"hvc"===i&&2===o)&&h()},p=function(t,n){t=e(t),(n=e(n)).data(t.html()),n.html('<span class="'+t.klass()+'">'+t.html()+"</span>"),t.add("hide"),r(l(n)),m()},e("#player1icon").on("mousedown",M),e("#player2icon").on("mousedown",M),e("#notes").add("hide"),e("#info").on("mousedown",function(){n.on("mouseup",function t(){n.off("mouseup",t),e("#notes").toggle("hide")})}),B()</script>