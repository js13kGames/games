<!doctype html><title>üê°‚öîÔ∏èüõ°</title><meta content="width=device-width" name=viewport><meta content=https://platane.github.io/js13k-2021/images/600x400.jpg property=og:image><meta content="A pretty blob simulation with zero game play. A game made for the 2021 js13kGames.com competition." name=description><meta content=Delph name=title><meta content="width=device-width,initial-scale=1" name=viewport><style>body{font-family:Helvetica,sans-serif;background-color:#f4f4f0}</style><canvas style=position:fixed;top:0;left:0;width:100%;height:100%;touch-action:none></canvas><footer style="position:fixed;bottom:0;right:0;padding:0 4px"><a href=# id=splash-up>controls</a> <a href=https://github.com/Platane/js13k-2021>source</a></footer><div id=splash style="position:fixed;top:0;left:0;width:100%;height:100%;backdrop-filter:blur(5px);transition:opacity .2s ease;padding:40px;color:#333;background-color:#ffffff66;text-shadow:0 0 3px #f8f8f6;font-size:1.2em"><h1>Delph</h1><span>üê°‚öîÔ∏èüõ°</span><h4>A pretty blob simulation<br>With zero game play</h4><br><br><h5>Controls:</h5><ul><li><b>Left Click</b> to select a blob<li><b>Right Click</b> to command the blob to move<li><b>Drag</b> the blob to split it in half</li><br><li>There is no goals, apart from enjoying the graphics <i>(sorry)</i></ul><br><br><button id=splash-dismiss style=padding:20px>Let's go !</button></div><script>let t=Object.fromEntries(Array.from(new URLSearchParams(window.location.search).entries()).map((([t,e])=>[t,"0"!==e]))),n={t:0,o:0,s:0,i:0};if(Object.assign(n,t),"all"in t)for(let e in n)n[e]=t.all;let e=[Array.from({length:26},(()=>new Uint16Array([65536*(.2*Math.random()+.5),65536*(.16*Math.random()+.6)]))),Array.from({length:14},(()=>new Uint16Array([65536*(.12*Math.random()+.4),65536*(.14*Math.random()+.15)]))),Array.from({length:16},(()=>new Uint16Array([65536*(.2*Math.random()+.3),65536*(.14*Math.random()+.32)])))];var o,r=1,a=[0,0],i=[65536,65536],l=e.map((()=>[])),s=0,u=null,c=null,f="undefined"!=typeof Float32Array?Float32Array:Array;function h(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function m(t,e,n,r){t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r}function M(t,e){return Math.hypot(e[0]-t[0],e[1]-t[1])}function d(t,e){var n=e[0]-t[0];return n*n+(t=e[1]-t[1])*t}function p(t){return Math.hypot(t[0],t[1])}function v(t,e){var n=e[0],r=e[1];0<(n=n*n+r*r)&&(n=1/Math.sqrt(n)),t[0]=e[0]*n,t[1]=e[1]*n}function g(t,e){return t[0]*e[0]+t[1]*e[1]}function y(t,e,n,r){var a=e[0];e=e[1],t[0]=a+r*(n[0]-a),t[1]=e+r*(n[1]-e)}Math.hypot||(Math.hypot=function(){for(var t=0,e=arguments.length;e--;)t+=arguments[e]*arguments[e];return Math.sqrt(t)}),o=new f(2),f!=Float32Array&&(o[0]=0,o[1]=0);let b=(t,e)=>{t[0][0]=Math.min(t[0][0],e[0]),t[0][1]=Math.min(t[0][1],e[1]),t[1][0]=Math.max(t[1][0],e[0]),t[1][1]=Math.max(t[1][1],e[1])},x=(t,e)=>{e.forEach((e=>b(t,e)))},w=(t,e)=>{var n=t[0][0],r=t[1][0],a=e[0][0],o=e[1][0];return(n=n<=o&&a<=r||a<=r&&n<=o)&&(n=t[0][1],t=t[1][1],r=e[0][1],n=n<=(e=e[1][1])&&r<=t||r<=t&&n<=e),n},A=t=>(t[0][0]=1/0,t[0][1]=1/0,t[1][0]=-1/0,t[1][1]=-1/0,t),P=2.8/100*65536,S=Math.sqrt(-2*Math.log(.38)*P*P),k=(t,e,n)=>t.reduce(((t,[r,a])=>(r=Math.hypot(e-r,n-a),t+Math.exp(-.5*r*r/(P*P)))),0),K=Math.sqrt(-2*Math.log(.38)*P*P),B=K/4,T=[0,0],F=(t,e,n)=>{h(T,t[n],e=t[e]);var r=(n=p(T))-2*K;const a=Math.ceil(r/B);r=(r-(a-1)*B)/2;for(let o=0;o<a;o++){const l=a/2+(o%2?o/2:-(o+1)/2);if(!(.38<k(t,e[0]+T[0]/n*(K+r+l*B),e[1]+T[1]/n*(K+r+l*B))))return 0}return 1},I=(t,e,n=t.map(((t,e)=>e)))=>{const r=[e];for(-1!==(e=n.indexOf(e))&&n.splice(e,1),e=0;e<r.length;e++){const a=r[e];for(let e=n.length;e--;){const o=n[e];F(t,a,o)&&(n.splice(e,1),r.push(o))}}return r},U=(t,e,n)=>(t[0]=Math.floor(e/r-a[0]),t[1]=Math.floor(n/r-a[1]),t),_=Symbol(),j=Symbol(),q=null,D=0,N=0,$=[0,0],O=(t,e)=>{if(!(.38<k(e,t[0],t[1])))return null;let n=1/0,r=0;return e.forEach(((e,a)=>{(e=M(e,t))<n&&(n=e,r=a)})),I(e,r)},X=({pageX:t,pageY:n,button:r,ctrlKey:a,timeStamp:o})=>{switch(q=null,N=o,D=1,$[0]=t,$[1]=n,r){case 0:if(t=U([0,0],t,n),a)q=_,u=[t,t.slice()],c=null;else{if(!c||!((t,e,n)=>.38<k(t,e,n))((c??[]).map((t=>e[s][t])),t[0],t[1]))for(c=null,a=e.length;a--;)(n=O(t,e[a]))&&(c=n,s=a);c&&4<=c.length&&(q=j)}break;case 2:const r=c;if(r){var i=s;l[i].forEach(((t,e)=>{t.l=t.l.filter((t=>!r.includes(t))),0===t.l.length&&l[i].splice(e,1)})),l[i].push({l:r.slice(),target:{u:U([0,0],t,n)}})}}},Y=({pageX:t,pageY:n})=>{switch(D=D&&50>M($,[t,n]),q){case j:const i=h([0,0],$,[t,n]);if(100<p(i)){q=null,v(i,i);const r=s,a=c.slice().sort(((t,n)=>g(i,e[r][t])-g(i,e[r][n])));var o=Math.floor(a.length/2);const h=a.slice(0,o),f=a.slice(o),u=[0,0];U(u,t,n),m(u,u,i,500+500*Math.sqrt(o));const R=A([[],[]]);f.forEach((t=>b(R,e[r][t]))),y(t=[0,0],...R,.5),m(t,t,i,500+500*Math.sqrt(o)),l[r].forEach(((t,e)=>{t.l=t.l.filter((t=>!a.includes(t))),0===t.l.length&&l[r].splice(e,1)})),l[r].push({l:h,target:{u:u}},{l:f,target:{u:t}}),c=h.slice()}break;case _:(o=u)[1][0]=Math.floor(t/r-a[0]),o[1][1]=Math.floor(n/r-a[1]);const f=(([[t,e],[n,r]])=>{const a=Math.min(t,n),o=Math.max(t,n),l=Math.min(e,r),i=Math.max(e,r);return([t,e])=>a<=t&&t<=o&&l<=e&&e<=i})(o);c=e[s].reduce(((t,e,n)=>f(e)?[...t,n]:t),[])}},z=({timeStamp:t})=>{if(q&&D&&240>t-N){t=U([0,0],$[0],$[1]);for(let n=e.length;n--;){const r=O(t,e[n]);r&&(c=r,s=n)}}q=u=null},L=document.getElementsByTagName("canvas")[0],R=L.getContext("2d"),C=()=>{L.width=L.clientWidth,L.height=L.clientHeight,r=Math.min(L.clientWidth/i[0],L.clientHeight/i[1])};C(),window.addEventListener("resize",C);let E=document.createElement("canvas");E.height=E.width=Math.min(window.innerWidth,window.innerHeight),E.style.position="fixed",E.style.zIndex="-1",E.style.top="0",E.style.left="0",E.style.transform="scale(1,-1)",document.body.appendChild(E);let G=E.getContext("webgl2"),H=(t,e)=>(e=G.createShader(e),G.shaderSource(e,t),G.compileShader(e),e),J=[],Q=[],V=document.createElement("canvas");V.width=V.height=128;let W=V.getContext("2d");W.scale(1.28,1.28),W.fillStyle="orange",W.beginPath(),W.fillRect(0,0,100,100),W.fillStyle="#f5ce88",W.beginPath(),W.moveTo(50,14),W.lineTo(10,55),W.lineTo(90,55),W.fill(),W.beginPath(),W.arc(50,60,28,0,Math.PI),W.fill();let{data:Z}=W.getImageData(0,0,128,128);Q.push(Z),J.push(V);let tt=document.createElement("canvas");tt.width=tt.height=128;let nt=tt.getContext("2d");nt.scale(1.28,1.28),nt.fillStyle="seagreen",nt.beginPath(),nt.fillRect(0,0,100,100),nt.fillStyle="#3fb774",nt.beginPath(),nt.moveTo(50,14),nt.lineTo(10,55),nt.lineTo(50,80),nt.lineTo(90,55),nt.fill();let{data:et}=nt.getImageData(0,0,128,128);Q.push(et),J.push(tt);let ot=document.createElement("canvas");ot.width=ot.height=128;let rt=ot.getContext("2d");rt.scale(1.28,1.28),rt.fillStyle="#b73f2b",rt.beginPath(),rt.fillRect(0,0,100,100),rt.fillStyle="#bf5d4d",rt.beginPath(),rt.arc(50,60,28,0,Math.PI),rt.fill(),rt.beginPath(),rt.arc(50,40,28,-Math.PI,0),rt.fill();let{data:at}=rt.getImageData(0,0,128,128);Q.push(at),J.push(ot);let it=document.createElement("canvas");it.width=it.height=128;let lt=it.getContext("2d");lt.scale(1.28,1.28),lt.fillStyle="#da9143",lt.beginPath(),lt.fillRect(0,0,100,100),lt.fillStyle="#e09c52",lt.beginPath(),lt.arc(50,60,28,0,Math.PI),lt.fill(),lt.beginPath(),lt.arc(50,40,28,-Math.PI,0),lt.fill();let{data:st}=lt.getImageData(0,0,128,128);Q.push(st),J.push(it);let ut=Q.map((t=>`rgb(${t[0]},${t[1]},${t[2]})`));Array.from({length:400},(()=>({l:[0],h:[[0,0],[0,0]]})));let ct=Array.from({length:400},(()=>({l:e.map((()=>[])),h:[[0,0],[0,0]]}))),ft=t=>{let n=0;e.map(((e,r)=>e.forEach(((e,a)=>{const o=ct[n++];o.h[0][0]=e[0]-t,o.h[0][1]=e[1]-t,o.h[1][0]=e[0]+t,o.h[1][1]=e[1]+t,o.l.forEach((t=>t.length=0)),o.l[r].push(a)}))));let r=1;for(;r;){r=0;for(let t=0;t<n;t++)for(let e=t+1;e<n;e++)w(ct[t].h,ct[e].h)&&(x(ct[t].h,ct[e].h),ct[e].l.forEach(((n,r)=>{ct[t].l[r].push(...ct[e].l[r])})),ct.push(...ct.splice(e,1)),n--,r=1)}return ct.slice(0,n)};const ht=H("#version 300 es\nuniform highp vec2 camera_a;\nuniform highp vec2 camera_offset;\nin vec2 position;\nin float iBox;\nout vec2 pos;\nflat out int iB;\n// out int iBox2;\nvoid main() {\ngl_Position = vec4(position.xy * camera_a * 2.0 - 1.0, 0.0, 1.0);\npos = position.xy;\niB = int(iBox);\n}",G.VERTEX_SHADER),mt=H("#version 300 es\nprecision highp float;\nuniform highp usampler2D pointTexture;\nuniform highp sampler2D bannerTexture;\nuniform highp float tauSquare;\nuniform highp float threshold;\nuniform int nPoint;\nuniform int nK;\nin vec2 pos;\nflat in int iB;\nout vec4 color;\nfloat gauss(float x) { return exp(-0.5 * (x * x) / (tauSquare)); }\nvoid main() {\n// color = vec4(0.0, 0.0, 0.0, 0.07);\nfloat bestSum = 0.0;\nint bestK = -1;\nfor (int k = 0; k < nK; k++) {\nfloat sum = 0.0;\nfor (int i = 0; i < nPoint; i++) {\nuvec2 uPointPosition =\ntexelFetch(pointTexture, ivec2(iB * nK + k, i), 0).xy;\nvec2 pointPosition = vec2(uPointPosition.xy);\nif (pointPosition.x != 0.0 || pointPosition.y != 0.0) {\nfloat d = distance(pointPosition, pos);\nsum += gauss(d);\n}\n}\nif (sum > threshold && sum > bestSum) {\nbestSum = sum;\nbestK = k;\n}\n}\nif (bestK >= 0) {\nfloat m = 0.0003;\nfloat w = 1.0 / float(nK);\nfloat y = floor(pos.y * m);\nvec2 u = vec2(\n//\n(mod((pos.x) * m + 0.5 * mod(y, 2.0), 1.0) * 0.96 + 0.02) * w +\nw * float(bestK),\n//\nmod(pos.y * m, 1.0) * 0.96 + 0.02);\ncolor = texture(bannerTexture, u);\ncolor.w = (bestSum - threshold) / (threshold * 0.1);\n}\n}\n",G.FRAGMENT_SHADER),Mt=G.createProgram();G.attachShader(Mt,ht),G.attachShader(Mt,mt),G.deleteShader(ht),G.deleteShader(mt),G.linkProgram(Mt),G.useProgram(Mt);let dt=e.length,pt=16*dt,vt=G.createTexture(),gt=new Uint16Array(256*pt),yt=G.getUniformLocation(Mt,"pointTexture");G.activeTexture(G.TEXTURE1),G.bindTexture(G.TEXTURE_2D,vt),G.uniform1i(yt,1),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.NEAREST),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.NEAREST);let bt=G.createTexture(),xt=G.getUniformLocation(Mt,"bannerTexture");G.activeTexture(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,bt),G.uniform1i(xt,0);let wt=document.createElement("canvas");wt.width=e.length*J[0].width,wt.height=J[0].height;let At=wt.getContext("2d");e.forEach(((t,e)=>{At.drawImage(t=J[e%J.length],e*t.width,0)})),G.texImage2D(G.TEXTURE_2D,0,G.RGBA,wt.width,wt.height,0,G.RGBA,G.UNSIGNED_BYTE,wt),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MIN_FILTER,G.NEAREST),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_MAG_FILTER,G.NEAREST),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_S,G.CLAMP_TO_EDGE),G.texParameteri(G.TEXTURE_2D,G.TEXTURE_WRAP_T,G.CLAMP_TO_EDGE),G.generateMipmap(G.TEXTURE_2D),G.uniform1f(G.getUniformLocation(Mt,"tauSquare"),P*P),G.uniform1f(G.getUniformLocation(Mt,"threshold"),.38),G.uniform1i(G.getUniformLocation(Mt,"nK"),e.length);let Pt=G.getUniformLocation(Mt,"nPoint"),St=G.getUniformLocation(Mt,"camera_a"),kt=G.getUniformLocation(Mt,"camera_offset"),Kt=G.createBuffer(),Bt=new Float32Array(192),Tt=G.getAttribLocation(Mt,"position");G.bindBuffer(G.ARRAY_BUFFER,Kt),G.enableVertexAttribArray(Tt),G.vertexAttribPointer(Tt,2,G.FLOAT,0,0,0),G.bufferData(G.ARRAY_BUFFER,Bt,G.STATIC_DRAW),G.bindAttribLocation(Mt,Tt,"position");let Ft=G.createBuffer(),It=new Float32Array(96);for(let t=16;t--;)It.fill(t,6*t,6*(t+1));let Ut=G.getAttribLocation(Mt,"iBox");G.bindBuffer(G.ARRAY_BUFFER,Ft),G.enableVertexAttribArray(Ut),G.vertexAttribPointer(Ut,1,G.FLOAT,0,0,0),G.bufferData(G.ARRAY_BUFFER,It,G.STATIC_DRAW),G.bindAttribLocation(Mt,Ut,"iBox");let _t=[0,0],jt=[0,0],qt=[0,0],Dt=[0,0],Nt=[0,0],$t=(t,e,n)=>{const r=[0,0,0];return Dt[0]=(t[0]+e[0])/2,Dt[1]=(t[1]+e[1])/2,Nt[0]=(n[0]+e[0])/2,Nt[1]=(n[1]+e[1])/2,jt[0]=t[1]-e[1],jt[1]=-(t[0]-e[0]),qt[0]=e[1]-n[1],qt[1]=-(e[0]-n[0]),Math.abs(jt[0]*qt[1]-jt[1]*qt[0])<Number.EPSILON?Math.abs(jt[0]*(Dt[1]-Nt[1])-jt[1]*(Dt[1]-Nt[1]))<Number.EPSILON&&(r[0]=Dt[0],r[1]=Dt[1]):(e=Math.abs(qt[0])<Number.EPSILON?(Nt[0]-Dt[0])/jt[0]:Math.abs(qt[1])<Number.EPSILON?(Nt[1]-Dt[1])/jt[1]:((Dt[0]-Nt[0])/qt[0]-(Dt[1]-Nt[1])/qt[1])/(jt[1]/qt[1]-jt[0]/qt[0]),r[0]=Dt[0]+jt[0]*e,r[1]=Dt[1]+jt[1]*e),r[2]=d(t,r),r},Ot=[[0,0],[0,0]],Xt=t=>{x(A(Ot),t),Ot[0][0]-=1e6,Ot[0][1]-=1e6,Ot[1][0]+=1e6,Ot[1][1]+=1e6;var e=[[Ot[0][0],Ot[0][1]],[Ot[0][0],Ot[0][1]+2*(Ot[1][1]-Ot[0][1])],[Ot[0][0]+2*(Ot[1][0]-Ot[0][0]),Ot[0][1]]];const n=t.length;t.push(...e);const r=[[n,n+1,n+2]];e=[$t(...e)];for(let l=n;l--;){const n=t[l],i=[];for(var a=e.length;a--;)if(d(n,e[a])<=e[a][2]){var o=r[a];e.splice(a,1),r.splice(a,1);for(let t=3;t--;){const e=o[t],n=o[(t+1)%3],r=i.findIndex((([t,r])=>t===e&&r===n||t===n&&r===e));-1<r?i.splice(r,1):i.push([e,n,0])}}for(a=i.length;a--;)(o=i[a])[2]=l,e.push($t(t[o[0]],t[o[1]],n)),r.push(o)}for(e=r.length;e--;)(r[e][0]>=n||r[e][1]>=n||r[e][2]>=n)&&r.splice(e,1);return t.splice(n,3),r},Yt=(t,e,n,r,a,o)=>{const l=S/100;for(;Math.abs(a-o)>l;){const t=(a+o)/2;.38<k(e,n[0]+t*r[0],n[1]+t*r[1])?a=t:o=t}return t[0]=n[0]+(e=(a+o)/2)*r[0],t[1]=n[1]+e*r[1],t},zt=[1,0],Lt=[1,0],Rt=[0,0],Ct=[0,0],Et=(t,e,n)=>{var r=[0,0],a=Gt;let o=n;Lt[0]=a[1],Lt[1]=-a[0];for(let l=3;l--;){if(m(Rt,e,a,o),m(Rt,Rt,Lt,-n/2),m(Ct,Rt,Lt,n),.38<k(t,Rt[0],Rt[1])&&!(.38<k(t,Ct[0],Ct[1])))return Yt(r,t,Rt,Lt,0,n);o/=2}return null},Gt=[0,0],Ht=[1,0],Jt=t=>{var e=S/3;let n=(t=>{var e=[0,0];((t,e)=>{t[0]=e[0],t[1]=e[1]})(e,t.reduce(((t,e)=>t[0]>e[0]?t:e)));const n=S/1.2;e[0]+=.9*S;for(let r=100;r--;)if(e[0]+=n,!(.38<k(t,e[0],e[1])))return Yt(e,t,e,zt,-n,0);return null})(t);var r=[n[0],n[1]-1];const a=[n];for(let l=200;l--;){let l;if(h(Gt,n,r),v(Gt,Gt),l=Et(t,n,e),!l){var o=Gt;for((r=Ht)[0]=o[1],r[1]=-o[0],r=5;!l&&r--;)y(Gt,Gt,Ht,.5),v(Gt,Gt),l=Et(t,n,e)}if(!l)return null;if(r=n,n=l,4<a.length&&M(a[0],n)<1.6*e){0<g(t=h([0,0],a[0],n),Gt)&&a.push(n);break}a.push(n)}return a},Qt=(2.6*S)**2,Vt=t=>{const e=t.shift();if(!e)return[];const n=[e.m];let r;for(r=e;r=Wt(t,r);)n.push(r.m);for(r=e;r=Wt(t,r);)n.unshift(r.m);return t=Vt(t),2<=n.length&&t.push({M:e.M,p:e.p,line:n}),t},Wt=(t,e)=>{for(let n=t.length;n--;){const r=t[n];for(let a=e.e.length;a--;)for(let o=r.e.length;o--;)if(e.e[a]===r.e[o])return e.e.splice(a,1),r.e.splice(o,1),t.splice(n,1),r}return null},Zt=[0,0],tn=[0,0],nn=[0,0],en=e.map((()=>Array.from({length:128},(()=>[0,0])))),on=1/60,rn=t=>{600>t&&(t=600);const e=.9*S;let n=4e9/(t*t);return t>e&&(n/=(1+(t-e)/(.5*S))**4),t>1.3*e&&(n=0),n},an=Date.now()/1e3,ln=0,sn=()=>{for(var t=Date.now()/1e3;an+.016666666666666666*ln<=t;ln++)ft(1.5*S).forEach((t=>{const n=[],r=[];t.l.forEach(((t,a)=>t.forEach((t=>{n.push(e[a][t]),r.push(a)}))));const a=Xt(n),o=2<=t.l.reduce(((t,e)=>t+ +!!e.length),0)?((t,e,n)=>{const r=[];return n.forEach((n=>{if(!(e[n[0]]!==e[n[1]]&&e[n[0]]!==e[n[2]]&&e[n[1]]!==e[n[2]]||e[n[0]]===e[n[1]]&&e[n[0]]===e[n[2]]))for(let c=3;c--;){const s=n[c],f=n[(c+1)%3],u=n[(c+2)%3];if(e[s]===e[f]&&(d(t[u],t[s])<Qt||d(t[u],t[f])<Qt)){var a=r,o=a.push,l=t[u],i=t[s],h=t[f];l=new Uint16Array([((l[0]+i[0])/2+(l[0]+h[0])/2)/2,((l[1]+i[1])/2+(l[1]+h[1])/2)/2]),o.call(a,{m:l,M:Math.min(e[s],e[u]),p:Math.max(e[s],e[u]),e:[Math.min(s,u)*t.length+Math.max(s,u),Math.min(f,u)*t.length+Math.max(f,u)]})}}})),Vt(r)})(n,r,a):[];t.l.forEach(((n,r)=>n.forEach((n=>{const a=e[r][n],i=en[r][n];i[0]=0,i[1]=0;const c=l[r].find((t=>t.l.includes(n)));t.l[r].forEach((t=>{(t=e[r][t])!==a&&(h(tn,t,a),t=p(tn),m(i,i,tn,-rn(t)*(c?1:.8)/t))})),c&&(h(tn,c.target.u,a),v(tn,tn),m(i,i,tn,8e3)),c&&o.forEach((({line:t})=>{for(let l=t.length-1;l--;){var e=t[l];h(nn,t[l+1],e);const c=p(nn);var n=1/c,r=nn,o=nn;r[0]=o[0]*n,r[1]=o[1]*n,(n=tn)[0]=(r=nn)[1],n[1]=-r[0],h(Zt,a,e),e=g(nn,Zt),0>(n=g(tn,Zt))&&(o=r=tn,r[0]=-o[0],r[1]=-o[1]),r=Math.max(1400,Math.abs(n)),-S/10<e&&e<c+S/10&&Math.abs(n)<1.4*S&&m(i,i,tn,1e7/r)}}))})))),t.l.forEach(((t,n)=>t.forEach((t=>{const r=e[n][t];r[0]+=(t=en[n][t])[0]*on,r[1]+=t[1]*on}))))})),l.forEach(((t,n)=>t.forEach(((t,r)=>{for(let r=t.l.length;r--;)1e3>M(e[n][t.l[r]],t.target.u)&&t.l.splice(r,1);0===t.l.length&&l[n].splice(r,1)}))));if(R.clearRect(0,0,9999,9999),R.save(),R.scale(r,r),R.translate(a[0],a[1]),(()=>{const t=ft(1.6*S);gt.fill(0),t.forEach((({h:t,l:n},r)=>{Bt[12*r]=t[0][0],Bt[12*r+1]=t[0][1],Bt[12*r+2]=t[1][0],Bt[12*r+3]=t[0][1],Bt[12*r+4]=t[1][0],Bt[12*r+5]=t[1][1],Bt[12*r+6]=t[1][0],Bt[12*r+7]=t[1][1],Bt[12*r+8]=t[0][0],Bt[12*r+9]=t[1][1],Bt[12*r+10]=t[0][0],Bt[12*r+11]=t[0][1],n.forEach(((t,n)=>t.forEach(((t,a)=>{const[o,l]=e[n][t];128>a&&(gt[0+(t=2*(a*pt+(r*dt+n)))]=o,gt[t+1]=l)}))))}));const n=Math.max(...t.map((({l:t})=>t.map((({length:t})=>t)))).flat());G.useProgram(Mt),G.uniform1i(Pt,n),G.uniform2f(St,1/i[0],1/i[1]),G.uniform2f(kt,a[0],a[1]),G.bindBuffer(G.ARRAY_BUFFER,Kt),G.bufferData(G.ARRAY_BUFFER,Bt,G.DYNAMIC_DRAW),G.activeTexture(G.TEXTURE1),G.bindTexture(G.TEXTURE_2D,vt),G.texImage2D(G.TEXTURE_2D,0,G.RG16UI,pt,128,0,G.RG_INTEGER,G.UNSIGNED_SHORT,gt),G.activeTexture(G.TEXTURE0),G.bindTexture(G.TEXTURE_2D,bt),G.clear(G.COLOR_BUFFER_BIT),G.drawArrays(G.TRIANGLES,0,6*t.length)})(),R.lineWidth=.5/r,R.strokeStyle="#000",u){const[[t,e],[n,r]]=u;R.strokeRect(t,e,n-t,r-e)}if((()=>{if(c){const n=s,a=c.slice();for(R.lineWidth=3/r,R.strokeStyle="#666";a.length;){var t=I(e[n],a[0],a);if(t=Jt(t.map((t=>e[n][t])))){R.beginPath(),R.moveTo(t[0][0],t[0][1]);for(let e=t.length;e--;)R.lineTo(t[e][0],t[e][1]);R.stroke()}}}})(),n.s&&(e.forEach(((t,e)=>{for(const[n,a]of t)R.fillStyle="#333",R.beginPath(),R.arc(n,a,5/r,0,2*Math.PI),R.fill(),R.fillStyle=ut[e],R.beginPath(),R.arc(n,a,3/r,0,2*Math.PI),R.fill()})),(c||[]).forEach((t=>{const[n,a]=e[0][t];R.fillStyle="#aaa",R.beginPath(),R.arc(n,a,3.2/r,0,2*Math.PI),R.fill()})),R.lineWidth=1/r,l.forEach(((t,n)=>t.forEach((t=>{t.l.forEach((a=>{h(_t,t.target.u,a=e[n][a]),v(_t,_t),m(_t,a,_t,20/r),R.beginPath(),R.moveTo(a[0],a[1]),R.lineTo(_t[0],_t[1]),R.stroke()}))}))))),n.i&&(R.lineWidth=.5/r,ft(1.6*S).forEach((({h:t})=>{R.strokeStyle="purple",R.beginPath(),R.strokeRect(t[0][0],t[0][1],t[1][0]-t[0][0],t[1][1]-t[0][1])}))),n.o&&(R.lineWidth=.8/r,ft(1.6*S).forEach((({l:t})=>{const n=[],r=[];t.forEach(((t,a)=>t.forEach((t=>{n.push(e[a][t]),r.push(a)})))),t=Xt(n);const a=n.map((()=>[]));t.forEach((t=>{for(let n=3;n--;){var e=(n+1)%3;const r=Math.min(t[n],t[e]);e=Math.max(t[n],t[e]),a[r]=a[r]||[],a[r].includes(e)||a[r].push(e)}})),a.forEach(((t,e)=>t.forEach((t=>{R.strokeStyle=r[e]!=r[t]?"purple":"blue",R.beginPath(),R.moveTo(n[e][0],n[e][1]),R.lineTo(n[t][0],n[t][1]),R.stroke()}))))}))),n.t){for(R.lineWidth=.7/r,R.fillStyle=R.strokeStyle="purple",R.font=`${Math.floor(8/r)}px sans-serif `,R.beginPath(),R.moveTo(10/r,17/r),R.lineTo(10/r,20/r),R.lineTo(10/r+1e3,20/r),R.lineTo(10/r+1e3,17/r),R.stroke(),R.beginPath(),R.fillText(Intl.NumberFormat().format(1e3),10/r,16/r),R.beginPath(),R.moveTo(10/r,47/r),R.lineTo(10/r,50/r),R.lineTo(10/r+1e4,50/r),R.lineTo(10/r+1e4,47/r),R.stroke(),R.beginPath(),R.fillText(Intl.NumberFormat().format(1e4),10/r,46/r),R.save(),R.translate(10/r,120/r),R.strokeStyle="black",R.beginPath(),R.moveTo(0,0),R.lineTo(1e4,0),R.stroke(),R.strokeStyle="red",R.beginPath(),R.moveTo(0,0),t=0;1e4>t;t+=50)R.lineTo(t,.4*-rn(t));R.stroke(),R.restore()}R.restore(),requestAnimationFrame(sn)};sn();let un,cn=()=>{clearTimeout(un);const t=Array.from({length:Math.floor(e[0].length)},((t,e)=>e));l[0].length=0,l[0].push({l:t,target:{u:new Uint16Array([(.6*Math.random()+.2)*i[0],(.6*Math.random()+.2)*i[1]])}}),un=setTimeout(cn,3e3)};cn(),document.getElementById("splash-dismiss").addEventListener("click",(()=>{clearTimeout(un),document.addEventListener("mousemove",Y),document.addEventListener("mousedown",X),document.addEventListener("mouseup",z),document.addEventListener("contextmenu",(t=>t.preventDefault()));let t=document.getElementById("splash");t.style.opacity="0",t.style.pointerEvents="none"})),document.getElementById("splash-up").addEventListener("click",(()=>{let t=document.getElementById("splash");t.style.opacity="1",t.style.pointerEvents="auto"}))</script>