<!doctype html><meta content="width=device-width,user-scalable=no,maximum-scale=1,user-scalable=0" name=viewport><meta content=#000 name=theme-color><style>body{margin:0;padding:0;background:#000}canvas{display:block;margin:0 auto;background:#9198a3;image-rendering:-moz-crisp-edges;image-rendering:-webkit-optimize-contrast;image-rendering:pixelated}</style><canvas></canvas><script src=js/kontra.js></script><script src=js/lvlData.js></script><script src=js/resize.js></script><script>var ctx=canvas.getContext("2d"),characterOffsetX=20,characterOffsetY=39,currentLevel=0,userTouching=!1;let apex=25,nadir=25,deathPoint=170;kontra.init();let timer=0,wobbleTimer=0,hasPressed=!1;function touching(t){userTouching=t}let playerImg=new Image;playerImg.src="img/tropeCharWalk.png";let cursorActive=!0,cursor=kontra.sprite({x:0,y:0,width:1,height:1,color:"red",move:function(t){if(cursorActive){let e=t.pageX,i=t.pageY,r=RESIZE.currentWidth/RESIZE.WIDTH;this.x=(e-RESIZE.canvas.offsetLeft)/r,this.y=(i-RESIZE.canvas.offsetTop)/r}}});playerImg.onload=function(){let t=kontra.spriteSheet({image:playerImg,frameWidth:40,frameHeight:40,animations:{walk:{frames:["2..4","0..2"],frameRate:30,loop:!1},fall:{frames:"4..9",frameRate:15,loop:!1},wobble:{frames:"10..12",frameRate:15,loop:!0}}}),e=kontra.sprite({x:canvas.width/15,y:canvas.height/2+40,animations:t.animations,move:function(){timer<=0?(timer=0,hasPressed=!1):this.x+=2},hitBox:kontra.sprite({x:canvas.width/15,y:canvas.height/2,height:30,width:15,updatePos:function(){this.x=e.x+15,this.y=e.y+5},color:"red"}),initialPosX:canvas.width/15,initialPosY:canvas.height/2+40}),i=!1,r=!1,o={posX:RESIZE.WIDTH/10*8,posY:RESIZE.HEIGHT/10*1.2,current:3,max:3,loss:function(){o.current-=1,o.current<=0&&(f(),o.current=o.max)},draw:function(){let t=0;for(var e=0;e<o.max;e++)e<o.current?(ctx.beginPath(),ctx.arc(o.posX+t,o.posY,15,0,2*Math.PI,!1),ctx.fillStyle="rgba(242, 255, 0, 1)",ctx.fill(),ctx.lineWidth=3,ctx.strokeStyle="rgba(0, 0, 0, 0.3)",ctx.stroke(),t+=35):(ctx.beginPath(),ctx.arc(o.posX+t,o.posY,15,0,2*Math.PI,!1),ctx.fillStyle="rgba(242, 255, 0, 0.3)",ctx.fill(),t+=35)}},n=0,a=0,c=function(){let t="Distance:"+a.toString()+"m";ctx.font="30px Helvetica",ctx.strokeStyle="black",ctx.lineWidth=4,r&&(ctx.strokeText("Congratulations!",130,100),ctx.fillStyle="white",ctx.fillText("Congratulations!",130,100),ctx.font="20px Helvetica",ctx.strokeStyle="black",ctx.lineWidth=4,ctx.strokeText("you beat classic mode",142,133),ctx.fillStyle="white",ctx.fillText("you beat classic mode",142,133)),i&&(ctx.strokeText("You made it: "+a.toString()+"m",120,90),ctx.fillStyle="white",ctx.fillText("You made it: "+a.toString()+"m",120,90)),i||r||(ctx.strokeText(t,20,50),ctx.fillStyle="white",ctx.fillText(t,20,50))},s=kontra.sprite({x:0,y:RESIZE.HEIGHT/2-50,width:RESIZE.WIDTH,height:100,color:"rgba(255,255,255,0.3)",buttonHome:kontra.sprite({x:0,y:5,width:RESIZE.WIDTH,height:50,color:"rgba(0,0,100,0.6)",drawTXT:function(){ctx.font="30px Helvetica",ctx.fillStyle="white",ctx.fillText("Back to Menu",canvas.width/2-90,35)}}),buttonRetry:kontra.sprite({x:0,y:RESIZE.HEIGHT/2-25,width:RESIZE.WIDTH,height:50,color:"rgba(255,255,255,0.7)",drawTXT:function(){ctx.font="40px Helvetica",ctx.fillStyle="black",ctx.fillText("Tap to retry",canvas.width/2-95,canvas.height/2+10)}})}),l=function(t,e){t+=characterOffsetX,e+=characterOffsetY,ctx.beginPath(),ctx.moveTo(-100,canvas.height/2),ctx.lineTo(t-100,(e+150)/2),ctx.lineTo(t-10,e),ctx.lineTo(t+10,e),ctx.lineTo(t+100,(e+150)/2),ctx.lineTo(canvas.width+100,canvas.height/2),ctx.lineWidth=3,ctx.lineJoin="bevel",ctx.stroke()},u=!0,x=.5,h=function(){e.y+40<=canvas.height/2-apex?u=!1:e.y+40>=canvas.height/2+nadir&&(u=!0),1==u?e.y-=x:0==u&&(e.y+=x)},d=!1,f=function(){d=!0,e.playAnimation("fall"),deathPoint=e.y,cursorActive=!0,H.stop(),R.start(),i=!0},p=!1,b=function(){e.playAnimation("wobble"),wobbleTimer=30,p=!0,o.loss()},y=function(t){canvas.style.background=t};var g=0;let v=function(t){g=t},m=function(t){if(E){let i=endLevels[t];y(i.bkColour),apex=i.apex,nadir=i.nadir,x=i.bounce,v(i.obstructions),obstructions[g].init(i.nOf),e.x=e.initialPosX,e.y=e.initialPosY,n=a,o.current=o.max}else if(t<levels.length){let i=levels[t];y(i.bkColour),apex=i.apex,nadir=i.nadir,x=i.bounce,v(i.obstructions),obstructions[g].init(i.nOf),e.x=e.initialPosX,e.y=e.initialPosY,n=a,o.current=o.max}else H.stop(),r=!0,cursorActive=!0,R.start()},T=kontra.sprite({x:0,y:RESIZE.HEIGHT/2-140,width:RESIZE.WIDTH,height:RESIZE.HEIGHT/5,color:"rgba(0,0,100,0.6)",pressed:function(){S.stop(),cursorActive=!1,cursor.x=0,cursor.y=0,m(0),H.start()}}),w={x:T.x+canvas.width/2-100,y:T.y+45,draw:function(){ctx.font="40px Helvetica",ctx.fillStyle="#c2d5e8",ctx.fillText("Classic Mode",this.x,this.y)}},E=!1,k=kontra.sprite({x:0,y:RESIZE.HEIGHT/2+70,width:RESIZE.WIDTH,height:RESIZE.HEIGHT/5,color:"rgba(0,100,0,0.6)",pressed:function(){S.stop(),cursorActive=!1,cursor.x=0,cursor.y=0,E=!0,m(0),genLevel(a),H.start()}}),I={x:k.x+canvas.width/2,y:k.y+45,draw:function(){ctx.font="40px Helvetica",ctx.fillStyle="#c2d5e8",ctx.fillText("Endless Mode",this.x,this.y)}},S=kontra.gameLoop({fps:30,update:function(t){T.update(),cursor.collidesWith(T)&&(T.pressed(),cursor.x=0,cursor.y=0),cursor.collidesWith(k)&&(k.pressed(),cursor.x=0,cursor.Y=0),h()},render:function(){e.render(),l(e.x,e.y),T.render(),w.draw(),k.render(),I.draw()}}),H=kontra.gameLoop({fps:30,update:function(t){1==hasPressed&&e.move(),timer>=0&&(timer-=1),wobbleTimer>0&&(wobbleTimer-=1),wobbleTimer<=0&&(wobbleTimer=0,p=!1),0==p&&(kontra.keys.pressed("space")&&0==hasPressed||userTouching&&0==hasPressed)&&(!function(){let t=e.y+40,i=canvas.height/2;(t==i-apex||t>=i-apex-4&&t<=i-apex+4)&&b(),(t==i+nadir||t>=i+nadir-4&&t<=i+nadir+4)&&b()}(),0==d&&0==p&&(e.playAnimation("walk"),hasPressed=!0,timer=5)),h(),obstructions[g].updateAll(),e.update(),a=Math.floor(n+(e.x-e.initialPosX)/10),e.hitBox.updatePos(),function(t){if(1==t)for(var i=0;i<obstructions[1].pillars.length;i++)e.hitBox.collidesWith(obstructions[1].pillars[i])&&f();if(2==t)for(i=0;i<obstructions[2].balls.length;i++)e.hitBox.collidesWith(obstructions[2].balls[i].hitBox)&&f();if(3==t)for(i=0;i<obstructions[3].blocks.length;i++)e.hitBox.collidesWith(obstructions[3].blocks[i])&&f()}(g),e.x>=450&&(E?(currentLevel=0,genLevel(a)):currentLevel+=1,m(currentLevel))},render:function(){obstructions[g].draw(),e.render(),l(e.x,e.y),i||o.draw(),c()}}),P=!1,R=kontra.gameLoop({fps:30,update:function(t){e.y>deathPoint-10&&(e.y-=1),e.y<=deathPoint-10&&(P=!0),P&&e.y<=canvas.height&&(e.y+=3),cursor.collidesWith(s.buttonRetry)&&!r&&(R.stop(),H.start(),E&&(endLevels[0]={bkColour:"green",apex:70,nadir:70,bounce:1,obstructions:0,nOf:0}),m(0),currentLevel=0,n=0,d=!1,hasPressed=!1,i=!1,r=!1,timer=0,e.playAnimation("walk"),cursor.x=0,cursor.y=0),cursor.collidesWith(s.buttonHome)&&(cursor.x=0,cursor.y=0,R.stop(),S.start(),i=!1,r=!1,E&&(endLevels[0]={bkColour:"green",apex:70,nadir:70,bounce:1,obstructions:0,nOf:0}),currentLevel=0,n=0,a=0,d=!1,hasPressed=!1,timer=0,e.playAnimation("walk"),y("#9198a3"),E=!1,apex=25,nadir=25,x=.5,e.x=e.initialPosX,e.y=e.initialPosY),e.update()},render:function(){obstructions[g].draw(),r||e.render(),l(150-characterOffsetX,150-characterOffsetY),c(),r||(s.render(),s.buttonRetry.render(),s.buttonRetry.drawTXT()),s.buttonHome.render(),s.buttonHome.drawTXT()}});S.start()},canvas.addEventListener("click",(function(t){cursor.move(t)})),canvas.addEventListener("touchstart",(function(t){touching(!0)})),canvas.addEventListener("touchend",(function(t){touching(!1)}))</script>