<!doctype html><meta name=viewport content="width=device-width"><style>body,html{margin:0;padding:0}body{display:flex;justify-content:center;align-items:center;flex-direction:column;background-color:#1b1b1b}</style><body><script>window.addEventListener("keydown",(function(e){[32,37,38,39,40].indexOf(e.keyCode)>-1&&e.preventDefault()}),!1)</script><canvas height=400 width=800 id=game></canvas><script>!function(t){var e={};function i(h){if(e[h])return e[h].exports;var s=e[h]={i:h,l:!1,exports:{}};return t[h].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,h){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:h})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var h=Object.create(null);if(i.r(h),Object.defineProperty(h,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)i.d(h,s,function(e){return t[e]}.bind(null,s));return h},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=13)}([function(t,e,i){t.exports=i.p+"4b4e40fa76221a6aabce8c81cb06ac98.png"},function(t,e,i){t.exports=i.p+"b433bf3666965c88523c7f26885e3d8f.png"},function(t,e,i){t.exports=i.p+"e89d90bc0df21a0a5e427fc8babac59d.png"},function(t,e,i){t.exports=i.p+"0bfc9a14e6515158be44c7d7f2171738.png"},function(t,e,i){t.exports=i.p+"9192a792dcac476a537ab956b5b705dd.png"},function(t,e,i){t.exports=i.p+"1b3f2d2f376bd7dc86ad52b4bf922135.png"},function(t,e,i){t.exports=i.p+"8b367019751afd97a0d30d54b74ed5b4.png"},function(t,e,i){t.exports=i.p+"7ea13559a0abdc198fed5093a3ea8424.png"},function(t,e,i){t.exports=i.p+"75aa0d06afe4a27262956d2ec7bd5297.png"},function(t,e,i){t.exports=i.p+"d469615b333fe45fb9d1b3be0dd3997f.png"},function(t,e,i){t.exports=i.p+"a74caf33b7a4e524f7e050d8fd1f7c58.png"},function(t,e,i){},,function(t,e,i){"use strict";i.r(e);let h,s,n={};function o(t,...e){n[t]&&n[t].map((t=>t(...e)))}function r(){return h}function a(){return s}function c(t){if(!(h=document.getElementById(t)||t||document.querySelector("canvas")))throw Error("You must provide a canvas element for the game");return(s=h.getContext("2d")).imageSmoothingEnabled=!1,o("init"),{canvas:h,context:s}}class l{constructor({spriteSheet:t,frames:e,frameRate:i,loop:h=!0}={}){this.spriteSheet=t,this.frames=e,this.frameRate=i,this.loop=h;let{width:s,height:n,margin:o=0}=t.frame;this.width=s,this.height=n,this.margin=o,this._f=0,this._a=0}clone(){return d(this)}reset(){this._f=0,this._a=0}update(t=1/60){if(this.loop||this._f!=this.frames.length-1)for(this._a+=t;this._a*this.frameRate>=1;)this._f=++this._f%this.frames.length,this._a-=1/this.frameRate}render({x:t,y:e,width:i=this.width,height:h=this.height,context:s=a()}={}){let n=this.frames[this._f]/this.spriteSheet._f|0,o=this.frames[this._f]%this.spriteSheet._f|0;s.drawImage(this.spriteSheet.image,o*this.width+(2*o+1)*this.margin,n*this.height+(2*n+1)*this.margin,this.width,this.height,t,e,i,h)}}function d(t){return new l(t)}d.prototype=l.prototype,d.class=l,new WeakMap;const f=()=>{};function u(){let t=r();a().clearRect(0,0,t.width,t.height)}function p({fps:t=60,clearCanvas:e=!0,update:i,render:h}={}){if(!i||!h)throw Error("You must provide update() and render() functions");let s,n,r,a,c,l=0,d=1e3/t,p=1/t,g=e?u:f;function m(){if(n=requestAnimationFrame(m),r=performance.now(),a=r-s,s=r,!(a>1e3)){for(o("tick"),l+=a;l>=d;)c.update(p),l-=d;g(),c.render()}}return c={update:i,render:h,isStopped:!0,start(){s=performance.now(),this.isStopped=!1,requestAnimationFrame(m)},stop(){this.isStopped=!0,cancelAnimationFrame(n)},_frame:m,set _last(t){s=t}}}let g={},m={},x={13:"enter",27:"esc",32:"space",37:"left",38:"up",39:"right",40:"down"};function w(t){let e=x[t.which];m[e]=!0,g[e]&&g[e](t)}function y(t){m[x[t.which]]=!1}function b(){m={}}function _(){let t;for(t=0;t<26;t++)x[65+t]=(10+t).toString(36);for(t=0;t<10;t++)x[48+t]=""+t;window.addEventListener("keydown",w),window.addEventListener("keyup",y),window.addEventListener("blur",b)}function v(t){return!!m[t]}let j=[],S=[],A={},M=[],k={},P={0:"left",1:"middle",2:"right"},T={x:0,y:0,radius:5};function E(t){let e=t.x,i=t.y;t.anchor&&(e-=t.width*t.anchor.x,i-=t.height*t.anchor.y);let h=T.x-Math.max(e,Math.min(T.x,e+t.width)),s=T.y-Math.max(i,Math.min(T.y,i+t.height));return h*h+s*s<T.radius*T.radius}function R(){let t,e,i=S.length?S:j;for(let h=i.length-1;h>=0;h--)if(e=(t=i[h]).collidesWithPointer?t.collidesWithPointer(T):E(t))return t}function I(t){let e=void 0!==t.button?P[t.button]:"left";k[e]=!0,L(t,"onDown")}function O(t){let e=void 0!==t.button?P[t.button]:"left";k[e]=!1,L(t,"onUp")}function W(t){L(t,"onOver")}function z(){k={}}function L(t,e){let i,h,s=r();if(!s)return;-1!==["touchstart","touchmove","touchend"].indexOf(t.type)?(i=(t.touches[0]||t.changedTouches[0]).clientX,h=(t.touches[0]||t.changedTouches[0]).clientY):(i=t.clientX,h=t.clientY);let n=s.height/s.offsetHeight,o=s.getBoundingClientRect(),a=(i-o.left)*n,c=(h-o.top)*n;T.x=a,T.y=c,t.preventDefault();let l=R();l&&l[e]&&l[e](t),A[e]&&A[e](t,l)}function C(){let t=r();t.addEventListener("mousedown",I),t.addEventListener("touchstart",I),t.addEventListener("mouseup",O),t.addEventListener("touchend",O),t.addEventListener("blur",z),t.addEventListener("mousemove",W),t.addEventListener("touchmove",W),function(t,e){n[t]=n[t]||[],n[t].push(e)}("tick",(()=>{S.length=0,j.map((t=>{S.push(t)})),j.length=0}))}function Y(t){[].concat(t).map((t=>{t._r||(t._r=t.render,t.render=function(){j.push(this),this._r()},M.push(t))}))}function D(t){return!!M.includes(t)&&R()===t}function H(t){A.onUp=t}function X(t){return!!k[t]}class B{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t())||!(i.update&&i.init&&i.isAlive))throw Error("Must provide create() function which returns an object with init(), update(), and isAlive() functions");this._c=t,this._i=0,this.objects=[t()],this.size=1,this.maxSize=e}get(t={}){if(this.objects.length==this._i){if(this.size===this.maxSize)return;for(let t=0;t<this.size&&this.objects.length<this.maxSize;t++)this.objects.unshift(this._c());this.size=this.objects.length}let e=this.objects.shift();return e.init(t),this.objects.push(e),this._i++,e}getAliveObjects(){return this.objects.slice(this.objects.length-this._i)}clear(){this._i=this.objects.length=0,this.size=1,this.objects.push(this._c())}update(t){let e,i=this.size-1,h=Math.max(this.objects.length-this._i,0);for(;i>=h;)(e=this.objects[i]).update(t),e.isAlive()?i--:(this.objects=this.objects.splice(i,1).concat(this.objects),this._i--,h++)}render(){let t=Math.max(this.objects.length-this._i,0);for(let e=this.size-1;e>=t;e--)this.objects[e].render()}}function q(t){return new B(t)}function F(t,e){let i=[],h=e.x+e.width/2,s=e.y+e.height/2,n=t.y<s&&t.y+t.height>=e.y,o=t.y+t.height>=s&&t.y<e.y+e.height;return t.x<h&&t.x+t.width>=e.x&&(n&&i.push(0),o&&i.push(2)),t.x+t.width>=h&&t.x<e.x+e.width&&(n&&i.push(1),o&&i.push(3)),i}q.prototype=B.prototype,q.class=B;class G{constructor({maxDepth:t=3,maxObjects:e=25,bounds:i}={}){this.maxDepth=t,this.maxObjects=e;let h=r();this.bounds=i||{x:0,y:0,width:h.width,height:h.height},this._b=!1,this._d=0,this._o=[],this._s=[],this._p=null}clear(){this._s.map((function(t){t.clear()})),this._b=!1,this._o.length=0}get(t){let e,i,h=new Set;for(;this._s.length&&this._b;){for(e=F(t,this.bounds),i=0;i<e.length;i++)this._s[e[i]].get(t).forEach((t=>h.add(t)));return Array.from(h)}return this._o.filter((e=>e!==t))}add(){let t,e,i,h;for(e=0;e<arguments.length;e++)if(i=arguments[e],Array.isArray(i))this.add.apply(this,i);else if(this._b)this._a(i);else if(this._o.push(i),this._o.length>this.maxObjects&&this._d<this.maxDepth){for(this._sp(),t=0;h=this._o[t];t++)this._a(h);this._o.length=0}}_a(t,e,i){for(e=F(t,this.bounds),i=0;i<e.length;i++)this._s[e[i]].add(t)}_sp(t,e,i){if(this._b=!0,!this._s.length)for(t=this.bounds.width/2|0,e=this.bounds.height/2|0,i=0;i<4;i++)this._s[i]=N({bounds:{x:this.bounds.x+(i%2==1?t:0),y:this.bounds.y+(i>=2?e:0),width:t,height:e},maxDepth:this.maxDepth,maxObjects:this.maxObjects}),this._s[i]._d=this._d+1,this._s[i]._p=this}}function N(t){return new G(t)}N.prototype=G.prototype,N.class=G;class U{constructor(t=0,e=0){this._x=t,this._y=e}add(t,e=1){return J(this.x+(t.x||0)*e,this.y+(t.y||0)*e,this)}clamp(t,e,i,h){this._c=!0,this._a=t,this._b=e,this._d=i,this._e=h}get x(){return this._x}get y(){return this._y}set x(t){this._x=this._c?Math.min(Math.max(this._a,t),this._d):t}set y(t){this._y=this._c?Math.min(Math.max(this._b,t),this._e):t}}function J(t,e,i={}){let h=new U(t,e);return i._c&&(h.clamp(i._a,i._b,i._d,i._e),h.x=t,h.y=e),h}J.prototype=U.prototype,J.class=U;class K{constructor(t){this.init(t)}init(t={}){let{x:e,y:i,dx:h,dy:s,ddx:n,ddy:o,width:r,height:c,image:l}=t;this.position=J(e,i),this.velocity=J(h,s),this.acceleration=J(n,o),this._fx=this._fy=1,this.width=this.height=this.rotation=0,this.ttl=1/0,this.anchor={x:0,y:0},this.context=a();for(let e in t)this[e]=t[e];l&&(this.width=void 0!==r?r:l.width,this.height=void 0!==c?c:l.height),this.sx=0,this.sy=0}get x(){return this.position.x}get y(){return this.position.y}get dx(){return this.velocity.x}get dy(){return this.velocity.y}get ddx(){return this.acceleration.x}get ddy(){return this.acceleration.y}get animations(){return this._a}get viewX(){return this.x-this.sx}get viewY(){return this.y-this.sy}get width(){return this._w}get height(){return this._h}set x(t){this.position.x=t}set y(t){this.position.y=t}set dx(t){this.velocity.x=t}set dy(t){this.velocity.y=t}set ddx(t){this.acceleration.x=t}set ddy(t){this.acceleration.y=t}set animations(t){let e,i;for(e in this._a={},t)this._a[e]=t[e].clone(),i=i||this._a[e];this.currentAnimation=i,this.width=this.width||i.width,this.height=this.height||i.height}set viewX(t){}set viewY(t){}set width(t){let e=t<0?-1:1;this._fx=e,this._w=t*e}set height(t){let e=t<0?-1:1;this._fy=e,this._h=t*e}isAlive(){return this.ttl>0}collidesWith(t){if(this.rotation||t.rotation)return null;let e=this.x-this.width*this.anchor.x,i=this.y-this.height*this.anchor.y,h=t.x,s=t.y;return t.anchor&&(h-=t.width*t.anchor.x,s-=t.height*t.anchor.y),e<h+t.width&&e+this.width>h&&i<s+t.height&&i+this.height>s}update(t){this.advance(t)}render(){this.draw()}playAnimation(t){this.currentAnimation=this.animations[t],this.currentAnimation.loop||this.currentAnimation.reset()}advance(t){this.velocity=this.velocity.add(this.acceleration,t),this.position=this.position.add(this.velocity,t),this.ttl--,this.currentAnimation&&this.currentAnimation.update(t)}draw(){let t=-this.width*this.anchor.x,e=-this.height*this.anchor.y;if(this.context.save(),this.context.translate(this.viewX,this.viewY),this.rotation&&this.context.rotate(this.rotation),-1==this._fx||-1==this._fy){let i=this.width/2+t,h=this.height/2+e;this.context.translate(i,h),this.context.scale(this._fx,this._fy),this.context.translate(-i,-h)}this.image?this.context.drawImage(this.image,0,0,this.image.width,this.image.height,t,e,this.width,this.height):this.currentAnimation?this.currentAnimation.render({x:t,y:e,width:this.width,height:this.height,context:this.context}):(this.context.fillStyle=this.color,this.context.fillRect(t,e,this.width,this.height)),this.context.restore()}}function Q(t){return new K(t)}function V(t){if(+t===t)return t;let e=[],i=t.split(".."),h=+i[0],s=+i[1],n=h;if(h<s)for(;n<=s;n++)e.push(n);else for(;n>=s;n--)e.push(n);return e}Q.prototype=K.prototype,Q.class=K;class Z{constructor({image:t,frameWidth:e,frameHeight:i,frameMargin:h,animations:s}={}){if(!t)throw Error("You must provide an Image for the SpriteSheet");this.animations={},this.image=t,this.frame={width:e,height:i,margin:h},this._f=t.width/e|0,this.createAnimations(s)}createAnimations(t){let e,i;for(i in t){let{frames:h,frameRate:s,loop:n}=t[i];if(e=[],void 0===h)throw Error("Animation "+i+" must provide a frames property");[].concat(h).map((t=>{e=e.concat(V(t))})),this.animations[i]=d({spriteSheet:this,frames:e,frameRate:s,loop:n})}}}function $(t){return new Z(t)}$.prototype=Z.prototype,$.class=Z;const tt=(t,e)=>{t&&!e.jumping&&e.grounded&&(e.jumping=!0,e.grounded=!1,e.dy>-20&&(e.slowed?e.dy-=3:e.dy-=5))},et=(t,e)=>{t.right?(e.facing="right",e.confused?e.dx=-e.speed:e.dx=e.speed,e.playAnimation("walk_right")):t.left?(e.confused?e.dx=e.speed:e.dx=-e.speed,e.facing="left",e.playAnimation("walk_left")):(e.dx=0,"left"===e.facing?e.playAnimation("idle_left"):e.playAnimation("idle_right"))},it=(t,e)=>{let i=t.x+t.width/2-(e.x+e.width/2),h=t.y+t.height/2-(e.y+e.height/2),s=t.width/2+e.width/2,n=t.height/2+e.height/2,o=null;if(Math.abs(i)<s&&Math.abs(h)<n){let e=s-Math.abs(i),r=n-Math.abs(h);e>=r?h>0?(o="t",t.y+=r):(o="b",t.y-=r):i>0?(o="l",t.x+=e):(o="r",t.x-=e)}return o};class ht extends Q{constructor(t,e,i,h,s,n,o,r){super(),this.x=t,this.y=e,this.width=h,this.height=i,this.color=s,this.effect=r,""!==n&&(this.image=n),this.active=!0,this.pickup=o,this.isMoveable=!0}}var st=i(0),nt=i.n(st),ot=i(1),rt=i.n(ot),at=i(2),ct=i.n(at),lt=i(3),dt=i.n(lt),ft=i(4),ut=i.n(ft),pt=i(5),gt=i.n(pt),mt=i(6),xt=i.n(mt),wt=i(7),yt=i.n(wt),bt=i(8),_t=i.n(bt),vt=i(9),jt=i.n(vt),St=i(10),At=i.n(St);const Mt=(t,e)=>{D(t)&&X("left")&&t.isMoveable&&e===t.placer&&(t.x=T.x-t.width/2,t.y=T.y-t.height/2)};let kt=!1,Pt=new Image;Pt.src=nt.a;let Tt=new Image;Tt.src=rt.a;let Et=new Image;Et.src=ct.a;let Rt=new Image;Rt.src=ut.a;let It=new Image;It.src=gt.a;let Ot=new Image;Ot.src=dt.a;const Wt=new Image;Wt.src=_t.a;let zt=new Image;zt.src=At.a;let Lt=new Image;Lt.src=jt.a;let Ct=new Image;Ct.src=xt.a;let Yt=new Image;Yt.src=yt.a,Tt.onload=function(){let{canvas:t,context:e}=c();_(),C();let i=[],h=(t=>{let e=[];const i=Q({y:0,x:0,color:"rgba(255,255,255, .3)",height:60,width:t.width}),h=Q({x:0,y:50,height:10,width:t.width,color:"black"}),s=Q({x:0,y:0,width:t.width,height:10,color:"black"}),n=Q({x:0,y:0,height:50,width:15,color:"black"}),o=Q({height:50,width:15,x:t.width-15,y:0,color:"black"}),r=Q({height:50,width:20,x:t.width/2,y:0,color:"black"}),a=Q({x:375,y:50,height:30,width:70,color:"green"});return e.push(i,h,s,n,o,r,a),e})(t),s=[],n=[],o=0,r=0,a=$({image:Pt,frameWidth:72,frameHeight:72,animations:{walk_right:{frames:[4,5,6,7],frameRate:10},walk_left:{frames:[3,2,1,0],frameRate:10},idle_right:{frames:[4],frameRate:1},idle_left:{frames:[3],frameRate:1}}}),l=$({image:Tt,frameWidth:72,frameHeight:72,animations:{walk_right:{frames:[4,5,6,7],frameRate:10},walk_left:{frames:[3,2,1,0],frameRate:10},idle_right:{frames:[4],frameRate:1},idle_left:{frames:[3],frameRate:1}}});const d=Q({x:0,y:0,width:t.width,height:t.height}),f=Q({x:0,y:t.height-10,width:t.width,height:10,color:"brown",slowPlayer:!1,hurtPlayer:!1}),u=Q({x:0,y:0,height:t.height,width:10,color:"brown",slowPlayer:!1,hurtPlayer:!1}),g=Q({x:t.width-10,y:0,height:t.height,width:10,color:"brown",slowPlayer:!1,hurtPlayer:!1}),m=Q({x:0,y:0,height:10,width:t.width,color:"brown",slowPlayer:!1,hurtPlayer:!1}),x=Q({x:u.width,y:t.height/2-8,height:200,width:52,color:"black",slowPlayer:!1,isClimbable:!0}),w=Q({x:g.x-52,y:t.height/2-8,height:216,width:52,color:"black",slowPlayer:!1,isClimbable:!0}),y=Q({x:x.x+x.width,y:t.height-20,width:w.x-(x.x+x.width),height:10,color:"Green",slowPlayer:!0,hurtPlayer:!0}),b=Q({x:y.width/2.5,y:250,height:16,width:y.width/3,color:"red",image:zt,slowPlayer:!1}),j=Q({x:x.width+u.width-20,y:x.y-40,animations:a.animations,width:20,height:20,facing:"right",dx:0,dy:0,jumping:!0,grounded:!1,climbing:!1,speed:2.5,speed_base:2.5,max_fall_speed:10,name:"Red",wins:!1,confused:!1,explode:!1,objects:[],ammo:0,shootTime:60,confuseTime:0}),S=Q({x:739,y:x.y-80,animations:l.animations,width:20,height:20,facing:"left",dx:0,dy:0,jumping:!0,grounded:!1,speed:2.5,speed_base:2.5,max_fall_speed:10,name:"billy",wins:!1,confused:!1,explode:!1,objects:[],ammo:0,shootTime:60,confuseTime:0});let A=j;const M=Q({x:530,y:20,height:30,width:70,color:"green"}),k=(new ht(60,30,25,21,"brown",Rt,!0,(function(t){this.active&&(this.active=!1,t.speed_base*=1.2)})),new ht(120,30,25,25,"red",Et,!0,(function(t){this.active&&(t.wins=!1,t.explode=!0,t.y-=5,t.ddy=0,t.dy=-4,t.ddx=0,t.dx=1.5*-t.dx,this.active=!1,function(t){t===j?O.active=!0:t===S&&(I.active=!0)}(t))}))),P=new ht(280,25,25,21,"pink",It,!0,(function(t){this.active&&(t.confuseTime=0,this.active=!1,t.speed_base=-t.speed_base)})),T=new ht(0,0,10,10,"gray","",!0,(function(t){this.active&&(t.ammo+=5,this.active=!1)})),E=new ht(100,100,8,40,"green",Wt,!1,(function(t){let e=it(t,this);null!==e&&t.explode&&(t.explode=!1),"l"===e||"r"===e?t.dx=0:"b"===e?(t.dy=0,t.ddy=0,t.jumping=!1,t.grounded=!0,t.climbing=!1,t.speed=t.speed_base,t.slowed=!1):"t"===e&&(t.dy=0,t.climbing=!1)})),R=new ht(100,100,40,8,"green",Lt,!1,(function(t){this.isClimbable=!0;let e=it(t,this);null!==e&&t.explode&&(t.explode=!1),"l"===e||"r"===e?t.dx=0:"b"===e?(t.dy=0,t.ddy=0,t.jumping=!1,t.grounded=!0,t.climbing=!1,t.speed=t.speed_base):"t"===e&&(t.dy=0,t.climbing=!1)})),I=new ht(32,175,13,13,"green",Ct,!1,(function(t){t!==this.placer&&this.active&&(t.wins=!0,this.active=!1)})),O=new ht(t.width-42,175,13,13,"red",Yt,!0,(function(t){t!==this.placer&&this.active&&(t.wins=!0,this.active=!1)}));I.placer=j,O.placer=S,I.active=!0,O.active=!0;const W=function(t){return new ht(t.x,t.y,t.height,t.width,t.color,t.image,t.pickup,t.effect)}(T);W.x=370,W.y=220,i.push(h[1],f,y,u,g,m,x,w,b),n.push(W),s.push(k,P,E,R);for(let t=0;t<4;t++){let e=L();e.placer=j,e.y=25,j.objects[t]=e;let i=L();i.placer=S,i.y=25,S.objects[t]=i}for(let t=0;t<j.objects.length;t++)j.objects[t].x=j.objects[t].x+50*t;for(let e=0;e<S.objects.length;e++)S.objects[e].x=t.width/2+100+50*e;function z(t){t.dy<t.max_fall_speed&&!t.climbing&&t.dy<10&&(t.dy+=.1)}function L(){let t=Math.floor(Math.random()*s.length),e=s[t];return new ht(e.x,e.y,e.height,e.width,e.color,e.image,e.pickup,e.effect)}function B(t,e){if(e===I||e===O){let i=e;t.collidesWith(i)&&i.effect(t)}else for(let i=0;i<e.length;i++){let h=e[i];t.collidesWith(h)&&h.effect(t),h.active||h===I||h===O||(j.objects=j.objects.filter((function(t){return t!=h})),S.objects=S.objects.filter((function(t){return t!=h})))}}function q(t){t.isBullet||(t.x<=80?t.x=t.x+x.width/12:t.x+t.width>=740&&(t.x=740-w.width-t.width/2))}function F(t,e){if(t&&e.ammo>0){e.ammo--,e.shootTime=0;let t=new ht(e.x+e.width/1.5,e.y+e.height/2,10,10,"red",Ot,!0,(function(e){e!==t.placer&&t.collidesWith(e)&&(e.wins=!1,e===j?O.active=!0:e===S&&(I.active=!0),t.color="transparent",e.dy=-1.5,e.explode=!0,e.dx=.3*t.dx)}));t.placer=e,"right"===e.facing?t.dx=10:t.dx=-10,t.isBullet=!0,e.objects.push(t),s.push(t)}}function G(e){B(e,j.objects),B(e,S.objects),B(e,n),B(e,I),B(e,O),j.wins&&j.x<34&&!S.wins&&(alert("Player 1 wins!!!"),location.reload()),S.wins&&S.x>745&&!j.wins&&(alert("Player 2 wins!!!"),location.reload());for(let h=0;h<i.length;h++){let s=i[h];i[h].update();let n=it(e,i[h]);"l"===n||"r"===n?(e.dx=0,s.isClimbable&&(e.dy=-10)):"b"===n?(e.dy=0,e.ddy=0,e.jumping=!1,e.grounded=!0,e.climbing=!1,i[h]===y?(e.speed=e.speed_base/2,e.slowed=!0):(e.speed=e.speed_base,e.slowed=!1)):"t"===n&&(e.dy=0,e.climbing=!1),(e.x>t.width||e.y>t.height||e.x<0||e.y<0)&&(e.x=30,e.y=170,e.dx=0,e.ddy=0),null!==n&&e.explode&&(e.explode=!1)}}e.fillStyle="teal",e.font="10px Courier New",p({update:function(){z(j),z(S),G(j),G(S),j.update(),S.update(),I.update(),O.update(),W.active||++o>600&&(W.active=!0,o=0,n.push(W));for(let t=0;t<j.objects.length;t++)j.objects[t].update(),Y(j.objects[t]),kt||Mt(j.objects[t],A),q(j.objects[t]);for(let t=0;t<S.objects.length;t++)S.objects[t].update(),Y(S.objects[t]),kt||Mt(S.objects[t],A),q(S.objects[t]);kt||Y(h[6]),Y(M),kt||D(h[6])&&X("left")&&H((()=>{kt=!0,h=h.filter((function(t){return t!=h[6]}))})),r++,v("t")&&r/60>10&&(A===j?A=S:A===S&&(A=j),r=0),kt&&(tt(v("w"),j),tt(v("up"),S),et({left:v("a"),right:v("d")},j),et({left:v("left"),right:v("right")},S),j.shootTime>60&&F(v("e"),j),S.shootTime>60&&F(v("space"),S)),j.shootTime++,S.shootTime++,j.collidesWith(S)&&(j.x=j.x+1),S.collidesWith(j)&&(S.x=S.x-1)},render:function(){d.render(),j.render(),S.render(),I.active&&I.render(),O.active&&O.render();for(let t=0;t<i.length;t++)i[t].render();for(let t=0;t<j.objects.length;t++){let e=j.objects[t];e.active&&e.render()}for(let t=0;t<S.objects.length;t++){let e=S.objects[t];e.active&&e.render()}for(let t=0;t<n.length;t++){let e=n[t];e.active&&e.render()}for(let t=0;t<h.length;t++)h[t].render();if(b.render(),e.fillStyle="white",e.font="10px Courier New",kt)e.fillText("STEAL THEM GEMS!!",M.x+M.width/2-12,M.y+M.height/2+2.5);else{e.fillText(A.name+" Turn",M.x+M.width/2-12,M.y+M.height/2+2.5);let t=h[6];e.fillText("START",t.x+t.width/2-12,t.y+t.height/2+2.5)}}}).start()},i(11)}])</script>