<!doctype html><title>Hang by a Thread</title><script type=module> function t(t){return t&&t.__esModule?t.default:t}let e=()=>{}; function i(t,e){let i=t.indexOf(e);if(-1!=i)return t.splice(i,1),!0}let s,n,o={}; function r(t,e){o[t]=o[t]||[],o[t].push(e)} function a(t,...e){(o[t]||[]).map((t=>t(...e)))}let h={get:(t,i)=>"_proxy"==i||e}; function l(){return n} function c(t,{contextless:e=!1}={}){if(s=document.getElementById(t)||t||document.querySelector("canvas"),e&&(s=s|| new Proxy({},h)),!s)throw Error("You must provide a canvas element for the game");return n=s.getContext("2d")|| new Proxy({},h),n.imageSmoothingEnabled=!1,a("init"),{canvas:s,context:n}} new WeakMap; function d(t,e){let i=Math.sin(e),s=Math.cos(e);return {x:t.x*s-t.y*i,y:t.x*i+t.y*s}} function p(t,e,i){return Math.min(Math.max(t,i),e)}class g{constructor(t=0,e=0){ this.x=t, this.y=e}add(t){return  new g( this.x+t.x, this.y+t.y, this)}subtract(t){return  new g( this.x-t.x, this.y-t.y, this)} length(){return Math.hypot( this.x, this.y)}get x(){return  this._x}get y(){return  this._y}set x(t){ this._x= this._c?p( this._a, this._d,t):t}set y(t){ this._y= this._c?p( this._b, this._e,t):t}} function u(){return  new g(...arguments)}class y extends class{constructor(t){return  this.init(t)}init(t={}){ this.position=u(), this.velocity=u(), this.acceleration=u(), this.ttl=1/0,Object.assign( this,t)}update(t){ this.advance(t)}advance(t){let e= this.acceleration;t&&(e=e.scale(t)), this.velocity= this.velocity.add(e);let i= this.velocity;t&&(i=i.scale(t)), this.position= this.position.add(i), this._pc(), this.ttl--}get dx(){return  this.velocity.x}get dy(){return  this.velocity.y}set dx(t){ this.velocity.x=t}set dy(t){ this.velocity.y=t}get ddx(){return  this.acceleration.x}get ddy(){return  this.acceleration.y}set ddx(t){ this.acceleration.x=t}set ddy(t){ this.acceleration.y=t}isAlive(){return  this.ttl>0}_pc(){}}{init({ width:t=0, height:e=0,context:i=l(),render:s= this.draw,update:n= this.advance,children:o=[],anchor:r={x:0,y:0},opacity:a=1,rotation:h=0, scaleX:c=1,scaleY:d=1,...p}={}){ this._c=[],super.init({ width:t, height:e,context:i,anchor:r,opacity:a,rotation:h, scaleX:c,scaleY:d,...p}), this._di=!0, this._uw(), this.addChild(o), this._rf=s, this._uf=n}update(t){ this._uf(t), this.children.map((e=>e.update&&e.update(t)))}render(){let t= this.context;t.save(),( this.x|| this.y)&&t.translate( this.x, this.y), this.rotation&&t.rotate( this.rotation),1== this. scaleX&&1== this.scaleY||t.scale( this. scaleX, this.scaleY);let e=- this. width* this.anchor.x,i=- this. height* this.anchor.y;(e||i)&&t.translate(e,i), this.context.globalAlpha= this.opacity, this._rf(),(e||i)&&t.translate(-e,-i), this.children.map((t=>t.render&&t.render())),t.restore()}draw(){}_pc(){ this._uw(), this.children.map((t=>t._pc()))}get x(){return  this.position.x}get y(){return  this.position.y}set x(t){ this.position.x=t, this._pc()}set y(t){ this.position.y=t, this._pc()}get width(){return  this._w}set width(t){ this._w=t, this._pc()}get height(){return  this._h}set height(t){ this._h=t, this._pc()}_uw(){if(! this._di)return ;let {_wx:t=0,_wy:e=0,_wo:i=1,_wr:s=0,_wsx:n=1,_wsy:o=1}= this.parent||{}; this._wx= this.x, this._wy= this.y, this._ww= this. width, this._wh= this. height, this._wo=i* this.opacity, this._wsx=n* this. scaleX, this._wsy=o* this.scaleY, this._wx= this._wx*n, this._wy= this._wy*o, this._ww= this. width* this._wsx, this._wh= this. height* this._wsy, this._wr=s+ this.rotation;let {x:r,y:a}=d({x: this._wx,y: this._wy},s); this._wx=r, this._wy=a, this._wx+=t, this._wy+=e}get world(){return {x: this._wx,y: this._wy, width: this._ww, height: this._wh,opacity: this._wo,rotation: this._wr, scaleX: this._wsx,scaleY: this._wsy}}set children(t){ this.removeChild( this._c), this.addChild(t)}get children(){return  this._c}addChild(...t){t.flat().map((t=>{ this.children.push(t),t.parent= this,t._pc=t._pc||e,t._pc()}))}removeChild(...t){t.flat().map((t=>{i( this.children,t)&&(t.parent=null,t._pc())}))}get opacity(){return  this._opa}set opacity(t){ this._opa=t, this._pc()}get rotation(){return  this._rot}set rotation(t){ this._rot=t, this._pc()}setScale(t,e=t){ this. scaleX=t, this.scaleY=e}get scaleX(){return  this._scx}set scaleX(t){ this._scx=t, this._pc()}get scaleY(){return  this._scy}set scaleY(t){ this._scy=t, this._pc()}}class x extends y{init({image:t, width:e=(t?t. width:void 0), height:i=(t?t. height:void 0),...s}={}){super.init({image:t, width:e, height:i,...s})}draw(){ this.image&& this.context.drawImage( this.image,0,0, this.image. width, this.image. height), this.currentAnimation&& this.currentAnimation.render({x:0,y:0, width: this. width, height: this. height,context: this.context}), this.color&&( this.context.fillStyle= this.color, this.context.fillRect(0,0, this. width, this. height))}} function w(){return  new x(...arguments)} new WeakMap; function m(t){let e=t.canvas;t.clearRect(0,0,e. width,e. height)} function A({fps:t=60,clearCanvas:i=!0,update:s=e,render:n,context:o=l(),blur:r=!1}={}){if(!n)throw Error("You must provide a render() function");let h,c,d,p,g,u=0,y=1e3/t,x=1/t,w=i?m:e,A=!0; function f(){if(c=requestAnimationFrame(f),A&&(d=performance.now(),p=d-h,h=d,!(p>1e3))){for(a("tick"),u+=p;u>=y;)g.update(x),u-=y;w(o),g.render()}}return r||( window.addEventListener("focus",(()=>{A=!0})), window.addEventListener("blur",(()=>{A=!1}))),g={update:s,render:n,isStopped:!0,start(){h=performance.now(), this.isStopped=!1,requestAnimationFrame(f)},stop(){ this.isStopped=!0,cancelAnimationFrame(c)},_frame:f,set _last(t){h=t}},g}let f={},v={},b={},_={Enter:"enter",Escape:"esc",Space:"space",ArrowLeft:"arrowleft",ArrowUp:"arrowup",ArrowRight:"arrowright",ArrowDown:"arrowdown"}; function k(t=e,i){t._pd&&i.preventDefault(),t(i)} function S(t){let e=_[t.code],i=f[e];b[e]=!0,k(i,t)} function C(t){let e=_[t.code],i=v[e];b[e]=!1,k(i,t)} function E(){b={}} function B(){let t;for(t=0;t<26;t++)_["Key"+String.fromCharCode(t+65)]=String.fromCharCode(t+97);for(t=0;t<10;t++)_["Digit"+t]=_["Numpad"+t]=""+t; window.addEventListener("keydown",S), window.addEventListener("keyup",C), window.addEventListener("blur",E)} function I(t,e,{handler:i="keydown",preventDefault:s=!0}={}){let n="keydown"==i?f:v;e._pd=s,[].concat(t).map((t=>n[t]=e))} function L(t){return !!b[t]} function M(t,e){return Object.values(e).includes(t)} function R(t={}){let e;return B(),{pointer:e}} function N(t,e,{gamepad:i,key:s}={}){[].concat(t).map((t=>{if(M(t,_))I(t,e,s);else if(!["down","up"].includes(t))throw new TypeError(`"${t}" is not a valid input name`)}))}class D{constructor({create:t,maxSize:e=1024}={}){let i;if(!t||!(i=t())||!(i.update&&i.init&&i.isAlive&&i.render))throw Error(""); this._c=t, this.objects=[t()], this.size=0, this.maxSize=e}get(t={}){if( this.size== this.objects. length){if( this.size== this.maxSize)return ;for(let t=0;t< this.size&& this.objects. length< this.maxSize;t++) this.objects.push( this._c())}let e= this.objects[ this.size];return  this.size++,e.init(t),e}update(t){let e,i=!1;for(let s= this.size;s--;)e= this.objects[s],e.update(t),e.isAlive()||(i=!0, this.size--);i&& this.objects.sort(((t,e)=>e.isAlive()-t.isAlive()))}render(){for(let t= this.size;t--;) this.objects[t].render()}} function F(){return  new D(...arguments)}const Y=({behavior:t,direction:e,distance:i,orgX:s,orgY:n,x:o,y:r})=>{let a="",h=1,l=e;switch(t){case"ns":a="y";break;case"ew":a="x"}switch(e){case"n":h=-1;break;case"s":h=1;break;case"e":h=1,s+i<o&&(l="w");break;case"w":h=-1,s-i>o&&(l="e")}return {axis:a,multiplier:h,newDirection:l}},P=(t,e)=>{let i="";return i=e<0?"ew"==t?"w":"n":"ew"==t?"e":"s",i};class X{x;y;level; width=32; height=32;speed=1;constructor(t,e,{level:i,behavior:s,distance:n}){ this.direction=P(s,n), this.distance=Math.abs(n), this.behavior=s, this.orgX=t, this.orgY=e, this.x=t, this.y=e, this.level=i}getSmallCollisionBox(){return {x: this.x+10,y: this.y+10, width:12, height:12}}update(){const {axis:t,newDirection:e,multiplier:i}=Y({behavior: this.behavior,distance: this.distance,direction: this.direction,x: this.x,y: this.y,orgX: this.orgX,orgY: this.orgY}); this.direction=e, this[t]+= this.speed*i}render(t){t&&(t.lineWidth=4,t.beginPath(),t.rect( this.x, this.y, this. width, this. height),t.rect( this.x+10, this.y+10,12,12),t.stroke())}}const T=t=>{const e='\nCut the rope with "S".',i=document.getElementById("hint");switch(i.textContent="",t){case 1:i.textContent="Reach the goal below.\nUse the arrow keys to move."+e;break;case 2:i.textContent='Use "Up Arrow" to shorten the rope';break;case 3:i.textContent='Use "Space" to boost up.'+e}};let z=0,U=0;const O={};let V={},j=[],Q=[],G=[],H=!1;const W={},J=({id:t,data:e,img:i})=>{O[t]={data:e,img:i}},K=(t,e,i)=>{Q=t,j=e,G=i,a("n",{nftTokensBySeries:j,nftTokensForOwner:Q,nftCollections:G})},q=(t,e)=>!(!t||!e)&&(t.x<e.x+e. width&&t.x+t. width>e.x&&t.y<e.y+e. height&&t. height+t.y>e.y),Z=(t,e)=>!!e.find((e=>e.token_id.split(":")[0]==t)),$=({x:t,y:e,scale:i,imgSrc:s})=> new Promise((n=>{const o= new Image;o.src=s,o.onload=()=>{const s=w({x:t,y:e,anchor:{x:.5,y:.5}, width:8, height:8,image:o, scaleX:i,scaleY:i});n(s)}})); window.zzfxR=44100, window.zzfxX= new ( window.AudioContext||webkitAudioContext);const tt= new ( window.AudioContext||webkitAudioContext),et=(...t)=>it(tt,zzfxG(...t)),it=(t,...e)=>{let i=t.createBufferSource(),s=t.createBuffer(e. length,e[0]. length,44100);return e.map(((t,e)=>s.getChannelData(e).set(t))),i.buffer=s,i.connect(t.destination),i.start(),i}; window.zzfxG=(t=1,e=.05,i=220,s=0,n=0,o=.1,r=0,a=1,h=0,l=0,c=0,d=0,p=0,g=0,u=0,y=0,x=0,w=1,m=0,A=0)=>{let f,v,b=2*Math.PI,_=h*=500*b/44100**2,k=(0<u?1:-1)*b/4,S=i*=(1+2*e*Math.random()-e)*b/44100,C=[],E=0,B=0,I=0,L=1,M=0,R=0,N=0;for(l*=500*b/44100**3,u*=b/44100,c*=b/44100,d*=44100,p=44100*p|0,v=(s=99+44100*s)+(m*=44100)+(n*=44100)+(o*=44100)+(x*=44100)|0;I<v;C[I++]=N)++R%(100*y|0)||(N=r?1<r?2<r?3<r?Math.sin((E%b)**3):Math.max(Math.min(Math.tan(E),1),-1):1-(2*E/b%2+2)%2:1-4*Math.abs(Math.round(E/b)-E/b):Math.sin(E),N=(p?1-A+A*Math.sin(2*Math.PI*I/p):1)*(0<N?1:-1)*Math.abs(N)**a*t*.3*(I<s?I/s:I<s+m?1-(I-s)/m*(1-w):I<s+m+n?w:I<v-x?(v-I-x)/o*w:0),N=x?N/2+(x>I?0:(I<v-x?1:(v-I)/x)*C[I-x|0]/2):N),f=(i+=h+=l)*Math.sin(B*u-k),E+=f-f*g*(1-1e9*(Math.sin(I)+1)%2),B+=f-f*g*(1-1e9*(Math.sin(I)**2+1)%2),L&&++L>d&&(i+=c,S+=c,L=0),!p||++M%p||(i=S,h=_,L=L||1);return C};const st=(t,e,i,s=125)=>{let n,o,r,a,h,l,c,d,p,g,u,y,x,w,m,A=0,f=[],v=[],b=[],_=0,k=0,S=1,C={},E= window.zzfxR/s*60>>2;for(;S;_++)f=[S=d=u=x=0],i.map(((s,u)=>{for(c=e[s][_]||[0,0,0],S|=!!e[s][_],m=x+(e[s][0]. length-2-!d)*E,w=u==i. length-1,o=2,a=x;o<c. length+w;d=++o){for(h=c[o],p=o==c. length+w-1&&w||g!=(c[0]||0)|h|0,r=0;r<E&&d;r++>E-99&&p&&(y+=(y<1)/99))l=(1-y)*f[A++]/2||0,v[a]=(v[a]||0)-l*k+l,b[a]=(b[a++]||0)+l*k+l;h&&(y=h%1,k=c[1]||0,(h|=0)&&(f=C[[g=c[A=0]||0,h]]=C[[g,h]]||(n=[...t[g]],n[2]*=2**((h-12)/12),h>0? window.zzfxG(...n):[])))}x=m}));return [v,b]};let nt=null,ot=!1,rt= window.zzfxX;const at=()=>ot,ht=()=>{if(ot=!0,nt)return void rt.resume();let t=st(...[[[.5,0,245,.07,.1,.65,,1.5,,,,,,,,,,,.05,1],[.3,0,245,,,3,2,.3,,-.001,,,,,,,.02,,,.04],[.1,0,245,,,2,1,0],[,0,,,,,4,,,,,,,,100,2]],[[[,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,],[1,,22.1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],[2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,,18,,,,22,,,,25,,,,29,,,,25,,,,22,,,,18,,,,22,,,,25,,,,29,,,,25,,,,22,,,,],[1,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],[2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,],[1,,25,,,,,,,,,,,,,,,,,,,,,,24,,25,,,,,,,,,,,,29,,,,,,,,,,,,28,,,,,,,,,,,,,,,,,,,,,,,,],[2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,,18,,,,22,,,,25,,,,29,,,,25,,,,22,,,,18,,,,22,,,,25,,,,29,,,,25,,,,22,,,,],[1,,18,,,,,,,,,,,,,,,,,,,,,,17,,18,,,,,,,,,,,,23,,,,,,,,,,,,],[2,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,]],[[,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,10,,,,17,,,,24,,,,25,,,,24,,,,17,,,,],[1,,22,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,],[2,,10.53,,,,,,,,,,,,,,,,,,,,12.4,,,,13.7,,,,,,,,,,,,20,,,,,,,,,,,,18,,,,,,,,,,,,,,,,,,,,17,,,,]],[[,,18,,,,22,,,,25,,,,29,,,,25,,,,22,,,,18,,,,22,,,,25,,,,29,,,,25,,,,22,,,,],[1,,18,,,,,,,,,,,,,,,,,,,,,,17,,18,,,,,,,,,,,,23.1,,,,,,,,,,,,],[2,,6,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,-1]]],[0,1,2,3,4,5],,{title:"",instruments:["","","",""],patterns:["A1","A2","B1","B2","B3","B4"]}]);nt=it(zzfxX,...t),nt.loop=!0},lt=()=>{ot=!1,rt.suspend()};class ct{level;scale=1; width=60; height=32;originalRadius={x:15,y:30};radiusX=15;radiusY=30;hasWon=!1;hasVanished=!1;vanishSpeed=.3;isVanishihng=!1;constructor(t,e,{level:i}){ this.x=t, this.y=e, this.level=i}update(){ this.hasVanished|| this.checkCollision()}render(t){t&&! this.hasVanished&&(t.lineWidth=4,t.beginPath(), this.hasWon&& this.startVanishing(),t.ellipse( this.x+ this. width/2, this.y+ this. height/2, this.radiusX, this.radiusY,Math.PI/2,0,2*Math.PI),t.stroke())}startVanishing(){ this.isVanishihng||et(...[,,269,.07,.21,.3,1,.94,8.3,-.2,284,.12,.12,,,,.13,.75,.17]), this.isVanishihng=!0, this.radiusX-= this.vanishSpeed, this.radiusY-=2* this.vanishSpeed, this.radiusX<=0&&( this.radiusX=0), this.radiusY<=0&&( this.radiusY=0), this.radiusX<=0&& this.radiusY<=0&&( this.hasVanished=!0,a("l"))}checkCollision(){q({x: this.x,y: this.y, width: this. width, height: this. height}, this.level.player.sprite)&&( this.hasWon=!0,a("g"))}}class dt{scale=4; width=8; height=8;x;y;sprite;idleSpeed=.1;direction="n";orgX;orgY;constructor(e,i,{level:s}){ this.orgX=e, this.orgY=i, this.level=s, this.x=e, this.y=i,$({x: this.x,y: this.y,scale: this.scale,imgSrc:t("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIAgMAAAC5YVYYAAAAAXNSR0IArs4c6QAAAAlQTFRFAAAA6e%2Fs4g%2Bgfy227QAAAAF0Uk5TAEDm2GYAAAAgSURBVHjaY2BgYBAJYMhcwpC1hEFqAgObAwMjAwMDAwAvpANxcyRR5QAAAABJRU5ErkJggg%3D%3D")}).then((t=> this.sprite=t))}update(){ this.sprite&&( this.updateIdlePos(), this.sprite.update(), this.checkCollision())}updateIdlePos(){"n"== this.direction&&( this.sprite.y-= this.idleSpeed, this.sprite.scaleY+= this.idleSpeed/10, this.sprite. scaleX+= this.idleSpeed/10, this.sprite.y<= this.orgY-2&&( this.direction="s")),"s"== this.direction&&( this.sprite.y+= this.idleSpeed, this.sprite.scaleY-= this.idleSpeed/10, this.sprite. scaleX-= this.idleSpeed/10, this.sprite.y>= this.orgY+2&&( this.direction="n"))}render(t){ this.sprite&& this.sprite.render()}checkCollision(){q({x: this.x- this. width* this.scale/2,y: this.y- this. height* this.scale/2, width: this. width* this.scale, height: this. height* this.scale}, this.level.player.sprite)&&( this.sprite=null,et(...[,,607,.01,.03,.13,1,1.56,,,-490,.04,.02,,,,,.47,.02,.03]),a("h",{heart: this}))}}const pt={level1:{p:{x:400,y:255},r:30,s:[],b:[{x:272,y:220},{x:303,y:220},{x:333,y:220},{x:363,y:220},{x:393,y:220},{x:423,y:220},{x:453,y:220},{x:483,y:220},{x:453,y:300},{x:303,y:300}],g:[{x:368,y:700}],h:[{x:550,y:290},{x:200,y:290}]},level2:{p:{x:400,y:255},r:30,s:[],b:[{x:400,y:220},{x:272,y:380},{x:302,y:380},{x:332,y:380},{x:362,y:380},{x:432,y:380},{x:462,y:380},{x:492,y:380}],g:[{x:368,y:250}],h:[{x:550,y:290},{x:400,y:190}]},level3:{p:{x:272,y:255},r:30,s:[{x:464,y:350,b:"ew",d:100}],b:[{x:260,y:220}],g:[{x:400,y:600},{x:600,y:50}],h:[{x:260,y:50},{x:580,y:100}]},level4:{p:{x:250,y:155,b:"ew",d:100},r:50,s:[{x:464,y:350,b:"ew",d:100},{x:164,y:150,b:"ew",d:100},{x:400,y:380},{x:600,y:480}],b:[{x:250,y:155,b:"ew",d:100}],g:[{x:700,y:700}],h:[{x:260,y:50},{x:580,y:100}]},level5:{p:{x:272,y:255,b:"ew",d:100},r:30,s:[{x:100,y:450,b:"ew",d:100},{x:400,y:200,b:"ew",d:-200}],b:[{x:260,y:220,b:"ew",d:100},{x:600,y:520,b:"ew",d:80}],g:[{x:600,y:700}],h:[{x:200,y:400},{x:600,y:50}]},level6:{p:{x:416,y:155,b:"ew",d:100},r:30,s:[{x:400,y:80,b:"ew",d:200},{x:250,y:230},{x:550,y:200}],b:[{x:400,y:120,b:"ew",d:100},{x:300,y:250,b:"ew",d:80},{x:500,y:220,b:"ew",d:-80}],g:[{x:600,y:700},{x:100,y:700}],h:[{x:600,y:100},{x:200,y:50}]},level7:{p:{x:416,y:155},r:30,s:[{x:483,y:260},{x:356,y:260}],b:[{x:400,y:120},{x:460,y:290},{x:460,y:322},{x:460,y:354},{x:340,y:290},{x:340,y:322},{x:340,y:354}],g:[{x:500,y:650}],h:[{x:483,y:226},{x:356,y:226}]},level8:{p:{x:272,y:255},r:30,s:[{x:300,y:400,b:"ew",d:100},{x:464,y:350,b:"ew",d:-200},{x:100,y:450,b:"ew",d:100}],b:[{x:260,y:220},{x:460,y:290},{x:460,y:322},{x:460,y:354}],g:[{x:600,y:700}],h:[{x:200,y:400},{x:478,y:270}]}};async function gt(t){const e="https://api.arcadians.io/"+t;return  new Promise(((i,s)=>{var n= new XMLHttpRequest;n.onload=()=>{if(n.readyState==n.DONE){200!==n.status&&s(null);let r="female";var e=JSON.parse(n.response);const a=e.attributes.find((t=>"Head"==t.trait_type));e.attributes.find((t=>"Class"==t.trait_type)).value.match("Male")&&(r="male");const h=a.value.toLowerCase().replaceAll(" ","-");var o= new Image;o.src=`https://nftstorage.link/ipfs/bafybeib2ir3zpgd3cmizcv7shekjeftcwq7apjib6i5gz2sjc4vajwtgiy/${r}/head/${h}.png`,o.addEventListener("load",(()=>{localStorage.setItem("Arcadian #"+t,o),J({id:t,data:e,img:o}),i({id:t,data:e,img:o})}),!1)}},n.open("GET",e),n.send()}))}class ut{walletConnection;contract;accountId;userName;ready;nearConfig={networkId:"testnet",nodeUrl:"https://rpc.testnet.near.org",contractName:"paras-token-v2.testnet",walletUrl:"https://wallet.testnet.near.org",helperUrl:"https://helper.testnet.near.org",explorerUrl:"https://explorer.testnet.near.org"};resolveContract;constructor(){ this.listenForGameEvents(), this.ready= new Promise((t=>{ this.resolveContract=t}))}isSignedIn(){return  this&& this.walletConnection&& this.walletConnection.isSignedIn()}async initContract(){const t= new  window.nearApi.keyStores.BrowserLocalStorageKeyStore,e=await window.nearApi.connect({... this.nearConfig,keyStore:t});return  this.walletConnection= new  window.nearApi.WalletConnection(e,null), this.accountId= this.walletConnection.getAccountId(), this.contract=await new  window.nearApi.Contract( this.walletConnection.account(), this.nearConfig.contractName,{viewMethods:["nft_tokens_for_owner","nft_tokens_by_series"],changeMethods:["nft_buy"]}), this.resolveContract(), this.walletConnection}logout(){ this.walletConnection.signOut()}login(){ this.walletConnection.requestSignIn( this.nearConfig.contractName)}nft_tokens_for_owner(t){return  this.contract.nft_tokens_for_owner({account_id:t})}nft_tokens_by_series(t){return  this.contract.nft_tokens_by_series({token_series_id:t})}nft_buy({token_series_id:t,priceInYoctoNear:e}){return  this.contract.nft_buy({owner_id: this.accountId,receiver_id: this.accountId,token_series_id:t},"300000000000000",e)}getNftCollections(){return fetch("https://api-v3-marketplace-testnet.paras.id/token-series?collection_id=hang-by-a-thread-by-johnonymtestnet").then((t=>t.json())).then((t=>t.data.results.filter((t=>t.metadata.copies>0&&!t.is_non_mintable))))}listenForGameEvents(){r("b",(({token_series_id:t,priceInYoctoNear:e})=> this.nft_buy({token_series_id:t,priceInYoctoNear:e})))}}const yt=["main","bonus","levels","level-d","n-l","thanks"],xt=Object.keys(pt). length;let wt=!1;const mt=()=>{document.getElementById("lv").focus()},At=({nftTokensBySeries:t,nftTokensForOwner:e,nftCollections:i})=>{const s=document.getElementById("lnl");s&&s.remove();const n=document.getElementById("nlg");i.forEach((t=>{var i,s;i=t.token_series_id,s=t.metadata.description,W[i]=s;const o=document.createElement("button"),r=document.createElement("img"),a=Z(t.token_series_id,e);r.setAttribute("src","https://ipfs.fleek.co/ipfs/"+t.metadata.media),o.setAttribute("near","true"),a||o.classList.add("disabled"),o.setAttribute("token-series-id",t.token_series_id),o.setAttribute("price","1000000000000000000000000"),o.textContent=t.metadata.title,o.appendChild(r);const h=document.createElement("span");h.textContent=a?"Click to play level":"Buy level for: "+(t.price/Math.pow(10,24)).toFixed(2)+" \u24c3",o.appendChild(h),o.classList.add("level-item"),n.appendChild(o)}))},ft=()=>{const t=document.getElementById("bonus-g");vt(t),bt(t)},vt=e=>{const i= new Image;i.src=t("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAAXNSR0IArs4c6QAAABJQTFRF9u3NAAAA6e%2FsoKCLVVVoIR4gJR%2FcEQAAAAJ0Uk5TAAB2k804AAAAK0lEQVR42mMQDA1lZBBVUgpkCFJSUmUIClUNZQgKVjWFcEWdVAIYBENDBQGBlgaUUfu3rwAAAABJRU5ErkJggg%3D%3D"), new Promise((t=>{const e=[];e.push(gt(92)),e.push(gt(101)),e.push(gt(110));for(let t=1;t<46;t++){if(2==t||13==t)continue;const i=gt(t);e.push(i)}Promise.allSettled(e).then((e=>{a("i",{img:e[0].value}),t(e)}))})).then((t=>{for(let s=0;s<t. length;s++){const n=t[s].value.img,o=document.createElement("canvas");o.setAttribute("height",4*n. height),o.setAttribute("width",4*n. width),o.classList.add("bonus-item"),o.setAttribute("arcadian",t[s].value.id),s>5&&!H&&o.classList.add("disabled");const r=o.getContext("2d");r.imageSmoothingEnabled=!1,r.scale(8,8),r.drawImage(i,n. width/4-4,n. height/4-12),r.scale(.5,.5),r.drawImage(n,0,0),e.appendChild(o)}}))},bt=t=>{t.addEventListener("click",(t=>{var e;t.target.classList.contains("bonus-item")&&(t.target.classList.contains("disabled")||(e=t.target.getAttribute("arcadian"),V=O[e],a("i",{img:V.img}),Ct("main")))}))},_t=()=>{document.getElementById("wrap").addEventListener("click",kt)},kt=e=>{const i=e.target.id,s=e.target.classList;switch(i){case"lv":(()=>{const e=document.getElementById("levels-g");e.innerHTML="";for(let i=1;i<xt+1;i++){const s=localStorage.getItem("hearts-"+i)||0,n=document.createElement("button");n.textContent=i;const o=document.createElement("div");o.classList.add("heart-wrap");for(let e=0;e<2;e++){const i=document.createElement("img");i.setAttribute("src",t("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIAgMAAAC5YVYYAAAAAXNSR0IArs4c6QAAAAlQTFRFAAAA6e%2Fs4g%2Bgfy227QAAAAF0Uk5TAEDm2GYAAAAgSURBVHjaY2BgYBAJYMhcwpC1hEFqAgObAwMjAwMDAwAvpANxcyRR5QAAAABJRU5ErkJggg%3D%3D")),s>e&&i.classList.add("collected"),o.appendChild(i)}n.appendChild(o),n.classList.add("level-item"),e.appendChild(n)}})(),Ct("levels"),document.getElementsByClassName("level-item")[0].focus();break;case"bo":Ct("bonus");break;case"hamburger":Ct("main");break;case"near":Ct("n-l");break;case"nextBtn":Ct(),a("x");break;case"replayBtn":Ct(),a("r");break;case"mu":a("t",{isMusicOn:!at()})}if(s.contains("bone")||s.contains("inverse"))return void Ct("main");const n=e.target.closest("button");n&&n.getAttribute("near")?St(n):n&&n.classList.contains("level-item")&&(Ct(),a("s",{levelId:+n.textContent}))},St=t=>{if(t&&t.classList.contains("disabled")){Rt();a("b",{token_series_id:t.getAttribute("token-series-id"),priceInYoctoNear:t.getAttribute("price")})}else Ct(),a("s",{levelData:JSON.parse((e=t.getAttribute("token-series-id"),W[e]))});var e},Ct=t=>{T(null),yt.forEach((e=>{const i=document.getElementById(e);i.classList.contains("hide")||i.classList.add("hide"),e==t&&i.classList.remove("hide")}))},Et=()=>{r("l",It),r("n",Lt),r("p",Mt),r("t",Bt)},Bt=()=>{document.getElementById("mu").textContent=at()?"Music is ON":"Music is OFF"},It=()=>{Ct("level-d"),document.getElementById("nextBtn").focus()},Lt=({nftTokensBySeries:t,nftTokensForOwner:e,nftCollections:i})=>{At({nftTokensBySeries:t,nftTokensForOwner:e,nftCollections:i})},Mt=()=>{if(wt)return ;const t=document.getElementById("coil-subscriber"),e=document.getElementById("coilBtn");e&&e.remove(),t&&t.classList.remove("hide");const i=document.getElementsByClassName("bonus-item");for(let t of i)t.classList.remove("disabled");i&&i. length&&(wt=!0)},Rt=()=>{document.getElementById("loader-wrapper").classList.remove("hide")};class Nt{player;constructor(t){ this.player=t, this.initControls()}updateControls(){ this.player.hasWon|| this.player.isRopeCut|| this.player.rope. length<=0||(L("arrowleft")&&( this.player.applyForce(-1.5,-1), this.player.changePlayerDirection(!0)),L("arrowright")&&( this.player.applyForce(1.5,-1), this.player.changePlayerDirection(!1)),L("arrowup")&& this.player.climbRope(),L("space")&& this.player.applyForce(0,-5))}initControls(){N(["s"],(()=> this.player.rope.cutRope(Math.floor( this.player.rope. length/2)))),N(["z"],(()=>a("r")))}}class Dt{n1;n2;restingDistance=7;constructor(t,e){ this.n1=t, this.n2=e}}class Ft{pos;oldPos; width=2; height=2;mass=.03;constructor({x:t,y:e}){ this.pos=u(t,e), this.oldPos=u(t,e)}get x(){return  this.pos.x}get y(){return  this.pos.y}applyForce(t,e){ this.pos.x+=t, this.pos.y+=e}}class Yt{nodes=[];links=[];anchor;iterations=20;constructor({x:t,y:e,numNodes:i,level:s}){ this.level=s, this.anchor=u(t,e);for(let s=0;s<i;s++) this.nodes.push( new Ft({x:t,y:7*s+e}));for(let t=0;t< this.nodes. length-1;t++){const e= this.nodes[t],i= this.nodes[t+1]; this.links.push( new Dt(e,i))}}update(){ this.updateNodes();for(let t=0;t< this.iterations;t++) this.updateLinks(), this.constrainNodes()}render(t){t&& this.renderRope(t)}updateNodes(){ this.nodes.forEach((t=>{t== this.nodes[0]&&(t.pos= this.anchor);const e=t.pos.subtract(t.oldPos);t.oldPos=t.pos,t.pos=t.pos.add(e).add(u(0,9*t.mass))}))}constrainNodes(){ this.nodes.forEach((t=>{t== this.nodes[0]&&(t.pos= this.anchor), this.handleWallCollision(t), this.handleBoxCollision(t)}))}updateLinks(){ this.links.forEach((t=>{const e=t.n2.pos.subtract(t.n1.pos),i=e. length(),s=(t.restingDistance-i)/i/2,n=u(e.x*s,e.y*s);t.n1.pos=t.n1.pos.subtract(n),t.n2.pos=t.n2.pos.add(n)}))}renderRope(t){t.lineWidth=4,t.strokeStyle="#e9efec",t.beginPath(), this.links.forEach((e=>{t.moveTo(e.n1.x,e.n1.y),t.lineTo(e.n2.x,e.n2.y)})),t.stroke()}handleWallCollision(t){t.x>z&&(t.pos.x=z),t.x<0&&(t.pos.x=0),t.y>U&&(t.pos.y=U),t.y<0&&(t.pos.y=0)}handleBoxCollision(t,e){if(t== this.nodes[0])return ; this.level.bricks.forEach((e=>{if(q(e,t)){const i=Math.abs(t.pos.x-e.x),s=Math.abs(t.pos.x-(e.x+e. width)),n=Math.abs(t.pos.y-e.y),o=Math.abs(t.pos.y-(e.y+e. height)),r=Math.max(i,s,n,o);r==s?t.pos.x=e.x-3:r==i?t.pos.x=e.x+e. width+3:r==o?t.pos.y=e.y-3:r==n&&(t.pos.y=e.y+e. height+3)}}))}climbRope(){if(! this.nodes|| this.nodes. length<=2)return void this.cutRope(0);const t= this.links[ this.links. length-1];t.restingDistance-=2.1,t.restingDistance<=0&&( this.links.pop(), this.nodes.pop())}cutRope(t){t>= this.nodes. length-1&&(t= this.nodes. length-2), this.links.splice(t,1),et(...[,,1081,.01,.01,.02,4,1.1,14,32,,,,.8,,,.06,.66]),a("c",{rope: this})}get length(){return  this.nodes. length}get endNode(){return  this.nodes[ this.nodes. length-1]}get anchorNode(){return  this.nodes. length? this.nodes[0]:{}}}class Pt{timeBetweenBubbles=10;timeSinceLastBubble=10;timeSinceLastBoostBubble=10;constructor(){ this.pool=F({create:w,maxSize:20})}render(){ this.pool.render()}update(){ this.timeSinceLastBubble+=1, this.timeSinceLastBoostBubble+=5, this.pool.update()}addBubbles({x:t,y:e,isBoost:i}){!i&& this.timeSinceLastBubble<= this.timeBetweenBubbles||i&& this.timeSinceLastBoostBubble<= this.timeBetweenBubbles||(et(...[,1,7,.02,.01,.02,4,.5,,,1,.01,,,150,,.21,,.01]), this.timeSinceLastBubble=0, this.timeSinceLastBoostBubble=0, this.pool.get({x:t/2,y:e/2, width:20, height:40,color:"#e9efec",ttl:50,render: function (){let t=8;i&&(t=4);const e= this.context;e.lineWidth=2,e.globalAlpha= this.ttl/60,e.strokeStyle= this.color,e.beginPath(),e.arc( this.x, this.y,t,0,2*Math.PI),e.stroke()},update: function (t){ this.ttl-=1, this.x+=Math.random()>.5?1:-1, this.y-=1,i&& this.ttl>30? this.y+=2:i&&( this.y+=1.5)}}))}}class Xt{game;rope=[];playerControls;scale=4;sprite={render:()=>{},x:0,y:0};headSprite={render:()=>{},x:0,y:0};hasWon=!1;hasSetListeners=!1;headImg;headOffset={x:10,y:38};isLeft=!1;isRopeCut=!1;anchorNodeSpeed=1;anchorNodeDirection;anchorNodeOrgPos;particleEffect;deadTimer=0;deadInAirTimer=0;deadLimit=50;deadInAirLimit=250;playerState="a";constructor({game:e,levelData:i}){i.p=i.p||{}, this.levelData=i, this.anchorNodeDirection=P(i.p.b,i.p.d), this.distance=Math.abs(i.p.d), this.behavior=i.p.b, this.game=e;const s=i.r,n=i.p.x,o=i.p.y; this.anchorNodeOrgPos=u(n,o), this.headImg=V.img||{ width:0, height:0}, this.createRope({startX:n,startY:o,ropeLength:s,levelData:i}),$({x:n,y:o,scale: this.scale,imgSrc:t("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAAXNSR0IArs4c6QAAABJQTFRF9u3NAAAA6e%2FsoKCLVVVoIR4gJR%2FcEQAAAAJ0Uk5TAAB2k804AAAAK0lEQVR42mMQDA1lZBBVUgpkCFJSUmUIClUNZQgKVjWFcEWdVAIYBENDBQGBlgaUUfu3rwAAAABJRU5ErkJggg%3D%3D")}).then((t=> this.sprite=t)), this.createHeadSprite( this.headImg), this.playerControls= new Nt( this), this.listenForGameEvents(), this.particleEffect= new Pt}updateRope(){ this.hasWon|| this.rope.update()}renderRope(t){ this.hasWon|| this.rope.render(t)}createHeadSprite(t){if(!t. width||!t. height)return ;const e= this.scale/2;let i=e; this.isLeft&&(i*=-1), this.headSprite=w({x: this.rope.endNode.x-t. width,y: this.rope.endNode.y-t. height,anchor:{x:.5,y:.5}, width:8, height:8,image:t, scaleX:i,scaleY:e})}createRope({startX:t,startY:e,ropeLength:i}){ this.rope= new Yt({x:t,y:e,numNodes:i,level: this.game.level}), this.isRopeCut=!1}renderPlayer(t){ this.sprite.render(), this.headSprite.render()}applyForce(t,e){const i=e<-4; this.particleEffect.addBubbles({x: this.sprite.x,y: this.sprite.y,isBoost:i}), this.rope.endNode.applyForce(t,e)}changePlayerDirection(t){ this.isLeft=t,t?( this.sprite. scaleX=- this.scale, this.headSprite. scaleX=- this.scale/2):( this.sprite. scaleX= this.scale, this.headSprite. scaleX= this.scale/2), this.headSprite.x= this.sprite.x-( this.headImg. width- this.headOffset.x)*Math.sign( this.sprite. scaleX)}render(t){ this.renderRope(t), this.renderPlayer(t), this.particleEffect.render(t)}renderCollisionBox(t){t.lineWidth=4,t.strokeStyle="#e9efec",t.beginPath(),t.rect( this.sprite.x, this.sprite.y, this.sprite. width* this.scale, this.sprite. height* this.scale),t.stroke()}update(){ this.sprite.x= this.rope.endNode.pos.x, this.sprite.y= this.rope.endNode.pos.y, this.headSprite.x= this.rope.endNode.pos.x-( this.headImg. width- this.headOffset.x)*Math.sign( this.sprite. scaleX), this.headSprite.y= this.rope.endNode.pos.y- this.headImg. height+ + this.headOffset.y, this.particleEffect.update(), this.updateRope(), this.updateAnchorNode(), this.handlePlayerState(), this.playerControls.updateControls()}handlePlayerState(){ this.handleDeadOnGround(), this.handleDeadInAir()}handleDeadOnGround(){"d"!= this.playerState&& this.sprite.y>=U&&( this.deadTimer+=1, this.deadTimer>= this.deadLimit&& this.handleDied())}handleDeadInAir(){ this.hasWon|| this.isRopeCut&&"d"!= this.playerState&&( this.deadInAirTimer+=1, this.deadInAirTimer>= this.deadInAirLimit&& this.handleDied())}handleDied(){ this.deadTimer=0, this.deadInAirTimer=0, this.playerState="d",a("d",{})}updateAnchorNode(){const t= this.rope.anchorNode,{axis:e,newDirection:i,multiplier:s}=Y({behavior: this.behavior,distance: this.distance,direction: this.anchorNodeDirection,x:t.pos.x,y:t.pos.y,orgX: this.anchorNodeOrgPos.x,orgY: this.anchorNodeOrgPos.y}); this.anchorNodeDirection=i,t.pos[e]+= this.anchorNodeSpeed*s}climbRope(){ this.rope.climbRope()}reArrangeRope(){ this.rope.splice( this.rope. length-2,1);const t= this.rope[ this.rope. length-2];t&&(t.removeLink(),t.attachTo( this.pointMass))}respawnPlayer(){const t= this.levelData.r,e= this.levelData.p.x,i= this.levelData.p.y; this.anchorNodeDirection=P( this.levelData.p.b, this.levelData.p.d), this.createRope({startX:e,startY:i,ropeLength:t,levelData: this.levelData}), this.playerState="a"}resetHearts(){}listenForGameEvents(){ this.hasSetListeners||(r("g", this.onGoalCollision),r("i", this.onArcadianAdded),r("c", this.onCutRope), this.hasSetListeners=!0)}onGoalCollision=()=>{ this.hasWon=!0};onArcadianAdded=({img:t})=>{ this.headImg=t, this.createHeadSprite(t)};onCutRope=({rope:t})=>{ this.isRopeCut=!0};get currPos(){return  this.rope.endNode.pos}get oldPos(){return  this.rope.endNode.oldPos}set currPos(t){ this.rope.endNode.currPos=t}set oldPos(t){ this.rope.endNode.oldPos=t}}class Tt{x;y;orgX;orgY;sprite={render:()=>{}};distance=100;speed=1;scale=4;rotSpeed=.2; width=8; height=8;level;constructor(e,i,{behavior:s,distance:n,level:o}){ this.direction=P(s,n), this.distance=Math.abs(n), this.behavior=s, this.x=e, this.y=i, this.orgX=e, this.orgY=i, this.level=o,$({x: this.x,y: this.y, width: this. width, height: this. height,scale: this.scale,imgSrc:t("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAgAAAAIBAMAAAA2IaO4AAAAAXNSR0IArs4c6QAAAA9QTFRFAAAA6e%2FsoKCLVVVoIR4gQ1uK0QAAAAF0Uk5TAEDm2GYAAAArSURBVHjaBcCBCQAQEADAIwMoCygT8AZQv%2F9OosB6iJjazW3cfGoE2oHuAz4SAw96QFa2AAAAAElFTkSuQmCC")}).then((t=> this.sprite=t))}update(){const {axis:t,newDirection:e,multiplier:i}=Y({behavior: this.behavior,distance: this.distance,direction: this.direction,x: this.x,y: this.y,orgX: this.orgX,orgY: this.orgY}); this.direction=e, this[t]+= this.speed*i, this.sprite.x= this.x, this.sprite.y= this.y, this.sprite.rotation+= this.rotSpeed*i}render(t){ this.sprite.render()}}class zt{player;saws=[];goals=[];hearts=[];bricks=[];isLevelLoaded=!1;isFirstRopeCut=!1;isStopMotion=!1;levelId;levelData;capturedHearts=[];stopMotionTime=10;stopMotionEllapsed=0;constructor({game:t,levelId:e,levelData:i}){ this.levelId=e, this.levelData=i, this.game=t,i?setTimeout((()=>{ this.init(i)})): this.loadLevel("level"+e).then((t=>{ this.init(t)})).catch((()=>{Ct("thanks")})), this.listenForGameEvents()}init(t){ this.levelData=t, this.createPlayer(t), this.createSaws(t), this.createGoals(t), this.createHearts(t), this.createBricks(t), this.isLevelLoaded=!0,T( this.levelId)}loadLevel(t){return  new Promise(((e,i)=>{if(pt[t]&&pt[t].p){e(pt[t])}else i(null)}))}render(t){ this.isLevelLoaded&&( this.saws.forEach((e=>{e.render(t)})), this.hearts.forEach((e=>{e.render(t)})), this.bricks.forEach((e=>{e.render(t)})), this.player.render(t), this.goals.forEach((e=>{e.render(t)})))}update(){if( this.isLevelLoaded){if( this.isStopMotion)return  this.stopMotionEllapsed+=1,void( this.stopMotionEllapsed>= this.stopMotionTime&&( this.isStopMotion=!1)); this.checkCollisions(), this.player.update(), this.saws.forEach((t=>{t.update()})), this.goals.forEach((t=>{t.update()})), this.hearts.forEach((t=>{t.update()})), this.bricks.forEach((t=>{t.update()}))}}createGoals(t){t.g.forEach((t=>{ this.goals.push( new ct(t.x,t.y,{level: this}))}))}createPlayer(t){ this.player= new Xt({levelData:t,game: this.game})}createSaws(t){t.s&&t.s.forEach((t=>{ this.saws.push( new Tt(t.x,t.y,{level: this,behavior:t.b,distance:t.d}))}))}createHearts(t){t.h&&t.h.forEach((t=>{ this.hearts.push( new dt(t.x,t.y,{level: this}))}))}createBricks(t){t.b&&t.b.forEach((t=>{ this.bricks.push( new X(t.x,t.y,{behavior:t.b,distance:t.d,level: this}))}))}storeCapturedHearts(){localStorage.setItem("hearts-"+ this.levelId, this.capturedHearts. length)}listenForGameEvents(){r("d", this.onPlayerDied),r("h", this.onHeartPickup),r("l", this.onLevelComplete),r("c", this.onCutRope)}onCutRope=({rope:t})=>{ this.isFirstRopeCut||( this.isStopMotion=!0, this.isFirstRopeCut=!0, this.flashScreen())};onLevelComplete=()=>{ this.storeCapturedHearts()};onHeartPickup=({heart:t})=>{ this.capturedHearts.push(t)};flashScreen(){const t=document.getElementById("c");t.classList.add("flash"),setTimeout((()=>{requestAnimationFrame((()=>{t.classList.remove("flash")}))}),50)}onPlayerDied=({})=>{et(...[,,326,,.06,.08,1,.95,-6.8,,,,,,,,,.45,.08]), this.isFirstRopeCut=!1, this.stopMotionEllapsed=0, this.player.respawnPlayer(), this.resetHearts(), this.resertSaws(), this.resetBricks()};resetBricks(){ this.bricks. length=0, this.createBricks( this.levelData)}resetHearts(){ this.capturedHearts. length=0, this.hearts. length=0, this.createHearts( this.levelData)}resertSaws(){ this.saws. length=0, this.createSaws( this.levelData)}checkCollisions(){const t= this.player.rope;for(let e=0;e<t. length-2;e++) this.saws.forEach((i=>{q(t.nodes[e],{ width:i. width*i.scale, height:i. height*i.scale,...i})&& this.player.rope.cutRope(e)}))}destroy(){console.log("destroy level")}}class Ut{canvas;context;player;saw;level;constructor(){const t= this;let {canvas:e,context:i}=c();var s,n; this.canvas=e, this.context=i,R(),s=e. height,U=s,n=e. width,z=n,A({update: function (){t.level&&t.level.update()},render: function (){t.level&&(i.save(),t.level.render(t.context))}}).start(), this.listenForGameEvents()}loadLevel({levelId:t,levelData:e}){t? this.level= new zt({levelId:t,game: this}):e&&( this.level= new zt({game: this,levelData:e}))}listenForGameEvents(){r("x", this.onStartNextLevel),r("s", this.onStartLevel),r("r", this.onReStartLevel),r("t", this.onToggleMusic)}onToggleMusic=({isMusicOn:t=!1})=>{t?ht():lt()};onStartNextLevel=()=>{ this.level.destroy(), this.level.levelId? this.loadLevel({levelId: this.level.levelId+1}):Ct("n-l")};onStartLevel=({levelId:t,levelData:e})=>{ this.level&& this.level.destroy(), this.loadLevel({levelId:t,levelData:e})};onReStartLevel=()=>{ this.loadLevel({levelId: this.level.levelId,levelData: this.level.levelData})}}const Ot=t=>{const e=document.getElementById("lo");if(t&&t.isSignedIn()){e.innerHTML="Logout from NEAR";const t=document.getElementById("near");t.classList.remove("disabled"),t.removeAttribute("disabled")}else e.innerHTML="Login to NEAR";e.addEventListener("click",(()=>((t,e)=>{e&&(e.walletConnection.isSignedIn()?(e.logout(),t.innerHTML="Login to NEAR"):(e.login(),t.innerHTML="Logout from NEAR"))})(e,t)))},Vt=t=>{H=!0,a("p",t)},jt=()=>{Qt().then((()=>{const t= new ut;t.initContract().then((()=>{if(Ot(t),!t.isSignedIn())return ;const e=[t.nft_tokens_for_owner(t.accountId),t.nft_tokens_by_series("2036"),t.getNftCollections()];Promise.all(e).then((([t,e,i])=>{K(t,e,i)}))}))}))},Qt=()=> new Promise((t=>{ window.nearApi&&t();const e=document.createElement("script");e.onload=()=>{t()},e.src="https://cdn.jsdelivr.net/npm/near-api-js@0.45.1/dist/near-api-js.min.js",document.head.appendChild(e)}));(()=>{let e=document.createElement("style");e.textContent=t(':root{--bgc:#211e20;--bgc2:#555568;--fgc:#a0a08b;--fgc2:#e9efec;--acc:#e20fa0}body{width:100vw;height:100vh;background-color:var(--bgc);color:var(--fgc2);margin:0;padding:0;font-family:sans-serif}#wrap{position:relative}body,#wrap{flex-flow:column;justify-content:center;align-items:center;display:flex}canvas{background-color:var(--bgc)}#c{border:3px solid var(--fgc2)}.menu{color:var(--fgc2);flex-direction:row-reverse;align-content:center;align-items:center;padding:10px 20px;font-size:23px;font-weight:600;display:flex;position:absolute}#r-menu{top:0;right:0}#mu{margin-top:50px}.flat{background-color:inherit;color:var(--fgc2);border:3px solid var(--fgc2)}#hamburger{height:9px;cursor:pointer;flex-direction:column;align-items:center;line-height:.4;display:flex}#hint{white-space:pre-wrap;text-align:center;position:absolute;bottom:250px}#hamburger,#hamburger:after,#hamburger:before{content:"\u2013\u2013"}#hamburger:hover{filter:drop-shadow(0 0 12px var(--acc))}button,.btn{width:240px;height:50px;background-color:var(--fgc2);color:var(--bgc);cursor:pointer;border:none;border-radius:4px;margin-top:20px;font-size:16px;font-weight:600}button.disabled{color:#a9a9a9;cursor:not-allowed;background-color:#d3d3d3}button.disabled img{filter:contrast(.5)}button:hover,.btn:hover{background-color:var(--bgc2);color:var(--fgc2)}button:hover img{filter:none}#coil-subscriber{height:50px}#coilBtn{width:400px;height:50px;justify-content:center;align-items:center;text-decoration:none;display:flex}.overlay{width:100%;height:100%;background-color:var(--bgc);text-align:center;flex-direction:column;place-content:center;align-items:center;display:flex;position:absolute}#thanks{width:80%;height:80%}.level-item{cursor:pointer;width:120px;height:120px;background-color:var(--fgc);border-radius:4px;flex-flow:column;justify-content:center;align-items:center;display:flex}.level-item img{width:100%;height:auto}.level-item img:not(.collected){filter:grayscale()}.heart-wrap{height:50%;width:70%;flex-flow:row;display:flex}.heart-wrap img{object-fit:contain;image-rendering:pixelated}#levels-g,#bonus-g,#nlg{width:640px;height:440px;min-height:440px;scroll-behavior:smooth;grid-template-columns:repeat(4,150px);justify-content:center;justify-items:center;row-gap:60px;display:grid;overflow-x:hidden;overflow-y:auto}#nlg{grid-template-columns:repeat(2,1fr)}#nlg .level-item{width:250px;height:300px;cursor:pointer;flex-flow:column}#bonus-g{row-gap:0}#level-d{width:50%;height:50%;background-color:#121212ee;border:1px solid #fff;border-radius:4px}.bonus-item{cursor:pointer;background:0 0;border-radius:4px;margin-bottom:-60px}.bonus-item:hover:not(.disabled){transform:scale(1.1)}.bonus-item.disabled{filter:contrast(.5);cursor:not-allowed;background-color:#000}#bonus-g>canvas{width:200px;height:200px}#loader-wrapper{z-index:99;background-color:#211e2055}#loader{border:16px solid var(--fgc2);border-top:16px solid var(--acc);width:120px;height:120px;border-radius:50%;animation:spin 2s linear infinite}@keyframes spin{0%{transform:rotate(0deg)}to{transform:rotate(360deg)}}.bone{cursor:pointer;cursor:pointer;font-size:32px;position:absolute;top:100px;right:100px}.bone:hover{filter:drop-shadow(0 0 12px var(--acc))brightness(1.3)}.inverse{position:absolute;top:-1px;left:-2px;transform:rotate(90deg)}.hide{display:none!important}.flash{background-color:var(--bgc2)}');document.getElementsByTagName("head")[0].appendChild(e)})(), new Ut,jt(),_t(),Et(),ft(),mt(),document&&document.monetization?document.monetization.addEventListener("monetizationprogress",(t=>Vt(t))): window.addEventListener("monetizationprogress",(t=>Vt(t)));</script><meta name=monetization content=$ilp.uphold.com/Wb3kd4Jf3642><div id=wrap><div id=loader-wrapper class="hide overlay"><div id=loader></div></div><canvas id=c width=800px height=800px></canvas><div id=r-menu class=menu><div id=hamburger>––</div></div><div id=main class=overlay><button id=lv>Select Level</button> <button id=lo>Loading..</button> <button id=near class=disabled disabled>NEAR Levels</button> <button id=bo>Bonus Content</button> <button id=mu class=flat>Music is OFF</button></div><div id=bonus class="hide overlay"><div id=coil-subscriber class=hide>Thanks for subscribing to Coil</div><a id=coilBtn href=https://coil.com/ class=btn>Subscribe to Coil for more hats</a><div class=bone>🦴<div class=inverse>🦴</div></div><div id=bonus-g></div></div><div id=levels class="hide overlay"><div class=bone>🦴<div class=inverse>🦴</div></div><div id=levels-g></div></div><div id=n-l class="hide overlay"><div class=bone>🦴<div class=inverse>🦴</div></div><div id=lnl>Loading NEAR levels..</div><div id=nlg></div></div><div id=level-d class="hide overlay"><button id=nextBtn>Play next level</button> <button id=replayBtn>Replay level</button></div><div id=thanks class="hide overlay">Rest in peace my soul<br>More levels for NEAR users</div><div id=hint></div></div>