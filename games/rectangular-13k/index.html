<!doctype html><title>Rectangular 13k - js13kGames 2012</title><style>canvas{position:fixed;top:0;left:0;z-index:-1}#menu{position:absolute;width:500px;height:600px;background-color:#fff;-webkit-box-shadow:-2px 2px 7px rgba(0,0,0,.5);-moz-box-shadow:-2px 2px 7px rgba(0,0,0,.5);-ms-box-shadow:-2px 2px 7px rgba(0,0,0,.5);-o-box-shadow:-2px 2px 7px rgba(0,0,0,.5);box-shadow:-2px 2px 7px rgba(0,0,0,.5)}h1{text-align:center;font-size:2em}p{text-align:justify;padding:30px}#links{text-align:center;margin:0;padding:0}a{font-family:Impact,sans-serif;font-weight:700;font-size:2.5em;text-transform:uppercase;-moz-text-shadow:0px 2px 0px grey;-ms-text-shadow:0px 2px 0px grey;-o-text-shadow:0px 2px 0px grey;text-shadow:0 2px 0 grey}a:active{-moz-text-shadow:0px 0px 0px grey;-ms-text-shadow:0px 0px 0px grey;-o-text-shadow:0px 0px 0px grey;text-shadow:0 0 0 grey}#signed{margin-top:-50px;float:right;color:#000;font-family:arial;font-size:.7em;font-variant:italic;padding-right:10px}#signed a{color:#000;font-family:arial;font-size:.7em;font-variant:italic}#signed a:hover{text-decoration:none}</style><div id=menu><h1>Rectangular 13k</h1><p>The goal is to make the red rectangle go through the red line in the right of the window using the arrow keys. Beware of black circles, if you touch one of them you will have to restart.<br>Use the space key to deploy your parachute and collect the red circles to "reload" it.<br>If you fall down the screen, the rectangle will reappear on the top, at the same place.<br>To start, press Play :<p id=links><a>Play</a><br><br><a>Quit</a><p>Better with Chrome, works on other browsers but it seems to be really slow.<p id=signed>Any suggestions or problems : <a href=https://twitter.com/yhoyhoj>@yhoyhoj</a></div><canvas></canvas><script>function t(t,e){this.startX=t,this.startY=e,this.x=t,this.y=e,this.up=-50,this.rotate=0,this.parachute=100,this.renderPara=!1,this.renderer}function e(t,e,i,s,h,a){this.x=t,this.y=e,this.size=i,this.color=s,this.speed=h,this.time=a,this.player=!1,p.push(this)}function i(t,e,i,s){this.x=t,this.y=e,this.size=i/2,this.speed=s,this.explode=0,p.push(this)}function s(t,e){this.x=t,this.y=e,this.size=15,p.push(this)}function h(){for(var t,e="#",i=0;i<6;i++)e+=9<(t=Math.round(14*Math.random()+1))?["A","B","C","D","E","F"][t-10]:t;return e}t.prototype.render=function(){w.save(),w.translate(this.x,this.y),0!=this.rotate&&(w.rotate(Math.PI*this.rotate/180),this.rotate=0),w.fillStyle="red",w.shadowBlur=7,w.shadowOffsetX=-2,w.shadowOffsetY=2,w.fillRect(0,0,10,20),w.restore(),this.renderPara&&this.renderParachute()},t.prototype.renderParachute=function(){w.save(),this.parachute<50&&this.parachute%5==0?w.strokeStyle="white":w.strokeStyle="red",w.moveTo(this.x,this.y),w.lineTo(this.x-10,this.y-20),w.moveTo(this.x+10,this.y),w.lineTo(this.x+20,this.y-20),w.stroke(),this.parachute<50&&this.parachute%5==0?w.strokeStyle="white":w.strokeStyle="red",w.beginPath(),w.arc(this.x+5,this.y-20,20,Math.PI,2*Math.PI),w.lineTo(this.x-15,this.y-20),w.stroke(),w.restore()},t.prototype.tick=function(){var t,s,h=!0;this.renderPara=!1,this.x>a.width-10&&!x&&(x=!0,s=new Date(new Date-o),u=("0"+s.getMinutes()).slice(-2)+":"+("0"+s.getSeconds()).slice(-2),localStorage)&&(localStorage&&(null==localStorage.getItem("rectangularBest")||localStorage.getItem("rectangularBest").slice(0,2)>s.getMinutes())||localStorage&&localStorage.getItem("rectangularBest").slice(-2)>s.getSeconds())&&localStorage.setItem("rectangularBest",u),this.x<-10?(this.x=this.startX,this.y=this.startY):this.y>a.height&&(this.y=-20);for(var r=0;r<p.length;r++){var w=p[r];w instanceof e?this.x>w.x-10&&this.x<w.x+w.size&&this.y+20<w.y+1&&this.y+20>w.y-2&&(this.renderer!=w&&(this.renderer&&(this.renderer.player=!1),w.player=!0,this.renderer=w),t=w.speed,h=!1):w instanceof i?this.x>w.x-w.size-10&&this.x<w.x+w.size&&this.y+20<w.y+w.size&&this.y>w.y-w.size&&(this.x=this.startX,this.y=this.startY,w.explo()):this.x>w.x-w.size-10&&this.x<w.x+w.size&&this.y+20<w.y+w.size&&this.y>w.y-w.size&&(this.parachute+=100,w.disappear())}d&&!h&&(this.up=50),h||(l?this.x++:n&&this.x--,this.x-=t),c&&h&&0<this.parachute&&(l?(this.x+=.5,this.rotate=-5):n&&(this.x-=.5,this.rotate=5),this.parachute--,this.renderPara=!0,this.y-=1.5),0<this.up?(this.y-=this.up/8,l?this.x+=1.1:n&&(this.x-=1.1),this.up--):-50<this.up&&h&&(l?this.x+=.8+this.up/80:n&&(this.x-=.8+this.up/80),this.up--),h&&(this.y+=3),this.renderer||this.render()},e.prototype.render=function(){var t;w.save(),w.fillStyle=this.color,w.shadowColor="rgba(0,0,0,0.5)",w.shadowBlur=7,w.shadowOffsetX=-2,w.shadowOffsetY=2,w.fillRect(this.x,this.y,this.size,this.size),this.time&&(t=("0"+(t=new Date(new Date-o)).getMinutes()).slice(-2)+":"+("0"+t.getSeconds()).slice(-2),w.restore(),w.fillStyle="white",w.shadowBlur=0,w.shadowOffsetX=-0,w.shadowOffsetY=0,w.font=this.size/3-5+"px Arial",w.textBaseline="middle",w.fillText(t,Math.round(this.x+(this.size-w.measureText(t).width)/2),Math.round(this.y+this.size/2))),w.restore(),this.onRender()},e.prototype.onRender=function(){this.player&&r.render()},e.prototype.tick=function(){this.x<-this.size?this.time?(this.size=125-100*Math.random(),this.color=h(),this.speed=.5+Math.random(),this.x=a.width+this.size,this.y=this.size+Math.random()*a.height-2*this.size+1):(this.x=a.width+this.size,this.y=Math.random()*a.height+1):this.x-=this.speed,this.render()},i.prototype.render=function(){w.save(),w.fillStyle="black",w.shadowColor="rgba(0,0,0,0.5)",w.shadowBlur=7,w.shadowOffsetX=-2,w.shadowOffsetY=2,w.beginPath(),w.arc(this.x,this.y,this.size,0,2*Math.PI),w.fill(),w.restore()},i.prototype.tick=function(){this.x<0-this.size?(this.x=a.width+2*this.size,this.y=Math.random()*a.height+1):this.x-=this.speed,10<this.explode?(this.size+=4,this.explode--):1<this.explode?4<this.size?(this.size-=4,this.explode--):this.explode=1:1==this.explode&&(this.explode=0,p.splice(p.indexOf(this),1),new i(a.width+100,Math.random()*a.height+1,100-30*Math.random(),.5+Math.random())),this.render()},i.prototype.explo=function(){0==this.explode&&(this.explode=20)},s.prototype.render=function(){w.save(),w.strokeStyle="red",w.shadowColor="rgba(0,0,0,0.5)",w.shadowBlur=7,w.shadowOffsetX=-2,w.shadowOffsetY=2,w.beginPath(),w.arc(this.x,this.y,this.size,0,2*Math.PI),w.stroke(),w.restore()},s.prototype.tick=function(){this.x>a.width+this.size?(this.x=-this.size,this.y=Math.random()*a.height+1):this.x+=.1,this.render()},s.prototype.disappear=function(){p.splice(p.indexOf(this),1),new s(a.width+100,Math.random()*a.height+1)};var a=document.getElementsByTagName("canvas")[0];a.width=window.innerWidth,a.height=window.innerHeight;var r,o,n,l,d,c,u,w=a.getContext("2d"),p=[],f=!1,x=!1,m=document.getElementById("menu");m.style.left=a.width/2-250+"px",m.style.top=a.height/2-250+"px",document.onkeydown=function(t){switch(t.keyCode){case 38:d=!0;break;case 39:l=!0;break;case 37:n=!0;break;case 32:c=!0}},document.onkeyup=function(t){switch(t.keyCode){case 38:d=!1,r.up=0;break;case 39:l=!1;break;case 37:n=!1;break;case 32:c=!1}},document.getElementsByTagName("a")[0].onclick=function(){m.style.opacity=0,o=new Date,new e(a.width+100,Math.random()*a.height+1,125-100*Math.random(),h(),.5+Math.random(),!0),f=!0};for(var y=0;y<a.width/15;y++)new e(Math.random()*a.width+1,Math.random()*a.height+1,15+86*Math.random(),h(),.5+Math.random(),!1);for(r=new t(a.width/5,-25),y=0;y<a.width/320;y++)new i(Math.random()*a.width+1,Math.random()*a.height+1,100-30*Math.random(),.5+Math.random()),new s(Math.random()*a.width+1,Math.random()*a.height+1);!function t(){window.webkitRequestAnimationFrame?webkitRequestAnimationFrame(t):window.mozRequestAnimationFrame?mozRequestAnimationFrame(t):window.msRequestAnimationFrame?msRequestAnimationFrame(t):window.requestAnimationFrame?requestAnimationFrame(t):setTimeout(t,25),w.save(),w.fillStyle="#FAFAED",w.shadowBlur=0,w.shadowOffsetX=-0,w.shadowOffsetY=0,w.fillRect(0,0,a.width,a.height),w.fillStyle="#FA4646",w.fillRect(a.width-15,0,5,a.height),w.restore(),w.save(),w.fillStyle="black",w.translate(a.width/5-30,10),w.rotate(-10*Math.PI/180),w.beginPath(),w.moveTo(0,90),w.lineTo(25,50),w.lineTo(-25,50),w.fill(),w.moveTo(-8,50),w.lineTo(-12,0),w.lineTo(12,0),w.lineTo(8,50),w.fill(),w.font="20px Impact",w.fillText("ICI",35-w.measureText("ICI").width/2,20),w.restore(),w.fillStyle="black",w.fillRect(a.width/5-50,-5,3,55),w.fillRect(a.width/5-50,20,30,3),w.fillRect(a.width/5-50,45,30,3),w.restore(),w.restore();for(var e,i=0;i<p.length;i++)p[i].tick();f&&r.tick(),x&&(w.restore(),w.fillStyle="black",w.font="70px Arial",w.fillText("You won !",a.width/2-w.measureText("You won !").width/2,a.height/2-35),w.font="20px Arial",w.fillText("Reload the page to retry (your best time will be saved).",a.width/2-w.measureText("Reload the page to retry (your best time will be saved).").width/2,a.height/2+8-7.5),w.font="15px Arial",w.fillText("Time : "+u,a.width/2-w.measureText("Time : "+u).width/2,a.height/2+30-7.5),localStorage)&&null!=localStorage.getItem("rectangularBest")&&(e=localStorage.getItem("rectangularBest"),w.fillText("Best time : "+e,a.width/2-w.measureText("Best time : "+e).width/2,a.height/2+50-7.5))}()</script>