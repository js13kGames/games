<!doctype html><title>Shadow Network - js13kGames 2025</title><meta name=viewport content="width=device-width"><style>*{margin:0;padding:0;box-sizing:border-box}body{background:#0a0a0a;color:#00ff41;font:11px monospace;overflow:hidden}canvas{display:block;margin:0 auto;border:1px solid #222;background:radial-gradient(circle,#010,#000)}#ui{position:fixed;top:8px;left:8px;z-index:100;background:rgba(0,20,0,.95);padding:8px;border:1px solid #333;border-radius:4px}.stat{margin:2px 0;display:flex;align-items:center;gap:6px}#scoreboard{position:fixed;top:8px;right:8px;background:rgba(0,20,0,.95);padding:8px;border:1px solid #333;border-radius:4px;min-width:220px;max-height:60vh;overflow:auto}#instructions{position:fixed;bottom:8px;right:8px;background:rgba(0,20,0,.95);padding:8px;border:1px solid #333;border-radius:4px;max-width:350px;font-size:9px}#level-complete{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);background:rgba(0,50,0,.95);padding:20px;border:2px solid #00ff41;border-radius:8px;text-align:center;display:none}button{background:#1a472a;border:1px solid #00ff41;color:#00ff41;padding:8px 16px;margin:5px;border-radius:4px;cursor:pointer;font:11px monospace}button:hover{background:#2a573a}#ai-toggle{background:#472a1a;border-color:#f80}#ai-toggle:hover{background:#573a2a}#ai-toggle.active{background:#573a1a;border-color:#fa0}</style><div id=ui><div class=stat>üê± Black Cat Network</div><div class=stat>üéØ Level: <span id=level>1</span></div><div class=stat>‚è±Ô∏è Time: <span id=timer>0</span></div><div class=stat>‚≠ê Score: <span id=score>0</span></div><div class=stat>üåê Mode: <span id=mode>Offline</span></div><div style=margin-top:6px><button id=connectBtn>Join Multiplayer</button> <button id=newGameBtn>New Game</button> <button id=ai-toggle>AI Cat: OFF</button></div></div><div id=scoreboard><div style=font-weight:700;margin-bottom:6px>üèÜ Scoreboard</div><div id=playersList>Click "Join Multiplayer" to compete!</div></div><div id=instructions><div>üéÆ HOW TO PLAY:</div><div>‚Ä¢ Click nodes to move your black cat</div><div>‚Ä¢ Mine all target nodes (yellow) to win</div><div>‚Ä¢ Cats can only move along green connections</div><div>‚Ä¢ Each node takes time to mine</div><div>‚Ä¢ Faster completion = higher score</div><br><div>üèÅ MULTIPLAYER:</div><div>‚Ä¢ Race against other players</div><div>‚Ä¢ First to mine all targets wins</div><div>‚Ä¢ Watch the scoreboard for rankings</div><br><div>ü§ñ AI CAT:</div><div>‚Ä¢ Toggle AI for automated play</div><div>‚Ä¢ Learn strategies by watching</div></div><canvas id=game width=1000 height=700></canvas><div id=level-complete><div style=font-size:16px;margin-bottom:10px>üéâ LEVEL COMPLETE!</div><div>Network Successfully Mined!</div><div style="margin:10px 0"><span>Score Earned: </span><span id=level-score>0</span></div><button onclick=nextLevel()>Next Level</button> <button onclick=resetGame()>Restart</button></div><script>const WS_SERVER="wss://relay.js13kgames.com/shadow-network",canvas=document.getElementById("game"),ctx=canvas.getContext("2d"),game={width:canvas.width=1e3,height:canvas.height=700,nodes:[],links:[],cats:[],level:1,score:0,startTime:Date.now(),levelComplete:!1,particles:[],targetNodes:[],completedNodes:new Set,players:{},clientId:null,ws:null,mode:"offline",aiEnabled:!1,aiCat:null},levels=[{nodes:8,cats:1,targets:2,time:45,reward:100,complexity:"ring"},{nodes:12,cats:1,targets:3,time:60,reward:200,complexity:"grid"},{nodes:16,cats:1,targets:4,time:75,reward:350,complexity:"spiral"},{nodes:20,cats:1,targets:5,time:90,reward:500,complexity:"cluster"},{nodes:24,cats:1,targets:6,time:120,reward:750,complexity:"mesh"},{nodes:30,cats:1,targets:8,time:150,reward:1e3,complexity:"complex"}];class NetworkCat{constructor(e,t,a,n=!1){this.id=e,this.x=t,this.y=a,this.targetX=t,this.targetY=a,this.node=0,this.moving=!1,this.mining=!1,this.miningProgress=0,this.energy=100,this.maxEnergy=100,this.trail=[],this.isAI=n,this.aiTimer=0,this.lastTarget=-1}update(){if(this.moving){const e=this.targetX-this.x,t=this.targetY-this.y;Math.sqrt(e*e+t*t)>3?(this.x+=.2*e,this.y+=.2*t):(this.x=this.targetX,this.y=this.targetY,this.moving=!1,this.startMining())}if(this.mining){const e=game.nodes[this.node];if(e&&!e.mined&&this.energy>0&&game.targetNodes.includes(this.node)){this.miningProgress+=2,this.energy=Math.max(0,this.energy-1);const t=60*e.difficulty;this.miningProgress>=t&&this.completeMining(),Math.random()<.3&&this.createMiningParticle()}else this.mining=!1,e&&(e.mining=!1)}!this.mining&&this.energy<this.maxEnergy&&(this.energy+=.8),!this.isAI||this.moving||this.mining||(this.aiTimer++,this.aiTimer>30&&(this.performAIAction(),this.aiTimer=0)),this.updateTrail()}performAIAction(){const e=game.targetNodes.filter(e=>!game.completedNodes.has(e));if(0===e.length)return;let t=null,a=1/0;for(const n of e){const e=this.getPathDistance(this.node,n);e<a&&n!==this.lastTarget&&(a=e,t=n)}if(null!==t){const e=this.findNextNodeToTarget(t);-1!==e&&(this.moveTo(e),e===t&&(this.lastTarget=t))}}getPathDistance(e,t){if(e===t)return 0;const a=new Set,n=[{node:e,dist:0}];for(a.add(e);n.length>0;){const{node:e,dist:i}=n.shift(),s=game.links.filter(t=>t.from===e||t.to===e).map(t=>t.from===e?t.to:t.from);for(const e of s){if(e===t)return i+1;a.has(e)||(a.add(e),n.push({node:e,dist:i+1}))}}return 1/0}findNextNodeToTarget(e){const t=game.links.filter(e=>e.from===this.node||e.to===this.node).map(e=>e.from===this.node?e.to:e.from);if(t.includes(e))return e;let a=-1,n=1/0;for(const i of t){const t=this.getPathDistance(i,e);t<n&&(n=t,a=i)}return a}updateTrail(){this.trail.push({x:this.x,y:this.y,alpha:1}),this.trail.length>12&&this.trail.shift(),this.trail.forEach(e=>e.alpha*=.85)}moveTo(e){return!this.mining&&!this.moving&&!(this.node!==e&&!game.links.some(t=>t.from===this.node&&t.to===e||t.to===this.node&&t.from===e)||!(e<game.nodes.length)||(this.node=e,this.targetX=game.nodes[e].x,this.targetY=game.nodes[e].y,this.moving=!0,this.miningProgress=0,0))}startMining(){const e=game.nodes[this.node];e&&!e.mined&&(this.mining=!0,e.mining=!0,this.miningProgress=0)}completeMining(){const e=game.nodes[this.node];if(e){e.mined=!0,e.mining=!1,game.completedNodes.add(this.node),game.links.forEach(e=>{(e.from===this.node||e.to===this.node)&&game.nodes[e.from].mined&&game.nodes[e.to].mined&&(e.active=!0)});const t=50*e.difficulty;game.score+=t,this.createRewardParticles(t),updateUI(),checkLevelComplete()}this.mining=!1}createMiningParticle(){game.particles.push({x:this.x+20*(Math.random()-.5),y:this.y+20*(Math.random()-.5),vx:3*(Math.random()-.5),vy:3*(Math.random()-.5)-1,life:40,type:"mining",size:3*Math.random()+1})}createRewardParticles(e){const t=Math.min(e/20,10);for(let e=0;e<t;e++)game.particles.push({x:this.x,y:this.y,vx:8*(Math.random()-.5),vy:8*(Math.random()-.5)-3,life:60,type:"reward",size:4*Math.random()+2})}draw(e){if(this.trail.forEach(t=>{e.globalAlpha=.5*t.alpha,e.fillStyle=this.isAI?"#ff8800":"#00ff41",e.beginPath(),e.arc(t.x,t.y,4,0,2*Math.PI),e.fill()}),e.globalAlpha=1,e.fillStyle="#000",e.fillRect(this.x-10,this.y-8,20,16),e.fillStyle=this.isAI?"#ff8800":"#00ff41",e.fillRect(this.x-6,this.y-4,3,3),e.fillRect(this.x+3,this.y-4,3,3),e.fillStyle="#000",e.beginPath(),e.moveTo(this.x-8,this.y-8),e.lineTo(this.x-12,this.y-15),e.lineTo(this.x-4,this.y-12),e.fill(),e.beginPath(),e.moveTo(this.x+8,this.y-8),e.lineTo(this.x+12,this.y-15),e.lineTo(this.x+4,this.y-12),e.fill(),this.mining){e.strokeStyle="#ffaa00",e.lineWidth=3,e.setLineDash([4,4]),e.beginPath();const t=this.miningProgress/(60*game.nodes[this.node].difficulty);e.arc(this.x,this.y,20,0,t*Math.PI*2),e.stroke(),e.setLineDash([])}e.fillStyle="#330000",e.fillRect(this.x-10,this.y+12,20,3),e.fillStyle=this.energy>30?"#00ff41":"#ff4444",e.fillRect(this.x-10,this.y+12,20*this.energy/this.maxEnergy,3),e.fillStyle=this.isAI?"#ff8800":"#00ff41",e.font="9px monospace",e.textAlign="center",e.fillText(this.isAI?"AI":this.id.toString(),this.x,this.y-18)}}function generateLevel(e){const t=levels[Math.min(e-1,levels.length-1)];resetGameState();const a=t.nodes;switch(game.level=e,t.complexity){case"ring":default:generateRingNetwork(a);break;case"grid":generateGridNetwork(a);break;case"spiral":generateSpiralNetwork(a);break;case"cluster":generateClusterNetwork(a);break;case"mesh":generateMeshNetwork(a);break;case"complex":generateComplexNetwork(a)}game.nodes.forEach((e,t)=>{e.id=t,e.mined=!1,e.mining=!1,e.difficulty=Math.floor(3*Math.random())+1});const n=game.nodes.map(e=>e.id);shuffleArray(n),game.targetNodes=n.slice(0,t.targets);for(let e=0;e<t.cats;e++)game.cats.push(new NetworkCat(e,game.nodes[0].x,game.nodes[0].y));game.aiEnabled&&(game.aiCat=new NetworkCat("AI",game.nodes[0].x,game.nodes[0].y,!0),game.cats.push(game.aiCat)),ensureConnectedGraph()}function resetGameState(){game.nodes=[],game.links=[],game.cats=[],game.targetNodes=[],game.completedNodes=new Set,game.particles=[],game.startTime=Date.now(),game.levelComplete=!1,game.aiCat=null}function generateRingNetwork(e){const t=game.width/2,a=game.height/2;for(let n=0;n<e;n++){const i=n/e*Math.PI*2;game.nodes.push({x:t+200*Math.cos(i)+40*(Math.random()-.5),y:a+200*Math.sin(i)+40*(Math.random()-.5)})}for(let t=0;t<e;t++)if(game.links.push({from:t,to:(t+1)%e,active:!1}),Math.random()<.3){const a=(t+2+Math.floor(3*Math.random()))%e;a!==t&&game.links.push({from:t,to:a,active:!1})}}function generateGridNetwork(e){const t=Math.ceil(Math.sqrt(e)),a=Math.ceil(e/t),n=(game.width-200)/t,i=(game.height-200)/a;for(let a=0;a<e;a++){const e=Math.floor(a/t),s=a%t;game.nodes.push({x:100+s*n+n/2+30*(Math.random()-.5),y:100+e*i+i/2+30*(Math.random()-.5)})}for(let n=0;n<e;n++){const i=Math.floor(n/t),s=n%t;s<t-1&&n+1<e&&game.links.push({from:n,to:n+1,active:!1}),i<a-1&&n+t<e&&game.links.push({from:n,to:n+t,active:!1}),Math.random()<.4&&s<t-1&&i<a-1&&n+t+1<e&&game.links.push({from:n,to:n+t+1,active:!1})}}function generateSpiralNetwork(e){const t=game.width/2,a=game.height/2;let n=0,i=50;for(let s=0;s<e;s++)game.nodes.push({x:t+Math.cos(n)*i+20*(Math.random()-.5),y:a+Math.sin(n)*i+20*(Math.random()-.5)}),n+=.8,i+=8;for(let t=0;t<e-1;t++)game.links.push({from:t,to:t+1,active:!1});for(let t=0;t<e;t++)Math.random()<.3&&t+3<e&&game.links.push({from:t,to:t+3,active:!1})}function generateClusterNetwork(e){const t=Math.floor(e/3);for(let e=0;e<3;e++){const a=200+300*e,n=200+e%2*200;for(let e=0;e<t;e++){const i=e/t*Math.PI*2,s=80+60*Math.random();game.nodes.push({x:a+Math.cos(i)*s,y:n+Math.sin(i)*s})}}for(;game.nodes.length<e;)game.nodes.push({x:Math.random()*(game.width-100)+50,y:Math.random()*(game.height-100)+50});for(let e=0;e<3;e++){const a=e*t,n=Math.min(a+t,game.nodes.length);for(let e=a;e<n;e++)for(let t=e+1;t<n;t++)Math.random()<.6&&game.links.push({from:e,to:t,active:!1})}for(let e=0;e<game.nodes.length;e++)for(let t=e+1;t<game.nodes.length;t++){const a=game.nodes[e].x-game.nodes[t].x,n=game.nodes[e].y-game.nodes[t].y;Math.sqrt(a*a+n*n)<200&&Math.random()<.2&&game.links.push({from:e,to:t,active:!1})}}function generateMeshNetwork(e){for(let t=0;t<e;t++)game.nodes.push({x:Math.random()*(game.width-200)+100,y:Math.random()*(game.height-200)+100});for(let t=0;t<e;t++)for(let a=t+1;a<e;a++){const e=game.nodes[t].x-game.nodes[a].x,n=game.nodes[t].y-game.nodes[a].y,i=Math.sqrt(e*e+n*n),s=150,o=Math.max(0,.8-i/s);Math.random()<o&&game.links.push({from:t,to:a,active:!1})}}function generateComplexNetwork(e){const t=["ring","grid","cluster"],a=Math.floor(e/t.length);for(let e=0;e<t.length;e++)game.nodes.length,generateSubNetwork(t[e],a,e);for(;game.nodes.length<e;)game.nodes.push({x:Math.random()*(game.width-100)+50,y:Math.random()*(game.height-100)+50});connectSubNetworks()}function generateSubNetwork(e,t,a){const n=a%2*400+150,i=300*Math.floor(a/2)+150,s=game.nodes.length;for(let a=0;a<t;a++){let s,o;if("ring"===e){const e=a/t*Math.PI*2;s=n+100*Math.cos(e),o=i+100*Math.sin(e)}else if("grid"===e){const e=Math.ceil(Math.sqrt(t));s=n+a%e*40-20*e,o=i+40*Math.floor(a/e)-20*Math.ceil(t/e)}else s=n+200*(Math.random()-.5),o=i+200*(Math.random()-.5);game.nodes.push({x:s,y:o})}for(let e=s;e<s+t;e++)for(let a=e+1;a<s+t;a++)Math.random()<.5&&game.links.push({from:e,to:a,active:!1})}function connectSubNetworks(){const e=Math.floor(game.nodes.length/3);for(let t=0;t<2;t++){const a=t*e+Math.floor(Math.random()*e),n=(t+1)*e+Math.floor(Math.random()*e);game.links.push({from:a,to:n,active:!1})}}function ensureConnectedGraph(){const e=game.nodes.length,t=Array.from({length:e},(e,t)=>t);function a(e){return t[e]===e?e:t[e]=a(t[e])}function n(e,n){(e=a(e))!==(n=a(n))&&(t[n]=e)}game.links.forEach(e=>n(e.from,e.to));for(let t=1;t<e;t++)a(t)!==a(0)&&(game.links.push({from:0,to:t,active:!1}),n(0,t))}function shuffleArray(e){for(let t=e.length-1;t>0;t--){const a=Math.floor(Math.random()*(t+1));[e[t],e[a]]=[e[a],e[t]]}}function render(){ctx.fillStyle="#000",ctx.fillRect(0,0,game.width,game.height),game.links.forEach(e=>{const t=game.nodes[e.from],a=game.nodes[e.to];ctx.strokeStyle=e.active?"#00ff41":"#003300",ctx.lineWidth=e.active?3:2,e.active?(ctx.setLineDash([6,6]),ctx.lineDashOffset=Date.now()/50):ctx.setLineDash([]),ctx.beginPath(),ctx.moveTo(t.x,t.y),ctx.lineTo(a.x,a.y),ctx.stroke()}),ctx.setLineDash([]),game.nodes.forEach((e,t)=>{let a,n,i;game.targetNodes.includes(t)?e.mined?(a="rgba(0, 255, 65, 0.6)",n="#00ff41",i=4):(a="rgba(255, 170, 0, 0.3)",n="#ffaa00",i=4):e.mined?(a="rgba(0, 255, 65, 0.4)",n="#00ff41",i=3):e.mining?(a="rgba(255, 170, 0, 0.4)",n="#ffaa00",i=3):(a="rgba(0, 255, 65, 0.1)",n="#003300",i=2),ctx.fillStyle=a,ctx.strokeStyle=n,ctx.lineWidth=i,ctx.beginPath(),ctx.arc(e.x,e.y,22,0,2*Math.PI),ctx.fill(),ctx.stroke(),ctx.fillStyle=n,ctx.font="11px monospace",ctx.textAlign="center",ctx.fillText(t.toString(),e.x,e.y-2),ctx.font="9px monospace",ctx.fillText("D"+e.difficulty,e.x,e.y+10)}),game.particles=game.particles.filter(e=>(e.x+=e.vx,e.y+=e.vy,e.vy+=.15,e.vx*=.98,e.vy*=.98,e.life--,ctx.globalAlpha=e.life/("reward"===e.type?60:40),ctx.fillStyle="reward"===e.type?"#ffaa00":"#00ff41",ctx.beginPath(),ctx.arc(e.x,e.y,e.size,0,2*Math.PI),ctx.fill(),e.life>0)),ctx.globalAlpha=1,game.cats.forEach(e=>e.draw(ctx));const e=game.nodes.length,t=game.completedNodes.size,a=game.targetNodes.filter(e=>game.completedNodes.has(e)).length;ctx.fillStyle="rgba(0, 20, 0, 0.9)",ctx.fillRect(10,game.height-90,320,80),ctx.strokeStyle="#003300",ctx.strokeRect(10,game.height-90,320,80),ctx.fillStyle="#00ff41",ctx.font="11px monospace",ctx.textAlign="left",ctx.fillText(`Total Nodes: ${t}/${e}`,15,game.height-70),ctx.fillText(`Target Nodes: ${a}/${game.targetNodes.length}`,15,game.height-54),ctx.fillText(`Network Progress: ${Math.floor(t/e*100)}%`,15,game.height-38),ctx.fillText(`Completion: ${Math.floor(a/game.targetNodes.length*100)}%`,15,game.height-22)}function checkLevelComplete(){if(game.nodes&&0!==game.nodes.length&&(game.targetNodes.filter(e=>game.completedNodes.has(e)).length,game.targetNodes.length>0&&game.targetNodes.every(e=>game.completedNodes.has(e))&&!game.levelComplete)){game.levelComplete=!0;const e=levels[Math.min(game.level-1,levels.length-1)],t=Math.floor((Date.now()-game.startTime)/1e3),a=20*Math.max(0,e.time-t),n=e.reward+a;if(game.score+=n,updateUI(),document.getElementById("level-score").textContent=n,document.getElementById("level-complete").style.display="block","online"===game.mode&&game.ws&&game.clientId){const e={type:"finish",clientId:game.clientId,level:game.level,time:t,score:n};try{game.ws.send(JSON.stringify(e))}catch(e){console.warn("WebSocket send failed:",e)}}}}function updateUI(){document.getElementById("level").textContent=game.level,document.getElementById("score").textContent=game.score}function updateTimer(){const e=Math.floor((Date.now()-game.startTime)/1e3);document.getElementById("timer").textContent=e+"s"}function connectMultiplayer(){game.ws&&game.ws.close(),game.mode="online",document.getElementById("mode").textContent="Online";const e="player_"+Math.random().toString(36).slice(2,9);game.clientId=e;const t=new WebSocket(WS_SERVER);game.ws=t,t.addEventListener("open",()=>{console.log("Connected to multiplayer server"),t.send(JSON.stringify({type:"join",clientId:e,name:`Player ${e.slice(-4)}`}))}),t.addEventListener("message",e=>{handleWebSocketMessage(e)}),t.addEventListener("close",()=>{game.mode="offline",document.getElementById("mode").textContent="Offline",game.ws=null,renderPlayersList()}),t.addEventListener("error",e=>{console.error("WebSocket error:",e),alert("Connection failed. Playing offline.")})}async function handleWebSocketMessage(e){try{let t,a;if("string"==typeof e.data)t=e.data;else try{t=await e.data.text()}catch(a){const n=await e.data.arrayBuffer();t=(new TextDecoder).decode(n)}try{a=JSON.parse(t)}catch(e){const n=Math.min(-1===t.indexOf("{")?1/0:t.indexOf("{"),-1===t.indexOf("[")?1/0:t.indexOf("["));if(n===1/0)return void console.warn("Non-JSON WebSocket message:",t);{const e=t.slice(n);a=JSON.parse(e)}}handleGameMessage(a)}catch(e){console.error("Failed to process WebSocket message:",e)}}function handleGameMessage(e){try{switch(e.type){case"state":e.players&&(game.players=e.players,renderPlayersList());break;case"start":e.levelConfig&&applyServerLevel(e.levelConfig),game.startTime=Date.now(),document.getElementById("level-complete").style.display="none";break;case"finish":e.clientId&&e.clientId!==game.clientId&&(game.players[e.clientId]=game.players[e.clientId]||{},game.players[e.clientId].time=e.time,game.players[e.clientId].score=e.score,game.players[e.clientId].status="finished",renderPlayersList());break;default:console.log("Unknown message type:",e.type)}}catch(e){console.error("Error handling game message:",e)}}function applyServerLevel(e){if(e&&e.nodes&&e.links){game.nodes=e.nodes,game.links=e.links,game.targetNodes=e.targetNodes||[],game.cats=[];const t=e.cats||1;for(let e=0;e<t;e++)game.cats.push(new NetworkCat(e,game.nodes[0].x,game.nodes[0].y));game.aiEnabled&&(game.aiCat=new NetworkCat("AI",game.nodes[0].x,game.nodes[0].y,!0),game.cats.push(game.aiCat))}}function renderPlayersList(){const e=document.getElementById("playersList"),t=Object.values(game.players).sort((e,t)=>(e.time||99999)-(t.time||99999));0!==t.length?e.innerHTML=t.map(e=>`\n          <div style="margin-bottom: 8px; padding: 4px; border-left: 2px solid ${"finished"===e.status?"#00ff41":"#666"}">\n            <div>${e.name||e.clientId}</div>\n            <div style="font-size: 9px; color: #aaa">\n              ${"finished"===e.status?`‚è±Ô∏è ${e.time}s`:"üèÉ Racing..."}\n              ${e.score?` | üèÜ ${e.score}`:""}\n            </div>\n          </div>\n        `).join(""):e.innerHTML='Click "Join Multiplayer" to compete!'}function toggleAI(){game.aiEnabled=!game.aiEnabled;const e=document.getElementById("ai-toggle");if(game.aiEnabled)e.textContent="AI Cat: ON",e.classList.add("active"),game.aiCat||(game.aiCat=new NetworkCat("AI",game.nodes[0].x,game.nodes[0].y,!0),game.cats.push(game.aiCat));else if(e.textContent="AI Cat: OFF",e.classList.remove("active"),game.aiCat){const e=game.cats.indexOf(game.aiCat);e>-1&&game.cats.splice(e,1),game.aiCat=null}}function nextLevel(){game.level<levels.length?game.level++:game.level=1,generateLevel(game.level),document.getElementById("level-complete").style.display="none",updateUI()}function resetGame(){game.level=1,game.score=0,generateLevel(1),document.getElementById("level-complete").style.display="none",updateUI()}function gameLoop(){game.levelComplete||(game.cats.forEach(e=>e.update()),updateTimer()),render(),requestAnimationFrame(gameLoop)}canvas.addEventListener("click",e=>{const t=canvas.getBoundingClientRect(),a=e.clientX-t.left,n=e.clientY-t.top,i=game.nodes.findIndex(e=>{const t=a-e.x,i=n-e.y;return Math.sqrt(t*t+i*i)<30});if(i>=0){const e=game.cats.filter(e=>!e.isAI&&!e.moving&&!e.mining).sort((e,t)=>t.energy-e.energy)[0];e&&e.moveTo(i)}}),document.getElementById("connectBtn").addEventListener("click",connectMultiplayer),document.getElementById("newGameBtn").addEventListener("click",resetGame),document.getElementById("ai-toggle").addEventListener("click",toggleAI),generateLevel(1),updateUI(),gameLoop()</script>