<!doctype html><meta name=viewport content="width=device-width"><title>The_Coder's Game!</title><p id=gameText0><p><p id=gameText1><p><p id=gameText2><p><p id=gameText3><p><p id=gameText4>test<p><canvas id=game width=800 height=800></canvas><script>var disX,disY,hero,canvas=document.getElementById("game"),ctx=canvas.getContext("2d"),grid=[],w=10,rows=80,cols=60,rooms=[],collide=!1,amount=4,size=10,sizeMin=10,corridorW=1,enemys=[],zoom=4,step=[0,1,0],arr=[],space=u=d=l=r=0,startingAmount=6,coolDown=!1,interval=[],win=!1,lose=!1,wCS=!1,sCS=!1,tut=!1,tutA=!1,menuOn=!0,beacons=[],beaconSpots=[],switched=0,level=1,time=90,timeR=90;function Cell(t,e,i,l){this.c=t,this.r=e,this.x=i,this.y=l,this.type=0,this.dir,this.show=function(){if(0==this.type)ctx.fillStyle="#292634",ctx.fillRect(this.x,this.y,w,w);else if(1==this.type)ctx.fillStyle="#489551",ctx.fillRect(this.x,this.y,w,w);else if(2==this.type){ctx.fillStyle="#AA856F",ctx.fillRect(this.x,this.y,w,w);for(var t=1;t<3;t++)ctx.fillStyle="#874A24",ctx.fillRect(this.x,this.y+w/3*t,w,1)}else if(3==this.type)for(ctx.fillStyle="#AA856F",ctx.fillRect(this.x,this.y,w,w),t=1;t<3;t++)ctx.fillStyle="#874A24",ctx.fillRect(this.x+w/3*t,this.y,1,w);else if(4==this.type)ctx.fillStyle="#2EC0F9",ctx.fillRect(this.x,this.y,w,w);else if(5==this.type)ctx.fillStyle="#8D6A9F",ctx.fillRect(this.x,this.y,w,w);else if(6==this.type){var e=ctx.createLinearGradient(this.x,this.y,this.x,this.y+3*w);e.addColorStop(0,"#57719C"),e.addColorStop(1,"#292634"),ctx.fillStyle=e,ctx.fillRect(this.x,this.y,w,w)}else 7==this.type&&(ctx.fillStyle=e,ctx.fillRect(this.x,this.y,w,w))},this.detect=function(){var i=[];i[0]=grid[index(t-1,e)],i[1]=grid[index(t,e+1)],i[2]=grid[index(t,e-1)],i[3]=grid[index(t+1,e)],i[4]=grid[index(t+2,e)];for(var l=0;l<4;l++)i[l]&&1==this.type&&(0!=i[l].type&&7!=i[l].type&&6!=i[l].type||(this.line(l),this.type=1));i[3]&&0==i[3].type&&(1!=this.type&&8!=this.type||(i[3].type=6)),i[3]&&0==i[3].type&&6==this.type&&(i[3].type=7),i[4]&&0==i[4].type&&6==this.type&&(i[4].type=7)},this.carve=function(){for(var t=0;t<rooms.length;t++)this.c>=rooms[t].y/w&&this.c<rooms[t].y/w+rooms[t].h/w&&this.r>=rooms[t].x/w&&this.r<rooms[t].x/w+rooms[t].w/w&&(this.type=1)},this.carveH=function(t,e,i){this.r>=e&&this.r<e+t&&this.c<i+corridorW&&this.c>i-corridorW&&(this.type=3)},this.carveV=function(t,e,i){this.c>=i&&this.c<i+t&&this.r<e+corridorW&&this.r>e-corridorW&&(this.type=2)},this.line=function(t){for(var e=[[0,0,w,3],[w-3,0,3,w],[0,0,3,w],[0,w,w,3]],i=0;i<4;i++)t==i&&(ctx.fillStyle="#6FAE53",ctx.fillRect(this.x+e[i][0],this.y+e[i][1],e[i][2],e[i][3]))},this.collide=function(){hero.x>=this.x&&hero.x+7<=this.x+w&&hero.y+8>=this.y&&hero.y+8<=this.y+w&&(0!=this.type&&7!=this.type&&6!=this.type||(zoom=7)),hero.x+7>=this.x&&hero.x<=this.x+w&&hero.y+8>=this.y&&hero.y<=this.y+w&&5==this.type&&(this.type=4)},this.beacon=function(){for(var t=0;t<beacons.length;t++)this.x==grid[beacons[t]].x&&this.y==grid[beacons[t]].y&&(this.type=5)}}function makeGrid(){for(var t=0;t<rows;t++)for(var e=0;e<cols;e++){var i=new Cell(e,t,t*w,e*w);grid.push(i)}}function Room(t,e,i,l,s){this.x=(t-1)*w,this.y=(e-1)*w,this.w=i*w,this.h=l*w,this.center=[Math.floor(this.x/w+i/2),Math.floor(this.y/w+l/2)],this.enemys=function(){for(var t=0;t<enemys.length;t++)enemys[t].x+7>this.x&&enemys[t].x<this.x+this.w&&enemys[t].y+10>this.y&&enemys[t].y<this.y+this.h&&(enemys[t].bX=this.x,enemys[t].bY=this.y,enemys[t].bW=this.w,enemys[t].bH=this.h)},this.beacons=function(){for(var t=[],e=0;e<grid.length;e++)1==grid[e].type&&grid[e].x+w>this.x+w&&grid[e].x<this.x+this.w-w&&grid[e].y+w>this.y+w&&grid[e].y<this.y+this.h-w&&t.push(e);beaconSpots.push(t)}}function createRooms(t){for(var e=0;e<t;e++){var i=new Room(Math.floor(Math.random()*rows)+1,Math.floor(Math.random()*cols)+1,Math.floor(Math.random()*size)+sizeMin,Math.floor(Math.random()*size)+sizeMin,e);if(e>0){if(rooms[0].x+rooms[0].w>=rows*w||rooms[0].x<=0||rooms[0].y+rooms[0].h>=cols*w||rooms[0].y<=0){rooms=[],createRooms(t);break}for(var l=0;l<rooms.length;l++){if(collide=!1,i.x<=rooms[l].x+rooms[l].w&&i.x+i.w>=rooms[l].x&&i.y<=rooms[l].y+rooms[l].h&&i.y+i.h>=rooms[l].y){collide=!0,e--;break}if(i.x+i.w>=rows*w||i.x<=0||i.y+i.h>=cols*w||i.y<=0){collide=!0,e--;break}}}0==collide&&(rooms.push(i),e>0&&(hCorridor(rooms[e-1].center[0],i.center[0],rooms[e-1].center[1],i.center[1]),vCorridor(rooms[e-1].center[0],i.center[0],rooms[e-1].center[1],i.center[1])))}}function hCorridor(t,e,i,l){if(t>e){disX=t-e,disX+=1;for(var s=0;s<grid.length;s++)grid[s].carveH(disX,e,l)}else for(disX=e-t,disX+=1,s=0;s<grid.length;s++)grid[s].carveH(disX,t,i)}function vCorridor(t,e,i,l){var s;if(i>l){disY=i-l,disY+=1,s=e+(disX-1)>t+(disX-1)?e:e+(disX-1);for(var o=0;o<grid.length;o++)grid[o].carveV(disY,s,l)}else for(disY=l-i,disY+=1,s=t+(disX-1)>e+(disX-1)?t:t+(disX-1),o=0;o<grid.length;o++)grid[o].carveV(disY,s,i)}function heroClass(){this.x,this.y,this.draw=function(){ctx.fillStyle="white",ctx.fillRect(this.x,this.y,7,7),ctx.fillStyle="#dcd9d9",ctx.fillRect(this.x+1,this.y+7,2,step[0]),ctx.fillRect(this.x+4,this.y+7,2,step[1]),u||(d?(ctx.fillStyle="black",ctx.fillRect(this.x+2,this.y+2,1,1),ctx.fillRect(this.x+4,this.y+2,1,1)):l?(ctx.fillStyle="black",ctx.fillRect(this.x+1,this.y+2,1,1),ctx.fillRect(this.x+3,this.y+2,1,1)):r?(ctx.fillStyle="black",ctx.fillRect(this.x+3,this.y+2,1,1),ctx.fillRect(this.x+5,this.y+2,1,1)):(ctx.fillStyle="black",ctx.fillRect(this.x+2,this.y+2,1,1),ctx.fillRect(this.x+4,this.y+2,1,1),ctx.fillStyle="#dcd9d9",ctx.fillRect(this.x+1,this.y+7,2,1),ctx.fillRect(this.x+4,this.y+7,2,1)))},this.move=function(){u?this.y-=.7:d?this.y+=.7:l?this.x-=.7:r&&(this.x+=.7)}}function createHero(){hero=new heroClass}function enemyClass(){this.x,this.y,this.u=!1,this.d=!1,this.l=!1,this.r=!1,this.bX,this.bY,this.bW,this.bH,this.state=1,this.ran,this.rMove=function(){this.ran=Math.floor(4*Math.random())},this.nMove=function(){this.u=!1,this.d=!1,this.l=!1,this.r=!1},this.draw=function(){ctx.fillStyle="red",ctx.fillRect(this.x,this.y,7,9),ctx.fillStyle="#bf0202",ctx.fillRect(this.x+1,this.y+9,2,step[0]),ctx.fillRect(this.x+4,this.y+9,2,step[1]),this.u||(this.d?(ctx.fillStyle="black",ctx.fillRect(this.x+2,this.y+2,1,1),ctx.fillRect(this.x+4,this.y+2,1,1)):this.l?(ctx.fillStyle="black",ctx.fillRect(this.x+1,this.y+2,1,1),ctx.fillRect(this.x+3,this.y+2,1,1)):this.r?(ctx.fillStyle="black",ctx.fillRect(this.x+3,this.y+2,1,1),ctx.fillRect(this.x+5,this.y+2,1,1)):(ctx.fillStyle="black",ctx.fillRect(this.x+2,this.y+2,1,1),ctx.fillRect(this.x+4,this.y+2,1,1),ctx.fillStyle="#bf0202",ctx.fillRect(this.x+1,this.y+9,2,1),ctx.fillRect(this.x+4,this.y+9,2,1)))},this.move=function(){hero.x+7>this.x-50&&hero.x<this.x+57&&hero.y+8>this.y-50&&hero.y<this.y+60&&hero.x+7>this.bX&&hero.x<this.bX+this.bW&&hero.y+8>this.bY&&hero.y<this.bY+this.bH?this.state=2:(this.nMove(),this.state=1),1==this.state?(0==this.ran?(this.y-=.2,this.u=!0,this.r=!1,this.d=!1,this.l=!1):1==this.ran?(this.y+=.2,this.d=!0,this.u=!1,this.r=!1,this.l=!1):2==this.ran?(this.x-=.2,this.l=!0,this.u=!1,this.d=!1,this.r=!1):3==this.ran&&(this.x+=.2,this.r=!0,this.u=!1,this.d=!1,this.l=!1),this.x<this.bX&&(this.x=this.bX,this.nMove()),this.x+7>this.bX+this.bW&&(this.x=this.bX+this.bW-7,this.nMove()),this.y<this.bY&&(this.y=this.bY,this.nMove()),this.y+10>this.bY+this.bH&&(this.y=this.bY+this.bH-10,this.nMove())):2==this.state&&(this.x+7<=hero.x?(this.x+=.3,this.r=!0,this.u=!1,this.d=!1,this.l=!1):this.r=!1,this.x-7>=hero.x?(this.x-=.3,this.l=!0,this.u=!1,this.d=!1,this.r=!1):this.l=!1,this.y+9<=hero.y+6?(this.y+=.3,this.d=!0,this.u=!1,this.r=!1,this.l=!1):this.d=!1,this.y-7>=hero.y+1?(this.y-=.3,this.u=!0,this.r=!1,this.d=!1,this.l=!1):this.u=!1)},this.colision=function(){this.x+7>hero.x&&this.x<hero.x+7&&this.y+10>hero.y&&this.y<hero.y+8&&0==coolDown&&2==this.state&&(zoom+=.5,coolDown=!0,setTimeout((function(){coolDown=!1}),2e3))}}function createEnemy(){var t=new enemyClass,e=arr[Math.floor(Math.random()*arr.length)];t.x=grid[e].x,t.y=grid[e].y,enemys.push(t)}function startGame(){document.getElementById("gameText0").style.color="transparent",document.getElementById("gameText0").textContent="",document.getElementById("gameText4").textContent="",document.getElementById("gameText4").style.color="transparent",ctx.fillStyle="#292634",ctx.fillRect(0,0,canvas.width,canvas.height),zoom=4,time=timeR,makeGrid(),createRooms(amount);for(var t=0;t<grid.length;t++)grid[t].carve();for(t=0;t<rooms.length;t++)rooms[t].beacons();for(createHero(),heroSpawn(),beaconPlacing(),t=0;t<grid.length;t++)grid[t].beacon();for(t=0;t<startingAmount;t++)createEnemy();interval[0]=setInterval((function(){createEnemy()}),15e3),interval[1]=setInterval((function(){for(var t=0;t<enemys.length;t++)enemys[t].rMove()}),5e3),interval[2]=setInterval((function(){step[0]=step[1],step[1]=step[2],step[2]=step[0]}),200),interval[3]=setInterval((function(){switched=0,ctx.save(),ctx.scale(zoom,zoom),ctx.translate(-hero.x+canvas.width/2/zoom,-hero.y+canvas.width/2/zoom);for(var t=0;t<grid.length;t++)grid[t].show();for(t=0;t<grid.length;t++)grid[t].detect(),grid[t].collide(),4==grid[t].type&&switched++,t==grid.length-1&&(document.getElementById("gameText2").style.color="white",document.getElementById("gameText2").textContent=switched+"/"+rooms.length+" online.",switched==rooms.length&&5==level?(wCS=!0,cutscene(),endGame()):switched==rooms.length&&(zoom=1,timeR+=10,endGame(),level++,time=timeR,amount++,rows+=10,cols+=10,setTimeout((function(){startGame()}),1e3)));for(t=0;t<rooms.length;t++)rooms[t].enemys();for(t=0;t<enemys.length;t++)enemys[t].move(),enemys[t].draw(),enemys[t].colision();(zoom>6||time<=0)&&(zoom=1,endGame(),lose=!0),hero.draw(),hero.move(),ctx.restore()}),1e3/60),interval[4]=setInterval((function(){time-=1,document.getElementById("gameText1").style.color="white",document.getElementById("gameText1").textContent=Math.floor(time)+" seconds"}),1e3),document.getElementById("gameText3").style.color="white",document.getElementById("gameText3").textContent="Level "+level}function endGame(){grid=[],w=10,rooms=[],collide=!1,size=5,sizeMin=15,corridorW=1,enemys=[],step=[0,1,0],arr=[],space=u=d=l=r=0,beacons=[],beaconSpots=[],startingAmount=6,coolDown=!1;for(var t=0;t<interval.length;t++)clearInterval(interval[t]);ctx.clearRect(0,0,canvas.width,canvas.height),document.getElementById("gameText1").style.color="transparent",document.getElementById("gameText1").textContent="",document.getElementById("gameText2").style.color="transparent",document.getElementById("gameText2").textContent="",document.getElementById("gameText3").style.color="transparent",document.getElementById("gameText3").textContent="",setTimeout((function(){ctx.clearRect(0,0,canvas.width,canvas.height)}),100)}function reset(){timeR=90,level=1,rows=80,cols=60,amount=4}function won(){1==win&&(document.getElementById("gameText0").style.fontSize="4em",document.getElementById("gameText0").textContent="You Win!",document.getElementById("gameText0").style.color="white",document.getElementById("gameText4").textContent="Click To Continue",document.getElementById("gameText4").style.color="white",document.getElementById("gameText0").style.fontSize="4em",reset(),space&&(menuOn=!0,win=!1,space=!1))}function lost(){1==lose&&(document.getElementById("gameText0").style.fontSize="4em",document.getElementById("gameText0").textContent="You lose!",document.getElementById("gameText0").style.color="white",document.getElementById("gameText4").textContent="Click To Continue",document.getElementById("gameText4").style.color="white",reset(),space&&(menuOn=!0,lose=!1,space=!1))}function menu(){1==menuOn&&(document.getElementById("gameText0").textContent="Welcome to The_Coder's Game!",document.getElementById("gameText0").style.color="white",document.getElementById("gameText4").textContent="Click To Continue",document.getElementById("gameText4").style.color="white",reset(),space&&(menuOn=!1,tut=!0,space=!1))}function tutorial(){1==tut&&0==tutA?(document.getElementById("gameText0").textContent="W/A/S/D, Z/Q/S/D, Arrow Keys to move",document.getElementById("gameText0").style.fontSize="3em",document.getElementById("gameText4").textContent="Click To Continue",document.getElementById("gameText4").style.color="white",reset(),space&&(tut=!1,space=!1,tutA=!0,sCS=!0,cutscene())):1==tut&&(tut=!1,sCS=!0,cutscene(),space=!1,reset())}function cutscene(){document.getElementById("gameText0").textContent="",document.getElementById("gameText0").style.color="transparent",document.getElementById("gameText4").textContent="",document.getElementById("gameText4").style.color="transparent";var t=-100,e=canvas.width/2-10;sCS?(setInterval((function(){t<canvas.width/2+50&&(t+=3,ctx.fillStyle="black",ctx.fillRect(0,0,canvas.width,canvas.height),ctx.beginPath(),ctx.fillStyle="#575A5E",ctx.moveTo(t,e),ctx.arcTo(t-75,e+65,t-150,e,100),ctx.lineTo(t-150,e),ctx.fill(),ctx.beginPath(),ctx.fillStyle="#7E8287",ctx.moveTo(t,e),ctx.arcTo(t-75,e-50,t-150,e,140),ctx.lineTo(t-150,e),ctx.moveTo(t,e),ctx.arcTo(t-75,e+45,t-150,e,110),ctx.lineTo(t-150,e),ctx.fill(),ctx.fillStyle="white",ctx.fillRect(t-68,e-18,20,20),ctx.fillStyle="black",ctx.fillRect(t-64,e-13,4,4),ctx.fillRect(t-56,e-13,4,4),ctx.fillStyle="white",ctx.fillRect(t-102,e-18,20,20),ctx.fillStyle="black",ctx.fillRect(t-97,e-13,4,4),ctx.fillRect(t-89,e-13,4,4),ctx.fillStyle="white",ctx.fillRect(t-85,e-15,20,20),ctx.fillStyle="black",ctx.fillRect(t-81,e-10,4,4),ctx.fillRect(t-73,e-10,4,4),ctx.beginPath(),ctx.fillStyle="#B5E2F4",ctx.globalAlpha=.5,ctx.moveTo(t-25,e-5),ctx.arcTo(t-75,-(e+45),t-125,e-5,50),ctx.lineTo(t-125,e-5),ctx.moveTo(t-25,e-5),ctx.arcTo(t-75,e+15,t-125,e-5,100),ctx.lineTo(t-125,e-5),ctx.fill(),ctx.beginPath(),ctx.lineWidth=3,ctx.strokeStyle="white",ctx.moveTo(t-80,e-40),ctx.arcTo(t-100,e-35,t-105,e-20,30),ctx.lineTo(t-105,e-20),ctx.stroke(),ctx.globalAlpha=1)}),1e3/60),setTimeout((function(){ctx.font="15px Arial",ctx.fillStyle="white",ctx.fillText("Where is he?",450,300)}),3500),setTimeout((function(){ctx.fillStyle="black",ctx.fillRect(400,250,200,50),ctx.fillStyle="white",ctx.fillText("He must have fallen out!",450,300)}),6500),setTimeout((function(){ctx.fillStyle="black",ctx.fillRect(400,250,250,50),ctx.fillStyle="white";for(var t="Lets hope he can get the beacons \n online so we can find him in time!".split("\n"),e=0;e<t.length;e++)ctx.fillText(t[e],450,300+15*e)}),9500),setTimeout((function(){startGame(),sCS=!1}),12500)):wCS&&(t=canvas.width/2+50,e=100,setTimeout((function(){ctx.beginPath(),ctx.fillStyle="#575A5E",ctx.moveTo(t,e),ctx.arcTo(t-75,e+65,t-150,e,100),ctx.lineTo(t-150,e),ctx.fill(),ctx.beginPath(),ctx.fillStyle="#7E8287",ctx.moveTo(t,e),ctx.arcTo(t-75,e-50,t-150,e,140),ctx.lineTo(t-150,e),ctx.moveTo(t,e),ctx.arcTo(t-75,e+45,t-150,e,110),ctx.lineTo(t-150,e),ctx.fill(),ctx.fillStyle="white",ctx.fillRect(t-68,e-18,20,20),ctx.fillStyle="black",ctx.fillRect(t-64,e-13,4,4),ctx.fillRect(t-56,e-13,4,4),ctx.fillStyle="white",ctx.fillRect(t-102,e-18,20,20),ctx.fillStyle="black",ctx.fillRect(t-97,e-13,4,4),ctx.fillRect(t-89,e-13,4,4),ctx.fillStyle="white",ctx.fillRect(t-85,e-15,20,20),ctx.fillStyle="black",ctx.fillRect(t-81,e-10,4,4),ctx.fillRect(t-73,e-10,4,4),ctx.beginPath(),ctx.fillStyle="#B5E2F4",ctx.globalAlpha=.5,ctx.moveTo(t-25,e-5),ctx.arcTo(t-75,-(e+45),t-125,e-5,50),ctx.lineTo(t-125,e-5),ctx.moveTo(t-25,e-5),ctx.arcTo(t-75,e+15,t-125,e-5,100),ctx.lineTo(t-125,e-5),ctx.fill(),ctx.beginPath(),ctx.lineWidth=3,ctx.strokeStyle="white",ctx.moveTo(t-80,e-40),ctx.arcTo(t-100,e-35,t-105,e-20,30),ctx.lineTo(t-105,e-20),ctx.stroke(),ctx.globalAlpha=1,ctx.fillStyle="#489551",ctx.fillRect(0,e+318,canvas.width,canvas.height),ctx.fillStyle="#6FAE53",ctx.fillRect(0,e+318,canvas.width,5),ctx.fillStyle="white",ctx.fillRect(t-100,e+300,40,40),ctx.fillStyle="black",ctx.fillRect(t-92,e+308,8,8),ctx.fillRect(t-78,e+308,8,8)}),1e3),setTimeout((function(){ctx.font="15px Arial",ctx.fillStyle="white",ctx.fillText("We found you!",450,50)}),1e3),setTimeout((function(){endGame(),wCS=!1,win=!0}),5e3))}function index(t,e){return t<0||e<0||t>cols-1||e>rows-1?-1:t+e*cols}function heroSpawn(){for(var t=0;t<grid.length;t++)1==grid[t].type&&arr.push(t);var e=arr[Math.floor(Math.random()*arr.length)];hero.x=grid[e].x,hero.y=grid[e].y}function beaconPlacing(){for(var t=0;t<rooms.length;t++)beacons[t]=beaconSpots[t][Math.floor(Math.random()*beaconSpots[t].length)]}function handleMouseClick(t){space=!0,console.log(space)}setInterval((function(){lost(),won(),menu(),tutorial()}),100),canvas.addEventListener("mousedown",handleMouseClick),onkeydown=e=>t(e,1),onkeyup=e=>t(e),t=(t,e,i,l)=>{for(l in i={u:[38,90,87],r:[39,68],d:[40,83],l:[37,65,81]})i[l].includes(t.keyCode)&&(window[l]=e)}</script><style>body,p{margin:0}#gameText1,#gameText2,#gameText3{top:1vh;font-size:2em}body{background-color:#100}#game{margin:0 auto;padding-top:0;display:block;border:3px solid #555;border-radius:3px;background-color:#292634;height:99vh}#gameText0,#gameText1,#gameText2,#gameText3,#gameText4{font-family:larger Lato,Roboto,sans-serif;font-weight:300;font-variant:small-caps;text-align:center;position:absolute;color:transparent}#gameText0{font-size:4em;top:45vh;width:100%}#gameText1{left:5%}#gameText2{left:86%}#gameText3{width:100%}#gameText4{font-size:2em;top:90vh;width:100%;color:#fff}</style>