<!doctype html><meta name=viewport content="width=device-width"><style>body,html{width:100%;height:100%;margin:0;padding:0;font-family:Helvetica Neue,Helvetica,Arial,sans-serif}body{background-color:#333;display:grid;grid-template-columns:1fr 1fr 1fr;grid-template-rows:1fr auto 1fr;grid-template-areas:". . ." ". main ." ". . ."}canvas{background:#fff;outline:1px solid #000;margin:0 auto}.t-o,canvas{grid-area:main}.t-o{align-self:center;justify-self:center;z-index:1;width:auto;max-width:80%;height:auto;padding:30px;background-color:#f6b18d;color:#323251}.t-o.hidden{display:none}.t-o h2{font-size:34px;margin-top:0}.t-o p{line-height:1.4em}.t-o .right{text-align:right}.t-o .center{text-align:center}.t-o button{background-color:#dc657b;border:0 none;width:44px;height:22px;padding:0;line-height:22px}.t-o :last-child{margin-bottom:0}</style><body><script>!function(t){function e(n){if(i[n])return i[n].exports;var r=i[n]={i:n,l:!1,exports:{}};return t[n].call(r.exports,r,r.exports,e),r.l=!0,r.exports}var i={};e.m=t,e.c=i,e.d=function(t,i,n){e.o(t,i)||Object.defineProperty(t,i,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(i,"a",i),i},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=0)}([function(t,e,i){"use strict";function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function r(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function o(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}function a(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}Object.defineProperty(e,"__esModule",{value:!0});var h={size:{grid:70,me:30},speed:{move:180},shelf:{faceSize:50,facePadding:3},palette:{base1:"#133354",base2:"#323251",high1:"#F6B18D",high2:"#DC657B",mid1:"#A86C7D"}},l=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),c=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}return l(t,[{key:"set",value:function(t){return Object.assign(this,t)}}]),t}(),u=c,f=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),d=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.h=0,t.s=0,t.l=0,t.a=1,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),f(e,[{key:"toString",value:function(){return"hsla("+this.h+","+this.s+"%,"+this.l+"%,"+this.a+")"}},{key:"lighten",value:function(t){return this.l=Math.min(100,this.l+this.l*t),this}},{key:"darken",value:function(t){return this.l=Math.max(0,this.l-this.l*t),this}},{key:"setH",value:function(t){return this.h=Math.min(255,Math.max(0,t)),this}},{key:"shiftH",value:function(t){return this.h+=t,this.h<0?this.h+=360:this.h>360&&(this.h-=360),this}},{key:"setS",value:function(t){return this.s=Math.min(100,Math.max(0,t)),this}},{key:"setL",value:function(t){return this.l=Math.min(100,Math.max(0,t)),this}},{key:"copy",value:function(){var t=new e;return t.set({h:this.h,s:this.s,l:this.l,a:this.a}),t}},{key:"setRGB",value:function(t,e,i){t/=255,e/=255,i/=255;var n,r,o=Math.max(t,e,i),a=Math.min(t,e,i),s=(o+a)/2;if(o==a)n=r=0;else{var h=o-a;switch(r=s>.5?h/(2-o-a):h/(o+a),o){case t:n=(e-i)/h+(e<i?6:0);break;case e:n=(i-t)/h+2;break;case i:n=(t-e)/h+4}n/=6}this.h=parseInt((360*n).toFixed(0),10),this.s=parseInt((100*r).toFixed(6),10),this.l=parseInt((100*s).toFixed(6),10)}},{key:"toRGB",value:function(){var t=0,e=0,i=0,n=this.h/360,r=this.l/100,o=this.s/100;if(0==o)t=e=i=r;else{var a=function(t,e,i){return i<0&&(i+=1),i>1&&(i-=1),i<1/6?t+6*(e-t)*i:i<.5?e:i<2/3?t+(e-t)*(2/3-i)*6:t},s=r<.5?r*(1+o):r+o-r*o,h=2*r-s;t=a(h,s,n+1/3),e=a(h,s,n),i=a(h,s,n-1/3)}return[255*t,255*e,255*i]}}],[{key:"hsla",value:function(t,i,n,r){var o=new e;return o.set({h:t,s:i,l:n,a:r}),o}},{key:"fromHex",value:function(t){var i=t.match(/^#([0-9a-fA-F]{2})([0-9a-fA-F]{2})([0-9a-fA-F]{2})$/),n=parseInt(i[1],16),r=parseInt(i[2],16),o=parseInt(i[3],16);return e.fromRGB(n,r,o)}},{key:"fromRGB",value:function(t,i,n){var r=new e;return r.setRGB(t,i,n),r}}]),e}(u),y=d,p=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),g={},w=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.m_w=e,this.m_z=987654321-e,this.mask=4294967295,this.next()}return p(t,[{key:"next",value:function(){this.m_z=36969*(65535&this.m_z)+(this.m_z>>16)&this.mask,this.m_w=18e3*(65535&this.m_w)+(this.m_w>>16)&this.mask;var t=(this.m_z<<16)+this.m_w&this.mask;return.5+(t/=4294967296)}},{key:"pick",value:function(t){return t[Math.floor(this.next()*t.length)]}},{key:"bool",value:function(){return this.next()>.5}},{key:"color",value:function(){return y.fromRGB(Math.floor(256*this.next()),Math.floor(256*this.next()),Math.floor(256*this.next()))}}],[{key:"set",value:function(e,i){g.hasOwnProperty(e)&&delete g[e],g[e]=new t(i)}},{key:"get",value:function(t){return g[t]}}]),t}(),v=w,b=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),m=(i(1)(0),function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.dt=0,this.play=!1,this.count=0,this.showStats=!1,this.lastTime=this.timestamp(),this.worker=function(){}}return b(t,[{key:"start",value:function(t){return this.play=!0,this.worker=t,this.raf()}},{key:"stop",value:function(){this.play=!1}},{key:"tick",value:function(t){this.count=(this.count+1)%600,this.worker(t),this.play&&this.raf()}},{key:"timestamp",value:function(){return window.performance.now()}},{key:"raf",value:function(){var t=this;return window.requestAnimationFrame((function(){var e=t.timestamp(),i=e-t.lastTime;i>999?i=1/60:i/=1e3,t.dt=i,t.lastTime=e,t.tick(i)}))}}]),t}()),x=m,k=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),O=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.up=!1,this.down=!1,this.left=!1,this.right=!1,this.bindings={up:[38,90,87],down:[40,83],left:[37,65,81],right:[39,68]},this.bindEvents(),this.listeners=[]}return k(t,[{key:"on",value:function(t,e){this.listeners.unshift({keys:t,callback:e})}},{key:"updateKeyState",value:function(t,e){for(var i in this.bindings)if(this.bindings[i].includes(t))return void(this[i]=e);if(e&&this.listeners.length){var n=!1;this.listeners=this.listeners.filter((function(e){return!e.keys.includes(t)||(n||(n=e.callback),!1)})),n&&n()}}},{key:"bindEvents",value:function(){var t=this;onkeydown=function(e){return t.updateKeyState(e.keyCode,!0)},onkeyup=function(e){return t.updateKeyState(e.keyCode,!1)},onblur=function(e){return t.up=t.down=t.left=t.right=!1}}}]),t}();O.SPACE=32,O.ESC=27,O.ENTER=13;var S=O,_=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),P=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.width=640,this.height=480,this.autoClear=!0,this.scene=null,this.node=this._createCanvas(),this.ctx=this.node.getContext("2d")}return _(t,[{key:"appendTo",value:function(t){t.appendChild(this.node)}},{key:"setScene",value:function(t){return this.scene=t,this}},{key:"draw",value:function(){var t=this;this.autoClear&&this.clear(),this.scene.children.forEach((function(e){e&&e.visible&&(t.ctx.save(),e.draw(t.ctx),t.ctx.restore())}))}},{key:"clear",value:function(){this.ctx.clearRect(0,0,this.ctx.canvas.width,this.ctx.canvas.height)}},{key:"_createCanvas",value:function(){var t=document.createElement("canvas");return t.width=this.width,t.height=this.height,t}}]),t}(),j=P,T=function t(e,i,n){null===e&&(e=Function.prototype);var r=Object.getOwnPropertyDescriptor(e,i);if(void 0===r){var o=Object.getPrototypeOf(e);return null===o?void 0:t(o,i,n)}if("value"in r)return r.value;var a=r.get;return void 0!==a?a.call(n):void 0},M=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),C=function(t){function e(){n(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.color="#999",t.radius=3,t.opacity=1,t.lineColor="#999",t.lineWidth=0,t}return o(e,t),e}(u),A=function(t){function e(){n(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.x=0,t.y=0,t.width=1,t.height=1,t.visible=!0,t.style=new C,t.parent=null,t}return o(e,t),M(e,[{key:"draw",value:function(){}},{key:"intersects",value:function(t){return this.x<t.x+t.width&&this.x+this.width>t.x&&this.y<t.y+t.height&&this.height+this.y>t.y}},{key:"collisionResponseImpulse",value:function(t){var e={x:0,y:0};return this.y>t.y?e.y=t.y+t.height-this.y:e.y=-1*(this.y+this.height-t.y),this.x>t.x?e.x=t.x+t.width-this.x:e.x=-1*(this.x+this.width-t.x),Math.abs(e.x)>Math.abs(e.y)?e.x=0:e.y=0,e}},{key:"addTo",value:function(t){t.addChild(this)}},{key:"setStyle",value:function(t){return this.style.set(t),this}},{key:"getImageData",value:function(){var t=document.createElement("canvas");t.width=this.width,t.height=this.height;var e=t.getContext("2d");return this.draw(e),e.getImageData(0,0,this.width,this.height)}},{key:"cache",value:function(){var t=this.getImageData();this.draw=function(e){e.putImageData(t,this.parent.x,this.parent.y)}}},{key:"absX",get:function(){return this.x+(this.parent?this.parent.absX:0)}},{key:"absY",get:function(){return this.y+(this.parent?this.parent.absY:0)}}]),e}(u),E=(function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}o(e,t),M(e,[{key:"draw",value:function(t){return t.fillStyle=this.style.color,t.globalAlpha=this.style.opacity,t.beginPath(),t.arc(this.x,this.y,this.style.radius,0,2*Math.PI,!0),t.closePath(),t.fill(),this}}])}(A),function(t){function e(){return n(this,e),r(this,(e.__proto__||Object.getPrototypeOf(e)).apply(this,arguments))}return o(e,t),M(e,[{key:"draw",value:function(t){return t.fillStyle=this.style.color,t.globalAlpha=this.style.opacity,t.fillRect(this.x,this.y,this.width,this.height),this.style.lineWidth&&(t.lineWidth=this.style.lineWidth,t.strokeStyle=this.style.lineColor,t.strokeRect(this.x,this.y,this.width,this.height)),this}}]),e}(A)),z=function(t){function e(){n(this,e);var t=r(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.children=[],t}return o(e,t),M(e,[{key:"addChild",value:function(t){this.children.indexOf(t)>=0||(this.children.push(t),t.parent=this)}},{key:"removeChild",value:function(t){var e=this.children.indexOf(t);return!(e<0||(this.children.splice(e,1),0))}},{key:"draw",value:function(t){this.visible&&T(e.prototype.__proto__||Object.getPrototypeOf(e.prototype),"draw",this).call(this,t),this.drawChildren(t)}},{key:"drawChildren",value:function(t){t.save(),t.translate(this.x,this.y);for(var e=0;e<this.children.length;e++)t.save(),this.children[e].draw(t),t.restore();t.restore()}}]),e}(E),R=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),H=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.direction={x:"",y:""},t.width=ut.config.size.me;var i=t.width/20*26;return t.drawHeight=Math.ceil(i),t.height=Math.ceil(.1*i),t.x=ut.config.size.grid,t.y=ut.config.size.grid,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),R(e,[{key:"draw",value:function(t){t.mozImageSmoothingEnabled=!1,t.webkitImageSmoothingEnabled=!1,t.msImageSmoothingEnabled=!1,t.imageSmoothingEnabled=!1;var e=(this.width,"u"==this.direction.y?"back":"front"),i=Math.round(Math.abs(ut.loop.count%100-50)/100*this.drawHeight*.3);"r"==this.direction.x?(t.scale(-1,1),ut.sprites.ghost.draw(e,t,-1*this.x-this.width,this.y-Math.round(this.drawHeight-this.height)-i,this.width,this.drawHeight)):ut.sprites.ghost.draw(e,t,this.x,this.y-Math.round(this.drawHeight-this.height)-i,this.width,this.drawHeight)}},{key:"move",value:function(){ut.io.left?(this.x-=ut.config.speed.move*ut.loop.dt,this.direction.x="l"):ut.io.right?(this.x+=ut.config.speed.move*ut.loop.dt,this.direction.x="r"):this.direction.x="",ut.io.up?(this.y-=ut.config.speed.move*ut.loop.dt,this.direction.y="u"):ut.io.down?(this.y+=ut.config.speed.move*ut.loop.dt,this.direction.y="d"):this.direction.y=""}}]),e}(E),B=H,N=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),L=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));t.direction=0,t.width=ut.config.size.me;var i=t.width/21*34;return t.drawHeight=Math.ceil(i),t.height=Math.ceil(.1*i),t.x=ut.config.size.grid,t.y=ut.config.size.grid,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),N(e,[{key:"draw",value:function(t){var e=Math.round(Math.abs((ut.loop.count+50)%100-50)/100*this.drawHeight*.3);ut.sprites.ghost.draw("mom",t,this.x,this.y-Math.round(this.drawHeight-this.height)-e,this.width,this.drawHeight)}}]),e}(E),I=L,F=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.collidable=!0,t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),e}(z),D=F,J=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),W=function(t){function e(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this))}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),J(e,[{key:"draw",value:function(t){var e=ut.config.shelf.faceSize,i=y.fromHex(ut.config.palette.base2);return this.drawShadow(t,{x:14,y:e/2}),t.fillStyle=i.toString(),t.globalAlpha=1,t.fillRect(this.x,this.y,this.width,this.height),this.drawSides(t,e,i.copy()),t.fillStyle=i.darken(.2).toString(),t.fillRect(this.x,this.y,this.width,this.height-e),this}},{key:"drawShadow",value:function(t,e){t.fillStyle="#000",t.globalAlpha=.2,t.beginPath(),t.moveTo(this.x,this.y),t.lineTo(this.x+e.x,this.y+e.y),t.lineTo(this.x+e.x+this.width,this.y+e.y),t.lineTo(this.x+e.x+this.width,this.y+this.height-e.y),t.lineTo(this.x+this.width,this.y+this.height),t.fill()}},{key:"drawSides",value:function(t,e,i){for(var n=ut.config.shelf.facePadding,r=function(t,e,i,r,o,a){e=e.copy(),t.fillStyle=e.toString(),t.fillRect(i,r,o,a),t.fillStyle=e.copy().lighten(.3).shiftH(20).toString(),t.fillRect(i+n,r+n,o-2*n,a-2*n),t.fillStyle=e.copy().lighten(.5).shiftH(40).toString(),t.fillRect(i+n+n,r+n+n,o-2*n*2,a-2*n*2);var s=ut.prngs.pcg.pick(Object.keys(ut.sprites.items.areas)),h=Math.min(30,Math.round(.9*(o-4*n))),l=Math.round(ut.prngs.pcg.next()*(o-h-2*n*2)),c=Math.pow(1-h/o,2);ut.prngs.pcg.next()<c&&(t.imageSmoothingEnabled=!1,t.globalCompositeOperation="luminosity",ut.sprites.items.drawToFit(s,t,i+n+n+l,r+a-n-20-1,h,20),t.globalCompositeOperation="source-over")},o=ut.prngs.pcg.pick([2,3]),a=this.width>=this.height,s=o;s>=1;s--){var h=Math.round(e*(s/o));if(a)r(t,i,this.x,this.y+this.height-e,this.width,h);else{var l=Math.round(this.width/2)-10;r(t,i,this.x,this.y+this.height-e,l,h),r(t,i,this.x+this.width-l,this.y+this.height-e,l,h)}}}}]),e}(D),q=W,G=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),K=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.data=[],this.width=0,this.height=0}return G(t,[{key:"resize",value:function(t,e){this.width=t,this.height=e,this.fill(0,0,t,e,0)}},{key:"set",value:function(t,e,i){this.data[this.width*e+t]=i}},{key:"get",value:function(t,e){return this.data[this.width*e+t]}},{key:"fill",value:function(t,e,i,n,r){for(var o=t;o<i;o++)for(var a=e;a<n;a++)this.data[this.width*a+o]=r}},{key:"fillRow",value:function(t,e){for(var i=0;i<this.width;i++)this.data[this.width*t+i]=e}},{key:"fillCol",value:function(t,e){for(var i=0;i<this.height;i++)this.data[this.width*i+t]=e}},{key:"toString",value:function(){for(var t="",e=0;e<this.height;e++){for(var i=0;i<this.width;i++)t+=this.data[this.width*e+i]+"\t";t+="\n"}return t}},{key:"each",value:function(t){for(var e=0;e<this.width;e++)for(var i=0;i<this.height;i++)t(e,i,this.data[this.width*i+e])}},{key:"filter",value:function(t){for(var e=[],i=0;i<this.width;i++)for(var n=0;n<this.height;n++)this.data[this.width*n+i]==t&&e.push({x:i,y:n});return e}},{key:"overlayWith",value:function(t,e,i,n){for(var r=0;r<t.width;r++)for(var o=0;o<t.height;o++)t.get(r,o)&&(this.data[this.width*(o+i)+(r+e)]=n)}}],[{key:"outsideRadius",value:function(t,e,i){for(var n=[],r=0;r<t.length;r++)Math.abs(t[r].x-e.x)+Math.abs(t[r].y-e.y)>i&&n.push(t[r]);return n}}]),t}(),Y=K,X=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),Z=function(){function t(e){a(this,t),this.difficulty=e,this.width=6+4*this.difficulty,this.height=6+4*this.difficulty,this.tiles=new Y,this.drawable=(new z).set({width:this.width*ut.config.size.grid,height:this.height*ut.config.size.grid,visible:!1}),this.generateSections(),this.constructTiles(),this.createDrawables()}return X(t,[{key:"placePeople",value:function(t,e){var i=this.tiles.filter(0),n=ut.prngs.pcg.pick(i),r=Y.outsideRadius(i,n,Math.round(Math.max(this.width-2,this.height-2)/1.5)),o=ut.prngs.pcg.pick(r);t.x=n.x*ut.config.size.grid,t.y=n.y*ut.config.size.grid,e.x=o.x*ut.config.size.grid,e.y=o.y*ut.config.size.grid}},{key:"createDrawables",value:function(){var t=this;this.createFloorDrawable(),this.createBorderDrawables(),this.tiles.each((function(e,i,n){if(n&&99!=n){for(var r={right:1,bottom:1};t.tiles.get(e+r.right,i);)r.right++;for(;t.tiles.get(e,i+r.bottom);)r.bottom++;t.tiles.fill(e,i,e+r.right,i+r.bottom,99),t.tiles.set(e,i,n);var o=(new q).set({x:e*ut.config.size.grid,y:i*ut.config.size.grid,width:(1+r.right-1)*ut.config.size.grid,height:(1+r.bottom-1)*ut.config.size.grid}).setStyle({color:t.sections[n].color});t.drawable.addChild(o)}})),this.drawable.cache()}},{key:"createFloorDrawable",value:function(){var t=y.fromHex(ut.config.palette.base1).darken(.2),e=Math.round(ut.config.size.grid/4),i=Math.round(ut.config.size.grid/4),n=document.createElement("canvas"),r=n.getContext("2d");n.width=e,n.height=i,r.fillStyle=t.copy().lighten(.1).toString(),r.fillRect(0,0,e,i),r.fillStyle=t.copy().darken(.25).toString(),r.fillRect(1,1,e,i),r.fillStyle=t.copy().toString(),r.fillRect(2,2,e-2,i-2);var o=(new A).set({x:0,y:0,width:this.width*ut.config.size.grid,height:this.height*ut.config.size.grid});return o.draw=function(t){t.fillStyle=t.createPattern(n,"repeat"),t.globalAlpha=o.style.opacity,t.fillRect(o.x,o.y,o.width,o.height)},this.drawable.addChild(o),o}},{key:"createBorderDrawables",value:function(){var t=y.fromHex(ut.config.palette.base2).darken(.5).toString();this.drawable.addChild((new D).set({x:0,y:0,width:this.width*ut.config.size.grid,height:1*ut.config.size.grid}).setStyle({color:t})),this.drawable.addChild((new D).set({x:0,y:(this.height-1)*ut.config.size.grid,width:this.width*ut.config.size.grid,height:1*ut.config.size.grid}).setStyle({color:t})),this.drawable.addChild((new D).set({x:0,y:1*ut.config.size.grid,width:1*ut.config.size.grid,height:(this.height-2)*ut.config.size.grid}).setStyle({color:t})),this.drawable.addChild((new D).set({x:(this.width-1)*ut.config.size.grid,y:1*ut.config.size.grid,width:1*ut.config.size.grid,height:(this.height-2)*ut.config.size.grid}).setStyle({color:t}))}},{key:"constructTiles",value:function(){var t=this;this.tiles.resize(this.width,this.height),this.tiles.fillRow(0,99),this.tiles.fillRow(this.width-1,99),this.tiles.fillCol(0,99),this.tiles.fillCol(this.height-1,99),this.sections.forEach((function(e,i){return t.tiles.overlayWith(e.getTiles(),e.x,e.y,i)}))}},{key:"generateSections",value:function(){this.sections=[],this.sections[1]=(new V).set({x:2,y:2,w:this.width-4,h:this.height-4,color:ut.prngs.pcg.color()});for(var t=!0;t;){t=!1;for(var e=1;e<this.sections.length;e++){var i=this.sections[e].divide();i&&(t=!0,this.sections.push(i))}}return this.sections}}]),t}(),U=Z,V=function(t){function e(){a(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.x=0,t.y=0,t.w=0,t.h=0,t.color="#dad",t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),X(e,[{key:"getTiles",value:function(){if(this.hasOwnProperty("tiles"))return this.tiles;this.tiles=new Y,this.tiles.resize(this.w,this.h);var t=this.w>this.h,e=Math.round(ut.prngs.pcg.next()),i=Math.round(ut.prngs.pcg.next())+2;t&&this.w%2==1?e=0:t||this.h%2!=1||(e=0);for(var n=this.x;n<this.xMax;n++)for(var r=this.y;r<this.yMax;r++){(t?(this.xMax-n+e)%i:(this.yMax-r+e)%i)&&this.tiles.set(n-this.x,r-this.y,1)}return this.tiles}},{key:"divide",value:function(){if(this.area<24)return!1;var t=this.w>this.h?["x","w"]:["y","h"],i=Math.round(this[t[1]]*(.5+.2*(ut.prngs.pcg.next()-.5))),n=(new e).set({x:this.x,y:this.y,w:this.w,h:this.h});return n.color=ut.prngs.pcg.color(),n[t[0]]+=i,n[t[1]]-=i,this[t[1]]=i-1,n}},{key:"area",get:function(){return this.w*this.h}},{key:"xMax",get:function(){return this.x+this.w}},{key:"yMax",get:function(){return this.y+this.h}}]),e}(u),Q=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),$=function(t){function e(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return i.difficulty=t,i.scene=(new z).set({width:ut.canvas.width,height:ut.canvas.height}),i.store=new U(t),i.player=new B,i.mom=new I,i.container=(new z).set({width:i.store.width*ut.config.size.grid,height:i.store.height*ut.config.size.grid}).setStyle({color:"#ccc"}),i.store.placePeople(i.player,i.mom),i.container.set({x:Math.round(ut.canvas.width/2-i.container.width/2),y:Math.round(ut.canvas.height/2-i.container.height/2)}),i.container.addChild(i.store.drawable),i.container.addChild(i.player),i.container.addChild(i.mom),i.container.addTo(i.scene),i}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),Q(e,[{key:"loopHandler",value:function(t){this.player.move();for(var e=this.store.drawable.children,i=0;i<e.length;i++)if(e[i].collidable&&this.player.intersects(e[i])){var n=this.player.collisionResponseImpulse(e[i]);this.player.x+=n.x,this.player.y+=n.y}if(this.player.intersects(this.mom))return ut.canvas.draw(),void this.onLevelEnd();var r=Math.round(this.player.absX),o=Math.round(this.player.absY);r<ut.cameraBoundry.left?this.container.x+=ut.cameraBoundry.left-r:r>ut.cameraBoundry.right&&(this.container.x-=r-ut.cameraBoundry.right),o<ut.cameraBoundry.top?this.container.y+=ut.cameraBoundry.top-o:o>ut.cameraBoundry.bottom&&(this.container.y-=o-ut.cameraBoundry.bottom),ut.canvas.draw()}}]),e}(u),tt=$,et=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),it=!1,nt=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.node=document.createElement("div"),this.node.classList.add("t-o"),this.node.innerHTML="{{placeholder}}",this.onNextCallback=function(){}}return et(t,[{key:"setText",value:function(t){this.node.innerHTML=t}},{key:"addNext",value:function(t){var e=this;this.node.innerHTML=this.node.innerHTML+'<p class="right"><button>&raquo;</button></p>',it||(it=!0,this.node.innerHTML=this.node.innerHTML+'<p class="right"><small>Press <strong>esc</strong>, <strong>space</strong>, or <strong>enter</strong> to continue</small></p>'),this.onNextCallback=t;var i=function(){e.hide(),t(e)};this.node.querySelector("button").addEventListener("click",(function(){return i()})),ut.io.on([S.SPACE,S.ESC,S.ENTER],(function(){return i()}))}},{key:"show",value:function(){document.body.appendChild(this.node)}},{key:"hide",value:function(){this.node.classList.add("hidden"),setTimeout((function(){}),500)}}],[{key:"display",value:function(e){var i=new t;return i.setText(e),i.show(),i}}]),t}(),rt=nt,ot=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),at=function(t){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e);var t=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(e.__proto__||Object.getPrototypeOf(e)).call(this));return t.img=!1,t.areas={},t}return function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(e,t),ot(e,[{key:"load",value:function(t,e){var i=this;return this.img=new Image,this.img.addEventListener("load",(function(){return i.process(e)}),!1),this.img.src=t,this}},{key:"process",value:function(t){var e=this;Object.keys(t).forEach((function(i){var n=t[i],r=document.createElement("canvas"),o=r.getContext("2d");r.width=n.w,r.height=n.h,o.drawImage(e.img,n.x,n.y,n.w,n.h,0,0,n.w,n.h),e.areas[i]={width:n.w,height:n.h,canvas:r}}))}},{key:"get",value:function(t){return this.areas[t]}},{key:"drawToHeight",value:function(t,e,i,n,r){var o=this.areas[t],a=r/o.height*o.width;this.draw(t,e,i,n,a,r)}},{key:"drawToFit",value:function(t,e,i,n,r,o){var a=this.areas[t],s=r,h=s/a.width*a.height;h>o&&(s=(h=o)/a.height*a.width),this.draw(t,e,i,n,s,h)}},{key:"draw",value:function(t,e,i,n,r,o){var a=this.areas[t];a&&e.drawImage(a.canvas,0,0,a.width,a.height,i,n,r,o)}}]),e}(u),st=at,ht=function(){function t(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),lt=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.config=h,this.prngs={},this.sprites={},this.canvas=null,this.scene=null,this.levelNumber=1,this.level=null,this.howtoShown=!1}return ht(t,[{key:"init",value:function(){this.initCanvas(),this.initPrngs(),this.initLoop(),this.initIO(),this.initSprites()}},{key:"playIntro",value:function(){var t=this;rt.display('<h2 class="center">Ghost Goes Lost</h2><p class="center"> Siyan Panayotov &middot; js13kGames 2017</p>').addNext((function(){rt.display("<p>Charlie is a 7 year old ghost.</p>").addNext((function(){rt.display("<p>He likes haunting vacated supermarkets<br>with his shopaholic mother.</p>").addNext((function(){rt.display("<p>Too slow to glide around after her<br>he is now lost.</p>").addNext((function(){rt.display("<p>Help Charlie find his mom!</p>").addNext((function(){t.playLevel(t.levelNumber)}))}))}))}))}))}},{key:"showHowTo",value:function(t){return this.howtoShown?(setTimeout((function(){return t()}),1),this):(this.howtoShown=!0,rt.display("<p>Glide with <strong>wasd</strong>, <strong>zqsd</strong>, or <strong>arrow</strong> keys</p>").addNext(t),this)}},{key:"nextLevel",value:function(){var t=this;5==this.levelNumber?rt.display("<h3>Charlie thanks you for your help</h3>").addNext((function(){rt.display("<h3>Game's over</h3><p>But you can still help lost Charlie in the afterlife!</p>").addNext((function(){rt.display("<p><strong>Play for eternity</strong></p>").addNext((function(){t.playLevel(t.levelNumber+1)}))}))})):this.playLevel(this.levelNumber+1)}},{key:"playLevel",value:function(t){var e=this;this.levelNumber=t,this.playStory((function(){var t=(new Date).getTime();e.level=new tt(e.levelNumber),e.level.onLevelEnd=function(){ct.loop.stop();var i=(new Date).getTime();rt.display("<p>Charlie was lost for <strong>"+Math.ceil((i-t)/1e3)+" seconds</strong>, but<br> <strong>you saved him!</strong></p><p>For now.</p><p>A few years would pass<br>before he finds himself alone again.</p>").addNext((function(){return e.nextLevel()}))},e.canvas.setScene(e.level.scene),e.loop.start((function(t){return e.level.loopHandler(t)}))}))}},{key:"playStory",value:function(t){var e=this,i=function(t){var e=function(t){return ut.prngs.story.pick(t)},i=["fresh dust around the aisle","premium ghost sheets","a fancy hat","frozen ghost meal","her husband Gary at the Spirits section"],n=(e(["","One summer","One fall","","One spring","","","A rainy","A stormy","","That boring","","An average"])+" "+e(["","","Monday","Tuesday","Wednesday","","Thursday","Friday","Saturday","Sunday"])+" "+e(["afternoon","night","morning"])).trim(),r=1985+3*t+e([1,2,3]),o="Charlie's mom went looking for<br>"+i[t-1]+".";return t>i.length&&(o=""),{title:"%day%, %year%".replace("%day%",n).replace("%year%",r),text:o}}(this.levelNumber);rt.display("<h3>"+i.title+"</h3><p>"+i.text+"</p>").addNext((function(){e.showHowTo(t)}))}},{key:"initCanvas",value:function(){this.canvas=new j,this.scene=(new z).set({width:this.canvas.width,height:this.canvas.height});var t=y.fromHex(this.config.palette.base1).darken(.7).toString();this.canvas.node.style.backgroundColor=t,document.body.style.backgroundColor=t,this.canvas.setScene(this.scene),this.canvas.appendTo(document.body),this.cameraBoundry={left:Math.round(.35*this.canvas.width),bottom:this.canvas.height-Math.round(.35*this.canvas.height),right:this.canvas.width-Math.round(.35*this.canvas.width),top:Math.round(.35*this.canvas.height)}}},{key:"initIO",value:function(){this.io=new S}},{key:"initLoop",value:function(){this.loop=new x}},{key:"initPrngs",value:function(){this.prngs.pcg=new v(822505),this.prngs.story=new v(3829),console.log("PCG seed: ",822505)}},{key:"initSprites",value:function(){var t;this.sprites.ghost=(new st).load("data:image/gif;base64,R0lGODlhPQAiAKEBAJ5yVfaxjfaxjfaxjSH5BAEKAAIALAAAAAA9ACIAAALilB+pce2y1JsxTlPtzetC3j1g6IySaJ5ImpQs07zqlwCLTWJvLKs3HgAAYSsWLyhM1pLCls54TB2HOKqTJo2aisGu1QZ8KpoVFxSLHC6H4q47hx5xezCZORuPqDvkSp+YBzKn90bIsTe4lWgE0JjRGLbIoWUXmHGnOAcpJ6lBOTlV9dj4eYkpWAK05xhUWnYKGrU6hpLpCnczAkBx1pnzsruBdztTKcxZi2pp6jFMXLfj4Qv4vOwp3XadXBaNjek993wFTl4+TW2eLt2t3s7b6x6frSwvz14f74yfT79fz9ygAAA7",{front:{x:0,y:0,w:20,h:26},back:{x:20,y:0,w:20,h:26},mom:{x:40,y:0,w:21,h:34}}),this.sprites.items=(new st).load("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACMAAAAWCAMAAAB9sNV1AAAA0lBMVEUAAADm20U5NhHLiEf////VMBcYMwaYTSREzZgwZgwzImYhZktzbSJqGAtgFQpNMpnVn2tFhOaOcOZnRM1HR0fPxT5NtTyrJhEiURvNzc1mZmY9PT3dsomAgIBzc3MiQnNHOHMymnKibDgmWh55PR1xWbiZmZlILo9ZWVmIHg4mUQm6urqXzbhcSJVWQ4uXTCRcWBtqnOvm5uaPj49NPX04JXBFozYzMzM3gitjOCFnYh/MzMyysrJ6nWNQUFDmXEVZhDy6sTiUSyNlYB4xHBBWEwlz9yd9AAAAAXRSTlMAQObYZgAAAXBJREFUKM99z+tWgkAUhuEPBpgKByEBlYOFoWaa2vl8rvu/pfaeCfrj8l3Lf48fewBkWQacXx9Tq9UKkFKiLY5jJsPhMMP15FB3DlkUY0lpQeVEnskssuPJZKLNpxDhuCjEWK7XyPM4J+NXy+Wy8nFgwlqIccG/UAiJzRdAZq+qqj1/1jN1ZSiaQonHj402nH/T5Xq9mRShjkhY4zGxNq056Bo0gxRNNTC4TQdshtqYbmaA1NV1DTJpegJCTGA3waSCANRJmqYDRr4P2J3E4hJGSqm+25h7Nt63Rybp/GVDua7bd5Uxt8Y8sLE6VjNEaM4zGg2Y/BuHsiwyCNQPqFFZjqDJ/v6Z1+6wUWruzpXCiP5zOTKEkdnRhr7E97iqnE6nV6U2L4Q8O2l3AgKMgtKheOcouoii6Kh5fJLYgSb9Ppm3qXPKxnEihwzsJqhAZ+4h0+5s6fTqabF41fe88z1bTZ7f3cVs+Fn0+J151G7yC0hNJKirD/bzAAAAAElFTkSuQmCC",(s(t={can:{x:0,y:0,w:7,h:10},box1:{x:7,y:0,w:9,h:8},bread:{x:16,y:0,w:13,h:8},spray:{x:29,y:0,w:6,h:12}},"can",{x:0,y:10,w:7,h:12}),s(t,"box2",{x:7,y:8,w:11,h:10}),s(t,"bag",{x:18,y:8,w:9,h:10}),s(t,"cigs",{x:27,y:12,w:6,h:8}),t))}}]),t}(),ct=new lt,ut=ct;ut.init(),ut.playIntro();var ft=i(2);i.n(ft)},function(t,e,i){t.exports=function(){var t=function(){function e(t){return r.appendChild(t.dom),t}function i(t){for(var e=0;e<r.children.length;e++)r.children[e].style.display=e===t?"block":"none";n=t}var n=0,r=document.createElement("div");r.style.cssText="position:fixed;top:0;left:0;cursor:pointer;opacity:0.9;z-index:10000",r.addEventListener("click",(function(t){t.preventDefault(),i(++n%r.children.length)}),!1);var o=(performance||Date).now(),a=o,s=0,h=e(new t.Panel("FPS","#0ff","#002")),l=e(new t.Panel("MS","#0f0","#020"));if(self.performance&&self.performance.memory)var c=e(new t.Panel("MB","#f08","#201"));return i(0),{REVISION:16,dom:r,addPanel:e,showPanel:i,begin:function(){o=(performance||Date).now()},end:function(){s++;var t=(performance||Date).now();if(l.update(t-o,200),t>a+1e3&&(h.update(1e3*s/(t-a),100),a=t,s=0,c)){var e=performance.memory;c.update(e.usedJSHeapSize/1048576,e.jsHeapSizeLimit/1048576)}return t},update:function(){o=this.end()},domElement:r,setMode:i}};return t.Panel=function(t,e,i){var n=1/0,r=0,o=Math.round,a=o(window.devicePixelRatio||1),s=80*a,h=48*a,l=3*a,c=2*a,u=3*a,f=15*a,d=74*a,y=30*a,p=document.createElement("canvas");p.width=s,p.height=h,p.style.cssText="width:80px;height:48px";var g=p.getContext("2d");return g.font="bold "+9*a+"px Helvetica,Arial,sans-serif",g.textBaseline="top",g.fillStyle=i,g.fillRect(0,0,s,h),g.fillStyle=e,g.fillText(t,l,c),g.fillRect(u,f,d,y),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(u,f,d,y),{dom:p,update:function(h,w){n=Math.min(n,h),r=Math.max(r,h),g.fillStyle=i,g.globalAlpha=1,g.fillRect(0,0,s,f),g.fillStyle=e,g.fillText(o(h)+" "+t+" ("+o(n)+"-"+o(r)+")",l,c),g.drawImage(p,u+a,f,d-a,y,u,f,d-a,y),g.fillRect(u+d-a,f,a,y),g.fillStyle=i,g.globalAlpha=.9,g.fillRect(u+d-a,f,a,o((1-h/w)*y))}}},t}()},function(t,e){}])</script>