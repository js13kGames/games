<!doctype html><meta name=viewport content="width=device-width"><title>Clawdia - js13kGames 2025</title><style>body{margin:0;font-family:Chiller,Times New Roman,Times,serif}.text{font-size:150px;font-weight:700;margin:0 auto;padding:10px;width:50%;text-align:center;position:absolute;top:25%;left:50%;transform:translate(-50%,-50%)}.box{width:100%;display:flex;justify-content:space-around;align-items:flex-end;position:absolute;top:85%}.util{position:absolute;top:0;right:0;margin:1%;display:flex;flex-direction:column;gap:5px}.button,.buttonClose{border:2px solid #111118;padding:8px 12px;text-align:center;font-size:25px;cursor:pointer;background:#6d6e80;color:#e9dcc9;font:inherit;z-index:1;transition:.4s}.button:hover,.buttonClose:hover{background:#9595cb;color:#741290}.popUpClass{visibility:hidden;border:2px solid #111118;background:#e9dcc9;padding:10px;width:50%;height:60%;position:absolute;top:40%;left:50%;transform:translate(-50%,-50%);z-index:2;line-height:150%}.popUpClass p{font-size:30px}</style><script type=module>var e=Object.defineProperty,t=(t,i,o)=>((t,i,o)=>i in t?e(t,i,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[i]=o)(t,"symbol"!=typeof i?i+"":i,o);import*as i from"/2025/webxr/three.js";function o(e,t){const o=document.createElement("canvas"),s=o.getContext("2d",{willReadFrequently:!0});let n=null;s.font="normal 100px "+t,n=s.measureText(e);const r=n.width;o.width=r,o.height=100,o.border="10px solid blue",s.font="normal 75px "+t,s.textAlign="center",s.textBaseline="middle",s.fillText(e,r/2,50);const a=new i.Texture(o);a.needsUpdate=!0;const l=new i.MeshStandardMaterial({map:a,transparent:!0}),c=new i.PlaneGeometry(.125*r/100,.125);return new i.Mesh(c,l)}function s(e,t){const i=e.material.map,o=e.material.map.image,s=o.getContext("2d");s.clearRect(0,0,o.width,o.height),s.textAlign="center",s.textBaseline="middle",s.fillText(t,o.width/2,o.height/2),i.needsUpdate=!0}function n(e,t,i){const o=[];for(let s=0;s<e.children.length;s++){const i=e.children[s];i.name===t&&o.push(i)}for(const s of o)e.remove(s);i.length=0}let r,a;class l{constructor(){this.zombieMesh=null,this.trackPlayer=this.trackPlayer.bind(this),this.zombieMap=new Map,this.zombRep=null}createZombie(){this.zombieMesh=new i.Sprite(r),this.zombieMesh.scale.set(2,2,1),this.zombieMesh.name="zombie",v.scene.add(this.zombieMesh);const e=new i.SphereGeometry(.01,32,16),t=new i.MeshBasicMaterial({color:"maroon"});this.zombRep=new i.Mesh(e,t),this.zombRep.name="zombReplica",x.zombReplicArr.push(this.zombRep),x.paper.add(this.zombRep),this.zombieMap.set(this.zombieMesh,this.zombRep)}trackPlayer(e,t){const o=new i.Vector3;o.subVectors(D.dolly.position,t.zombieMesh.position),o.normalize(),o.multiplyScalar(9*e),this.zombieMesh.position.add(o)}}function c(e,t){clearInterval(b.zombieSoundIntervalId),b.playDeadZombie(),e.zombieMesh.material=a,e.zombieMesh.material.map.needsUpdate=!0,e.zombieMesh.scale.set(1,1,1),v.zombieDeadArr.push(e),e.zombieMesh.name="zombieDead";const i=e.zombieMap;i&&i.get(e.zombieMesh).material.color.setHex(0)}const h=new i.Raycaster,d=[],p=[];class m{constructor(e,t){this.controller=e.xr.getController(t),this.index=t,this.controller.addEventListener("connected",this.onControllerConnected.bind(this)),this.controller.addEventListener("disconnected",this.onControllerDisconnected.bind(this)),this.controller.addEventListener("squeezestart",e=>this.onSqueezeStart(e)),this.controller.addEventListener("squeezeend",e=>this.onSqueezeEnd(e)),this.controller.addEventListener("selectstart",e=>this.onSelectStart(e)),this.controller.addEventListener("selectend",e=>this.onSelectEnd(e)),this.currentHovered=null,this.controller.userData.selected=void 0,this.hapticActuators=[],this.sword=null,this.line=null,p.push(this),D.dolly.add(this.controller)}onControllerConnected(){const e=v.sword.clone();e.rotateY(i.MathUtils.degToRad(180)),this.controller.add(e),this.sword=e,this.sword.visible=!1;const t=(new i.BufferGeometry).setFromPoints([new i.Vector3(0,0,0),new i.Vector3(0,0,-1)]),o=new i.LineBasicMaterial({color:v.colObj.c1,linewidth:2});this.line=new i.Line(t,o),this.line.name="line",this.line.scale.z=5,this.controller.add(this.line),this.controller.name=0===this.index?"controllerIndex0":"controllerIndex1"}onControllerDisconnected(e){const t=e.target,i=p.indexOf(this);i>-1&&p.splice(i,1),t&&(this.sword&&t.remove(this.sword),this.line&&t.remove(this.line)),this.sword=null,this.line=null,this.hapticActuators=[]}onSqueezeStart(e){e.data.gamepad.hapticActuators[0].pulse(.2,100),this.sword.visible=!0,this.line.visible=!1,D.usingSword=!0}onSqueezeEnd(e){const t=e.data&&e.data.gamepad;this.sword&&t&&t.buttons&&t.buttons.length>1&&!t.buttons[1].pressed&&(this.sword.visible=!1,this.line.visible=!0,D.usingSword=!1)}onSelectStart(e){this.handleSelect(e,!0)}onSelectEnd(e){this.handleSelect(e,!1)}handleSelect(e,t=!0){const i=e.target;if(t){const e=this.getIntersections(i);if(e.length>0){const t=e[0].object;i.userData.selected=t,function(e){"Exit VR"===e.name&&window.location.reload()}(t)}}else i.userData.selected&&(i.userData.selected=void 0)}handleHover(e=this.controller,t=!0){if(e.userData.selected)return;const i=e.getObjectByName("line");if(!i)return;const o=this.getIntersections(e),s=o.length>0?o[0].object:null;s&&t?(i.scale.z=o[0].distance,s!==this.currentHovered&&(this.currentHovered&&this.resetHover(this.currentHovered),s.material.emissive.r=1,d.includes(s)||d.push(s),this.currentHovered=s)):(i.scale.z=5,!t&&this.currentHovered?(this.resetHover(this.currentHovered),this.currentHovered=null,this.unhoverObjects(e)):this.currentHovered&&s!==this.currentHovered&&(this.resetHover(this.currentHovered),this.currentHovered=null))}resetHover(e){e.material.emissive.r=0;const t=d.indexOf(e);t>-1&&d.splice(t,1)}unhoverObjects(){for(;d.length;){const e=d.pop();e!==this.currentHovered&&(e.material.emissive.r=0)}}getIntersections(e){return e.updateMatrixWorld(),h.setFromXRController(e),h.intersectObjects(v.clickable_3D)}}const u=function(){var e,t,i,o,s,n=function(e){return Math.sin(6.283184*e)},r=function(e){return.003959503758*2**((e-128)/12)},a=function(e,t,i){var o,s,n,a,c,h,d=l[e.i[0]],p=e.i[1],m=e.i[3]/32,u=l[e.i[4]],w=e.i[5],y=e.i[8]/32,g=e.i[9],f=e.i[10]*e.i[10]*4,v=e.i[11]*e.i[11]*4,b=e.i[12]*e.i[12]*4,M=1/b,S=-e.i[13]/16,x=e.i[14],z=i*2**(2-e.i[15]),D=new Int32Array(f+v+b),I=0,C=0;for(o=0,s=0;o<f+v+b;o++,s++)s>=0&&(s-=z,c=r(t+(15&(x=x>>8|(255&x)<<4))+e.i[2]-128),h=r(t+(15&x)+e.i[6]-128)*(1+8e-4*e.i[7])),n=1,o<f?n=o/f:o>=f+v&&(n=(1-(n=(o-f-v)*M))*3**(S*n)),a=d(I+=c*n**m)*p,a+=u(C+=h*n**y)*w,g&&(a+=(2*Math.random()-1)*g),D[o]=80*a*n|0;return D},l=[n,function(e){return e%1<.5?1:-1},function(e){return e%1*2-1},function(e){var t=e%1*4;return t<2?t-1:3-t}];this.init=function(n){e=n,t=n.endPattern,i=0,o=n.rowLen*n.patternLen*(t+1)*2,s=new Int32Array(o)},this.generate=function(){var r,c,h,d,p,m,u,w,y,g,f,v,b,M,S=new Int32Array(o),x=e.songData[i],z=e.rowLen,D=e.patternLen,I=0,C=0,P=!1,T=[];for(h=0;h<=t;++h)for(u=x.p[h],d=0;d<D;++d){var k=u?x.c[u-1].f[d]:0;k&&(x.i[k-1]=x.c[u-1].f[d+D]||0,k<17&&(T=[]));var E=l[x.i[16]],A=x.i[17]/512,O=2**(x.i[18]-9)/z,R=x.i[19],L=x.i[20],V=43.23529*x.i[21]*3.141592/44100,B=1-x.i[22]/255,G=1e-5*x.i[23],F=x.i[24]/32,j=x.i[25]/512,H=6.283184*2**(x.i[26]-9)/z,_=x.i[27]/255,W=x.i[28]*z&-2;for(f=(h*D+d)*z,p=0;p<4;++p)if(m=u?x.c[u-1].n[d+p*D]:0){T[m]||(T[m]=a(x,m,z));var U=T[m];for(c=0,r=2*f;c<U.length;c++,r+=2)S[r]+=U[c]}for(c=0;c<z;c++)(g=S[w=2*(f+c)])||P?(v=V,R&&(v*=E(O*w)*A+.5),C+=(v=1.5*Math.sin(v))*(b=B*(g-C)-(I+=v*C)),g=3==L?C:1==L?b:I,G&&(g=(g*=G)<1?g>-1?n(.25*g):-1:1,g/=G),P=(g*=F)*g>1e-5,M=g*(1-(y=Math.sin(H*w)*j+.5)),g*=y):M=0,w>=W&&(M+=S[w-W+1]*_,g+=S[w-W]*_),S[w]=0|M,S[w+1]=0|g,s[w]+=0|M,s[w+1]+=0|g}return++i/e.numChannels},this.createAudioBuffer=function(e){for(var t=e.createBuffer(2,o/2,44100),i=0;i<2;i++)for(var n=t.getChannelData(i),r=i;r<o;r+=2)n[r>>1]=s[r]/65536;return t},this.createWave=function(){var e=44+2*o-8,t=e-36,i=new Uint8Array(44+2*o);i.set([82,73,70,70,255&e,e>>8&255,e>>16&255,e>>24&255,87,65,86,69,102,109,116,32,16,0,0,0,1,0,2,0,68,172,0,0,16,177,2,0,4,0,16,0,100,97,116,97,255&t,t>>8&255,t>>16&255,t>>24&255]);for(var n=0,r=44;n<o;++n){var a=s[n];a=a<-32767?-32767:a>32767?32767:a,i[r++]=255&a,i[r++]=a>>8&255}return i},this.getData=function(e,t){for(var i=2*Math.floor(44100*e),o=new Array(t),n=0;n<2*t;n+=1){var r=i+n;o[n]=e>0&&r<s.length?s[r]/32768:0}return o}};class w{constructor(e,t){this.audioContext=e,this.songData=t,this.currentSongNode=null}initSong(){const e=new u;e.init(this.songData);let t=0;for(;t<1;)t=e.generate();const i=e.createAudioBuffer(this.audioContext),o=this.audioContext.createBufferSource();o.buffer=i,o.connect(this.audioContext.destination),this.currentSongNode=o}}const y={songData:[{i:[0,91,128,0,0,95,128,12,0,0,12,0,72,0,0,0,0,0,0,0,2,255,0,0,32,83,3,130,4],p:[1,1,1,1,1,1,1],c:[{n:[146,,,146,,,142,,,137,,,137,,,137,,,142,,,137,,,137],f:[]}]},{i:[3,100,128,0,3,201,128,2,0,0,0,6,49,0,0,0,0,139,4,1,3,30,184,119,244,147,6,84,6],p:[,,,2,2],c:[{n:[],f:[]},{n:[,122,,,122,,,128,,,116,,,116,,,116,,,122,,,122],f:[]}]}],rowLen:5513,patternLen:32,endPattern:6,numChannels:2},g=(e,t,i={})=>t.appendChild(Object.assign(document.createElement(e),i)),f=new class{constructor(){this.eventListeners={}}on(e,t){return this.eventListeners[e]||(this.eventListeners[e]=[]),this.eventListeners[e].push(t),()=>this.off(e,t)}off(e,t){if(!this.eventListeners[e])return;const i=this.eventListeners[e].indexOf(t);i>-1&&this.eventListeners[e].splice(i,1)}emit(e,...t){if(!this.eventListeners[e])return;const i=[...this.eventListeners[e]];for(const s of i)try{s.call(this,...t)}catch(o){}}waitOnce(e,t=1e4){return new Promise((i,o)=>{let s;const n=(...t)=>{clearTimeout(s),this.off(e,n),i(...t)};this.on(e,n),s=setTimeout(()=>{this.off(e,n),o(new Error(`Timeout '${e}' , ${t}ms.`))},t)})}},v=new class{constructor(e){this.colObj={c1:7171712,c2:13158600,c3:14916608,c4:10822925,c5:15843015,c6:0,c7:6045384,c8:3153269,c9:6228500,c10:14464120,c11:8273477},this.emitter=e,this.world={width:300,height:150,moveDown:-1.5,font:"Chiller"},this.worldGroup=new i.Group,this.sizesWindowInner={width:window.innerWidth,height:window.innerHeight,pixelRatio:Math.min(window.devicePixelRatio,2)},this.blackOutPlane=null,this.opacityDirection=1,this.fadeDuration=2,this.listener=new i.AudioListener,this.zdistArr=[],this.willPlay=!1,this.environmentCollisionBVH,this.scene=new i.Scene,this.camera=new i.PerspectiveCamera(50,this.sizesWindowInner.width/this.sizesWindowInner.height,.1,1e3),this.camera.near=.01,this.scene.add(this.camera),this.camera.add(this.listener),this.clock=new i.Clock,this.elapsedTime=this.clock.getElapsedTime();const t=new i.HemisphereLight(16773360,394758,1.2);t.position.set(1,1,1),this.scene.add(t);const o=new i.AmbientLight(4210752,.5);this.scene.add(o),[{position:[0,20,0]},{position:[100,20,100]},{position:[-100,-20,-100]}].forEach(e=>{const t=new i.DirectionalLight(16777215,.5);t.position.set(...e.position),this.scene.add(t)}),this.renderer=new i.WebGLRenderer({antialias:!0}),this.renderer.setSize(this.sizesWindowInner.width,this.sizesWindowInner.height),this.renderer.setPixelRatio(this.sizesWindowInner.pixelRatio),this.renderer.xr.enabled=!0,document.body.appendChild(this.renderer.domElement),this.clickable_3D=[],this.zombieArr=[],this.zombieDeadArr=[],this.sword=null}init(){(function(){const e=new i.SphereGeometry(v.world.width/2,32,16,0,2*Math.PI,0,.5*Math.PI),t=(o=v.colObj.c5,s=v.colObj.c9,new i.ShaderMaterial({uniforms:{color1:{value:new i.Color(o)},color2:{value:new i.Color(s)}},vertexShader:"varying vec2 vUv; void main() { vUv = uv; gl_Position = projectionMatrix * modelViewMatrix * vec4(position,1.0); }",fragmentShader:"uniform vec3 color1; uniform vec3 color2; varying vec2 vUv; void main() { gl_FragColor = vec4(mix(color1, color2, vUv.y), 1.0); }"}));var o,s;t.side=i.BackSide;const n=new i.Mesh(e,t);n.position.set(0,v.world.moveDown,0),v.worldGroup.add(n)})(),function(){const e=new i.CircleGeometry(v.world.width/2,32),t=(t,o)=>{const s=new i.MeshBasicMaterial({color:t}),n=new i.Mesh(e,s);return n.rotation.x=-Math.PI/2,n.position.y=v.world.moveDown,n.layers.set(o),n};v.worldGroup.add(t(v.colObj.c3,0),t(v.colObj.c10,3))}(),function(){const e=new i.Group,t=new i.ConeGeometry(4,.5,8,1,!0),o=new i.TorusGeometry(4,.2,50,8),s=new i.CylinderGeometry(4.2,4.2,.5,8,1,!0),n=new i.CircleGeometry(.2,64),r=new i.MeshStandardMaterial({color:v.colObj.c7,flatShading:!0,side:i.DoubleSide}),a=new i.MeshStandardMaterial({color:v.colObj.c8,flatShading:!0,side:i.DoubleSide,roughness:.5}),l=new i.Mesh(t,r),c=new i.Mesh(o,r),h=new i.Mesh(s,r),d=new i.Mesh(n,a);c.rotation.set(Math.PI/2,0,2*Math.PI/8),c.translateZ(.2),d.rotation.x=Math.PI/2,d.position.y=.2,e.add(l,c,h,d),e.rotation.x=Math.PI,e.position.y=v.world.moveDown+.5,v.scene.add(e)}(),this.scene.add(this.worldGroup),this.sword=function(){const e=new i.Group,t={depth:2.5},o=new i.MeshBasicMaterial({color:"pink"}),s=new i.ConeGeometry(1,3,4),n=new i.MeshBasicMaterial({color:"DarkKhaki"}),r=new i.Shape([[3,0],[3,3],[8,13],[8,15],[7,17],[5,18],[5,19],[4,20],[3,21],[1,21],[-1,19],[-2,20],[-4,20],[-5,18],[-8,16],[-8,13],[-6,10],[-3,4],[-3,0],[3,0]].map(e=>new i.Vector2(...e)));return e.add(new i.Mesh(new i.ExtrudeGeometry(r,{depth:2,bevelThickness:.02,bevelSize:.02,bevelSegments:2}),new i.MeshBasicMaterial({color:"black"}))),[[[-7,14],[-6,13],[-5,13],[-4,14],[-4,15],[-5,16],[-6,16],[-7,15],[-7,14]],[[-4,17],[-3,15],[-2,15],[-1,16],[-1,18],[-2,19],[-3,19],[-4,18],[-4,17]],[[1,17],[2,15],[3,15],[4,18],[4,19],[3,20],[2,20],[1,19],[1,17]],[[4,14],[5,13],[6,13],[7,14],[7,15],[6,16],[5,16],[4,15],[4,14]],[[-3,9],[-3,10],[-2,11],[-2,12],[-1,13],[2,13],[3,12],[3,11],[4,10],[4,9],[2,7],[-2,7]]].forEach(s=>{const n=new i.Shape;n.moveTo(...s[0]),s.slice(1).forEach(e=>n.lineTo(...e));const r=new i.Mesh(new i.ExtrudeGeometry(n,t),o);e.add(r.translateZ(.5))}),[[-7,18,1],[-3,21,1],[2,22,1],[6,19,1]].forEach(t=>{const o=new i.Mesh(s,n);o.position.set(...t),e.add(o)}),e.rotateX(i.MathUtils.degToRad(-85)),e.scale.set(.015,.015,.015),e}(),z.addGems(S.levelUpScore),D.addDolly(),function(){const e=o("🐶",v.world.font).material.map.clone();r=new i.SpriteMaterial({map:e,color:16777215,depthTest:!1})}(),function(){const e=o("💀",v.world.font).material.map.clone();a=new i.SpriteMaterial({map:e,color:16777215})}(),this.blackOutPlane=new i.Mesh(new i.PlaneGeometry(4,4),new i.MeshBasicMaterial({color:34,transparent:!0,opacity:.01})),this.blackOutPlane.position.set(0,0,-1),this.camera.add(this.blackOutPlane),this.addResizeListener(),this.animate()}addResizeListener(){window.addEventListener("resize",()=>{this.sizesWindowInner.width=window.innerWidth,this.sizesWindowInner.height=window.innerHeight,this.sizesWindowInner.pixelRatio=Math.min(window.devicePixelRatio,2),this.camera.aspect=this.sizesWindowInner.width/this.sizesWindowInner.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.sizesWindowInner.width,this.sizesWindowInner.height),this.renderer.setPixelRatio(this.sizesWindowInner.pixelRatio)})}animate(){this.renderer.setAnimationLoop(()=>this.render())}render(){const e=this.clock.getDelta();if(z.gemMeshToBoxMap.size>0&&z.gemMeshToBoxMap.forEach((e,t)=>{t.rotation.y+=.005}),D&&"desktop_mode"==S.mode&&D.updateMovement(D.keys,P,e,null),1==S.screenFade&&(this.blackOutPlane.material.opacity+=1/this.fadeDuration*e*this.opacityDirection,this.blackOutPlane.material.opacity>=1&&(this.opacityDirection=-1),this.blackOutPlane.material.opacity<=0&&(this.blackOutPlane.material.opacity=.01,this.opacityDirection=1,this.emitter.emit("fadeComplete"),S.screenFade=!1)),M&&M.checkPortalCollision(),z.gemMeshToBoxMap.size>0){const e=Array.from(z.gemMeshToBoxMap.values());for(const t of e)t.userData&&t.containsPoint(D.dolly.position)&&!1===t.userData.beenSelected&&(t.userData.beenSelected=!0,z.collectGem(t))}if(this.zombieArr.length>0){for(let t=0;t<this.zombieArr.length;t++){const i=this.zombieArr[t];if(i.trackPlayer(e,i),i){const e=D.dolly.position.distanceTo(i.zombieMesh.position);this.zdistArr.push(e),1==D.usingSword&&e<1?(c(i),this.zombieArr.splice(t,1)):0==D.usingSword&&e<.5&&D.deadPlayer()}}this.toPlay=this.zdistArr.some(e=>e>.5&&e<=25),b.manageZombieSound(this.toPlay),this.zdistArr.length=0}x.upDateReplica(D.dolly,x.me);for(let t=0;t<this.zombieArr.length;t++){const e=this.zombieArr[t];x.upDateReplicaMap(e)}this.renderer.xr.isPresenting&&p.length>0&&(p.forEach(e=>{!function(e){e.handleHover()}(e)}),D.updateMovement(D.keys,P,e,I.session)),this.renderer.render(this.scene,this.camera)}}(f),b=new class{constructor(e){this.audioContext=e,this.zombieSoundIntervalId=null,this.lastFootstepTime=0,this.footstepCooldown=.25}playSound(e,t,i,o,s="sine",n=!1,r,a,l,c,h="sine"){const d=this.audioContext.createOscillator(),p=this.audioContext.createGain();d.type=s;const m=this.audioContext.currentTime;if(d.frequency.setValueAtTime(e,m),d.frequency.linearRampToValueAtTime(t,m+o*i),d.frequency.exponentialRampToValueAtTime(e,m+o),p.gain.setValueAtTime(1,m),p.gain.exponentialRampToValueAtTime(.001,m+o),d.connect(p),p.connect(this.audioContext.destination),d.start(m),d.stop(m+o),n){const e=this.audioContext.createOscillator();e.type=h,e.frequency.setValueAtTime(r,m+o),e.frequency.linearRampToValueAtTime(a,m+o+c*l),e.connect(p),e.start(m+o),e.stop(m+o+c)}}playMeow(){this.playSound(700,1500,.1,.5,"square",!0,1500,500,1,.7,"sine")}playSwordOut(){this.playSound(300,400,.5,.5,"sine",!0,1e3,1500,.5,.7,"sine")}playSwordIn(){this.playSound(300,400,.1,.5,"sine")}playGemCollect(){this.playSound(800,1500,.8,.6,"sine",!0,1350,1880,.01,.1)}playLevelUp(){this.playSound(1150,1775,.7,.5,"sine",!0,1650,2e3,.01,.3,"triangle")}playZombieRelease(){this.playSound(400,50,.1,1,"sawtooth")}playZombieNear(){this.playSound(135,500,.43,.6,"sine",!0,161,500,.51,.4,"sine")}playDeadZombie(){this.playSound(400,80,.4,1,"sawtooth",!0,380,70,.2,.7,"square")}playPlayerDead(){this.playSound(400,80,.1,1,"sawtooth",!0,180,70,-.1,1,"triangle")}playFootSteps(){this.playSound(120,110,1,.01,"sine")}manageZombieSound(e){e?null===this.zombieSoundIntervalId&&(this.playZombieNear(),this.zombieSoundIntervalId=setInterval(()=>{this.playZombieNear()},1e3)):null!==this.zombieSoundIntervalId&&(clearInterval(this.zombieSoundIntervalId),this.zombieSoundIntervalId=null)}}(v.listener.context),M=new class{constructor(){this.door={w:12,h:5,d:12},this.geo=new i.BoxGeometry(this.door.w,this.door.h,this.door.d),this.mat=new i.MeshStandardMaterial({color:240,wireframe:!0}),this.cube=this.box=null,this.map=new Map,this.pos=new i.Vector3(0,this.door.h/2-1.3,0)}initPortal(){this.cube=new i.Mesh(this.geo,this.mat),this.cube.position.copy(this.pos),this.cube.visible=!1,v.scene.add(this.cube),this.box=(new i.Box3).setFromObject(this.cube),this.map.set(this.cube,this.box)}async checkPortalCollision(){if(this.box&&this.box.containsPoint(D.dolly.position)&&!z.gemMeshToBoxMap.size&&!v.zombieArr.length&&!S.isGameSuspended){S.isGameSuspended=S.screenFade=!0,clearInterval(b.zombieSoundIntervalId),b.playLevelUp(),v.scene.remove(this.cube),this.box=null;try{await S.emitter.waitOnce("fadeComplete",5e3),S.score=0,S.level++,S.levelUpScore++,S.cleanLevel()}catch(e){S.screenFade=!1,S.cleanLevel()}S.isGameSuspended=!1}}};M.initPortal();const S=new class{constructor(e){this.emitter=e,this.mode="pregame",this.modes={PREGAME:"pregame",VR_MODE:"vr_mode",DT_MODE:"desktop_mode"},this.level=1,this.score=0,this.levelUpScore=3,this.screenFade=!1,this.childrenToRemove=[],this.emitter.on("fadeComplete",()=>{}),this.isGameSuspended=!1}setMode(e){Object.values(this.modes).includes(e)&&(this.mode=e,this.handleModeChange(e))}resetScore(){this.score=0,x.updateScoreDisplay()}handleModeChange(e){switch(e){case this.modes.VR_MODE:I.removePreGameElements(),b.playMeow(),x.capture();break;case this.modes.DT_MODE:I.removePreGameElements(),b.playMeow(),D.speedFactor=25,D.angularSpeed=1.5,x.capture(),D.addEventListenersDT(),D.addSword()}}cleanLevel(){D.dolly.position.set(0,0,135),D.dolly.rotation.set(0,0,0),clearInterval(b.zombieSoundIntervalId),n(x.paper,"zombReplica",x.zombReplicArr),n(v.scene,"zombie",v.zombieArr),n(v.scene,"zombieDead",v.zombieDeadArr);for(const[e,t]of z.gemMeshToBoxMap.entries())v.scene.remove(e),e.geometry.dispose(),e.material.dispose();z.gemMeshToBoxMap.clear(),this.prepLevel()}prepLevel(){x.updateLevelDisplay(),x.updateScoreDisplay(),z.addGems(this.levelUpScore),M.initPortal(),x.updateCapture()}}(f);S.setMode(S.modes.PREGAME);const x=new class{constructor(){this.paper=null,this.paperPosition=new i.Vector3(-1,.5,-2),this.paperWidth=.8,this.captured=!1,this.cameraScis=null,this.renderer2=null,this.canvas=null,this.me=null,this.localSpaceVector=new i.Vector3,this.localSpaceEuler=new i.Euler,this.zomb=null,this.zombReplicArr=[],this.levelDisplay=null,this.scoreDisplay=null}capture(){const e=this.initializeRenderer();e.style.display="none";const t=e.toDataURL("img/png"),i=new Image;i.src=t,i.onload=()=>{null==this.canvas&&this.createPaperMesh(i),0==this.captured&&(this.createMeReplica(),this.createExitButton(),this.createLevelDisplay(),this.createScoreDisplay(),this.captured=!0)},i.onerror=e=>{}}updateCapture(){const e=this.canvas.getContext("2d");e.clearRect(0,0,this.canvas.width,this.canvas.height),this.renderer2.render(v.scene,this.cameraScis);const t=this.renderer2.domElement.toDataURL("img/png"),o=new Image;o.src=t,o.onload=()=>{e.drawImage(o,0,0,this.canvas.width,this.canvas.height);const t=new i.Texture(this.canvas);this.paper.material.map=t,this.paper.material.map.needsUpdate=!0}}initializeRenderer(){return 0==this.captured&&(this.renderer2=new i.WebGLRenderer({antialias:!0}),document.body.appendChild(this.renderer2.domElement),this.cameraScis=new i.OrthographicCamera(v.world.width/-2,v.world.width/2,v.world.width/2,v.world.width/-2,.1,1e3),this.cameraScis.position.set(0,4,0),this.cameraScis.lookAt(new i.Vector3(0,0,0)),this.cameraScis.layers.enable(3),v.scene.add(this.cameraScis)),this.renderer2.render(v.scene,this.cameraScis),this.renderer2.domElement}createPaperMesh(e){this.canvas=document.createElement("canvas"),this.canvas.getContext("2d").drawImage(e,0,0,this.canvas.width,this.canvas.height);const t=new i.Texture(this.canvas),o=new i.MeshBasicMaterial({map:t,side:2}),s=new i.CircleGeometry(this.paperWidth/2,32);this.paper=new i.Mesh(s,o),this.paper.position.copy(this.paperPosition),D.dolly.add(this.paper),o.map.needsUpdate=!0}createMeReplica(){const e=new i.SphereGeometry(.02,32,16),t=new i.MeshBasicMaterial({color:v.colObj.c1});this.me=new i.Mesh(e,t);const o=new i.ConeGeometry(.02,.05,32),s=new i.Mesh(o,t);s.position.set(0,.03,0),this.me.add(s),this.me.scale.set(.6,.6,.6),this.paper.add(this.me)}upDateReplica(e,t){null!=this.paper&&(this.localSpaceVector.copy(this.paperPosition).applyMatrix4(e.matrixWorld),t.position.set(this.localSpaceVector.x,-this.localSpaceVector.z,0).multiplyScalar(this.paperWidth/v.world.width),this.localSpaceEuler.setFromRotationMatrix(e.matrixWorld,"YXZ"),t.rotation.set(0,0,this.localSpaceEuler.y))}upDateReplicaMap(e){if(null==this.paper)return;this.localSpaceVector.copy(this.paperPosition).applyMatrix4(e.zombieMesh.matrixWorld);const t=e.zombRep;t&&t.position.set(this.localSpaceVector.x,-this.localSpaceVector.z,0).multiplyScalar(this.paperWidth/v.world.width)}createExitButton(){if("vr_mode"==S.mode){const e=o("EXIT",v.world.font);e.position.set(0,-.55,0),e.name="Exit VR",this.paper.add(e),v.clickable_3D.push(e)}}createLevelDisplay(){this.levelDisplay=o("L1",v.world.font),this.levelDisplay.position.set(-.35,.35,0),this.paper.add(this.levelDisplay)}createScoreDisplay(){this.scoreDisplay=o("🐭 0",v.world.font),this.scoreDisplay.position.set(.35,.35,0),this.paper.add(this.scoreDisplay)}updateLevelDisplay(){s(this.levelDisplay,`L${S.level}`)}updateScoreDisplay(){s(this.scoreDisplay,`🐭${S.score}`)}},z=new class{constructor(){this.gemGeo=new i.IcosahedronGeometry(2,1),this.gemMeshToBoxMap=new Map,this.gemMat=new i.MeshStandardMaterial({color:v.colObj.c1,wireframe:!0})}addGems(e){let t,s=new i.Vector2;const n=o("🐀",v.world.font).material.map.clone(),r=new i.SpriteMaterial({map:n,color:16777215});for(let o=0;o<e;o++){t=new i.Mesh(this.gemGeo,this.gemMat);const n=o*(2*Math.PI/e),a=[62,96,135],l=a[Math.floor(Math.random()*a.length)];s.x=l*Math.cos(n),s.z=l*Math.sin(n),t.position.set(s.x,1,s.z),t.userData={index:o},t.add(new i.Sprite(r)),v.scene.add(t);const c=(new i.Box3).setFromObject(t);c.userData={beenSelected:!1},this.gemMeshToBoxMap.set(t,c)}}async collectGem(e){b.playGemCollect(),S.score=S.score+1,x.updateScoreDisplay();let t=null;for(const[i,o]of this.gemMeshToBoxMap.entries())if(o===e){t=i;break}t&&(t.children.forEach(e=>{e instanceof i.Sprite&&t.remove(e)}),v.scene.remove(t),t.geometry.dispose(),t.material&&t.material.dispose(),this.gemMeshToBoxMap.delete(t),x.updateCapture(),setTimeout(()=>{const e=new l;e.createZombie(),v.zombieArr.push(e),b.playZombieRelease()},1e3))}},D=new class{constructor(){this.dolly=new i.Group,this.keys={w:!1,a:!1,s:!1,d:!1},this.speedFactor=25,this.angularSpeed=1,this.distanceFromHome,this.usingSword=!1,this.colliderHeight=1.8,this.colliderWidth=.8,this.colliderDepth=.8,this.playerCollider=new i.Box3,this.playerColliderMesh=new i.Mesh(new i.BoxGeometry(this.colliderWidth,this.colliderHeight,this.colliderDepth),new i.MeshBasicMaterial({color:65280,wireframe:!0,transparent:!0,opacity:.5})),this.playerColliderMesh.visible=!1,this.dolly.add(this.playerColliderMesh),this.homePosition=new i.Vector3(0,0,-135),this.sword2=null}addDolly(){v.scene.remove(v.camera),this.dolly.add(v.camera),this.dolly.position.set(0,0,135),this.dolly.name="Dolly",v.scene.add(this.dolly);const e=function(){const e=(new i.Shape).moveTo(-2,16).lineTo(-8,14).lineTo(0,26).lineTo(8,14).lineTo(2,16).lineTo(2,0).lineTo(-2,0).lineTo(-2,16),t=new i.ExtrudeGeometry(e,{depth:.1});return t.center(),t}(),t=new i.MeshStandardMaterial({color:"black"}),o=new i.Mesh(e,t);o.rotateX(-Math.PI/2),o.scale.set(.03,.03,.03),o.position.set(0,-.5,-1),o.name="arrow",this.dolly.add(o)}addSword(){this.dolly.add(v.sword),v.sword.rotateX(i.MathUtils.degToRad(30)),v.sword.rotateY(i.MathUtils.degToRad(180)),v.sword.translateX(.25),v.sword.translateZ(.65),v.sword.translateY(.5),this.sword2=v.sword.clone(!0),this.dolly.add(this.sword2),this.sword2.translateX(-.5),this.sword2.visible=!1,v.sword.visible=!1}async deadPlayer(){if(!S.isGameSuspended){S.isGameSuspended=!0,S.screenFade=!0,clearInterval(b.zombieSoundIntervalId),b.playPlayerDead();try{await S.emitter.waitOnce("fadeComplete",5e3),S.score=0,S.cleanLevel()}catch(e){S.screenFade=!1,S.cleanLevel()}S.isGameSuspended=!1}}handleTrumanZone(){this.dolly.position.multiplyScalar(.9)}addEventListenersDT(){document.addEventListener("keydown",this.onDocumentKeyDown.bind(this)),document.addEventListener("keyup",this.onDocumentKeyUp.bind(this))}onDocumentKeyDown(e){switch(e.preventDefault(),e.which){case 87:case 38:this.keys.w=!0;break;case 83:case 40:this.keys.s=!0;break;case 65:case 37:this.keys.a=!0;break;case 68:case 39:this.keys.d=!0;break;case 81:this.keys.q=!0;break;case 32:!1===this.usingSword&&b.playSwordOut(),v.sword.visible=!0,this.sword2.visible=!0,this.usingSword=!0}}onDocumentKeyUp(e){switch(e.preventDefault(),e.which){case 87:case 38:this.keys.w=!1;break;case 83:case 40:this.keys.s=!1;break;case 65:case 37:this.keys.a=!1;break;case 68:case 39:this.keys.d=!1;break;case 32:b.playSwordIn(),v.sword.visible=!1,this.sword2.visible=!1,this.usingSword=!1}}updateMovement(e,t,o,s=null){const n=this.speedFactor*o,r=this.angularSpeed*o,a=this.dolly.position.clone();if(s&&s.inputSources.length>0){let e=s.inputSources[0].gamepad;if(!e)return;e.axes.every(e=>0===e)&&s.inputSources.length>1&&(e=s.inputSources[1].gamepad);const t=new i.Vector3(0,0,-1);t.applyQuaternion(this.dolly.quaternion),(e.axes[3]>.1||e.axes[3]<-.1)&&this.dolly.position.addScaledVector(t,-e.axes[3]*n),(e.axes[2]>.5||e.axes[2]<-.5)&&(this.dolly.rotation.y-=e.axes[2]*r)}e.a&&(this.dolly.rotation.y+=r),e.d&&(this.dolly.rotation.y-=r),e.q&&this.dolly.position.addScaledVector(new i.Vector3(0,1,0),n);const l=new i.Vector3(0,0,-1);if(l.applyQuaternion(this.dolly.quaternion),e.w&&this.dolly.position.addScaledVector(l,n),e.s&&this.dolly.position.addScaledVector(l,-n),a.distanceTo(this.dolly.position)>.05){const e=b.audioContext.currentTime;e-b.lastFootstepTime>b.footstepCooldown&&(b.playFootSteps(),b.lastFootstepTime=e)}this.playerCollider.setFromCenterAndSize(new i.Vector3(this.dolly.position.x,this.dolly.position.y+this.colliderHeight/2,this.dolly.position.z),new i.Vector3(this.colliderWidth,this.colliderHeight,this.colliderDepth)),this.playerColliderMesh.position.set(0,this.colliderHeight/2+v.world.moveDown,0);const c=t.query(this.playerCollider);for(const h of c)if(this.playerCollider.intersectsBox(h)){const e=new i.Vector3;this._getPenetrationVector(this.playerCollider,h,e),Math.abs(e.x)<.05&&Math.abs(e.z)<.05&&e.y>0&&e.y<=this.stepHeight?(this.dolly.position.y+=e.y,this.playerCollider.translate(new i.Vector3(0,e.y,0))):(this.dolly.position.add(e),this.playerCollider.translate(e))}this.dolly.position.y<this.colliderHeight/2&&(this.dolly.position.y=this.colliderHeight/2,this.playerCollider.setFromCenterAndSize(new i.Vector3(this.dolly.position.x,this.dolly.position.y+this.colliderHeight/2,this.dolly.position.z),new i.Vector3(this.colliderWidth,this.colliderHeight,this.colliderDepth))),this.distanceFromHome=this.dolly.position.distanceTo(new i.Vector3),this.distanceFromHome>v.world.width/2-.75&&this.handleTrumanZone()}_getPenetrationVector(e,t,o){const s=new i.Vector3;e.getCenter(s);const n=new i.Vector3;t.getCenter(n);const r=new i.Vector3;e.getSize(r);const a=new i.Vector3;t.getSize(a);const l=r.x/2+a.x/2-Math.abs(s.x-n.x),c=r.y/2+a.y/2-Math.abs(s.y-n.y),h=r.z/2+a.z/2-Math.abs(s.z-n.z);l<0||c<0||h<0?o.set(0,0,0):l<c&&l<h?o.set(l*Math.sign(s.x-n.x),0,0):c<l&&c<h?o.set(0,c*Math.sign(s.y-n.y),0):o.set(0,0,h*Math.sign(s.z-n.z))}}(v),I=new class{constructor(){t(this,"togglePopup",(e,t)=>document.getElementById(e).style.visibility=t?"visible":"hidden"),t(this,"toggleMute",()=>{const e=v.listener.context,t=document.getElementById("muteB"),i="suspended"===e.state;(i?e.resume():e.suspend()).then(()=>{t.textContent=i?"🔉":"🔇"})}),this.createUI(),this.vrQuery()}createUI(){const e=[g("div",document.body,{id:"title",className:"text",textContent:"Clawdia"}),g("div",document.body,{className:"box"}),g("div",document.body,{className:"util"})];e.forEach(e=>e.classList.add("pregame-ui")),this.createPopup("introID","Instructions",["Eat all Mice","Slay dog","Snooze in dogs bed","For VR - thumb stick to move & squeeze for weapon","For Desktop - WASD to move & space bar for weapon"]),this.createPopup("aboutID","About",['Clawdia by Shauna Lynch for js13k comp. <a href="https://www.lynchbyte.com/index.html" target="_blank">lynchbyte</a>.','License here; <a href="https://www.lynchbyte.com/20_Clawdia/license_Clawdia.html" target="_blank">MIT & CC BY-SA 4.0</a>','Made with: <a href="https://threejs.org/" target="_blank">Three.js</a>','and Sound Box <a href="https://sb.bitsnbites.eu/" target="_blank">Bits n Bites</a>.']);const[t,i]=[e[1],e[2]];[{parent:t,id:"introB",left:"25%",text:"Intro",event:()=>this.togglePopup("introID",!0)},{parent:t,id:"startVR",left:"35%",fontSize:"40px",text:"VR ?"},{parent:t,id:"startDT",left:"65%",fontSize:"40px",text:"Desktop",event:()=>S.setMode(S.modes.DT_MODE)},{parent:t,id:"aboutB",left:"75%",text:"About",event:()=>this.togglePopup("aboutID",!0)},{parent:i,id:"muteB",left:"50%",fontSize:"15px",text:"🔉",event:this.toggleMute},{parent:i,id:"exitB",left:"50%",fontSize:"15px",text:"Exit",event:()=>window.location.reload()}].forEach(e=>{const t=g("button",e.parent,{className:"button",id:e.id,textContent:e.text});Object.assign(t.style,{left:e.left,fontSize:e.fontSize||""}),e.event&&t.addEventListener("click",e.event)})}createPopup(e,t,i){const o=g("div",document.body,{id:e,className:"popUpClass pregame-ui"});g("h1",o,{textContent:t}),i.forEach(e=>g("p",o,{innerHTML:e})),g("button",o,{className:"buttonClose",textContent:"❌",onclick:()=>this.togglePopup(e,!1)})}removePreGameElements(){T.stop(),document.querySelectorAll(".pregame-ui").forEach(e=>{e.classList.contains("util")||e.closest(".util")||e.remove()})}vrQuery(){let e=document.getElementById("startVR");navigator.xr?navigator.xr.isSessionSupported("immersive-vr").then(t=>{t?(e.textContent="VR ✔️",e.addEventListener("click",()=>{navigator.xr.requestSession("immersive-vr",{}).then(e=>{S.setMode(S.modes.VR_MODE),async function(e){v.renderer.xr.setReferenceSpaceType("local"),await v.renderer.xr.setSession(e),function(){const e=navigator.userAgent||"";return e.includes("OculusBrowser")||e.includes("Quest")}()&&function(){const e=Object.assign(document.createElement("canvas"),{width:1024,height:128}),t=e.getContext("2d");t.fillStyle=v.colObj.c3,t.font="bold 20px Times New Roman",t.textAlign="center",t.textBaseline="middle",t.fillText("No Controllers? Press re-centre button once, then resume",e.width/2,e.height/2);const o=new i.Mesh(new i.PlaneGeometry(1.8,.45),new i.MeshBasicMaterial({map:new i.CanvasTexture(e),transparent:!0}));o.position.set(0,-.1,-2),v.camera.add(o),setTimeout(()=>{v.camera.remove(o),o.geometry.dispose(),o.material.map.dispose(),o.material.dispose()},5e3)}(v.scene),new m(v.renderer,0),new m(v.renderer,1)}(e),this.session=e}).catch(e=>{})})):e.textContent="VR ❌"}).catch(t=>{e.textContent="Error"}):e.textContent="XR ❌"}},C=function(){const e=new i.MeshStandardMaterial({color:v.colObj.c11,flatShading:!0,side:i.DoubleSide}),t=new i.MeshStandardMaterial({color:v.colObj.c4,flatShading:!0,side:i.DoubleSide}),o=[],s=[],n=[],r=[],a={steps:1,depth:5,bevelEnabled:!1},l={radius:45,walkwayAng:18*Math.PI/180,panelsToMakeOneSegment:4,numOfSegments:4,jumpInStartAngle:90*Math.PI/180,offsetFromCentreline:45*Math.PI/180/2,Floor_Inner:36,Floor_Outer:52},c={radius:80,walkwayAng:10*Math.PI/180,panelsToMakeOneSegment:6,numOfSegments:5,jumpInStartAngle:72*Math.PI/180,offsetFromCentreline:45*Math.PI/180/2,Floor_Inner:72,Floor_Outer:87},h={radius:115,walkwayAng:10*Math.PI/180,panelsToMakeOneSegment:6,numOfSegments:5,jumpInStartAngle:72*Math.PI/180,offsetFromCentreline:10*Math.PI/180/2,Floor_Inner:106,Floor_Outer:123};r.push(l,c,h),r.forEach(t=>{const r=new i.Vector2(t.radius,v.world.moveDown),a=new i.Vector2(t.radius,5);o.push(r,a);const l=new i.LatheGeometry(o,1,0,t.walkwayAng),c=new i.Mesh(l,e);c.visible=!1,o.length=0;const h=new i.Vector2(t.Floor_Inner,v.world.moveDown+.01),d=new i.Vector2(t.Floor_Outer,v.world.moveDown+.01);s.push(h,d);const p=new i.LatheGeometry(s,1,0,t.walkwayAng),m=new i.Mesh(p,e);m.position.set(0,5.1,0),m.layers.set(3),s.length=0;for(let e=0;e<t.numOfSegments;e++){const o=e*t.jumpInStartAngle+t.offsetFromCentreline;for(let e=0;e<t.panelsToMakeOneSegment;e++){const s=e*t.walkwayAng+o,r=c.clone(),a=m.clone();r.rotateY(s),a.rotateY(s),v.worldGroup.add(r,a);const l=(new i.Box3).setFromObject(r);n.push(l)}}});const d=new i.RingGeometry(140,155,20),p=new i.Mesh(d,e);return p.rotateX(90*Math.PI/180),p.position.set(0,v.world.moveDown+.1,0),p.layers.set(3),v.worldGroup.add(p),r.forEach(e=>{const o=new i.Shape,s=e.walkwayAng*e.panelsToMakeOneSegment;o.moveTo(e.Floor_Inner,0),o.absarc(0,0,e.Floor_Inner,0,s,!1),o.lineTo(e.Floor_Outer*Math.cos(s),e.Floor_Outer*Math.sin(s)),o.absarc(0,0,e.Floor_Outer,s,0,!0);const n=new i.ExtrudeGeometry(o,a);n.rotateX(-Math.PI/2),n.translate(0,v.world.moveDown+.01,0);const r=new i.Mesh(n,t);for(let t=0;t<e.numOfSegments;t++){const i=t*e.jumpInStartAngle+e.offsetFromCentreline,o=r.clone();o.rotateY(i-90*Math.PI/180),v.worldGroup.add(o)}}),n}(),P=new class{constructor(e){if(!Array.isArray(e)||e.some(e=>!(e instanceof i.Box3)))return this.colliders=[],void(this.nodes=[]);this.colliders=e,this.nodes=[],this.colliderIndices=Array.from({length:e.length},(e,t)=>t),this.colliders.length>0&&this.build(0,this.colliderIndices.length-1,0,this.colliderIndices)}build(e,t,o,s){const n=this.nodes.length;this.nodes.push({});const r=new i.Box3,a=[];for(let m=e;m<=t;m++){const e=s[m],t=this.colliders[e];r.union(t);const o=new i.Vector3;t.getCenter(o),a.push({centroid:o,originalIndex:e,currentArrayIdx:m})}this.nodes[n].min=r.min,this.nodes[n].max=r.max;const l=t-e+1;if(l<=4||o>=15)return this.nodes[n].isLeaf=!0,this.nodes[n].colliderStart=e,this.nodes[n].colliderEnd=t,this.nodes[n].left=-1,this.nodes[n].right=-1,n;const c=(new i.Vector3).subVectors(r.max,r.min);let h=0;c.y>c.x&&(h=1),c.z>c.getComponent(h)&&(h=2),a.sort((e,t)=>e.centroid.getComponent(h)-t.centroid.getComponent(h));const d=new Array(l);for(let i=0;i<l;i++)d[i]=a[i].originalIndex;for(let i=0;i<l;i++)s[e+i]=d[i];const p=e+Math.floor(l/2)-1;return this.nodes[n].isLeaf=!1,this.nodes[n].left=this.build(e,p,o+1,s),this.nodes[n].right=this.build(p+1,t,o+1,s),n}query(e){const t=[];if(0===this.nodes.length)return t;const o=[0];for(;o.length>0;){const s=o.pop(),n=this.nodes[s],r=new i.Box3(n.min,n.max);if(e.intersectsBox(r))if(n.isLeaf)for(let e=n.colliderStart;e<=n.colliderEnd;e++){const i=this.colliderIndices[e];t.push(this.colliders[i])}else o.push(n.left),o.push(n.right)}return t}}(C);let T;v.init(),function(){T=new i.Audio(v.listener);const e=new i.Object3D;e.add(T),v.scene.add(e);const t=new w(v.listener.context,y);t.initSong(),t.currentSongNode&&t.currentSongNode.buffer&&(T.setBuffer(t.currentSongNode.buffer),T.play())}();</script>